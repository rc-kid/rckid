#include "../gbctests_insns.h"
#if (defined GBCEMU_INSNS_TESTS_ALL) || (defined GBCEMU_INSNS_TESTS_f7)
#include "../gbctests.h"

namespace rckid::gbcemu {

    TEST(gbcemu, opcode_f7) {
        GBCEmu gbc{};
        uint8_t cartridge[0x8000];
        cartridge[0x149] = 0x02; // 8kb external RAM
        gbc.loadCartridge(new FlashGamePak(cartridge));
        // F7 0000
        gbc.setState(0x7454, 0xa828, 0xb460, 0xaa5d, 0x57ce, 0xcd9d, 0x0, 0x1);
        gbc.writeMem(0x7454, { 0xf7 });
        gbc.writeMem(0xa826, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xb4);
        EXPECT(gbc.b(),  0xaa);
        EXPECT(gbc.c(),  0x5d);
        EXPECT(gbc.d(),  0x57);
        EXPECT(gbc.e(),  0xce);
        EXPECT(gbc.h(),  0xcd);
        EXPECT(gbc.l(),  0x9d);
        EXPECT(gbc.sp(), 0xa826);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa826), 0x55);
        EXPECT(gbc.readMem(0xa827), 0x74);
        // F7 0007
        gbc.setState(0x8cc6, 0xedac, 0x6200, 0x7df2, 0x2acc, 0x4651, 0x0, 0x0);
        gbc.writeMem(0x8cc6, { 0xf7 });
        gbc.writeMem(0xedaa, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x62);
        EXPECT(gbc.b(),  0x7d);
        EXPECT(gbc.c(),  0xf2);
        EXPECT(gbc.d(),  0x2a);
        EXPECT(gbc.e(),  0xcc);
        EXPECT(gbc.h(),  0x46);
        EXPECT(gbc.l(),  0x51);
        EXPECT(gbc.sp(), 0xedaa);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8cc6), 0xf7);
        EXPECT(gbc.readMem(0xedaa), 0xc7);
        EXPECT(gbc.readMem(0xedab), 0x8c);
        // F7 0008
        gbc.setState(0xa388, 0xc99f, 0x5620, 0x75dd, 0xafc6, 0x9997, 0x1, 0x1);
        gbc.writeMem(0xa388, { 0xf7 });
        gbc.writeMem(0xc99d, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x56);
        EXPECT(gbc.b(),  0x75);
        EXPECT(gbc.c(),  0xdd);
        EXPECT(gbc.d(),  0xaf);
        EXPECT(gbc.e(),  0xc6);
        EXPECT(gbc.h(),  0x99);
        EXPECT(gbc.l(),  0x97);
        EXPECT(gbc.sp(), 0xc99d);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa388), 0xf7);
        EXPECT(gbc.readMem(0xc99d), 0x89);
        EXPECT(gbc.readMem(0xc99e), 0xa3);
        // F7 000A
        gbc.setState(0x1766, 0xfbab, 0x1e0, 0x74ec, 0x70e2, 0xf321, 0x1, 0x0);
        gbc.writeMem(0x1766, { 0xf7 });
        gbc.writeMem(0xfba9, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0x74);
        EXPECT(gbc.c(),  0xec);
        EXPECT(gbc.d(),  0x70);
        EXPECT(gbc.e(),  0xe2);
        EXPECT(gbc.h(),  0xf3);
        EXPECT(gbc.l(),  0x21);
        EXPECT(gbc.sp(), 0xfba9);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xfba9), 0x67);
        EXPECT(gbc.readMem(0xfbaa), 0x17);
        // F7 0011
        gbc.setState(0xb4ce, 0x9e4b, 0x6960, 0xfa69, 0x1f02, 0xe3dc, 0x1, 0x1);
        gbc.writeMem(0x9e49, { 0x0, 0x0 });
        gbc.writeMem(0xb4ce, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x69);
        EXPECT(gbc.b(),  0xfa);
        EXPECT(gbc.c(),  0x69);
        EXPECT(gbc.d(),  0x1f);
        EXPECT(gbc.e(),  0x2);
        EXPECT(gbc.h(),  0xe3);
        EXPECT(gbc.l(),  0xdc);
        EXPECT(gbc.sp(), 0x9e49);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9e49), 0xcf);
        EXPECT(gbc.readMem(0x9e4a), 0xb4);
        EXPECT(gbc.readMem(0xb4ce), 0xf7);
        // F7 0012
        gbc.setState(0xc81d, 0x8703, 0x9b80, 0xe765, 0x9d83, 0xd1fb, 0x0, 0x0);
        gbc.writeMem(0x8701, { 0x0, 0x0 });
        gbc.writeMem(0xc81d, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x9b);
        EXPECT(gbc.b(),  0xe7);
        EXPECT(gbc.c(),  0x65);
        EXPECT(gbc.d(),  0x9d);
        EXPECT(gbc.e(),  0x83);
        EXPECT(gbc.h(),  0xd1);
        EXPECT(gbc.l(),  0xfb);
        EXPECT(gbc.sp(), 0x8701);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8701), 0x1e);
        EXPECT(gbc.readMem(0x8702), 0xc8);
        EXPECT(gbc.readMem(0xc81d), 0xf7);
        // F7 0013
        gbc.setState(0x18ef, 0xe246, 0x46a0, 0xe1cc, 0x6a49, 0x85fe, 0x1, 0x0);
        gbc.writeMem(0x18ef, { 0xf7 });
        gbc.writeMem(0xe244, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x46);
        EXPECT(gbc.b(),  0xe1);
        EXPECT(gbc.c(),  0xcc);
        EXPECT(gbc.d(),  0x6a);
        EXPECT(gbc.e(),  0x49);
        EXPECT(gbc.h(),  0x85);
        EXPECT(gbc.l(),  0xfe);
        EXPECT(gbc.sp(), 0xe244);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe244), 0xf0);
        EXPECT(gbc.readMem(0xe245), 0x18);
        // F7 0015
        gbc.setState(0x12eb, 0xecab, 0xae80, 0x6d38, 0xbdb8, 0xdd11, 0x1, 0x1);
        gbc.writeMem(0x12eb, { 0xf7 });
        gbc.writeMem(0xeca9, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xae);
        EXPECT(gbc.b(),  0x6d);
        EXPECT(gbc.c(),  0x38);
        EXPECT(gbc.d(),  0xbd);
        EXPECT(gbc.e(),  0xb8);
        EXPECT(gbc.h(),  0xdd);
        EXPECT(gbc.l(),  0x11);
        EXPECT(gbc.sp(), 0xeca9);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xeca9), 0xec);
        EXPECT(gbc.readMem(0xecaa), 0x12);
        // F7 0016
        gbc.setState(0x4bf1, 0xfd76, 0x4330, 0x30a2, 0x1b54, 0x4202, 0x1, 0x0);
        gbc.writeMem(0x4bf1, { 0xf7 });
        gbc.writeMem(0xfd74, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x43);
        EXPECT(gbc.b(),  0x30);
        EXPECT(gbc.c(),  0xa2);
        EXPECT(gbc.d(),  0x1b);
        EXPECT(gbc.e(),  0x54);
        EXPECT(gbc.h(),  0x42);
        EXPECT(gbc.l(),  0x2);
        EXPECT(gbc.sp(), 0xfd74);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xfd74), 0xf2);
        EXPECT(gbc.readMem(0xfd75), 0x4b);
        // F7 0018
        gbc.setState(0x70ff, 0xfcba, 0x4f40, 0x7109, 0x13b, 0x9f7d, 0x0, 0x0);
        gbc.writeMem(0x70ff, { 0xf7 });
        gbc.writeMem(0xfcb8, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x4f);
        EXPECT(gbc.b(),  0x71);
        EXPECT(gbc.c(),  0x9);
        EXPECT(gbc.d(),  0x1);
        EXPECT(gbc.e(),  0x3b);
        EXPECT(gbc.h(),  0x9f);
        EXPECT(gbc.l(),  0x7d);
        EXPECT(gbc.sp(), 0xfcb8);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xfcb8), 0x0);
        EXPECT(gbc.readMem(0xfcb9), 0x71);
        // F7 0019
        gbc.setState(0x51a3, 0xb800, 0xdba0, 0x733a, 0x1ced, 0xd14e, 0x0, 0x1);
        gbc.writeMem(0x51a3, { 0xf7 });
        gbc.writeMem(0xb7fe, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xdb);
        EXPECT(gbc.b(),  0x73);
        EXPECT(gbc.c(),  0x3a);
        EXPECT(gbc.d(),  0x1c);
        EXPECT(gbc.e(),  0xed);
        EXPECT(gbc.h(),  0xd1);
        EXPECT(gbc.l(),  0x4e);
        EXPECT(gbc.sp(), 0xb7fe);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb7fe), 0xa4);
        EXPECT(gbc.readMem(0xb7ff), 0x51);
        // F7 001A
        gbc.setState(0x6493, 0xa070, 0x4ec0, 0xf9d9, 0x3189, 0x1314, 0x0, 0x1);
        gbc.writeMem(0x6493, { 0xf7 });
        gbc.writeMem(0xa06e, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x4e);
        EXPECT(gbc.b(),  0xf9);
        EXPECT(gbc.c(),  0xd9);
        EXPECT(gbc.d(),  0x31);
        EXPECT(gbc.e(),  0x89);
        EXPECT(gbc.h(),  0x13);
        EXPECT(gbc.l(),  0x14);
        EXPECT(gbc.sp(), 0xa06e);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa06e), 0x94);
        EXPECT(gbc.readMem(0xa06f), 0x64);
        // F7 001D
        gbc.setState(0xa1f8, 0x9880, 0x15b0, 0xee74, 0xe16e, 0xc6af, 0x1, 0x0);
        gbc.writeMem(0x987e, { 0x0, 0x0 });
        gbc.writeMem(0xa1f8, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x15);
        EXPECT(gbc.b(),  0xee);
        EXPECT(gbc.c(),  0x74);
        EXPECT(gbc.d(),  0xe1);
        EXPECT(gbc.e(),  0x6e);
        EXPECT(gbc.h(),  0xc6);
        EXPECT(gbc.l(),  0xaf);
        EXPECT(gbc.sp(), 0x987e);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x987e), 0xf9);
        EXPECT(gbc.readMem(0x987f), 0xa1);
        EXPECT(gbc.readMem(0xa1f8), 0xf7);
        // F7 001F
        gbc.setState(0xc46, 0xe223, 0xfa60, 0xae0e, 0x76e0, 0xc0bf, 0x0, 0x1);
        gbc.writeMem(0xc46, { 0xf7 });
        gbc.writeMem(0xe221, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xfa);
        EXPECT(gbc.b(),  0xae);
        EXPECT(gbc.c(),  0xe);
        EXPECT(gbc.d(),  0x76);
        EXPECT(gbc.e(),  0xe0);
        EXPECT(gbc.h(),  0xc0);
        EXPECT(gbc.l(),  0xbf);
        EXPECT(gbc.sp(), 0xe221);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe221), 0x47);
        EXPECT(gbc.readMem(0xe222), 0xc);
        // F7 0020
        gbc.setState(0xa5b7, 0xda0b, 0x2f0, 0xa04f, 0xaf46, 0x76a4, 0x1, 0x0);
        gbc.writeMem(0xa5b7, { 0xf7 });
        gbc.writeMem(0xda09, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0xa0);
        EXPECT(gbc.c(),  0x4f);
        EXPECT(gbc.d(),  0xaf);
        EXPECT(gbc.e(),  0x46);
        EXPECT(gbc.h(),  0x76);
        EXPECT(gbc.l(),  0xa4);
        EXPECT(gbc.sp(), 0xda09);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa5b7), 0xf7);
        EXPECT(gbc.readMem(0xda09), 0xb8);
        EXPECT(gbc.readMem(0xda0a), 0xa5);
        // F7 0022
        gbc.setState(0x8f24, 0xf8f5, 0x6010, 0xeb3b, 0x39d4, 0x90db, 0x0, 0x1);
        gbc.writeMem(0x8f24, { 0xf7 });
        gbc.writeMem(0xf8f3, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x60);
        EXPECT(gbc.b(),  0xeb);
        EXPECT(gbc.c(),  0x3b);
        EXPECT(gbc.d(),  0x39);
        EXPECT(gbc.e(),  0xd4);
        EXPECT(gbc.h(),  0x90);
        EXPECT(gbc.l(),  0xdb);
        EXPECT(gbc.sp(), 0xf8f3);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8f24), 0xf7);
        EXPECT(gbc.readMem(0xf8f3), 0x25);
        EXPECT(gbc.readMem(0xf8f4), 0x8f);
        // F7 0023
        gbc.setState(0x27de, 0xeef7, 0xae0, 0x6d15, 0x1458, 0x269b, 0x1, 0x0);
        gbc.writeMem(0x27de, { 0xf7 });
        gbc.writeMem(0xeef5, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xa);
        EXPECT(gbc.b(),  0x6d);
        EXPECT(gbc.c(),  0x15);
        EXPECT(gbc.d(),  0x14);
        EXPECT(gbc.e(),  0x58);
        EXPECT(gbc.h(),  0x26);
        EXPECT(gbc.l(),  0x9b);
        EXPECT(gbc.sp(), 0xeef5);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xeef5), 0xdf);
        EXPECT(gbc.readMem(0xeef6), 0x27);
        // F7 0026
        gbc.setState(0xb806, 0xcd38, 0x8470, 0x3734, 0x3558, 0x3035, 0x0, 0x0);
        gbc.writeMem(0xb806, { 0xf7 });
        gbc.writeMem(0xcd36, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x84);
        EXPECT(gbc.b(),  0x37);
        EXPECT(gbc.c(),  0x34);
        EXPECT(gbc.d(),  0x35);
        EXPECT(gbc.e(),  0x58);
        EXPECT(gbc.h(),  0x30);
        EXPECT(gbc.l(),  0x35);
        EXPECT(gbc.sp(), 0xcd36);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb806), 0xf7);
        EXPECT(gbc.readMem(0xcd36), 0x7);
        EXPECT(gbc.readMem(0xcd37), 0xb8);
        // F7 0027
        gbc.setState(0x5d42, 0xdf1d, 0xd8f0, 0x9ec7, 0xdf91, 0x7312, 0x0, 0x1);
        gbc.writeMem(0x5d42, { 0xf7 });
        gbc.writeMem(0xdf1b, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xd8);
        EXPECT(gbc.b(),  0x9e);
        EXPECT(gbc.c(),  0xc7);
        EXPECT(gbc.d(),  0xdf);
        EXPECT(gbc.e(),  0x91);
        EXPECT(gbc.h(),  0x73);
        EXPECT(gbc.l(),  0x12);
        EXPECT(gbc.sp(), 0xdf1b);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xdf1b), 0x43);
        EXPECT(gbc.readMem(0xdf1c), 0x5d);
        // F7 0028
        gbc.setState(0x3e81, 0xb791, 0xd2f0, 0x7357, 0x4afb, 0x29d9, 0x1, 0x0);
        gbc.writeMem(0x3e81, { 0xf7 });
        gbc.writeMem(0xb78f, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xd2);
        EXPECT(gbc.b(),  0x73);
        EXPECT(gbc.c(),  0x57);
        EXPECT(gbc.d(),  0x4a);
        EXPECT(gbc.e(),  0xfb);
        EXPECT(gbc.h(),  0x29);
        EXPECT(gbc.l(),  0xd9);
        EXPECT(gbc.sp(), 0xb78f);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb78f), 0x82);
        EXPECT(gbc.readMem(0xb790), 0x3e);
        // F7 002A
        gbc.setState(0x793e, 0x92a8, 0xa8c0, 0x56d8, 0xd38, 0xa753, 0x0, 0x1);
        gbc.writeMem(0x793e, { 0xf7 });
        gbc.writeMem(0x92a6, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xa8);
        EXPECT(gbc.b(),  0x56);
        EXPECT(gbc.c(),  0xd8);
        EXPECT(gbc.d(),  0xd);
        EXPECT(gbc.e(),  0x38);
        EXPECT(gbc.h(),  0xa7);
        EXPECT(gbc.l(),  0x53);
        EXPECT(gbc.sp(), 0x92a6);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x92a6), 0x3f);
        EXPECT(gbc.readMem(0x92a7), 0x79);
        // F7 002D
        gbc.setState(0x951b, 0xd8b4, 0x92b0, 0x9bad, 0x1c3b, 0xf0d3, 0x0, 0x0);
        gbc.writeMem(0x951b, { 0xf7 });
        gbc.writeMem(0xd8b2, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x92);
        EXPECT(gbc.b(),  0x9b);
        EXPECT(gbc.c(),  0xad);
        EXPECT(gbc.d(),  0x1c);
        EXPECT(gbc.e(),  0x3b);
        EXPECT(gbc.h(),  0xf0);
        EXPECT(gbc.l(),  0xd3);
        EXPECT(gbc.sp(), 0xd8b2);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x951b), 0xf7);
        EXPECT(gbc.readMem(0xd8b2), 0x1c);
        EXPECT(gbc.readMem(0xd8b3), 0x95);
        // F7 002F
        gbc.setState(0x7d8a, 0xca1b, 0x63e0, 0xa735, 0xcf14, 0xa5d, 0x0, 0x0);
        gbc.writeMem(0x7d8a, { 0xf7 });
        gbc.writeMem(0xca19, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x63);
        EXPECT(gbc.b(),  0xa7);
        EXPECT(gbc.c(),  0x35);
        EXPECT(gbc.d(),  0xcf);
        EXPECT(gbc.e(),  0x14);
        EXPECT(gbc.h(),  0xa);
        EXPECT(gbc.l(),  0x5d);
        EXPECT(gbc.sp(), 0xca19);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xca19), 0x8b);
        EXPECT(gbc.readMem(0xca1a), 0x7d);
        // F7 0030
        gbc.setState(0x7b92, 0xa8e4, 0x3d30, 0xc96e, 0x6a0, 0xa4a, 0x1, 0x0);
        gbc.writeMem(0x7b92, { 0xf7 });
        gbc.writeMem(0xa8e2, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x3d);
        EXPECT(gbc.b(),  0xc9);
        EXPECT(gbc.c(),  0x6e);
        EXPECT(gbc.d(),  0x6);
        EXPECT(gbc.e(),  0xa0);
        EXPECT(gbc.h(),  0xa);
        EXPECT(gbc.l(),  0x4a);
        EXPECT(gbc.sp(), 0xa8e2);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa8e2), 0x93);
        EXPECT(gbc.readMem(0xa8e3), 0x7b);
        // F7 0031
        gbc.setState(0xe714, 0xbff4, 0xb6d0, 0x25e9, 0xdea, 0xdf3d, 0x1, 0x0);
        gbc.writeMem(0xbff2, { 0x0, 0x0 });
        gbc.writeMem(0xe714, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xb6);
        EXPECT(gbc.b(),  0x25);
        EXPECT(gbc.c(),  0xe9);
        EXPECT(gbc.d(),  0xd);
        EXPECT(gbc.e(),  0xea);
        EXPECT(gbc.h(),  0xdf);
        EXPECT(gbc.l(),  0x3d);
        EXPECT(gbc.sp(), 0xbff2);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbff2), 0x15);
        EXPECT(gbc.readMem(0xbff3), 0xe7);
        EXPECT(gbc.readMem(0xe714), 0xf7);
        // F7 0033
        gbc.setState(0xcc, 0xca05, 0xa9f0, 0x13ef, 0x957c, 0x25f8, 0x0, 0x0);
        gbc.writeMem(0xcc, { 0xf7 });
        gbc.writeMem(0xca03, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xa9);
        EXPECT(gbc.b(),  0x13);
        EXPECT(gbc.c(),  0xef);
        EXPECT(gbc.d(),  0x95);
        EXPECT(gbc.e(),  0x7c);
        EXPECT(gbc.h(),  0x25);
        EXPECT(gbc.l(),  0xf8);
        EXPECT(gbc.sp(), 0xca03);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xca03), 0xcd);
        EXPECT(gbc.readMem(0xca04), 0x0);
        // F7 0034
        gbc.setState(0xa06d, 0xa6f2, 0x3b30, 0xa1d, 0x557b, 0x3e71, 0x0, 0x0);
        gbc.writeMem(0xa06d, { 0xf7 });
        gbc.writeMem(0xa6f0, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x3b);
        EXPECT(gbc.b(),  0xa);
        EXPECT(gbc.c(),  0x1d);
        EXPECT(gbc.d(),  0x55);
        EXPECT(gbc.e(),  0x7b);
        EXPECT(gbc.h(),  0x3e);
        EXPECT(gbc.l(),  0x71);
        EXPECT(gbc.sp(), 0xa6f0);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa06d), 0xf7);
        EXPECT(gbc.readMem(0xa6f0), 0x6e);
        EXPECT(gbc.readMem(0xa6f1), 0xa0);
        // F7 0036
        gbc.setState(0xccdb, 0xce36, 0xe7a0, 0x3263, 0xbff9, 0x5f1b, 0x0, 0x0);
        gbc.writeMem(0xccdb, { 0xf7 });
        gbc.writeMem(0xce34, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xe7);
        EXPECT(gbc.b(),  0x32);
        EXPECT(gbc.c(),  0x63);
        EXPECT(gbc.d(),  0xbf);
        EXPECT(gbc.e(),  0xf9);
        EXPECT(gbc.h(),  0x5f);
        EXPECT(gbc.l(),  0x1b);
        EXPECT(gbc.sp(), 0xce34);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xccdb), 0xf7);
        EXPECT(gbc.readMem(0xce34), 0xdc);
        EXPECT(gbc.readMem(0xce35), 0xcc);
        // F7 0038
        gbc.setState(0xab36, 0xa4d9, 0x1e80, 0xd406, 0x169b, 0xc9c0, 0x1, 0x0);
        gbc.writeMem(0xa4d7, { 0x0, 0x0 });
        gbc.writeMem(0xab36, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x1e);
        EXPECT(gbc.b(),  0xd4);
        EXPECT(gbc.c(),  0x6);
        EXPECT(gbc.d(),  0x16);
        EXPECT(gbc.e(),  0x9b);
        EXPECT(gbc.h(),  0xc9);
        EXPECT(gbc.l(),  0xc0);
        EXPECT(gbc.sp(), 0xa4d7);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa4d7), 0x37);
        EXPECT(gbc.readMem(0xa4d8), 0xab);
        EXPECT(gbc.readMem(0xab36), 0xf7);
        // F7 0039
        gbc.setState(0x33fa, 0xfc0c, 0x5a60, 0xdcbf, 0x1390, 0x5982, 0x0, 0x1);
        gbc.writeMem(0x33fa, { 0xf7 });
        gbc.writeMem(0xfc0a, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x5a);
        EXPECT(gbc.b(),  0xdc);
        EXPECT(gbc.c(),  0xbf);
        EXPECT(gbc.d(),  0x13);
        EXPECT(gbc.e(),  0x90);
        EXPECT(gbc.h(),  0x59);
        EXPECT(gbc.l(),  0x82);
        EXPECT(gbc.sp(), 0xfc0a);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xfc0a), 0xfb);
        EXPECT(gbc.readMem(0xfc0b), 0x33);
        // F7 003A
        gbc.setState(0x474b, 0xabc3, 0xbba0, 0x6a02, 0x40db, 0xf616, 0x1, 0x1);
        gbc.writeMem(0x474b, { 0xf7 });
        gbc.writeMem(0xabc1, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xbb);
        EXPECT(gbc.b(),  0x6a);
        EXPECT(gbc.c(),  0x2);
        EXPECT(gbc.d(),  0x40);
        EXPECT(gbc.e(),  0xdb);
        EXPECT(gbc.h(),  0xf6);
        EXPECT(gbc.l(),  0x16);
        EXPECT(gbc.sp(), 0xabc1);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xabc1), 0x4c);
        EXPECT(gbc.readMem(0xabc2), 0x47);
        // F7 003B
        gbc.setState(0x868d, 0xd3ee, 0xae90, 0xc68b, 0xdda4, 0x75a3, 0x0, 0x1);
        gbc.writeMem(0x868d, { 0xf7 });
        gbc.writeMem(0xd3ec, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xae);
        EXPECT(gbc.b(),  0xc6);
        EXPECT(gbc.c(),  0x8b);
        EXPECT(gbc.d(),  0xdd);
        EXPECT(gbc.e(),  0xa4);
        EXPECT(gbc.h(),  0x75);
        EXPECT(gbc.l(),  0xa3);
        EXPECT(gbc.sp(), 0xd3ec);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x868d), 0xf7);
        EXPECT(gbc.readMem(0xd3ec), 0x8e);
        EXPECT(gbc.readMem(0xd3ed), 0x86);
        // F7 003D
        gbc.setState(0xb3a6, 0x8024, 0x8b00, 0x46b2, 0x9892, 0x3f1e, 0x0, 0x1);
        gbc.writeMem(0x8022, { 0x0, 0x0 });
        gbc.writeMem(0xb3a6, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x8b);
        EXPECT(gbc.b(),  0x46);
        EXPECT(gbc.c(),  0xb2);
        EXPECT(gbc.d(),  0x98);
        EXPECT(gbc.e(),  0x92);
        EXPECT(gbc.h(),  0x3f);
        EXPECT(gbc.l(),  0x1e);
        EXPECT(gbc.sp(), 0x8022);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8022), 0xa7);
        EXPECT(gbc.readMem(0x8023), 0xb3);
        EXPECT(gbc.readMem(0xb3a6), 0xf7);
        // F7 003E
        gbc.setState(0xc8a5, 0xba05, 0xef30, 0x4134, 0x43d9, 0x1f3d, 0x0, 0x0);
        gbc.writeMem(0xba03, { 0x0, 0x0 });
        gbc.writeMem(0xc8a5, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xef);
        EXPECT(gbc.b(),  0x41);
        EXPECT(gbc.c(),  0x34);
        EXPECT(gbc.d(),  0x43);
        EXPECT(gbc.e(),  0xd9);
        EXPECT(gbc.h(),  0x1f);
        EXPECT(gbc.l(),  0x3d);
        EXPECT(gbc.sp(), 0xba03);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xba03), 0xa6);
        EXPECT(gbc.readMem(0xba04), 0xc8);
        EXPECT(gbc.readMem(0xc8a5), 0xf7);
        // F7 003F
        gbc.setState(0xed13, 0xcb7b, 0x1fa0, 0x9b1b, 0xeee1, 0x7ccb, 0x0, 0x1);
        gbc.writeMem(0xcb79, { 0x0, 0x0 });
        gbc.writeMem(0xed13, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x1f);
        EXPECT(gbc.b(),  0x9b);
        EXPECT(gbc.c(),  0x1b);
        EXPECT(gbc.d(),  0xee);
        EXPECT(gbc.e(),  0xe1);
        EXPECT(gbc.h(),  0x7c);
        EXPECT(gbc.l(),  0xcb);
        EXPECT(gbc.sp(), 0xcb79);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcb79), 0x14);
        EXPECT(gbc.readMem(0xcb7a), 0xed);
        EXPECT(gbc.readMem(0xed13), 0xf7);
        // F7 0040
        gbc.setState(0xb9a1, 0xecac, 0x8360, 0xfa2f, 0x151b, 0x53fc, 0x0, 0x1);
        gbc.writeMem(0xb9a1, { 0xf7 });
        gbc.writeMem(0xecaa, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x83);
        EXPECT(gbc.b(),  0xfa);
        EXPECT(gbc.c(),  0x2f);
        EXPECT(gbc.d(),  0x15);
        EXPECT(gbc.e(),  0x1b);
        EXPECT(gbc.h(),  0x53);
        EXPECT(gbc.l(),  0xfc);
        EXPECT(gbc.sp(), 0xecaa);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb9a1), 0xf7);
        EXPECT(gbc.readMem(0xecaa), 0xa2);
        EXPECT(gbc.readMem(0xecab), 0xb9);
        // F7 0042
        gbc.setState(0x3594, 0xe30c, 0xfdb0, 0x1bf5, 0x72d9, 0xfb21, 0x1, 0x1);
        gbc.writeMem(0x3594, { 0xf7 });
        gbc.writeMem(0xe30a, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xfd);
        EXPECT(gbc.b(),  0x1b);
        EXPECT(gbc.c(),  0xf5);
        EXPECT(gbc.d(),  0x72);
        EXPECT(gbc.e(),  0xd9);
        EXPECT(gbc.h(),  0xfb);
        EXPECT(gbc.l(),  0x21);
        EXPECT(gbc.sp(), 0xe30a);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe30a), 0x95);
        EXPECT(gbc.readMem(0xe30b), 0x35);
        // F7 0043
        gbc.setState(0x2ad, 0xd7dd, 0x5bd0, 0x4227, 0x9486, 0xa46f, 0x0, 0x0);
        gbc.writeMem(0x2ad, { 0xf7 });
        gbc.writeMem(0xd7db, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x5b);
        EXPECT(gbc.b(),  0x42);
        EXPECT(gbc.c(),  0x27);
        EXPECT(gbc.d(),  0x94);
        EXPECT(gbc.e(),  0x86);
        EXPECT(gbc.h(),  0xa4);
        EXPECT(gbc.l(),  0x6f);
        EXPECT(gbc.sp(), 0xd7db);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd7db), 0xae);
        EXPECT(gbc.readMem(0xd7dc), 0x2);
        // F7 0044
        gbc.setState(0x2041, 0xb966, 0xd370, 0x618, 0x3164, 0xb887, 0x1, 0x0);
        gbc.writeMem(0x2041, { 0xf7 });
        gbc.writeMem(0xb964, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xd3);
        EXPECT(gbc.b(),  0x6);
        EXPECT(gbc.c(),  0x18);
        EXPECT(gbc.d(),  0x31);
        EXPECT(gbc.e(),  0x64);
        EXPECT(gbc.h(),  0xb8);
        EXPECT(gbc.l(),  0x87);
        EXPECT(gbc.sp(), 0xb964);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb964), 0x42);
        EXPECT(gbc.readMem(0xb965), 0x20);
        // F7 0046
        gbc.setState(0xd7d1, 0x925f, 0xf390, 0x6a98, 0xc440, 0xe302, 0x1, 0x0);
        gbc.writeMem(0x925d, { 0x0, 0x0 });
        gbc.writeMem(0xd7d1, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xf3);
        EXPECT(gbc.b(),  0x6a);
        EXPECT(gbc.c(),  0x98);
        EXPECT(gbc.d(),  0xc4);
        EXPECT(gbc.e(),  0x40);
        EXPECT(gbc.h(),  0xe3);
        EXPECT(gbc.l(),  0x2);
        EXPECT(gbc.sp(), 0x925d);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x925d), 0xd2);
        EXPECT(gbc.readMem(0x925e), 0xd7);
        EXPECT(gbc.readMem(0xd7d1), 0xf7);
        // F7 0047
        gbc.setState(0x1abe, 0xfa41, 0x1090, 0x6e83, 0x9692, 0xbf47, 0x0, 0x1);
        gbc.writeMem(0x1abe, { 0xf7 });
        gbc.writeMem(0xfa3f, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0x6e);
        EXPECT(gbc.c(),  0x83);
        EXPECT(gbc.d(),  0x96);
        EXPECT(gbc.e(),  0x92);
        EXPECT(gbc.h(),  0xbf);
        EXPECT(gbc.l(),  0x47);
        EXPECT(gbc.sp(), 0xfa3f);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xfa3f), 0xbf);
        EXPECT(gbc.readMem(0xfa40), 0x1a);
        // F7 0049
        gbc.setState(0x87ec, 0xa9f6, 0x800, 0xbb3a, 0xc759, 0x7fa9, 0x1, 0x1);
        gbc.writeMem(0x87ec, { 0xf7 });
        gbc.writeMem(0xa9f4, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0xbb);
        EXPECT(gbc.c(),  0x3a);
        EXPECT(gbc.d(),  0xc7);
        EXPECT(gbc.e(),  0x59);
        EXPECT(gbc.h(),  0x7f);
        EXPECT(gbc.l(),  0xa9);
        EXPECT(gbc.sp(), 0xa9f4);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x87ec), 0xf7);
        EXPECT(gbc.readMem(0xa9f4), 0xed);
        EXPECT(gbc.readMem(0xa9f5), 0x87);
        // F7 004B
        gbc.setState(0x31dc, 0xdc85, 0xb340, 0x3d57, 0x92a0, 0xdf39, 0x1, 0x0);
        gbc.writeMem(0x31dc, { 0xf7 });
        gbc.writeMem(0xdc83, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xb3);
        EXPECT(gbc.b(),  0x3d);
        EXPECT(gbc.c(),  0x57);
        EXPECT(gbc.d(),  0x92);
        EXPECT(gbc.e(),  0xa0);
        EXPECT(gbc.h(),  0xdf);
        EXPECT(gbc.l(),  0x39);
        EXPECT(gbc.sp(), 0xdc83);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdc83), 0xdd);
        EXPECT(gbc.readMem(0xdc84), 0x31);
        // F7 004D
        gbc.setState(0x1a94, 0xd801, 0x1a30, 0x1662, 0xd83e, 0x539c, 0x1, 0x1);
        gbc.writeMem(0x1a94, { 0xf7 });
        gbc.writeMem(0xd7ff, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x1a);
        EXPECT(gbc.b(),  0x16);
        EXPECT(gbc.c(),  0x62);
        EXPECT(gbc.d(),  0xd8);
        EXPECT(gbc.e(),  0x3e);
        EXPECT(gbc.h(),  0x53);
        EXPECT(gbc.l(),  0x9c);
        EXPECT(gbc.sp(), 0xd7ff);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd7ff), 0x95);
        EXPECT(gbc.readMem(0xd800), 0x1a);
        // F7 0050
        gbc.setState(0xaa5a, 0xefaf, 0xbe30, 0x6846, 0xecbf, 0xb45d, 0x1, 0x0);
        gbc.writeMem(0xaa5a, { 0xf7 });
        gbc.writeMem(0xefad, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xbe);
        EXPECT(gbc.b(),  0x68);
        EXPECT(gbc.c(),  0x46);
        EXPECT(gbc.d(),  0xec);
        EXPECT(gbc.e(),  0xbf);
        EXPECT(gbc.h(),  0xb4);
        EXPECT(gbc.l(),  0x5d);
        EXPECT(gbc.sp(), 0xefad);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xaa5a), 0xf7);
        EXPECT(gbc.readMem(0xefad), 0x5b);
        EXPECT(gbc.readMem(0xefae), 0xaa);
        // F7 0056
        gbc.setState(0x692, 0x927c, 0x68d0, 0xe3ee, 0x6568, 0x4d96, 0x0, 0x1);
        gbc.writeMem(0x692, { 0xf7 });
        gbc.writeMem(0x927a, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x68);
        EXPECT(gbc.b(),  0xe3);
        EXPECT(gbc.c(),  0xee);
        EXPECT(gbc.d(),  0x65);
        EXPECT(gbc.e(),  0x68);
        EXPECT(gbc.h(),  0x4d);
        EXPECT(gbc.l(),  0x96);
        EXPECT(gbc.sp(), 0x927a);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x927a), 0x93);
        EXPECT(gbc.readMem(0x927b), 0x6);
        // F7 0057
        gbc.setState(0x879a, 0xc4da, 0x6df0, 0x5267, 0x175a, 0xc751, 0x1, 0x1);
        gbc.writeMem(0x879a, { 0xf7 });
        gbc.writeMem(0xc4d8, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x6d);
        EXPECT(gbc.b(),  0x52);
        EXPECT(gbc.c(),  0x67);
        EXPECT(gbc.d(),  0x17);
        EXPECT(gbc.e(),  0x5a);
        EXPECT(gbc.h(),  0xc7);
        EXPECT(gbc.l(),  0x51);
        EXPECT(gbc.sp(), 0xc4d8);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x879a), 0xf7);
        EXPECT(gbc.readMem(0xc4d8), 0x9b);
        EXPECT(gbc.readMem(0xc4d9), 0x87);
        // F7 005D
        gbc.setState(0x18fd, 0xd90b, 0x5a10, 0x8909, 0xc278, 0x8968, 0x1, 0x1);
        gbc.writeMem(0x18fd, { 0xf7 });
        gbc.writeMem(0xd909, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x5a);
        EXPECT(gbc.b(),  0x89);
        EXPECT(gbc.c(),  0x9);
        EXPECT(gbc.d(),  0xc2);
        EXPECT(gbc.e(),  0x78);
        EXPECT(gbc.h(),  0x89);
        EXPECT(gbc.l(),  0x68);
        EXPECT(gbc.sp(), 0xd909);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd909), 0xfe);
        EXPECT(gbc.readMem(0xd90a), 0x18);
        // F7 005E
        gbc.setState(0xbb1d, 0xf56a, 0x5ae0, 0x8614, 0xf278, 0x521a, 0x1, 0x1);
        gbc.writeMem(0xbb1d, { 0xf7 });
        gbc.writeMem(0xf568, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x5a);
        EXPECT(gbc.b(),  0x86);
        EXPECT(gbc.c(),  0x14);
        EXPECT(gbc.d(),  0xf2);
        EXPECT(gbc.e(),  0x78);
        EXPECT(gbc.h(),  0x52);
        EXPECT(gbc.l(),  0x1a);
        EXPECT(gbc.sp(), 0xf568);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbb1d), 0xf7);
        EXPECT(gbc.readMem(0xf568), 0x1e);
        EXPECT(gbc.readMem(0xf569), 0xbb);
        // F7 0061
        gbc.setState(0x2cee, 0x88a1, 0x6fc0, 0xcc12, 0x73f, 0x2eeb, 0x0, 0x1);
        gbc.writeMem(0x2cee, { 0xf7 });
        gbc.writeMem(0x889f, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x6f);
        EXPECT(gbc.b(),  0xcc);
        EXPECT(gbc.c(),  0x12);
        EXPECT(gbc.d(),  0x7);
        EXPECT(gbc.e(),  0x3f);
        EXPECT(gbc.h(),  0x2e);
        EXPECT(gbc.l(),  0xeb);
        EXPECT(gbc.sp(), 0x889f);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x889f), 0xef);
        EXPECT(gbc.readMem(0x88a0), 0x2c);
        // F7 0063
        gbc.setState(0x8723, 0xcd76, 0x7b40, 0xb167, 0xe53c, 0x922c, 0x1, 0x0);
        gbc.writeMem(0x8723, { 0xf7 });
        gbc.writeMem(0xcd74, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x7b);
        EXPECT(gbc.b(),  0xb1);
        EXPECT(gbc.c(),  0x67);
        EXPECT(gbc.d(),  0xe5);
        EXPECT(gbc.e(),  0x3c);
        EXPECT(gbc.h(),  0x92);
        EXPECT(gbc.l(),  0x2c);
        EXPECT(gbc.sp(), 0xcd74);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8723), 0xf7);
        EXPECT(gbc.readMem(0xcd74), 0x24);
        EXPECT(gbc.readMem(0xcd75), 0x87);
        // F7 0064
        gbc.setState(0x6fe5, 0xc6dc, 0x3620, 0x2d22, 0xd9e3, 0xb08d, 0x0, 0x0);
        gbc.writeMem(0x6fe5, { 0xf7 });
        gbc.writeMem(0xc6da, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x36);
        EXPECT(gbc.b(),  0x2d);
        EXPECT(gbc.c(),  0x22);
        EXPECT(gbc.d(),  0xd9);
        EXPECT(gbc.e(),  0xe3);
        EXPECT(gbc.h(),  0xb0);
        EXPECT(gbc.l(),  0x8d);
        EXPECT(gbc.sp(), 0xc6da);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc6da), 0xe6);
        EXPECT(gbc.readMem(0xc6db), 0x6f);
        // F7 0065
        gbc.setState(0x8906, 0xee64, 0xa990, 0x641b, 0x5906, 0xf732, 0x0, 0x0);
        gbc.writeMem(0x8906, { 0xf7 });
        gbc.writeMem(0xee62, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xa9);
        EXPECT(gbc.b(),  0x64);
        EXPECT(gbc.c(),  0x1b);
        EXPECT(gbc.d(),  0x59);
        EXPECT(gbc.e(),  0x6);
        EXPECT(gbc.h(),  0xf7);
        EXPECT(gbc.l(),  0x32);
        EXPECT(gbc.sp(), 0xee62);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8906), 0xf7);
        EXPECT(gbc.readMem(0xee62), 0x7);
        EXPECT(gbc.readMem(0xee63), 0x89);
        // F7 0069
        gbc.setState(0x514a, 0xc015, 0x81e0, 0xf53d, 0x6310, 0x3f0b, 0x0, 0x1);
        gbc.writeMem(0x514a, { 0xf7 });
        gbc.writeMem(0xc013, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x81);
        EXPECT(gbc.b(),  0xf5);
        EXPECT(gbc.c(),  0x3d);
        EXPECT(gbc.d(),  0x63);
        EXPECT(gbc.e(),  0x10);
        EXPECT(gbc.h(),  0x3f);
        EXPECT(gbc.l(),  0xb);
        EXPECT(gbc.sp(), 0xc013);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc013), 0x4b);
        EXPECT(gbc.readMem(0xc014), 0x51);
        // F7 006C
        gbc.setState(0x4e35, 0xc8b5, 0xd8f0, 0xd813, 0x48e2, 0xf84f, 0x1, 0x0);
        gbc.writeMem(0x4e35, { 0xf7 });
        gbc.writeMem(0xc8b3, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xd8);
        EXPECT(gbc.b(),  0xd8);
        EXPECT(gbc.c(),  0x13);
        EXPECT(gbc.d(),  0x48);
        EXPECT(gbc.e(),  0xe2);
        EXPECT(gbc.h(),  0xf8);
        EXPECT(gbc.l(),  0x4f);
        EXPECT(gbc.sp(), 0xc8b3);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc8b3), 0x36);
        EXPECT(gbc.readMem(0xc8b4), 0x4e);
        // F7 006D
        gbc.setState(0x2fb2, 0xc01b, 0x9b80, 0xed49, 0x206a, 0x1077, 0x0, 0x1);
        gbc.writeMem(0x2fb2, { 0xf7 });
        gbc.writeMem(0xc019, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x9b);
        EXPECT(gbc.b(),  0xed);
        EXPECT(gbc.c(),  0x49);
        EXPECT(gbc.d(),  0x20);
        EXPECT(gbc.e(),  0x6a);
        EXPECT(gbc.h(),  0x10);
        EXPECT(gbc.l(),  0x77);
        EXPECT(gbc.sp(), 0xc019);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc019), 0xb3);
        EXPECT(gbc.readMem(0xc01a), 0x2f);
        // F7 006F
        gbc.setState(0x90df, 0xe712, 0x69c0, 0x9d7, 0x4729, 0x4e22, 0x1, 0x1);
        gbc.writeMem(0x90df, { 0xf7 });
        gbc.writeMem(0xe710, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x69);
        EXPECT(gbc.b(),  0x9);
        EXPECT(gbc.c(),  0xd7);
        EXPECT(gbc.d(),  0x47);
        EXPECT(gbc.e(),  0x29);
        EXPECT(gbc.h(),  0x4e);
        EXPECT(gbc.l(),  0x22);
        EXPECT(gbc.sp(), 0xe710);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x90df), 0xf7);
        EXPECT(gbc.readMem(0xe710), 0xe0);
        EXPECT(gbc.readMem(0xe711), 0x90);
        // F7 0070
        gbc.setState(0xcf1d, 0xd971, 0xe670, 0xc576, 0xb2bd, 0x391, 0x0, 0x1);
        gbc.writeMem(0xcf1d, { 0xf7 });
        gbc.writeMem(0xd96f, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xe6);
        EXPECT(gbc.b(),  0xc5);
        EXPECT(gbc.c(),  0x76);
        EXPECT(gbc.d(),  0xb2);
        EXPECT(gbc.e(),  0xbd);
        EXPECT(gbc.h(),  0x3);
        EXPECT(gbc.l(),  0x91);
        EXPECT(gbc.sp(), 0xd96f);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcf1d), 0xf7);
        EXPECT(gbc.readMem(0xd96f), 0x1e);
        EXPECT(gbc.readMem(0xd970), 0xcf);
        // F7 0073
        gbc.setState(0xd905, 0xf4ca, 0x2180, 0x2c26, 0xd333, 0x2b14, 0x1, 0x1);
        gbc.writeMem(0xd905, { 0xf7 });
        gbc.writeMem(0xf4c8, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x21);
        EXPECT(gbc.b(),  0x2c);
        EXPECT(gbc.c(),  0x26);
        EXPECT(gbc.d(),  0xd3);
        EXPECT(gbc.e(),  0x33);
        EXPECT(gbc.h(),  0x2b);
        EXPECT(gbc.l(),  0x14);
        EXPECT(gbc.sp(), 0xf4c8);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd905), 0xf7);
        EXPECT(gbc.readMem(0xf4c8), 0x6);
        EXPECT(gbc.readMem(0xf4c9), 0xd9);
        // F7 0074
        gbc.setState(0x1659, 0x95ac, 0x7040, 0xc173, 0x1a71, 0x3c8b, 0x0, 0x1);
        gbc.writeMem(0x1659, { 0xf7 });
        gbc.writeMem(0x95aa, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x70);
        EXPECT(gbc.b(),  0xc1);
        EXPECT(gbc.c(),  0x73);
        EXPECT(gbc.d(),  0x1a);
        EXPECT(gbc.e(),  0x71);
        EXPECT(gbc.h(),  0x3c);
        EXPECT(gbc.l(),  0x8b);
        EXPECT(gbc.sp(), 0x95aa);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x95aa), 0x5a);
        EXPECT(gbc.readMem(0x95ab), 0x16);
        // F7 0076
        gbc.setState(0x501f, 0x9d98, 0x62a0, 0x4977, 0xefa3, 0x830d, 0x1, 0x1);
        gbc.writeMem(0x501f, { 0xf7 });
        gbc.writeMem(0x9d96, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x62);
        EXPECT(gbc.b(),  0x49);
        EXPECT(gbc.c(),  0x77);
        EXPECT(gbc.d(),  0xef);
        EXPECT(gbc.e(),  0xa3);
        EXPECT(gbc.h(),  0x83);
        EXPECT(gbc.l(),  0xd);
        EXPECT(gbc.sp(), 0x9d96);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9d96), 0x20);
        EXPECT(gbc.readMem(0x9d97), 0x50);
        // F7 0077
        gbc.setState(0x10e8, 0xcb65, 0x4310, 0x9a03, 0x4f54, 0x2162, 0x1, 0x1);
        gbc.writeMem(0x10e8, { 0xf7 });
        gbc.writeMem(0xcb63, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x43);
        EXPECT(gbc.b(),  0x9a);
        EXPECT(gbc.c(),  0x3);
        EXPECT(gbc.d(),  0x4f);
        EXPECT(gbc.e(),  0x54);
        EXPECT(gbc.h(),  0x21);
        EXPECT(gbc.l(),  0x62);
        EXPECT(gbc.sp(), 0xcb63);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcb63), 0xe9);
        EXPECT(gbc.readMem(0xcb64), 0x10);
        // F7 0078
        gbc.setState(0x32be, 0xfe16, 0x9b10, 0xcc3b, 0xc18a, 0xf6f5, 0x1, 0x0);
        gbc.writeMem(0x32be, { 0xf7 });
        gbc.writeMem(0xfe14, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x9b);
        EXPECT(gbc.b(),  0xcc);
        EXPECT(gbc.c(),  0x3b);
        EXPECT(gbc.d(),  0xc1);
        EXPECT(gbc.e(),  0x8a);
        EXPECT(gbc.h(),  0xf6);
        EXPECT(gbc.l(),  0xf5);
        EXPECT(gbc.sp(), 0xfe14);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xfe14), 0xbf);
        EXPECT(gbc.readMem(0xfe15), 0x32);
        // F7 007D
        gbc.setState(0x6eaf, 0xd0e0, 0x44f0, 0xd1e7, 0x2aa7, 0xc2c3, 0x1, 0x0);
        gbc.writeMem(0x6eaf, { 0xf7 });
        gbc.writeMem(0xd0de, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x44);
        EXPECT(gbc.b(),  0xd1);
        EXPECT(gbc.c(),  0xe7);
        EXPECT(gbc.d(),  0x2a);
        EXPECT(gbc.e(),  0xa7);
        EXPECT(gbc.h(),  0xc2);
        EXPECT(gbc.l(),  0xc3);
        EXPECT(gbc.sp(), 0xd0de);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd0de), 0xb0);
        EXPECT(gbc.readMem(0xd0df), 0x6e);
        // F7 007E
        gbc.setState(0xd4b1, 0xdb6c, 0x8d60, 0x732a, 0x56fb, 0x16d3, 0x1, 0x1);
        gbc.writeMem(0xd4b1, { 0xf7 });
        gbc.writeMem(0xdb6a, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x8d);
        EXPECT(gbc.b(),  0x73);
        EXPECT(gbc.c(),  0x2a);
        EXPECT(gbc.d(),  0x56);
        EXPECT(gbc.e(),  0xfb);
        EXPECT(gbc.h(),  0x16);
        EXPECT(gbc.l(),  0xd3);
        EXPECT(gbc.sp(), 0xdb6a);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd4b1), 0xf7);
        EXPECT(gbc.readMem(0xdb6a), 0xb2);
        EXPECT(gbc.readMem(0xdb6b), 0xd4);
        // F7 0080
        gbc.setState(0x37b4, 0xd756, 0xa090, 0xf377, 0x6630, 0xcee8, 0x0, 0x1);
        gbc.writeMem(0x37b4, { 0xf7 });
        gbc.writeMem(0xd754, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xa0);
        EXPECT(gbc.b(),  0xf3);
        EXPECT(gbc.c(),  0x77);
        EXPECT(gbc.d(),  0x66);
        EXPECT(gbc.e(),  0x30);
        EXPECT(gbc.h(),  0xce);
        EXPECT(gbc.l(),  0xe8);
        EXPECT(gbc.sp(), 0xd754);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd754), 0xb5);
        EXPECT(gbc.readMem(0xd755), 0x37);
        // F7 0083
        gbc.setState(0xca58, 0xf8bb, 0x1d70, 0x5395, 0xccc5, 0x83bb, 0x1, 0x0);
        gbc.writeMem(0xca58, { 0xf7 });
        gbc.writeMem(0xf8b9, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x1d);
        EXPECT(gbc.b(),  0x53);
        EXPECT(gbc.c(),  0x95);
        EXPECT(gbc.d(),  0xcc);
        EXPECT(gbc.e(),  0xc5);
        EXPECT(gbc.h(),  0x83);
        EXPECT(gbc.l(),  0xbb);
        EXPECT(gbc.sp(), 0xf8b9);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xca58), 0xf7);
        EXPECT(gbc.readMem(0xf8b9), 0x59);
        EXPECT(gbc.readMem(0xf8ba), 0xca);
        // F7 0084
        gbc.setState(0x84b4, 0x8d6c, 0x4e60, 0x43e8, 0x2e31, 0x1820, 0x1, 0x0);
        gbc.writeMem(0x84b4, { 0xf7 });
        gbc.writeMem(0x8d6a, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x4e);
        EXPECT(gbc.b(),  0x43);
        EXPECT(gbc.c(),  0xe8);
        EXPECT(gbc.d(),  0x2e);
        EXPECT(gbc.e(),  0x31);
        EXPECT(gbc.h(),  0x18);
        EXPECT(gbc.l(),  0x20);
        EXPECT(gbc.sp(), 0x8d6a);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x84b4), 0xf7);
        EXPECT(gbc.readMem(0x8d6a), 0xb5);
        EXPECT(gbc.readMem(0x8d6b), 0x84);
        // F7 0085
        gbc.setState(0xa187, 0xc9ac, 0x190, 0x6a46, 0x1400, 0x570a, 0x0, 0x1);
        gbc.writeMem(0xa187, { 0xf7 });
        gbc.writeMem(0xc9aa, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0x6a);
        EXPECT(gbc.c(),  0x46);
        EXPECT(gbc.d(),  0x14);
        EXPECT(gbc.e(),  0x0);
        EXPECT(gbc.h(),  0x57);
        EXPECT(gbc.l(),  0xa);
        EXPECT(gbc.sp(), 0xc9aa);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa187), 0xf7);
        EXPECT(gbc.readMem(0xc9aa), 0x88);
        EXPECT(gbc.readMem(0xc9ab), 0xa1);
        // F7 0089
        gbc.setState(0xb329, 0xc352, 0x51e0, 0x6c45, 0x693a, 0xc6de, 0x0, 0x0);
        gbc.writeMem(0xb329, { 0xf7 });
        gbc.writeMem(0xc350, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x51);
        EXPECT(gbc.b(),  0x6c);
        EXPECT(gbc.c(),  0x45);
        EXPECT(gbc.d(),  0x69);
        EXPECT(gbc.e(),  0x3a);
        EXPECT(gbc.h(),  0xc6);
        EXPECT(gbc.l(),  0xde);
        EXPECT(gbc.sp(), 0xc350);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb329), 0xf7);
        EXPECT(gbc.readMem(0xc350), 0x2a);
        EXPECT(gbc.readMem(0xc351), 0xb3);
        // F7 008A
        gbc.setState(0xe3c6, 0xccb8, 0xfca0, 0xeff9, 0x79b4, 0x6102, 0x1, 0x0);
        gbc.writeMem(0xccb6, { 0x0, 0x0 });
        gbc.writeMem(0xe3c6, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xfc);
        EXPECT(gbc.b(),  0xef);
        EXPECT(gbc.c(),  0xf9);
        EXPECT(gbc.d(),  0x79);
        EXPECT(gbc.e(),  0xb4);
        EXPECT(gbc.h(),  0x61);
        EXPECT(gbc.l(),  0x2);
        EXPECT(gbc.sp(), 0xccb6);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xccb6), 0xc7);
        EXPECT(gbc.readMem(0xccb7), 0xe3);
        EXPECT(gbc.readMem(0xe3c6), 0xf7);
        // F7 008C
        gbc.setState(0xbf83, 0x80f7, 0xb070, 0x2b88, 0xe214, 0xc337, 0x1, 0x0);
        gbc.writeMem(0x80f5, { 0x0, 0x0 });
        gbc.writeMem(0xbf83, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xb0);
        EXPECT(gbc.b(),  0x2b);
        EXPECT(gbc.c(),  0x88);
        EXPECT(gbc.d(),  0xe2);
        EXPECT(gbc.e(),  0x14);
        EXPECT(gbc.h(),  0xc3);
        EXPECT(gbc.l(),  0x37);
        EXPECT(gbc.sp(), 0x80f5);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x80f5), 0x84);
        EXPECT(gbc.readMem(0x80f6), 0xbf);
        EXPECT(gbc.readMem(0xbf83), 0xf7);
        // F7 008D
        gbc.setState(0x37af, 0x97a6, 0x6410, 0x6b05, 0xa01e, 0xfdf8, 0x0, 0x1);
        gbc.writeMem(0x37af, { 0xf7 });
        gbc.writeMem(0x97a4, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x64);
        EXPECT(gbc.b(),  0x6b);
        EXPECT(gbc.c(),  0x5);
        EXPECT(gbc.d(),  0xa0);
        EXPECT(gbc.e(),  0x1e);
        EXPECT(gbc.h(),  0xfd);
        EXPECT(gbc.l(),  0xf8);
        EXPECT(gbc.sp(), 0x97a4);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x97a4), 0xb0);
        EXPECT(gbc.readMem(0x97a5), 0x37);
        // F7 008E
        gbc.setState(0x5d44, 0xdfd9, 0xa5e0, 0x5dbf, 0xb491, 0x4f3d, 0x1, 0x1);
        gbc.writeMem(0x5d44, { 0xf7 });
        gbc.writeMem(0xdfd7, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xa5);
        EXPECT(gbc.b(),  0x5d);
        EXPECT(gbc.c(),  0xbf);
        EXPECT(gbc.d(),  0xb4);
        EXPECT(gbc.e(),  0x91);
        EXPECT(gbc.h(),  0x4f);
        EXPECT(gbc.l(),  0x3d);
        EXPECT(gbc.sp(), 0xdfd7);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdfd7), 0x45);
        EXPECT(gbc.readMem(0xdfd8), 0x5d);
        // F7 0090
        gbc.setState(0xe1f8, 0xdc17, 0x1350, 0x1b65, 0xbea1, 0xc2c4, 0x0, 0x0);
        gbc.writeMem(0xdc15, { 0x0, 0x0 });
        gbc.writeMem(0xe1f8, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x13);
        EXPECT(gbc.b(),  0x1b);
        EXPECT(gbc.c(),  0x65);
        EXPECT(gbc.d(),  0xbe);
        EXPECT(gbc.e(),  0xa1);
        EXPECT(gbc.h(),  0xc2);
        EXPECT(gbc.l(),  0xc4);
        EXPECT(gbc.sp(), 0xdc15);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xdc15), 0xf9);
        EXPECT(gbc.readMem(0xdc16), 0xe1);
        EXPECT(gbc.readMem(0xe1f8), 0xf7);
        // F7 0092
        gbc.setState(0xc88c, 0xbaea, 0x7520, 0xe755, 0x851f, 0x5071, 0x0, 0x0);
        gbc.writeMem(0xbae8, { 0x0, 0x0 });
        gbc.writeMem(0xc88c, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x75);
        EXPECT(gbc.b(),  0xe7);
        EXPECT(gbc.c(),  0x55);
        EXPECT(gbc.d(),  0x85);
        EXPECT(gbc.e(),  0x1f);
        EXPECT(gbc.h(),  0x50);
        EXPECT(gbc.l(),  0x71);
        EXPECT(gbc.sp(), 0xbae8);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbae8), 0x8d);
        EXPECT(gbc.readMem(0xbae9), 0xc8);
        EXPECT(gbc.readMem(0xc88c), 0xf7);
        // F7 0093
        gbc.setState(0xae02, 0x93a9, 0x5810, 0xc12d, 0xb08e, 0x7991, 0x1, 0x0);
        gbc.writeMem(0x93a7, { 0x0, 0x0 });
        gbc.writeMem(0xae02, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x58);
        EXPECT(gbc.b(),  0xc1);
        EXPECT(gbc.c(),  0x2d);
        EXPECT(gbc.d(),  0xb0);
        EXPECT(gbc.e(),  0x8e);
        EXPECT(gbc.h(),  0x79);
        EXPECT(gbc.l(),  0x91);
        EXPECT(gbc.sp(), 0x93a7);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x93a7), 0x3);
        EXPECT(gbc.readMem(0x93a8), 0xae);
        EXPECT(gbc.readMem(0xae02), 0xf7);
        // F7 0094
        gbc.setState(0x3863, 0xec41, 0x4750, 0x4530, 0x1537, 0x804c, 0x0, 0x0);
        gbc.writeMem(0x3863, { 0xf7 });
        gbc.writeMem(0xec3f, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x47);
        EXPECT(gbc.b(),  0x45);
        EXPECT(gbc.c(),  0x30);
        EXPECT(gbc.d(),  0x15);
        EXPECT(gbc.e(),  0x37);
        EXPECT(gbc.h(),  0x80);
        EXPECT(gbc.l(),  0x4c);
        EXPECT(gbc.sp(), 0xec3f);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xec3f), 0x64);
        EXPECT(gbc.readMem(0xec40), 0x38);
        // F7 0096
        gbc.setState(0x67ab, 0xa35e, 0x37c0, 0x4373, 0xebd2, 0x7a2c, 0x0, 0x1);
        gbc.writeMem(0x67ab, { 0xf7 });
        gbc.writeMem(0xa35c, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x37);
        EXPECT(gbc.b(),  0x43);
        EXPECT(gbc.c(),  0x73);
        EXPECT(gbc.d(),  0xeb);
        EXPECT(gbc.e(),  0xd2);
        EXPECT(gbc.h(),  0x7a);
        EXPECT(gbc.l(),  0x2c);
        EXPECT(gbc.sp(), 0xa35c);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa35c), 0xac);
        EXPECT(gbc.readMem(0xa35d), 0x67);
        // F7 0098
        gbc.setState(0x15d6, 0x9f18, 0xbf20, 0x5348, 0x3e51, 0xce46, 0x0, 0x0);
        gbc.writeMem(0x15d6, { 0xf7 });
        gbc.writeMem(0x9f16, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xbf);
        EXPECT(gbc.b(),  0x53);
        EXPECT(gbc.c(),  0x48);
        EXPECT(gbc.d(),  0x3e);
        EXPECT(gbc.e(),  0x51);
        EXPECT(gbc.h(),  0xce);
        EXPECT(gbc.l(),  0x46);
        EXPECT(gbc.sp(), 0x9f16);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9f16), 0xd7);
        EXPECT(gbc.readMem(0x9f17), 0x15);
        // F7 009C
        gbc.setState(0x8169, 0xad2c, 0xfd0, 0x11ef, 0x84cc, 0x1eb5, 0x0, 0x1);
        gbc.writeMem(0x8169, { 0xf7 });
        gbc.writeMem(0xad2a, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xf);
        EXPECT(gbc.b(),  0x11);
        EXPECT(gbc.c(),  0xef);
        EXPECT(gbc.d(),  0x84);
        EXPECT(gbc.e(),  0xcc);
        EXPECT(gbc.h(),  0x1e);
        EXPECT(gbc.l(),  0xb5);
        EXPECT(gbc.sp(), 0xad2a);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8169), 0xf7);
        EXPECT(gbc.readMem(0xad2a), 0x6a);
        EXPECT(gbc.readMem(0xad2b), 0x81);
        // F7 009E
        gbc.setState(0xc51, 0xfa27, 0x7af0, 0x60b1, 0xfd2c, 0x8c68, 0x0, 0x0);
        gbc.writeMem(0xc51, { 0xf7 });
        gbc.writeMem(0xfa25, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x7a);
        EXPECT(gbc.b(),  0x60);
        EXPECT(gbc.c(),  0xb1);
        EXPECT(gbc.d(),  0xfd);
        EXPECT(gbc.e(),  0x2c);
        EXPECT(gbc.h(),  0x8c);
        EXPECT(gbc.l(),  0x68);
        EXPECT(gbc.sp(), 0xfa25);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xfa25), 0x52);
        EXPECT(gbc.readMem(0xfa26), 0xc);
        // F7 009F
        gbc.setState(0x63a9, 0xed72, 0x6060, 0xf983, 0xd3e9, 0x5319, 0x0, 0x1);
        gbc.writeMem(0x63a9, { 0xf7 });
        gbc.writeMem(0xed70, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x60);
        EXPECT(gbc.b(),  0xf9);
        EXPECT(gbc.c(),  0x83);
        EXPECT(gbc.d(),  0xd3);
        EXPECT(gbc.e(),  0xe9);
        EXPECT(gbc.h(),  0x53);
        EXPECT(gbc.l(),  0x19);
        EXPECT(gbc.sp(), 0xed70);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xed70), 0xaa);
        EXPECT(gbc.readMem(0xed71), 0x63);
        // F7 00A1
        gbc.setState(0x3d40, 0x8812, 0x43b0, 0xa910, 0xb9a7, 0x7130, 0x0, 0x0);
        gbc.writeMem(0x3d40, { 0xf7 });
        gbc.writeMem(0x8810, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x43);
        EXPECT(gbc.b(),  0xa9);
        EXPECT(gbc.c(),  0x10);
        EXPECT(gbc.d(),  0xb9);
        EXPECT(gbc.e(),  0xa7);
        EXPECT(gbc.h(),  0x71);
        EXPECT(gbc.l(),  0x30);
        EXPECT(gbc.sp(), 0x8810);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8810), 0x41);
        EXPECT(gbc.readMem(0x8811), 0x3d);
        // F7 00A2
        gbc.setState(0x46f2, 0x97d0, 0x6fc0, 0x3c1d, 0x1449, 0x3d7, 0x1, 0x1);
        gbc.writeMem(0x46f2, { 0xf7 });
        gbc.writeMem(0x97ce, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x6f);
        EXPECT(gbc.b(),  0x3c);
        EXPECT(gbc.c(),  0x1d);
        EXPECT(gbc.d(),  0x14);
        EXPECT(gbc.e(),  0x49);
        EXPECT(gbc.h(),  0x3);
        EXPECT(gbc.l(),  0xd7);
        EXPECT(gbc.sp(), 0x97ce);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x97ce), 0xf3);
        EXPECT(gbc.readMem(0x97cf), 0x46);
        // F7 00A4
        gbc.setState(0xb37c, 0x862e, 0xce10, 0x531c, 0x8ce4, 0xa698, 0x0, 0x1);
        gbc.writeMem(0x862c, { 0x0, 0x0 });
        gbc.writeMem(0xb37c, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xce);
        EXPECT(gbc.b(),  0x53);
        EXPECT(gbc.c(),  0x1c);
        EXPECT(gbc.d(),  0x8c);
        EXPECT(gbc.e(),  0xe4);
        EXPECT(gbc.h(),  0xa6);
        EXPECT(gbc.l(),  0x98);
        EXPECT(gbc.sp(), 0x862c);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x862c), 0x7d);
        EXPECT(gbc.readMem(0x862d), 0xb3);
        EXPECT(gbc.readMem(0xb37c), 0xf7);
        // F7 00A6
        gbc.setState(0x5e0, 0x828c, 0x6e00, 0xaa85, 0xfe2b, 0xb8f9, 0x1, 0x1);
        gbc.writeMem(0x5e0, { 0xf7 });
        gbc.writeMem(0x828a, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x6e);
        EXPECT(gbc.b(),  0xaa);
        EXPECT(gbc.c(),  0x85);
        EXPECT(gbc.d(),  0xfe);
        EXPECT(gbc.e(),  0x2b);
        EXPECT(gbc.h(),  0xb8);
        EXPECT(gbc.l(),  0xf9);
        EXPECT(gbc.sp(), 0x828a);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x828a), 0xe1);
        EXPECT(gbc.readMem(0x828b), 0x5);
        // F7 00A7
        gbc.setState(0x974d, 0x9cbe, 0xe8c0, 0xcb74, 0x3e83, 0x61ba, 0x1, 0x1);
        gbc.writeMem(0x974d, { 0xf7 });
        gbc.writeMem(0x9cbc, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xe8);
        EXPECT(gbc.b(),  0xcb);
        EXPECT(gbc.c(),  0x74);
        EXPECT(gbc.d(),  0x3e);
        EXPECT(gbc.e(),  0x83);
        EXPECT(gbc.h(),  0x61);
        EXPECT(gbc.l(),  0xba);
        EXPECT(gbc.sp(), 0x9cbc);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x974d), 0xf7);
        EXPECT(gbc.readMem(0x9cbc), 0x4e);
        EXPECT(gbc.readMem(0x9cbd), 0x97);
        // F7 00A8
        gbc.setState(0x2a43, 0x87e6, 0x37c0, 0xd8f5, 0xd1c2, 0x8ead, 0x0, 0x0);
        gbc.writeMem(0x2a43, { 0xf7 });
        gbc.writeMem(0x87e4, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x37);
        EXPECT(gbc.b(),  0xd8);
        EXPECT(gbc.c(),  0xf5);
        EXPECT(gbc.d(),  0xd1);
        EXPECT(gbc.e(),  0xc2);
        EXPECT(gbc.h(),  0x8e);
        EXPECT(gbc.l(),  0xad);
        EXPECT(gbc.sp(), 0x87e4);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x87e4), 0x44);
        EXPECT(gbc.readMem(0x87e5), 0x2a);
        // F7 00A9
        gbc.setState(0xbbe6, 0xa98a, 0xaa60, 0x326d, 0xe152, 0xa8cd, 0x0, 0x1);
        gbc.writeMem(0xa988, { 0x0, 0x0 });
        gbc.writeMem(0xbbe6, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xaa);
        EXPECT(gbc.b(),  0x32);
        EXPECT(gbc.c(),  0x6d);
        EXPECT(gbc.d(),  0xe1);
        EXPECT(gbc.e(),  0x52);
        EXPECT(gbc.h(),  0xa8);
        EXPECT(gbc.l(),  0xcd);
        EXPECT(gbc.sp(), 0xa988);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa988), 0xe7);
        EXPECT(gbc.readMem(0xa989), 0xbb);
        EXPECT(gbc.readMem(0xbbe6), 0xf7);
        // F7 00AB
        gbc.setState(0x606d, 0xa299, 0x8cc0, 0xd737, 0x7a71, 0xba7e, 0x0, 0x1);
        gbc.writeMem(0x606d, { 0xf7 });
        gbc.writeMem(0xa297, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x8c);
        EXPECT(gbc.b(),  0xd7);
        EXPECT(gbc.c(),  0x37);
        EXPECT(gbc.d(),  0x7a);
        EXPECT(gbc.e(),  0x71);
        EXPECT(gbc.h(),  0xba);
        EXPECT(gbc.l(),  0x7e);
        EXPECT(gbc.sp(), 0xa297);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa297), 0x6e);
        EXPECT(gbc.readMem(0xa298), 0x60);
        // F7 00B2
        gbc.setState(0x2fe7, 0xfb3b, 0x10b0, 0x29e2, 0xa03d, 0xc9, 0x1, 0x0);
        gbc.writeMem(0x2fe7, { 0xf7 });
        gbc.writeMem(0xfb39, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0x29);
        EXPECT(gbc.c(),  0xe2);
        EXPECT(gbc.d(),  0xa0);
        EXPECT(gbc.e(),  0x3d);
        EXPECT(gbc.h(),  0x0);
        EXPECT(gbc.l(),  0xc9);
        EXPECT(gbc.sp(), 0xfb39);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xfb39), 0xe8);
        EXPECT(gbc.readMem(0xfb3a), 0x2f);
        // F7 00B7
        gbc.setState(0x51df, 0xd38e, 0x9110, 0x415a, 0x70e9, 0xc241, 0x1, 0x1);
        gbc.writeMem(0x51df, { 0xf7 });
        gbc.writeMem(0xd38c, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x91);
        EXPECT(gbc.b(),  0x41);
        EXPECT(gbc.c(),  0x5a);
        EXPECT(gbc.d(),  0x70);
        EXPECT(gbc.e(),  0xe9);
        EXPECT(gbc.h(),  0xc2);
        EXPECT(gbc.l(),  0x41);
        EXPECT(gbc.sp(), 0xd38c);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd38c), 0xe0);
        EXPECT(gbc.readMem(0xd38d), 0x51);
        // F7 00B8
        gbc.setState(0x8739, 0xf7cf, 0x1310, 0xbdfd, 0xf9ae, 0x16b1, 0x0, 0x0);
        gbc.writeMem(0x8739, { 0xf7 });
        gbc.writeMem(0xf7cd, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x13);
        EXPECT(gbc.b(),  0xbd);
        EXPECT(gbc.c(),  0xfd);
        EXPECT(gbc.d(),  0xf9);
        EXPECT(gbc.e(),  0xae);
        EXPECT(gbc.h(),  0x16);
        EXPECT(gbc.l(),  0xb1);
        EXPECT(gbc.sp(), 0xf7cd);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8739), 0xf7);
        EXPECT(gbc.readMem(0xf7cd), 0x3a);
        EXPECT(gbc.readMem(0xf7ce), 0x87);
        // F7 00BD
        gbc.setState(0xbdab, 0xc106, 0xb460, 0x8adf, 0x2047, 0x4b05, 0x0, 0x0);
        gbc.writeMem(0xbdab, { 0xf7 });
        gbc.writeMem(0xc104, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xb4);
        EXPECT(gbc.b(),  0x8a);
        EXPECT(gbc.c(),  0xdf);
        EXPECT(gbc.d(),  0x20);
        EXPECT(gbc.e(),  0x47);
        EXPECT(gbc.h(),  0x4b);
        EXPECT(gbc.l(),  0x5);
        EXPECT(gbc.sp(), 0xc104);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbdab), 0xf7);
        EXPECT(gbc.readMem(0xc104), 0xac);
        EXPECT(gbc.readMem(0xc105), 0xbd);
        // F7 00BE
        gbc.setState(0x8276, 0xfe29, 0x94d0, 0xbb85, 0x5f4d, 0x2945, 0x0, 0x1);
        gbc.writeMem(0x8276, { 0xf7 });
        gbc.writeMem(0xfe27, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x94);
        EXPECT(gbc.b(),  0xbb);
        EXPECT(gbc.c(),  0x85);
        EXPECT(gbc.d(),  0x5f);
        EXPECT(gbc.e(),  0x4d);
        EXPECT(gbc.h(),  0x29);
        EXPECT(gbc.l(),  0x45);
        EXPECT(gbc.sp(), 0xfe27);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8276), 0xf7);
        EXPECT(gbc.readMem(0xfe27), 0x77);
        EXPECT(gbc.readMem(0xfe28), 0x82);
        // F7 00BF
        gbc.setState(0xaaeb, 0xce3b, 0x4d0, 0x2485, 0x225f, 0x1dcb, 0x0, 0x0);
        gbc.writeMem(0xaaeb, { 0xf7 });
        gbc.writeMem(0xce39, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0x24);
        EXPECT(gbc.c(),  0x85);
        EXPECT(gbc.d(),  0x22);
        EXPECT(gbc.e(),  0x5f);
        EXPECT(gbc.h(),  0x1d);
        EXPECT(gbc.l(),  0xcb);
        EXPECT(gbc.sp(), 0xce39);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xaaeb), 0xf7);
        EXPECT(gbc.readMem(0xce39), 0xec);
        EXPECT(gbc.readMem(0xce3a), 0xaa);
        // F7 00C0
        gbc.setState(0x1ac7, 0xec14, 0x2550, 0x4f2d, 0x2cd5, 0x377d, 0x1, 0x0);
        gbc.writeMem(0x1ac7, { 0xf7 });
        gbc.writeMem(0xec12, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x25);
        EXPECT(gbc.b(),  0x4f);
        EXPECT(gbc.c(),  0x2d);
        EXPECT(gbc.d(),  0x2c);
        EXPECT(gbc.e(),  0xd5);
        EXPECT(gbc.h(),  0x37);
        EXPECT(gbc.l(),  0x7d);
        EXPECT(gbc.sp(), 0xec12);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xec12), 0xc8);
        EXPECT(gbc.readMem(0xec13), 0x1a);
        // F7 00C1
        gbc.setState(0xaab1, 0xafd6, 0x2420, 0xbf8a, 0x4e41, 0x725a, 0x1, 0x0);
        gbc.writeMem(0xaab1, { 0xf7 });
        gbc.writeMem(0xafd4, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x24);
        EXPECT(gbc.b(),  0xbf);
        EXPECT(gbc.c(),  0x8a);
        EXPECT(gbc.d(),  0x4e);
        EXPECT(gbc.e(),  0x41);
        EXPECT(gbc.h(),  0x72);
        EXPECT(gbc.l(),  0x5a);
        EXPECT(gbc.sp(), 0xafd4);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xaab1), 0xf7);
        EXPECT(gbc.readMem(0xafd4), 0xb2);
        EXPECT(gbc.readMem(0xafd5), 0xaa);
        // F7 00C5
        gbc.setState(0xc971, 0xbada, 0x7280, 0x8052, 0x8b8e, 0x356d, 0x0, 0x1);
        gbc.writeMem(0xbad8, { 0x0, 0x0 });
        gbc.writeMem(0xc971, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x72);
        EXPECT(gbc.b(),  0x80);
        EXPECT(gbc.c(),  0x52);
        EXPECT(gbc.d(),  0x8b);
        EXPECT(gbc.e(),  0x8e);
        EXPECT(gbc.h(),  0x35);
        EXPECT(gbc.l(),  0x6d);
        EXPECT(gbc.sp(), 0xbad8);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbad8), 0x72);
        EXPECT(gbc.readMem(0xbad9), 0xc9);
        EXPECT(gbc.readMem(0xc971), 0xf7);
        // F7 00C8
        gbc.setState(0x9079, 0xc4ff, 0x1be0, 0xc078, 0x1093, 0xc0c2, 0x0, 0x0);
        gbc.writeMem(0x9079, { 0xf7 });
        gbc.writeMem(0xc4fd, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x1b);
        EXPECT(gbc.b(),  0xc0);
        EXPECT(gbc.c(),  0x78);
        EXPECT(gbc.d(),  0x10);
        EXPECT(gbc.e(),  0x93);
        EXPECT(gbc.h(),  0xc0);
        EXPECT(gbc.l(),  0xc2);
        EXPECT(gbc.sp(), 0xc4fd);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9079), 0xf7);
        EXPECT(gbc.readMem(0xc4fd), 0x7a);
        EXPECT(gbc.readMem(0xc4fe), 0x90);
        // F7 00CA
        gbc.setState(0x7d92, 0x99a8, 0xcf50, 0xef0, 0x431d, 0xf43a, 0x0, 0x0);
        gbc.writeMem(0x7d92, { 0xf7 });
        gbc.writeMem(0x99a6, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xcf);
        EXPECT(gbc.b(),  0xe);
        EXPECT(gbc.c(),  0xf0);
        EXPECT(gbc.d(),  0x43);
        EXPECT(gbc.e(),  0x1d);
        EXPECT(gbc.h(),  0xf4);
        EXPECT(gbc.l(),  0x3a);
        EXPECT(gbc.sp(), 0x99a6);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x99a6), 0x93);
        EXPECT(gbc.readMem(0x99a7), 0x7d);
        // F7 00CB
        gbc.setState(0x659d, 0xd07e, 0x6940, 0xfd06, 0x5481, 0x38e, 0x0, 0x0);
        gbc.writeMem(0x659d, { 0xf7 });
        gbc.writeMem(0xd07c, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x69);
        EXPECT(gbc.b(),  0xfd);
        EXPECT(gbc.c(),  0x6);
        EXPECT(gbc.d(),  0x54);
        EXPECT(gbc.e(),  0x81);
        EXPECT(gbc.h(),  0x3);
        EXPECT(gbc.l(),  0x8e);
        EXPECT(gbc.sp(), 0xd07c);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd07c), 0x9e);
        EXPECT(gbc.readMem(0xd07d), 0x65);
        // F7 00CC
        gbc.setState(0x8fd9, 0x9cb6, 0x1370, 0xdd4d, 0x66f, 0x2301, 0x1, 0x1);
        gbc.writeMem(0x8fd9, { 0xf7 });
        gbc.writeMem(0x9cb4, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x13);
        EXPECT(gbc.b(),  0xdd);
        EXPECT(gbc.c(),  0x4d);
        EXPECT(gbc.d(),  0x6);
        EXPECT(gbc.e(),  0x6f);
        EXPECT(gbc.h(),  0x23);
        EXPECT(gbc.l(),  0x1);
        EXPECT(gbc.sp(), 0x9cb4);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8fd9), 0xf7);
        EXPECT(gbc.readMem(0x9cb4), 0xda);
        EXPECT(gbc.readMem(0x9cb5), 0x8f);
        // F7 00CD
        gbc.setState(0xc547, 0x8d88, 0x40f0, 0x1206, 0x6bde, 0x83e1, 0x0, 0x0);
        gbc.writeMem(0x8d86, { 0x0, 0x0 });
        gbc.writeMem(0xc547, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0x12);
        EXPECT(gbc.c(),  0x6);
        EXPECT(gbc.d(),  0x6b);
        EXPECT(gbc.e(),  0xde);
        EXPECT(gbc.h(),  0x83);
        EXPECT(gbc.l(),  0xe1);
        EXPECT(gbc.sp(), 0x8d86);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8d86), 0x48);
        EXPECT(gbc.readMem(0x8d87), 0xc5);
        EXPECT(gbc.readMem(0xc547), 0xf7);
        // F7 00CF
        gbc.setState(0x56d4, 0xd1ab, 0x68b0, 0x38f, 0x58d9, 0x494d, 0x1, 0x1);
        gbc.writeMem(0x56d4, { 0xf7 });
        gbc.writeMem(0xd1a9, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x68);
        EXPECT(gbc.b(),  0x3);
        EXPECT(gbc.c(),  0x8f);
        EXPECT(gbc.d(),  0x58);
        EXPECT(gbc.e(),  0xd9);
        EXPECT(gbc.h(),  0x49);
        EXPECT(gbc.l(),  0x4d);
        EXPECT(gbc.sp(), 0xd1a9);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd1a9), 0xd5);
        EXPECT(gbc.readMem(0xd1aa), 0x56);
        // F7 00D1
        gbc.setState(0x1c3e, 0xd30a, 0x2a70, 0x408e, 0x9c33, 0x73ba, 0x0, 0x0);
        gbc.writeMem(0x1c3e, { 0xf7 });
        gbc.writeMem(0xd308, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x2a);
        EXPECT(gbc.b(),  0x40);
        EXPECT(gbc.c(),  0x8e);
        EXPECT(gbc.d(),  0x9c);
        EXPECT(gbc.e(),  0x33);
        EXPECT(gbc.h(),  0x73);
        EXPECT(gbc.l(),  0xba);
        EXPECT(gbc.sp(), 0xd308);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd308), 0x3f);
        EXPECT(gbc.readMem(0xd309), 0x1c);
        // F7 00D3
        gbc.setState(0x5d7c, 0x87b8, 0xf20, 0x1111, 0xd66c, 0x90ba, 0x1, 0x0);
        gbc.writeMem(0x5d7c, { 0xf7 });
        gbc.writeMem(0x87b6, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xf);
        EXPECT(gbc.b(),  0x11);
        EXPECT(gbc.c(),  0x11);
        EXPECT(gbc.d(),  0xd6);
        EXPECT(gbc.e(),  0x6c);
        EXPECT(gbc.h(),  0x90);
        EXPECT(gbc.l(),  0xba);
        EXPECT(gbc.sp(), 0x87b6);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x87b6), 0x7d);
        EXPECT(gbc.readMem(0x87b7), 0x5d);
        // F7 00D4
        gbc.setState(0x9449, 0xac5d, 0xa180, 0xe7a1, 0x68a6, 0xe572, 0x1, 0x0);
        gbc.writeMem(0x9449, { 0xf7 });
        gbc.writeMem(0xac5b, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xa1);
        EXPECT(gbc.b(),  0xe7);
        EXPECT(gbc.c(),  0xa1);
        EXPECT(gbc.d(),  0x68);
        EXPECT(gbc.e(),  0xa6);
        EXPECT(gbc.h(),  0xe5);
        EXPECT(gbc.l(),  0x72);
        EXPECT(gbc.sp(), 0xac5b);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9449), 0xf7);
        EXPECT(gbc.readMem(0xac5b), 0x4a);
        EXPECT(gbc.readMem(0xac5c), 0x94);
        // F7 00D7
        gbc.setState(0x25af, 0xbda0, 0x9240, 0x249c, 0xdb46, 0x2659, 0x1, 0x0);
        gbc.writeMem(0x25af, { 0xf7 });
        gbc.writeMem(0xbd9e, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x92);
        EXPECT(gbc.b(),  0x24);
        EXPECT(gbc.c(),  0x9c);
        EXPECT(gbc.d(),  0xdb);
        EXPECT(gbc.e(),  0x46);
        EXPECT(gbc.h(),  0x26);
        EXPECT(gbc.l(),  0x59);
        EXPECT(gbc.sp(), 0xbd9e);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbd9e), 0xb0);
        EXPECT(gbc.readMem(0xbd9f), 0x25);
        // F7 00DA
        gbc.setState(0x7be6, 0xd97e, 0x6360, 0x7610, 0xcaa7, 0xdff7, 0x1, 0x1);
        gbc.writeMem(0x7be6, { 0xf7 });
        gbc.writeMem(0xd97c, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x63);
        EXPECT(gbc.b(),  0x76);
        EXPECT(gbc.c(),  0x10);
        EXPECT(gbc.d(),  0xca);
        EXPECT(gbc.e(),  0xa7);
        EXPECT(gbc.h(),  0xdf);
        EXPECT(gbc.l(),  0xf7);
        EXPECT(gbc.sp(), 0xd97c);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd97c), 0xe7);
        EXPECT(gbc.readMem(0xd97d), 0x7b);
        // F7 00DC
        gbc.setState(0x16de, 0xe90b, 0x2480, 0x18d8, 0x9cea, 0x4721, 0x1, 0x1);
        gbc.writeMem(0x16de, { 0xf7 });
        gbc.writeMem(0xe909, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x24);
        EXPECT(gbc.b(),  0x18);
        EXPECT(gbc.c(),  0xd8);
        EXPECT(gbc.d(),  0x9c);
        EXPECT(gbc.e(),  0xea);
        EXPECT(gbc.h(),  0x47);
        EXPECT(gbc.l(),  0x21);
        EXPECT(gbc.sp(), 0xe909);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe909), 0xdf);
        EXPECT(gbc.readMem(0xe90a), 0x16);
        // F7 00DF
        gbc.setState(0x45ee, 0xba6d, 0x4800, 0xada1, 0x6518, 0x6812, 0x0, 0x1);
        gbc.writeMem(0x45ee, { 0xf7 });
        gbc.writeMem(0xba6b, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x48);
        EXPECT(gbc.b(),  0xad);
        EXPECT(gbc.c(),  0xa1);
        EXPECT(gbc.d(),  0x65);
        EXPECT(gbc.e(),  0x18);
        EXPECT(gbc.h(),  0x68);
        EXPECT(gbc.l(),  0x12);
        EXPECT(gbc.sp(), 0xba6b);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xba6b), 0xef);
        EXPECT(gbc.readMem(0xba6c), 0x45);
        // F7 00E0
        gbc.setState(0x734c, 0xe436, 0x3eb0, 0x15d3, 0xadd5, 0xb5de, 0x0, 0x0);
        gbc.writeMem(0x734c, { 0xf7 });
        gbc.writeMem(0xe434, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x3e);
        EXPECT(gbc.b(),  0x15);
        EXPECT(gbc.c(),  0xd3);
        EXPECT(gbc.d(),  0xad);
        EXPECT(gbc.e(),  0xd5);
        EXPECT(gbc.h(),  0xb5);
        EXPECT(gbc.l(),  0xde);
        EXPECT(gbc.sp(), 0xe434);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe434), 0x4d);
        EXPECT(gbc.readMem(0xe435), 0x73);
        // F7 00E3
        gbc.setState(0x82c5, 0x88e4, 0x8070, 0x8560, 0xedd3, 0x2c82, 0x1, 0x0);
        gbc.writeMem(0x82c5, { 0xf7 });
        gbc.writeMem(0x88e2, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0x85);
        EXPECT(gbc.c(),  0x60);
        EXPECT(gbc.d(),  0xed);
        EXPECT(gbc.e(),  0xd3);
        EXPECT(gbc.h(),  0x2c);
        EXPECT(gbc.l(),  0x82);
        EXPECT(gbc.sp(), 0x88e2);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x82c5), 0xf7);
        EXPECT(gbc.readMem(0x88e2), 0xc6);
        EXPECT(gbc.readMem(0x88e3), 0x82);
        // F7 00E6
        gbc.setState(0xcd31, 0x9ad3, 0x4730, 0xacd5, 0x8a5e, 0x77eb, 0x1, 0x0);
        gbc.writeMem(0x9ad1, { 0x0, 0x0 });
        gbc.writeMem(0xcd31, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x47);
        EXPECT(gbc.b(),  0xac);
        EXPECT(gbc.c(),  0xd5);
        EXPECT(gbc.d(),  0x8a);
        EXPECT(gbc.e(),  0x5e);
        EXPECT(gbc.h(),  0x77);
        EXPECT(gbc.l(),  0xeb);
        EXPECT(gbc.sp(), 0x9ad1);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9ad1), 0x32);
        EXPECT(gbc.readMem(0x9ad2), 0xcd);
        EXPECT(gbc.readMem(0xcd31), 0xf7);
        // F7 00E7
        gbc.setState(0x4537, 0x9108, 0xa710, 0xb8c3, 0x67d3, 0xba93, 0x1, 0x1);
        gbc.writeMem(0x4537, { 0xf7 });
        gbc.writeMem(0x9106, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xa7);
        EXPECT(gbc.b(),  0xb8);
        EXPECT(gbc.c(),  0xc3);
        EXPECT(gbc.d(),  0x67);
        EXPECT(gbc.e(),  0xd3);
        EXPECT(gbc.h(),  0xba);
        EXPECT(gbc.l(),  0x93);
        EXPECT(gbc.sp(), 0x9106);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9106), 0x38);
        EXPECT(gbc.readMem(0x9107), 0x45);
        // F7 00E8
        gbc.setState(0x9956, 0xafb9, 0x1610, 0x9ba8, 0x5e6f, 0xc972, 0x1, 0x0);
        gbc.writeMem(0x9956, { 0xf7 });
        gbc.writeMem(0xafb7, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x16);
        EXPECT(gbc.b(),  0x9b);
        EXPECT(gbc.c(),  0xa8);
        EXPECT(gbc.d(),  0x5e);
        EXPECT(gbc.e(),  0x6f);
        EXPECT(gbc.h(),  0xc9);
        EXPECT(gbc.l(),  0x72);
        EXPECT(gbc.sp(), 0xafb7);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9956), 0xf7);
        EXPECT(gbc.readMem(0xafb7), 0x57);
        EXPECT(gbc.readMem(0xafb8), 0x99);
        // F7 00EA
        gbc.setState(0x189c, 0xe582, 0x20e0, 0x4a85, 0x89e8, 0xdeeb, 0x0, 0x1);
        gbc.writeMem(0x189c, { 0xf7 });
        gbc.writeMem(0xe580, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0x4a);
        EXPECT(gbc.c(),  0x85);
        EXPECT(gbc.d(),  0x89);
        EXPECT(gbc.e(),  0xe8);
        EXPECT(gbc.h(),  0xde);
        EXPECT(gbc.l(),  0xeb);
        EXPECT(gbc.sp(), 0xe580);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe580), 0x9d);
        EXPECT(gbc.readMem(0xe581), 0x18);
        // F7 00EB
        gbc.setState(0xb4ac, 0x970f, 0x2ae0, 0x733e, 0xb1e7, 0xb535, 0x0, 0x0);
        gbc.writeMem(0x970d, { 0x0, 0x0 });
        gbc.writeMem(0xb4ac, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x2a);
        EXPECT(gbc.b(),  0x73);
        EXPECT(gbc.c(),  0x3e);
        EXPECT(gbc.d(),  0xb1);
        EXPECT(gbc.e(),  0xe7);
        EXPECT(gbc.h(),  0xb5);
        EXPECT(gbc.l(),  0x35);
        EXPECT(gbc.sp(), 0x970d);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x970d), 0xad);
        EXPECT(gbc.readMem(0x970e), 0xb4);
        EXPECT(gbc.readMem(0xb4ac), 0xf7);
        // F7 00EE
        gbc.setState(0xcb76, 0xf561, 0xaf40, 0x4e28, 0x4273, 0x3e93, 0x1, 0x1);
        gbc.writeMem(0xcb76, { 0xf7 });
        gbc.writeMem(0xf55f, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xaf);
        EXPECT(gbc.b(),  0x4e);
        EXPECT(gbc.c(),  0x28);
        EXPECT(gbc.d(),  0x42);
        EXPECT(gbc.e(),  0x73);
        EXPECT(gbc.h(),  0x3e);
        EXPECT(gbc.l(),  0x93);
        EXPECT(gbc.sp(), 0xf55f);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcb76), 0xf7);
        EXPECT(gbc.readMem(0xf55f), 0x77);
        EXPECT(gbc.readMem(0xf560), 0xcb);
        // F7 00F0
        gbc.setState(0x8f7f, 0xaf1e, 0x6cd0, 0xd147, 0xaa84, 0xe676, 0x1, 0x1);
        gbc.writeMem(0x8f7f, { 0xf7 });
        gbc.writeMem(0xaf1c, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x6c);
        EXPECT(gbc.b(),  0xd1);
        EXPECT(gbc.c(),  0x47);
        EXPECT(gbc.d(),  0xaa);
        EXPECT(gbc.e(),  0x84);
        EXPECT(gbc.h(),  0xe6);
        EXPECT(gbc.l(),  0x76);
        EXPECT(gbc.sp(), 0xaf1c);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8f7f), 0xf7);
        EXPECT(gbc.readMem(0xaf1c), 0x80);
        EXPECT(gbc.readMem(0xaf1d), 0x8f);
        // F7 00F1
        gbc.setState(0x6b30, 0x9754, 0x90e0, 0x7730, 0x82a0, 0x1123, 0x0, 0x0);
        gbc.writeMem(0x6b30, { 0xf7 });
        gbc.writeMem(0x9752, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x90);
        EXPECT(gbc.b(),  0x77);
        EXPECT(gbc.c(),  0x30);
        EXPECT(gbc.d(),  0x82);
        EXPECT(gbc.e(),  0xa0);
        EXPECT(gbc.h(),  0x11);
        EXPECT(gbc.l(),  0x23);
        EXPECT(gbc.sp(), 0x9752);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9752), 0x31);
        EXPECT(gbc.readMem(0x9753), 0x6b);
        // F7 00F2
        gbc.setState(0x1a07, 0xdf80, 0xc080, 0xddf0, 0xf7a5, 0x4e61, 0x1, 0x1);
        gbc.writeMem(0x1a07, { 0xf7 });
        gbc.writeMem(0xdf7e, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xc0);
        EXPECT(gbc.b(),  0xdd);
        EXPECT(gbc.c(),  0xf0);
        EXPECT(gbc.d(),  0xf7);
        EXPECT(gbc.e(),  0xa5);
        EXPECT(gbc.h(),  0x4e);
        EXPECT(gbc.l(),  0x61);
        EXPECT(gbc.sp(), 0xdf7e);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdf7e), 0x8);
        EXPECT(gbc.readMem(0xdf7f), 0x1a);
        // F7 00F3
        gbc.setState(0x98e1, 0xb076, 0xa570, 0xa24d, 0xa630, 0x4cff, 0x0, 0x1);
        gbc.writeMem(0x98e1, { 0xf7 });
        gbc.writeMem(0xb074, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xa5);
        EXPECT(gbc.b(),  0xa2);
        EXPECT(gbc.c(),  0x4d);
        EXPECT(gbc.d(),  0xa6);
        EXPECT(gbc.e(),  0x30);
        EXPECT(gbc.h(),  0x4c);
        EXPECT(gbc.l(),  0xff);
        EXPECT(gbc.sp(), 0xb074);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x98e1), 0xf7);
        EXPECT(gbc.readMem(0xb074), 0xe2);
        EXPECT(gbc.readMem(0xb075), 0x98);
        // F7 00F5
        gbc.setState(0x3f9, 0xdbab, 0xcc50, 0x243d, 0x820, 0xb9f9, 0x0, 0x1);
        gbc.writeMem(0x3f9, { 0xf7 });
        gbc.writeMem(0xdba9, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xcc);
        EXPECT(gbc.b(),  0x24);
        EXPECT(gbc.c(),  0x3d);
        EXPECT(gbc.d(),  0x8);
        EXPECT(gbc.e(),  0x20);
        EXPECT(gbc.h(),  0xb9);
        EXPECT(gbc.l(),  0xf9);
        EXPECT(gbc.sp(), 0xdba9);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xdba9), 0xfa);
        EXPECT(gbc.readMem(0xdbaa), 0x3);
        // F7 00F6
        gbc.setState(0x5f49, 0xe5c9, 0xa1d0, 0xbf23, 0x4b30, 0x4f1a, 0x0, 0x1);
        gbc.writeMem(0x5f49, { 0xf7 });
        gbc.writeMem(0xe5c7, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xa1);
        EXPECT(gbc.b(),  0xbf);
        EXPECT(gbc.c(),  0x23);
        EXPECT(gbc.d(),  0x4b);
        EXPECT(gbc.e(),  0x30);
        EXPECT(gbc.h(),  0x4f);
        EXPECT(gbc.l(),  0x1a);
        EXPECT(gbc.sp(), 0xe5c7);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe5c7), 0x4a);
        EXPECT(gbc.readMem(0xe5c8), 0x5f);
        // F7 00FB
        gbc.setState(0x6976, 0xc05a, 0xac30, 0x9ddb, 0x30e5, 0xfc63, 0x0, 0x0);
        gbc.writeMem(0x6976, { 0xf7 });
        gbc.writeMem(0xc058, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xac);
        EXPECT(gbc.b(),  0x9d);
        EXPECT(gbc.c(),  0xdb);
        EXPECT(gbc.d(),  0x30);
        EXPECT(gbc.e(),  0xe5);
        EXPECT(gbc.h(),  0xfc);
        EXPECT(gbc.l(),  0x63);
        EXPECT(gbc.sp(), 0xc058);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc058), 0x77);
        EXPECT(gbc.readMem(0xc059), 0x69);
        // F7 00FC
        gbc.setState(0x2c6d, 0xd33f, 0x4f0, 0x2025, 0x5f92, 0x8a41, 0x1, 0x1);
        gbc.writeMem(0x2c6d, { 0xf7 });
        gbc.writeMem(0xd33d, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0x20);
        EXPECT(gbc.c(),  0x25);
        EXPECT(gbc.d(),  0x5f);
        EXPECT(gbc.e(),  0x92);
        EXPECT(gbc.h(),  0x8a);
        EXPECT(gbc.l(),  0x41);
        EXPECT(gbc.sp(), 0xd33d);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd33d), 0x6e);
        EXPECT(gbc.readMem(0xd33e), 0x2c);
        // F7 00FE
        gbc.setState(0x7aec, 0xe4cb, 0x9290, 0xe15f, 0x339f, 0xf633, 0x0, 0x1);
        gbc.writeMem(0x7aec, { 0xf7 });
        gbc.writeMem(0xe4c9, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x92);
        EXPECT(gbc.b(),  0xe1);
        EXPECT(gbc.c(),  0x5f);
        EXPECT(gbc.d(),  0x33);
        EXPECT(gbc.e(),  0x9f);
        EXPECT(gbc.h(),  0xf6);
        EXPECT(gbc.l(),  0x33);
        EXPECT(gbc.sp(), 0xe4c9);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe4c9), 0xed);
        EXPECT(gbc.readMem(0xe4ca), 0x7a);
        // F7 0103
        gbc.setState(0xbe66, 0x98cd, 0x51e0, 0x9128, 0xe9b8, 0x3067, 0x0, 0x0);
        gbc.writeMem(0x98cb, { 0x0, 0x0 });
        gbc.writeMem(0xbe66, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x51);
        EXPECT(gbc.b(),  0x91);
        EXPECT(gbc.c(),  0x28);
        EXPECT(gbc.d(),  0xe9);
        EXPECT(gbc.e(),  0xb8);
        EXPECT(gbc.h(),  0x30);
        EXPECT(gbc.l(),  0x67);
        EXPECT(gbc.sp(), 0x98cb);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x98cb), 0x67);
        EXPECT(gbc.readMem(0x98cc), 0xbe);
        EXPECT(gbc.readMem(0xbe66), 0xf7);
        // F7 0104
        gbc.setState(0xa06, 0xe090, 0x4a00, 0xccfb, 0xaf4d, 0x6c52, 0x1, 0x1);
        gbc.writeMem(0xa06, { 0xf7 });
        gbc.writeMem(0xe08e, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x4a);
        EXPECT(gbc.b(),  0xcc);
        EXPECT(gbc.c(),  0xfb);
        EXPECT(gbc.d(),  0xaf);
        EXPECT(gbc.e(),  0x4d);
        EXPECT(gbc.h(),  0x6c);
        EXPECT(gbc.l(),  0x52);
        EXPECT(gbc.sp(), 0xe08e);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe08e), 0x7);
        EXPECT(gbc.readMem(0xe08f), 0xa);
        // F7 0105
        gbc.setState(0x9097, 0xca57, 0xe010, 0xbc90, 0x6126, 0x34f7, 0x1, 0x1);
        gbc.writeMem(0x9097, { 0xf7 });
        gbc.writeMem(0xca55, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xe0);
        EXPECT(gbc.b(),  0xbc);
        EXPECT(gbc.c(),  0x90);
        EXPECT(gbc.d(),  0x61);
        EXPECT(gbc.e(),  0x26);
        EXPECT(gbc.h(),  0x34);
        EXPECT(gbc.l(),  0xf7);
        EXPECT(gbc.sp(), 0xca55);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9097), 0xf7);
        EXPECT(gbc.readMem(0xca55), 0x98);
        EXPECT(gbc.readMem(0xca56), 0x90);
        // F7 0106
        gbc.setState(0x890b, 0x8258, 0xa640, 0x1d4c, 0x110f, 0x1d0, 0x0, 0x0);
        gbc.writeMem(0x8256, { 0x0, 0x0 });
        gbc.writeMem(0x890b, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xa6);
        EXPECT(gbc.b(),  0x1d);
        EXPECT(gbc.c(),  0x4c);
        EXPECT(gbc.d(),  0x11);
        EXPECT(gbc.e(),  0xf);
        EXPECT(gbc.h(),  0x1);
        EXPECT(gbc.l(),  0xd0);
        EXPECT(gbc.sp(), 0x8256);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8256), 0xc);
        EXPECT(gbc.readMem(0x8257), 0x89);
        EXPECT(gbc.readMem(0x890b), 0xf7);
        // F7 0109
        gbc.setState(0x4c62, 0xf851, 0x8ab0, 0xe494, 0xad82, 0x2d41, 0x0, 0x0);
        gbc.writeMem(0x4c62, { 0xf7 });
        gbc.writeMem(0xf84f, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x8a);
        EXPECT(gbc.b(),  0xe4);
        EXPECT(gbc.c(),  0x94);
        EXPECT(gbc.d(),  0xad);
        EXPECT(gbc.e(),  0x82);
        EXPECT(gbc.h(),  0x2d);
        EXPECT(gbc.l(),  0x41);
        EXPECT(gbc.sp(), 0xf84f);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xf84f), 0x63);
        EXPECT(gbc.readMem(0xf850), 0x4c);
        // F7 010B
        gbc.setState(0xc78f, 0xaacf, 0x86a0, 0x46e7, 0x523a, 0xea53, 0x1, 0x0);
        gbc.writeMem(0xaacd, { 0x0, 0x0 });
        gbc.writeMem(0xc78f, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x86);
        EXPECT(gbc.b(),  0x46);
        EXPECT(gbc.c(),  0xe7);
        EXPECT(gbc.d(),  0x52);
        EXPECT(gbc.e(),  0x3a);
        EXPECT(gbc.h(),  0xea);
        EXPECT(gbc.l(),  0x53);
        EXPECT(gbc.sp(), 0xaacd);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xaacd), 0x90);
        EXPECT(gbc.readMem(0xaace), 0xc7);
        EXPECT(gbc.readMem(0xc78f), 0xf7);
        // F7 010C
        gbc.setState(0xac68, 0xaa17, 0x2020, 0xc6a4, 0xad7c, 0xb69d, 0x1, 0x1);
        gbc.writeMem(0xaa15, { 0x0, 0x0 });
        gbc.writeMem(0xac68, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0xc6);
        EXPECT(gbc.c(),  0xa4);
        EXPECT(gbc.d(),  0xad);
        EXPECT(gbc.e(),  0x7c);
        EXPECT(gbc.h(),  0xb6);
        EXPECT(gbc.l(),  0x9d);
        EXPECT(gbc.sp(), 0xaa15);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xaa15), 0x69);
        EXPECT(gbc.readMem(0xaa16), 0xac);
        EXPECT(gbc.readMem(0xac68), 0xf7);
        // F7 010E
        gbc.setState(0x1f51, 0xc213, 0x28a0, 0xda16, 0x796f, 0x6316, 0x0, 0x1);
        gbc.writeMem(0x1f51, { 0xf7 });
        gbc.writeMem(0xc211, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0xda);
        EXPECT(gbc.c(),  0x16);
        EXPECT(gbc.d(),  0x79);
        EXPECT(gbc.e(),  0x6f);
        EXPECT(gbc.h(),  0x63);
        EXPECT(gbc.l(),  0x16);
        EXPECT(gbc.sp(), 0xc211);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc211), 0x52);
        EXPECT(gbc.readMem(0xc212), 0x1f);
        // F7 0111
        gbc.setState(0xc9ce, 0xd2e0, 0x87d0, 0xdb4f, 0x5296, 0xe478, 0x0, 0x1);
        gbc.writeMem(0xc9ce, { 0xf7 });
        gbc.writeMem(0xd2de, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x87);
        EXPECT(gbc.b(),  0xdb);
        EXPECT(gbc.c(),  0x4f);
        EXPECT(gbc.d(),  0x52);
        EXPECT(gbc.e(),  0x96);
        EXPECT(gbc.h(),  0xe4);
        EXPECT(gbc.l(),  0x78);
        EXPECT(gbc.sp(), 0xd2de);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc9ce), 0xf7);
        EXPECT(gbc.readMem(0xd2de), 0xcf);
        EXPECT(gbc.readMem(0xd2df), 0xc9);
        // F7 0112
        gbc.setState(0x6178, 0xb213, 0xeba0, 0xdd8c, 0xb9d4, 0x41ea, 0x1, 0x1);
        gbc.writeMem(0x6178, { 0xf7 });
        gbc.writeMem(0xb211, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xeb);
        EXPECT(gbc.b(),  0xdd);
        EXPECT(gbc.c(),  0x8c);
        EXPECT(gbc.d(),  0xb9);
        EXPECT(gbc.e(),  0xd4);
        EXPECT(gbc.h(),  0x41);
        EXPECT(gbc.l(),  0xea);
        EXPECT(gbc.sp(), 0xb211);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb211), 0x79);
        EXPECT(gbc.readMem(0xb212), 0x61);
        // F7 0113
        gbc.setState(0x5e3a, 0xcd0f, 0xf810, 0x75cd, 0x791b, 0xff, 0x0, 0x0);
        gbc.writeMem(0x5e3a, { 0xf7 });
        gbc.writeMem(0xcd0d, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xf8);
        EXPECT(gbc.b(),  0x75);
        EXPECT(gbc.c(),  0xcd);
        EXPECT(gbc.d(),  0x79);
        EXPECT(gbc.e(),  0x1b);
        EXPECT(gbc.h(),  0x0);
        EXPECT(gbc.l(),  0xff);
        EXPECT(gbc.sp(), 0xcd0d);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcd0d), 0x3b);
        EXPECT(gbc.readMem(0xcd0e), 0x5e);
        // F7 0115
        gbc.setState(0xa5e7, 0x956a, 0xd150, 0xe17f, 0x468c, 0x77d1, 0x1, 0x1);
        gbc.writeMem(0x9568, { 0x0, 0x0 });
        gbc.writeMem(0xa5e7, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xd1);
        EXPECT(gbc.b(),  0xe1);
        EXPECT(gbc.c(),  0x7f);
        EXPECT(gbc.d(),  0x46);
        EXPECT(gbc.e(),  0x8c);
        EXPECT(gbc.h(),  0x77);
        EXPECT(gbc.l(),  0xd1);
        EXPECT(gbc.sp(), 0x9568);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9568), 0xe8);
        EXPECT(gbc.readMem(0x9569), 0xa5);
        EXPECT(gbc.readMem(0xa5e7), 0xf7);
        // F7 0117
        gbc.setState(0x5ad3, 0xd063, 0xb950, 0x9506, 0x27e3, 0xbc9, 0x1, 0x1);
        gbc.writeMem(0x5ad3, { 0xf7 });
        gbc.writeMem(0xd061, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xb9);
        EXPECT(gbc.b(),  0x95);
        EXPECT(gbc.c(),  0x6);
        EXPECT(gbc.d(),  0x27);
        EXPECT(gbc.e(),  0xe3);
        EXPECT(gbc.h(),  0xb);
        EXPECT(gbc.l(),  0xc9);
        EXPECT(gbc.sp(), 0xd061);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd061), 0xd4);
        EXPECT(gbc.readMem(0xd062), 0x5a);
        // F7 0118
        gbc.setState(0x8c6a, 0xd18d, 0xaa50, 0xf39, 0x7f30, 0x7aee, 0x0, 0x1);
        gbc.writeMem(0x8c6a, { 0xf7 });
        gbc.writeMem(0xd18b, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xaa);
        EXPECT(gbc.b(),  0xf);
        EXPECT(gbc.c(),  0x39);
        EXPECT(gbc.d(),  0x7f);
        EXPECT(gbc.e(),  0x30);
        EXPECT(gbc.h(),  0x7a);
        EXPECT(gbc.l(),  0xee);
        EXPECT(gbc.sp(), 0xd18b);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8c6a), 0xf7);
        EXPECT(gbc.readMem(0xd18b), 0x6b);
        EXPECT(gbc.readMem(0xd18c), 0x8c);
        // F7 0119
        gbc.setState(0x4a4f, 0xbd54, 0xb240, 0x289a, 0x5da6, 0x59cf, 0x1, 0x0);
        gbc.writeMem(0x4a4f, { 0xf7 });
        gbc.writeMem(0xbd52, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xb2);
        EXPECT(gbc.b(),  0x28);
        EXPECT(gbc.c(),  0x9a);
        EXPECT(gbc.d(),  0x5d);
        EXPECT(gbc.e(),  0xa6);
        EXPECT(gbc.h(),  0x59);
        EXPECT(gbc.l(),  0xcf);
        EXPECT(gbc.sp(), 0xbd52);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbd52), 0x50);
        EXPECT(gbc.readMem(0xbd53), 0x4a);
        // F7 011B
        gbc.setState(0x414, 0x9bff, 0x2450, 0xc30e, 0xaf75, 0xcf2a, 0x0, 0x1);
        gbc.writeMem(0x414, { 0xf7 });
        gbc.writeMem(0x9bfd, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x24);
        EXPECT(gbc.b(),  0xc3);
        EXPECT(gbc.c(),  0xe);
        EXPECT(gbc.d(),  0xaf);
        EXPECT(gbc.e(),  0x75);
        EXPECT(gbc.h(),  0xcf);
        EXPECT(gbc.l(),  0x2a);
        EXPECT(gbc.sp(), 0x9bfd);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9bfd), 0x15);
        EXPECT(gbc.readMem(0x9bfe), 0x4);
        // F7 011D
        gbc.setState(0x68fe, 0x9ef7, 0xdae0, 0xa4db, 0xd456, 0x6880, 0x0, 0x1);
        gbc.writeMem(0x68fe, { 0xf7 });
        gbc.writeMem(0x9ef5, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xda);
        EXPECT(gbc.b(),  0xa4);
        EXPECT(gbc.c(),  0xdb);
        EXPECT(gbc.d(),  0xd4);
        EXPECT(gbc.e(),  0x56);
        EXPECT(gbc.h(),  0x68);
        EXPECT(gbc.l(),  0x80);
        EXPECT(gbc.sp(), 0x9ef5);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9ef5), 0xff);
        EXPECT(gbc.readMem(0x9ef6), 0x68);
        // F7 0120
        gbc.setState(0x5777, 0xc33e, 0x6a90, 0xb614, 0xf18, 0x96a3, 0x0, 0x1);
        gbc.writeMem(0x5777, { 0xf7 });
        gbc.writeMem(0xc33c, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x6a);
        EXPECT(gbc.b(),  0xb6);
        EXPECT(gbc.c(),  0x14);
        EXPECT(gbc.d(),  0xf);
        EXPECT(gbc.e(),  0x18);
        EXPECT(gbc.h(),  0x96);
        EXPECT(gbc.l(),  0xa3);
        EXPECT(gbc.sp(), 0xc33c);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc33c), 0x78);
        EXPECT(gbc.readMem(0xc33d), 0x57);
        // F7 0122
        gbc.setState(0x3383, 0x92f6, 0xc7b0, 0xc9f1, 0x4c7a, 0x71a, 0x1, 0x1);
        gbc.writeMem(0x3383, { 0xf7 });
        gbc.writeMem(0x92f4, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xc7);
        EXPECT(gbc.b(),  0xc9);
        EXPECT(gbc.c(),  0xf1);
        EXPECT(gbc.d(),  0x4c);
        EXPECT(gbc.e(),  0x7a);
        EXPECT(gbc.h(),  0x7);
        EXPECT(gbc.l(),  0x1a);
        EXPECT(gbc.sp(), 0x92f4);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x92f4), 0x84);
        EXPECT(gbc.readMem(0x92f5), 0x33);
        // F7 0124
        gbc.setState(0xcf, 0x91a9, 0x20f0, 0x9f8, 0xa310, 0x86a, 0x0, 0x1);
        gbc.writeMem(0xcf, { 0xf7 });
        gbc.writeMem(0x91a7, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0x9);
        EXPECT(gbc.c(),  0xf8);
        EXPECT(gbc.d(),  0xa3);
        EXPECT(gbc.e(),  0x10);
        EXPECT(gbc.h(),  0x8);
        EXPECT(gbc.l(),  0x6a);
        EXPECT(gbc.sp(), 0x91a7);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x91a7), 0xd0);
        EXPECT(gbc.readMem(0x91a8), 0x0);
        // F7 0125
        gbc.setState(0xe2b2, 0x9f0b, 0x2770, 0xf79f, 0xa0be, 0x246c, 0x0, 0x1);
        gbc.writeMem(0x9f09, { 0x0, 0x0 });
        gbc.writeMem(0xe2b2, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x27);
        EXPECT(gbc.b(),  0xf7);
        EXPECT(gbc.c(),  0x9f);
        EXPECT(gbc.d(),  0xa0);
        EXPECT(gbc.e(),  0xbe);
        EXPECT(gbc.h(),  0x24);
        EXPECT(gbc.l(),  0x6c);
        EXPECT(gbc.sp(), 0x9f09);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9f09), 0xb3);
        EXPECT(gbc.readMem(0x9f0a), 0xe2);
        EXPECT(gbc.readMem(0xe2b2), 0xf7);
        // F7 0128
        gbc.setState(0x27af, 0xdb13, 0x7b00, 0xdd1, 0x3cbb, 0x3c4f, 0x1, 0x0);
        gbc.writeMem(0x27af, { 0xf7 });
        gbc.writeMem(0xdb11, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x7b);
        EXPECT(gbc.b(),  0xd);
        EXPECT(gbc.c(),  0xd1);
        EXPECT(gbc.d(),  0x3c);
        EXPECT(gbc.e(),  0xbb);
        EXPECT(gbc.h(),  0x3c);
        EXPECT(gbc.l(),  0x4f);
        EXPECT(gbc.sp(), 0xdb11);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdb11), 0xb0);
        EXPECT(gbc.readMem(0xdb12), 0x27);
        // F7 0129
        gbc.setState(0x2b0a, 0xe2d5, 0x4af0, 0x44ce, 0x61cc, 0x6281, 0x1, 0x0);
        gbc.writeMem(0x2b0a, { 0xf7 });
        gbc.writeMem(0xe2d3, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x4a);
        EXPECT(gbc.b(),  0x44);
        EXPECT(gbc.c(),  0xce);
        EXPECT(gbc.d(),  0x61);
        EXPECT(gbc.e(),  0xcc);
        EXPECT(gbc.h(),  0x62);
        EXPECT(gbc.l(),  0x81);
        EXPECT(gbc.sp(), 0xe2d3);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe2d3), 0xb);
        EXPECT(gbc.readMem(0xe2d4), 0x2b);
        // F7 012B
        gbc.setState(0x3e31, 0x894c, 0x2c50, 0x1832, 0x39cb, 0xb9df, 0x0, 0x1);
        gbc.writeMem(0x3e31, { 0xf7 });
        gbc.writeMem(0x894a, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x2c);
        EXPECT(gbc.b(),  0x18);
        EXPECT(gbc.c(),  0x32);
        EXPECT(gbc.d(),  0x39);
        EXPECT(gbc.e(),  0xcb);
        EXPECT(gbc.h(),  0xb9);
        EXPECT(gbc.l(),  0xdf);
        EXPECT(gbc.sp(), 0x894a);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x894a), 0x32);
        EXPECT(gbc.readMem(0x894b), 0x3e);
        // F7 012C
        gbc.setState(0xced4, 0x8fbd, 0x31f0, 0x56a0, 0xd73a, 0x2781, 0x1, 0x0);
        gbc.writeMem(0x8fbb, { 0x0, 0x0 });
        gbc.writeMem(0xced4, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x31);
        EXPECT(gbc.b(),  0x56);
        EXPECT(gbc.c(),  0xa0);
        EXPECT(gbc.d(),  0xd7);
        EXPECT(gbc.e(),  0x3a);
        EXPECT(gbc.h(),  0x27);
        EXPECT(gbc.l(),  0x81);
        EXPECT(gbc.sp(), 0x8fbb);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8fbb), 0xd5);
        EXPECT(gbc.readMem(0x8fbc), 0xce);
        EXPECT(gbc.readMem(0xced4), 0xf7);
        // F7 012D
        gbc.setState(0x91f9, 0xb69b, 0x9ce0, 0xc865, 0xfa9a, 0x1888, 0x0, 0x1);
        gbc.writeMem(0x91f9, { 0xf7 });
        gbc.writeMem(0xb699, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x9c);
        EXPECT(gbc.b(),  0xc8);
        EXPECT(gbc.c(),  0x65);
        EXPECT(gbc.d(),  0xfa);
        EXPECT(gbc.e(),  0x9a);
        EXPECT(gbc.h(),  0x18);
        EXPECT(gbc.l(),  0x88);
        EXPECT(gbc.sp(), 0xb699);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x91f9), 0xf7);
        EXPECT(gbc.readMem(0xb699), 0xfa);
        EXPECT(gbc.readMem(0xb69a), 0x91);
        // F7 0132
        gbc.setState(0x67c0, 0xad62, 0xc7c0, 0xf088, 0xe571, 0x101a, 0x1, 0x1);
        gbc.writeMem(0x67c0, { 0xf7 });
        gbc.writeMem(0xad60, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xc7);
        EXPECT(gbc.b(),  0xf0);
        EXPECT(gbc.c(),  0x88);
        EXPECT(gbc.d(),  0xe5);
        EXPECT(gbc.e(),  0x71);
        EXPECT(gbc.h(),  0x10);
        EXPECT(gbc.l(),  0x1a);
        EXPECT(gbc.sp(), 0xad60);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xad60), 0xc1);
        EXPECT(gbc.readMem(0xad61), 0x67);
        // F7 0134
        gbc.setState(0xe365, 0x98d5, 0x8d50, 0xcd8c, 0xc7dd, 0x9b3c, 0x1, 0x1);
        gbc.writeMem(0x98d3, { 0x0, 0x0 });
        gbc.writeMem(0xe365, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x8d);
        EXPECT(gbc.b(),  0xcd);
        EXPECT(gbc.c(),  0x8c);
        EXPECT(gbc.d(),  0xc7);
        EXPECT(gbc.e(),  0xdd);
        EXPECT(gbc.h(),  0x9b);
        EXPECT(gbc.l(),  0x3c);
        EXPECT(gbc.sp(), 0x98d3);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x98d3), 0x66);
        EXPECT(gbc.readMem(0x98d4), 0xe3);
        EXPECT(gbc.readMem(0xe365), 0xf7);
        // F7 0135
        gbc.setState(0x9f23, 0x9143, 0xfc00, 0x1232, 0xcd54, 0xe65a, 0x1, 0x0);
        gbc.writeMem(0x9141, { 0x0, 0x0 });
        gbc.writeMem(0x9f23, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xfc);
        EXPECT(gbc.b(),  0x12);
        EXPECT(gbc.c(),  0x32);
        EXPECT(gbc.d(),  0xcd);
        EXPECT(gbc.e(),  0x54);
        EXPECT(gbc.h(),  0xe6);
        EXPECT(gbc.l(),  0x5a);
        EXPECT(gbc.sp(), 0x9141);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9141), 0x24);
        EXPECT(gbc.readMem(0x9142), 0x9f);
        EXPECT(gbc.readMem(0x9f23), 0xf7);
        // F7 0137
        gbc.setState(0xe3b0, 0xdacd, 0xafb0, 0x873a, 0x7614, 0xa1ae, 0x0, 0x1);
        gbc.writeMem(0xdacb, { 0x0, 0x0 });
        gbc.writeMem(0xe3b0, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xaf);
        EXPECT(gbc.b(),  0x87);
        EXPECT(gbc.c(),  0x3a);
        EXPECT(gbc.d(),  0x76);
        EXPECT(gbc.e(),  0x14);
        EXPECT(gbc.h(),  0xa1);
        EXPECT(gbc.l(),  0xae);
        EXPECT(gbc.sp(), 0xdacb);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xdacb), 0xb1);
        EXPECT(gbc.readMem(0xdacc), 0xe3);
        EXPECT(gbc.readMem(0xe3b0), 0xf7);
        // F7 0138
        gbc.setState(0xc439, 0xf7b8, 0xbc60, 0xbe80, 0x1046, 0xa978, 0x1, 0x1);
        gbc.writeMem(0xc439, { 0xf7 });
        gbc.writeMem(0xf7b6, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xbc);
        EXPECT(gbc.b(),  0xbe);
        EXPECT(gbc.c(),  0x80);
        EXPECT(gbc.d(),  0x10);
        EXPECT(gbc.e(),  0x46);
        EXPECT(gbc.h(),  0xa9);
        EXPECT(gbc.l(),  0x78);
        EXPECT(gbc.sp(), 0xf7b6);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc439), 0xf7);
        EXPECT(gbc.readMem(0xf7b6), 0x3a);
        EXPECT(gbc.readMem(0xf7b7), 0xc4);
        // F7 0139
        gbc.setState(0x34a, 0xaaae, 0x4f00, 0x7491, 0xfcaf, 0xe62a, 0x0, 0x0);
        gbc.writeMem(0x34a, { 0xf7 });
        gbc.writeMem(0xaaac, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x4f);
        EXPECT(gbc.b(),  0x74);
        EXPECT(gbc.c(),  0x91);
        EXPECT(gbc.d(),  0xfc);
        EXPECT(gbc.e(),  0xaf);
        EXPECT(gbc.h(),  0xe6);
        EXPECT(gbc.l(),  0x2a);
        EXPECT(gbc.sp(), 0xaaac);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xaaac), 0x4b);
        EXPECT(gbc.readMem(0xaaad), 0x3);
        // F7 013A
        gbc.setState(0xe960, 0xbc35, 0xd630, 0x10f, 0x4e69, 0x7fdd, 0x0, 0x1);
        gbc.writeMem(0xbc33, { 0x0, 0x0 });
        gbc.writeMem(0xe960, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xd6);
        EXPECT(gbc.b(),  0x1);
        EXPECT(gbc.c(),  0xf);
        EXPECT(gbc.d(),  0x4e);
        EXPECT(gbc.e(),  0x69);
        EXPECT(gbc.h(),  0x7f);
        EXPECT(gbc.l(),  0xdd);
        EXPECT(gbc.sp(), 0xbc33);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbc33), 0x61);
        EXPECT(gbc.readMem(0xbc34), 0xe9);
        EXPECT(gbc.readMem(0xe960), 0xf7);
        // F7 013B
        gbc.setState(0x2e74, 0xd090, 0xd940, 0xf135, 0xbd82, 0xdca7, 0x0, 0x1);
        gbc.writeMem(0x2e74, { 0xf7 });
        gbc.writeMem(0xd08e, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xd9);
        EXPECT(gbc.b(),  0xf1);
        EXPECT(gbc.c(),  0x35);
        EXPECT(gbc.d(),  0xbd);
        EXPECT(gbc.e(),  0x82);
        EXPECT(gbc.h(),  0xdc);
        EXPECT(gbc.l(),  0xa7);
        EXPECT(gbc.sp(), 0xd08e);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd08e), 0x75);
        EXPECT(gbc.readMem(0xd08f), 0x2e);
        // F7 013C
        gbc.setState(0x2649, 0xfe19, 0x9830, 0xf50c, 0x691a, 0x9f4f, 0x0, 0x0);
        gbc.writeMem(0x2649, { 0xf7 });
        gbc.writeMem(0xfe17, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x98);
        EXPECT(gbc.b(),  0xf5);
        EXPECT(gbc.c(),  0xc);
        EXPECT(gbc.d(),  0x69);
        EXPECT(gbc.e(),  0x1a);
        EXPECT(gbc.h(),  0x9f);
        EXPECT(gbc.l(),  0x4f);
        EXPECT(gbc.sp(), 0xfe17);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xfe17), 0x4a);
        EXPECT(gbc.readMem(0xfe18), 0x26);
        // F7 013E
        gbc.setState(0xe43f, 0x9b90, 0x6ef0, 0x276a, 0x7f88, 0xa544, 0x1, 0x1);
        gbc.writeMem(0x9b8e, { 0x0, 0x0 });
        gbc.writeMem(0xe43f, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x6e);
        EXPECT(gbc.b(),  0x27);
        EXPECT(gbc.c(),  0x6a);
        EXPECT(gbc.d(),  0x7f);
        EXPECT(gbc.e(),  0x88);
        EXPECT(gbc.h(),  0xa5);
        EXPECT(gbc.l(),  0x44);
        EXPECT(gbc.sp(), 0x9b8e);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9b8e), 0x40);
        EXPECT(gbc.readMem(0x9b8f), 0xe4);
        EXPECT(gbc.readMem(0xe43f), 0xf7);
        // F7 0141
        gbc.setState(0x6b6f, 0xd8d5, 0x18e0, 0x7a9b, 0x6d6c, 0xd80d, 0x0, 0x0);
        gbc.writeMem(0x6b6f, { 0xf7 });
        gbc.writeMem(0xd8d3, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x18);
        EXPECT(gbc.b(),  0x7a);
        EXPECT(gbc.c(),  0x9b);
        EXPECT(gbc.d(),  0x6d);
        EXPECT(gbc.e(),  0x6c);
        EXPECT(gbc.h(),  0xd8);
        EXPECT(gbc.l(),  0xd);
        EXPECT(gbc.sp(), 0xd8d3);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd8d3), 0x70);
        EXPECT(gbc.readMem(0xd8d4), 0x6b);
        // F7 0144
        gbc.setState(0x2f2a, 0xae9f, 0x27d0, 0xfc57, 0x41ea, 0x7bcf, 0x0, 0x1);
        gbc.writeMem(0x2f2a, { 0xf7 });
        gbc.writeMem(0xae9d, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x27);
        EXPECT(gbc.b(),  0xfc);
        EXPECT(gbc.c(),  0x57);
        EXPECT(gbc.d(),  0x41);
        EXPECT(gbc.e(),  0xea);
        EXPECT(gbc.h(),  0x7b);
        EXPECT(gbc.l(),  0xcf);
        EXPECT(gbc.sp(), 0xae9d);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xae9d), 0x2b);
        EXPECT(gbc.readMem(0xae9e), 0x2f);
        // F7 0146
        gbc.setState(0x46c9, 0xb0f8, 0x2830, 0x6249, 0x94b9, 0x21f7, 0x0, 0x0);
        gbc.writeMem(0x46c9, { 0xf7 });
        gbc.writeMem(0xb0f6, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0x62);
        EXPECT(gbc.c(),  0x49);
        EXPECT(gbc.d(),  0x94);
        EXPECT(gbc.e(),  0xb9);
        EXPECT(gbc.h(),  0x21);
        EXPECT(gbc.l(),  0xf7);
        EXPECT(gbc.sp(), 0xb0f6);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb0f6), 0xca);
        EXPECT(gbc.readMem(0xb0f7), 0x46);
        // F7 014C
        gbc.setState(0x3204, 0x91b4, 0x2a70, 0x464f, 0xc003, 0x326a, 0x0, 0x0);
        gbc.writeMem(0x3204, { 0xf7 });
        gbc.writeMem(0x91b2, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x2a);
        EXPECT(gbc.b(),  0x46);
        EXPECT(gbc.c(),  0x4f);
        EXPECT(gbc.d(),  0xc0);
        EXPECT(gbc.e(),  0x3);
        EXPECT(gbc.h(),  0x32);
        EXPECT(gbc.l(),  0x6a);
        EXPECT(gbc.sp(), 0x91b2);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x91b2), 0x5);
        EXPECT(gbc.readMem(0x91b3), 0x32);
        // F7 014D
        gbc.setState(0xbe2d, 0xf3f6, 0x6850, 0x64a0, 0xc87d, 0xdb29, 0x1, 0x1);
        gbc.writeMem(0xbe2d, { 0xf7 });
        gbc.writeMem(0xf3f4, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x68);
        EXPECT(gbc.b(),  0x64);
        EXPECT(gbc.c(),  0xa0);
        EXPECT(gbc.d(),  0xc8);
        EXPECT(gbc.e(),  0x7d);
        EXPECT(gbc.h(),  0xdb);
        EXPECT(gbc.l(),  0x29);
        EXPECT(gbc.sp(), 0xf3f4);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbe2d), 0xf7);
        EXPECT(gbc.readMem(0xf3f4), 0x2e);
        EXPECT(gbc.readMem(0xf3f5), 0xbe);
        // F7 0150
        gbc.setState(0x8ef1, 0xa034, 0x7390, 0x4e48, 0x6e00, 0x367a, 0x0, 0x0);
        gbc.writeMem(0x8ef1, { 0xf7 });
        gbc.writeMem(0xa032, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x73);
        EXPECT(gbc.b(),  0x4e);
        EXPECT(gbc.c(),  0x48);
        EXPECT(gbc.d(),  0x6e);
        EXPECT(gbc.e(),  0x0);
        EXPECT(gbc.h(),  0x36);
        EXPECT(gbc.l(),  0x7a);
        EXPECT(gbc.sp(), 0xa032);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8ef1), 0xf7);
        EXPECT(gbc.readMem(0xa032), 0xf2);
        EXPECT(gbc.readMem(0xa033), 0x8e);
        // F7 0151
        gbc.setState(0x9cf, 0x8aa9, 0x59a0, 0x7b7a, 0x47dc, 0x3037, 0x1, 0x0);
        gbc.writeMem(0x9cf, { 0xf7 });
        gbc.writeMem(0x8aa7, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x59);
        EXPECT(gbc.b(),  0x7b);
        EXPECT(gbc.c(),  0x7a);
        EXPECT(gbc.d(),  0x47);
        EXPECT(gbc.e(),  0xdc);
        EXPECT(gbc.h(),  0x30);
        EXPECT(gbc.l(),  0x37);
        EXPECT(gbc.sp(), 0x8aa7);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8aa7), 0xd0);
        EXPECT(gbc.readMem(0x8aa8), 0x9);
        // F7 0153
        gbc.setState(0xc827, 0xec7b, 0x3900, 0x97dd, 0x6e99, 0xb654, 0x0, 0x0);
        gbc.writeMem(0xc827, { 0xf7 });
        gbc.writeMem(0xec79, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x39);
        EXPECT(gbc.b(),  0x97);
        EXPECT(gbc.c(),  0xdd);
        EXPECT(gbc.d(),  0x6e);
        EXPECT(gbc.e(),  0x99);
        EXPECT(gbc.h(),  0xb6);
        EXPECT(gbc.l(),  0x54);
        EXPECT(gbc.sp(), 0xec79);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc827), 0xf7);
        EXPECT(gbc.readMem(0xec79), 0x28);
        EXPECT(gbc.readMem(0xec7a), 0xc8);
        // F7 0155
        gbc.setState(0xac99, 0xea27, 0x5490, 0x8059, 0x9686, 0xb35b, 0x0, 0x0);
        gbc.writeMem(0xac99, { 0xf7 });
        gbc.writeMem(0xea25, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x54);
        EXPECT(gbc.b(),  0x80);
        EXPECT(gbc.c(),  0x59);
        EXPECT(gbc.d(),  0x96);
        EXPECT(gbc.e(),  0x86);
        EXPECT(gbc.h(),  0xb3);
        EXPECT(gbc.l(),  0x5b);
        EXPECT(gbc.sp(), 0xea25);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xac99), 0xf7);
        EXPECT(gbc.readMem(0xea25), 0x9a);
        EXPECT(gbc.readMem(0xea26), 0xac);
        // F7 0158
        gbc.setState(0xbd58, 0xd044, 0x1020, 0x6a85, 0x75c5, 0x2fb3, 0x0, 0x0);
        gbc.writeMem(0xbd58, { 0xf7 });
        gbc.writeMem(0xd042, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0x6a);
        EXPECT(gbc.c(),  0x85);
        EXPECT(gbc.d(),  0x75);
        EXPECT(gbc.e(),  0xc5);
        EXPECT(gbc.h(),  0x2f);
        EXPECT(gbc.l(),  0xb3);
        EXPECT(gbc.sp(), 0xd042);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbd58), 0xf7);
        EXPECT(gbc.readMem(0xd042), 0x59);
        EXPECT(gbc.readMem(0xd043), 0xbd);
        // F7 0159
        gbc.setState(0xdc4c, 0xaa88, 0x960, 0x957b, 0x1a5c, 0x18ae, 0x1, 0x0);
        gbc.writeMem(0xaa86, { 0x0, 0x0 });
        gbc.writeMem(0xdc4c, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x9);
        EXPECT(gbc.b(),  0x95);
        EXPECT(gbc.c(),  0x7b);
        EXPECT(gbc.d(),  0x1a);
        EXPECT(gbc.e(),  0x5c);
        EXPECT(gbc.h(),  0x18);
        EXPECT(gbc.l(),  0xae);
        EXPECT(gbc.sp(), 0xaa86);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xaa86), 0x4d);
        EXPECT(gbc.readMem(0xaa87), 0xdc);
        EXPECT(gbc.readMem(0xdc4c), 0xf7);
        // F7 015A
        gbc.setState(0xbac0, 0xf8d5, 0x77f0, 0x34a0, 0xcf24, 0x7937, 0x0, 0x0);
        gbc.writeMem(0xbac0, { 0xf7 });
        gbc.writeMem(0xf8d3, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x77);
        EXPECT(gbc.b(),  0x34);
        EXPECT(gbc.c(),  0xa0);
        EXPECT(gbc.d(),  0xcf);
        EXPECT(gbc.e(),  0x24);
        EXPECT(gbc.h(),  0x79);
        EXPECT(gbc.l(),  0x37);
        EXPECT(gbc.sp(), 0xf8d3);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbac0), 0xf7);
        EXPECT(gbc.readMem(0xf8d3), 0xc1);
        EXPECT(gbc.readMem(0xf8d4), 0xba);
        // F7 015B
        gbc.setState(0xa3cc, 0xcbc6, 0x3370, 0x2c46, 0x939a, 0x7ed7, 0x1, 0x1);
        gbc.writeMem(0xa3cc, { 0xf7 });
        gbc.writeMem(0xcbc4, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x33);
        EXPECT(gbc.b(),  0x2c);
        EXPECT(gbc.c(),  0x46);
        EXPECT(gbc.d(),  0x93);
        EXPECT(gbc.e(),  0x9a);
        EXPECT(gbc.h(),  0x7e);
        EXPECT(gbc.l(),  0xd7);
        EXPECT(gbc.sp(), 0xcbc4);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa3cc), 0xf7);
        EXPECT(gbc.readMem(0xcbc4), 0xcd);
        EXPECT(gbc.readMem(0xcbc5), 0xa3);
        // F7 0160
        gbc.setState(0x9e3c, 0xabd5, 0xaa10, 0x6354, 0xb33c, 0xb12d, 0x1, 0x0);
        gbc.writeMem(0x9e3c, { 0xf7 });
        gbc.writeMem(0xabd3, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xaa);
        EXPECT(gbc.b(),  0x63);
        EXPECT(gbc.c(),  0x54);
        EXPECT(gbc.d(),  0xb3);
        EXPECT(gbc.e(),  0x3c);
        EXPECT(gbc.h(),  0xb1);
        EXPECT(gbc.l(),  0x2d);
        EXPECT(gbc.sp(), 0xabd3);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9e3c), 0xf7);
        EXPECT(gbc.readMem(0xabd3), 0x3d);
        EXPECT(gbc.readMem(0xabd4), 0x9e);
        // F7 0162
        gbc.setState(0x86bf, 0x88f8, 0x7650, 0xdeb1, 0xd92b, 0x1577, 0x0, 0x1);
        gbc.writeMem(0x86bf, { 0xf7 });
        gbc.writeMem(0x88f6, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x76);
        EXPECT(gbc.b(),  0xde);
        EXPECT(gbc.c(),  0xb1);
        EXPECT(gbc.d(),  0xd9);
        EXPECT(gbc.e(),  0x2b);
        EXPECT(gbc.h(),  0x15);
        EXPECT(gbc.l(),  0x77);
        EXPECT(gbc.sp(), 0x88f6);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x86bf), 0xf7);
        EXPECT(gbc.readMem(0x88f6), 0xc0);
        EXPECT(gbc.readMem(0x88f7), 0x86);
        // F7 0164
        gbc.setState(0xaf8f, 0x9574, 0x4ab0, 0x580d, 0x7a45, 0x7720, 0x0, 0x0);
        gbc.writeMem(0x9572, { 0x0, 0x0 });
        gbc.writeMem(0xaf8f, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x4a);
        EXPECT(gbc.b(),  0x58);
        EXPECT(gbc.c(),  0xd);
        EXPECT(gbc.d(),  0x7a);
        EXPECT(gbc.e(),  0x45);
        EXPECT(gbc.h(),  0x77);
        EXPECT(gbc.l(),  0x20);
        EXPECT(gbc.sp(), 0x9572);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9572), 0x90);
        EXPECT(gbc.readMem(0x9573), 0xaf);
        EXPECT(gbc.readMem(0xaf8f), 0xf7);
        // F7 0166
        gbc.setState(0xbe58, 0xcdbd, 0xb8a0, 0xc369, 0xaa8c, 0x6816, 0x1, 0x1);
        gbc.writeMem(0xbe58, { 0xf7 });
        gbc.writeMem(0xcdbb, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xb8);
        EXPECT(gbc.b(),  0xc3);
        EXPECT(gbc.c(),  0x69);
        EXPECT(gbc.d(),  0xaa);
        EXPECT(gbc.e(),  0x8c);
        EXPECT(gbc.h(),  0x68);
        EXPECT(gbc.l(),  0x16);
        EXPECT(gbc.sp(), 0xcdbb);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbe58), 0xf7);
        EXPECT(gbc.readMem(0xcdbb), 0x59);
        EXPECT(gbc.readMem(0xcdbc), 0xbe);
        // F7 0168
        gbc.setState(0xc64c, 0xa9f0, 0xdf70, 0x74cb, 0xc4f7, 0xbd1c, 0x1, 0x1);
        gbc.writeMem(0xa9ee, { 0x0, 0x0 });
        gbc.writeMem(0xc64c, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xdf);
        EXPECT(gbc.b(),  0x74);
        EXPECT(gbc.c(),  0xcb);
        EXPECT(gbc.d(),  0xc4);
        EXPECT(gbc.e(),  0xf7);
        EXPECT(gbc.h(),  0xbd);
        EXPECT(gbc.l(),  0x1c);
        EXPECT(gbc.sp(), 0xa9ee);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa9ee), 0x4d);
        EXPECT(gbc.readMem(0xa9ef), 0xc6);
        EXPECT(gbc.readMem(0xc64c), 0xf7);
        // F7 016B
        gbc.setState(0xb485, 0xfbce, 0x72d0, 0x2ea6, 0x77ce, 0xdf70, 0x1, 0x1);
        gbc.writeMem(0xb485, { 0xf7 });
        gbc.writeMem(0xfbcc, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x72);
        EXPECT(gbc.b(),  0x2e);
        EXPECT(gbc.c(),  0xa6);
        EXPECT(gbc.d(),  0x77);
        EXPECT(gbc.e(),  0xce);
        EXPECT(gbc.h(),  0xdf);
        EXPECT(gbc.l(),  0x70);
        EXPECT(gbc.sp(), 0xfbcc);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb485), 0xf7);
        EXPECT(gbc.readMem(0xfbcc), 0x86);
        EXPECT(gbc.readMem(0xfbcd), 0xb4);
        // F7 016C
        gbc.setState(0xefb4, 0xa1dc, 0x6940, 0xc098, 0x96f5, 0xcd10, 0x0, 0x0);
        gbc.writeMem(0xa1da, { 0x0, 0x0 });
        gbc.writeMem(0xefb4, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x69);
        EXPECT(gbc.b(),  0xc0);
        EXPECT(gbc.c(),  0x98);
        EXPECT(gbc.d(),  0x96);
        EXPECT(gbc.e(),  0xf5);
        EXPECT(gbc.h(),  0xcd);
        EXPECT(gbc.l(),  0x10);
        EXPECT(gbc.sp(), 0xa1da);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa1da), 0xb5);
        EXPECT(gbc.readMem(0xa1db), 0xef);
        EXPECT(gbc.readMem(0xefb4), 0xf7);
        // F7 016D
        gbc.setState(0xb4b0, 0x99a1, 0x3990, 0x2172, 0xfd1e, 0x3bc3, 0x1, 0x1);
        gbc.writeMem(0x999f, { 0x0, 0x0 });
        gbc.writeMem(0xb4b0, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x39);
        EXPECT(gbc.b(),  0x21);
        EXPECT(gbc.c(),  0x72);
        EXPECT(gbc.d(),  0xfd);
        EXPECT(gbc.e(),  0x1e);
        EXPECT(gbc.h(),  0x3b);
        EXPECT(gbc.l(),  0xc3);
        EXPECT(gbc.sp(), 0x999f);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x999f), 0xb1);
        EXPECT(gbc.readMem(0x99a0), 0xb4);
        EXPECT(gbc.readMem(0xb4b0), 0xf7);
        // F7 0171
        gbc.setState(0x4cf0, 0xdd1b, 0x25e0, 0xc8a9, 0x673c, 0x416c, 0x0, 0x0);
        gbc.writeMem(0x4cf0, { 0xf7 });
        gbc.writeMem(0xdd19, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x25);
        EXPECT(gbc.b(),  0xc8);
        EXPECT(gbc.c(),  0xa9);
        EXPECT(gbc.d(),  0x67);
        EXPECT(gbc.e(),  0x3c);
        EXPECT(gbc.h(),  0x41);
        EXPECT(gbc.l(),  0x6c);
        EXPECT(gbc.sp(), 0xdd19);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdd19), 0xf1);
        EXPECT(gbc.readMem(0xdd1a), 0x4c);
        // F7 0176
        gbc.setState(0x9517, 0xa358, 0xd4d0, 0xdc70, 0x3fcb, 0x22a, 0x1, 0x0);
        gbc.writeMem(0x9517, { 0xf7 });
        gbc.writeMem(0xa356, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xd4);
        EXPECT(gbc.b(),  0xdc);
        EXPECT(gbc.c(),  0x70);
        EXPECT(gbc.d(),  0x3f);
        EXPECT(gbc.e(),  0xcb);
        EXPECT(gbc.h(),  0x2);
        EXPECT(gbc.l(),  0x2a);
        EXPECT(gbc.sp(), 0xa356);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9517), 0xf7);
        EXPECT(gbc.readMem(0xa356), 0x18);
        EXPECT(gbc.readMem(0xa357), 0x95);
        // F7 0177
        gbc.setState(0xd0e2, 0x9e29, 0xfbf0, 0x86ae, 0xd27a, 0x27a8, 0x1, 0x1);
        gbc.writeMem(0x9e27, { 0x0, 0x0 });
        gbc.writeMem(0xd0e2, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xfb);
        EXPECT(gbc.b(),  0x86);
        EXPECT(gbc.c(),  0xae);
        EXPECT(gbc.d(),  0xd2);
        EXPECT(gbc.e(),  0x7a);
        EXPECT(gbc.h(),  0x27);
        EXPECT(gbc.l(),  0xa8);
        EXPECT(gbc.sp(), 0x9e27);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9e27), 0xe3);
        EXPECT(gbc.readMem(0x9e28), 0xd0);
        EXPECT(gbc.readMem(0xd0e2), 0xf7);
        // F7 0179
        gbc.setState(0x5deb, 0xa4c7, 0x9580, 0x5ef7, 0x70ec, 0x2dde, 0x0, 0x1);
        gbc.writeMem(0x5deb, { 0xf7 });
        gbc.writeMem(0xa4c5, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x95);
        EXPECT(gbc.b(),  0x5e);
        EXPECT(gbc.c(),  0xf7);
        EXPECT(gbc.d(),  0x70);
        EXPECT(gbc.e(),  0xec);
        EXPECT(gbc.h(),  0x2d);
        EXPECT(gbc.l(),  0xde);
        EXPECT(gbc.sp(), 0xa4c5);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa4c5), 0xec);
        EXPECT(gbc.readMem(0xa4c6), 0x5d);
        // F7 017B
        gbc.setState(0xca44, 0x9992, 0xe6e0, 0x7cf3, 0xdb97, 0x1a77, 0x0, 0x1);
        gbc.writeMem(0x9990, { 0x0, 0x0 });
        gbc.writeMem(0xca44, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xe6);
        EXPECT(gbc.b(),  0x7c);
        EXPECT(gbc.c(),  0xf3);
        EXPECT(gbc.d(),  0xdb);
        EXPECT(gbc.e(),  0x97);
        EXPECT(gbc.h(),  0x1a);
        EXPECT(gbc.l(),  0x77);
        EXPECT(gbc.sp(), 0x9990);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9990), 0x45);
        EXPECT(gbc.readMem(0x9991), 0xca);
        EXPECT(gbc.readMem(0xca44), 0xf7);
        // F7 017E
        gbc.setState(0x2501, 0xbe09, 0xbbc0, 0x8de8, 0x9cb9, 0x1309, 0x0, 0x1);
        gbc.writeMem(0x2501, { 0xf7 });
        gbc.writeMem(0xbe07, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xbb);
        EXPECT(gbc.b(),  0x8d);
        EXPECT(gbc.c(),  0xe8);
        EXPECT(gbc.d(),  0x9c);
        EXPECT(gbc.e(),  0xb9);
        EXPECT(gbc.h(),  0x13);
        EXPECT(gbc.l(),  0x9);
        EXPECT(gbc.sp(), 0xbe07);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbe07), 0x2);
        EXPECT(gbc.readMem(0xbe08), 0x25);
        // F7 0180
        gbc.setState(0xc02, 0xd3fd, 0x9550, 0x2129, 0xdf84, 0x1280, 0x1, 0x0);
        gbc.writeMem(0xc02, { 0xf7 });
        gbc.writeMem(0xd3fb, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x95);
        EXPECT(gbc.b(),  0x21);
        EXPECT(gbc.c(),  0x29);
        EXPECT(gbc.d(),  0xdf);
        EXPECT(gbc.e(),  0x84);
        EXPECT(gbc.h(),  0x12);
        EXPECT(gbc.l(),  0x80);
        EXPECT(gbc.sp(), 0xd3fb);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd3fb), 0x3);
        EXPECT(gbc.readMem(0xd3fc), 0xc);
        // F7 0181
        gbc.setState(0xc8f, 0xae7b, 0xd5d0, 0xc3be, 0xa152, 0xf972, 0x0, 0x1);
        gbc.writeMem(0xc8f, { 0xf7 });
        gbc.writeMem(0xae79, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xd5);
        EXPECT(gbc.b(),  0xc3);
        EXPECT(gbc.c(),  0xbe);
        EXPECT(gbc.d(),  0xa1);
        EXPECT(gbc.e(),  0x52);
        EXPECT(gbc.h(),  0xf9);
        EXPECT(gbc.l(),  0x72);
        EXPECT(gbc.sp(), 0xae79);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xae79), 0x90);
        EXPECT(gbc.readMem(0xae7a), 0xc);
        // F7 0185
        gbc.setState(0x605b, 0xcbaf, 0x3370, 0xa4bf, 0x39e5, 0x9383, 0x1, 0x0);
        gbc.writeMem(0x605b, { 0xf7 });
        gbc.writeMem(0xcbad, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x33);
        EXPECT(gbc.b(),  0xa4);
        EXPECT(gbc.c(),  0xbf);
        EXPECT(gbc.d(),  0x39);
        EXPECT(gbc.e(),  0xe5);
        EXPECT(gbc.h(),  0x93);
        EXPECT(gbc.l(),  0x83);
        EXPECT(gbc.sp(), 0xcbad);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcbad), 0x5c);
        EXPECT(gbc.readMem(0xcbae), 0x60);
        // F7 0186
        gbc.setState(0xce15, 0xb5b5, 0xa40, 0xfd4, 0xd59e, 0x9c24, 0x0, 0x0);
        gbc.writeMem(0xb5b3, { 0x0, 0x0 });
        gbc.writeMem(0xce15, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xa);
        EXPECT(gbc.b(),  0xf);
        EXPECT(gbc.c(),  0xd4);
        EXPECT(gbc.d(),  0xd5);
        EXPECT(gbc.e(),  0x9e);
        EXPECT(gbc.h(),  0x9c);
        EXPECT(gbc.l(),  0x24);
        EXPECT(gbc.sp(), 0xb5b3);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb5b3), 0x16);
        EXPECT(gbc.readMem(0xb5b4), 0xce);
        EXPECT(gbc.readMem(0xce15), 0xf7);
        // F7 0187
        gbc.setState(0x6037, 0x9035, 0xcf30, 0x555a, 0x9bbd, 0xe906, 0x1, 0x0);
        gbc.writeMem(0x6037, { 0xf7 });
        gbc.writeMem(0x9033, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xcf);
        EXPECT(gbc.b(),  0x55);
        EXPECT(gbc.c(),  0x5a);
        EXPECT(gbc.d(),  0x9b);
        EXPECT(gbc.e(),  0xbd);
        EXPECT(gbc.h(),  0xe9);
        EXPECT(gbc.l(),  0x6);
        EXPECT(gbc.sp(), 0x9033);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9033), 0x38);
        EXPECT(gbc.readMem(0x9034), 0x60);
        // F7 0188
        gbc.setState(0x384, 0xb641, 0x9520, 0x6624, 0x3f3a, 0xaf49, 0x1, 0x0);
        gbc.writeMem(0x384, { 0xf7 });
        gbc.writeMem(0xb63f, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x95);
        EXPECT(gbc.b(),  0x66);
        EXPECT(gbc.c(),  0x24);
        EXPECT(gbc.d(),  0x3f);
        EXPECT(gbc.e(),  0x3a);
        EXPECT(gbc.h(),  0xaf);
        EXPECT(gbc.l(),  0x49);
        EXPECT(gbc.sp(), 0xb63f);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb63f), 0x85);
        EXPECT(gbc.readMem(0xb640), 0x3);
        // F7 018B
        gbc.setState(0x7f98, 0x8809, 0x5a50, 0x71f7, 0x5ed6, 0xc9ce, 0x0, 0x1);
        gbc.writeMem(0x7f98, { 0xf7 });
        gbc.writeMem(0x8807, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x5a);
        EXPECT(gbc.b(),  0x71);
        EXPECT(gbc.c(),  0xf7);
        EXPECT(gbc.d(),  0x5e);
        EXPECT(gbc.e(),  0xd6);
        EXPECT(gbc.h(),  0xc9);
        EXPECT(gbc.l(),  0xce);
        EXPECT(gbc.sp(), 0x8807);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8807), 0x99);
        EXPECT(gbc.readMem(0x8808), 0x7f);
        // F7 018C
        gbc.setState(0xe4d9, 0xabe1, 0xf890, 0x2e35, 0xbfe, 0x1e2f, 0x1, 0x0);
        gbc.writeMem(0xabdf, { 0x0, 0x0 });
        gbc.writeMem(0xe4d9, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xf8);
        EXPECT(gbc.b(),  0x2e);
        EXPECT(gbc.c(),  0x35);
        EXPECT(gbc.d(),  0xb);
        EXPECT(gbc.e(),  0xfe);
        EXPECT(gbc.h(),  0x1e);
        EXPECT(gbc.l(),  0x2f);
        EXPECT(gbc.sp(), 0xabdf);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xabdf), 0xda);
        EXPECT(gbc.readMem(0xabe0), 0xe4);
        EXPECT(gbc.readMem(0xe4d9), 0xf7);
        // F7 018E
        gbc.setState(0x9d28, 0x902a, 0xfa40, 0x6435, 0xcef4, 0x4024, 0x1, 0x1);
        gbc.writeMem(0x9028, { 0x0, 0x0 });
        gbc.writeMem(0x9d28, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xfa);
        EXPECT(gbc.b(),  0x64);
        EXPECT(gbc.c(),  0x35);
        EXPECT(gbc.d(),  0xce);
        EXPECT(gbc.e(),  0xf4);
        EXPECT(gbc.h(),  0x40);
        EXPECT(gbc.l(),  0x24);
        EXPECT(gbc.sp(), 0x9028);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9028), 0x29);
        EXPECT(gbc.readMem(0x9029), 0x9d);
        EXPECT(gbc.readMem(0x9d28), 0xf7);
        // F7 018F
        gbc.setState(0xebb, 0xaf14, 0xc260, 0xa1c7, 0x31a9, 0xb62, 0x1, 0x0);
        gbc.writeMem(0xebb, { 0xf7 });
        gbc.writeMem(0xaf12, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xc2);
        EXPECT(gbc.b(),  0xa1);
        EXPECT(gbc.c(),  0xc7);
        EXPECT(gbc.d(),  0x31);
        EXPECT(gbc.e(),  0xa9);
        EXPECT(gbc.h(),  0xb);
        EXPECT(gbc.l(),  0x62);
        EXPECT(gbc.sp(), 0xaf12);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xaf12), 0xbc);
        EXPECT(gbc.readMem(0xaf13), 0xe);
        // F7 0190
        gbc.setState(0x36c7, 0xf77c, 0x1540, 0xa4e2, 0x8231, 0x18aa, 0x1, 0x1);
        gbc.writeMem(0x36c7, { 0xf7 });
        gbc.writeMem(0xf77a, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x15);
        EXPECT(gbc.b(),  0xa4);
        EXPECT(gbc.c(),  0xe2);
        EXPECT(gbc.d(),  0x82);
        EXPECT(gbc.e(),  0x31);
        EXPECT(gbc.h(),  0x18);
        EXPECT(gbc.l(),  0xaa);
        EXPECT(gbc.sp(), 0xf77a);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xf77a), 0xc8);
        EXPECT(gbc.readMem(0xf77b), 0x36);
        // F7 0191
        gbc.setState(0x92bd, 0xf162, 0x88c0, 0x9929, 0xe5bb, 0x5390, 0x0, 0x0);
        gbc.writeMem(0x92bd, { 0xf7 });
        gbc.writeMem(0xf160, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x88);
        EXPECT(gbc.b(),  0x99);
        EXPECT(gbc.c(),  0x29);
        EXPECT(gbc.d(),  0xe5);
        EXPECT(gbc.e(),  0xbb);
        EXPECT(gbc.h(),  0x53);
        EXPECT(gbc.l(),  0x90);
        EXPECT(gbc.sp(), 0xf160);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x92bd), 0xf7);
        EXPECT(gbc.readMem(0xf160), 0xbe);
        EXPECT(gbc.readMem(0xf161), 0x92);
        // F7 0193
        gbc.setState(0x57a2, 0xac3b, 0x1e80, 0xe2cd, 0x394d, 0x7e24, 0x0, 0x1);
        gbc.writeMem(0x57a2, { 0xf7 });
        gbc.writeMem(0xac39, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x1e);
        EXPECT(gbc.b(),  0xe2);
        EXPECT(gbc.c(),  0xcd);
        EXPECT(gbc.d(),  0x39);
        EXPECT(gbc.e(),  0x4d);
        EXPECT(gbc.h(),  0x7e);
        EXPECT(gbc.l(),  0x24);
        EXPECT(gbc.sp(), 0xac39);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xac39), 0xa3);
        EXPECT(gbc.readMem(0xac3a), 0x57);
        // F7 0194
        gbc.setState(0x8c8f, 0xbafb, 0x9e00, 0x56b1, 0x2bb6, 0xf024, 0x0, 0x1);
        gbc.writeMem(0x8c8f, { 0xf7 });
        gbc.writeMem(0xbaf9, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x9e);
        EXPECT(gbc.b(),  0x56);
        EXPECT(gbc.c(),  0xb1);
        EXPECT(gbc.d(),  0x2b);
        EXPECT(gbc.e(),  0xb6);
        EXPECT(gbc.h(),  0xf0);
        EXPECT(gbc.l(),  0x24);
        EXPECT(gbc.sp(), 0xbaf9);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8c8f), 0xf7);
        EXPECT(gbc.readMem(0xbaf9), 0x90);
        EXPECT(gbc.readMem(0xbafa), 0x8c);
        // F7 0196
        gbc.setState(0xa86d, 0xed31, 0x4630, 0x7d9a, 0xf2f7, 0xe54b, 0x0, 0x1);
        gbc.writeMem(0xa86d, { 0xf7 });
        gbc.writeMem(0xed2f, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x46);
        EXPECT(gbc.b(),  0x7d);
        EXPECT(gbc.c(),  0x9a);
        EXPECT(gbc.d(),  0xf2);
        EXPECT(gbc.e(),  0xf7);
        EXPECT(gbc.h(),  0xe5);
        EXPECT(gbc.l(),  0x4b);
        EXPECT(gbc.sp(), 0xed2f);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa86d), 0xf7);
        EXPECT(gbc.readMem(0xed2f), 0x6e);
        EXPECT(gbc.readMem(0xed30), 0xa8);
        // F7 019B
        gbc.setState(0xe0bd, 0xa2a8, 0xb080, 0x8562, 0x3718, 0xce95, 0x0, 0x0);
        gbc.writeMem(0xa2a6, { 0x0, 0x0 });
        gbc.writeMem(0xe0bd, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xb0);
        EXPECT(gbc.b(),  0x85);
        EXPECT(gbc.c(),  0x62);
        EXPECT(gbc.d(),  0x37);
        EXPECT(gbc.e(),  0x18);
        EXPECT(gbc.h(),  0xce);
        EXPECT(gbc.l(),  0x95);
        EXPECT(gbc.sp(), 0xa2a6);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa2a6), 0xbe);
        EXPECT(gbc.readMem(0xa2a7), 0xe0);
        EXPECT(gbc.readMem(0xe0bd), 0xf7);
        // F7 01A1
        gbc.setState(0x9514, 0x97fb, 0xc040, 0xd99d, 0x8e74, 0x1831, 0x0, 0x1);
        gbc.writeMem(0x9514, { 0xf7 });
        gbc.writeMem(0x97f9, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xc0);
        EXPECT(gbc.b(),  0xd9);
        EXPECT(gbc.c(),  0x9d);
        EXPECT(gbc.d(),  0x8e);
        EXPECT(gbc.e(),  0x74);
        EXPECT(gbc.h(),  0x18);
        EXPECT(gbc.l(),  0x31);
        EXPECT(gbc.sp(), 0x97f9);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9514), 0xf7);
        EXPECT(gbc.readMem(0x97f9), 0x15);
        EXPECT(gbc.readMem(0x97fa), 0x95);
        // F7 01A2
        gbc.setState(0x608f, 0xcc22, 0x8d00, 0x59c1, 0xae9, 0x460e, 0x1, 0x0);
        gbc.writeMem(0x608f, { 0xf7 });
        gbc.writeMem(0xcc20, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x8d);
        EXPECT(gbc.b(),  0x59);
        EXPECT(gbc.c(),  0xc1);
        EXPECT(gbc.d(),  0xa);
        EXPECT(gbc.e(),  0xe9);
        EXPECT(gbc.h(),  0x46);
        EXPECT(gbc.l(),  0xe);
        EXPECT(gbc.sp(), 0xcc20);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcc20), 0x90);
        EXPECT(gbc.readMem(0xcc21), 0x60);
        // F7 01A3
        gbc.setState(0x4845, 0xf646, 0x2880, 0x1f82, 0x2bf5, 0x24cd, 0x0, 0x0);
        gbc.writeMem(0x4845, { 0xf7 });
        gbc.writeMem(0xf644, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0x1f);
        EXPECT(gbc.c(),  0x82);
        EXPECT(gbc.d(),  0x2b);
        EXPECT(gbc.e(),  0xf5);
        EXPECT(gbc.h(),  0x24);
        EXPECT(gbc.l(),  0xcd);
        EXPECT(gbc.sp(), 0xf644);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xf644), 0x46);
        EXPECT(gbc.readMem(0xf645), 0x48);
        // F7 01A5
        gbc.setState(0x7b8, 0x8471, 0xddc0, 0xc5b3, 0x7993, 0x4d9c, 0x0, 0x0);
        gbc.writeMem(0x7b8, { 0xf7 });
        gbc.writeMem(0x846f, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xdd);
        EXPECT(gbc.b(),  0xc5);
        EXPECT(gbc.c(),  0xb3);
        EXPECT(gbc.d(),  0x79);
        EXPECT(gbc.e(),  0x93);
        EXPECT(gbc.h(),  0x4d);
        EXPECT(gbc.l(),  0x9c);
        EXPECT(gbc.sp(), 0x846f);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x846f), 0xb9);
        EXPECT(gbc.readMem(0x8470), 0x7);
        // F7 01A7
        gbc.setState(0xc0f0, 0xbb2e, 0xf690, 0x2dcf, 0xd22, 0x5fa6, 0x1, 0x1);
        gbc.writeMem(0xbb2c, { 0x0, 0x0 });
        gbc.writeMem(0xc0f0, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xf6);
        EXPECT(gbc.b(),  0x2d);
        EXPECT(gbc.c(),  0xcf);
        EXPECT(gbc.d(),  0xd);
        EXPECT(gbc.e(),  0x22);
        EXPECT(gbc.h(),  0x5f);
        EXPECT(gbc.l(),  0xa6);
        EXPECT(gbc.sp(), 0xbb2c);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbb2c), 0xf1);
        EXPECT(gbc.readMem(0xbb2d), 0xc0);
        EXPECT(gbc.readMem(0xc0f0), 0xf7);
        // F7 01A9
        gbc.setState(0x8075, 0xe665, 0x5480, 0x13b, 0x4484, 0x760a, 0x0, 0x0);
        gbc.writeMem(0x8075, { 0xf7 });
        gbc.writeMem(0xe663, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x54);
        EXPECT(gbc.b(),  0x1);
        EXPECT(gbc.c(),  0x3b);
        EXPECT(gbc.d(),  0x44);
        EXPECT(gbc.e(),  0x84);
        EXPECT(gbc.h(),  0x76);
        EXPECT(gbc.l(),  0xa);
        EXPECT(gbc.sp(), 0xe663);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8075), 0xf7);
        EXPECT(gbc.readMem(0xe663), 0x76);
        EXPECT(gbc.readMem(0xe664), 0x80);
        // F7 01AA
        gbc.setState(0x3734, 0xa3cd, 0x9460, 0xa98d, 0x6028, 0x5d7f, 0x0, 0x0);
        gbc.writeMem(0x3734, { 0xf7 });
        gbc.writeMem(0xa3cb, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x94);
        EXPECT(gbc.b(),  0xa9);
        EXPECT(gbc.c(),  0x8d);
        EXPECT(gbc.d(),  0x60);
        EXPECT(gbc.e(),  0x28);
        EXPECT(gbc.h(),  0x5d);
        EXPECT(gbc.l(),  0x7f);
        EXPECT(gbc.sp(), 0xa3cb);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa3cb), 0x35);
        EXPECT(gbc.readMem(0xa3cc), 0x37);
        // F7 01AC
        gbc.setState(0x2777, 0x8b97, 0x510, 0x7970, 0xca11, 0x1ed9, 0x1, 0x0);
        gbc.writeMem(0x2777, { 0xf7 });
        gbc.writeMem(0x8b95, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x5);
        EXPECT(gbc.b(),  0x79);
        EXPECT(gbc.c(),  0x70);
        EXPECT(gbc.d(),  0xca);
        EXPECT(gbc.e(),  0x11);
        EXPECT(gbc.h(),  0x1e);
        EXPECT(gbc.l(),  0xd9);
        EXPECT(gbc.sp(), 0x8b95);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8b95), 0x78);
        EXPECT(gbc.readMem(0x8b96), 0x27);
        // F7 01AE
        gbc.setState(0x2535, 0xf17a, 0x4980, 0xa89f, 0x241e, 0xee53, 0x0, 0x0);
        gbc.writeMem(0x2535, { 0xf7 });
        gbc.writeMem(0xf178, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x49);
        EXPECT(gbc.b(),  0xa8);
        EXPECT(gbc.c(),  0x9f);
        EXPECT(gbc.d(),  0x24);
        EXPECT(gbc.e(),  0x1e);
        EXPECT(gbc.h(),  0xee);
        EXPECT(gbc.l(),  0x53);
        EXPECT(gbc.sp(), 0xf178);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xf178), 0x36);
        EXPECT(gbc.readMem(0xf179), 0x25);
        // F7 01AF
        gbc.setState(0xaf10, 0xfe39, 0xe2c0, 0xc89, 0x5f2e, 0x9f1c, 0x1, 0x1);
        gbc.writeMem(0xaf10, { 0xf7 });
        gbc.writeMem(0xfe37, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xe2);
        EXPECT(gbc.b(),  0xc);
        EXPECT(gbc.c(),  0x89);
        EXPECT(gbc.d(),  0x5f);
        EXPECT(gbc.e(),  0x2e);
        EXPECT(gbc.h(),  0x9f);
        EXPECT(gbc.l(),  0x1c);
        EXPECT(gbc.sp(), 0xfe37);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xaf10), 0xf7);
        EXPECT(gbc.readMem(0xfe37), 0x11);
        EXPECT(gbc.readMem(0xfe38), 0xaf);
        // F7 01B1
        gbc.setState(0x1d5f, 0xf92a, 0x4bb0, 0xe2ba, 0xafcd, 0x91de, 0x1, 0x0);
        gbc.writeMem(0x1d5f, { 0xf7 });
        gbc.writeMem(0xf928, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x4b);
        EXPECT(gbc.b(),  0xe2);
        EXPECT(gbc.c(),  0xba);
        EXPECT(gbc.d(),  0xaf);
        EXPECT(gbc.e(),  0xcd);
        EXPECT(gbc.h(),  0x91);
        EXPECT(gbc.l(),  0xde);
        EXPECT(gbc.sp(), 0xf928);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xf928), 0x60);
        EXPECT(gbc.readMem(0xf929), 0x1d);
        // F7 01B2
        gbc.setState(0xa4f1, 0x85d0, 0xb9c0, 0x1e1f, 0xe647, 0xc800, 0x1, 0x1);
        gbc.writeMem(0x85ce, { 0x0, 0x0 });
        gbc.writeMem(0xa4f1, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xb9);
        EXPECT(gbc.b(),  0x1e);
        EXPECT(gbc.c(),  0x1f);
        EXPECT(gbc.d(),  0xe6);
        EXPECT(gbc.e(),  0x47);
        EXPECT(gbc.h(),  0xc8);
        EXPECT(gbc.l(),  0x0);
        EXPECT(gbc.sp(), 0x85ce);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x85ce), 0xf2);
        EXPECT(gbc.readMem(0x85cf), 0xa4);
        EXPECT(gbc.readMem(0xa4f1), 0xf7);
        // F7 01B5
        gbc.setState(0x8fac, 0xcfb5, 0x67e0, 0xa726, 0xc540, 0x7264, 0x1, 0x0);
        gbc.writeMem(0x8fac, { 0xf7 });
        gbc.writeMem(0xcfb3, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x67);
        EXPECT(gbc.b(),  0xa7);
        EXPECT(gbc.c(),  0x26);
        EXPECT(gbc.d(),  0xc5);
        EXPECT(gbc.e(),  0x40);
        EXPECT(gbc.h(),  0x72);
        EXPECT(gbc.l(),  0x64);
        EXPECT(gbc.sp(), 0xcfb3);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8fac), 0xf7);
        EXPECT(gbc.readMem(0xcfb3), 0xad);
        EXPECT(gbc.readMem(0xcfb4), 0x8f);
        // F7 01B6
        gbc.setState(0x642, 0xa858, 0x8b30, 0xb675, 0x60e7, 0x3575, 0x0, 0x1);
        gbc.writeMem(0x642, { 0xf7 });
        gbc.writeMem(0xa856, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x8b);
        EXPECT(gbc.b(),  0xb6);
        EXPECT(gbc.c(),  0x75);
        EXPECT(gbc.d(),  0x60);
        EXPECT(gbc.e(),  0xe7);
        EXPECT(gbc.h(),  0x35);
        EXPECT(gbc.l(),  0x75);
        EXPECT(gbc.sp(), 0xa856);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa856), 0x43);
        EXPECT(gbc.readMem(0xa857), 0x6);
        // F7 01B7
        gbc.setState(0x7967, 0xba3a, 0xda20, 0xb9fa, 0xa776, 0x6be8, 0x0, 0x1);
        gbc.writeMem(0x7967, { 0xf7 });
        gbc.writeMem(0xba38, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xda);
        EXPECT(gbc.b(),  0xb9);
        EXPECT(gbc.c(),  0xfa);
        EXPECT(gbc.d(),  0xa7);
        EXPECT(gbc.e(),  0x76);
        EXPECT(gbc.h(),  0x6b);
        EXPECT(gbc.l(),  0xe8);
        EXPECT(gbc.sp(), 0xba38);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xba38), 0x68);
        EXPECT(gbc.readMem(0xba39), 0x79);
        // F7 01B8
        gbc.setState(0x724e, 0x8391, 0xe510, 0xb3eb, 0x1d53, 0x1ede, 0x0, 0x0);
        gbc.writeMem(0x724e, { 0xf7 });
        gbc.writeMem(0x838f, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xe5);
        EXPECT(gbc.b(),  0xb3);
        EXPECT(gbc.c(),  0xeb);
        EXPECT(gbc.d(),  0x1d);
        EXPECT(gbc.e(),  0x53);
        EXPECT(gbc.h(),  0x1e);
        EXPECT(gbc.l(),  0xde);
        EXPECT(gbc.sp(), 0x838f);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x838f), 0x4f);
        EXPECT(gbc.readMem(0x8390), 0x72);
        // F7 01BA
        gbc.setState(0x8c7d, 0x9bee, 0x7780, 0xf9ea, 0x1c55, 0x7f35, 0x1, 0x0);
        gbc.writeMem(0x8c7d, { 0xf7 });
        gbc.writeMem(0x9bec, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x77);
        EXPECT(gbc.b(),  0xf9);
        EXPECT(gbc.c(),  0xea);
        EXPECT(gbc.d(),  0x1c);
        EXPECT(gbc.e(),  0x55);
        EXPECT(gbc.h(),  0x7f);
        EXPECT(gbc.l(),  0x35);
        EXPECT(gbc.sp(), 0x9bec);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8c7d), 0xf7);
        EXPECT(gbc.readMem(0x9bec), 0x7e);
        EXPECT(gbc.readMem(0x9bed), 0x8c);
        // F7 01BD
        gbc.setState(0xa021, 0x9f7d, 0x5530, 0x1618, 0x1e49, 0x8ea8, 0x0, 0x1);
        gbc.writeMem(0x9f7b, { 0x0, 0x0 });
        gbc.writeMem(0xa021, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x55);
        EXPECT(gbc.b(),  0x16);
        EXPECT(gbc.c(),  0x18);
        EXPECT(gbc.d(),  0x1e);
        EXPECT(gbc.e(),  0x49);
        EXPECT(gbc.h(),  0x8e);
        EXPECT(gbc.l(),  0xa8);
        EXPECT(gbc.sp(), 0x9f7b);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9f7b), 0x22);
        EXPECT(gbc.readMem(0x9f7c), 0xa0);
        EXPECT(gbc.readMem(0xa021), 0xf7);
        // F7 01BE
        gbc.setState(0xed4b, 0x8bd2, 0x3150, 0xffc, 0x4e3b, 0xad34, 0x1, 0x0);
        gbc.writeMem(0x8bd0, { 0x0, 0x0 });
        gbc.writeMem(0xed4b, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x31);
        EXPECT(gbc.b(),  0xf);
        EXPECT(gbc.c(),  0xfc);
        EXPECT(gbc.d(),  0x4e);
        EXPECT(gbc.e(),  0x3b);
        EXPECT(gbc.h(),  0xad);
        EXPECT(gbc.l(),  0x34);
        EXPECT(gbc.sp(), 0x8bd0);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8bd0), 0x4c);
        EXPECT(gbc.readMem(0x8bd1), 0xed);
        EXPECT(gbc.readMem(0xed4b), 0xf7);
        // F7 01BF
        gbc.setState(0xcacc, 0xacc3, 0x50f0, 0x32f6, 0x75e9, 0x1abb, 0x1, 0x1);
        gbc.writeMem(0xacc1, { 0x0, 0x0 });
        gbc.writeMem(0xcacc, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x50);
        EXPECT(gbc.b(),  0x32);
        EXPECT(gbc.c(),  0xf6);
        EXPECT(gbc.d(),  0x75);
        EXPECT(gbc.e(),  0xe9);
        EXPECT(gbc.h(),  0x1a);
        EXPECT(gbc.l(),  0xbb);
        EXPECT(gbc.sp(), 0xacc1);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xacc1), 0xcd);
        EXPECT(gbc.readMem(0xacc2), 0xca);
        EXPECT(gbc.readMem(0xcacc), 0xf7);
        // F7 01C0
        gbc.setState(0x9b0e, 0xd9e8, 0x10f0, 0x9061, 0x6d53, 0xeb65, 0x1, 0x1);
        gbc.writeMem(0x9b0e, { 0xf7 });
        gbc.writeMem(0xd9e6, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0x90);
        EXPECT(gbc.c(),  0x61);
        EXPECT(gbc.d(),  0x6d);
        EXPECT(gbc.e(),  0x53);
        EXPECT(gbc.h(),  0xeb);
        EXPECT(gbc.l(),  0x65);
        EXPECT(gbc.sp(), 0xd9e6);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9b0e), 0xf7);
        EXPECT(gbc.readMem(0xd9e6), 0xf);
        EXPECT(gbc.readMem(0xd9e7), 0x9b);
        // F7 01C1
        gbc.setState(0xd9e3, 0xbe9f, 0x16a0, 0x1f4, 0x6ca2, 0xef0f, 0x1, 0x1);
        gbc.writeMem(0xbe9d, { 0x0, 0x0 });
        gbc.writeMem(0xd9e3, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x16);
        EXPECT(gbc.b(),  0x1);
        EXPECT(gbc.c(),  0xf4);
        EXPECT(gbc.d(),  0x6c);
        EXPECT(gbc.e(),  0xa2);
        EXPECT(gbc.h(),  0xef);
        EXPECT(gbc.l(),  0xf);
        EXPECT(gbc.sp(), 0xbe9d);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbe9d), 0xe4);
        EXPECT(gbc.readMem(0xbe9e), 0xd9);
        EXPECT(gbc.readMem(0xd9e3), 0xf7);
        // F7 01C2
        gbc.setState(0x3bfc, 0xffeb, 0x8400, 0x301d, 0x9115, 0x9203, 0x1, 0x0);
        gbc.writeMem(0x3bfc, { 0xf7 });
        gbc.writeMem(0xffe9, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x84);
        EXPECT(gbc.b(),  0x30);
        EXPECT(gbc.c(),  0x1d);
        EXPECT(gbc.d(),  0x91);
        EXPECT(gbc.e(),  0x15);
        EXPECT(gbc.h(),  0x92);
        EXPECT(gbc.l(),  0x3);
        EXPECT(gbc.sp(), 0xffe9);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xffe9), 0xfd);
        EXPECT(gbc.readMem(0xffea), 0x3b);
        // F7 01C3
        gbc.setState(0x2f5a, 0xaea5, 0x9b10, 0x90b8, 0xd882, 0x64f5, 0x0, 0x1);
        gbc.writeMem(0x2f5a, { 0xf7 });
        gbc.writeMem(0xaea3, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x9b);
        EXPECT(gbc.b(),  0x90);
        EXPECT(gbc.c(),  0xb8);
        EXPECT(gbc.d(),  0xd8);
        EXPECT(gbc.e(),  0x82);
        EXPECT(gbc.h(),  0x64);
        EXPECT(gbc.l(),  0xf5);
        EXPECT(gbc.sp(), 0xaea3);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xaea3), 0x5b);
        EXPECT(gbc.readMem(0xaea4), 0x2f);
        // F7 01C4
        gbc.setState(0x40af, 0x8573, 0xbd40, 0xd9b5, 0x5253, 0xf1b6, 0x1, 0x0);
        gbc.writeMem(0x40af, { 0xf7 });
        gbc.writeMem(0x8571, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xbd);
        EXPECT(gbc.b(),  0xd9);
        EXPECT(gbc.c(),  0xb5);
        EXPECT(gbc.d(),  0x52);
        EXPECT(gbc.e(),  0x53);
        EXPECT(gbc.h(),  0xf1);
        EXPECT(gbc.l(),  0xb6);
        EXPECT(gbc.sp(), 0x8571);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8571), 0xb0);
        EXPECT(gbc.readMem(0x8572), 0x40);
        // F7 01C5
        gbc.setState(0x5b63, 0xc8e0, 0x58a0, 0xb2d5, 0x84f9, 0x6903, 0x0, 0x0);
        gbc.writeMem(0x5b63, { 0xf7 });
        gbc.writeMem(0xc8de, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x58);
        EXPECT(gbc.b(),  0xb2);
        EXPECT(gbc.c(),  0xd5);
        EXPECT(gbc.d(),  0x84);
        EXPECT(gbc.e(),  0xf9);
        EXPECT(gbc.h(),  0x69);
        EXPECT(gbc.l(),  0x3);
        EXPECT(gbc.sp(), 0xc8de);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc8de), 0x64);
        EXPECT(gbc.readMem(0xc8df), 0x5b);
        // F7 01C7
        gbc.setState(0x5211, 0xc7c5, 0xef30, 0x3bb5, 0x6734, 0x2410, 0x1, 0x0);
        gbc.writeMem(0x5211, { 0xf7 });
        gbc.writeMem(0xc7c3, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xef);
        EXPECT(gbc.b(),  0x3b);
        EXPECT(gbc.c(),  0xb5);
        EXPECT(gbc.d(),  0x67);
        EXPECT(gbc.e(),  0x34);
        EXPECT(gbc.h(),  0x24);
        EXPECT(gbc.l(),  0x10);
        EXPECT(gbc.sp(), 0xc7c3);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc7c3), 0x12);
        EXPECT(gbc.readMem(0xc7c4), 0x52);
        // F7 01C9
        gbc.setState(0x6c35, 0xc88d, 0xbfb0, 0x80a7, 0xc57f, 0xd0ef, 0x1, 0x1);
        gbc.writeMem(0x6c35, { 0xf7 });
        gbc.writeMem(0xc88b, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xbf);
        EXPECT(gbc.b(),  0x80);
        EXPECT(gbc.c(),  0xa7);
        EXPECT(gbc.d(),  0xc5);
        EXPECT(gbc.e(),  0x7f);
        EXPECT(gbc.h(),  0xd0);
        EXPECT(gbc.l(),  0xef);
        EXPECT(gbc.sp(), 0xc88b);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc88b), 0x36);
        EXPECT(gbc.readMem(0xc88c), 0x6c);
        // F7 01CA
        gbc.setState(0xbd95, 0xa75f, 0xf170, 0x4663, 0xa8e0, 0x9394, 0x0, 0x1);
        gbc.writeMem(0xa75d, { 0x0, 0x0 });
        gbc.writeMem(0xbd95, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xf1);
        EXPECT(gbc.b(),  0x46);
        EXPECT(gbc.c(),  0x63);
        EXPECT(gbc.d(),  0xa8);
        EXPECT(gbc.e(),  0xe0);
        EXPECT(gbc.h(),  0x93);
        EXPECT(gbc.l(),  0x94);
        EXPECT(gbc.sp(), 0xa75d);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa75d), 0x96);
        EXPECT(gbc.readMem(0xa75e), 0xbd);
        EXPECT(gbc.readMem(0xbd95), 0xf7);
        // F7 01CB
        gbc.setState(0x3b8, 0xe1d9, 0x6870, 0x9bdb, 0x57a7, 0xb27b, 0x1, 0x1);
        gbc.writeMem(0x3b8, { 0xf7 });
        gbc.writeMem(0xe1d7, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x68);
        EXPECT(gbc.b(),  0x9b);
        EXPECT(gbc.c(),  0xdb);
        EXPECT(gbc.d(),  0x57);
        EXPECT(gbc.e(),  0xa7);
        EXPECT(gbc.h(),  0xb2);
        EXPECT(gbc.l(),  0x7b);
        EXPECT(gbc.sp(), 0xe1d7);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe1d7), 0xb9);
        EXPECT(gbc.readMem(0xe1d8), 0x3);
        // F7 01CC
        gbc.setState(0xe1c7, 0xb508, 0xf300, 0xf69d, 0x6843, 0x62c7, 0x1, 0x0);
        gbc.writeMem(0xb506, { 0x0, 0x0 });
        gbc.writeMem(0xe1c7, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xf3);
        EXPECT(gbc.b(),  0xf6);
        EXPECT(gbc.c(),  0x9d);
        EXPECT(gbc.d(),  0x68);
        EXPECT(gbc.e(),  0x43);
        EXPECT(gbc.h(),  0x62);
        EXPECT(gbc.l(),  0xc7);
        EXPECT(gbc.sp(), 0xb506);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb506), 0xc8);
        EXPECT(gbc.readMem(0xb507), 0xe1);
        EXPECT(gbc.readMem(0xe1c7), 0xf7);
        // F7 01D1
        gbc.setState(0x2d7, 0xdc3d, 0xca40, 0x655, 0x2051, 0x5a66, 0x1, 0x0);
        gbc.writeMem(0x2d7, { 0xf7 });
        gbc.writeMem(0xdc3b, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xca);
        EXPECT(gbc.b(),  0x6);
        EXPECT(gbc.c(),  0x55);
        EXPECT(gbc.d(),  0x20);
        EXPECT(gbc.e(),  0x51);
        EXPECT(gbc.h(),  0x5a);
        EXPECT(gbc.l(),  0x66);
        EXPECT(gbc.sp(), 0xdc3b);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdc3b), 0xd8);
        EXPECT(gbc.readMem(0xdc3c), 0x2);
        // F7 01D6
        gbc.setState(0xb67e, 0x8112, 0xd600, 0x4fc3, 0x9349, 0x8b2d, 0x0, 0x0);
        gbc.writeMem(0x8110, { 0x0, 0x0 });
        gbc.writeMem(0xb67e, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xd6);
        EXPECT(gbc.b(),  0x4f);
        EXPECT(gbc.c(),  0xc3);
        EXPECT(gbc.d(),  0x93);
        EXPECT(gbc.e(),  0x49);
        EXPECT(gbc.h(),  0x8b);
        EXPECT(gbc.l(),  0x2d);
        EXPECT(gbc.sp(), 0x8110);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8110), 0x7f);
        EXPECT(gbc.readMem(0x8111), 0xb6);
        EXPECT(gbc.readMem(0xb67e), 0xf7);
        // F7 01D7
        gbc.setState(0x94ec, 0xa475, 0xdcf0, 0x9ef6, 0x760c, 0xb76e, 0x1, 0x1);
        gbc.writeMem(0x94ec, { 0xf7 });
        gbc.writeMem(0xa473, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xdc);
        EXPECT(gbc.b(),  0x9e);
        EXPECT(gbc.c(),  0xf6);
        EXPECT(gbc.d(),  0x76);
        EXPECT(gbc.e(),  0xc);
        EXPECT(gbc.h(),  0xb7);
        EXPECT(gbc.l(),  0x6e);
        EXPECT(gbc.sp(), 0xa473);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x94ec), 0xf7);
        EXPECT(gbc.readMem(0xa473), 0xed);
        EXPECT(gbc.readMem(0xa474), 0x94);
        // F7 01D8
        gbc.setState(0xbdeb, 0x9848, 0x8320, 0x11ba, 0x1545, 0xa698, 0x1, 0x0);
        gbc.writeMem(0x9846, { 0x0, 0x0 });
        gbc.writeMem(0xbdeb, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x83);
        EXPECT(gbc.b(),  0x11);
        EXPECT(gbc.c(),  0xba);
        EXPECT(gbc.d(),  0x15);
        EXPECT(gbc.e(),  0x45);
        EXPECT(gbc.h(),  0xa6);
        EXPECT(gbc.l(),  0x98);
        EXPECT(gbc.sp(), 0x9846);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9846), 0xec);
        EXPECT(gbc.readMem(0x9847), 0xbd);
        EXPECT(gbc.readMem(0xbdeb), 0xf7);
        // F7 01DB
        gbc.setState(0x9e4e, 0xa505, 0x5d60, 0xf2d4, 0xdc51, 0xd810, 0x1, 0x1);
        gbc.writeMem(0x9e4e, { 0xf7 });
        gbc.writeMem(0xa503, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x5d);
        EXPECT(gbc.b(),  0xf2);
        EXPECT(gbc.c(),  0xd4);
        EXPECT(gbc.d(),  0xdc);
        EXPECT(gbc.e(),  0x51);
        EXPECT(gbc.h(),  0xd8);
        EXPECT(gbc.l(),  0x10);
        EXPECT(gbc.sp(), 0xa503);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9e4e), 0xf7);
        EXPECT(gbc.readMem(0xa503), 0x4f);
        EXPECT(gbc.readMem(0xa504), 0x9e);
        // F7 01E1
        gbc.setState(0x4ef5, 0x9955, 0xa6a0, 0xdb75, 0x5d1e, 0x58de, 0x1, 0x1);
        gbc.writeMem(0x4ef5, { 0xf7 });
        gbc.writeMem(0x9953, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xa6);
        EXPECT(gbc.b(),  0xdb);
        EXPECT(gbc.c(),  0x75);
        EXPECT(gbc.d(),  0x5d);
        EXPECT(gbc.e(),  0x1e);
        EXPECT(gbc.h(),  0x58);
        EXPECT(gbc.l(),  0xde);
        EXPECT(gbc.sp(), 0x9953);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9953), 0xf6);
        EXPECT(gbc.readMem(0x9954), 0x4e);
        // F7 01E5
        gbc.setState(0x743a, 0xc0db, 0xe5e0, 0x29ff, 0xf0b1, 0x45c6, 0x0, 0x0);
        gbc.writeMem(0x743a, { 0xf7 });
        gbc.writeMem(0xc0d9, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xe5);
        EXPECT(gbc.b(),  0x29);
        EXPECT(gbc.c(),  0xff);
        EXPECT(gbc.d(),  0xf0);
        EXPECT(gbc.e(),  0xb1);
        EXPECT(gbc.h(),  0x45);
        EXPECT(gbc.l(),  0xc6);
        EXPECT(gbc.sp(), 0xc0d9);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc0d9), 0x3b);
        EXPECT(gbc.readMem(0xc0da), 0x74);
        // F7 01EA
        gbc.setState(0x6d19, 0x8a8a, 0x1ea0, 0x9cd8, 0x7f2c, 0xe7ee, 0x0, 0x1);
        gbc.writeMem(0x6d19, { 0xf7 });
        gbc.writeMem(0x8a88, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x1e);
        EXPECT(gbc.b(),  0x9c);
        EXPECT(gbc.c(),  0xd8);
        EXPECT(gbc.d(),  0x7f);
        EXPECT(gbc.e(),  0x2c);
        EXPECT(gbc.h(),  0xe7);
        EXPECT(gbc.l(),  0xee);
        EXPECT(gbc.sp(), 0x8a88);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8a88), 0x1a);
        EXPECT(gbc.readMem(0x8a89), 0x6d);
        // F7 01ED
        gbc.setState(0x6a98, 0xc567, 0xe930, 0x9818, 0x5ad6, 0xe40c, 0x1, 0x0);
        gbc.writeMem(0x6a98, { 0xf7 });
        gbc.writeMem(0xc565, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xe9);
        EXPECT(gbc.b(),  0x98);
        EXPECT(gbc.c(),  0x18);
        EXPECT(gbc.d(),  0x5a);
        EXPECT(gbc.e(),  0xd6);
        EXPECT(gbc.h(),  0xe4);
        EXPECT(gbc.l(),  0xc);
        EXPECT(gbc.sp(), 0xc565);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc565), 0x99);
        EXPECT(gbc.readMem(0xc566), 0x6a);
        // F7 01F1
        gbc.setState(0x3506, 0xa78f, 0xc3e0, 0xf877, 0xaf29, 0x4095, 0x0, 0x0);
        gbc.writeMem(0x3506, { 0xf7 });
        gbc.writeMem(0xa78d, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xc3);
        EXPECT(gbc.b(),  0xf8);
        EXPECT(gbc.c(),  0x77);
        EXPECT(gbc.d(),  0xaf);
        EXPECT(gbc.e(),  0x29);
        EXPECT(gbc.h(),  0x40);
        EXPECT(gbc.l(),  0x95);
        EXPECT(gbc.sp(), 0xa78d);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa78d), 0x7);
        EXPECT(gbc.readMem(0xa78e), 0x35);
        // F7 01F3
        gbc.setState(0x9e0c, 0xd42c, 0x6270, 0x599, 0x2cfa, 0x9c7, 0x0, 0x1);
        gbc.writeMem(0x9e0c, { 0xf7 });
        gbc.writeMem(0xd42a, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x62);
        EXPECT(gbc.b(),  0x5);
        EXPECT(gbc.c(),  0x99);
        EXPECT(gbc.d(),  0x2c);
        EXPECT(gbc.e(),  0xfa);
        EXPECT(gbc.h(),  0x9);
        EXPECT(gbc.l(),  0xc7);
        EXPECT(gbc.sp(), 0xd42a);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9e0c), 0xf7);
        EXPECT(gbc.readMem(0xd42a), 0xd);
        EXPECT(gbc.readMem(0xd42b), 0x9e);
        // F7 01F4
        gbc.setState(0x818d, 0xb3f9, 0xf7b0, 0x93ab, 0x2603, 0x670f, 0x1, 0x1);
        gbc.writeMem(0x818d, { 0xf7 });
        gbc.writeMem(0xb3f7, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xf7);
        EXPECT(gbc.b(),  0x93);
        EXPECT(gbc.c(),  0xab);
        EXPECT(gbc.d(),  0x26);
        EXPECT(gbc.e(),  0x3);
        EXPECT(gbc.h(),  0x67);
        EXPECT(gbc.l(),  0xf);
        EXPECT(gbc.sp(), 0xb3f7);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x818d), 0xf7);
        EXPECT(gbc.readMem(0xb3f7), 0x8e);
        EXPECT(gbc.readMem(0xb3f8), 0x81);
        // F7 01F5
        gbc.setState(0x2746, 0xf716, 0x6150, 0xa0a5, 0xb174, 0x6509, 0x1, 0x0);
        gbc.writeMem(0x2746, { 0xf7 });
        gbc.writeMem(0xf714, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x61);
        EXPECT(gbc.b(),  0xa0);
        EXPECT(gbc.c(),  0xa5);
        EXPECT(gbc.d(),  0xb1);
        EXPECT(gbc.e(),  0x74);
        EXPECT(gbc.h(),  0x65);
        EXPECT(gbc.l(),  0x9);
        EXPECT(gbc.sp(), 0xf714);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xf714), 0x47);
        EXPECT(gbc.readMem(0xf715), 0x27);
        // F7 01F7
        gbc.setState(0x7519, 0x82fc, 0x7f40, 0xc67a, 0xaaad, 0xedf4, 0x1, 0x1);
        gbc.writeMem(0x7519, { 0xf7 });
        gbc.writeMem(0x82fa, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x7f);
        EXPECT(gbc.b(),  0xc6);
        EXPECT(gbc.c(),  0x7a);
        EXPECT(gbc.d(),  0xaa);
        EXPECT(gbc.e(),  0xad);
        EXPECT(gbc.h(),  0xed);
        EXPECT(gbc.l(),  0xf4);
        EXPECT(gbc.sp(), 0x82fa);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x82fa), 0x1a);
        EXPECT(gbc.readMem(0x82fb), 0x75);
        // F7 01F9
        gbc.setState(0x42ff, 0xf47c, 0x4560, 0x6d35, 0xdb34, 0xe05d, 0x1, 0x1);
        gbc.writeMem(0x42ff, { 0xf7 });
        gbc.writeMem(0xf47a, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x45);
        EXPECT(gbc.b(),  0x6d);
        EXPECT(gbc.c(),  0x35);
        EXPECT(gbc.d(),  0xdb);
        EXPECT(gbc.e(),  0x34);
        EXPECT(gbc.h(),  0xe0);
        EXPECT(gbc.l(),  0x5d);
        EXPECT(gbc.sp(), 0xf47a);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xf47a), 0x0);
        EXPECT(gbc.readMem(0xf47b), 0x43);
        // F7 01FA
        gbc.setState(0x6da3, 0xc1ae, 0x2460, 0x856f, 0x53ee, 0x8e4, 0x0, 0x1);
        gbc.writeMem(0x6da3, { 0xf7 });
        gbc.writeMem(0xc1ac, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x24);
        EXPECT(gbc.b(),  0x85);
        EXPECT(gbc.c(),  0x6f);
        EXPECT(gbc.d(),  0x53);
        EXPECT(gbc.e(),  0xee);
        EXPECT(gbc.h(),  0x8);
        EXPECT(gbc.l(),  0xe4);
        EXPECT(gbc.sp(), 0xc1ac);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc1ac), 0xa4);
        EXPECT(gbc.readMem(0xc1ad), 0x6d);
        // F7 01FB
        gbc.setState(0x6d2, 0xe744, 0xc890, 0xe51a, 0xeb9f, 0xc21f, 0x0, 0x1);
        gbc.writeMem(0x6d2, { 0xf7 });
        gbc.writeMem(0xe742, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xc8);
        EXPECT(gbc.b(),  0xe5);
        EXPECT(gbc.c(),  0x1a);
        EXPECT(gbc.d(),  0xeb);
        EXPECT(gbc.e(),  0x9f);
        EXPECT(gbc.h(),  0xc2);
        EXPECT(gbc.l(),  0x1f);
        EXPECT(gbc.sp(), 0xe742);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe742), 0xd3);
        EXPECT(gbc.readMem(0xe743), 0x6);
        // F7 01FD
        gbc.setState(0xa7df, 0xce84, 0xc650, 0x8a97, 0xb1c8, 0xac32, 0x1, 0x1);
        gbc.writeMem(0xa7df, { 0xf7 });
        gbc.writeMem(0xce82, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xc6);
        EXPECT(gbc.b(),  0x8a);
        EXPECT(gbc.c(),  0x97);
        EXPECT(gbc.d(),  0xb1);
        EXPECT(gbc.e(),  0xc8);
        EXPECT(gbc.h(),  0xac);
        EXPECT(gbc.l(),  0x32);
        EXPECT(gbc.sp(), 0xce82);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa7df), 0xf7);
        EXPECT(gbc.readMem(0xce82), 0xe0);
        EXPECT(gbc.readMem(0xce83), 0xa7);
        // F7 01FE
        gbc.setState(0xce47, 0x841e, 0xd610, 0x9ce2, 0xfaa7, 0x97c2, 0x0, 0x0);
        gbc.writeMem(0x841c, { 0x0, 0x0 });
        gbc.writeMem(0xce47, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xd6);
        EXPECT(gbc.b(),  0x9c);
        EXPECT(gbc.c(),  0xe2);
        EXPECT(gbc.d(),  0xfa);
        EXPECT(gbc.e(),  0xa7);
        EXPECT(gbc.h(),  0x97);
        EXPECT(gbc.l(),  0xc2);
        EXPECT(gbc.sp(), 0x841c);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x841c), 0x48);
        EXPECT(gbc.readMem(0x841d), 0xce);
        EXPECT(gbc.readMem(0xce47), 0xf7);
        // F7 01FF
        gbc.setState(0x15ef, 0x904d, 0x4f50, 0x17f0, 0x912, 0xc3dd, 0x1, 0x1);
        gbc.writeMem(0x15ef, { 0xf7 });
        gbc.writeMem(0x904b, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x4f);
        EXPECT(gbc.b(),  0x17);
        EXPECT(gbc.c(),  0xf0);
        EXPECT(gbc.d(),  0x9);
        EXPECT(gbc.e(),  0x12);
        EXPECT(gbc.h(),  0xc3);
        EXPECT(gbc.l(),  0xdd);
        EXPECT(gbc.sp(), 0x904b);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x904b), 0xf0);
        EXPECT(gbc.readMem(0x904c), 0x15);
        // F7 0201
        gbc.setState(0x6c71, 0xfe2d, 0x1120, 0xc70b, 0xe1c7, 0x49f5, 0x0, 0x0);
        gbc.writeMem(0x6c71, { 0xf7 });
        gbc.writeMem(0xfe2b, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x11);
        EXPECT(gbc.b(),  0xc7);
        EXPECT(gbc.c(),  0xb);
        EXPECT(gbc.d(),  0xe1);
        EXPECT(gbc.e(),  0xc7);
        EXPECT(gbc.h(),  0x49);
        EXPECT(gbc.l(),  0xf5);
        EXPECT(gbc.sp(), 0xfe2b);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xfe2b), 0x72);
        EXPECT(gbc.readMem(0xfe2c), 0x6c);
        // F7 0202
        gbc.setState(0x5d2c, 0xd6ae, 0x17f0, 0x77f1, 0xae29, 0xc6c2, 0x0, 0x1);
        gbc.writeMem(0x5d2c, { 0xf7 });
        gbc.writeMem(0xd6ac, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x17);
        EXPECT(gbc.b(),  0x77);
        EXPECT(gbc.c(),  0xf1);
        EXPECT(gbc.d(),  0xae);
        EXPECT(gbc.e(),  0x29);
        EXPECT(gbc.h(),  0xc6);
        EXPECT(gbc.l(),  0xc2);
        EXPECT(gbc.sp(), 0xd6ac);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd6ac), 0x2d);
        EXPECT(gbc.readMem(0xd6ad), 0x5d);
        // F7 0204
        gbc.setState(0x7225, 0xf043, 0xe0e0, 0x449f, 0xef49, 0x1efb, 0x0, 0x0);
        gbc.writeMem(0x7225, { 0xf7 });
        gbc.writeMem(0xf041, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xe0);
        EXPECT(gbc.b(),  0x44);
        EXPECT(gbc.c(),  0x9f);
        EXPECT(gbc.d(),  0xef);
        EXPECT(gbc.e(),  0x49);
        EXPECT(gbc.h(),  0x1e);
        EXPECT(gbc.l(),  0xfb);
        EXPECT(gbc.sp(), 0xf041);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xf041), 0x26);
        EXPECT(gbc.readMem(0xf042), 0x72);
        // F7 0208
        gbc.setState(0xee78, 0x9168, 0x4dc0, 0x68e8, 0xc1b9, 0xa13c, 0x0, 0x1);
        gbc.writeMem(0x9166, { 0x0, 0x0 });
        gbc.writeMem(0xee78, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x4d);
        EXPECT(gbc.b(),  0x68);
        EXPECT(gbc.c(),  0xe8);
        EXPECT(gbc.d(),  0xc1);
        EXPECT(gbc.e(),  0xb9);
        EXPECT(gbc.h(),  0xa1);
        EXPECT(gbc.l(),  0x3c);
        EXPECT(gbc.sp(), 0x9166);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9166), 0x79);
        EXPECT(gbc.readMem(0x9167), 0xee);
        EXPECT(gbc.readMem(0xee78), 0xf7);
        // F7 020A
        gbc.setState(0x7db5, 0xc8b8, 0x7a10, 0xac7e, 0xbcb2, 0xaa43, 0x0, 0x0);
        gbc.writeMem(0x7db5, { 0xf7 });
        gbc.writeMem(0xc8b6, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x7a);
        EXPECT(gbc.b(),  0xac);
        EXPECT(gbc.c(),  0x7e);
        EXPECT(gbc.d(),  0xbc);
        EXPECT(gbc.e(),  0xb2);
        EXPECT(gbc.h(),  0xaa);
        EXPECT(gbc.l(),  0x43);
        EXPECT(gbc.sp(), 0xc8b6);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc8b6), 0xb6);
        EXPECT(gbc.readMem(0xc8b7), 0x7d);
        // F7 020B
        gbc.setState(0xef78, 0xf114, 0x7f10, 0x5912, 0x9071, 0x27c2, 0x1, 0x1);
        gbc.writeMem(0xef78, { 0xf7 });
        gbc.writeMem(0xf112, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x7f);
        EXPECT(gbc.b(),  0x59);
        EXPECT(gbc.c(),  0x12);
        EXPECT(gbc.d(),  0x90);
        EXPECT(gbc.e(),  0x71);
        EXPECT(gbc.h(),  0x27);
        EXPECT(gbc.l(),  0xc2);
        EXPECT(gbc.sp(), 0xf112);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xef78), 0xf7);
        EXPECT(gbc.readMem(0xf112), 0x79);
        EXPECT(gbc.readMem(0xf113), 0xef);
        // F7 020C
        gbc.setState(0x7e8a, 0xad18, 0x7320, 0xdec1, 0x16ef, 0x9195, 0x1, 0x1);
        gbc.writeMem(0x7e8a, { 0xf7 });
        gbc.writeMem(0xad16, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x73);
        EXPECT(gbc.b(),  0xde);
        EXPECT(gbc.c(),  0xc1);
        EXPECT(gbc.d(),  0x16);
        EXPECT(gbc.e(),  0xef);
        EXPECT(gbc.h(),  0x91);
        EXPECT(gbc.l(),  0x95);
        EXPECT(gbc.sp(), 0xad16);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xad16), 0x8b);
        EXPECT(gbc.readMem(0xad17), 0x7e);
        // F7 020E
        gbc.setState(0x27b, 0xe18e, 0x6a90, 0x8bec, 0xc6de, 0x5c9b, 0x0, 0x0);
        gbc.writeMem(0x27b, { 0xf7 });
        gbc.writeMem(0xe18c, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x6a);
        EXPECT(gbc.b(),  0x8b);
        EXPECT(gbc.c(),  0xec);
        EXPECT(gbc.d(),  0xc6);
        EXPECT(gbc.e(),  0xde);
        EXPECT(gbc.h(),  0x5c);
        EXPECT(gbc.l(),  0x9b);
        EXPECT(gbc.sp(), 0xe18c);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe18c), 0x7c);
        EXPECT(gbc.readMem(0xe18d), 0x2);
        // F7 0210
        gbc.setState(0x160b, 0xebfb, 0xbb50, 0x975e, 0x4d18, 0xc727, 0x1, 0x0);
        gbc.writeMem(0x160b, { 0xf7 });
        gbc.writeMem(0xebf9, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xbb);
        EXPECT(gbc.b(),  0x97);
        EXPECT(gbc.c(),  0x5e);
        EXPECT(gbc.d(),  0x4d);
        EXPECT(gbc.e(),  0x18);
        EXPECT(gbc.h(),  0xc7);
        EXPECT(gbc.l(),  0x27);
        EXPECT(gbc.sp(), 0xebf9);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xebf9), 0xc);
        EXPECT(gbc.readMem(0xebfa), 0x16);
        // F7 0211
        gbc.setState(0x1c92, 0xe7fe, 0x8850, 0xbda, 0x3c8b, 0x4bf8, 0x0, 0x0);
        gbc.writeMem(0x1c92, { 0xf7 });
        gbc.writeMem(0xe7fc, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x88);
        EXPECT(gbc.b(),  0xb);
        EXPECT(gbc.c(),  0xda);
        EXPECT(gbc.d(),  0x3c);
        EXPECT(gbc.e(),  0x8b);
        EXPECT(gbc.h(),  0x4b);
        EXPECT(gbc.l(),  0xf8);
        EXPECT(gbc.sp(), 0xe7fc);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe7fc), 0x93);
        EXPECT(gbc.readMem(0xe7fd), 0x1c);
        // F7 0215
        gbc.setState(0x6f48, 0xcf44, 0x7240, 0xbe8f, 0xdfd4, 0x8a9b, 0x1, 0x0);
        gbc.writeMem(0x6f48, { 0xf7 });
        gbc.writeMem(0xcf42, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x72);
        EXPECT(gbc.b(),  0xbe);
        EXPECT(gbc.c(),  0x8f);
        EXPECT(gbc.d(),  0xdf);
        EXPECT(gbc.e(),  0xd4);
        EXPECT(gbc.h(),  0x8a);
        EXPECT(gbc.l(),  0x9b);
        EXPECT(gbc.sp(), 0xcf42);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcf42), 0x49);
        EXPECT(gbc.readMem(0xcf43), 0x6f);
        // F7 0217
        gbc.setState(0x15bb, 0x9a6a, 0x5780, 0x6b90, 0x81d1, 0x89dc, 0x0, 0x1);
        gbc.writeMem(0x15bb, { 0xf7 });
        gbc.writeMem(0x9a68, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x57);
        EXPECT(gbc.b(),  0x6b);
        EXPECT(gbc.c(),  0x90);
        EXPECT(gbc.d(),  0x81);
        EXPECT(gbc.e(),  0xd1);
        EXPECT(gbc.h(),  0x89);
        EXPECT(gbc.l(),  0xdc);
        EXPECT(gbc.sp(), 0x9a68);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9a68), 0xbc);
        EXPECT(gbc.readMem(0x9a69), 0x15);
        // F7 0218
        gbc.setState(0xbfb4, 0xce06, 0x9900, 0xa7f, 0xa193, 0x22e2, 0x0, 0x1);
        gbc.writeMem(0xbfb4, { 0xf7 });
        gbc.writeMem(0xce04, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x99);
        EXPECT(gbc.b(),  0xa);
        EXPECT(gbc.c(),  0x7f);
        EXPECT(gbc.d(),  0xa1);
        EXPECT(gbc.e(),  0x93);
        EXPECT(gbc.h(),  0x22);
        EXPECT(gbc.l(),  0xe2);
        EXPECT(gbc.sp(), 0xce04);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbfb4), 0xf7);
        EXPECT(gbc.readMem(0xce04), 0xb5);
        EXPECT(gbc.readMem(0xce05), 0xbf);
        // F7 021B
        gbc.setState(0xd5da, 0xaa0e, 0x41b0, 0x4f47, 0x864d, 0x6e51, 0x1, 0x1);
        gbc.writeMem(0xaa0c, { 0x0, 0x0 });
        gbc.writeMem(0xd5da, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x41);
        EXPECT(gbc.b(),  0x4f);
        EXPECT(gbc.c(),  0x47);
        EXPECT(gbc.d(),  0x86);
        EXPECT(gbc.e(),  0x4d);
        EXPECT(gbc.h(),  0x6e);
        EXPECT(gbc.l(),  0x51);
        EXPECT(gbc.sp(), 0xaa0c);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xaa0c), 0xdb);
        EXPECT(gbc.readMem(0xaa0d), 0xd5);
        EXPECT(gbc.readMem(0xd5da), 0xf7);
        // F7 021E
        gbc.setState(0x5616, 0xb4e2, 0xbba0, 0x1a36, 0x9764, 0xa76a, 0x1, 0x0);
        gbc.writeMem(0x5616, { 0xf7 });
        gbc.writeMem(0xb4e0, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xbb);
        EXPECT(gbc.b(),  0x1a);
        EXPECT(gbc.c(),  0x36);
        EXPECT(gbc.d(),  0x97);
        EXPECT(gbc.e(),  0x64);
        EXPECT(gbc.h(),  0xa7);
        EXPECT(gbc.l(),  0x6a);
        EXPECT(gbc.sp(), 0xb4e0);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb4e0), 0x17);
        EXPECT(gbc.readMem(0xb4e1), 0x56);
        // F7 021F
        gbc.setState(0xd16, 0xf31d, 0x25b0, 0x41d8, 0x9ab5, 0x2d3d, 0x0, 0x0);
        gbc.writeMem(0xd16, { 0xf7 });
        gbc.writeMem(0xf31b, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x25);
        EXPECT(gbc.b(),  0x41);
        EXPECT(gbc.c(),  0xd8);
        EXPECT(gbc.d(),  0x9a);
        EXPECT(gbc.e(),  0xb5);
        EXPECT(gbc.h(),  0x2d);
        EXPECT(gbc.l(),  0x3d);
        EXPECT(gbc.sp(), 0xf31b);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xf31b), 0x17);
        EXPECT(gbc.readMem(0xf31c), 0xd);
        // F7 0222
        gbc.setState(0xedbf, 0xc447, 0xd0c0, 0xdf21, 0x361c, 0xdd94, 0x1, 0x0);
        gbc.writeMem(0xc445, { 0x0, 0x0 });
        gbc.writeMem(0xedbf, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xd0);
        EXPECT(gbc.b(),  0xdf);
        EXPECT(gbc.c(),  0x21);
        EXPECT(gbc.d(),  0x36);
        EXPECT(gbc.e(),  0x1c);
        EXPECT(gbc.h(),  0xdd);
        EXPECT(gbc.l(),  0x94);
        EXPECT(gbc.sp(), 0xc445);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc445), 0xc0);
        EXPECT(gbc.readMem(0xc446), 0xed);
        EXPECT(gbc.readMem(0xedbf), 0xf7);
        // F7 0223
        gbc.setState(0x596a, 0xf31b, 0xb350, 0x5a30, 0x816d, 0x7bd7, 0x1, 0x0);
        gbc.writeMem(0x596a, { 0xf7 });
        gbc.writeMem(0xf319, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xb3);
        EXPECT(gbc.b(),  0x5a);
        EXPECT(gbc.c(),  0x30);
        EXPECT(gbc.d(),  0x81);
        EXPECT(gbc.e(),  0x6d);
        EXPECT(gbc.h(),  0x7b);
        EXPECT(gbc.l(),  0xd7);
        EXPECT(gbc.sp(), 0xf319);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xf319), 0x6b);
        EXPECT(gbc.readMem(0xf31a), 0x59);
        // F7 0224
        gbc.setState(0xd39d, 0xb5fd, 0x7d90, 0xba29, 0x702d, 0xd7df, 0x0, 0x0);
        gbc.writeMem(0xb5fb, { 0x0, 0x0 });
        gbc.writeMem(0xd39d, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x7d);
        EXPECT(gbc.b(),  0xba);
        EXPECT(gbc.c(),  0x29);
        EXPECT(gbc.d(),  0x70);
        EXPECT(gbc.e(),  0x2d);
        EXPECT(gbc.h(),  0xd7);
        EXPECT(gbc.l(),  0xdf);
        EXPECT(gbc.sp(), 0xb5fb);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb5fb), 0x9e);
        EXPECT(gbc.readMem(0xb5fc), 0xd3);
        EXPECT(gbc.readMem(0xd39d), 0xf7);
        // F7 0225
        gbc.setState(0x241d, 0x93b3, 0xaef0, 0xaacf, 0xed20, 0xfa0d, 0x0, 0x1);
        gbc.writeMem(0x241d, { 0xf7 });
        gbc.writeMem(0x93b1, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xae);
        EXPECT(gbc.b(),  0xaa);
        EXPECT(gbc.c(),  0xcf);
        EXPECT(gbc.d(),  0xed);
        EXPECT(gbc.e(),  0x20);
        EXPECT(gbc.h(),  0xfa);
        EXPECT(gbc.l(),  0xd);
        EXPECT(gbc.sp(), 0x93b1);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x93b1), 0x1e);
        EXPECT(gbc.readMem(0x93b2), 0x24);
        // F7 0226
        gbc.setState(0xe11f, 0xafbf, 0x8a30, 0x4039, 0x1392, 0x71b8, 0x0, 0x0);
        gbc.writeMem(0xafbd, { 0x0, 0x0 });
        gbc.writeMem(0xe11f, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x8a);
        EXPECT(gbc.b(),  0x40);
        EXPECT(gbc.c(),  0x39);
        EXPECT(gbc.d(),  0x13);
        EXPECT(gbc.e(),  0x92);
        EXPECT(gbc.h(),  0x71);
        EXPECT(gbc.l(),  0xb8);
        EXPECT(gbc.sp(), 0xafbd);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xafbd), 0x20);
        EXPECT(gbc.readMem(0xafbe), 0xe1);
        EXPECT(gbc.readMem(0xe11f), 0xf7);
        // F7 022A
        gbc.setState(0x1ce2, 0xf7a8, 0x43d0, 0xa7ef, 0x3a53, 0x60db, 0x1, 0x1);
        gbc.writeMem(0x1ce2, { 0xf7 });
        gbc.writeMem(0xf7a6, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x43);
        EXPECT(gbc.b(),  0xa7);
        EXPECT(gbc.c(),  0xef);
        EXPECT(gbc.d(),  0x3a);
        EXPECT(gbc.e(),  0x53);
        EXPECT(gbc.h(),  0x60);
        EXPECT(gbc.l(),  0xdb);
        EXPECT(gbc.sp(), 0xf7a6);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xf7a6), 0xe3);
        EXPECT(gbc.readMem(0xf7a7), 0x1c);
        // F7 022E
        gbc.setState(0x477c, 0xd93b, 0xb650, 0xdd4f, 0xd0e8, 0x44c9, 0x1, 0x1);
        gbc.writeMem(0x477c, { 0xf7 });
        gbc.writeMem(0xd939, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xb6);
        EXPECT(gbc.b(),  0xdd);
        EXPECT(gbc.c(),  0x4f);
        EXPECT(gbc.d(),  0xd0);
        EXPECT(gbc.e(),  0xe8);
        EXPECT(gbc.h(),  0x44);
        EXPECT(gbc.l(),  0xc9);
        EXPECT(gbc.sp(), 0xd939);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd939), 0x7d);
        EXPECT(gbc.readMem(0xd93a), 0x47);
        // F7 022F
        gbc.setState(0x7b9a, 0xe3db, 0xccc0, 0x4484, 0x7395, 0xa8ce, 0x1, 0x1);
        gbc.writeMem(0x7b9a, { 0xf7 });
        gbc.writeMem(0xe3d9, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xcc);
        EXPECT(gbc.b(),  0x44);
        EXPECT(gbc.c(),  0x84);
        EXPECT(gbc.d(),  0x73);
        EXPECT(gbc.e(),  0x95);
        EXPECT(gbc.h(),  0xa8);
        EXPECT(gbc.l(),  0xce);
        EXPECT(gbc.sp(), 0xe3d9);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe3d9), 0x9b);
        EXPECT(gbc.readMem(0xe3da), 0x7b);
        // F7 0231
        gbc.setState(0x2320, 0xfcde, 0x14e0, 0x5fe0, 0xcb31, 0xb96b, 0x1, 0x0);
        gbc.writeMem(0x2320, { 0xf7 });
        gbc.writeMem(0xfcdc, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x14);
        EXPECT(gbc.b(),  0x5f);
        EXPECT(gbc.c(),  0xe0);
        EXPECT(gbc.d(),  0xcb);
        EXPECT(gbc.e(),  0x31);
        EXPECT(gbc.h(),  0xb9);
        EXPECT(gbc.l(),  0x6b);
        EXPECT(gbc.sp(), 0xfcdc);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xfcdc), 0x21);
        EXPECT(gbc.readMem(0xfcdd), 0x23);
        // F7 0232
        gbc.setState(0xc35c, 0xa352, 0x290, 0x2417, 0x2056, 0x4f62, 0x1, 0x0);
        gbc.writeMem(0xa350, { 0x0, 0x0 });
        gbc.writeMem(0xc35c, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0x24);
        EXPECT(gbc.c(),  0x17);
        EXPECT(gbc.d(),  0x20);
        EXPECT(gbc.e(),  0x56);
        EXPECT(gbc.h(),  0x4f);
        EXPECT(gbc.l(),  0x62);
        EXPECT(gbc.sp(), 0xa350);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa350), 0x5d);
        EXPECT(gbc.readMem(0xa351), 0xc3);
        EXPECT(gbc.readMem(0xc35c), 0xf7);
        // F7 0234
        gbc.setState(0x6ebd, 0xae1c, 0xdc80, 0x38d9, 0x86d6, 0x2a7e, 0x1, 0x1);
        gbc.writeMem(0x6ebd, { 0xf7 });
        gbc.writeMem(0xae1a, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xdc);
        EXPECT(gbc.b(),  0x38);
        EXPECT(gbc.c(),  0xd9);
        EXPECT(gbc.d(),  0x86);
        EXPECT(gbc.e(),  0xd6);
        EXPECT(gbc.h(),  0x2a);
        EXPECT(gbc.l(),  0x7e);
        EXPECT(gbc.sp(), 0xae1a);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xae1a), 0xbe);
        EXPECT(gbc.readMem(0xae1b), 0x6e);
        // F7 0235
        gbc.setState(0x832e, 0xb4f1, 0x37d0, 0x9e4e, 0xdc5e, 0x4820, 0x0, 0x1);
        gbc.writeMem(0x832e, { 0xf7 });
        gbc.writeMem(0xb4ef, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x37);
        EXPECT(gbc.b(),  0x9e);
        EXPECT(gbc.c(),  0x4e);
        EXPECT(gbc.d(),  0xdc);
        EXPECT(gbc.e(),  0x5e);
        EXPECT(gbc.h(),  0x48);
        EXPECT(gbc.l(),  0x20);
        EXPECT(gbc.sp(), 0xb4ef);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x832e), 0xf7);
        EXPECT(gbc.readMem(0xb4ef), 0x2f);
        EXPECT(gbc.readMem(0xb4f0), 0x83);
        // F7 0237
        gbc.setState(0x249a, 0xeb25, 0xfc00, 0x6327, 0x49d2, 0x27d9, 0x0, 0x0);
        gbc.writeMem(0x249a, { 0xf7 });
        gbc.writeMem(0xeb23, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xfc);
        EXPECT(gbc.b(),  0x63);
        EXPECT(gbc.c(),  0x27);
        EXPECT(gbc.d(),  0x49);
        EXPECT(gbc.e(),  0xd2);
        EXPECT(gbc.h(),  0x27);
        EXPECT(gbc.l(),  0xd9);
        EXPECT(gbc.sp(), 0xeb23);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xeb23), 0x9b);
        EXPECT(gbc.readMem(0xeb24), 0x24);
        // F7 0238
        gbc.setState(0x577e, 0xeeee, 0x6bb0, 0x232e, 0xc49a, 0x74d2, 0x0, 0x1);
        gbc.writeMem(0x577e, { 0xf7 });
        gbc.writeMem(0xeeec, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x6b);
        EXPECT(gbc.b(),  0x23);
        EXPECT(gbc.c(),  0x2e);
        EXPECT(gbc.d(),  0xc4);
        EXPECT(gbc.e(),  0x9a);
        EXPECT(gbc.h(),  0x74);
        EXPECT(gbc.l(),  0xd2);
        EXPECT(gbc.sp(), 0xeeec);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xeeec), 0x7f);
        EXPECT(gbc.readMem(0xeeed), 0x57);
        // F7 023A
        gbc.setState(0x5f2a, 0xeef8, 0xcf80, 0x9115, 0x13af, 0x6e9e, 0x1, 0x1);
        gbc.writeMem(0x5f2a, { 0xf7 });
        gbc.writeMem(0xeef6, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xcf);
        EXPECT(gbc.b(),  0x91);
        EXPECT(gbc.c(),  0x15);
        EXPECT(gbc.d(),  0x13);
        EXPECT(gbc.e(),  0xaf);
        EXPECT(gbc.h(),  0x6e);
        EXPECT(gbc.l(),  0x9e);
        EXPECT(gbc.sp(), 0xeef6);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xeef6), 0x2b);
        EXPECT(gbc.readMem(0xeef7), 0x5f);
        // F7 023B
        gbc.setState(0xc0f8, 0xd778, 0x9590, 0xce84, 0x7649, 0xa0f5, 0x1, 0x0);
        gbc.writeMem(0xc0f8, { 0xf7 });
        gbc.writeMem(0xd776, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x95);
        EXPECT(gbc.b(),  0xce);
        EXPECT(gbc.c(),  0x84);
        EXPECT(gbc.d(),  0x76);
        EXPECT(gbc.e(),  0x49);
        EXPECT(gbc.h(),  0xa0);
        EXPECT(gbc.l(),  0xf5);
        EXPECT(gbc.sp(), 0xd776);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc0f8), 0xf7);
        EXPECT(gbc.readMem(0xd776), 0xf9);
        EXPECT(gbc.readMem(0xd777), 0xc0);
        // F7 023D
        gbc.setState(0x5b36, 0xd2dc, 0x49b0, 0x1130, 0x50d3, 0xda0a, 0x1, 0x1);
        gbc.writeMem(0x5b36, { 0xf7 });
        gbc.writeMem(0xd2da, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x49);
        EXPECT(gbc.b(),  0x11);
        EXPECT(gbc.c(),  0x30);
        EXPECT(gbc.d(),  0x50);
        EXPECT(gbc.e(),  0xd3);
        EXPECT(gbc.h(),  0xda);
        EXPECT(gbc.l(),  0xa);
        EXPECT(gbc.sp(), 0xd2da);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd2da), 0x37);
        EXPECT(gbc.readMem(0xd2db), 0x5b);
        // F7 023E
        gbc.setState(0x95a, 0xa361, 0xc560, 0xf4ff, 0xfcbe, 0xb06b, 0x0, 0x0);
        gbc.writeMem(0x95a, { 0xf7 });
        gbc.writeMem(0xa35f, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xc5);
        EXPECT(gbc.b(),  0xf4);
        EXPECT(gbc.c(),  0xff);
        EXPECT(gbc.d(),  0xfc);
        EXPECT(gbc.e(),  0xbe);
        EXPECT(gbc.h(),  0xb0);
        EXPECT(gbc.l(),  0x6b);
        EXPECT(gbc.sp(), 0xa35f);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa35f), 0x5b);
        EXPECT(gbc.readMem(0xa360), 0x9);
        // F7 023F
        gbc.setState(0x9111, 0x90bb, 0xd0, 0x9346, 0xca67, 0x722a, 0x0, 0x1);
        gbc.writeMem(0x90b9, { 0x0, 0x0 });
        gbc.writeMem(0x9111, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x93);
        EXPECT(gbc.c(),  0x46);
        EXPECT(gbc.d(),  0xca);
        EXPECT(gbc.e(),  0x67);
        EXPECT(gbc.h(),  0x72);
        EXPECT(gbc.l(),  0x2a);
        EXPECT(gbc.sp(), 0x90b9);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x90b9), 0x12);
        EXPECT(gbc.readMem(0x90ba), 0x91);
        EXPECT(gbc.readMem(0x9111), 0xf7);
        // F7 0241
        gbc.setState(0xacf3, 0xa188, 0xb0, 0x72ef, 0x9b23, 0xc7f, 0x0, 0x1);
        gbc.writeMem(0xa186, { 0x0, 0x0 });
        gbc.writeMem(0xacf3, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x72);
        EXPECT(gbc.c(),  0xef);
        EXPECT(gbc.d(),  0x9b);
        EXPECT(gbc.e(),  0x23);
        EXPECT(gbc.h(),  0xc);
        EXPECT(gbc.l(),  0x7f);
        EXPECT(gbc.sp(), 0xa186);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa186), 0xf4);
        EXPECT(gbc.readMem(0xa187), 0xac);
        EXPECT(gbc.readMem(0xacf3), 0xf7);
        // F7 0242
        gbc.setState(0xc6b3, 0x844d, 0xc160, 0x32e6, 0xb8d, 0xdc62, 0x0, 0x0);
        gbc.writeMem(0x844b, { 0x0, 0x0 });
        gbc.writeMem(0xc6b3, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xc1);
        EXPECT(gbc.b(),  0x32);
        EXPECT(gbc.c(),  0xe6);
        EXPECT(gbc.d(),  0xb);
        EXPECT(gbc.e(),  0x8d);
        EXPECT(gbc.h(),  0xdc);
        EXPECT(gbc.l(),  0x62);
        EXPECT(gbc.sp(), 0x844b);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x844b), 0xb4);
        EXPECT(gbc.readMem(0x844c), 0xc6);
        EXPECT(gbc.readMem(0xc6b3), 0xf7);
        // F7 0243
        gbc.setState(0x118, 0xe749, 0xdd40, 0x6a48, 0x249b, 0x3326, 0x1, 0x0);
        gbc.writeMem(0x118, { 0xf7 });
        gbc.writeMem(0xe747, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xdd);
        EXPECT(gbc.b(),  0x6a);
        EXPECT(gbc.c(),  0x48);
        EXPECT(gbc.d(),  0x24);
        EXPECT(gbc.e(),  0x9b);
        EXPECT(gbc.h(),  0x33);
        EXPECT(gbc.l(),  0x26);
        EXPECT(gbc.sp(), 0xe747);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe747), 0x19);
        EXPECT(gbc.readMem(0xe748), 0x1);
        // F7 0244
        gbc.setState(0xecea, 0xd7ba, 0xd160, 0x8df, 0x2de, 0x5e4, 0x1, 0x1);
        gbc.writeMem(0xd7b8, { 0x0, 0x0 });
        gbc.writeMem(0xecea, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xd1);
        EXPECT(gbc.b(),  0x8);
        EXPECT(gbc.c(),  0xdf);
        EXPECT(gbc.d(),  0x2);
        EXPECT(gbc.e(),  0xde);
        EXPECT(gbc.h(),  0x5);
        EXPECT(gbc.l(),  0xe4);
        EXPECT(gbc.sp(), 0xd7b8);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd7b8), 0xeb);
        EXPECT(gbc.readMem(0xd7b9), 0xec);
        EXPECT(gbc.readMem(0xecea), 0xf7);
        // F7 0249
        gbc.setState(0xe167, 0xdcb5, 0x4c20, 0xd63b, 0xba79, 0x5cfe, 0x0, 0x0);
        gbc.writeMem(0xdcb3, { 0x0, 0x0 });
        gbc.writeMem(0xe167, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x4c);
        EXPECT(gbc.b(),  0xd6);
        EXPECT(gbc.c(),  0x3b);
        EXPECT(gbc.d(),  0xba);
        EXPECT(gbc.e(),  0x79);
        EXPECT(gbc.h(),  0x5c);
        EXPECT(gbc.l(),  0xfe);
        EXPECT(gbc.sp(), 0xdcb3);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdcb3), 0x68);
        EXPECT(gbc.readMem(0xdcb4), 0xe1);
        EXPECT(gbc.readMem(0xe167), 0xf7);
        // F7 024C
        gbc.setState(0x37b4, 0xf9a3, 0xd0a0, 0xe0f7, 0xe854, 0x703, 0x0, 0x0);
        gbc.writeMem(0x37b4, { 0xf7 });
        gbc.writeMem(0xf9a1, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xd0);
        EXPECT(gbc.b(),  0xe0);
        EXPECT(gbc.c(),  0xf7);
        EXPECT(gbc.d(),  0xe8);
        EXPECT(gbc.e(),  0x54);
        EXPECT(gbc.h(),  0x7);
        EXPECT(gbc.l(),  0x3);
        EXPECT(gbc.sp(), 0xf9a1);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xf9a1), 0xb5);
        EXPECT(gbc.readMem(0xf9a2), 0x37);
        // F7 024D
        gbc.setState(0xb887, 0xd5fc, 0xf850, 0x2bb6, 0xfda1, 0xe8bf, 0x0, 0x1);
        gbc.writeMem(0xb887, { 0xf7 });
        gbc.writeMem(0xd5fa, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xf8);
        EXPECT(gbc.b(),  0x2b);
        EXPECT(gbc.c(),  0xb6);
        EXPECT(gbc.d(),  0xfd);
        EXPECT(gbc.e(),  0xa1);
        EXPECT(gbc.h(),  0xe8);
        EXPECT(gbc.l(),  0xbf);
        EXPECT(gbc.sp(), 0xd5fa);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb887), 0xf7);
        EXPECT(gbc.readMem(0xd5fa), 0x88);
        EXPECT(gbc.readMem(0xd5fb), 0xb8);
        // F7 024E
        gbc.setState(0x5720, 0xb8de, 0x19c0, 0xc9f2, 0x9599, 0x3dc5, 0x1, 0x1);
        gbc.writeMem(0x5720, { 0xf7 });
        gbc.writeMem(0xb8dc, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x19);
        EXPECT(gbc.b(),  0xc9);
        EXPECT(gbc.c(),  0xf2);
        EXPECT(gbc.d(),  0x95);
        EXPECT(gbc.e(),  0x99);
        EXPECT(gbc.h(),  0x3d);
        EXPECT(gbc.l(),  0xc5);
        EXPECT(gbc.sp(), 0xb8dc);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb8dc), 0x21);
        EXPECT(gbc.readMem(0xb8dd), 0x57);
        // F7 024F
        gbc.setState(0xcc30, 0xb058, 0xea0, 0x8dd, 0xdd16, 0x53d8, 0x0, 0x1);
        gbc.writeMem(0xb056, { 0x0, 0x0 });
        gbc.writeMem(0xcc30, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xe);
        EXPECT(gbc.b(),  0x8);
        EXPECT(gbc.c(),  0xdd);
        EXPECT(gbc.d(),  0xdd);
        EXPECT(gbc.e(),  0x16);
        EXPECT(gbc.h(),  0x53);
        EXPECT(gbc.l(),  0xd8);
        EXPECT(gbc.sp(), 0xb056);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb056), 0x31);
        EXPECT(gbc.readMem(0xb057), 0xcc);
        EXPECT(gbc.readMem(0xcc30), 0xf7);
        // F7 0252
        gbc.setState(0x5f0a, 0xd199, 0xc300, 0xc4d6, 0x3a71, 0x6886, 0x0, 0x1);
        gbc.writeMem(0x5f0a, { 0xf7 });
        gbc.writeMem(0xd197, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xc3);
        EXPECT(gbc.b(),  0xc4);
        EXPECT(gbc.c(),  0xd6);
        EXPECT(gbc.d(),  0x3a);
        EXPECT(gbc.e(),  0x71);
        EXPECT(gbc.h(),  0x68);
        EXPECT(gbc.l(),  0x86);
        EXPECT(gbc.sp(), 0xd197);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd197), 0xb);
        EXPECT(gbc.readMem(0xd198), 0x5f);
        // F7 0253
        gbc.setState(0x443b, 0xfdd9, 0x4f70, 0xc666, 0xdf4f, 0xc7ad, 0x0, 0x1);
        gbc.writeMem(0x443b, { 0xf7 });
        gbc.writeMem(0xfdd7, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x4f);
        EXPECT(gbc.b(),  0xc6);
        EXPECT(gbc.c(),  0x66);
        EXPECT(gbc.d(),  0xdf);
        EXPECT(gbc.e(),  0x4f);
        EXPECT(gbc.h(),  0xc7);
        EXPECT(gbc.l(),  0xad);
        EXPECT(gbc.sp(), 0xfdd7);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xfdd7), 0x3c);
        EXPECT(gbc.readMem(0xfdd8), 0x44);
        // F7 0255
        gbc.setState(0xbf9b, 0xa87f, 0xb4b0, 0x3800, 0x5305, 0x4bca, 0x1, 0x1);
        gbc.writeMem(0xa87d, { 0x0, 0x0 });
        gbc.writeMem(0xbf9b, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xb4);
        EXPECT(gbc.b(),  0x38);
        EXPECT(gbc.c(),  0x0);
        EXPECT(gbc.d(),  0x53);
        EXPECT(gbc.e(),  0x5);
        EXPECT(gbc.h(),  0x4b);
        EXPECT(gbc.l(),  0xca);
        EXPECT(gbc.sp(), 0xa87d);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa87d), 0x9c);
        EXPECT(gbc.readMem(0xa87e), 0xbf);
        EXPECT(gbc.readMem(0xbf9b), 0xf7);
        // F7 0256
        gbc.setState(0x239e, 0xa568, 0xd0a0, 0x50f4, 0x9458, 0x2428, 0x0, 0x1);
        gbc.writeMem(0x239e, { 0xf7 });
        gbc.writeMem(0xa566, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xd0);
        EXPECT(gbc.b(),  0x50);
        EXPECT(gbc.c(),  0xf4);
        EXPECT(gbc.d(),  0x94);
        EXPECT(gbc.e(),  0x58);
        EXPECT(gbc.h(),  0x24);
        EXPECT(gbc.l(),  0x28);
        EXPECT(gbc.sp(), 0xa566);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa566), 0x9f);
        EXPECT(gbc.readMem(0xa567), 0x23);
        // F7 0257
        gbc.setState(0xab91, 0xaf8e, 0x7b80, 0x9f9d, 0x3066, 0x7803, 0x1, 0x1);
        gbc.writeMem(0xab91, { 0xf7 });
        gbc.writeMem(0xaf8c, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x7b);
        EXPECT(gbc.b(),  0x9f);
        EXPECT(gbc.c(),  0x9d);
        EXPECT(gbc.d(),  0x30);
        EXPECT(gbc.e(),  0x66);
        EXPECT(gbc.h(),  0x78);
        EXPECT(gbc.l(),  0x3);
        EXPECT(gbc.sp(), 0xaf8c);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xab91), 0xf7);
        EXPECT(gbc.readMem(0xaf8c), 0x92);
        EXPECT(gbc.readMem(0xaf8d), 0xab);
        // F7 0259
        gbc.setState(0xbd2e, 0x84e3, 0xaf0, 0xa56b, 0x794d, 0xf3c3, 0x0, 0x0);
        gbc.writeMem(0x84e1, { 0x0, 0x0 });
        gbc.writeMem(0xbd2e, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xa);
        EXPECT(gbc.b(),  0xa5);
        EXPECT(gbc.c(),  0x6b);
        EXPECT(gbc.d(),  0x79);
        EXPECT(gbc.e(),  0x4d);
        EXPECT(gbc.h(),  0xf3);
        EXPECT(gbc.l(),  0xc3);
        EXPECT(gbc.sp(), 0x84e1);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x84e1), 0x2f);
        EXPECT(gbc.readMem(0x84e2), 0xbd);
        EXPECT(gbc.readMem(0xbd2e), 0xf7);
        // F7 025A
        gbc.setState(0xc00a, 0xb2ea, 0x1be0, 0x4364, 0x68b0, 0xf486, 0x1, 0x0);
        gbc.writeMem(0xb2e8, { 0x0, 0x0 });
        gbc.writeMem(0xc00a, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x1b);
        EXPECT(gbc.b(),  0x43);
        EXPECT(gbc.c(),  0x64);
        EXPECT(gbc.d(),  0x68);
        EXPECT(gbc.e(),  0xb0);
        EXPECT(gbc.h(),  0xf4);
        EXPECT(gbc.l(),  0x86);
        EXPECT(gbc.sp(), 0xb2e8);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb2e8), 0xb);
        EXPECT(gbc.readMem(0xb2e9), 0xc0);
        EXPECT(gbc.readMem(0xc00a), 0xf7);
        // F7 025B
        gbc.setState(0x9a9e, 0x82b6, 0x7a20, 0xf338, 0x74ec, 0xa03e, 0x1, 0x1);
        gbc.writeMem(0x82b4, { 0x0, 0x0 });
        gbc.writeMem(0x9a9e, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x7a);
        EXPECT(gbc.b(),  0xf3);
        EXPECT(gbc.c(),  0x38);
        EXPECT(gbc.d(),  0x74);
        EXPECT(gbc.e(),  0xec);
        EXPECT(gbc.h(),  0xa0);
        EXPECT(gbc.l(),  0x3e);
        EXPECT(gbc.sp(), 0x82b4);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x82b4), 0x9f);
        EXPECT(gbc.readMem(0x82b5), 0x9a);
        EXPECT(gbc.readMem(0x9a9e), 0xf7);
        // F7 025D
        gbc.setState(0xe577, 0xbaac, 0xe6f0, 0xd8a, 0x248c, 0xf3be, 0x0, 0x1);
        gbc.writeMem(0xbaaa, { 0x0, 0x0 });
        gbc.writeMem(0xe577, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xe6);
        EXPECT(gbc.b(),  0xd);
        EXPECT(gbc.c(),  0x8a);
        EXPECT(gbc.d(),  0x24);
        EXPECT(gbc.e(),  0x8c);
        EXPECT(gbc.h(),  0xf3);
        EXPECT(gbc.l(),  0xbe);
        EXPECT(gbc.sp(), 0xbaaa);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbaaa), 0x78);
        EXPECT(gbc.readMem(0xbaab), 0xe5);
        EXPECT(gbc.readMem(0xe577), 0xf7);
        // F7 0260
        gbc.setState(0x1834, 0xac1a, 0x4830, 0x5d3f, 0xaacf, 0x7925, 0x0, 0x1);
        gbc.writeMem(0x1834, { 0xf7 });
        gbc.writeMem(0xac18, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x48);
        EXPECT(gbc.b(),  0x5d);
        EXPECT(gbc.c(),  0x3f);
        EXPECT(gbc.d(),  0xaa);
        EXPECT(gbc.e(),  0xcf);
        EXPECT(gbc.h(),  0x79);
        EXPECT(gbc.l(),  0x25);
        EXPECT(gbc.sp(), 0xac18);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xac18), 0x35);
        EXPECT(gbc.readMem(0xac19), 0x18);
        // F7 0263
        gbc.setState(0x196, 0xfdc3, 0x38a0, 0xa5bf, 0x66d0, 0x97f0, 0x0, 0x0);
        gbc.writeMem(0x196, { 0xf7 });
        gbc.writeMem(0xfdc1, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x38);
        EXPECT(gbc.b(),  0xa5);
        EXPECT(gbc.c(),  0xbf);
        EXPECT(gbc.d(),  0x66);
        EXPECT(gbc.e(),  0xd0);
        EXPECT(gbc.h(),  0x97);
        EXPECT(gbc.l(),  0xf0);
        EXPECT(gbc.sp(), 0xfdc1);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xfdc1), 0x97);
        EXPECT(gbc.readMem(0xfdc2), 0x1);
        // F7 0264
        gbc.setState(0x9187, 0xd85c, 0x7740, 0xf02, 0x9861, 0x2858, 0x1, 0x0);
        gbc.writeMem(0x9187, { 0xf7 });
        gbc.writeMem(0xd85a, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x77);
        EXPECT(gbc.b(),  0xf);
        EXPECT(gbc.c(),  0x2);
        EXPECT(gbc.d(),  0x98);
        EXPECT(gbc.e(),  0x61);
        EXPECT(gbc.h(),  0x28);
        EXPECT(gbc.l(),  0x58);
        EXPECT(gbc.sp(), 0xd85a);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9187), 0xf7);
        EXPECT(gbc.readMem(0xd85a), 0x88);
        EXPECT(gbc.readMem(0xd85b), 0x91);
        // F7 0267
        gbc.setState(0x713d, 0xcb90, 0xf440, 0xe30e, 0xe27, 0x5d8d, 0x1, 0x1);
        gbc.writeMem(0x713d, { 0xf7 });
        gbc.writeMem(0xcb8e, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xf4);
        EXPECT(gbc.b(),  0xe3);
        EXPECT(gbc.c(),  0xe);
        EXPECT(gbc.d(),  0xe);
        EXPECT(gbc.e(),  0x27);
        EXPECT(gbc.h(),  0x5d);
        EXPECT(gbc.l(),  0x8d);
        EXPECT(gbc.sp(), 0xcb8e);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcb8e), 0x3e);
        EXPECT(gbc.readMem(0xcb8f), 0x71);
        // F7 026A
        gbc.setState(0xcdf7, 0xf429, 0xe840, 0xb74c, 0x9943, 0x6c66, 0x0, 0x1);
        gbc.writeMem(0xcdf7, { 0xf7 });
        gbc.writeMem(0xf427, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xe8);
        EXPECT(gbc.b(),  0xb7);
        EXPECT(gbc.c(),  0x4c);
        EXPECT(gbc.d(),  0x99);
        EXPECT(gbc.e(),  0x43);
        EXPECT(gbc.h(),  0x6c);
        EXPECT(gbc.l(),  0x66);
        EXPECT(gbc.sp(), 0xf427);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcdf7), 0xf7);
        EXPECT(gbc.readMem(0xf427), 0xf8);
        EXPECT(gbc.readMem(0xf428), 0xcd);
        // F7 026C
        gbc.setState(0x84a6, 0xe04c, 0x5630, 0xaaa2, 0xfb5b, 0x6387, 0x1, 0x1);
        gbc.writeMem(0x84a6, { 0xf7 });
        gbc.writeMem(0xe04a, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x56);
        EXPECT(gbc.b(),  0xaa);
        EXPECT(gbc.c(),  0xa2);
        EXPECT(gbc.d(),  0xfb);
        EXPECT(gbc.e(),  0x5b);
        EXPECT(gbc.h(),  0x63);
        EXPECT(gbc.l(),  0x87);
        EXPECT(gbc.sp(), 0xe04a);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x84a6), 0xf7);
        EXPECT(gbc.readMem(0xe04a), 0xa7);
        EXPECT(gbc.readMem(0xe04b), 0x84);
        // F7 026D
        gbc.setState(0xa264, 0xd0c5, 0x7ab0, 0x7b11, 0x6f3c, 0x3224, 0x0, 0x1);
        gbc.writeMem(0xa264, { 0xf7 });
        gbc.writeMem(0xd0c3, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x7a);
        EXPECT(gbc.b(),  0x7b);
        EXPECT(gbc.c(),  0x11);
        EXPECT(gbc.d(),  0x6f);
        EXPECT(gbc.e(),  0x3c);
        EXPECT(gbc.h(),  0x32);
        EXPECT(gbc.l(),  0x24);
        EXPECT(gbc.sp(), 0xd0c3);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa264), 0xf7);
        EXPECT(gbc.readMem(0xd0c3), 0x65);
        EXPECT(gbc.readMem(0xd0c4), 0xa2);
        // F7 0270
        gbc.setState(0x2c44, 0x90b9, 0xc7c0, 0x1349, 0x5ccb, 0x167e, 0x1, 0x0);
        gbc.writeMem(0x2c44, { 0xf7 });
        gbc.writeMem(0x90b7, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xc7);
        EXPECT(gbc.b(),  0x13);
        EXPECT(gbc.c(),  0x49);
        EXPECT(gbc.d(),  0x5c);
        EXPECT(gbc.e(),  0xcb);
        EXPECT(gbc.h(),  0x16);
        EXPECT(gbc.l(),  0x7e);
        EXPECT(gbc.sp(), 0x90b7);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x90b7), 0x45);
        EXPECT(gbc.readMem(0x90b8), 0x2c);
        // F7 0272
        gbc.setState(0x9299, 0x8619, 0x3570, 0x9f6d, 0xbda7, 0x2eca, 0x0, 0x0);
        gbc.writeMem(0x8617, { 0x0, 0x0 });
        gbc.writeMem(0x9299, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x35);
        EXPECT(gbc.b(),  0x9f);
        EXPECT(gbc.c(),  0x6d);
        EXPECT(gbc.d(),  0xbd);
        EXPECT(gbc.e(),  0xa7);
        EXPECT(gbc.h(),  0x2e);
        EXPECT(gbc.l(),  0xca);
        EXPECT(gbc.sp(), 0x8617);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8617), 0x9a);
        EXPECT(gbc.readMem(0x8618), 0x92);
        EXPECT(gbc.readMem(0x9299), 0xf7);
        // F7 0276
        gbc.setState(0xcec0, 0xd6f6, 0x9000, 0xcef, 0x22d1, 0xb8ab, 0x0, 0x0);
        gbc.writeMem(0xcec0, { 0xf7 });
        gbc.writeMem(0xd6f4, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x90);
        EXPECT(gbc.b(),  0xc);
        EXPECT(gbc.c(),  0xef);
        EXPECT(gbc.d(),  0x22);
        EXPECT(gbc.e(),  0xd1);
        EXPECT(gbc.h(),  0xb8);
        EXPECT(gbc.l(),  0xab);
        EXPECT(gbc.sp(), 0xd6f4);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcec0), 0xf7);
        EXPECT(gbc.readMem(0xd6f4), 0xc1);
        EXPECT(gbc.readMem(0xd6f5), 0xce);
        // F7 027A
        gbc.setState(0xcca, 0xe4a9, 0x48c0, 0xa22, 0xc1d0, 0x9b16, 0x0, 0x1);
        gbc.writeMem(0xcca, { 0xf7 });
        gbc.writeMem(0xe4a7, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x48);
        EXPECT(gbc.b(),  0xa);
        EXPECT(gbc.c(),  0x22);
        EXPECT(gbc.d(),  0xc1);
        EXPECT(gbc.e(),  0xd0);
        EXPECT(gbc.h(),  0x9b);
        EXPECT(gbc.l(),  0x16);
        EXPECT(gbc.sp(), 0xe4a7);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe4a7), 0xcb);
        EXPECT(gbc.readMem(0xe4a8), 0xc);
        // F7 027B
        gbc.setState(0x27ca, 0xf4e5, 0xf660, 0x947c, 0x57af, 0xdcf4, 0x0, 0x1);
        gbc.writeMem(0x27ca, { 0xf7 });
        gbc.writeMem(0xf4e3, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xf6);
        EXPECT(gbc.b(),  0x94);
        EXPECT(gbc.c(),  0x7c);
        EXPECT(gbc.d(),  0x57);
        EXPECT(gbc.e(),  0xaf);
        EXPECT(gbc.h(),  0xdc);
        EXPECT(gbc.l(),  0xf4);
        EXPECT(gbc.sp(), 0xf4e3);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xf4e3), 0xcb);
        EXPECT(gbc.readMem(0xf4e4), 0x27);
        // F7 027C
        gbc.setState(0x5e2b, 0x8ba6, 0x330, 0xd56, 0x8e04, 0x8a7, 0x0, 0x1);
        gbc.writeMem(0x5e2b, { 0xf7 });
        gbc.writeMem(0x8ba4, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x3);
        EXPECT(gbc.b(),  0xd);
        EXPECT(gbc.c(),  0x56);
        EXPECT(gbc.d(),  0x8e);
        EXPECT(gbc.e(),  0x4);
        EXPECT(gbc.h(),  0x8);
        EXPECT(gbc.l(),  0xa7);
        EXPECT(gbc.sp(), 0x8ba4);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8ba4), 0x2c);
        EXPECT(gbc.readMem(0x8ba5), 0x5e);
        // F7 027D
        gbc.setState(0xb80d, 0xed5f, 0xfcc0, 0x9c0f, 0xc43a, 0x7a6c, 0x0, 0x0);
        gbc.writeMem(0xb80d, { 0xf7 });
        gbc.writeMem(0xed5d, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xfc);
        EXPECT(gbc.b(),  0x9c);
        EXPECT(gbc.c(),  0xf);
        EXPECT(gbc.d(),  0xc4);
        EXPECT(gbc.e(),  0x3a);
        EXPECT(gbc.h(),  0x7a);
        EXPECT(gbc.l(),  0x6c);
        EXPECT(gbc.sp(), 0xed5d);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb80d), 0xf7);
        EXPECT(gbc.readMem(0xed5d), 0xe);
        EXPECT(gbc.readMem(0xed5e), 0xb8);
        // F7 027E
        gbc.setState(0x6ed8, 0x9bf7, 0xfa90, 0x3bbd, 0x9560, 0x87c0, 0x0, 0x0);
        gbc.writeMem(0x6ed8, { 0xf7 });
        gbc.writeMem(0x9bf5, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xfa);
        EXPECT(gbc.b(),  0x3b);
        EXPECT(gbc.c(),  0xbd);
        EXPECT(gbc.d(),  0x95);
        EXPECT(gbc.e(),  0x60);
        EXPECT(gbc.h(),  0x87);
        EXPECT(gbc.l(),  0xc0);
        EXPECT(gbc.sp(), 0x9bf5);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9bf5), 0xd9);
        EXPECT(gbc.readMem(0x9bf6), 0x6e);
        // F7 027F
        gbc.setState(0xcad3, 0xd5cb, 0x3290, 0x881a, 0x27d0, 0xafec, 0x1, 0x1);
        gbc.writeMem(0xcad3, { 0xf7 });
        gbc.writeMem(0xd5c9, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x32);
        EXPECT(gbc.b(),  0x88);
        EXPECT(gbc.c(),  0x1a);
        EXPECT(gbc.d(),  0x27);
        EXPECT(gbc.e(),  0xd0);
        EXPECT(gbc.h(),  0xaf);
        EXPECT(gbc.l(),  0xec);
        EXPECT(gbc.sp(), 0xd5c9);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcad3), 0xf7);
        EXPECT(gbc.readMem(0xd5c9), 0xd4);
        EXPECT(gbc.readMem(0xd5ca), 0xca);
        // F7 0281
        gbc.setState(0x5f53, 0x9ea8, 0xab50, 0xbe25, 0x34fa, 0x819a, 0x1, 0x1);
        gbc.writeMem(0x5f53, { 0xf7 });
        gbc.writeMem(0x9ea6, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xab);
        EXPECT(gbc.b(),  0xbe);
        EXPECT(gbc.c(),  0x25);
        EXPECT(gbc.d(),  0x34);
        EXPECT(gbc.e(),  0xfa);
        EXPECT(gbc.h(),  0x81);
        EXPECT(gbc.l(),  0x9a);
        EXPECT(gbc.sp(), 0x9ea6);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9ea6), 0x54);
        EXPECT(gbc.readMem(0x9ea7), 0x5f);
        // F7 0283
        gbc.setState(0xafe7, 0xfb82, 0x4190, 0x7f48, 0xf2e3, 0x7a99, 0x1, 0x0);
        gbc.writeMem(0xafe7, { 0xf7 });
        gbc.writeMem(0xfb80, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x41);
        EXPECT(gbc.b(),  0x7f);
        EXPECT(gbc.c(),  0x48);
        EXPECT(gbc.d(),  0xf2);
        EXPECT(gbc.e(),  0xe3);
        EXPECT(gbc.h(),  0x7a);
        EXPECT(gbc.l(),  0x99);
        EXPECT(gbc.sp(), 0xfb80);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xafe7), 0xf7);
        EXPECT(gbc.readMem(0xfb80), 0xe8);
        EXPECT(gbc.readMem(0xfb81), 0xaf);
        // F7 0284
        gbc.setState(0x67a9, 0xccc6, 0x4600, 0xb9fd, 0x6f16, 0x5e62, 0x0, 0x1);
        gbc.writeMem(0x67a9, { 0xf7 });
        gbc.writeMem(0xccc4, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x46);
        EXPECT(gbc.b(),  0xb9);
        EXPECT(gbc.c(),  0xfd);
        EXPECT(gbc.d(),  0x6f);
        EXPECT(gbc.e(),  0x16);
        EXPECT(gbc.h(),  0x5e);
        EXPECT(gbc.l(),  0x62);
        EXPECT(gbc.sp(), 0xccc4);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xccc4), 0xaa);
        EXPECT(gbc.readMem(0xccc5), 0x67);
        // F7 0286
        gbc.setState(0xcaee, 0xdf19, 0x7480, 0x6a5c, 0x8fa0, 0x5830, 0x1, 0x0);
        gbc.writeMem(0xcaee, { 0xf7 });
        gbc.writeMem(0xdf17, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x74);
        EXPECT(gbc.b(),  0x6a);
        EXPECT(gbc.c(),  0x5c);
        EXPECT(gbc.d(),  0x8f);
        EXPECT(gbc.e(),  0xa0);
        EXPECT(gbc.h(),  0x58);
        EXPECT(gbc.l(),  0x30);
        EXPECT(gbc.sp(), 0xdf17);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcaee), 0xf7);
        EXPECT(gbc.readMem(0xdf17), 0xef);
        EXPECT(gbc.readMem(0xdf18), 0xca);
        // F7 0288
        gbc.setState(0x14b4, 0xf064, 0x5170, 0x166d, 0xd459, 0x5aa5, 0x1, 0x1);
        gbc.writeMem(0x14b4, { 0xf7 });
        gbc.writeMem(0xf062, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x51);
        EXPECT(gbc.b(),  0x16);
        EXPECT(gbc.c(),  0x6d);
        EXPECT(gbc.d(),  0xd4);
        EXPECT(gbc.e(),  0x59);
        EXPECT(gbc.h(),  0x5a);
        EXPECT(gbc.l(),  0xa5);
        EXPECT(gbc.sp(), 0xf062);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xf062), 0xb5);
        EXPECT(gbc.readMem(0xf063), 0x14);
        // F7 028A
        gbc.setState(0x6e2d, 0x906f, 0x56a0, 0x5674, 0xc1d3, 0xbe5b, 0x1, 0x1);
        gbc.writeMem(0x6e2d, { 0xf7 });
        gbc.writeMem(0x906d, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x56);
        EXPECT(gbc.b(),  0x56);
        EXPECT(gbc.c(),  0x74);
        EXPECT(gbc.d(),  0xc1);
        EXPECT(gbc.e(),  0xd3);
        EXPECT(gbc.h(),  0xbe);
        EXPECT(gbc.l(),  0x5b);
        EXPECT(gbc.sp(), 0x906d);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x906d), 0x2e);
        EXPECT(gbc.readMem(0x906e), 0x6e);
        // F7 028D
        gbc.setState(0x3653, 0x8964, 0xb1e0, 0x6032, 0x7f68, 0x451d, 0x0, 0x0);
        gbc.writeMem(0x3653, { 0xf7 });
        gbc.writeMem(0x8962, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xb1);
        EXPECT(gbc.b(),  0x60);
        EXPECT(gbc.c(),  0x32);
        EXPECT(gbc.d(),  0x7f);
        EXPECT(gbc.e(),  0x68);
        EXPECT(gbc.h(),  0x45);
        EXPECT(gbc.l(),  0x1d);
        EXPECT(gbc.sp(), 0x8962);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8962), 0x54);
        EXPECT(gbc.readMem(0x8963), 0x36);
        // F7 0291
        gbc.setState(0x3ef, 0xcdc4, 0x5e00, 0x937f, 0xaa30, 0xf9cd, 0x0, 0x0);
        gbc.writeMem(0x3ef, { 0xf7 });
        gbc.writeMem(0xcdc2, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x5e);
        EXPECT(gbc.b(),  0x93);
        EXPECT(gbc.c(),  0x7f);
        EXPECT(gbc.d(),  0xaa);
        EXPECT(gbc.e(),  0x30);
        EXPECT(gbc.h(),  0xf9);
        EXPECT(gbc.l(),  0xcd);
        EXPECT(gbc.sp(), 0xcdc2);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcdc2), 0xf0);
        EXPECT(gbc.readMem(0xcdc3), 0x3);
        // F7 0292
        gbc.setState(0xad4e, 0xce60, 0xec70, 0x3f50, 0xe1a8, 0x21fa, 0x1, 0x0);
        gbc.writeMem(0xad4e, { 0xf7 });
        gbc.writeMem(0xce5e, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xec);
        EXPECT(gbc.b(),  0x3f);
        EXPECT(gbc.c(),  0x50);
        EXPECT(gbc.d(),  0xe1);
        EXPECT(gbc.e(),  0xa8);
        EXPECT(gbc.h(),  0x21);
        EXPECT(gbc.l(),  0xfa);
        EXPECT(gbc.sp(), 0xce5e);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xad4e), 0xf7);
        EXPECT(gbc.readMem(0xce5e), 0x4f);
        EXPECT(gbc.readMem(0xce5f), 0xad);
        // F7 0296
        gbc.setState(0x759c, 0xccf2, 0xa540, 0x5e9c, 0x2dd, 0x3e35, 0x1, 0x0);
        gbc.writeMem(0x759c, { 0xf7 });
        gbc.writeMem(0xccf0, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xa5);
        EXPECT(gbc.b(),  0x5e);
        EXPECT(gbc.c(),  0x9c);
        EXPECT(gbc.d(),  0x2);
        EXPECT(gbc.e(),  0xdd);
        EXPECT(gbc.h(),  0x3e);
        EXPECT(gbc.l(),  0x35);
        EXPECT(gbc.sp(), 0xccf0);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xccf0), 0x9d);
        EXPECT(gbc.readMem(0xccf1), 0x75);
        // F7 0297
        gbc.setState(0x18e5, 0xbbe2, 0xbfb0, 0x37d1, 0x1ba6, 0x97e7, 0x0, 0x0);
        gbc.writeMem(0x18e5, { 0xf7 });
        gbc.writeMem(0xbbe0, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xbf);
        EXPECT(gbc.b(),  0x37);
        EXPECT(gbc.c(),  0xd1);
        EXPECT(gbc.d(),  0x1b);
        EXPECT(gbc.e(),  0xa6);
        EXPECT(gbc.h(),  0x97);
        EXPECT(gbc.l(),  0xe7);
        EXPECT(gbc.sp(), 0xbbe0);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbbe0), 0xe6);
        EXPECT(gbc.readMem(0xbbe1), 0x18);
        // F7 029D
        gbc.setState(0xd6d4, 0xcf95, 0xf250, 0x3c13, 0x3ce2, 0xdbdc, 0x1, 0x1);
        gbc.writeMem(0xcf93, { 0x0, 0x0 });
        gbc.writeMem(0xd6d4, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xf2);
        EXPECT(gbc.b(),  0x3c);
        EXPECT(gbc.c(),  0x13);
        EXPECT(gbc.d(),  0x3c);
        EXPECT(gbc.e(),  0xe2);
        EXPECT(gbc.h(),  0xdb);
        EXPECT(gbc.l(),  0xdc);
        EXPECT(gbc.sp(), 0xcf93);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcf93), 0xd5);
        EXPECT(gbc.readMem(0xcf94), 0xd6);
        EXPECT(gbc.readMem(0xd6d4), 0xf7);
        // F7 02A0
        gbc.setState(0x151f, 0xdafd, 0x6bb0, 0x6e3, 0xe588, 0x2c08, 0x0, 0x0);
        gbc.writeMem(0x151f, { 0xf7 });
        gbc.writeMem(0xdafb, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x6b);
        EXPECT(gbc.b(),  0x6);
        EXPECT(gbc.c(),  0xe3);
        EXPECT(gbc.d(),  0xe5);
        EXPECT(gbc.e(),  0x88);
        EXPECT(gbc.h(),  0x2c);
        EXPECT(gbc.l(),  0x8);
        EXPECT(gbc.sp(), 0xdafb);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xdafb), 0x20);
        EXPECT(gbc.readMem(0xdafc), 0x15);
        // F7 02A2
        gbc.setState(0x3870, 0xc7bc, 0x1d80, 0x7552, 0x1a1e, 0x80c2, 0x1, 0x1);
        gbc.writeMem(0x3870, { 0xf7 });
        gbc.writeMem(0xc7ba, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x1d);
        EXPECT(gbc.b(),  0x75);
        EXPECT(gbc.c(),  0x52);
        EXPECT(gbc.d(),  0x1a);
        EXPECT(gbc.e(),  0x1e);
        EXPECT(gbc.h(),  0x80);
        EXPECT(gbc.l(),  0xc2);
        EXPECT(gbc.sp(), 0xc7ba);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc7ba), 0x71);
        EXPECT(gbc.readMem(0xc7bb), 0x38);
        // F7 02A4
        gbc.setState(0xefce, 0xe9cd, 0xedb0, 0x7bf, 0x56da, 0x18e9, 0x1, 0x1);
        gbc.writeMem(0xe9cb, { 0x0, 0x0 });
        gbc.writeMem(0xefce, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xed);
        EXPECT(gbc.b(),  0x7);
        EXPECT(gbc.c(),  0xbf);
        EXPECT(gbc.d(),  0x56);
        EXPECT(gbc.e(),  0xda);
        EXPECT(gbc.h(),  0x18);
        EXPECT(gbc.l(),  0xe9);
        EXPECT(gbc.sp(), 0xe9cb);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe9cb), 0xcf);
        EXPECT(gbc.readMem(0xe9cc), 0xef);
        EXPECT(gbc.readMem(0xefce), 0xf7);
        // F7 02A5
        gbc.setState(0x4896, 0xbdcd, 0xc350, 0x5a1e, 0x9519, 0xd23b, 0x0, 0x1);
        gbc.writeMem(0x4896, { 0xf7 });
        gbc.writeMem(0xbdcb, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xc3);
        EXPECT(gbc.b(),  0x5a);
        EXPECT(gbc.c(),  0x1e);
        EXPECT(gbc.d(),  0x95);
        EXPECT(gbc.e(),  0x19);
        EXPECT(gbc.h(),  0xd2);
        EXPECT(gbc.l(),  0x3b);
        EXPECT(gbc.sp(), 0xbdcb);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbdcb), 0x97);
        EXPECT(gbc.readMem(0xbdcc), 0x48);
        // F7 02A6
        gbc.setState(0xac84, 0xdbeb, 0x5be0, 0xb087, 0x5732, 0x4c31, 0x0, 0x0);
        gbc.writeMem(0xac84, { 0xf7 });
        gbc.writeMem(0xdbe9, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x5b);
        EXPECT(gbc.b(),  0xb0);
        EXPECT(gbc.c(),  0x87);
        EXPECT(gbc.d(),  0x57);
        EXPECT(gbc.e(),  0x32);
        EXPECT(gbc.h(),  0x4c);
        EXPECT(gbc.l(),  0x31);
        EXPECT(gbc.sp(), 0xdbe9);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xac84), 0xf7);
        EXPECT(gbc.readMem(0xdbe9), 0x85);
        EXPECT(gbc.readMem(0xdbea), 0xac);
        // F7 02AA
        gbc.setState(0x98e3, 0xa205, 0x88c0, 0x6eed, 0x8469, 0xda54, 0x0, 0x0);
        gbc.writeMem(0x98e3, { 0xf7 });
        gbc.writeMem(0xa203, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x88);
        EXPECT(gbc.b(),  0x6e);
        EXPECT(gbc.c(),  0xed);
        EXPECT(gbc.d(),  0x84);
        EXPECT(gbc.e(),  0x69);
        EXPECT(gbc.h(),  0xda);
        EXPECT(gbc.l(),  0x54);
        EXPECT(gbc.sp(), 0xa203);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x98e3), 0xf7);
        EXPECT(gbc.readMem(0xa203), 0xe4);
        EXPECT(gbc.readMem(0xa204), 0x98);
        // F7 02AC
        gbc.setState(0xa952, 0xccf1, 0xb400, 0xc32b, 0xd9cd, 0x52e5, 0x0, 0x1);
        gbc.writeMem(0xa952, { 0xf7 });
        gbc.writeMem(0xccef, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xb4);
        EXPECT(gbc.b(),  0xc3);
        EXPECT(gbc.c(),  0x2b);
        EXPECT(gbc.d(),  0xd9);
        EXPECT(gbc.e(),  0xcd);
        EXPECT(gbc.h(),  0x52);
        EXPECT(gbc.l(),  0xe5);
        EXPECT(gbc.sp(), 0xccef);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa952), 0xf7);
        EXPECT(gbc.readMem(0xccef), 0x53);
        EXPECT(gbc.readMem(0xccf0), 0xa9);
        // F7 02AD
        gbc.setState(0x926b, 0xcb3c, 0xa5e0, 0x624f, 0xf317, 0x36c1, 0x1, 0x0);
        gbc.writeMem(0x926b, { 0xf7 });
        gbc.writeMem(0xcb3a, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xa5);
        EXPECT(gbc.b(),  0x62);
        EXPECT(gbc.c(),  0x4f);
        EXPECT(gbc.d(),  0xf3);
        EXPECT(gbc.e(),  0x17);
        EXPECT(gbc.h(),  0x36);
        EXPECT(gbc.l(),  0xc1);
        EXPECT(gbc.sp(), 0xcb3a);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x926b), 0xf7);
        EXPECT(gbc.readMem(0xcb3a), 0x6c);
        EXPECT(gbc.readMem(0xcb3b), 0x92);
        // F7 02B2
        gbc.setState(0xcca1, 0xf5d3, 0x8360, 0xe9a9, 0x4336, 0xd48c, 0x0, 0x1);
        gbc.writeMem(0xcca1, { 0xf7 });
        gbc.writeMem(0xf5d1, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x83);
        EXPECT(gbc.b(),  0xe9);
        EXPECT(gbc.c(),  0xa9);
        EXPECT(gbc.d(),  0x43);
        EXPECT(gbc.e(),  0x36);
        EXPECT(gbc.h(),  0xd4);
        EXPECT(gbc.l(),  0x8c);
        EXPECT(gbc.sp(), 0xf5d1);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcca1), 0xf7);
        EXPECT(gbc.readMem(0xf5d1), 0xa2);
        EXPECT(gbc.readMem(0xf5d2), 0xcc);
        // F7 02B3
        gbc.setState(0xa915, 0xd7c7, 0x5a70, 0x603f, 0xdfe2, 0xe47, 0x1, 0x0);
        gbc.writeMem(0xa915, { 0xf7 });
        gbc.writeMem(0xd7c5, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x5a);
        EXPECT(gbc.b(),  0x60);
        EXPECT(gbc.c(),  0x3f);
        EXPECT(gbc.d(),  0xdf);
        EXPECT(gbc.e(),  0xe2);
        EXPECT(gbc.h(),  0xe);
        EXPECT(gbc.l(),  0x47);
        EXPECT(gbc.sp(), 0xd7c5);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa915), 0xf7);
        EXPECT(gbc.readMem(0xd7c5), 0x16);
        EXPECT(gbc.readMem(0xd7c6), 0xa9);
        // F7 02B5
        gbc.setState(0x2960, 0x8c72, 0x9d0, 0x761a, 0xd2ae, 0xce0d, 0x1, 0x0);
        gbc.writeMem(0x2960, { 0xf7 });
        gbc.writeMem(0x8c70, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x9);
        EXPECT(gbc.b(),  0x76);
        EXPECT(gbc.c(),  0x1a);
        EXPECT(gbc.d(),  0xd2);
        EXPECT(gbc.e(),  0xae);
        EXPECT(gbc.h(),  0xce);
        EXPECT(gbc.l(),  0xd);
        EXPECT(gbc.sp(), 0x8c70);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8c70), 0x61);
        EXPECT(gbc.readMem(0x8c71), 0x29);
        // F7 02B8
        gbc.setState(0x4a85, 0x8417, 0x2420, 0xb21, 0x94b7, 0xc554, 0x1, 0x0);
        gbc.writeMem(0x4a85, { 0xf7 });
        gbc.writeMem(0x8415, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x24);
        EXPECT(gbc.b(),  0xb);
        EXPECT(gbc.c(),  0x21);
        EXPECT(gbc.d(),  0x94);
        EXPECT(gbc.e(),  0xb7);
        EXPECT(gbc.h(),  0xc5);
        EXPECT(gbc.l(),  0x54);
        EXPECT(gbc.sp(), 0x8415);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8415), 0x86);
        EXPECT(gbc.readMem(0x8416), 0x4a);
        // F7 02BC
        gbc.setState(0x6b57, 0x8dcb, 0x56c0, 0xeafb, 0x9426, 0xc747, 0x1, 0x0);
        gbc.writeMem(0x6b57, { 0xf7 });
        gbc.writeMem(0x8dc9, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x56);
        EXPECT(gbc.b(),  0xea);
        EXPECT(gbc.c(),  0xfb);
        EXPECT(gbc.d(),  0x94);
        EXPECT(gbc.e(),  0x26);
        EXPECT(gbc.h(),  0xc7);
        EXPECT(gbc.l(),  0x47);
        EXPECT(gbc.sp(), 0x8dc9);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8dc9), 0x58);
        EXPECT(gbc.readMem(0x8dca), 0x6b);
        // F7 02BD
        gbc.setState(0x5d21, 0xcdcc, 0xd9d0, 0xfd68, 0x50e3, 0xe837, 0x0, 0x0);
        gbc.writeMem(0x5d21, { 0xf7 });
        gbc.writeMem(0xcdca, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xd9);
        EXPECT(gbc.b(),  0xfd);
        EXPECT(gbc.c(),  0x68);
        EXPECT(gbc.d(),  0x50);
        EXPECT(gbc.e(),  0xe3);
        EXPECT(gbc.h(),  0xe8);
        EXPECT(gbc.l(),  0x37);
        EXPECT(gbc.sp(), 0xcdca);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcdca), 0x22);
        EXPECT(gbc.readMem(0xcdcb), 0x5d);
        // F7 02BF
        gbc.setState(0xeda9, 0xcc83, 0x3160, 0x6b91, 0xb30a, 0x9dcd, 0x0, 0x0);
        gbc.writeMem(0xcc81, { 0x0, 0x0 });
        gbc.writeMem(0xeda9, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x31);
        EXPECT(gbc.b(),  0x6b);
        EXPECT(gbc.c(),  0x91);
        EXPECT(gbc.d(),  0xb3);
        EXPECT(gbc.e(),  0xa);
        EXPECT(gbc.h(),  0x9d);
        EXPECT(gbc.l(),  0xcd);
        EXPECT(gbc.sp(), 0xcc81);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcc81), 0xaa);
        EXPECT(gbc.readMem(0xcc82), 0xed);
        EXPECT(gbc.readMem(0xeda9), 0xf7);
        // F7 02C5
        gbc.setState(0xbedf, 0xef8c, 0x8330, 0x1d77, 0x85d4, 0x815, 0x1, 0x0);
        gbc.writeMem(0xbedf, { 0xf7 });
        gbc.writeMem(0xef8a, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x83);
        EXPECT(gbc.b(),  0x1d);
        EXPECT(gbc.c(),  0x77);
        EXPECT(gbc.d(),  0x85);
        EXPECT(gbc.e(),  0xd4);
        EXPECT(gbc.h(),  0x8);
        EXPECT(gbc.l(),  0x15);
        EXPECT(gbc.sp(), 0xef8a);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbedf), 0xf7);
        EXPECT(gbc.readMem(0xef8a), 0xe0);
        EXPECT(gbc.readMem(0xef8b), 0xbe);
        // F7 02C6
        gbc.setState(0x91e1, 0xf528, 0x3860, 0x4710, 0x909d, 0x4c86, 0x0, 0x1);
        gbc.writeMem(0x91e1, { 0xf7 });
        gbc.writeMem(0xf526, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x38);
        EXPECT(gbc.b(),  0x47);
        EXPECT(gbc.c(),  0x10);
        EXPECT(gbc.d(),  0x90);
        EXPECT(gbc.e(),  0x9d);
        EXPECT(gbc.h(),  0x4c);
        EXPECT(gbc.l(),  0x86);
        EXPECT(gbc.sp(), 0xf526);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x91e1), 0xf7);
        EXPECT(gbc.readMem(0xf526), 0xe2);
        EXPECT(gbc.readMem(0xf527), 0x91);
        // F7 02CC
        gbc.setState(0x2d73, 0xab91, 0xc990, 0x1b5c, 0xc311, 0x6c2a, 0x1, 0x0);
        gbc.writeMem(0x2d73, { 0xf7 });
        gbc.writeMem(0xab8f, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xc9);
        EXPECT(gbc.b(),  0x1b);
        EXPECT(gbc.c(),  0x5c);
        EXPECT(gbc.d(),  0xc3);
        EXPECT(gbc.e(),  0x11);
        EXPECT(gbc.h(),  0x6c);
        EXPECT(gbc.l(),  0x2a);
        EXPECT(gbc.sp(), 0xab8f);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xab8f), 0x74);
        EXPECT(gbc.readMem(0xab90), 0x2d);
        // F7 02CD
        gbc.setState(0x86e0, 0xfabf, 0x71c0, 0x5d4b, 0xa28, 0x21a4, 0x1, 0x0);
        gbc.writeMem(0x86e0, { 0xf7 });
        gbc.writeMem(0xfabd, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x71);
        EXPECT(gbc.b(),  0x5d);
        EXPECT(gbc.c(),  0x4b);
        EXPECT(gbc.d(),  0xa);
        EXPECT(gbc.e(),  0x28);
        EXPECT(gbc.h(),  0x21);
        EXPECT(gbc.l(),  0xa4);
        EXPECT(gbc.sp(), 0xfabd);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x86e0), 0xf7);
        EXPECT(gbc.readMem(0xfabd), 0xe1);
        EXPECT(gbc.readMem(0xfabe), 0x86);
        // F7 02CE
        gbc.setState(0xd91, 0xe038, 0x69a0, 0x3476, 0x7af2, 0xaa48, 0x0, 0x1);
        gbc.writeMem(0xd91, { 0xf7 });
        gbc.writeMem(0xe036, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x69);
        EXPECT(gbc.b(),  0x34);
        EXPECT(gbc.c(),  0x76);
        EXPECT(gbc.d(),  0x7a);
        EXPECT(gbc.e(),  0xf2);
        EXPECT(gbc.h(),  0xaa);
        EXPECT(gbc.l(),  0x48);
        EXPECT(gbc.sp(), 0xe036);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe036), 0x92);
        EXPECT(gbc.readMem(0xe037), 0xd);
        // F7 02D1
        gbc.setState(0x2bf0, 0xf5ac, 0xa300, 0x5793, 0xe80a, 0x811b, 0x1, 0x1);
        gbc.writeMem(0x2bf0, { 0xf7 });
        gbc.writeMem(0xf5aa, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xa3);
        EXPECT(gbc.b(),  0x57);
        EXPECT(gbc.c(),  0x93);
        EXPECT(gbc.d(),  0xe8);
        EXPECT(gbc.e(),  0xa);
        EXPECT(gbc.h(),  0x81);
        EXPECT(gbc.l(),  0x1b);
        EXPECT(gbc.sp(), 0xf5aa);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xf5aa), 0xf1);
        EXPECT(gbc.readMem(0xf5ab), 0x2b);
        // F7 02D3
        gbc.setState(0x65d5, 0xc12d, 0xdf10, 0x29d, 0x763, 0x68cf, 0x1, 0x1);
        gbc.writeMem(0x65d5, { 0xf7 });
        gbc.writeMem(0xc12b, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xdf);
        EXPECT(gbc.b(),  0x2);
        EXPECT(gbc.c(),  0x9d);
        EXPECT(gbc.d(),  0x7);
        EXPECT(gbc.e(),  0x63);
        EXPECT(gbc.h(),  0x68);
        EXPECT(gbc.l(),  0xcf);
        EXPECT(gbc.sp(), 0xc12b);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc12b), 0xd6);
        EXPECT(gbc.readMem(0xc12c), 0x65);
        // F7 02D6
        gbc.setState(0x6a6f, 0xd6e0, 0xd5a0, 0x400a, 0xfb15, 0x4e4c, 0x0, 0x0);
        gbc.writeMem(0x6a6f, { 0xf7 });
        gbc.writeMem(0xd6de, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xd5);
        EXPECT(gbc.b(),  0x40);
        EXPECT(gbc.c(),  0xa);
        EXPECT(gbc.d(),  0xfb);
        EXPECT(gbc.e(),  0x15);
        EXPECT(gbc.h(),  0x4e);
        EXPECT(gbc.l(),  0x4c);
        EXPECT(gbc.sp(), 0xd6de);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd6de), 0x70);
        EXPECT(gbc.readMem(0xd6df), 0x6a);
        // F7 02D8
        gbc.setState(0xe166, 0xa86c, 0x12b0, 0x8a68, 0x6cb3, 0x8576, 0x0, 0x0);
        gbc.writeMem(0xa86a, { 0x0, 0x0 });
        gbc.writeMem(0xe166, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x12);
        EXPECT(gbc.b(),  0x8a);
        EXPECT(gbc.c(),  0x68);
        EXPECT(gbc.d(),  0x6c);
        EXPECT(gbc.e(),  0xb3);
        EXPECT(gbc.h(),  0x85);
        EXPECT(gbc.l(),  0x76);
        EXPECT(gbc.sp(), 0xa86a);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa86a), 0x67);
        EXPECT(gbc.readMem(0xa86b), 0xe1);
        EXPECT(gbc.readMem(0xe166), 0xf7);
        // F7 02DA
        gbc.setState(0x19b0, 0x8c39, 0x3b70, 0x3102, 0xaba1, 0xf531, 0x0, 0x1);
        gbc.writeMem(0x19b0, { 0xf7 });
        gbc.writeMem(0x8c37, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x3b);
        EXPECT(gbc.b(),  0x31);
        EXPECT(gbc.c(),  0x2);
        EXPECT(gbc.d(),  0xab);
        EXPECT(gbc.e(),  0xa1);
        EXPECT(gbc.h(),  0xf5);
        EXPECT(gbc.l(),  0x31);
        EXPECT(gbc.sp(), 0x8c37);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8c37), 0xb1);
        EXPECT(gbc.readMem(0x8c38), 0x19);
        // F7 02DB
        gbc.setState(0xd42d, 0xca6b, 0x93f0, 0xd85d, 0xf0f3, 0xa332, 0x1, 0x1);
        gbc.writeMem(0xca69, { 0x0, 0x0 });
        gbc.writeMem(0xd42d, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x93);
        EXPECT(gbc.b(),  0xd8);
        EXPECT(gbc.c(),  0x5d);
        EXPECT(gbc.d(),  0xf0);
        EXPECT(gbc.e(),  0xf3);
        EXPECT(gbc.h(),  0xa3);
        EXPECT(gbc.l(),  0x32);
        EXPECT(gbc.sp(), 0xca69);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xca69), 0x2e);
        EXPECT(gbc.readMem(0xca6a), 0xd4);
        EXPECT(gbc.readMem(0xd42d), 0xf7);
        // F7 02DD
        gbc.setState(0x8215, 0xba2a, 0xd3f0, 0xf032, 0x5ab2, 0xb55e, 0x1, 0x0);
        gbc.writeMem(0x8215, { 0xf7 });
        gbc.writeMem(0xba28, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xd3);
        EXPECT(gbc.b(),  0xf0);
        EXPECT(gbc.c(),  0x32);
        EXPECT(gbc.d(),  0x5a);
        EXPECT(gbc.e(),  0xb2);
        EXPECT(gbc.h(),  0xb5);
        EXPECT(gbc.l(),  0x5e);
        EXPECT(gbc.sp(), 0xba28);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8215), 0xf7);
        EXPECT(gbc.readMem(0xba28), 0x16);
        EXPECT(gbc.readMem(0xba29), 0x82);
        // F7 02E0
        gbc.setState(0x8624, 0x869e, 0x5370, 0xa183, 0x25be, 0xe28d, 0x0, 0x1);
        gbc.writeMem(0x8624, { 0xf7 });
        gbc.writeMem(0x869c, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x53);
        EXPECT(gbc.b(),  0xa1);
        EXPECT(gbc.c(),  0x83);
        EXPECT(gbc.d(),  0x25);
        EXPECT(gbc.e(),  0xbe);
        EXPECT(gbc.h(),  0xe2);
        EXPECT(gbc.l(),  0x8d);
        EXPECT(gbc.sp(), 0x869c);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8624), 0xf7);
        EXPECT(gbc.readMem(0x869c), 0x25);
        EXPECT(gbc.readMem(0x869d), 0x86);
        // F7 02E1
        gbc.setState(0xd819, 0x83d1, 0x9e10, 0xaa49, 0x241c, 0x4afc, 0x1, 0x1);
        gbc.writeMem(0x83cf, { 0x0, 0x0 });
        gbc.writeMem(0xd819, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x9e);
        EXPECT(gbc.b(),  0xaa);
        EXPECT(gbc.c(),  0x49);
        EXPECT(gbc.d(),  0x24);
        EXPECT(gbc.e(),  0x1c);
        EXPECT(gbc.h(),  0x4a);
        EXPECT(gbc.l(),  0xfc);
        EXPECT(gbc.sp(), 0x83cf);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x83cf), 0x1a);
        EXPECT(gbc.readMem(0x83d0), 0xd8);
        EXPECT(gbc.readMem(0xd819), 0xf7);
        // F7 02E4
        gbc.setState(0x27ea, 0xc2c6, 0xa570, 0xc2d2, 0xec4f, 0x118a, 0x1, 0x0);
        gbc.writeMem(0x27ea, { 0xf7 });
        gbc.writeMem(0xc2c4, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xa5);
        EXPECT(gbc.b(),  0xc2);
        EXPECT(gbc.c(),  0xd2);
        EXPECT(gbc.d(),  0xec);
        EXPECT(gbc.e(),  0x4f);
        EXPECT(gbc.h(),  0x11);
        EXPECT(gbc.l(),  0x8a);
        EXPECT(gbc.sp(), 0xc2c4);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc2c4), 0xeb);
        EXPECT(gbc.readMem(0xc2c5), 0x27);
        // F7 02E6
        gbc.setState(0x188c, 0x9312, 0x9fa0, 0xa3f4, 0x74d3, 0xfe1f, 0x1, 0x1);
        gbc.writeMem(0x188c, { 0xf7 });
        gbc.writeMem(0x9310, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x9f);
        EXPECT(gbc.b(),  0xa3);
        EXPECT(gbc.c(),  0xf4);
        EXPECT(gbc.d(),  0x74);
        EXPECT(gbc.e(),  0xd3);
        EXPECT(gbc.h(),  0xfe);
        EXPECT(gbc.l(),  0x1f);
        EXPECT(gbc.sp(), 0x9310);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9310), 0x8d);
        EXPECT(gbc.readMem(0x9311), 0x18);
        // F7 02E7
        gbc.setState(0x47e4, 0xe650, 0x31d0, 0x1259, 0xb9fd, 0x1a55, 0x0, 0x1);
        gbc.writeMem(0x47e4, { 0xf7 });
        gbc.writeMem(0xe64e, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x31);
        EXPECT(gbc.b(),  0x12);
        EXPECT(gbc.c(),  0x59);
        EXPECT(gbc.d(),  0xb9);
        EXPECT(gbc.e(),  0xfd);
        EXPECT(gbc.h(),  0x1a);
        EXPECT(gbc.l(),  0x55);
        EXPECT(gbc.sp(), 0xe64e);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe64e), 0xe5);
        EXPECT(gbc.readMem(0xe64f), 0x47);
        // F7 02E9
        gbc.setState(0x5ee9, 0xfca2, 0x20e0, 0xb8b0, 0x5ee6, 0x51, 0x1, 0x0);
        gbc.writeMem(0x5ee9, { 0xf7 });
        gbc.writeMem(0xfca0, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0xb8);
        EXPECT(gbc.c(),  0xb0);
        EXPECT(gbc.d(),  0x5e);
        EXPECT(gbc.e(),  0xe6);
        EXPECT(gbc.h(),  0x0);
        EXPECT(gbc.l(),  0x51);
        EXPECT(gbc.sp(), 0xfca0);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xfca0), 0xea);
        EXPECT(gbc.readMem(0xfca1), 0x5e);
        // F7 02EA
        gbc.setState(0x254e, 0x842e, 0xd070, 0x1a01, 0x65ce, 0x378e, 0x1, 0x1);
        gbc.writeMem(0x254e, { 0xf7 });
        gbc.writeMem(0x842c, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xd0);
        EXPECT(gbc.b(),  0x1a);
        EXPECT(gbc.c(),  0x1);
        EXPECT(gbc.d(),  0x65);
        EXPECT(gbc.e(),  0xce);
        EXPECT(gbc.h(),  0x37);
        EXPECT(gbc.l(),  0x8e);
        EXPECT(gbc.sp(), 0x842c);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x842c), 0x4f);
        EXPECT(gbc.readMem(0x842d), 0x25);
        // F7 02EB
        gbc.setState(0xaf59, 0xb632, 0xb4d0, 0x5bd1, 0x6840, 0xbe6e, 0x0, 0x0);
        gbc.writeMem(0xaf59, { 0xf7 });
        gbc.writeMem(0xb630, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xb4);
        EXPECT(gbc.b(),  0x5b);
        EXPECT(gbc.c(),  0xd1);
        EXPECT(gbc.d(),  0x68);
        EXPECT(gbc.e(),  0x40);
        EXPECT(gbc.h(),  0xbe);
        EXPECT(gbc.l(),  0x6e);
        EXPECT(gbc.sp(), 0xb630);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xaf59), 0xf7);
        EXPECT(gbc.readMem(0xb630), 0x5a);
        EXPECT(gbc.readMem(0xb631), 0xaf);
        // F7 02EC
        gbc.setState(0xa4eb, 0xcf96, 0x1cc0, 0x9a68, 0x2361, 0x2933, 0x0, 0x0);
        gbc.writeMem(0xa4eb, { 0xf7 });
        gbc.writeMem(0xcf94, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x1c);
        EXPECT(gbc.b(),  0x9a);
        EXPECT(gbc.c(),  0x68);
        EXPECT(gbc.d(),  0x23);
        EXPECT(gbc.e(),  0x61);
        EXPECT(gbc.h(),  0x29);
        EXPECT(gbc.l(),  0x33);
        EXPECT(gbc.sp(), 0xcf94);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa4eb), 0xf7);
        EXPECT(gbc.readMem(0xcf94), 0xec);
        EXPECT(gbc.readMem(0xcf95), 0xa4);
        // F7 02ED
        gbc.setState(0xceee, 0xf29f, 0xb6f0, 0x9bf2, 0x8912, 0xc07, 0x1, 0x0);
        gbc.writeMem(0xceee, { 0xf7 });
        gbc.writeMem(0xf29d, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xb6);
        EXPECT(gbc.b(),  0x9b);
        EXPECT(gbc.c(),  0xf2);
        EXPECT(gbc.d(),  0x89);
        EXPECT(gbc.e(),  0x12);
        EXPECT(gbc.h(),  0xc);
        EXPECT(gbc.l(),  0x7);
        EXPECT(gbc.sp(), 0xf29d);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xceee), 0xf7);
        EXPECT(gbc.readMem(0xf29d), 0xef);
        EXPECT(gbc.readMem(0xf29e), 0xce);
        // F7 02EE
        gbc.setState(0x7470, 0xb967, 0x4f20, 0xcdc9, 0x6442, 0x26a, 0x0, 0x0);
        gbc.writeMem(0x7470, { 0xf7 });
        gbc.writeMem(0xb965, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x4f);
        EXPECT(gbc.b(),  0xcd);
        EXPECT(gbc.c(),  0xc9);
        EXPECT(gbc.d(),  0x64);
        EXPECT(gbc.e(),  0x42);
        EXPECT(gbc.h(),  0x2);
        EXPECT(gbc.l(),  0x6a);
        EXPECT(gbc.sp(), 0xb965);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb965), 0x71);
        EXPECT(gbc.readMem(0xb966), 0x74);
        // F7 02F0
        gbc.setState(0x51ec, 0xd4ce, 0xb5f0, 0x8530, 0x938, 0x743f, 0x1, 0x0);
        gbc.writeMem(0x51ec, { 0xf7 });
        gbc.writeMem(0xd4cc, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xb5);
        EXPECT(gbc.b(),  0x85);
        EXPECT(gbc.c(),  0x30);
        EXPECT(gbc.d(),  0x9);
        EXPECT(gbc.e(),  0x38);
        EXPECT(gbc.h(),  0x74);
        EXPECT(gbc.l(),  0x3f);
        EXPECT(gbc.sp(), 0xd4cc);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd4cc), 0xed);
        EXPECT(gbc.readMem(0xd4cd), 0x51);
        // F7 02F1
        gbc.setState(0x2c51, 0xd82c, 0x7f70, 0x2370, 0xac8a, 0xdc98, 0x0, 0x1);
        gbc.writeMem(0x2c51, { 0xf7 });
        gbc.writeMem(0xd82a, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x7f);
        EXPECT(gbc.b(),  0x23);
        EXPECT(gbc.c(),  0x70);
        EXPECT(gbc.d(),  0xac);
        EXPECT(gbc.e(),  0x8a);
        EXPECT(gbc.h(),  0xdc);
        EXPECT(gbc.l(),  0x98);
        EXPECT(gbc.sp(), 0xd82a);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd82a), 0x52);
        EXPECT(gbc.readMem(0xd82b), 0x2c);
        // F7 02F7
        gbc.setState(0x933d, 0x81fe, 0x5360, 0xa4a6, 0x6354, 0xd504, 0x1, 0x1);
        gbc.writeMem(0x81fc, { 0x0, 0x0 });
        gbc.writeMem(0x933d, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x53);
        EXPECT(gbc.b(),  0xa4);
        EXPECT(gbc.c(),  0xa6);
        EXPECT(gbc.d(),  0x63);
        EXPECT(gbc.e(),  0x54);
        EXPECT(gbc.h(),  0xd5);
        EXPECT(gbc.l(),  0x4);
        EXPECT(gbc.sp(), 0x81fc);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x81fc), 0x3e);
        EXPECT(gbc.readMem(0x81fd), 0x93);
        EXPECT(gbc.readMem(0x933d), 0xf7);
        // F7 02F8
        gbc.setState(0x97c9, 0xb53f, 0xb900, 0xe295, 0x7dfe, 0x5e8f, 0x0, 0x0);
        gbc.writeMem(0x97c9, { 0xf7 });
        gbc.writeMem(0xb53d, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xb9);
        EXPECT(gbc.b(),  0xe2);
        EXPECT(gbc.c(),  0x95);
        EXPECT(gbc.d(),  0x7d);
        EXPECT(gbc.e(),  0xfe);
        EXPECT(gbc.h(),  0x5e);
        EXPECT(gbc.l(),  0x8f);
        EXPECT(gbc.sp(), 0xb53d);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x97c9), 0xf7);
        EXPECT(gbc.readMem(0xb53d), 0xca);
        EXPECT(gbc.readMem(0xb53e), 0x97);
        // F7 02F9
        gbc.setState(0xe51a, 0xcbb8, 0x9850, 0x31f5, 0x1571, 0x73bc, 0x0, 0x0);
        gbc.writeMem(0xcbb6, { 0x0, 0x0 });
        gbc.writeMem(0xe51a, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x98);
        EXPECT(gbc.b(),  0x31);
        EXPECT(gbc.c(),  0xf5);
        EXPECT(gbc.d(),  0x15);
        EXPECT(gbc.e(),  0x71);
        EXPECT(gbc.h(),  0x73);
        EXPECT(gbc.l(),  0xbc);
        EXPECT(gbc.sp(), 0xcbb6);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcbb6), 0x1b);
        EXPECT(gbc.readMem(0xcbb7), 0xe5);
        EXPECT(gbc.readMem(0xe51a), 0xf7);
        // F7 02FA
        gbc.setState(0x461c, 0xbc9f, 0x1bb0, 0xf06, 0x3e0f, 0xf338, 0x1, 0x0);
        gbc.writeMem(0x461c, { 0xf7 });
        gbc.writeMem(0xbc9d, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x1b);
        EXPECT(gbc.b(),  0xf);
        EXPECT(gbc.c(),  0x6);
        EXPECT(gbc.d(),  0x3e);
        EXPECT(gbc.e(),  0xf);
        EXPECT(gbc.h(),  0xf3);
        EXPECT(gbc.l(),  0x38);
        EXPECT(gbc.sp(), 0xbc9d);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbc9d), 0x1d);
        EXPECT(gbc.readMem(0xbc9e), 0x46);
        // F7 02FB
        gbc.setState(0x4819, 0xdf26, 0x270, 0xd5d8, 0x8ab2, 0xf0a8, 0x1, 0x0);
        gbc.writeMem(0x4819, { 0xf7 });
        gbc.writeMem(0xdf24, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0xd5);
        EXPECT(gbc.c(),  0xd8);
        EXPECT(gbc.d(),  0x8a);
        EXPECT(gbc.e(),  0xb2);
        EXPECT(gbc.h(),  0xf0);
        EXPECT(gbc.l(),  0xa8);
        EXPECT(gbc.sp(), 0xdf24);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xdf24), 0x1a);
        EXPECT(gbc.readMem(0xdf25), 0x48);
        // F7 0305
        gbc.setState(0xc513, 0x8142, 0xa530, 0x8f1, 0xa2b0, 0x24e5, 0x1, 0x1);
        gbc.writeMem(0x8140, { 0x0, 0x0 });
        gbc.writeMem(0xc513, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xa5);
        EXPECT(gbc.b(),  0x8);
        EXPECT(gbc.c(),  0xf1);
        EXPECT(gbc.d(),  0xa2);
        EXPECT(gbc.e(),  0xb0);
        EXPECT(gbc.h(),  0x24);
        EXPECT(gbc.l(),  0xe5);
        EXPECT(gbc.sp(), 0x8140);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8140), 0x14);
        EXPECT(gbc.readMem(0x8141), 0xc5);
        EXPECT(gbc.readMem(0xc513), 0xf7);
        // F7 0306
        gbc.setState(0x1dd3, 0xdc15, 0xc5c0, 0x1912, 0x105e, 0x6fc3, 0x0, 0x1);
        gbc.writeMem(0x1dd3, { 0xf7 });
        gbc.writeMem(0xdc13, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xc5);
        EXPECT(gbc.b(),  0x19);
        EXPECT(gbc.c(),  0x12);
        EXPECT(gbc.d(),  0x10);
        EXPECT(gbc.e(),  0x5e);
        EXPECT(gbc.h(),  0x6f);
        EXPECT(gbc.l(),  0xc3);
        EXPECT(gbc.sp(), 0xdc13);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdc13), 0xd4);
        EXPECT(gbc.readMem(0xdc14), 0x1d);
        // F7 0308
        gbc.setState(0xc63e, 0xb52d, 0xc970, 0xb5ed, 0x9567, 0x5885, 0x0, 0x1);
        gbc.writeMem(0xb52b, { 0x0, 0x0 });
        gbc.writeMem(0xc63e, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xc9);
        EXPECT(gbc.b(),  0xb5);
        EXPECT(gbc.c(),  0xed);
        EXPECT(gbc.d(),  0x95);
        EXPECT(gbc.e(),  0x67);
        EXPECT(gbc.h(),  0x58);
        EXPECT(gbc.l(),  0x85);
        EXPECT(gbc.sp(), 0xb52b);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb52b), 0x3f);
        EXPECT(gbc.readMem(0xb52c), 0xc6);
        EXPECT(gbc.readMem(0xc63e), 0xf7);
        // F7 0309
        gbc.setState(0x40, 0xc055, 0xdad0, 0x2379, 0x8566, 0x3afd, 0x1, 0x0);
        gbc.writeMem(0x40, { 0xf7 });
        gbc.writeMem(0xc053, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xda);
        EXPECT(gbc.b(),  0x23);
        EXPECT(gbc.c(),  0x79);
        EXPECT(gbc.d(),  0x85);
        EXPECT(gbc.e(),  0x66);
        EXPECT(gbc.h(),  0x3a);
        EXPECT(gbc.l(),  0xfd);
        EXPECT(gbc.sp(), 0xc053);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc053), 0x41);
        EXPECT(gbc.readMem(0xc054), 0x0);
        // F7 030B
        gbc.setState(0xcd80, 0x9fe7, 0xe5f0, 0x87d1, 0xa24, 0x2fe, 0x1, 0x1);
        gbc.writeMem(0x9fe5, { 0x0, 0x0 });
        gbc.writeMem(0xcd80, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xe5);
        EXPECT(gbc.b(),  0x87);
        EXPECT(gbc.c(),  0xd1);
        EXPECT(gbc.d(),  0xa);
        EXPECT(gbc.e(),  0x24);
        EXPECT(gbc.h(),  0x2);
        EXPECT(gbc.l(),  0xfe);
        EXPECT(gbc.sp(), 0x9fe5);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9fe5), 0x81);
        EXPECT(gbc.readMem(0x9fe6), 0xcd);
        EXPECT(gbc.readMem(0xcd80), 0xf7);
        // F7 030E
        gbc.setState(0x5b0d, 0xad38, 0x4890, 0xb6d3, 0x3282, 0xdf95, 0x1, 0x1);
        gbc.writeMem(0x5b0d, { 0xf7 });
        gbc.writeMem(0xad36, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x48);
        EXPECT(gbc.b(),  0xb6);
        EXPECT(gbc.c(),  0xd3);
        EXPECT(gbc.d(),  0x32);
        EXPECT(gbc.e(),  0x82);
        EXPECT(gbc.h(),  0xdf);
        EXPECT(gbc.l(),  0x95);
        EXPECT(gbc.sp(), 0xad36);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xad36), 0xe);
        EXPECT(gbc.readMem(0xad37), 0x5b);
        // F7 030F
        gbc.setState(0x5b1e, 0x8f1c, 0x3820, 0xd633, 0x3c72, 0x49f6, 0x1, 0x0);
        gbc.writeMem(0x5b1e, { 0xf7 });
        gbc.writeMem(0x8f1a, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x38);
        EXPECT(gbc.b(),  0xd6);
        EXPECT(gbc.c(),  0x33);
        EXPECT(gbc.d(),  0x3c);
        EXPECT(gbc.e(),  0x72);
        EXPECT(gbc.h(),  0x49);
        EXPECT(gbc.l(),  0xf6);
        EXPECT(gbc.sp(), 0x8f1a);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8f1a), 0x1f);
        EXPECT(gbc.readMem(0x8f1b), 0x5b);
        // F7 0310
        gbc.setState(0x227c, 0xd0ea, 0x6c40, 0x9882, 0xceee, 0x71bc, 0x0, 0x1);
        gbc.writeMem(0x227c, { 0xf7 });
        gbc.writeMem(0xd0e8, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x6c);
        EXPECT(gbc.b(),  0x98);
        EXPECT(gbc.c(),  0x82);
        EXPECT(gbc.d(),  0xce);
        EXPECT(gbc.e(),  0xee);
        EXPECT(gbc.h(),  0x71);
        EXPECT(gbc.l(),  0xbc);
        EXPECT(gbc.sp(), 0xd0e8);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd0e8), 0x7d);
        EXPECT(gbc.readMem(0xd0e9), 0x22);
        // F7 0314
        gbc.setState(0x9c95, 0xfd5e, 0x5520, 0xf2e2, 0x476f, 0xeee4, 0x0, 0x0);
        gbc.writeMem(0x9c95, { 0xf7 });
        gbc.writeMem(0xfd5c, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x55);
        EXPECT(gbc.b(),  0xf2);
        EXPECT(gbc.c(),  0xe2);
        EXPECT(gbc.d(),  0x47);
        EXPECT(gbc.e(),  0x6f);
        EXPECT(gbc.h(),  0xee);
        EXPECT(gbc.l(),  0xe4);
        EXPECT(gbc.sp(), 0xfd5c);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9c95), 0xf7);
        EXPECT(gbc.readMem(0xfd5c), 0x96);
        EXPECT(gbc.readMem(0xfd5d), 0x9c);
        // F7 0315
        gbc.setState(0xbb49, 0x9657, 0x3e10, 0x79bb, 0x23e1, 0xb360, 0x0, 0x1);
        gbc.writeMem(0x9655, { 0x0, 0x0 });
        gbc.writeMem(0xbb49, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x3e);
        EXPECT(gbc.b(),  0x79);
        EXPECT(gbc.c(),  0xbb);
        EXPECT(gbc.d(),  0x23);
        EXPECT(gbc.e(),  0xe1);
        EXPECT(gbc.h(),  0xb3);
        EXPECT(gbc.l(),  0x60);
        EXPECT(gbc.sp(), 0x9655);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9655), 0x4a);
        EXPECT(gbc.readMem(0x9656), 0xbb);
        EXPECT(gbc.readMem(0xbb49), 0xf7);
        // F7 0316
        gbc.setState(0x3eed, 0xb54c, 0x3bc0, 0x3244, 0xf640, 0x7728, 0x0, 0x0);
        gbc.writeMem(0x3eed, { 0xf7 });
        gbc.writeMem(0xb54a, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x3b);
        EXPECT(gbc.b(),  0x32);
        EXPECT(gbc.c(),  0x44);
        EXPECT(gbc.d(),  0xf6);
        EXPECT(gbc.e(),  0x40);
        EXPECT(gbc.h(),  0x77);
        EXPECT(gbc.l(),  0x28);
        EXPECT(gbc.sp(), 0xb54a);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb54a), 0xee);
        EXPECT(gbc.readMem(0xb54b), 0x3e);
        // F7 0317
        gbc.setState(0xb28f, 0xcbcc, 0x8cb0, 0x3e3b, 0xb59b, 0xdb42, 0x0, 0x0);
        gbc.writeMem(0xb28f, { 0xf7 });
        gbc.writeMem(0xcbca, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x8c);
        EXPECT(gbc.b(),  0x3e);
        EXPECT(gbc.c(),  0x3b);
        EXPECT(gbc.d(),  0xb5);
        EXPECT(gbc.e(),  0x9b);
        EXPECT(gbc.h(),  0xdb);
        EXPECT(gbc.l(),  0x42);
        EXPECT(gbc.sp(), 0xcbca);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb28f), 0xf7);
        EXPECT(gbc.readMem(0xcbca), 0x90);
        EXPECT(gbc.readMem(0xcbcb), 0xb2);
        // F7 0318
        gbc.setState(0x4670, 0xb478, 0x1370, 0x8238, 0x2484, 0x57cd, 0x0, 0x1);
        gbc.writeMem(0x4670, { 0xf7 });
        gbc.writeMem(0xb476, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x13);
        EXPECT(gbc.b(),  0x82);
        EXPECT(gbc.c(),  0x38);
        EXPECT(gbc.d(),  0x24);
        EXPECT(gbc.e(),  0x84);
        EXPECT(gbc.h(),  0x57);
        EXPECT(gbc.l(),  0xcd);
        EXPECT(gbc.sp(), 0xb476);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb476), 0x71);
        EXPECT(gbc.readMem(0xb477), 0x46);
        // F7 0319
        gbc.setState(0x1a8c, 0x8c21, 0x4b20, 0x9f4f, 0xf31c, 0xf21b, 0x0, 0x1);
        gbc.writeMem(0x1a8c, { 0xf7 });
        gbc.writeMem(0x8c1f, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x4b);
        EXPECT(gbc.b(),  0x9f);
        EXPECT(gbc.c(),  0x4f);
        EXPECT(gbc.d(),  0xf3);
        EXPECT(gbc.e(),  0x1c);
        EXPECT(gbc.h(),  0xf2);
        EXPECT(gbc.l(),  0x1b);
        EXPECT(gbc.sp(), 0x8c1f);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8c1f), 0x8d);
        EXPECT(gbc.readMem(0x8c20), 0x1a);
        // F7 031A
        gbc.setState(0xecac, 0xcfdf, 0x6af0, 0x8fc5, 0x33c3, 0xa642, 0x0, 0x1);
        gbc.writeMem(0xcfdd, { 0x0, 0x0 });
        gbc.writeMem(0xecac, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x6a);
        EXPECT(gbc.b(),  0x8f);
        EXPECT(gbc.c(),  0xc5);
        EXPECT(gbc.d(),  0x33);
        EXPECT(gbc.e(),  0xc3);
        EXPECT(gbc.h(),  0xa6);
        EXPECT(gbc.l(),  0x42);
        EXPECT(gbc.sp(), 0xcfdd);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcfdd), 0xad);
        EXPECT(gbc.readMem(0xcfde), 0xec);
        EXPECT(gbc.readMem(0xecac), 0xf7);
        // F7 031D
        gbc.setState(0x7069, 0xa7c6, 0x350, 0xa968, 0x723f, 0x7a6c, 0x0, 0x0);
        gbc.writeMem(0x7069, { 0xf7 });
        gbc.writeMem(0xa7c4, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x3);
        EXPECT(gbc.b(),  0xa9);
        EXPECT(gbc.c(),  0x68);
        EXPECT(gbc.d(),  0x72);
        EXPECT(gbc.e(),  0x3f);
        EXPECT(gbc.h(),  0x7a);
        EXPECT(gbc.l(),  0x6c);
        EXPECT(gbc.sp(), 0xa7c4);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa7c4), 0x6a);
        EXPECT(gbc.readMem(0xa7c5), 0x70);
        // F7 031F
        gbc.setState(0x12a3, 0xb853, 0x75e0, 0xcd79, 0x5615, 0xdbea, 0x1, 0x1);
        gbc.writeMem(0x12a3, { 0xf7 });
        gbc.writeMem(0xb851, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x75);
        EXPECT(gbc.b(),  0xcd);
        EXPECT(gbc.c(),  0x79);
        EXPECT(gbc.d(),  0x56);
        EXPECT(gbc.e(),  0x15);
        EXPECT(gbc.h(),  0xdb);
        EXPECT(gbc.l(),  0xea);
        EXPECT(gbc.sp(), 0xb851);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb851), 0xa4);
        EXPECT(gbc.readMem(0xb852), 0x12);
        // F7 0322
        gbc.setState(0x7d27, 0xadd9, 0xddf0, 0x91f3, 0xaf, 0xf64e, 0x0, 0x0);
        gbc.writeMem(0x7d27, { 0xf7 });
        gbc.writeMem(0xadd7, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xdd);
        EXPECT(gbc.b(),  0x91);
        EXPECT(gbc.c(),  0xf3);
        EXPECT(gbc.d(),  0x0);
        EXPECT(gbc.e(),  0xaf);
        EXPECT(gbc.h(),  0xf6);
        EXPECT(gbc.l(),  0x4e);
        EXPECT(gbc.sp(), 0xadd7);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xadd7), 0x28);
        EXPECT(gbc.readMem(0xadd8), 0x7d);
        // F7 0324
        gbc.setState(0xe49a, 0x8378, 0xc650, 0x50ce, 0x8c86, 0xd19b, 0x1, 0x0);
        gbc.writeMem(0x8376, { 0x0, 0x0 });
        gbc.writeMem(0xe49a, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xc6);
        EXPECT(gbc.b(),  0x50);
        EXPECT(gbc.c(),  0xce);
        EXPECT(gbc.d(),  0x8c);
        EXPECT(gbc.e(),  0x86);
        EXPECT(gbc.h(),  0xd1);
        EXPECT(gbc.l(),  0x9b);
        EXPECT(gbc.sp(), 0x8376);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8376), 0x9b);
        EXPECT(gbc.readMem(0x8377), 0xe4);
        EXPECT(gbc.readMem(0xe49a), 0xf7);
        // F7 032A
        gbc.setState(0xaad9, 0x8c79, 0xb8b0, 0xf585, 0x3bd7, 0x2208, 0x0, 0x1);
        gbc.writeMem(0x8c77, { 0x0, 0x0 });
        gbc.writeMem(0xaad9, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xb8);
        EXPECT(gbc.b(),  0xf5);
        EXPECT(gbc.c(),  0x85);
        EXPECT(gbc.d(),  0x3b);
        EXPECT(gbc.e(),  0xd7);
        EXPECT(gbc.h(),  0x22);
        EXPECT(gbc.l(),  0x8);
        EXPECT(gbc.sp(), 0x8c77);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8c77), 0xda);
        EXPECT(gbc.readMem(0x8c78), 0xaa);
        EXPECT(gbc.readMem(0xaad9), 0xf7);
        // F7 032D
        gbc.setState(0xefab, 0xc667, 0xfb90, 0x9197, 0x8aab, 0xec8a, 0x1, 0x0);
        gbc.writeMem(0xc665, { 0x0, 0x0 });
        gbc.writeMem(0xefab, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xfb);
        EXPECT(gbc.b(),  0x91);
        EXPECT(gbc.c(),  0x97);
        EXPECT(gbc.d(),  0x8a);
        EXPECT(gbc.e(),  0xab);
        EXPECT(gbc.h(),  0xec);
        EXPECT(gbc.l(),  0x8a);
        EXPECT(gbc.sp(), 0xc665);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc665), 0xac);
        EXPECT(gbc.readMem(0xc666), 0xef);
        EXPECT(gbc.readMem(0xefab), 0xf7);
        // F7 032E
        gbc.setState(0x5dd7, 0xac4d, 0x38f0, 0xf19b, 0x4a38, 0xa8b8, 0x0, 0x0);
        gbc.writeMem(0x5dd7, { 0xf7 });
        gbc.writeMem(0xac4b, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x38);
        EXPECT(gbc.b(),  0xf1);
        EXPECT(gbc.c(),  0x9b);
        EXPECT(gbc.d(),  0x4a);
        EXPECT(gbc.e(),  0x38);
        EXPECT(gbc.h(),  0xa8);
        EXPECT(gbc.l(),  0xb8);
        EXPECT(gbc.sp(), 0xac4b);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xac4b), 0xd8);
        EXPECT(gbc.readMem(0xac4c), 0x5d);
        // F7 032F
        gbc.setState(0xb235, 0xb630, 0x1500, 0x4281, 0x98bd, 0xe4ee, 0x1, 0x0);
        gbc.writeMem(0xb235, { 0xf7 });
        gbc.writeMem(0xb62e, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x15);
        EXPECT(gbc.b(),  0x42);
        EXPECT(gbc.c(),  0x81);
        EXPECT(gbc.d(),  0x98);
        EXPECT(gbc.e(),  0xbd);
        EXPECT(gbc.h(),  0xe4);
        EXPECT(gbc.l(),  0xee);
        EXPECT(gbc.sp(), 0xb62e);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb235), 0xf7);
        EXPECT(gbc.readMem(0xb62e), 0x36);
        EXPECT(gbc.readMem(0xb62f), 0xb2);
        // F7 0330
        gbc.setState(0x9e0f, 0xcbcb, 0x5cd0, 0xe85a, 0xa6d4, 0x9769, 0x1, 0x1);
        gbc.writeMem(0x9e0f, { 0xf7 });
        gbc.writeMem(0xcbc9, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x5c);
        EXPECT(gbc.b(),  0xe8);
        EXPECT(gbc.c(),  0x5a);
        EXPECT(gbc.d(),  0xa6);
        EXPECT(gbc.e(),  0xd4);
        EXPECT(gbc.h(),  0x97);
        EXPECT(gbc.l(),  0x69);
        EXPECT(gbc.sp(), 0xcbc9);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9e0f), 0xf7);
        EXPECT(gbc.readMem(0xcbc9), 0x10);
        EXPECT(gbc.readMem(0xcbca), 0x9e);
        // F7 0332
        gbc.setState(0xb271, 0x891c, 0xfbd0, 0x2e3d, 0xe88b, 0x9db6, 0x1, 0x1);
        gbc.writeMem(0x891a, { 0x0, 0x0 });
        gbc.writeMem(0xb271, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xfb);
        EXPECT(gbc.b(),  0x2e);
        EXPECT(gbc.c(),  0x3d);
        EXPECT(gbc.d(),  0xe8);
        EXPECT(gbc.e(),  0x8b);
        EXPECT(gbc.h(),  0x9d);
        EXPECT(gbc.l(),  0xb6);
        EXPECT(gbc.sp(), 0x891a);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x891a), 0x72);
        EXPECT(gbc.readMem(0x891b), 0xb2);
        EXPECT(gbc.readMem(0xb271), 0xf7);
        // F7 0333
        gbc.setState(0xbdec, 0xc483, 0xbeb0, 0xa63d, 0x6efa, 0xa47c, 0x1, 0x1);
        gbc.writeMem(0xbdec, { 0xf7 });
        gbc.writeMem(0xc481, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xbe);
        EXPECT(gbc.b(),  0xa6);
        EXPECT(gbc.c(),  0x3d);
        EXPECT(gbc.d(),  0x6e);
        EXPECT(gbc.e(),  0xfa);
        EXPECT(gbc.h(),  0xa4);
        EXPECT(gbc.l(),  0x7c);
        EXPECT(gbc.sp(), 0xc481);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbdec), 0xf7);
        EXPECT(gbc.readMem(0xc481), 0xed);
        EXPECT(gbc.readMem(0xc482), 0xbd);
        // F7 0334
        gbc.setState(0x4485, 0x86af, 0x2f70, 0xb455, 0x2fb8, 0x3af5, 0x1, 0x0);
        gbc.writeMem(0x4485, { 0xf7 });
        gbc.writeMem(0x86ad, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x2f);
        EXPECT(gbc.b(),  0xb4);
        EXPECT(gbc.c(),  0x55);
        EXPECT(gbc.d(),  0x2f);
        EXPECT(gbc.e(),  0xb8);
        EXPECT(gbc.h(),  0x3a);
        EXPECT(gbc.l(),  0xf5);
        EXPECT(gbc.sp(), 0x86ad);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x86ad), 0x86);
        EXPECT(gbc.readMem(0x86ae), 0x44);
        // F7 0335
        gbc.setState(0x15e7, 0xc1fd, 0xeb00, 0xd630, 0x378b, 0xd55c, 0x1, 0x0);
        gbc.writeMem(0x15e7, { 0xf7 });
        gbc.writeMem(0xc1fb, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xeb);
        EXPECT(gbc.b(),  0xd6);
        EXPECT(gbc.c(),  0x30);
        EXPECT(gbc.d(),  0x37);
        EXPECT(gbc.e(),  0x8b);
        EXPECT(gbc.h(),  0xd5);
        EXPECT(gbc.l(),  0x5c);
        EXPECT(gbc.sp(), 0xc1fb);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc1fb), 0xe8);
        EXPECT(gbc.readMem(0xc1fc), 0x15);
        // F7 0336
        gbc.setState(0xb50, 0xe6d8, 0x75d0, 0xeb68, 0x1329, 0xfe, 0x1, 0x1);
        gbc.writeMem(0xb50, { 0xf7 });
        gbc.writeMem(0xe6d6, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x75);
        EXPECT(gbc.b(),  0xeb);
        EXPECT(gbc.c(),  0x68);
        EXPECT(gbc.d(),  0x13);
        EXPECT(gbc.e(),  0x29);
        EXPECT(gbc.h(),  0x0);
        EXPECT(gbc.l(),  0xfe);
        EXPECT(gbc.sp(), 0xe6d6);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe6d6), 0x51);
        EXPECT(gbc.readMem(0xe6d7), 0xb);
        // F7 0338
        gbc.setState(0x2e2d, 0xc164, 0xa2e0, 0x10e8, 0x47f7, 0x33f2, 0x0, 0x0);
        gbc.writeMem(0x2e2d, { 0xf7 });
        gbc.writeMem(0xc162, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xa2);
        EXPECT(gbc.b(),  0x10);
        EXPECT(gbc.c(),  0xe8);
        EXPECT(gbc.d(),  0x47);
        EXPECT(gbc.e(),  0xf7);
        EXPECT(gbc.h(),  0x33);
        EXPECT(gbc.l(),  0xf2);
        EXPECT(gbc.sp(), 0xc162);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc162), 0x2e);
        EXPECT(gbc.readMem(0xc163), 0x2e);
        // F7 033B
        gbc.setState(0xcadb, 0xc37c, 0xc60, 0xf277, 0x8160, 0x754, 0x1, 0x0);
        gbc.writeMem(0xc37a, { 0x0, 0x0 });
        gbc.writeMem(0xcadb, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xc);
        EXPECT(gbc.b(),  0xf2);
        EXPECT(gbc.c(),  0x77);
        EXPECT(gbc.d(),  0x81);
        EXPECT(gbc.e(),  0x60);
        EXPECT(gbc.h(),  0x7);
        EXPECT(gbc.l(),  0x54);
        EXPECT(gbc.sp(), 0xc37a);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc37a), 0xdc);
        EXPECT(gbc.readMem(0xc37b), 0xca);
        EXPECT(gbc.readMem(0xcadb), 0xf7);
        // F7 033D
        gbc.setState(0x3e7d, 0x918a, 0x50d0, 0x546b, 0x9abd, 0xe2cc, 0x1, 0x1);
        gbc.writeMem(0x3e7d, { 0xf7 });
        gbc.writeMem(0x9188, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x50);
        EXPECT(gbc.b(),  0x54);
        EXPECT(gbc.c(),  0x6b);
        EXPECT(gbc.d(),  0x9a);
        EXPECT(gbc.e(),  0xbd);
        EXPECT(gbc.h(),  0xe2);
        EXPECT(gbc.l(),  0xcc);
        EXPECT(gbc.sp(), 0x9188);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9188), 0x7e);
        EXPECT(gbc.readMem(0x9189), 0x3e);
        // F7 033E
        gbc.setState(0x35a1, 0xcbca, 0xaff0, 0x6a4f, 0xdb93, 0x9ca1, 0x0, 0x0);
        gbc.writeMem(0x35a1, { 0xf7 });
        gbc.writeMem(0xcbc8, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xaf);
        EXPECT(gbc.b(),  0x6a);
        EXPECT(gbc.c(),  0x4f);
        EXPECT(gbc.d(),  0xdb);
        EXPECT(gbc.e(),  0x93);
        EXPECT(gbc.h(),  0x9c);
        EXPECT(gbc.l(),  0xa1);
        EXPECT(gbc.sp(), 0xcbc8);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcbc8), 0xa2);
        EXPECT(gbc.readMem(0xcbc9), 0x35);
        // F7 0342
        gbc.setState(0x70a6, 0x9b39, 0x1330, 0x40df, 0x18c, 0x4900, 0x1, 0x0);
        gbc.writeMem(0x70a6, { 0xf7 });
        gbc.writeMem(0x9b37, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x13);
        EXPECT(gbc.b(),  0x40);
        EXPECT(gbc.c(),  0xdf);
        EXPECT(gbc.d(),  0x1);
        EXPECT(gbc.e(),  0x8c);
        EXPECT(gbc.h(),  0x49);
        EXPECT(gbc.l(),  0x0);
        EXPECT(gbc.sp(), 0x9b37);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9b37), 0xa7);
        EXPECT(gbc.readMem(0x9b38), 0x70);
        // F7 0343
        gbc.setState(0x3ab6, 0xe374, 0xcef0, 0xa98b, 0x827e, 0x978d, 0x1, 0x0);
        gbc.writeMem(0x3ab6, { 0xf7 });
        gbc.writeMem(0xe372, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xce);
        EXPECT(gbc.b(),  0xa9);
        EXPECT(gbc.c(),  0x8b);
        EXPECT(gbc.d(),  0x82);
        EXPECT(gbc.e(),  0x7e);
        EXPECT(gbc.h(),  0x97);
        EXPECT(gbc.l(),  0x8d);
        EXPECT(gbc.sp(), 0xe372);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe372), 0xb7);
        EXPECT(gbc.readMem(0xe373), 0x3a);
        // F7 0344
        gbc.setState(0x6fa8, 0x9926, 0x2f30, 0x1c7c, 0xc84d, 0xeefa, 0x1, 0x1);
        gbc.writeMem(0x6fa8, { 0xf7 });
        gbc.writeMem(0x9924, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x2f);
        EXPECT(gbc.b(),  0x1c);
        EXPECT(gbc.c(),  0x7c);
        EXPECT(gbc.d(),  0xc8);
        EXPECT(gbc.e(),  0x4d);
        EXPECT(gbc.h(),  0xee);
        EXPECT(gbc.l(),  0xfa);
        EXPECT(gbc.sp(), 0x9924);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9924), 0xa9);
        EXPECT(gbc.readMem(0x9925), 0x6f);
        // F7 0345
        gbc.setState(0x6b97, 0x94f4, 0xee90, 0xcdd0, 0x30e4, 0xac38, 0x0, 0x1);
        gbc.writeMem(0x6b97, { 0xf7 });
        gbc.writeMem(0x94f2, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xee);
        EXPECT(gbc.b(),  0xcd);
        EXPECT(gbc.c(),  0xd0);
        EXPECT(gbc.d(),  0x30);
        EXPECT(gbc.e(),  0xe4);
        EXPECT(gbc.h(),  0xac);
        EXPECT(gbc.l(),  0x38);
        EXPECT(gbc.sp(), 0x94f2);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x94f2), 0x98);
        EXPECT(gbc.readMem(0x94f3), 0x6b);
        // F7 0349
        gbc.setState(0x3f48, 0xeb0c, 0x91f0, 0x1323, 0xed1e, 0xdc7d, 0x0, 0x0);
        gbc.writeMem(0x3f48, { 0xf7 });
        gbc.writeMem(0xeb0a, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x91);
        EXPECT(gbc.b(),  0x13);
        EXPECT(gbc.c(),  0x23);
        EXPECT(gbc.d(),  0xed);
        EXPECT(gbc.e(),  0x1e);
        EXPECT(gbc.h(),  0xdc);
        EXPECT(gbc.l(),  0x7d);
        EXPECT(gbc.sp(), 0xeb0a);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xeb0a), 0x49);
        EXPECT(gbc.readMem(0xeb0b), 0x3f);
        // F7 034A
        gbc.setState(0x1ea2, 0xbbc9, 0x2db0, 0x76f7, 0xea3d, 0x317, 0x0, 0x0);
        gbc.writeMem(0x1ea2, { 0xf7 });
        gbc.writeMem(0xbbc7, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x2d);
        EXPECT(gbc.b(),  0x76);
        EXPECT(gbc.c(),  0xf7);
        EXPECT(gbc.d(),  0xea);
        EXPECT(gbc.e(),  0x3d);
        EXPECT(gbc.h(),  0x3);
        EXPECT(gbc.l(),  0x17);
        EXPECT(gbc.sp(), 0xbbc7);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbbc7), 0xa3);
        EXPECT(gbc.readMem(0xbbc8), 0x1e);
        // F7 034B
        gbc.setState(0x546, 0xe39b, 0xa600, 0xe134, 0x990f, 0x947f, 0x1, 0x0);
        gbc.writeMem(0x546, { 0xf7 });
        gbc.writeMem(0xe399, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xa6);
        EXPECT(gbc.b(),  0xe1);
        EXPECT(gbc.c(),  0x34);
        EXPECT(gbc.d(),  0x99);
        EXPECT(gbc.e(),  0xf);
        EXPECT(gbc.h(),  0x94);
        EXPECT(gbc.l(),  0x7f);
        EXPECT(gbc.sp(), 0xe399);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe399), 0x47);
        EXPECT(gbc.readMem(0xe39a), 0x5);
        // F7 034C
        gbc.setState(0x2447, 0xac68, 0xfa30, 0xe386, 0x3e0e, 0xb5c5, 0x1, 0x1);
        gbc.writeMem(0x2447, { 0xf7 });
        gbc.writeMem(0xac66, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xfa);
        EXPECT(gbc.b(),  0xe3);
        EXPECT(gbc.c(),  0x86);
        EXPECT(gbc.d(),  0x3e);
        EXPECT(gbc.e(),  0xe);
        EXPECT(gbc.h(),  0xb5);
        EXPECT(gbc.l(),  0xc5);
        EXPECT(gbc.sp(), 0xac66);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xac66), 0x48);
        EXPECT(gbc.readMem(0xac67), 0x24);
        // F7 034E
        gbc.setState(0x4bae, 0xbcc3, 0xcc30, 0x8d40, 0x2cb4, 0xadab, 0x0, 0x1);
        gbc.writeMem(0x4bae, { 0xf7 });
        gbc.writeMem(0xbcc1, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xcc);
        EXPECT(gbc.b(),  0x8d);
        EXPECT(gbc.c(),  0x40);
        EXPECT(gbc.d(),  0x2c);
        EXPECT(gbc.e(),  0xb4);
        EXPECT(gbc.h(),  0xad);
        EXPECT(gbc.l(),  0xab);
        EXPECT(gbc.sp(), 0xbcc1);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbcc1), 0xaf);
        EXPECT(gbc.readMem(0xbcc2), 0x4b);
        // F7 034F
        gbc.setState(0xa78c, 0xf8b5, 0x7ab0, 0x9620, 0x5f66, 0x4948, 0x0, 0x1);
        gbc.writeMem(0xa78c, { 0xf7 });
        gbc.writeMem(0xf8b3, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x7a);
        EXPECT(gbc.b(),  0x96);
        EXPECT(gbc.c(),  0x20);
        EXPECT(gbc.d(),  0x5f);
        EXPECT(gbc.e(),  0x66);
        EXPECT(gbc.h(),  0x49);
        EXPECT(gbc.l(),  0x48);
        EXPECT(gbc.sp(), 0xf8b3);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa78c), 0xf7);
        EXPECT(gbc.readMem(0xf8b3), 0x8d);
        EXPECT(gbc.readMem(0xf8b4), 0xa7);
        // F7 0350
        gbc.setState(0x435, 0xd51a, 0x60, 0x20e0, 0xb5b9, 0x28dd, 0x1, 0x1);
        gbc.writeMem(0x435, { 0xf7 });
        gbc.writeMem(0xd518, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x20);
        EXPECT(gbc.c(),  0xe0);
        EXPECT(gbc.d(),  0xb5);
        EXPECT(gbc.e(),  0xb9);
        EXPECT(gbc.h(),  0x28);
        EXPECT(gbc.l(),  0xdd);
        EXPECT(gbc.sp(), 0xd518);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd518), 0x36);
        EXPECT(gbc.readMem(0xd519), 0x4);
        // F7 0353
        gbc.setState(0xa8f0, 0xd085, 0x7cf0, 0x47c2, 0x7dc3, 0x3489, 0x1, 0x0);
        gbc.writeMem(0xa8f0, { 0xf7 });
        gbc.writeMem(0xd083, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x7c);
        EXPECT(gbc.b(),  0x47);
        EXPECT(gbc.c(),  0xc2);
        EXPECT(gbc.d(),  0x7d);
        EXPECT(gbc.e(),  0xc3);
        EXPECT(gbc.h(),  0x34);
        EXPECT(gbc.l(),  0x89);
        EXPECT(gbc.sp(), 0xd083);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa8f0), 0xf7);
        EXPECT(gbc.readMem(0xd083), 0xf1);
        EXPECT(gbc.readMem(0xd084), 0xa8);
        // F7 0354
        gbc.setState(0x43e4, 0xe6c3, 0xe050, 0xe88b, 0x9e00, 0x8c0, 0x1, 0x0);
        gbc.writeMem(0x43e4, { 0xf7 });
        gbc.writeMem(0xe6c1, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xe0);
        EXPECT(gbc.b(),  0xe8);
        EXPECT(gbc.c(),  0x8b);
        EXPECT(gbc.d(),  0x9e);
        EXPECT(gbc.e(),  0x0);
        EXPECT(gbc.h(),  0x8);
        EXPECT(gbc.l(),  0xc0);
        EXPECT(gbc.sp(), 0xe6c1);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe6c1), 0xe5);
        EXPECT(gbc.readMem(0xe6c2), 0x43);
        // F7 0357
        gbc.setState(0x2358, 0xad41, 0x6070, 0x9575, 0x14ad, 0x9994, 0x0, 0x0);
        gbc.writeMem(0x2358, { 0xf7 });
        gbc.writeMem(0xad3f, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x60);
        EXPECT(gbc.b(),  0x95);
        EXPECT(gbc.c(),  0x75);
        EXPECT(gbc.d(),  0x14);
        EXPECT(gbc.e(),  0xad);
        EXPECT(gbc.h(),  0x99);
        EXPECT(gbc.l(),  0x94);
        EXPECT(gbc.sp(), 0xad3f);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xad3f), 0x59);
        EXPECT(gbc.readMem(0xad40), 0x23);
        // F7 035C
        gbc.setState(0xb471, 0xbda5, 0x680, 0xc9f, 0xd3ab, 0x7642, 0x1, 0x1);
        gbc.writeMem(0xb471, { 0xf7 });
        gbc.writeMem(0xbda3, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x6);
        EXPECT(gbc.b(),  0xc);
        EXPECT(gbc.c(),  0x9f);
        EXPECT(gbc.d(),  0xd3);
        EXPECT(gbc.e(),  0xab);
        EXPECT(gbc.h(),  0x76);
        EXPECT(gbc.l(),  0x42);
        EXPECT(gbc.sp(), 0xbda3);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb471), 0xf7);
        EXPECT(gbc.readMem(0xbda3), 0x72);
        EXPECT(gbc.readMem(0xbda4), 0xb4);
        // F7 0360
        gbc.setState(0xc6d5, 0xd003, 0x1e50, 0x9feb, 0xca94, 0x236a, 0x0, 0x0);
        gbc.writeMem(0xc6d5, { 0xf7 });
        gbc.writeMem(0xd001, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x1e);
        EXPECT(gbc.b(),  0x9f);
        EXPECT(gbc.c(),  0xeb);
        EXPECT(gbc.d(),  0xca);
        EXPECT(gbc.e(),  0x94);
        EXPECT(gbc.h(),  0x23);
        EXPECT(gbc.l(),  0x6a);
        EXPECT(gbc.sp(), 0xd001);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc6d5), 0xf7);
        EXPECT(gbc.readMem(0xd001), 0xd6);
        EXPECT(gbc.readMem(0xd002), 0xc6);
        // F7 0361
        gbc.setState(0x392, 0xba61, 0x8ee0, 0x36a0, 0xdf1, 0x9493, 0x0, 0x0);
        gbc.writeMem(0x392, { 0xf7 });
        gbc.writeMem(0xba5f, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x8e);
        EXPECT(gbc.b(),  0x36);
        EXPECT(gbc.c(),  0xa0);
        EXPECT(gbc.d(),  0xd);
        EXPECT(gbc.e(),  0xf1);
        EXPECT(gbc.h(),  0x94);
        EXPECT(gbc.l(),  0x93);
        EXPECT(gbc.sp(), 0xba5f);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xba5f), 0x93);
        EXPECT(gbc.readMem(0xba60), 0x3);
        // F7 0362
        gbc.setState(0x628f, 0xb4d2, 0xcad0, 0xdd2d, 0x5a64, 0x6df, 0x0, 0x1);
        gbc.writeMem(0x628f, { 0xf7 });
        gbc.writeMem(0xb4d0, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xca);
        EXPECT(gbc.b(),  0xdd);
        EXPECT(gbc.c(),  0x2d);
        EXPECT(gbc.d(),  0x5a);
        EXPECT(gbc.e(),  0x64);
        EXPECT(gbc.h(),  0x6);
        EXPECT(gbc.l(),  0xdf);
        EXPECT(gbc.sp(), 0xb4d0);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb4d0), 0x90);
        EXPECT(gbc.readMem(0xb4d1), 0x62);
        // F7 0363
        gbc.setState(0x3a17, 0xb955, 0xaca0, 0x37bc, 0xb16e, 0xcbe3, 0x0, 0x0);
        gbc.writeMem(0x3a17, { 0xf7 });
        gbc.writeMem(0xb953, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xac);
        EXPECT(gbc.b(),  0x37);
        EXPECT(gbc.c(),  0xbc);
        EXPECT(gbc.d(),  0xb1);
        EXPECT(gbc.e(),  0x6e);
        EXPECT(gbc.h(),  0xcb);
        EXPECT(gbc.l(),  0xe3);
        EXPECT(gbc.sp(), 0xb953);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb953), 0x18);
        EXPECT(gbc.readMem(0xb954), 0x3a);
        // F7 0364
        gbc.setState(0x578d, 0xc57b, 0x65b0, 0x8df5, 0x3394, 0xf190, 0x1, 0x0);
        gbc.writeMem(0x578d, { 0xf7 });
        gbc.writeMem(0xc579, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x65);
        EXPECT(gbc.b(),  0x8d);
        EXPECT(gbc.c(),  0xf5);
        EXPECT(gbc.d(),  0x33);
        EXPECT(gbc.e(),  0x94);
        EXPECT(gbc.h(),  0xf1);
        EXPECT(gbc.l(),  0x90);
        EXPECT(gbc.sp(), 0xc579);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc579), 0x8e);
        EXPECT(gbc.readMem(0xc57a), 0x57);
        // F7 0365
        gbc.setState(0x2fb6, 0xc52c, 0xda50, 0xac1e, 0xa978, 0x998, 0x1, 0x1);
        gbc.writeMem(0x2fb6, { 0xf7 });
        gbc.writeMem(0xc52a, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xda);
        EXPECT(gbc.b(),  0xac);
        EXPECT(gbc.c(),  0x1e);
        EXPECT(gbc.d(),  0xa9);
        EXPECT(gbc.e(),  0x78);
        EXPECT(gbc.h(),  0x9);
        EXPECT(gbc.l(),  0x98);
        EXPECT(gbc.sp(), 0xc52a);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc52a), 0xb7);
        EXPECT(gbc.readMem(0xc52b), 0x2f);
        // F7 0366
        gbc.setState(0xdc60, 0xdc3a, 0xc380, 0xcf03, 0x80b1, 0x5374, 0x1, 0x1);
        gbc.writeMem(0xdc38, { 0x0, 0x0 });
        gbc.writeMem(0xdc60, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xc3);
        EXPECT(gbc.b(),  0xcf);
        EXPECT(gbc.c(),  0x3);
        EXPECT(gbc.d(),  0x80);
        EXPECT(gbc.e(),  0xb1);
        EXPECT(gbc.h(),  0x53);
        EXPECT(gbc.l(),  0x74);
        EXPECT(gbc.sp(), 0xdc38);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdc38), 0x61);
        EXPECT(gbc.readMem(0xdc39), 0xdc);
        EXPECT(gbc.readMem(0xdc60), 0xf7);
        // F7 0367
        gbc.setState(0x5f77, 0x8d1c, 0x9ff0, 0x11af, 0x9dae, 0x7d38, 0x1, 0x0);
        gbc.writeMem(0x5f77, { 0xf7 });
        gbc.writeMem(0x8d1a, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x9f);
        EXPECT(gbc.b(),  0x11);
        EXPECT(gbc.c(),  0xaf);
        EXPECT(gbc.d(),  0x9d);
        EXPECT(gbc.e(),  0xae);
        EXPECT(gbc.h(),  0x7d);
        EXPECT(gbc.l(),  0x38);
        EXPECT(gbc.sp(), 0x8d1a);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8d1a), 0x78);
        EXPECT(gbc.readMem(0x8d1b), 0x5f);
        // F7 036A
        gbc.setState(0x318c, 0xa6df, 0x36a0, 0x5492, 0x12f2, 0xcc22, 0x1, 0x0);
        gbc.writeMem(0x318c, { 0xf7 });
        gbc.writeMem(0xa6dd, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x36);
        EXPECT(gbc.b(),  0x54);
        EXPECT(gbc.c(),  0x92);
        EXPECT(gbc.d(),  0x12);
        EXPECT(gbc.e(),  0xf2);
        EXPECT(gbc.h(),  0xcc);
        EXPECT(gbc.l(),  0x22);
        EXPECT(gbc.sp(), 0xa6dd);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa6dd), 0x8d);
        EXPECT(gbc.readMem(0xa6de), 0x31);
        // F7 0374
        gbc.setState(0xc2b4, 0xfd45, 0x540, 0x14b8, 0xf624, 0x6b7b, 0x0, 0x0);
        gbc.writeMem(0xc2b4, { 0xf7 });
        gbc.writeMem(0xfd43, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x5);
        EXPECT(gbc.b(),  0x14);
        EXPECT(gbc.c(),  0xb8);
        EXPECT(gbc.d(),  0xf6);
        EXPECT(gbc.e(),  0x24);
        EXPECT(gbc.h(),  0x6b);
        EXPECT(gbc.l(),  0x7b);
        EXPECT(gbc.sp(), 0xfd43);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc2b4), 0xf7);
        EXPECT(gbc.readMem(0xfd43), 0xb5);
        EXPECT(gbc.readMem(0xfd44), 0xc2);
        // F7 0377
        gbc.setState(0x86ab, 0xc1fe, 0x9b10, 0x943f, 0x4d6a, 0xff13, 0x1, 0x0);
        gbc.writeMem(0x86ab, { 0xf7 });
        gbc.writeMem(0xc1fc, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x9b);
        EXPECT(gbc.b(),  0x94);
        EXPECT(gbc.c(),  0x3f);
        EXPECT(gbc.d(),  0x4d);
        EXPECT(gbc.e(),  0x6a);
        EXPECT(gbc.h(),  0xff);
        EXPECT(gbc.l(),  0x13);
        EXPECT(gbc.sp(), 0xc1fc);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x86ab), 0xf7);
        EXPECT(gbc.readMem(0xc1fc), 0xac);
        EXPECT(gbc.readMem(0xc1fd), 0x86);
        // F7 037A
        gbc.setState(0x22c, 0xc88c, 0xa280, 0xde7, 0xa633, 0xa252, 0x0, 0x0);
        gbc.writeMem(0x22c, { 0xf7 });
        gbc.writeMem(0xc88a, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xa2);
        EXPECT(gbc.b(),  0xd);
        EXPECT(gbc.c(),  0xe7);
        EXPECT(gbc.d(),  0xa6);
        EXPECT(gbc.e(),  0x33);
        EXPECT(gbc.h(),  0xa2);
        EXPECT(gbc.l(),  0x52);
        EXPECT(gbc.sp(), 0xc88a);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc88a), 0x2d);
        EXPECT(gbc.readMem(0xc88b), 0x2);
        // F7 037B
        gbc.setState(0x2c28, 0xfdaa, 0x5800, 0xceb, 0x49c8, 0xee4, 0x1, 0x1);
        gbc.writeMem(0x2c28, { 0xf7 });
        gbc.writeMem(0xfda8, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x58);
        EXPECT(gbc.b(),  0xc);
        EXPECT(gbc.c(),  0xeb);
        EXPECT(gbc.d(),  0x49);
        EXPECT(gbc.e(),  0xc8);
        EXPECT(gbc.h(),  0xe);
        EXPECT(gbc.l(),  0xe4);
        EXPECT(gbc.sp(), 0xfda8);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xfda8), 0x29);
        EXPECT(gbc.readMem(0xfda9), 0x2c);
        // F7 037C
        gbc.setState(0x8dd3, 0x8909, 0x3960, 0xe6d5, 0x2c28, 0x2384, 0x1, 0x1);
        gbc.writeMem(0x8907, { 0x0, 0x0 });
        gbc.writeMem(0x8dd3, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x39);
        EXPECT(gbc.b(),  0xe6);
        EXPECT(gbc.c(),  0xd5);
        EXPECT(gbc.d(),  0x2c);
        EXPECT(gbc.e(),  0x28);
        EXPECT(gbc.h(),  0x23);
        EXPECT(gbc.l(),  0x84);
        EXPECT(gbc.sp(), 0x8907);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8907), 0xd4);
        EXPECT(gbc.readMem(0x8908), 0x8d);
        EXPECT(gbc.readMem(0x8dd3), 0xf7);
        // F7 037D
        gbc.setState(0xb330, 0x9b91, 0x6eb0, 0x4892, 0x16dc, 0x9661, 0x1, 0x1);
        gbc.writeMem(0x9b8f, { 0x0, 0x0 });
        gbc.writeMem(0xb330, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x6e);
        EXPECT(gbc.b(),  0x48);
        EXPECT(gbc.c(),  0x92);
        EXPECT(gbc.d(),  0x16);
        EXPECT(gbc.e(),  0xdc);
        EXPECT(gbc.h(),  0x96);
        EXPECT(gbc.l(),  0x61);
        EXPECT(gbc.sp(), 0x9b8f);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9b8f), 0x31);
        EXPECT(gbc.readMem(0x9b90), 0xb3);
        EXPECT(gbc.readMem(0xb330), 0xf7);
        // F7 0382
        gbc.setState(0xe3c8, 0xc851, 0x33a0, 0x24d6, 0xcfc, 0xe76, 0x0, 0x0);
        gbc.writeMem(0xc84f, { 0x0, 0x0 });
        gbc.writeMem(0xe3c8, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x33);
        EXPECT(gbc.b(),  0x24);
        EXPECT(gbc.c(),  0xd6);
        EXPECT(gbc.d(),  0xc);
        EXPECT(gbc.e(),  0xfc);
        EXPECT(gbc.h(),  0xe);
        EXPECT(gbc.l(),  0x76);
        EXPECT(gbc.sp(), 0xc84f);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc84f), 0xc9);
        EXPECT(gbc.readMem(0xc850), 0xe3);
        EXPECT(gbc.readMem(0xe3c8), 0xf7);
        // F7 0385
        gbc.setState(0xd891, 0xfd59, 0x49e0, 0x2fd8, 0xa390, 0x2eab, 0x0, 0x0);
        gbc.writeMem(0xd891, { 0xf7 });
        gbc.writeMem(0xfd57, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x49);
        EXPECT(gbc.b(),  0x2f);
        EXPECT(gbc.c(),  0xd8);
        EXPECT(gbc.d(),  0xa3);
        EXPECT(gbc.e(),  0x90);
        EXPECT(gbc.h(),  0x2e);
        EXPECT(gbc.l(),  0xab);
        EXPECT(gbc.sp(), 0xfd57);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd891), 0xf7);
        EXPECT(gbc.readMem(0xfd57), 0x92);
        EXPECT(gbc.readMem(0xfd58), 0xd8);
        // F7 0386
        gbc.setState(0x76b8, 0x8e09, 0xb4d0, 0xaccc, 0x6e7d, 0x9df1, 0x0, 0x1);
        gbc.writeMem(0x76b8, { 0xf7 });
        gbc.writeMem(0x8e07, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xb4);
        EXPECT(gbc.b(),  0xac);
        EXPECT(gbc.c(),  0xcc);
        EXPECT(gbc.d(),  0x6e);
        EXPECT(gbc.e(),  0x7d);
        EXPECT(gbc.h(),  0x9d);
        EXPECT(gbc.l(),  0xf1);
        EXPECT(gbc.sp(), 0x8e07);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8e07), 0xb9);
        EXPECT(gbc.readMem(0x8e08), 0x76);
        // F7 038A
        gbc.setState(0x43b6, 0xf01c, 0xd5e0, 0x2759, 0xa59e, 0xfcc0, 0x0, 0x1);
        gbc.writeMem(0x43b6, { 0xf7 });
        gbc.writeMem(0xf01a, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xd5);
        EXPECT(gbc.b(),  0x27);
        EXPECT(gbc.c(),  0x59);
        EXPECT(gbc.d(),  0xa5);
        EXPECT(gbc.e(),  0x9e);
        EXPECT(gbc.h(),  0xfc);
        EXPECT(gbc.l(),  0xc0);
        EXPECT(gbc.sp(), 0xf01a);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xf01a), 0xb7);
        EXPECT(gbc.readMem(0xf01b), 0x43);
        // F7 038C
        gbc.setState(0x64d5, 0xd2b2, 0xe980, 0x6f7b, 0xca71, 0xcfd0, 0x1, 0x1);
        gbc.writeMem(0x64d5, { 0xf7 });
        gbc.writeMem(0xd2b0, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xe9);
        EXPECT(gbc.b(),  0x6f);
        EXPECT(gbc.c(),  0x7b);
        EXPECT(gbc.d(),  0xca);
        EXPECT(gbc.e(),  0x71);
        EXPECT(gbc.h(),  0xcf);
        EXPECT(gbc.l(),  0xd0);
        EXPECT(gbc.sp(), 0xd2b0);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd2b0), 0xd6);
        EXPECT(gbc.readMem(0xd2b1), 0x64);
        // F7 038D
        gbc.setState(0x74e3, 0xe49e, 0x5230, 0xcabd, 0x736f, 0xb65a, 0x0, 0x0);
        gbc.writeMem(0x74e3, { 0xf7 });
        gbc.writeMem(0xe49c, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x52);
        EXPECT(gbc.b(),  0xca);
        EXPECT(gbc.c(),  0xbd);
        EXPECT(gbc.d(),  0x73);
        EXPECT(gbc.e(),  0x6f);
        EXPECT(gbc.h(),  0xb6);
        EXPECT(gbc.l(),  0x5a);
        EXPECT(gbc.sp(), 0xe49c);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe49c), 0xe4);
        EXPECT(gbc.readMem(0xe49d), 0x74);
        // F7 038E
        gbc.setState(0xd8ac, 0xbf9f, 0xfce0, 0x6bd4, 0xbeea, 0x62f8, 0x0, 0x1);
        gbc.writeMem(0xbf9d, { 0x0, 0x0 });
        gbc.writeMem(0xd8ac, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xfc);
        EXPECT(gbc.b(),  0x6b);
        EXPECT(gbc.c(),  0xd4);
        EXPECT(gbc.d(),  0xbe);
        EXPECT(gbc.e(),  0xea);
        EXPECT(gbc.h(),  0x62);
        EXPECT(gbc.l(),  0xf8);
        EXPECT(gbc.sp(), 0xbf9d);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbf9d), 0xad);
        EXPECT(gbc.readMem(0xbf9e), 0xd8);
        EXPECT(gbc.readMem(0xd8ac), 0xf7);
        // F7 0391
        gbc.setState(0xee72, 0xcc20, 0x4020, 0x8114, 0x9536, 0x8b6b, 0x0, 0x0);
        gbc.writeMem(0xcc1e, { 0x0, 0x0 });
        gbc.writeMem(0xee72, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0x81);
        EXPECT(gbc.c(),  0x14);
        EXPECT(gbc.d(),  0x95);
        EXPECT(gbc.e(),  0x36);
        EXPECT(gbc.h(),  0x8b);
        EXPECT(gbc.l(),  0x6b);
        EXPECT(gbc.sp(), 0xcc1e);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcc1e), 0x73);
        EXPECT(gbc.readMem(0xcc1f), 0xee);
        EXPECT(gbc.readMem(0xee72), 0xf7);
        // F7 0392
        gbc.setState(0xc5db, 0x80e5, 0x3bc0, 0x1f10, 0xe21f, 0x81a5, 0x0, 0x1);
        gbc.writeMem(0x80e3, { 0x0, 0x0 });
        gbc.writeMem(0xc5db, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x3b);
        EXPECT(gbc.b(),  0x1f);
        EXPECT(gbc.c(),  0x10);
        EXPECT(gbc.d(),  0xe2);
        EXPECT(gbc.e(),  0x1f);
        EXPECT(gbc.h(),  0x81);
        EXPECT(gbc.l(),  0xa5);
        EXPECT(gbc.sp(), 0x80e3);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x80e3), 0xdc);
        EXPECT(gbc.readMem(0x80e4), 0xc5);
        EXPECT(gbc.readMem(0xc5db), 0xf7);
        // F7 0395
        gbc.setState(0x7714, 0xff76, 0x6b00, 0xf1a0, 0x8051, 0x554f, 0x1, 0x0);
        gbc.writeMem(0x7714, { 0xf7 });
        gbc.writeMem(0xff74, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x6b);
        EXPECT(gbc.b(),  0xf1);
        EXPECT(gbc.c(),  0xa0);
        EXPECT(gbc.d(),  0x80);
        EXPECT(gbc.e(),  0x51);
        EXPECT(gbc.h(),  0x55);
        EXPECT(gbc.l(),  0x4f);
        EXPECT(gbc.sp(), 0xff74);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xff74), 0x15);
        EXPECT(gbc.readMem(0xff75), 0x77);
        // F7 0399
        gbc.setState(0xeff8, 0xb4a2, 0xbfc0, 0x775f, 0xa1cd, 0x46c4, 0x1, 0x1);
        gbc.writeMem(0xb4a0, { 0x0, 0x0 });
        gbc.writeMem(0xeff8, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xbf);
        EXPECT(gbc.b(),  0x77);
        EXPECT(gbc.c(),  0x5f);
        EXPECT(gbc.d(),  0xa1);
        EXPECT(gbc.e(),  0xcd);
        EXPECT(gbc.h(),  0x46);
        EXPECT(gbc.l(),  0xc4);
        EXPECT(gbc.sp(), 0xb4a0);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb4a0), 0xf9);
        EXPECT(gbc.readMem(0xb4a1), 0xef);
        EXPECT(gbc.readMem(0xeff8), 0xf7);
        // F7 039E
        gbc.setState(0x5587, 0xefac, 0x6220, 0x6da4, 0x6a7f, 0xf035, 0x0, 0x0);
        gbc.writeMem(0x5587, { 0xf7 });
        gbc.writeMem(0xefaa, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x62);
        EXPECT(gbc.b(),  0x6d);
        EXPECT(gbc.c(),  0xa4);
        EXPECT(gbc.d(),  0x6a);
        EXPECT(gbc.e(),  0x7f);
        EXPECT(gbc.h(),  0xf0);
        EXPECT(gbc.l(),  0x35);
        EXPECT(gbc.sp(), 0xefaa);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xefaa), 0x88);
        EXPECT(gbc.readMem(0xefab), 0x55);
        // F7 03A0
        gbc.setState(0x1cea, 0xa44e, 0xf710, 0xdb67, 0xc5e0, 0xed5f, 0x0, 0x0);
        gbc.writeMem(0x1cea, { 0xf7 });
        gbc.writeMem(0xa44c, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xf7);
        EXPECT(gbc.b(),  0xdb);
        EXPECT(gbc.c(),  0x67);
        EXPECT(gbc.d(),  0xc5);
        EXPECT(gbc.e(),  0xe0);
        EXPECT(gbc.h(),  0xed);
        EXPECT(gbc.l(),  0x5f);
        EXPECT(gbc.sp(), 0xa44c);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa44c), 0xeb);
        EXPECT(gbc.readMem(0xa44d), 0x1c);
        // F7 03A4
        gbc.setState(0x8fd6, 0xc09a, 0x7070, 0xc968, 0x55f5, 0x87aa, 0x0, 0x0);
        gbc.writeMem(0x8fd6, { 0xf7 });
        gbc.writeMem(0xc098, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x70);
        EXPECT(gbc.b(),  0xc9);
        EXPECT(gbc.c(),  0x68);
        EXPECT(gbc.d(),  0x55);
        EXPECT(gbc.e(),  0xf5);
        EXPECT(gbc.h(),  0x87);
        EXPECT(gbc.l(),  0xaa);
        EXPECT(gbc.sp(), 0xc098);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8fd6), 0xf7);
        EXPECT(gbc.readMem(0xc098), 0xd7);
        EXPECT(gbc.readMem(0xc099), 0x8f);
        // F7 03A6
        gbc.setState(0xd363, 0x9d94, 0x490, 0x9868, 0x3f41, 0xe84d, 0x0, 0x1);
        gbc.writeMem(0x9d92, { 0x0, 0x0 });
        gbc.writeMem(0xd363, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0x98);
        EXPECT(gbc.c(),  0x68);
        EXPECT(gbc.d(),  0x3f);
        EXPECT(gbc.e(),  0x41);
        EXPECT(gbc.h(),  0xe8);
        EXPECT(gbc.l(),  0x4d);
        EXPECT(gbc.sp(), 0x9d92);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9d92), 0x64);
        EXPECT(gbc.readMem(0x9d93), 0xd3);
        EXPECT(gbc.readMem(0xd363), 0xf7);
        // F7 03A8
        gbc.setState(0x3c62, 0x8fbf, 0x7d0, 0x27a0, 0xa2d3, 0x792e, 0x0, 0x0);
        gbc.writeMem(0x3c62, { 0xf7 });
        gbc.writeMem(0x8fbd, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x7);
        EXPECT(gbc.b(),  0x27);
        EXPECT(gbc.c(),  0xa0);
        EXPECT(gbc.d(),  0xa2);
        EXPECT(gbc.e(),  0xd3);
        EXPECT(gbc.h(),  0x79);
        EXPECT(gbc.l(),  0x2e);
        EXPECT(gbc.sp(), 0x8fbd);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8fbd), 0x63);
        EXPECT(gbc.readMem(0x8fbe), 0x3c);
        // F7 03A9
        gbc.setState(0x525b, 0xa39c, 0x1de0, 0x377, 0x30ae, 0x1871, 0x0, 0x1);
        gbc.writeMem(0x525b, { 0xf7 });
        gbc.writeMem(0xa39a, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x1d);
        EXPECT(gbc.b(),  0x3);
        EXPECT(gbc.c(),  0x77);
        EXPECT(gbc.d(),  0x30);
        EXPECT(gbc.e(),  0xae);
        EXPECT(gbc.h(),  0x18);
        EXPECT(gbc.l(),  0x71);
        EXPECT(gbc.sp(), 0xa39a);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa39a), 0x5c);
        EXPECT(gbc.readMem(0xa39b), 0x52);
        // F7 03AA
        gbc.setState(0xace6, 0x86c9, 0x96e0, 0x5fe9, 0x6232, 0xf585, 0x1, 0x0);
        gbc.writeMem(0x86c7, { 0x0, 0x0 });
        gbc.writeMem(0xace6, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x96);
        EXPECT(gbc.b(),  0x5f);
        EXPECT(gbc.c(),  0xe9);
        EXPECT(gbc.d(),  0x62);
        EXPECT(gbc.e(),  0x32);
        EXPECT(gbc.h(),  0xf5);
        EXPECT(gbc.l(),  0x85);
        EXPECT(gbc.sp(), 0x86c7);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x86c7), 0xe7);
        EXPECT(gbc.readMem(0x86c8), 0xac);
        EXPECT(gbc.readMem(0xace6), 0xf7);
        // F7 03AB
        gbc.setState(0x4f0, 0x847a, 0x39e0, 0xa406, 0x9b12, 0x1408, 0x0, 0x1);
        gbc.writeMem(0x4f0, { 0xf7 });
        gbc.writeMem(0x8478, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x39);
        EXPECT(gbc.b(),  0xa4);
        EXPECT(gbc.c(),  0x6);
        EXPECT(gbc.d(),  0x9b);
        EXPECT(gbc.e(),  0x12);
        EXPECT(gbc.h(),  0x14);
        EXPECT(gbc.l(),  0x8);
        EXPECT(gbc.sp(), 0x8478);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8478), 0xf1);
        EXPECT(gbc.readMem(0x8479), 0x4);
        // F7 03AD
        gbc.setState(0xa39e, 0xf1fe, 0xf200, 0x5fd0, 0x6750, 0x5c4b, 0x1, 0x1);
        gbc.writeMem(0xa39e, { 0xf7 });
        gbc.writeMem(0xf1fc, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xf2);
        EXPECT(gbc.b(),  0x5f);
        EXPECT(gbc.c(),  0xd0);
        EXPECT(gbc.d(),  0x67);
        EXPECT(gbc.e(),  0x50);
        EXPECT(gbc.h(),  0x5c);
        EXPECT(gbc.l(),  0x4b);
        EXPECT(gbc.sp(), 0xf1fc);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa39e), 0xf7);
        EXPECT(gbc.readMem(0xf1fc), 0x9f);
        EXPECT(gbc.readMem(0xf1fd), 0xa3);
        // F7 03B3
        gbc.setState(0x6472, 0xf92f, 0xf910, 0x822, 0x4f0f, 0x9263, 0x0, 0x0);
        gbc.writeMem(0x6472, { 0xf7 });
        gbc.writeMem(0xf92d, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xf9);
        EXPECT(gbc.b(),  0x8);
        EXPECT(gbc.c(),  0x22);
        EXPECT(gbc.d(),  0x4f);
        EXPECT(gbc.e(),  0xf);
        EXPECT(gbc.h(),  0x92);
        EXPECT(gbc.l(),  0x63);
        EXPECT(gbc.sp(), 0xf92d);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xf92d), 0x73);
        EXPECT(gbc.readMem(0xf92e), 0x64);
        // F7 03B4
        gbc.setState(0x185, 0xc2af, 0x9970, 0x6615, 0xef4d, 0xf0f3, 0x0, 0x0);
        gbc.writeMem(0x185, { 0xf7 });
        gbc.writeMem(0xc2ad, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x99);
        EXPECT(gbc.b(),  0x66);
        EXPECT(gbc.c(),  0x15);
        EXPECT(gbc.d(),  0xef);
        EXPECT(gbc.e(),  0x4d);
        EXPECT(gbc.h(),  0xf0);
        EXPECT(gbc.l(),  0xf3);
        EXPECT(gbc.sp(), 0xc2ad);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc2ad), 0x86);
        EXPECT(gbc.readMem(0xc2ae), 0x1);
        // F7 03B6
        gbc.setState(0x99e3, 0xc4f3, 0xd430, 0xc7ea, 0xb459, 0x3372, 0x1, 0x1);
        gbc.writeMem(0x99e3, { 0xf7 });
        gbc.writeMem(0xc4f1, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xd4);
        EXPECT(gbc.b(),  0xc7);
        EXPECT(gbc.c(),  0xea);
        EXPECT(gbc.d(),  0xb4);
        EXPECT(gbc.e(),  0x59);
        EXPECT(gbc.h(),  0x33);
        EXPECT(gbc.l(),  0x72);
        EXPECT(gbc.sp(), 0xc4f1);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x99e3), 0xf7);
        EXPECT(gbc.readMem(0xc4f1), 0xe4);
        EXPECT(gbc.readMem(0xc4f2), 0x99);
        // F7 03B8
        gbc.setState(0xd810, 0x917f, 0x2240, 0x3380, 0xbfd8, 0xf493, 0x1, 0x1);
        gbc.writeMem(0x917d, { 0x0, 0x0 });
        gbc.writeMem(0xd810, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x22);
        EXPECT(gbc.b(),  0x33);
        EXPECT(gbc.c(),  0x80);
        EXPECT(gbc.d(),  0xbf);
        EXPECT(gbc.e(),  0xd8);
        EXPECT(gbc.h(),  0xf4);
        EXPECT(gbc.l(),  0x93);
        EXPECT(gbc.sp(), 0x917d);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x917d), 0x11);
        EXPECT(gbc.readMem(0x917e), 0xd8);
        EXPECT(gbc.readMem(0xd810), 0xf7);
        // F7 03BC
        gbc.setState(0x8dc7, 0x8780, 0xd4e0, 0x741f, 0x4e56, 0x8b81, 0x1, 0x0);
        gbc.writeMem(0x877e, { 0x0, 0x0 });
        gbc.writeMem(0x8dc7, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xd4);
        EXPECT(gbc.b(),  0x74);
        EXPECT(gbc.c(),  0x1f);
        EXPECT(gbc.d(),  0x4e);
        EXPECT(gbc.e(),  0x56);
        EXPECT(gbc.h(),  0x8b);
        EXPECT(gbc.l(),  0x81);
        EXPECT(gbc.sp(), 0x877e);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x877e), 0xc8);
        EXPECT(gbc.readMem(0x877f), 0x8d);
        EXPECT(gbc.readMem(0x8dc7), 0xf7);
        // F7 03BD
        gbc.setState(0x6e08, 0xbd74, 0x6560, 0x192c, 0xb8e8, 0x6682, 0x0, 0x1);
        gbc.writeMem(0x6e08, { 0xf7 });
        gbc.writeMem(0xbd72, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x65);
        EXPECT(gbc.b(),  0x19);
        EXPECT(gbc.c(),  0x2c);
        EXPECT(gbc.d(),  0xb8);
        EXPECT(gbc.e(),  0xe8);
        EXPECT(gbc.h(),  0x66);
        EXPECT(gbc.l(),  0x82);
        EXPECT(gbc.sp(), 0xbd72);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbd72), 0x9);
        EXPECT(gbc.readMem(0xbd73), 0x6e);
        // F7 03BE
        gbc.setState(0x1879, 0xb406, 0xd560, 0x15f, 0x4d4f, 0x1e7, 0x0, 0x1);
        gbc.writeMem(0x1879, { 0xf7 });
        gbc.writeMem(0xb404, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xd5);
        EXPECT(gbc.b(),  0x1);
        EXPECT(gbc.c(),  0x5f);
        EXPECT(gbc.d(),  0x4d);
        EXPECT(gbc.e(),  0x4f);
        EXPECT(gbc.h(),  0x1);
        EXPECT(gbc.l(),  0xe7);
        EXPECT(gbc.sp(), 0xb404);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb404), 0x7a);
        EXPECT(gbc.readMem(0xb405), 0x18);
        // F7 03BF
        gbc.setState(0x778a, 0xc0e5, 0x7bc0, 0xf353, 0xc7c1, 0x283b, 0x1, 0x1);
        gbc.writeMem(0x778a, { 0xf7 });
        gbc.writeMem(0xc0e3, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x7b);
        EXPECT(gbc.b(),  0xf3);
        EXPECT(gbc.c(),  0x53);
        EXPECT(gbc.d(),  0xc7);
        EXPECT(gbc.e(),  0xc1);
        EXPECT(gbc.h(),  0x28);
        EXPECT(gbc.l(),  0x3b);
        EXPECT(gbc.sp(), 0xc0e3);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc0e3), 0x8b);
        EXPECT(gbc.readMem(0xc0e4), 0x77);
        // F7 03C1
        gbc.setState(0x7d7, 0xbdf0, 0xd700, 0x5ee3, 0x9cde, 0x55c6, 0x1, 0x1);
        gbc.writeMem(0x7d7, { 0xf7 });
        gbc.writeMem(0xbdee, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xd7);
        EXPECT(gbc.b(),  0x5e);
        EXPECT(gbc.c(),  0xe3);
        EXPECT(gbc.d(),  0x9c);
        EXPECT(gbc.e(),  0xde);
        EXPECT(gbc.h(),  0x55);
        EXPECT(gbc.l(),  0xc6);
        EXPECT(gbc.sp(), 0xbdee);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbdee), 0xd8);
        EXPECT(gbc.readMem(0xbdef), 0x7);
        // F7 03C3
        gbc.setState(0xa76e, 0xf39f, 0x2ba0, 0xdad, 0x15e7, 0xd500, 0x0, 0x0);
        gbc.writeMem(0xa76e, { 0xf7 });
        gbc.writeMem(0xf39d, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x2b);
        EXPECT(gbc.b(),  0xd);
        EXPECT(gbc.c(),  0xad);
        EXPECT(gbc.d(),  0x15);
        EXPECT(gbc.e(),  0xe7);
        EXPECT(gbc.h(),  0xd5);
        EXPECT(gbc.l(),  0x0);
        EXPECT(gbc.sp(), 0xf39d);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa76e), 0xf7);
        EXPECT(gbc.readMem(0xf39d), 0x6f);
        EXPECT(gbc.readMem(0xf39e), 0xa7);
        // F7 03C6
        gbc.setState(0x922f, 0x92ea, 0x5440, 0x100b, 0x7c1d, 0xc3ee, 0x1, 0x1);
        gbc.writeMem(0x922f, { 0xf7 });
        gbc.writeMem(0x92e8, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x54);
        EXPECT(gbc.b(),  0x10);
        EXPECT(gbc.c(),  0xb);
        EXPECT(gbc.d(),  0x7c);
        EXPECT(gbc.e(),  0x1d);
        EXPECT(gbc.h(),  0xc3);
        EXPECT(gbc.l(),  0xee);
        EXPECT(gbc.sp(), 0x92e8);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x922f), 0xf7);
        EXPECT(gbc.readMem(0x92e8), 0x30);
        EXPECT(gbc.readMem(0x92e9), 0x92);
        // F7 03C7
        gbc.setState(0x8b9e, 0xc9e7, 0x14c0, 0x7c5b, 0xa75a, 0xb4a4, 0x1, 0x1);
        gbc.writeMem(0x8b9e, { 0xf7 });
        gbc.writeMem(0xc9e5, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x14);
        EXPECT(gbc.b(),  0x7c);
        EXPECT(gbc.c(),  0x5b);
        EXPECT(gbc.d(),  0xa7);
        EXPECT(gbc.e(),  0x5a);
        EXPECT(gbc.h(),  0xb4);
        EXPECT(gbc.l(),  0xa4);
        EXPECT(gbc.sp(), 0xc9e5);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8b9e), 0xf7);
        EXPECT(gbc.readMem(0xc9e5), 0x9f);
        EXPECT(gbc.readMem(0xc9e6), 0x8b);
        // F7 03CB
        gbc.setState(0xde15, 0xe905, 0x20d0, 0x10d1, 0xf472, 0x98ee, 0x1, 0x0);
        gbc.writeMem(0xde15, { 0xf7 });
        gbc.writeMem(0xe903, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0x10);
        EXPECT(gbc.c(),  0xd1);
        EXPECT(gbc.d(),  0xf4);
        EXPECT(gbc.e(),  0x72);
        EXPECT(gbc.h(),  0x98);
        EXPECT(gbc.l(),  0xee);
        EXPECT(gbc.sp(), 0xe903);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xde15), 0xf7);
        EXPECT(gbc.readMem(0xe903), 0x16);
        EXPECT(gbc.readMem(0xe904), 0xde);
        // F7 03CC
        gbc.setState(0x35a3, 0x8a61, 0x2950, 0x3b37, 0x6328, 0x1d60, 0x0, 0x1);
        gbc.writeMem(0x35a3, { 0xf7 });
        gbc.writeMem(0x8a5f, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x29);
        EXPECT(gbc.b(),  0x3b);
        EXPECT(gbc.c(),  0x37);
        EXPECT(gbc.d(),  0x63);
        EXPECT(gbc.e(),  0x28);
        EXPECT(gbc.h(),  0x1d);
        EXPECT(gbc.l(),  0x60);
        EXPECT(gbc.sp(), 0x8a5f);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8a5f), 0xa4);
        EXPECT(gbc.readMem(0x8a60), 0x35);
        // F7 03CE
        gbc.setState(0x9809, 0xad28, 0x7c80, 0x2a65, 0xbd49, 0xfafc, 0x0, 0x0);
        gbc.writeMem(0x9809, { 0xf7 });
        gbc.writeMem(0xad26, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x7c);
        EXPECT(gbc.b(),  0x2a);
        EXPECT(gbc.c(),  0x65);
        EXPECT(gbc.d(),  0xbd);
        EXPECT(gbc.e(),  0x49);
        EXPECT(gbc.h(),  0xfa);
        EXPECT(gbc.l(),  0xfc);
        EXPECT(gbc.sp(), 0xad26);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9809), 0xf7);
        EXPECT(gbc.readMem(0xad26), 0xa);
        EXPECT(gbc.readMem(0xad27), 0x98);
        // F7 03CF
        gbc.setState(0xe442, 0xeed3, 0x36b0, 0x1153, 0x6676, 0xdf58, 0x0, 0x0);
        gbc.writeMem(0xe442, { 0xf7 });
        gbc.writeMem(0xeed1, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x36);
        EXPECT(gbc.b(),  0x11);
        EXPECT(gbc.c(),  0x53);
        EXPECT(gbc.d(),  0x66);
        EXPECT(gbc.e(),  0x76);
        EXPECT(gbc.h(),  0xdf);
        EXPECT(gbc.l(),  0x58);
        EXPECT(gbc.sp(), 0xeed1);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe442), 0xf7);
        EXPECT(gbc.readMem(0xeed1), 0x43);
        EXPECT(gbc.readMem(0xeed2), 0xe4);
        // F7 03D1
        gbc.setState(0xa799, 0x8222, 0x2b10, 0x2875, 0x2194, 0x10d8, 0x1, 0x1);
        gbc.writeMem(0x8220, { 0x0, 0x0 });
        gbc.writeMem(0xa799, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x2b);
        EXPECT(gbc.b(),  0x28);
        EXPECT(gbc.c(),  0x75);
        EXPECT(gbc.d(),  0x21);
        EXPECT(gbc.e(),  0x94);
        EXPECT(gbc.h(),  0x10);
        EXPECT(gbc.l(),  0xd8);
        EXPECT(gbc.sp(), 0x8220);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8220), 0x9a);
        EXPECT(gbc.readMem(0x8221), 0xa7);
        EXPECT(gbc.readMem(0xa799), 0xf7);
        // F7 03D3
        gbc.setState(0x8363, 0xf90f, 0x75e0, 0xeac2, 0x1fcf, 0xfbf4, 0x1, 0x1);
        gbc.writeMem(0x8363, { 0xf7 });
        gbc.writeMem(0xf90d, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x75);
        EXPECT(gbc.b(),  0xea);
        EXPECT(gbc.c(),  0xc2);
        EXPECT(gbc.d(),  0x1f);
        EXPECT(gbc.e(),  0xcf);
        EXPECT(gbc.h(),  0xfb);
        EXPECT(gbc.l(),  0xf4);
        EXPECT(gbc.sp(), 0xf90d);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8363), 0xf7);
        EXPECT(gbc.readMem(0xf90d), 0x64);
        EXPECT(gbc.readMem(0xf90e), 0x83);
        // F7 03D4
        gbc.setState(0x4c67, 0x8d26, 0x7180, 0x4057, 0x356b, 0x3c0b, 0x0, 0x1);
        gbc.writeMem(0x4c67, { 0xf7 });
        gbc.writeMem(0x8d24, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x71);
        EXPECT(gbc.b(),  0x40);
        EXPECT(gbc.c(),  0x57);
        EXPECT(gbc.d(),  0x35);
        EXPECT(gbc.e(),  0x6b);
        EXPECT(gbc.h(),  0x3c);
        EXPECT(gbc.l(),  0xb);
        EXPECT(gbc.sp(), 0x8d24);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8d24), 0x68);
        EXPECT(gbc.readMem(0x8d25), 0x4c);
        // F7 03D5
        gbc.setState(0xeca8, 0xca4f, 0x1ab0, 0x1732, 0x4d94, 0x4ace, 0x0, 0x1);
        gbc.writeMem(0xca4d, { 0x0, 0x0 });
        gbc.writeMem(0xeca8, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x1a);
        EXPECT(gbc.b(),  0x17);
        EXPECT(gbc.c(),  0x32);
        EXPECT(gbc.d(),  0x4d);
        EXPECT(gbc.e(),  0x94);
        EXPECT(gbc.h(),  0x4a);
        EXPECT(gbc.l(),  0xce);
        EXPECT(gbc.sp(), 0xca4d);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xca4d), 0xa9);
        EXPECT(gbc.readMem(0xca4e), 0xec);
        EXPECT(gbc.readMem(0xeca8), 0xf7);
        // F7 03D8
        gbc.setState(0x440d, 0x9166, 0xb620, 0x3ae4, 0xad36, 0xe887, 0x0, 0x0);
        gbc.writeMem(0x440d, { 0xf7 });
        gbc.writeMem(0x9164, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xb6);
        EXPECT(gbc.b(),  0x3a);
        EXPECT(gbc.c(),  0xe4);
        EXPECT(gbc.d(),  0xad);
        EXPECT(gbc.e(),  0x36);
        EXPECT(gbc.h(),  0xe8);
        EXPECT(gbc.l(),  0x87);
        EXPECT(gbc.sp(), 0x9164);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9164), 0xe);
        EXPECT(gbc.readMem(0x9165), 0x44);
        // F7 03D9
        gbc.setState(0xeb40, 0xeb56, 0xd410, 0xe628, 0x9f0c, 0x1772, 0x1, 0x1);
        gbc.writeMem(0xeb40, { 0xf7 });
        gbc.writeMem(0xeb54, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xd4);
        EXPECT(gbc.b(),  0xe6);
        EXPECT(gbc.c(),  0x28);
        EXPECT(gbc.d(),  0x9f);
        EXPECT(gbc.e(),  0xc);
        EXPECT(gbc.h(),  0x17);
        EXPECT(gbc.l(),  0x72);
        EXPECT(gbc.sp(), 0xeb54);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xeb40), 0xf7);
        EXPECT(gbc.readMem(0xeb54), 0x41);
        EXPECT(gbc.readMem(0xeb55), 0xeb);
        // F7 03DA
        gbc.setState(0x919d, 0xfe7f, 0x8ec0, 0x1b1c, 0xc7ee, 0x42f8, 0x0, 0x0);
        gbc.writeMem(0x919d, { 0xf7 });
        gbc.writeMem(0xfe7d, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x8e);
        EXPECT(gbc.b(),  0x1b);
        EXPECT(gbc.c(),  0x1c);
        EXPECT(gbc.d(),  0xc7);
        EXPECT(gbc.e(),  0xee);
        EXPECT(gbc.h(),  0x42);
        EXPECT(gbc.l(),  0xf8);
        EXPECT(gbc.sp(), 0xfe7d);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x919d), 0xf7);
        EXPECT(gbc.readMem(0xfe7d), 0x9e);
        EXPECT(gbc.readMem(0xfe7e), 0x91);
        // F7 03DB
        gbc.setState(0x729c, 0xf39a, 0x80e0, 0xb370, 0xf221, 0x6832, 0x0, 0x0);
        gbc.writeMem(0x729c, { 0xf7 });
        gbc.writeMem(0xf398, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0xb3);
        EXPECT(gbc.c(),  0x70);
        EXPECT(gbc.d(),  0xf2);
        EXPECT(gbc.e(),  0x21);
        EXPECT(gbc.h(),  0x68);
        EXPECT(gbc.l(),  0x32);
        EXPECT(gbc.sp(), 0xf398);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xf398), 0x9d);
        EXPECT(gbc.readMem(0xf399), 0x72);
        // F7 03DC
        gbc.setState(0x6a1, 0xcc97, 0xd100, 0xca5a, 0xb918, 0x2516, 0x1, 0x0);
        gbc.writeMem(0x6a1, { 0xf7 });
        gbc.writeMem(0xcc95, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xd1);
        EXPECT(gbc.b(),  0xca);
        EXPECT(gbc.c(),  0x5a);
        EXPECT(gbc.d(),  0xb9);
        EXPECT(gbc.e(),  0x18);
        EXPECT(gbc.h(),  0x25);
        EXPECT(gbc.l(),  0x16);
        EXPECT(gbc.sp(), 0xcc95);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcc95), 0xa2);
        EXPECT(gbc.readMem(0xcc96), 0x6);
        // F7 03DE
        gbc.setState(0xde1a, 0xb8a5, 0xcc60, 0x840c, 0x1f63, 0x1d8a, 0x1, 0x0);
        gbc.writeMem(0xb8a3, { 0x0, 0x0 });
        gbc.writeMem(0xde1a, { 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xcc);
        EXPECT(gbc.b(),  0x84);
        EXPECT(gbc.c(),  0xc);
        EXPECT(gbc.d(),  0x1f);
        EXPECT(gbc.e(),  0x63);
        EXPECT(gbc.h(),  0x1d);
        EXPECT(gbc.l(),  0x8a);
        EXPECT(gbc.sp(), 0xb8a3);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb8a3), 0x1b);
        EXPECT(gbc.readMem(0xb8a4), 0xde);
        EXPECT(gbc.readMem(0xde1a), 0xf7);
        // F7 03E0
        gbc.setState(0x8d95, 0xd816, 0x2dd0, 0x7282, 0x7894, 0x4247, 0x1, 0x1);
        gbc.writeMem(0x8d95, { 0xf7 });
        gbc.writeMem(0xd814, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x2d);
        EXPECT(gbc.b(),  0x72);
        EXPECT(gbc.c(),  0x82);
        EXPECT(gbc.d(),  0x78);
        EXPECT(gbc.e(),  0x94);
        EXPECT(gbc.h(),  0x42);
        EXPECT(gbc.l(),  0x47);
        EXPECT(gbc.sp(), 0xd814);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8d95), 0xf7);
        EXPECT(gbc.readMem(0xd814), 0x96);
        EXPECT(gbc.readMem(0xd815), 0x8d);
        // F7 03E1
        gbc.setState(0x26d0, 0x96ff, 0x9360, 0xe67a, 0xf0d6, 0xcf56, 0x1, 0x1);
        gbc.writeMem(0x26d0, { 0xf7 });
        gbc.writeMem(0x96fd, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x93);
        EXPECT(gbc.b(),  0xe6);
        EXPECT(gbc.c(),  0x7a);
        EXPECT(gbc.d(),  0xf0);
        EXPECT(gbc.e(),  0xd6);
        EXPECT(gbc.h(),  0xcf);
        EXPECT(gbc.l(),  0x56);
        EXPECT(gbc.sp(), 0x96fd);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x96fd), 0xd1);
        EXPECT(gbc.readMem(0x96fe), 0x26);
        // F7 03E2
        gbc.setState(0x5692, 0x8de9, 0x7f50, 0x2f6c, 0xc17e, 0x5315, 0x1, 0x1);
        gbc.writeMem(0x5692, { 0xf7 });
        gbc.writeMem(0x8de7, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x7f);
        EXPECT(gbc.b(),  0x2f);
        EXPECT(gbc.c(),  0x6c);
        EXPECT(gbc.d(),  0xc1);
        EXPECT(gbc.e(),  0x7e);
        EXPECT(gbc.h(),  0x53);
        EXPECT(gbc.l(),  0x15);
        EXPECT(gbc.sp(), 0x8de7);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8de7), 0x93);
        EXPECT(gbc.readMem(0x8de8), 0x56);
        // F7 03E5
        gbc.setState(0xaa3, 0x83d4, 0x37a0, 0xe037, 0x86ae, 0x7b06, 0x1, 0x1);
        gbc.writeMem(0xaa3, { 0xf7 });
        gbc.writeMem(0x83d2, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x37);
        EXPECT(gbc.b(),  0xe0);
        EXPECT(gbc.c(),  0x37);
        EXPECT(gbc.d(),  0x86);
        EXPECT(gbc.e(),  0xae);
        EXPECT(gbc.h(),  0x7b);
        EXPECT(gbc.l(),  0x6);
        EXPECT(gbc.sp(), 0x83d2);
        EXPECT(gbc.pc(), 0x30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x83d2), 0xa4);
        EXPECT(gbc.readMem(0x83d3), 0xa);
    }
}
#endif
