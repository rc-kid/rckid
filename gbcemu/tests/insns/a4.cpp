#include "../gbctests_insns.h"
#if (defined GBCEMU_INSNS_TESTS_ALL) || (defined GBCEMU_INSNS_TESTS_a4)
#include "../gbctests.h"

namespace rckid::gbcemu {

    TEST(gbcemu, opcode_a4) {
        GBCEmu gbc{};
        uint8_t cartridge[0x8000];
        cartridge[0x149] = 0x02; // 8kb external RAM
        gbc.loadCartridge(new FlashGamePak(cartridge));
        // A4 0000
        gbc.setState(0x7be7, 0xb342, 0x8c10, 0x5da5, 0x1cb, 0xfa32, 0x0, 0x1);
        gbc.writeMem(0x7be7, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x88);
        EXPECT(gbc.b(),  0x5d);
        EXPECT(gbc.c(),  0xa5);
        EXPECT(gbc.d(),  0x1);
        EXPECT(gbc.e(),  0xcb);
        EXPECT(gbc.h(),  0xfa);
        EXPECT(gbc.l(),  0x32);
        EXPECT(gbc.sp(), 0xb342);
        EXPECT(gbc.pc(), 0x7be8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0001
        gbc.setState(0xd6ef, 0xc4b, 0x7360, 0x28af, 0xcd7a, 0xb97d, 0x0, 0x1);
        gbc.writeMem(0xd6ef, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x31);
        EXPECT(gbc.b(),  0x28);
        EXPECT(gbc.c(),  0xaf);
        EXPECT(gbc.d(),  0xcd);
        EXPECT(gbc.e(),  0x7a);
        EXPECT(gbc.h(),  0xb9);
        EXPECT(gbc.l(),  0x7d);
        EXPECT(gbc.sp(), 0xc4b);
        EXPECT(gbc.pc(), 0xd6f0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd6ef), 0xa4);
        // A4 0002
        gbc.setState(0xbe1, 0x7210, 0xb9e0, 0xa8e9, 0x8a2, 0x4419, 0x0, 0x0);
        gbc.writeMem(0xbe1, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0xa8);
        EXPECT(gbc.c(),  0xe9);
        EXPECT(gbc.d(),  0x8);
        EXPECT(gbc.e(),  0xa2);
        EXPECT(gbc.h(),  0x44);
        EXPECT(gbc.l(),  0x19);
        EXPECT(gbc.sp(), 0x7210);
        EXPECT(gbc.pc(), 0xbe2);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0004
        gbc.setState(0x5bd6, 0xad39, 0x9170, 0xa78, 0xbdf8, 0xbc4c, 0x1, 0x1);
        gbc.writeMem(0x5bd6, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x90);
        EXPECT(gbc.b(),  0xa);
        EXPECT(gbc.c(),  0x78);
        EXPECT(gbc.d(),  0xbd);
        EXPECT(gbc.e(),  0xf8);
        EXPECT(gbc.h(),  0xbc);
        EXPECT(gbc.l(),  0x4c);
        EXPECT(gbc.sp(), 0xad39);
        EXPECT(gbc.pc(), 0x5bd7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0005
        gbc.setState(0x7816, 0x32fd, 0x7220, 0xffba, 0x769d, 0x4427, 0x1, 0x0);
        gbc.writeMem(0x7816, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0xff);
        EXPECT(gbc.c(),  0xba);
        EXPECT(gbc.d(),  0x76);
        EXPECT(gbc.e(),  0x9d);
        EXPECT(gbc.h(),  0x44);
        EXPECT(gbc.l(),  0x27);
        EXPECT(gbc.sp(), 0x32fd);
        EXPECT(gbc.pc(), 0x7817);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0006
        gbc.setState(0x66d8, 0x546a, 0x4c20, 0xea88, 0x421e, 0x7a5f, 0x0, 0x1);
        gbc.writeMem(0x66d8, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x48);
        EXPECT(gbc.b(),  0xea);
        EXPECT(gbc.c(),  0x88);
        EXPECT(gbc.d(),  0x42);
        EXPECT(gbc.e(),  0x1e);
        EXPECT(gbc.h(),  0x7a);
        EXPECT(gbc.l(),  0x5f);
        EXPECT(gbc.sp(), 0x546a);
        EXPECT(gbc.pc(), 0x66d9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0007
        gbc.setState(0x89fa, 0xb175, 0x89c0, 0x5d0, 0xef76, 0x548b, 0x0, 0x1);
        gbc.writeMem(0x89fa, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x5);
        EXPECT(gbc.c(),  0xd0);
        EXPECT(gbc.d(),  0xef);
        EXPECT(gbc.e(),  0x76);
        EXPECT(gbc.h(),  0x54);
        EXPECT(gbc.l(),  0x8b);
        EXPECT(gbc.sp(), 0xb175);
        EXPECT(gbc.pc(), 0x89fb);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x89fa), 0xa4);
        // A4 0008
        gbc.setState(0x5307, 0xdafc, 0x9da0, 0xe990, 0xd1b8, 0xcdef, 0x1, 0x1);
        gbc.writeMem(0x5307, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8d);
        EXPECT(gbc.b(),  0xe9);
        EXPECT(gbc.c(),  0x90);
        EXPECT(gbc.d(),  0xd1);
        EXPECT(gbc.e(),  0xb8);
        EXPECT(gbc.h(),  0xcd);
        EXPECT(gbc.l(),  0xef);
        EXPECT(gbc.sp(), 0xdafc);
        EXPECT(gbc.pc(), 0x5308);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0009
        gbc.setState(0x280e, 0xff6d, 0x38a0, 0x4950, 0xd9ec, 0x5767, 0x0, 0x0);
        gbc.writeMem(0x280e, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0x49);
        EXPECT(gbc.c(),  0x50);
        EXPECT(gbc.d(),  0xd9);
        EXPECT(gbc.e(),  0xec);
        EXPECT(gbc.h(),  0x57);
        EXPECT(gbc.l(),  0x67);
        EXPECT(gbc.sp(), 0xff6d);
        EXPECT(gbc.pc(), 0x280f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 000A
        gbc.setState(0xe916, 0xc249, 0x1a30, 0xe1aa, 0xfcd1, 0x81b6, 0x1, 0x1);
        gbc.writeMem(0xe916, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0xe1);
        EXPECT(gbc.c(),  0xaa);
        EXPECT(gbc.d(),  0xfc);
        EXPECT(gbc.e(),  0xd1);
        EXPECT(gbc.h(),  0x81);
        EXPECT(gbc.l(),  0xb6);
        EXPECT(gbc.sp(), 0xc249);
        EXPECT(gbc.pc(), 0xe917);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe916), 0xa4);
        // A4 000B
        gbc.setState(0x5c22, 0xf93b, 0xcb20, 0x1f5d, 0xed7a, 0xfacd, 0x1, 0x0);
        gbc.writeMem(0x5c22, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xca);
        EXPECT(gbc.b(),  0x1f);
        EXPECT(gbc.c(),  0x5d);
        EXPECT(gbc.d(),  0xed);
        EXPECT(gbc.e(),  0x7a);
        EXPECT(gbc.h(),  0xfa);
        EXPECT(gbc.l(),  0xcd);
        EXPECT(gbc.sp(), 0xf93b);
        EXPECT(gbc.pc(), 0x5c23);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 000C
        gbc.setState(0xc595, 0x6958, 0x6120, 0xe545, 0xd815, 0xc27c, 0x0, 0x1);
        gbc.writeMem(0xc595, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0xe5);
        EXPECT(gbc.c(),  0x45);
        EXPECT(gbc.d(),  0xd8);
        EXPECT(gbc.e(),  0x15);
        EXPECT(gbc.h(),  0xc2);
        EXPECT(gbc.l(),  0x7c);
        EXPECT(gbc.sp(), 0x6958);
        EXPECT(gbc.pc(), 0xc596);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc595), 0xa4);
        // A4 000D
        gbc.setState(0xdf11, 0x6169, 0xed10, 0x9f1d, 0x70bb, 0x3d33, 0x0, 0x0);
        gbc.writeMem(0xdf11, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2d);
        EXPECT(gbc.b(),  0x9f);
        EXPECT(gbc.c(),  0x1d);
        EXPECT(gbc.d(),  0x70);
        EXPECT(gbc.e(),  0xbb);
        EXPECT(gbc.h(),  0x3d);
        EXPECT(gbc.l(),  0x33);
        EXPECT(gbc.sp(), 0x6169);
        EXPECT(gbc.pc(), 0xdf12);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdf11), 0xa4);
        // A4 000E
        gbc.setState(0x7f5b, 0x479d, 0xae10, 0x1721, 0xa5a2, 0x537c, 0x0, 0x0);
        gbc.writeMem(0x7f5b, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0x17);
        EXPECT(gbc.c(),  0x21);
        EXPECT(gbc.d(),  0xa5);
        EXPECT(gbc.e(),  0xa2);
        EXPECT(gbc.h(),  0x53);
        EXPECT(gbc.l(),  0x7c);
        EXPECT(gbc.sp(), 0x479d);
        EXPECT(gbc.pc(), 0x7f5c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 000F
        gbc.setState(0x5175, 0xbf7b, 0x1bd0, 0x3e17, 0xadaf, 0xd42e, 0x0, 0x0);
        gbc.writeMem(0x5175, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0x3e);
        EXPECT(gbc.c(),  0x17);
        EXPECT(gbc.d(),  0xad);
        EXPECT(gbc.e(),  0xaf);
        EXPECT(gbc.h(),  0xd4);
        EXPECT(gbc.l(),  0x2e);
        EXPECT(gbc.sp(), 0xbf7b);
        EXPECT(gbc.pc(), 0x5176);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0010
        gbc.setState(0xde46, 0x34e, 0x1cc0, 0x7ad7, 0x6215, 0xffb, 0x1, 0x0);
        gbc.writeMem(0xde46, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc);
        EXPECT(gbc.b(),  0x7a);
        EXPECT(gbc.c(),  0xd7);
        EXPECT(gbc.d(),  0x62);
        EXPECT(gbc.e(),  0x15);
        EXPECT(gbc.h(),  0xf);
        EXPECT(gbc.l(),  0xfb);
        EXPECT(gbc.sp(), 0x34e);
        EXPECT(gbc.pc(), 0xde47);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xde46), 0xa4);
        // A4 0011
        gbc.setState(0xbf85, 0xa942, 0xe740, 0x7aa4, 0xf6c7, 0x9e01, 0x1, 0x1);
        gbc.writeMem(0xbf85, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x86);
        EXPECT(gbc.b(),  0x7a);
        EXPECT(gbc.c(),  0xa4);
        EXPECT(gbc.d(),  0xf6);
        EXPECT(gbc.e(),  0xc7);
        EXPECT(gbc.h(),  0x9e);
        EXPECT(gbc.l(),  0x1);
        EXPECT(gbc.sp(), 0xa942);
        EXPECT(gbc.pc(), 0xbf86);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbf85), 0xa4);
        // A4 0012
        gbc.setState(0xc2d6, 0xadbc, 0xcb00, 0xeae7, 0x1361, 0xfdd1, 0x0, 0x0);
        gbc.writeMem(0xc2d6, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc9);
        EXPECT(gbc.b(),  0xea);
        EXPECT(gbc.c(),  0xe7);
        EXPECT(gbc.d(),  0x13);
        EXPECT(gbc.e(),  0x61);
        EXPECT(gbc.h(),  0xfd);
        EXPECT(gbc.l(),  0xd1);
        EXPECT(gbc.sp(), 0xadbc);
        EXPECT(gbc.pc(), 0xc2d7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc2d6), 0xa4);
        // A4 0013
        gbc.setState(0x1d13, 0xe068, 0x1f90, 0x923f, 0xc25d, 0x7211, 0x0, 0x1);
        gbc.writeMem(0x1d13, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x12);
        EXPECT(gbc.b(),  0x92);
        EXPECT(gbc.c(),  0x3f);
        EXPECT(gbc.d(),  0xc2);
        EXPECT(gbc.e(),  0x5d);
        EXPECT(gbc.h(),  0x72);
        EXPECT(gbc.l(),  0x11);
        EXPECT(gbc.sp(), 0xe068);
        EXPECT(gbc.pc(), 0x1d14);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0014
        gbc.setState(0xd525, 0x506a, 0xa570, 0x7174, 0xdfb3, 0xfeea, 0x0, 0x0);
        gbc.writeMem(0xd525, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa4);
        EXPECT(gbc.b(),  0x71);
        EXPECT(gbc.c(),  0x74);
        EXPECT(gbc.d(),  0xdf);
        EXPECT(gbc.e(),  0xb3);
        EXPECT(gbc.h(),  0xfe);
        EXPECT(gbc.l(),  0xea);
        EXPECT(gbc.sp(), 0x506a);
        EXPECT(gbc.pc(), 0xd526);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd525), 0xa4);
        // A4 0015
        gbc.setState(0xb8a, 0xb34f, 0x1460, 0xf564, 0xf69e, 0x27b7, 0x0, 0x1);
        gbc.writeMem(0xb8a, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0xf5);
        EXPECT(gbc.c(),  0x64);
        EXPECT(gbc.d(),  0xf6);
        EXPECT(gbc.e(),  0x9e);
        EXPECT(gbc.h(),  0x27);
        EXPECT(gbc.l(),  0xb7);
        EXPECT(gbc.sp(), 0xb34f);
        EXPECT(gbc.pc(), 0xb8b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0016
        gbc.setState(0x6f4a, 0xd6ca, 0xf570, 0x2ec8, 0xdc05, 0x2a4b, 0x1, 0x1);
        gbc.writeMem(0x6f4a, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0x2e);
        EXPECT(gbc.c(),  0xc8);
        EXPECT(gbc.d(),  0xdc);
        EXPECT(gbc.e(),  0x5);
        EXPECT(gbc.h(),  0x2a);
        EXPECT(gbc.l(),  0x4b);
        EXPECT(gbc.sp(), 0xd6ca);
        EXPECT(gbc.pc(), 0x6f4b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0017
        gbc.setState(0xac5f, 0xf242, 0x7f90, 0xacbd, 0xd860, 0xf56e, 0x1, 0x1);
        gbc.writeMem(0xac5f, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x75);
        EXPECT(gbc.b(),  0xac);
        EXPECT(gbc.c(),  0xbd);
        EXPECT(gbc.d(),  0xd8);
        EXPECT(gbc.e(),  0x60);
        EXPECT(gbc.h(),  0xf5);
        EXPECT(gbc.l(),  0x6e);
        EXPECT(gbc.sp(), 0xf242);
        EXPECT(gbc.pc(), 0xac60);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xac5f), 0xa4);
        // A4 0018
        gbc.setState(0xb76, 0x2ecf, 0xa80, 0xe7aa, 0xe820, 0xfcdb, 0x1, 0x1);
        gbc.writeMem(0xb76, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0xe7);
        EXPECT(gbc.c(),  0xaa);
        EXPECT(gbc.d(),  0xe8);
        EXPECT(gbc.e(),  0x20);
        EXPECT(gbc.h(),  0xfc);
        EXPECT(gbc.l(),  0xdb);
        EXPECT(gbc.sp(), 0x2ecf);
        EXPECT(gbc.pc(), 0xb77);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0019
        gbc.setState(0xd181, 0x1439, 0xa820, 0x58f, 0x6aac, 0x9ba4, 0x1, 0x1);
        gbc.writeMem(0xd181, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x88);
        EXPECT(gbc.b(),  0x5);
        EXPECT(gbc.c(),  0x8f);
        EXPECT(gbc.d(),  0x6a);
        EXPECT(gbc.e(),  0xac);
        EXPECT(gbc.h(),  0x9b);
        EXPECT(gbc.l(),  0xa4);
        EXPECT(gbc.sp(), 0x1439);
        EXPECT(gbc.pc(), 0xd182);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd181), 0xa4);
        // A4 001A
        gbc.setState(0xa744, 0x74aa, 0x8150, 0xd47e, 0xa4e, 0xed60, 0x0, 0x0);
        gbc.writeMem(0xa744, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x81);
        EXPECT(gbc.b(),  0xd4);
        EXPECT(gbc.c(),  0x7e);
        EXPECT(gbc.d(),  0xa);
        EXPECT(gbc.e(),  0x4e);
        EXPECT(gbc.h(),  0xed);
        EXPECT(gbc.l(),  0x60);
        EXPECT(gbc.sp(), 0x74aa);
        EXPECT(gbc.pc(), 0xa745);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa744), 0xa4);
        // A4 001B
        gbc.setState(0xcd78, 0x924d, 0x1620, 0x8a55, 0xe369, 0x42a5, 0x0, 0x1);
        gbc.writeMem(0xcd78, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0x8a);
        EXPECT(gbc.c(),  0x55);
        EXPECT(gbc.d(),  0xe3);
        EXPECT(gbc.e(),  0x69);
        EXPECT(gbc.h(),  0x42);
        EXPECT(gbc.l(),  0xa5);
        EXPECT(gbc.sp(), 0x924d);
        EXPECT(gbc.pc(), 0xcd79);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcd78), 0xa4);
        // A4 001C
        gbc.setState(0x9a92, 0xaf9f, 0x18b0, 0x7775, 0xe096, 0xa59d, 0x0, 0x1);
        gbc.writeMem(0x9a92, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x77);
        EXPECT(gbc.c(),  0x75);
        EXPECT(gbc.d(),  0xe0);
        EXPECT(gbc.e(),  0x96);
        EXPECT(gbc.h(),  0xa5);
        EXPECT(gbc.l(),  0x9d);
        EXPECT(gbc.sp(), 0xaf9f);
        EXPECT(gbc.pc(), 0x9a93);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9a92), 0xa4);
        // A4 001D
        gbc.setState(0xbd45, 0xfcc1, 0xd150, 0x6633, 0xd27c, 0xad52, 0x1, 0x0);
        gbc.writeMem(0xbd45, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x81);
        EXPECT(gbc.b(),  0x66);
        EXPECT(gbc.c(),  0x33);
        EXPECT(gbc.d(),  0xd2);
        EXPECT(gbc.e(),  0x7c);
        EXPECT(gbc.h(),  0xad);
        EXPECT(gbc.l(),  0x52);
        EXPECT(gbc.sp(), 0xfcc1);
        EXPECT(gbc.pc(), 0xbd46);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbd45), 0xa4);
        // A4 001E
        gbc.setState(0xec6b, 0x6944, 0x25f0, 0x7607, 0x7c0, 0x6815, 0x0, 0x0);
        gbc.writeMem(0xec6b, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0x76);
        EXPECT(gbc.c(),  0x7);
        EXPECT(gbc.d(),  0x7);
        EXPECT(gbc.e(),  0xc0);
        EXPECT(gbc.h(),  0x68);
        EXPECT(gbc.l(),  0x15);
        EXPECT(gbc.sp(), 0x6944);
        EXPECT(gbc.pc(), 0xec6c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xec6b), 0xa4);
        // A4 001F
        gbc.setState(0xee54, 0xd2a7, 0x8800, 0xeea0, 0x602a, 0x216a, 0x1, 0x0);
        gbc.writeMem(0xee54, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0xee);
        EXPECT(gbc.c(),  0xa0);
        EXPECT(gbc.d(),  0x60);
        EXPECT(gbc.e(),  0x2a);
        EXPECT(gbc.h(),  0x21);
        EXPECT(gbc.l(),  0x6a);
        EXPECT(gbc.sp(), 0xd2a7);
        EXPECT(gbc.pc(), 0xee55);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xee54), 0xa4);
        // A4 0021
        gbc.setState(0xddfb, 0x553d, 0x7bc0, 0x5299, 0x21e7, 0xb224, 0x0, 0x1);
        gbc.writeMem(0xddfb, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x32);
        EXPECT(gbc.b(),  0x52);
        EXPECT(gbc.c(),  0x99);
        EXPECT(gbc.d(),  0x21);
        EXPECT(gbc.e(),  0xe7);
        EXPECT(gbc.h(),  0xb2);
        EXPECT(gbc.l(),  0x24);
        EXPECT(gbc.sp(), 0x553d);
        EXPECT(gbc.pc(), 0xddfc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xddfb), 0xa4);
        // A4 0023
        gbc.setState(0x4d96, 0x2d58, 0x7e00, 0xfe5b, 0x1716, 0x44ff, 0x0, 0x1);
        gbc.writeMem(0x4d96, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x44);
        EXPECT(gbc.b(),  0xfe);
        EXPECT(gbc.c(),  0x5b);
        EXPECT(gbc.d(),  0x17);
        EXPECT(gbc.e(),  0x16);
        EXPECT(gbc.h(),  0x44);
        EXPECT(gbc.l(),  0xff);
        EXPECT(gbc.sp(), 0x2d58);
        EXPECT(gbc.pc(), 0x4d97);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0024
        gbc.setState(0xb384, 0x4b5f, 0x11b0, 0xf70e, 0x9815, 0xbf80, 0x0, 0x1);
        gbc.writeMem(0xb384, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x11);
        EXPECT(gbc.b(),  0xf7);
        EXPECT(gbc.c(),  0xe);
        EXPECT(gbc.d(),  0x98);
        EXPECT(gbc.e(),  0x15);
        EXPECT(gbc.h(),  0xbf);
        EXPECT(gbc.l(),  0x80);
        EXPECT(gbc.sp(), 0x4b5f);
        EXPECT(gbc.pc(), 0xb385);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb384), 0xa4);
        // A4 0025
        gbc.setState(0xbd6f, 0x2c0a, 0x1ed0, 0x4707, 0xfe18, 0xbcc0, 0x0, 0x1);
        gbc.writeMem(0xbd6f, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1c);
        EXPECT(gbc.b(),  0x47);
        EXPECT(gbc.c(),  0x7);
        EXPECT(gbc.d(),  0xfe);
        EXPECT(gbc.e(),  0x18);
        EXPECT(gbc.h(),  0xbc);
        EXPECT(gbc.l(),  0xc0);
        EXPECT(gbc.sp(), 0x2c0a);
        EXPECT(gbc.pc(), 0xbd70);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbd6f), 0xa4);
        // A4 0026
        gbc.setState(0x2d03, 0x2d19, 0x8050, 0xb08a, 0x9d17, 0x8009, 0x0, 0x0);
        gbc.writeMem(0x2d03, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0xb0);
        EXPECT(gbc.c(),  0x8a);
        EXPECT(gbc.d(),  0x9d);
        EXPECT(gbc.e(),  0x17);
        EXPECT(gbc.h(),  0x80);
        EXPECT(gbc.l(),  0x9);
        EXPECT(gbc.sp(), 0x2d19);
        EXPECT(gbc.pc(), 0x2d04);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0027
        gbc.setState(0x1766, 0x5ca4, 0x82f0, 0xa8ab, 0x7d65, 0xe686, 0x1, 0x1);
        gbc.writeMem(0x1766, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x82);
        EXPECT(gbc.b(),  0xa8);
        EXPECT(gbc.c(),  0xab);
        EXPECT(gbc.d(),  0x7d);
        EXPECT(gbc.e(),  0x65);
        EXPECT(gbc.h(),  0xe6);
        EXPECT(gbc.l(),  0x86);
        EXPECT(gbc.sp(), 0x5ca4);
        EXPECT(gbc.pc(), 0x1767);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0028
        gbc.setState(0x9bc3, 0x3215, 0xe0, 0x3d7d, 0x30e8, 0xde0c, 0x0, 0x1);
        gbc.writeMem(0x9bc3, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x3d);
        EXPECT(gbc.c(),  0x7d);
        EXPECT(gbc.d(),  0x30);
        EXPECT(gbc.e(),  0xe8);
        EXPECT(gbc.h(),  0xde);
        EXPECT(gbc.l(),  0xc);
        EXPECT(gbc.sp(), 0x3215);
        EXPECT(gbc.pc(), 0x9bc4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9bc3), 0xa4);
        // A4 002A
        gbc.setState(0x675d, 0x2797, 0x1a10, 0x9b8d, 0x8580, 0xb808, 0x1, 0x0);
        gbc.writeMem(0x675d, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x18);
        EXPECT(gbc.b(),  0x9b);
        EXPECT(gbc.c(),  0x8d);
        EXPECT(gbc.d(),  0x85);
        EXPECT(gbc.e(),  0x80);
        EXPECT(gbc.h(),  0xb8);
        EXPECT(gbc.l(),  0x8);
        EXPECT(gbc.sp(), 0x2797);
        EXPECT(gbc.pc(), 0x675e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 002B
        gbc.setState(0xed06, 0x8814, 0x3aa0, 0xc033, 0x2a5d, 0xada4, 0x0, 0x1);
        gbc.writeMem(0xed06, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0xc0);
        EXPECT(gbc.c(),  0x33);
        EXPECT(gbc.d(),  0x2a);
        EXPECT(gbc.e(),  0x5d);
        EXPECT(gbc.h(),  0xad);
        EXPECT(gbc.l(),  0xa4);
        EXPECT(gbc.sp(), 0x8814);
        EXPECT(gbc.pc(), 0xed07);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xed06), 0xa4);
        // A4 002D
        gbc.setState(0xb585, 0xc6e0, 0x7ca0, 0xb462, 0xe034, 0x30af, 0x0, 0x1);
        gbc.writeMem(0xb585, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x30);
        EXPECT(gbc.b(),  0xb4);
        EXPECT(gbc.c(),  0x62);
        EXPECT(gbc.d(),  0xe0);
        EXPECT(gbc.e(),  0x34);
        EXPECT(gbc.h(),  0x30);
        EXPECT(gbc.l(),  0xaf);
        EXPECT(gbc.sp(), 0xc6e0);
        EXPECT(gbc.pc(), 0xb586);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb585), 0xa4);
        // A4 002E
        gbc.setState(0x3889, 0xde38, 0x4fe0, 0x203b, 0x1772, 0x5208, 0x0, 0x1);
        gbc.writeMem(0x3889, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x42);
        EXPECT(gbc.b(),  0x20);
        EXPECT(gbc.c(),  0x3b);
        EXPECT(gbc.d(),  0x17);
        EXPECT(gbc.e(),  0x72);
        EXPECT(gbc.h(),  0x52);
        EXPECT(gbc.l(),  0x8);
        EXPECT(gbc.sp(), 0xde38);
        EXPECT(gbc.pc(), 0x388a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 002F
        gbc.setState(0x5f6a, 0x7b37, 0x86c0, 0x5d14, 0xf870, 0x2ab9, 0x1, 0x0);
        gbc.writeMem(0x5f6a, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0x5d);
        EXPECT(gbc.c(),  0x14);
        EXPECT(gbc.d(),  0xf8);
        EXPECT(gbc.e(),  0x70);
        EXPECT(gbc.h(),  0x2a);
        EXPECT(gbc.l(),  0xb9);
        EXPECT(gbc.sp(), 0x7b37);
        EXPECT(gbc.pc(), 0x5f6b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0031
        gbc.setState(0xc382, 0x1f6a, 0xc1f0, 0x2fd4, 0x8771, 0x212f, 0x1, 0x0);
        gbc.writeMem(0xc382, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0x2f);
        EXPECT(gbc.c(),  0xd4);
        EXPECT(gbc.d(),  0x87);
        EXPECT(gbc.e(),  0x71);
        EXPECT(gbc.h(),  0x21);
        EXPECT(gbc.l(),  0x2f);
        EXPECT(gbc.sp(), 0x1f6a);
        EXPECT(gbc.pc(), 0xc383);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc382), 0xa4);
        // A4 0032
        gbc.setState(0xc138, 0xf97c, 0xe6d0, 0x8a62, 0xa041, 0x1cdf, 0x1, 0x0);
        gbc.writeMem(0xc138, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0x8a);
        EXPECT(gbc.c(),  0x62);
        EXPECT(gbc.d(),  0xa0);
        EXPECT(gbc.e(),  0x41);
        EXPECT(gbc.h(),  0x1c);
        EXPECT(gbc.l(),  0xdf);
        EXPECT(gbc.sp(), 0xf97c);
        EXPECT(gbc.pc(), 0xc139);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc138), 0xa4);
        // A4 0033
        gbc.setState(0xbc56, 0x6a01, 0xb250, 0x7e7d, 0x68be, 0xf983, 0x1, 0x0);
        gbc.writeMem(0xbc56, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb0);
        EXPECT(gbc.b(),  0x7e);
        EXPECT(gbc.c(),  0x7d);
        EXPECT(gbc.d(),  0x68);
        EXPECT(gbc.e(),  0xbe);
        EXPECT(gbc.h(),  0xf9);
        EXPECT(gbc.l(),  0x83);
        EXPECT(gbc.sp(), 0x6a01);
        EXPECT(gbc.pc(), 0xbc57);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbc56), 0xa4);
        // A4 0034
        gbc.setState(0x6233, 0x6fc5, 0x6e0, 0x279a, 0x6aff, 0xdfd3, 0x0, 0x0);
        gbc.writeMem(0x6233, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x6);
        EXPECT(gbc.b(),  0x27);
        EXPECT(gbc.c(),  0x9a);
        EXPECT(gbc.d(),  0x6a);
        EXPECT(gbc.e(),  0xff);
        EXPECT(gbc.h(),  0xdf);
        EXPECT(gbc.l(),  0xd3);
        EXPECT(gbc.sp(), 0x6fc5);
        EXPECT(gbc.pc(), 0x6234);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0035
        gbc.setState(0x9ff2, 0xbf2, 0xe690, 0x88dd, 0x33cb, 0x9210, 0x0, 0x1);
        gbc.writeMem(0x9ff2, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x82);
        EXPECT(gbc.b(),  0x88);
        EXPECT(gbc.c(),  0xdd);
        EXPECT(gbc.d(),  0x33);
        EXPECT(gbc.e(),  0xcb);
        EXPECT(gbc.h(),  0x92);
        EXPECT(gbc.l(),  0x10);
        EXPECT(gbc.sp(), 0xbf2);
        EXPECT(gbc.pc(), 0x9ff3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9ff2), 0xa4);
        // A4 0036
        gbc.setState(0xa449, 0xe190, 0x9cc0, 0x2ec9, 0xe828, 0xc865, 0x0, 0x1);
        gbc.writeMem(0xa449, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x88);
        EXPECT(gbc.b(),  0x2e);
        EXPECT(gbc.c(),  0xc9);
        EXPECT(gbc.d(),  0xe8);
        EXPECT(gbc.e(),  0x28);
        EXPECT(gbc.h(),  0xc8);
        EXPECT(gbc.l(),  0x65);
        EXPECT(gbc.sp(), 0xe190);
        EXPECT(gbc.pc(), 0xa44a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa449), 0xa4);
        // A4 0037
        gbc.setState(0xea9f, 0xbda3, 0x2b40, 0x26a6, 0x6015, 0x2826, 0x0, 0x0);
        gbc.writeMem(0xea9f, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0x26);
        EXPECT(gbc.c(),  0xa6);
        EXPECT(gbc.d(),  0x60);
        EXPECT(gbc.e(),  0x15);
        EXPECT(gbc.h(),  0x28);
        EXPECT(gbc.l(),  0x26);
        EXPECT(gbc.sp(), 0xbda3);
        EXPECT(gbc.pc(), 0xeaa0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xea9f), 0xa4);
        // A4 0038
        gbc.setState(0x3fb6, 0x8468, 0xdf40, 0xfdfa, 0x2a59, 0x9d71, 0x1, 0x1);
        gbc.writeMem(0x3fb6, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x9d);
        EXPECT(gbc.b(),  0xfd);
        EXPECT(gbc.c(),  0xfa);
        EXPECT(gbc.d(),  0x2a);
        EXPECT(gbc.e(),  0x59);
        EXPECT(gbc.h(),  0x9d);
        EXPECT(gbc.l(),  0x71);
        EXPECT(gbc.sp(), 0x8468);
        EXPECT(gbc.pc(), 0x3fb7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0039
        gbc.setState(0x4908, 0xa04e, 0xa8b0, 0xdc26, 0x451f, 0x14f5, 0x0, 0x0);
        gbc.writeMem(0x4908, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0xdc);
        EXPECT(gbc.c(),  0x26);
        EXPECT(gbc.d(),  0x45);
        EXPECT(gbc.e(),  0x1f);
        EXPECT(gbc.h(),  0x14);
        EXPECT(gbc.l(),  0xf5);
        EXPECT(gbc.sp(), 0xa04e);
        EXPECT(gbc.pc(), 0x4909);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 003A
        gbc.setState(0x1c5d, 0x7213, 0xfc0, 0x64e8, 0xa8f, 0x5416, 0x0, 0x1);
        gbc.writeMem(0x1c5d, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0x64);
        EXPECT(gbc.c(),  0xe8);
        EXPECT(gbc.d(),  0xa);
        EXPECT(gbc.e(),  0x8f);
        EXPECT(gbc.h(),  0x54);
        EXPECT(gbc.l(),  0x16);
        EXPECT(gbc.sp(), 0x7213);
        EXPECT(gbc.pc(), 0x1c5e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 003B
        gbc.setState(0xe9d2, 0x80a8, 0x9c30, 0xf67c, 0xbab2, 0xd04c, 0x1, 0x0);
        gbc.writeMem(0xe9d2, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x90);
        EXPECT(gbc.b(),  0xf6);
        EXPECT(gbc.c(),  0x7c);
        EXPECT(gbc.d(),  0xba);
        EXPECT(gbc.e(),  0xb2);
        EXPECT(gbc.h(),  0xd0);
        EXPECT(gbc.l(),  0x4c);
        EXPECT(gbc.sp(), 0x80a8);
        EXPECT(gbc.pc(), 0xe9d3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe9d2), 0xa4);
        // A4 003C
        gbc.setState(0x15c1, 0x8017, 0x1d00, 0xa54c, 0x6a09, 0x6e04, 0x0, 0x0);
        gbc.writeMem(0x15c1, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc);
        EXPECT(gbc.b(),  0xa5);
        EXPECT(gbc.c(),  0x4c);
        EXPECT(gbc.d(),  0x6a);
        EXPECT(gbc.e(),  0x9);
        EXPECT(gbc.h(),  0x6e);
        EXPECT(gbc.l(),  0x4);
        EXPECT(gbc.sp(), 0x8017);
        EXPECT(gbc.pc(), 0x15c2);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 003D
        gbc.setState(0x7d0a, 0x6a04, 0xce20, 0xce80, 0xafdf, 0x119d, 0x0, 0x1);
        gbc.writeMem(0x7d0a, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0xce);
        EXPECT(gbc.c(),  0x80);
        EXPECT(gbc.d(),  0xaf);
        EXPECT(gbc.e(),  0xdf);
        EXPECT(gbc.h(),  0x11);
        EXPECT(gbc.l(),  0x9d);
        EXPECT(gbc.sp(), 0x6a04);
        EXPECT(gbc.pc(), 0x7d0b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 003E
        gbc.setState(0x2ea3, 0x4944, 0x6120, 0xd9fe, 0x6087, 0xbecf, 0x1, 0x1);
        gbc.writeMem(0x2ea3, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0xd9);
        EXPECT(gbc.c(),  0xfe);
        EXPECT(gbc.d(),  0x60);
        EXPECT(gbc.e(),  0x87);
        EXPECT(gbc.h(),  0xbe);
        EXPECT(gbc.l(),  0xcf);
        EXPECT(gbc.sp(), 0x4944);
        EXPECT(gbc.pc(), 0x2ea4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 003F
        gbc.setState(0xa4b4, 0x1e15, 0xe670, 0x8745, 0x9a39, 0x22e1, 0x0, 0x1);
        gbc.writeMem(0xa4b4, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x22);
        EXPECT(gbc.b(),  0x87);
        EXPECT(gbc.c(),  0x45);
        EXPECT(gbc.d(),  0x9a);
        EXPECT(gbc.e(),  0x39);
        EXPECT(gbc.h(),  0x22);
        EXPECT(gbc.l(),  0xe1);
        EXPECT(gbc.sp(), 0x1e15);
        EXPECT(gbc.pc(), 0xa4b5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa4b4), 0xa4);
        // A4 0040
        gbc.setState(0x6831, 0x2dba, 0x8e00, 0xc063, 0x8c12, 0x96b8, 0x1, 0x1);
        gbc.writeMem(0x6831, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x86);
        EXPECT(gbc.b(),  0xc0);
        EXPECT(gbc.c(),  0x63);
        EXPECT(gbc.d(),  0x8c);
        EXPECT(gbc.e(),  0x12);
        EXPECT(gbc.h(),  0x96);
        EXPECT(gbc.l(),  0xb8);
        EXPECT(gbc.sp(), 0x2dba);
        EXPECT(gbc.pc(), 0x6832);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0041
        gbc.setState(0xe156, 0xace2, 0xdfb0, 0x9ae5, 0x3a39, 0x7fc6, 0x0, 0x1);
        gbc.writeMem(0xe156, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x5f);
        EXPECT(gbc.b(),  0x9a);
        EXPECT(gbc.c(),  0xe5);
        EXPECT(gbc.d(),  0x3a);
        EXPECT(gbc.e(),  0x39);
        EXPECT(gbc.h(),  0x7f);
        EXPECT(gbc.l(),  0xc6);
        EXPECT(gbc.sp(), 0xace2);
        EXPECT(gbc.pc(), 0xe157);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe156), 0xa4);
        // A4 0042
        gbc.setState(0xcd4f, 0x59a1, 0x2150, 0x24cc, 0xf55e, 0xe310, 0x0, 0x1);
        gbc.writeMem(0xcd4f, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x21);
        EXPECT(gbc.b(),  0x24);
        EXPECT(gbc.c(),  0xcc);
        EXPECT(gbc.d(),  0xf5);
        EXPECT(gbc.e(),  0x5e);
        EXPECT(gbc.h(),  0xe3);
        EXPECT(gbc.l(),  0x10);
        EXPECT(gbc.sp(), 0x59a1);
        EXPECT(gbc.pc(), 0xcd50);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcd4f), 0xa4);
        // A4 0043
        gbc.setState(0xce73, 0x33ce, 0xbdb0, 0xc088, 0x83d, 0x10b9, 0x1, 0x0);
        gbc.writeMem(0xce73, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0xc0);
        EXPECT(gbc.c(),  0x88);
        EXPECT(gbc.d(),  0x8);
        EXPECT(gbc.e(),  0x3d);
        EXPECT(gbc.h(),  0x10);
        EXPECT(gbc.l(),  0xb9);
        EXPECT(gbc.sp(), 0x33ce);
        EXPECT(gbc.pc(), 0xce74);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xce73), 0xa4);
        // A4 0044
        gbc.setState(0x72d9, 0xb1a3, 0xb910, 0xe88c, 0xd6a2, 0xfef5, 0x1, 0x1);
        gbc.writeMem(0x72d9, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb8);
        EXPECT(gbc.b(),  0xe8);
        EXPECT(gbc.c(),  0x8c);
        EXPECT(gbc.d(),  0xd6);
        EXPECT(gbc.e(),  0xa2);
        EXPECT(gbc.h(),  0xfe);
        EXPECT(gbc.l(),  0xf5);
        EXPECT(gbc.sp(), 0xb1a3);
        EXPECT(gbc.pc(), 0x72da);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0045
        gbc.setState(0x259b, 0xc8a9, 0x1c70, 0xc879, 0xe672, 0x6189, 0x0, 0x1);
        gbc.writeMem(0x259b, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0xc8);
        EXPECT(gbc.c(),  0x79);
        EXPECT(gbc.d(),  0xe6);
        EXPECT(gbc.e(),  0x72);
        EXPECT(gbc.h(),  0x61);
        EXPECT(gbc.l(),  0x89);
        EXPECT(gbc.sp(), 0xc8a9);
        EXPECT(gbc.pc(), 0x259c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0046
        gbc.setState(0xb5d0, 0xce7, 0x65f0, 0xe28c, 0x319d, 0xa5d8, 0x1, 0x0);
        gbc.writeMem(0xb5d0, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x25);
        EXPECT(gbc.b(),  0xe2);
        EXPECT(gbc.c(),  0x8c);
        EXPECT(gbc.d(),  0x31);
        EXPECT(gbc.e(),  0x9d);
        EXPECT(gbc.h(),  0xa5);
        EXPECT(gbc.l(),  0xd8);
        EXPECT(gbc.sp(), 0xce7);
        EXPECT(gbc.pc(), 0xb5d1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb5d0), 0xa4);
        // A4 0047
        gbc.setState(0xcb5a, 0x6f83, 0x3030, 0x6f6, 0xb149, 0xfd72, 0x1, 0x1);
        gbc.writeMem(0xcb5a, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x30);
        EXPECT(gbc.b(),  0x6);
        EXPECT(gbc.c(),  0xf6);
        EXPECT(gbc.d(),  0xb1);
        EXPECT(gbc.e(),  0x49);
        EXPECT(gbc.h(),  0xfd);
        EXPECT(gbc.l(),  0x72);
        EXPECT(gbc.sp(), 0x6f83);
        EXPECT(gbc.pc(), 0xcb5b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcb5a), 0xa4);
        // A4 0048
        gbc.setState(0x1a71, 0xdfe, 0xe510, 0xac90, 0xb2c9, 0x2256, 0x0, 0x0);
        gbc.writeMem(0x1a71, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0xac);
        EXPECT(gbc.c(),  0x90);
        EXPECT(gbc.d(),  0xb2);
        EXPECT(gbc.e(),  0xc9);
        EXPECT(gbc.h(),  0x22);
        EXPECT(gbc.l(),  0x56);
        EXPECT(gbc.sp(), 0xdfe);
        EXPECT(gbc.pc(), 0x1a72);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0049
        gbc.setState(0x2672, 0xc4ff, 0x590, 0x959d, 0x7f71, 0x5f3a, 0x0, 0x1);
        gbc.writeMem(0x2672, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x5);
        EXPECT(gbc.b(),  0x95);
        EXPECT(gbc.c(),  0x9d);
        EXPECT(gbc.d(),  0x7f);
        EXPECT(gbc.e(),  0x71);
        EXPECT(gbc.h(),  0x5f);
        EXPECT(gbc.l(),  0x3a);
        EXPECT(gbc.sp(), 0xc4ff);
        EXPECT(gbc.pc(), 0x2673);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 004A
        gbc.setState(0x9787, 0x828a, 0xc2b0, 0x3e7a, 0x87f0, 0xe401, 0x1, 0x1);
        gbc.writeMem(0x9787, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc0);
        EXPECT(gbc.b(),  0x3e);
        EXPECT(gbc.c(),  0x7a);
        EXPECT(gbc.d(),  0x87);
        EXPECT(gbc.e(),  0xf0);
        EXPECT(gbc.h(),  0xe4);
        EXPECT(gbc.l(),  0x1);
        EXPECT(gbc.sp(), 0x828a);
        EXPECT(gbc.pc(), 0x9788);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9787), 0xa4);
        // A4 004B
        gbc.setState(0x2cc, 0xa90f, 0xcb20, 0x3e5d, 0x857f, 0xc34b, 0x1, 0x0);
        gbc.writeMem(0x2cc, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc3);
        EXPECT(gbc.b(),  0x3e);
        EXPECT(gbc.c(),  0x5d);
        EXPECT(gbc.d(),  0x85);
        EXPECT(gbc.e(),  0x7f);
        EXPECT(gbc.h(),  0xc3);
        EXPECT(gbc.l(),  0x4b);
        EXPECT(gbc.sp(), 0xa90f);
        EXPECT(gbc.pc(), 0x2cd);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 004C
        gbc.setState(0x3444, 0x99cb, 0xb200, 0x3e25, 0x36bf, 0x28cc, 0x0, 0x0);
        gbc.writeMem(0x3444, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0x3e);
        EXPECT(gbc.c(),  0x25);
        EXPECT(gbc.d(),  0x36);
        EXPECT(gbc.e(),  0xbf);
        EXPECT(gbc.h(),  0x28);
        EXPECT(gbc.l(),  0xcc);
        EXPECT(gbc.sp(), 0x99cb);
        EXPECT(gbc.pc(), 0x3445);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 004D
        gbc.setState(0x1aa1, 0xb654, 0xefe0, 0xb49a, 0xc101, 0x2d6b, 0x0, 0x1);
        gbc.writeMem(0x1aa1, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2d);
        EXPECT(gbc.b(),  0xb4);
        EXPECT(gbc.c(),  0x9a);
        EXPECT(gbc.d(),  0xc1);
        EXPECT(gbc.e(),  0x1);
        EXPECT(gbc.h(),  0x2d);
        EXPECT(gbc.l(),  0x6b);
        EXPECT(gbc.sp(), 0xb654);
        EXPECT(gbc.pc(), 0x1aa2);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 004F
        gbc.setState(0xbd62, 0x6424, 0xee80, 0xbffd, 0xc047, 0xafdd, 0x1, 0x0);
        gbc.writeMem(0xbd62, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xae);
        EXPECT(gbc.b(),  0xbf);
        EXPECT(gbc.c(),  0xfd);
        EXPECT(gbc.d(),  0xc0);
        EXPECT(gbc.e(),  0x47);
        EXPECT(gbc.h(),  0xaf);
        EXPECT(gbc.l(),  0xdd);
        EXPECT(gbc.sp(), 0x6424);
        EXPECT(gbc.pc(), 0xbd63);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbd62), 0xa4);
        // A4 0050
        gbc.setState(0x821f, 0xd286, 0x84f0, 0x590f, 0x509, 0xcf0c, 0x1, 0x0);
        gbc.writeMem(0x821f, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x84);
        EXPECT(gbc.b(),  0x59);
        EXPECT(gbc.c(),  0xf);
        EXPECT(gbc.d(),  0x5);
        EXPECT(gbc.e(),  0x9);
        EXPECT(gbc.h(),  0xcf);
        EXPECT(gbc.l(),  0xc);
        EXPECT(gbc.sp(), 0xd286);
        EXPECT(gbc.pc(), 0x8220);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x821f), 0xa4);
        // A4 0051
        gbc.setState(0x1b14, 0x6a77, 0x7110, 0x6675, 0xf8d9, 0x16fd, 0x0, 0x1);
        gbc.writeMem(0x1b14, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0x66);
        EXPECT(gbc.c(),  0x75);
        EXPECT(gbc.d(),  0xf8);
        EXPECT(gbc.e(),  0xd9);
        EXPECT(gbc.h(),  0x16);
        EXPECT(gbc.l(),  0xfd);
        EXPECT(gbc.sp(), 0x6a77);
        EXPECT(gbc.pc(), 0x1b15);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0053
        gbc.setState(0x1e0f, 0x6b3e, 0x8350, 0x46c2, 0x7a34, 0x71c8, 0x1, 0x1);
        gbc.writeMem(0x1e0f, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0x46);
        EXPECT(gbc.c(),  0xc2);
        EXPECT(gbc.d(),  0x7a);
        EXPECT(gbc.e(),  0x34);
        EXPECT(gbc.h(),  0x71);
        EXPECT(gbc.l(),  0xc8);
        EXPECT(gbc.sp(), 0x6b3e);
        EXPECT(gbc.pc(), 0x1e10);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0054
        gbc.setState(0xba9f, 0x399e, 0x7360, 0x90fa, 0x6a2b, 0x3dbd, 0x1, 0x0);
        gbc.writeMem(0xba9f, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x31);
        EXPECT(gbc.b(),  0x90);
        EXPECT(gbc.c(),  0xfa);
        EXPECT(gbc.d(),  0x6a);
        EXPECT(gbc.e(),  0x2b);
        EXPECT(gbc.h(),  0x3d);
        EXPECT(gbc.l(),  0xbd);
        EXPECT(gbc.sp(), 0x399e);
        EXPECT(gbc.pc(), 0xbaa0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xba9f), 0xa4);
        // A4 0055
        gbc.setState(0x83d7, 0x521a, 0x50c0, 0x3389, 0xb361, 0x9e06, 0x1, 0x0);
        gbc.writeMem(0x83d7, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0x33);
        EXPECT(gbc.c(),  0x89);
        EXPECT(gbc.d(),  0xb3);
        EXPECT(gbc.e(),  0x61);
        EXPECT(gbc.h(),  0x9e);
        EXPECT(gbc.l(),  0x6);
        EXPECT(gbc.sp(), 0x521a);
        EXPECT(gbc.pc(), 0x83d8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x83d7), 0xa4);
        // A4 0056
        gbc.setState(0xe896, 0xc100, 0x7740, 0xe3c4, 0x37e2, 0x6402, 0x0, 0x1);
        gbc.writeMem(0xe896, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x64);
        EXPECT(gbc.b(),  0xe3);
        EXPECT(gbc.c(),  0xc4);
        EXPECT(gbc.d(),  0x37);
        EXPECT(gbc.e(),  0xe2);
        EXPECT(gbc.h(),  0x64);
        EXPECT(gbc.l(),  0x2);
        EXPECT(gbc.sp(), 0xc100);
        EXPECT(gbc.pc(), 0xe897);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe896), 0xa4);
        // A4 0058
        gbc.setState(0x722e, 0x5385, 0xbd60, 0xe243, 0x79f1, 0x3e1c, 0x0, 0x1);
        gbc.writeMem(0x722e, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3c);
        EXPECT(gbc.b(),  0xe2);
        EXPECT(gbc.c(),  0x43);
        EXPECT(gbc.d(),  0x79);
        EXPECT(gbc.e(),  0xf1);
        EXPECT(gbc.h(),  0x3e);
        EXPECT(gbc.l(),  0x1c);
        EXPECT(gbc.sp(), 0x5385);
        EXPECT(gbc.pc(), 0x722f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0059
        gbc.setState(0x262, 0xefa9, 0x1ec0, 0x3879, 0x8a5, 0xf531, 0x1, 0x0);
        gbc.writeMem(0x262, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x14);
        EXPECT(gbc.b(),  0x38);
        EXPECT(gbc.c(),  0x79);
        EXPECT(gbc.d(),  0x8);
        EXPECT(gbc.e(),  0xa5);
        EXPECT(gbc.h(),  0xf5);
        EXPECT(gbc.l(),  0x31);
        EXPECT(gbc.sp(), 0xefa9);
        EXPECT(gbc.pc(), 0x263);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 005A
        gbc.setState(0x2ec6, 0xdd11, 0x9800, 0x7dce, 0x84a3, 0xfcad, 0x0, 0x1);
        gbc.writeMem(0x2ec6, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x98);
        EXPECT(gbc.b(),  0x7d);
        EXPECT(gbc.c(),  0xce);
        EXPECT(gbc.d(),  0x84);
        EXPECT(gbc.e(),  0xa3);
        EXPECT(gbc.h(),  0xfc);
        EXPECT(gbc.l(),  0xad);
        EXPECT(gbc.sp(), 0xdd11);
        EXPECT(gbc.pc(), 0x2ec7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 005B
        gbc.setState(0xb8cf, 0x92ec, 0xdcb0, 0x990b, 0x7b71, 0x5a9, 0x0, 0x1);
        gbc.writeMem(0xb8cf, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0x99);
        EXPECT(gbc.c(),  0xb);
        EXPECT(gbc.d(),  0x7b);
        EXPECT(gbc.e(),  0x71);
        EXPECT(gbc.h(),  0x5);
        EXPECT(gbc.l(),  0xa9);
        EXPECT(gbc.sp(), 0x92ec);
        EXPECT(gbc.pc(), 0xb8d0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb8cf), 0xa4);
        // A4 005C
        gbc.setState(0xdc8b, 0xf73b, 0x3090, 0x2200, 0xbb56, 0xb54a, 0x1, 0x1);
        gbc.writeMem(0xdc8b, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x30);
        EXPECT(gbc.b(),  0x22);
        EXPECT(gbc.c(),  0x0);
        EXPECT(gbc.d(),  0xbb);
        EXPECT(gbc.e(),  0x56);
        EXPECT(gbc.h(),  0xb5);
        EXPECT(gbc.l(),  0x4a);
        EXPECT(gbc.sp(), 0xf73b);
        EXPECT(gbc.pc(), 0xdc8c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdc8b), 0xa4);
        // A4 005D
        gbc.setState(0xadad, 0x3575, 0x3f90, 0x7c69, 0xc9eb, 0x38ab, 0x0, 0x1);
        gbc.writeMem(0xadad, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x38);
        EXPECT(gbc.b(),  0x7c);
        EXPECT(gbc.c(),  0x69);
        EXPECT(gbc.d(),  0xc9);
        EXPECT(gbc.e(),  0xeb);
        EXPECT(gbc.h(),  0x38);
        EXPECT(gbc.l(),  0xab);
        EXPECT(gbc.sp(), 0x3575);
        EXPECT(gbc.pc(), 0xadae);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xadad), 0xa4);
        // A4 005E
        gbc.setState(0x7ae0, 0x40f4, 0x7d10, 0x4949, 0xd2b1, 0xdd8b, 0x1, 0x0);
        gbc.writeMem(0x7ae0, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x5d);
        EXPECT(gbc.b(),  0x49);
        EXPECT(gbc.c(),  0x49);
        EXPECT(gbc.d(),  0xd2);
        EXPECT(gbc.e(),  0xb1);
        EXPECT(gbc.h(),  0xdd);
        EXPECT(gbc.l(),  0x8b);
        EXPECT(gbc.sp(), 0x40f4);
        EXPECT(gbc.pc(), 0x7ae1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 005F
        gbc.setState(0xb9a7, 0x819b, 0xf7d0, 0xef54, 0x251f, 0x96fc, 0x0, 0x0);
        gbc.writeMem(0xb9a7, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x96);
        EXPECT(gbc.b(),  0xef);
        EXPECT(gbc.c(),  0x54);
        EXPECT(gbc.d(),  0x25);
        EXPECT(gbc.e(),  0x1f);
        EXPECT(gbc.h(),  0x96);
        EXPECT(gbc.l(),  0xfc);
        EXPECT(gbc.sp(), 0x819b);
        EXPECT(gbc.pc(), 0xb9a8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb9a7), 0xa4);
        // A4 0060
        gbc.setState(0xcc12, 0x4f33, 0xd690, 0x2a38, 0x489d, 0x8e18, 0x0, 0x1);
        gbc.writeMem(0xcc12, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x86);
        EXPECT(gbc.b(),  0x2a);
        EXPECT(gbc.c(),  0x38);
        EXPECT(gbc.d(),  0x48);
        EXPECT(gbc.e(),  0x9d);
        EXPECT(gbc.h(),  0x8e);
        EXPECT(gbc.l(),  0x18);
        EXPECT(gbc.sp(), 0x4f33);
        EXPECT(gbc.pc(), 0xcc13);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcc12), 0xa4);
        // A4 0061
        gbc.setState(0x6a51, 0xe400, 0xcf60, 0x3643, 0x9d4a, 0x177a, 0x0, 0x1);
        gbc.writeMem(0x6a51, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x7);
        EXPECT(gbc.b(),  0x36);
        EXPECT(gbc.c(),  0x43);
        EXPECT(gbc.d(),  0x9d);
        EXPECT(gbc.e(),  0x4a);
        EXPECT(gbc.h(),  0x17);
        EXPECT(gbc.l(),  0x7a);
        EXPECT(gbc.sp(), 0xe400);
        EXPECT(gbc.pc(), 0x6a52);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0062
        gbc.setState(0x8398, 0x85db, 0x3ca0, 0x27bd, 0x1e8f, 0xcab8, 0x0, 0x1);
        gbc.writeMem(0x8398, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0x27);
        EXPECT(gbc.c(),  0xbd);
        EXPECT(gbc.d(),  0x1e);
        EXPECT(gbc.e(),  0x8f);
        EXPECT(gbc.h(),  0xca);
        EXPECT(gbc.l(),  0xb8);
        EXPECT(gbc.sp(), 0x85db);
        EXPECT(gbc.pc(), 0x8399);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8398), 0xa4);
        // A4 0063
        gbc.setState(0x45c5, 0x5527, 0xd260, 0x1b3d, 0x87d7, 0x6d09, 0x0, 0x0);
        gbc.writeMem(0x45c5, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0x1b);
        EXPECT(gbc.c(),  0x3d);
        EXPECT(gbc.d(),  0x87);
        EXPECT(gbc.e(),  0xd7);
        EXPECT(gbc.h(),  0x6d);
        EXPECT(gbc.l(),  0x9);
        EXPECT(gbc.sp(), 0x5527);
        EXPECT(gbc.pc(), 0x45c6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0064
        gbc.setState(0x26b4, 0xaae, 0xa7c0, 0x1646, 0x8204, 0xacb5, 0x1, 0x1);
        gbc.writeMem(0x26b4, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa4);
        EXPECT(gbc.b(),  0x16);
        EXPECT(gbc.c(),  0x46);
        EXPECT(gbc.d(),  0x82);
        EXPECT(gbc.e(),  0x4);
        EXPECT(gbc.h(),  0xac);
        EXPECT(gbc.l(),  0xb5);
        EXPECT(gbc.sp(), 0xaae);
        EXPECT(gbc.pc(), 0x26b5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0065
        gbc.setState(0x70ab, 0x4add, 0x2ec0, 0xd6d6, 0x1961, 0x9b3a, 0x0, 0x1);
        gbc.writeMem(0x70ab, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa);
        EXPECT(gbc.b(),  0xd6);
        EXPECT(gbc.c(),  0xd6);
        EXPECT(gbc.d(),  0x19);
        EXPECT(gbc.e(),  0x61);
        EXPECT(gbc.h(),  0x9b);
        EXPECT(gbc.l(),  0x3a);
        EXPECT(gbc.sp(), 0x4add);
        EXPECT(gbc.pc(), 0x70ac);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0066
        gbc.setState(0x36df, 0x116f, 0xe910, 0xd013, 0xa5b2, 0x167a, 0x1, 0x1);
        gbc.writeMem(0x36df, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0xd0);
        EXPECT(gbc.c(),  0x13);
        EXPECT(gbc.d(),  0xa5);
        EXPECT(gbc.e(),  0xb2);
        EXPECT(gbc.h(),  0x16);
        EXPECT(gbc.l(),  0x7a);
        EXPECT(gbc.sp(), 0x116f);
        EXPECT(gbc.pc(), 0x36e0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0067
        gbc.setState(0xc5b3, 0xa01d, 0xfd60, 0x4080, 0x2515, 0x5c9a, 0x0, 0x0);
        gbc.writeMem(0xc5b3, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x5c);
        EXPECT(gbc.b(),  0x40);
        EXPECT(gbc.c(),  0x80);
        EXPECT(gbc.d(),  0x25);
        EXPECT(gbc.e(),  0x15);
        EXPECT(gbc.h(),  0x5c);
        EXPECT(gbc.l(),  0x9a);
        EXPECT(gbc.sp(), 0xa01d);
        EXPECT(gbc.pc(), 0xc5b4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc5b3), 0xa4);
        // A4 0068
        gbc.setState(0x60a, 0x935f, 0xed40, 0x67a4, 0xd30e, 0x6545, 0x1, 0x0);
        gbc.writeMem(0x60a, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x65);
        EXPECT(gbc.b(),  0x67);
        EXPECT(gbc.c(),  0xa4);
        EXPECT(gbc.d(),  0xd3);
        EXPECT(gbc.e(),  0xe);
        EXPECT(gbc.h(),  0x65);
        EXPECT(gbc.l(),  0x45);
        EXPECT(gbc.sp(), 0x935f);
        EXPECT(gbc.pc(), 0x60b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0069
        gbc.setState(0x8ea7, 0xbc65, 0x3b0, 0x78b5, 0x7e37, 0x3c6a, 0x1, 0x0);
        gbc.writeMem(0x8ea7, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x78);
        EXPECT(gbc.c(),  0xb5);
        EXPECT(gbc.d(),  0x7e);
        EXPECT(gbc.e(),  0x37);
        EXPECT(gbc.h(),  0x3c);
        EXPECT(gbc.l(),  0x6a);
        EXPECT(gbc.sp(), 0xbc65);
        EXPECT(gbc.pc(), 0x8ea8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8ea7), 0xa4);
        // A4 006A
        gbc.setState(0x1ecc, 0x2d59, 0xbd90, 0xcec4, 0x8ecc, 0x505a, 0x0, 0x0);
        gbc.writeMem(0x1ecc, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0xce);
        EXPECT(gbc.c(),  0xc4);
        EXPECT(gbc.d(),  0x8e);
        EXPECT(gbc.e(),  0xcc);
        EXPECT(gbc.h(),  0x50);
        EXPECT(gbc.l(),  0x5a);
        EXPECT(gbc.sp(), 0x2d59);
        EXPECT(gbc.pc(), 0x1ecd);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 006B
        gbc.setState(0xbd3f, 0x4691, 0x6920, 0x7ba1, 0xc49f, 0x7220, 0x1, 0x0);
        gbc.writeMem(0xbd3f, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x60);
        EXPECT(gbc.b(),  0x7b);
        EXPECT(gbc.c(),  0xa1);
        EXPECT(gbc.d(),  0xc4);
        EXPECT(gbc.e(),  0x9f);
        EXPECT(gbc.h(),  0x72);
        EXPECT(gbc.l(),  0x20);
        EXPECT(gbc.sp(), 0x4691);
        EXPECT(gbc.pc(), 0xbd40);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbd3f), 0xa4);
        // A4 006C
        gbc.setState(0x531e, 0xbbed, 0xf730, 0x4a3, 0xea50, 0x6d65, 0x1, 0x0);
        gbc.writeMem(0x531e, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x65);
        EXPECT(gbc.b(),  0x4);
        EXPECT(gbc.c(),  0xa3);
        EXPECT(gbc.d(),  0xea);
        EXPECT(gbc.e(),  0x50);
        EXPECT(gbc.h(),  0x6d);
        EXPECT(gbc.l(),  0x65);
        EXPECT(gbc.sp(), 0xbbed);
        EXPECT(gbc.pc(), 0x531f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 006D
        gbc.setState(0xb407, 0x1b72, 0xe030, 0x67e4, 0xffc8, 0x3d12, 0x0, 0x0);
        gbc.writeMem(0xb407, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0x67);
        EXPECT(gbc.c(),  0xe4);
        EXPECT(gbc.d(),  0xff);
        EXPECT(gbc.e(),  0xc8);
        EXPECT(gbc.h(),  0x3d);
        EXPECT(gbc.l(),  0x12);
        EXPECT(gbc.sp(), 0x1b72);
        EXPECT(gbc.pc(), 0xb408);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb407), 0xa4);
        // A4 006E
        gbc.setState(0xc5f1, 0xa520, 0xc380, 0x1102, 0xff88, 0x7b54, 0x1, 0x0);
        gbc.writeMem(0xc5f1, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x43);
        EXPECT(gbc.b(),  0x11);
        EXPECT(gbc.c(),  0x2);
        EXPECT(gbc.d(),  0xff);
        EXPECT(gbc.e(),  0x88);
        EXPECT(gbc.h(),  0x7b);
        EXPECT(gbc.l(),  0x54);
        EXPECT(gbc.sp(), 0xa520);
        EXPECT(gbc.pc(), 0xc5f2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc5f1), 0xa4);
        // A4 006F
        gbc.setState(0xc1f5, 0x8577, 0xecb0, 0xfd09, 0xdc48, 0xe823, 0x1, 0x0);
        gbc.writeMem(0xc1f5, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe8);
        EXPECT(gbc.b(),  0xfd);
        EXPECT(gbc.c(),  0x9);
        EXPECT(gbc.d(),  0xdc);
        EXPECT(gbc.e(),  0x48);
        EXPECT(gbc.h(),  0xe8);
        EXPECT(gbc.l(),  0x23);
        EXPECT(gbc.sp(), 0x8577);
        EXPECT(gbc.pc(), 0xc1f6);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc1f5), 0xa4);
        // A4 0070
        gbc.setState(0x112a, 0x1a6e, 0xfc10, 0xb3, 0x5174, 0x58da, 0x0, 0x0);
        gbc.writeMem(0x112a, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x58);
        EXPECT(gbc.b(),  0x0);
        EXPECT(gbc.c(),  0xb3);
        EXPECT(gbc.d(),  0x51);
        EXPECT(gbc.e(),  0x74);
        EXPECT(gbc.h(),  0x58);
        EXPECT(gbc.l(),  0xda);
        EXPECT(gbc.sp(), 0x1a6e);
        EXPECT(gbc.pc(), 0x112b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0071
        gbc.setState(0x8e47, 0xb8f4, 0x4cb0, 0xe77f, 0x921c, 0x1fde, 0x1, 0x0);
        gbc.writeMem(0x8e47, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc);
        EXPECT(gbc.b(),  0xe7);
        EXPECT(gbc.c(),  0x7f);
        EXPECT(gbc.d(),  0x92);
        EXPECT(gbc.e(),  0x1c);
        EXPECT(gbc.h(),  0x1f);
        EXPECT(gbc.l(),  0xde);
        EXPECT(gbc.sp(), 0xb8f4);
        EXPECT(gbc.pc(), 0x8e48);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8e47), 0xa4);
        // A4 0072
        gbc.setState(0x9197, 0x868a, 0x3b20, 0x3808, 0x6bd5, 0xea5, 0x1, 0x1);
        gbc.writeMem(0x9197, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa);
        EXPECT(gbc.b(),  0x38);
        EXPECT(gbc.c(),  0x8);
        EXPECT(gbc.d(),  0x6b);
        EXPECT(gbc.e(),  0xd5);
        EXPECT(gbc.h(),  0xe);
        EXPECT(gbc.l(),  0xa5);
        EXPECT(gbc.sp(), 0x868a);
        EXPECT(gbc.pc(), 0x9198);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9197), 0xa4);
        // A4 0073
        gbc.setState(0x449c, 0xffe2, 0xa0a0, 0x5944, 0x52ef, 0xc42e, 0x0, 0x1);
        gbc.writeMem(0x449c, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0x59);
        EXPECT(gbc.c(),  0x44);
        EXPECT(gbc.d(),  0x52);
        EXPECT(gbc.e(),  0xef);
        EXPECT(gbc.h(),  0xc4);
        EXPECT(gbc.l(),  0x2e);
        EXPECT(gbc.sp(), 0xffe2);
        EXPECT(gbc.pc(), 0x449d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0074
        gbc.setState(0xb105, 0x8fe9, 0xd0f0, 0x64d2, 0xa2a2, 0x422b, 0x1, 0x0);
        gbc.writeMem(0xb105, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0x64);
        EXPECT(gbc.c(),  0xd2);
        EXPECT(gbc.d(),  0xa2);
        EXPECT(gbc.e(),  0xa2);
        EXPECT(gbc.h(),  0x42);
        EXPECT(gbc.l(),  0x2b);
        EXPECT(gbc.sp(), 0x8fe9);
        EXPECT(gbc.pc(), 0xb106);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb105), 0xa4);
        // A4 0075
        gbc.setState(0x3b5d, 0x5022, 0x56b0, 0xe81c, 0xee41, 0x34d7, 0x1, 0x0);
        gbc.writeMem(0x3b5d, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x14);
        EXPECT(gbc.b(),  0xe8);
        EXPECT(gbc.c(),  0x1c);
        EXPECT(gbc.d(),  0xee);
        EXPECT(gbc.e(),  0x41);
        EXPECT(gbc.h(),  0x34);
        EXPECT(gbc.l(),  0xd7);
        EXPECT(gbc.sp(), 0x5022);
        EXPECT(gbc.pc(), 0x3b5e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0076
        gbc.setState(0x1de0, 0x4e8e, 0x17f0, 0xf9e0, 0xd641, 0x2a7f, 0x0, 0x0);
        gbc.writeMem(0x1de0, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0xf9);
        EXPECT(gbc.c(),  0xe0);
        EXPECT(gbc.d(),  0xd6);
        EXPECT(gbc.e(),  0x41);
        EXPECT(gbc.h(),  0x2a);
        EXPECT(gbc.l(),  0x7f);
        EXPECT(gbc.sp(), 0x4e8e);
        EXPECT(gbc.pc(), 0x1de1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0077
        gbc.setState(0x3e34, 0x893d, 0x1990, 0x4a5a, 0xb0cb, 0x7236, 0x1, 0x0);
        gbc.writeMem(0x3e34, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0x4a);
        EXPECT(gbc.c(),  0x5a);
        EXPECT(gbc.d(),  0xb0);
        EXPECT(gbc.e(),  0xcb);
        EXPECT(gbc.h(),  0x72);
        EXPECT(gbc.l(),  0x36);
        EXPECT(gbc.sp(), 0x893d);
        EXPECT(gbc.pc(), 0x3e35);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0078
        gbc.setState(0xa83a, 0xce89, 0xf730, 0xfaa4, 0x102, 0xd464, 0x1, 0x0);
        gbc.writeMem(0xa83a, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd4);
        EXPECT(gbc.b(),  0xfa);
        EXPECT(gbc.c(),  0xa4);
        EXPECT(gbc.d(),  0x1);
        EXPECT(gbc.e(),  0x2);
        EXPECT(gbc.h(),  0xd4);
        EXPECT(gbc.l(),  0x64);
        EXPECT(gbc.sp(), 0xce89);
        EXPECT(gbc.pc(), 0xa83b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa83a), 0xa4);
        // A4 0079
        gbc.setState(0xa698, 0x5d71, 0x5de0, 0x5edb, 0xdc75, 0x3845, 0x0, 0x0);
        gbc.writeMem(0xa698, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x18);
        EXPECT(gbc.b(),  0x5e);
        EXPECT(gbc.c(),  0xdb);
        EXPECT(gbc.d(),  0xdc);
        EXPECT(gbc.e(),  0x75);
        EXPECT(gbc.h(),  0x38);
        EXPECT(gbc.l(),  0x45);
        EXPECT(gbc.sp(), 0x5d71);
        EXPECT(gbc.pc(), 0xa699);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa698), 0xa4);
        // A4 007A
        gbc.setState(0x9d82, 0xcd01, 0x8720, 0x12e5, 0x9a71, 0xd848, 0x0, 0x0);
        gbc.writeMem(0x9d82, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0x12);
        EXPECT(gbc.c(),  0xe5);
        EXPECT(gbc.d(),  0x9a);
        EXPECT(gbc.e(),  0x71);
        EXPECT(gbc.h(),  0xd8);
        EXPECT(gbc.l(),  0x48);
        EXPECT(gbc.sp(), 0xcd01);
        EXPECT(gbc.pc(), 0x9d83);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9d82), 0xa4);
        // A4 007B
        gbc.setState(0xb884, 0x4f22, 0xfb60, 0x3029, 0xbc68, 0x7e96, 0x1, 0x0);
        gbc.writeMem(0xb884, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x7a);
        EXPECT(gbc.b(),  0x30);
        EXPECT(gbc.c(),  0x29);
        EXPECT(gbc.d(),  0xbc);
        EXPECT(gbc.e(),  0x68);
        EXPECT(gbc.h(),  0x7e);
        EXPECT(gbc.l(),  0x96);
        EXPECT(gbc.sp(), 0x4f22);
        EXPECT(gbc.pc(), 0xb885);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb884), 0xa4);
        // A4 007C
        gbc.setState(0xc8e5, 0x2786, 0xc040, 0xb06f, 0xe8ef, 0xbc5d, 0x0, 0x1);
        gbc.writeMem(0xc8e5, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0xb0);
        EXPECT(gbc.c(),  0x6f);
        EXPECT(gbc.d(),  0xe8);
        EXPECT(gbc.e(),  0xef);
        EXPECT(gbc.h(),  0xbc);
        EXPECT(gbc.l(),  0x5d);
        EXPECT(gbc.sp(), 0x2786);
        EXPECT(gbc.pc(), 0xc8e6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc8e5), 0xa4);
        // A4 007D
        gbc.setState(0xcfad, 0x7bb, 0x5330, 0x5d20, 0xc4b1, 0x970c, 0x1, 0x1);
        gbc.writeMem(0xcfad, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x13);
        EXPECT(gbc.b(),  0x5d);
        EXPECT(gbc.c(),  0x20);
        EXPECT(gbc.d(),  0xc4);
        EXPECT(gbc.e(),  0xb1);
        EXPECT(gbc.h(),  0x97);
        EXPECT(gbc.l(),  0xc);
        EXPECT(gbc.sp(), 0x7bb);
        EXPECT(gbc.pc(), 0xcfae);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcfad), 0xa4);
        // A4 007E
        gbc.setState(0x8d44, 0xb8ae, 0xd980, 0xc0cd, 0x6b27, 0xb393, 0x0, 0x1);
        gbc.writeMem(0x8d44, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x91);
        EXPECT(gbc.b(),  0xc0);
        EXPECT(gbc.c(),  0xcd);
        EXPECT(gbc.d(),  0x6b);
        EXPECT(gbc.e(),  0x27);
        EXPECT(gbc.h(),  0xb3);
        EXPECT(gbc.l(),  0x93);
        EXPECT(gbc.sp(), 0xb8ae);
        EXPECT(gbc.pc(), 0x8d45);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8d44), 0xa4);
        // A4 007F
        gbc.setState(0x720e, 0xf9bd, 0x3510, 0x39f4, 0x12ff, 0xd086, 0x1, 0x1);
        gbc.writeMem(0x720e, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0x39);
        EXPECT(gbc.c(),  0xf4);
        EXPECT(gbc.d(),  0x12);
        EXPECT(gbc.e(),  0xff);
        EXPECT(gbc.h(),  0xd0);
        EXPECT(gbc.l(),  0x86);
        EXPECT(gbc.sp(), 0xf9bd);
        EXPECT(gbc.pc(), 0x720f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0080
        gbc.setState(0x46dc, 0xda9b, 0xdca0, 0x8615, 0x365d, 0x3852, 0x0, 0x1);
        gbc.writeMem(0x46dc, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x18);
        EXPECT(gbc.b(),  0x86);
        EXPECT(gbc.c(),  0x15);
        EXPECT(gbc.d(),  0x36);
        EXPECT(gbc.e(),  0x5d);
        EXPECT(gbc.h(),  0x38);
        EXPECT(gbc.l(),  0x52);
        EXPECT(gbc.sp(), 0xda9b);
        EXPECT(gbc.pc(), 0x46dd);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0081
        gbc.setState(0x3f7a, 0x9cc6, 0x7ff0, 0xad02, 0x31f, 0xdc60, 0x0, 0x1);
        gbc.writeMem(0x3f7a, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x5c);
        EXPECT(gbc.b(),  0xad);
        EXPECT(gbc.c(),  0x2);
        EXPECT(gbc.d(),  0x3);
        EXPECT(gbc.e(),  0x1f);
        EXPECT(gbc.h(),  0xdc);
        EXPECT(gbc.l(),  0x60);
        EXPECT(gbc.sp(), 0x9cc6);
        EXPECT(gbc.pc(), 0x3f7b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0082
        gbc.setState(0x67d2, 0xbb43, 0x2d20, 0x138d, 0x749d, 0x36e4, 0x1, 0x1);
        gbc.writeMem(0x67d2, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x24);
        EXPECT(gbc.b(),  0x13);
        EXPECT(gbc.c(),  0x8d);
        EXPECT(gbc.d(),  0x74);
        EXPECT(gbc.e(),  0x9d);
        EXPECT(gbc.h(),  0x36);
        EXPECT(gbc.l(),  0xe4);
        EXPECT(gbc.sp(), 0xbb43);
        EXPECT(gbc.pc(), 0x67d3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0083
        gbc.setState(0xc518, 0x8acc, 0x30d0, 0x92e5, 0xbec7, 0x79ef, 0x1, 0x0);
        gbc.writeMem(0xc518, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x30);
        EXPECT(gbc.b(),  0x92);
        EXPECT(gbc.c(),  0xe5);
        EXPECT(gbc.d(),  0xbe);
        EXPECT(gbc.e(),  0xc7);
        EXPECT(gbc.h(),  0x79);
        EXPECT(gbc.l(),  0xef);
        EXPECT(gbc.sp(), 0x8acc);
        EXPECT(gbc.pc(), 0xc519);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc518), 0xa4);
        // A4 0084
        gbc.setState(0xa45c, 0xa837, 0x4900, 0xf902, 0x350f, 0xc716, 0x1, 0x1);
        gbc.writeMem(0xa45c, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x41);
        EXPECT(gbc.b(),  0xf9);
        EXPECT(gbc.c(),  0x2);
        EXPECT(gbc.d(),  0x35);
        EXPECT(gbc.e(),  0xf);
        EXPECT(gbc.h(),  0xc7);
        EXPECT(gbc.l(),  0x16);
        EXPECT(gbc.sp(), 0xa837);
        EXPECT(gbc.pc(), 0xa45d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa45c), 0xa4);
        // A4 0085
        gbc.setState(0xca26, 0x66da, 0x9280, 0xdc56, 0xbb36, 0x4af7, 0x0, 0x1);
        gbc.writeMem(0xca26, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0xdc);
        EXPECT(gbc.c(),  0x56);
        EXPECT(gbc.d(),  0xbb);
        EXPECT(gbc.e(),  0x36);
        EXPECT(gbc.h(),  0x4a);
        EXPECT(gbc.l(),  0xf7);
        EXPECT(gbc.sp(), 0x66da);
        EXPECT(gbc.pc(), 0xca27);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xca26), 0xa4);
        // A4 0086
        gbc.setState(0x1c19, 0x9a71, 0x79c0, 0xddb0, 0x19ed, 0xd45f, 0x1, 0x0);
        gbc.writeMem(0x1c19, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x50);
        EXPECT(gbc.b(),  0xdd);
        EXPECT(gbc.c(),  0xb0);
        EXPECT(gbc.d(),  0x19);
        EXPECT(gbc.e(),  0xed);
        EXPECT(gbc.h(),  0xd4);
        EXPECT(gbc.l(),  0x5f);
        EXPECT(gbc.sp(), 0x9a71);
        EXPECT(gbc.pc(), 0x1c1a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0087
        gbc.setState(0x53fe, 0x500c, 0x8130, 0xe8ab, 0xd844, 0x90a0, 0x1, 0x0);
        gbc.writeMem(0x53fe, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0xe8);
        EXPECT(gbc.c(),  0xab);
        EXPECT(gbc.d(),  0xd8);
        EXPECT(gbc.e(),  0x44);
        EXPECT(gbc.h(),  0x90);
        EXPECT(gbc.l(),  0xa0);
        EXPECT(gbc.sp(), 0x500c);
        EXPECT(gbc.pc(), 0x53ff);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0088
        gbc.setState(0xd1d9, 0x40be, 0x74f0, 0x1f59, 0x7dd2, 0x5033, 0x1, 0x0);
        gbc.writeMem(0xd1d9, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x50);
        EXPECT(gbc.b(),  0x1f);
        EXPECT(gbc.c(),  0x59);
        EXPECT(gbc.d(),  0x7d);
        EXPECT(gbc.e(),  0xd2);
        EXPECT(gbc.h(),  0x50);
        EXPECT(gbc.l(),  0x33);
        EXPECT(gbc.sp(), 0x40be);
        EXPECT(gbc.pc(), 0xd1da);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd1d9), 0xa4);
        // A4 0089
        gbc.setState(0xdd36, 0xf879, 0xf40, 0x1567, 0x47ad, 0x28c1, 0x0, 0x1);
        gbc.writeMem(0xdd36, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0x15);
        EXPECT(gbc.c(),  0x67);
        EXPECT(gbc.d(),  0x47);
        EXPECT(gbc.e(),  0xad);
        EXPECT(gbc.h(),  0x28);
        EXPECT(gbc.l(),  0xc1);
        EXPECT(gbc.sp(), 0xf879);
        EXPECT(gbc.pc(), 0xdd37);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdd36), 0xa4);
        // A4 008A
        gbc.setState(0x1315, 0x1c92, 0xec00, 0x4a1e, 0xfa0a, 0x2bc9, 0x1, 0x1);
        gbc.writeMem(0x1315, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0x4a);
        EXPECT(gbc.c(),  0x1e);
        EXPECT(gbc.d(),  0xfa);
        EXPECT(gbc.e(),  0xa);
        EXPECT(gbc.h(),  0x2b);
        EXPECT(gbc.l(),  0xc9);
        EXPECT(gbc.sp(), 0x1c92);
        EXPECT(gbc.pc(), 0x1316);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 008B
        gbc.setState(0x69b8, 0x5f31, 0x42c0, 0x640b, 0xfc90, 0xeafa, 0x1, 0x1);
        gbc.writeMem(0x69b8, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x42);
        EXPECT(gbc.b(),  0x64);
        EXPECT(gbc.c(),  0xb);
        EXPECT(gbc.d(),  0xfc);
        EXPECT(gbc.e(),  0x90);
        EXPECT(gbc.h(),  0xea);
        EXPECT(gbc.l(),  0xfa);
        EXPECT(gbc.sp(), 0x5f31);
        EXPECT(gbc.pc(), 0x69b9);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 008C
        gbc.setState(0xdecb, 0x1db2, 0xf60, 0x65a5, 0x3f6b, 0x32d9, 0x0, 0x0);
        gbc.writeMem(0xdecb, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0x65);
        EXPECT(gbc.c(),  0xa5);
        EXPECT(gbc.d(),  0x3f);
        EXPECT(gbc.e(),  0x6b);
        EXPECT(gbc.h(),  0x32);
        EXPECT(gbc.l(),  0xd9);
        EXPECT(gbc.sp(), 0x1db2);
        EXPECT(gbc.pc(), 0xdecc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdecb), 0xa4);
        // A4 008D
        gbc.setState(0xb871, 0x21cb, 0xf3a0, 0x3d55, 0x3e0f, 0xe346, 0x1, 0x0);
        gbc.writeMem(0xb871, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe3);
        EXPECT(gbc.b(),  0x3d);
        EXPECT(gbc.c(),  0x55);
        EXPECT(gbc.d(),  0x3e);
        EXPECT(gbc.e(),  0xf);
        EXPECT(gbc.h(),  0xe3);
        EXPECT(gbc.l(),  0x46);
        EXPECT(gbc.sp(), 0x21cb);
        EXPECT(gbc.pc(), 0xb872);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb871), 0xa4);
        // A4 008E
        gbc.setState(0xb97, 0xdaa0, 0xbf50, 0x9b23, 0xdc70, 0xe9c3, 0x1, 0x0);
        gbc.writeMem(0xb97, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa9);
        EXPECT(gbc.b(),  0x9b);
        EXPECT(gbc.c(),  0x23);
        EXPECT(gbc.d(),  0xdc);
        EXPECT(gbc.e(),  0x70);
        EXPECT(gbc.h(),  0xe9);
        EXPECT(gbc.l(),  0xc3);
        EXPECT(gbc.sp(), 0xdaa0);
        EXPECT(gbc.pc(), 0xb98);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 008F
        gbc.setState(0x2269, 0x9273, 0x8280, 0x1cfa, 0x4c93, 0x88a8, 0x1, 0x0);
        gbc.writeMem(0x2269, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0x1c);
        EXPECT(gbc.c(),  0xfa);
        EXPECT(gbc.d(),  0x4c);
        EXPECT(gbc.e(),  0x93);
        EXPECT(gbc.h(),  0x88);
        EXPECT(gbc.l(),  0xa8);
        EXPECT(gbc.sp(), 0x9273);
        EXPECT(gbc.pc(), 0x226a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0090
        gbc.setState(0x8279, 0x43cb, 0x230, 0xbb39, 0xd7ad, 0xb6e2, 0x0, 0x0);
        gbc.writeMem(0x8279, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0xbb);
        EXPECT(gbc.c(),  0x39);
        EXPECT(gbc.d(),  0xd7);
        EXPECT(gbc.e(),  0xad);
        EXPECT(gbc.h(),  0xb6);
        EXPECT(gbc.l(),  0xe2);
        EXPECT(gbc.sp(), 0x43cb);
        EXPECT(gbc.pc(), 0x827a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8279), 0xa4);
        // A4 0091
        gbc.setState(0x2626, 0x9fbe, 0x7a00, 0xea02, 0x3061, 0xd9d5, 0x0, 0x0);
        gbc.writeMem(0x2626, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x58);
        EXPECT(gbc.b(),  0xea);
        EXPECT(gbc.c(),  0x2);
        EXPECT(gbc.d(),  0x30);
        EXPECT(gbc.e(),  0x61);
        EXPECT(gbc.h(),  0xd9);
        EXPECT(gbc.l(),  0xd5);
        EXPECT(gbc.sp(), 0x9fbe);
        EXPECT(gbc.pc(), 0x2627);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0092
        gbc.setState(0xd14a, 0x46c9, 0x34b0, 0x3895, 0xe1e8, 0x7c10, 0x0, 0x1);
        gbc.writeMem(0xd14a, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x34);
        EXPECT(gbc.b(),  0x38);
        EXPECT(gbc.c(),  0x95);
        EXPECT(gbc.d(),  0xe1);
        EXPECT(gbc.e(),  0xe8);
        EXPECT(gbc.h(),  0x7c);
        EXPECT(gbc.l(),  0x10);
        EXPECT(gbc.sp(), 0x46c9);
        EXPECT(gbc.pc(), 0xd14b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd14a), 0xa4);
        // A4 0093
        gbc.setState(0x3514, 0x5dbb, 0x8a50, 0x8b87, 0x45e2, 0x6c16, 0x0, 0x0);
        gbc.writeMem(0x3514, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0x8b);
        EXPECT(gbc.c(),  0x87);
        EXPECT(gbc.d(),  0x45);
        EXPECT(gbc.e(),  0xe2);
        EXPECT(gbc.h(),  0x6c);
        EXPECT(gbc.l(),  0x16);
        EXPECT(gbc.sp(), 0x5dbb);
        EXPECT(gbc.pc(), 0x3515);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0094
        gbc.setState(0x14d9, 0x1073, 0x350, 0x3fce, 0x264e, 0x5710, 0x0, 0x1);
        gbc.writeMem(0x14d9, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3);
        EXPECT(gbc.b(),  0x3f);
        EXPECT(gbc.c(),  0xce);
        EXPECT(gbc.d(),  0x26);
        EXPECT(gbc.e(),  0x4e);
        EXPECT(gbc.h(),  0x57);
        EXPECT(gbc.l(),  0x10);
        EXPECT(gbc.sp(), 0x1073);
        EXPECT(gbc.pc(), 0x14da);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0095
        gbc.setState(0x1861, 0xa375, 0xf4f0, 0x1da4, 0xfeb2, 0xca32, 0x0, 0x1);
        gbc.writeMem(0x1861, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc0);
        EXPECT(gbc.b(),  0x1d);
        EXPECT(gbc.c(),  0xa4);
        EXPECT(gbc.d(),  0xfe);
        EXPECT(gbc.e(),  0xb2);
        EXPECT(gbc.h(),  0xca);
        EXPECT(gbc.l(),  0x32);
        EXPECT(gbc.sp(), 0xa375);
        EXPECT(gbc.pc(), 0x1862);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0096
        gbc.setState(0x3f48, 0xf950, 0x8440, 0x8a67, 0xbc43, 0x45f6, 0x1, 0x1);
        gbc.writeMem(0x3f48, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0x8a);
        EXPECT(gbc.c(),  0x67);
        EXPECT(gbc.d(),  0xbc);
        EXPECT(gbc.e(),  0x43);
        EXPECT(gbc.h(),  0x45);
        EXPECT(gbc.l(),  0xf6);
        EXPECT(gbc.sp(), 0xf950);
        EXPECT(gbc.pc(), 0x3f49);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0097
        gbc.setState(0x3567, 0x919e, 0xdeb0, 0x83f1, 0xdf1f, 0xb274, 0x0, 0x1);
        gbc.writeMem(0x3567, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x92);
        EXPECT(gbc.b(),  0x83);
        EXPECT(gbc.c(),  0xf1);
        EXPECT(gbc.d(),  0xdf);
        EXPECT(gbc.e(),  0x1f);
        EXPECT(gbc.h(),  0xb2);
        EXPECT(gbc.l(),  0x74);
        EXPECT(gbc.sp(), 0x919e);
        EXPECT(gbc.pc(), 0x3568);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0098
        gbc.setState(0x8f45, 0x8a78, 0x8a00, 0xbd5d, 0x5856, 0x9033, 0x1, 0x1);
        gbc.writeMem(0x8f45, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0xbd);
        EXPECT(gbc.c(),  0x5d);
        EXPECT(gbc.d(),  0x58);
        EXPECT(gbc.e(),  0x56);
        EXPECT(gbc.h(),  0x90);
        EXPECT(gbc.l(),  0x33);
        EXPECT(gbc.sp(), 0x8a78);
        EXPECT(gbc.pc(), 0x8f46);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8f45), 0xa4);
        // A4 0099
        gbc.setState(0xb48d, 0x1b44, 0xd280, 0x8994, 0x47d6, 0x1148, 0x0, 0x0);
        gbc.writeMem(0xb48d, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0x89);
        EXPECT(gbc.c(),  0x94);
        EXPECT(gbc.d(),  0x47);
        EXPECT(gbc.e(),  0xd6);
        EXPECT(gbc.h(),  0x11);
        EXPECT(gbc.l(),  0x48);
        EXPECT(gbc.sp(), 0x1b44);
        EXPECT(gbc.pc(), 0xb48e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb48d), 0xa4);
        // A4 009A
        gbc.setState(0xc0f, 0x9026, 0x5690, 0x3096, 0x64f, 0x7c25, 0x0, 0x1);
        gbc.writeMem(0xc0f, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x54);
        EXPECT(gbc.b(),  0x30);
        EXPECT(gbc.c(),  0x96);
        EXPECT(gbc.d(),  0x6);
        EXPECT(gbc.e(),  0x4f);
        EXPECT(gbc.h(),  0x7c);
        EXPECT(gbc.l(),  0x25);
        EXPECT(gbc.sp(), 0x9026);
        EXPECT(gbc.pc(), 0xc10);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 009B
        gbc.setState(0x8544, 0x269c, 0xeea0, 0x7df8, 0xb82b, 0xa16f, 0x1, 0x1);
        gbc.writeMem(0x8544, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa0);
        EXPECT(gbc.b(),  0x7d);
        EXPECT(gbc.c(),  0xf8);
        EXPECT(gbc.d(),  0xb8);
        EXPECT(gbc.e(),  0x2b);
        EXPECT(gbc.h(),  0xa1);
        EXPECT(gbc.l(),  0x6f);
        EXPECT(gbc.sp(), 0x269c);
        EXPECT(gbc.pc(), 0x8545);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8544), 0xa4);
        // A4 009C
        gbc.setState(0xe657, 0xa0a4, 0xbc00, 0x8bda, 0x657, 0x7d81, 0x0, 0x0);
        gbc.writeMem(0xe657, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3c);
        EXPECT(gbc.b(),  0x8b);
        EXPECT(gbc.c(),  0xda);
        EXPECT(gbc.d(),  0x6);
        EXPECT(gbc.e(),  0x57);
        EXPECT(gbc.h(),  0x7d);
        EXPECT(gbc.l(),  0x81);
        EXPECT(gbc.sp(), 0xa0a4);
        EXPECT(gbc.pc(), 0xe658);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe657), 0xa4);
        // A4 009D
        gbc.setState(0x68aa, 0xca14, 0xf1e0, 0xcb61, 0x4ab1, 0xddfd, 0x0, 0x1);
        gbc.writeMem(0x68aa, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd1);
        EXPECT(gbc.b(),  0xcb);
        EXPECT(gbc.c(),  0x61);
        EXPECT(gbc.d(),  0x4a);
        EXPECT(gbc.e(),  0xb1);
        EXPECT(gbc.h(),  0xdd);
        EXPECT(gbc.l(),  0xfd);
        EXPECT(gbc.sp(), 0xca14);
        EXPECT(gbc.pc(), 0x68ab);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 009F
        gbc.setState(0xa04a, 0xd45e, 0xd540, 0xc98, 0x2acf, 0x1f6c, 0x0, 0x0);
        gbc.writeMem(0xa04a, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x15);
        EXPECT(gbc.b(),  0xc);
        EXPECT(gbc.c(),  0x98);
        EXPECT(gbc.d(),  0x2a);
        EXPECT(gbc.e(),  0xcf);
        EXPECT(gbc.h(),  0x1f);
        EXPECT(gbc.l(),  0x6c);
        EXPECT(gbc.sp(), 0xd45e);
        EXPECT(gbc.pc(), 0xa04b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa04a), 0xa4);
        // A4 00A0
        gbc.setState(0xacfb, 0xa925, 0x96d0, 0x7268, 0xbe3e, 0xe233, 0x0, 0x1);
        gbc.writeMem(0xacfb, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x82);
        EXPECT(gbc.b(),  0x72);
        EXPECT(gbc.c(),  0x68);
        EXPECT(gbc.d(),  0xbe);
        EXPECT(gbc.e(),  0x3e);
        EXPECT(gbc.h(),  0xe2);
        EXPECT(gbc.l(),  0x33);
        EXPECT(gbc.sp(), 0xa925);
        EXPECT(gbc.pc(), 0xacfc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xacfb), 0xa4);
        // A4 00A1
        gbc.setState(0x57f9, 0x6a89, 0x92a0, 0x6872, 0xb87a, 0x7c36, 0x1, 0x1);
        gbc.writeMem(0x57f9, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0x68);
        EXPECT(gbc.c(),  0x72);
        EXPECT(gbc.d(),  0xb8);
        EXPECT(gbc.e(),  0x7a);
        EXPECT(gbc.h(),  0x7c);
        EXPECT(gbc.l(),  0x36);
        EXPECT(gbc.sp(), 0x6a89);
        EXPECT(gbc.pc(), 0x57fa);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00A2
        gbc.setState(0x1e53, 0x3498, 0x2fb0, 0x1be8, 0x6fe8, 0xa43a, 0x1, 0x1);
        gbc.writeMem(0x1e53, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x24);
        EXPECT(gbc.b(),  0x1b);
        EXPECT(gbc.c(),  0xe8);
        EXPECT(gbc.d(),  0x6f);
        EXPECT(gbc.e(),  0xe8);
        EXPECT(gbc.h(),  0xa4);
        EXPECT(gbc.l(),  0x3a);
        EXPECT(gbc.sp(), 0x3498);
        EXPECT(gbc.pc(), 0x1e54);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00A3
        gbc.setState(0x5cf0, 0x9b71, 0xa2e0, 0xafbc, 0xed66, 0x85d, 0x1, 0x0);
        gbc.writeMem(0x5cf0, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0xaf);
        EXPECT(gbc.c(),  0xbc);
        EXPECT(gbc.d(),  0xed);
        EXPECT(gbc.e(),  0x66);
        EXPECT(gbc.h(),  0x8);
        EXPECT(gbc.l(),  0x5d);
        EXPECT(gbc.sp(), 0x9b71);
        EXPECT(gbc.pc(), 0x5cf1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00A4
        gbc.setState(0xe98b, 0x6637, 0xb2f0, 0xc3d3, 0xb424, 0x2d29, 0x0, 0x1);
        gbc.writeMem(0xe98b, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0xc3);
        EXPECT(gbc.c(),  0xd3);
        EXPECT(gbc.d(),  0xb4);
        EXPECT(gbc.e(),  0x24);
        EXPECT(gbc.h(),  0x2d);
        EXPECT(gbc.l(),  0x29);
        EXPECT(gbc.sp(), 0x6637);
        EXPECT(gbc.pc(), 0xe98c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe98b), 0xa4);
        // A4 00A5
        gbc.setState(0x57d, 0x9dac, 0x3f30, 0x575b, 0xb08d, 0x35b7, 0x1, 0x0);
        gbc.writeMem(0x57d, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x35);
        EXPECT(gbc.b(),  0x57);
        EXPECT(gbc.c(),  0x5b);
        EXPECT(gbc.d(),  0xb0);
        EXPECT(gbc.e(),  0x8d);
        EXPECT(gbc.h(),  0x35);
        EXPECT(gbc.l(),  0xb7);
        EXPECT(gbc.sp(), 0x9dac);
        EXPECT(gbc.pc(), 0x57e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00A6
        gbc.setState(0xaf00, 0xb651, 0xaca0, 0x5d17, 0xd8f, 0xcbd, 0x1, 0x1);
        gbc.writeMem(0xaf00, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc);
        EXPECT(gbc.b(),  0x5d);
        EXPECT(gbc.c(),  0x17);
        EXPECT(gbc.d(),  0xd);
        EXPECT(gbc.e(),  0x8f);
        EXPECT(gbc.h(),  0xc);
        EXPECT(gbc.l(),  0xbd);
        EXPECT(gbc.sp(), 0xb651);
        EXPECT(gbc.pc(), 0xaf01);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xaf00), 0xa4);
        // A4 00A7
        gbc.setState(0xca72, 0xbbd4, 0xee00, 0xe55f, 0xbb53, 0x2e58, 0x0, 0x1);
        gbc.writeMem(0xca72, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2e);
        EXPECT(gbc.b(),  0xe5);
        EXPECT(gbc.c(),  0x5f);
        EXPECT(gbc.d(),  0xbb);
        EXPECT(gbc.e(),  0x53);
        EXPECT(gbc.h(),  0x2e);
        EXPECT(gbc.l(),  0x58);
        EXPECT(gbc.sp(), 0xbbd4);
        EXPECT(gbc.pc(), 0xca73);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xca72), 0xa4);
        // A4 00A8
        gbc.setState(0x49ab, 0x2002, 0xa0f0, 0x2f31, 0x768f, 0x1778, 0x0, 0x1);
        gbc.writeMem(0x49ab, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x2f);
        EXPECT(gbc.c(),  0x31);
        EXPECT(gbc.d(),  0x76);
        EXPECT(gbc.e(),  0x8f);
        EXPECT(gbc.h(),  0x17);
        EXPECT(gbc.l(),  0x78);
        EXPECT(gbc.sp(), 0x2002);
        EXPECT(gbc.pc(), 0x49ac);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00A9
        gbc.setState(0x4302, 0x651e, 0x2e0, 0xcfe4, 0xdb45, 0x62e8, 0x1, 0x0);
        gbc.writeMem(0x4302, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0xcf);
        EXPECT(gbc.c(),  0xe4);
        EXPECT(gbc.d(),  0xdb);
        EXPECT(gbc.e(),  0x45);
        EXPECT(gbc.h(),  0x62);
        EXPECT(gbc.l(),  0xe8);
        EXPECT(gbc.sp(), 0x651e);
        EXPECT(gbc.pc(), 0x4303);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00AA
        gbc.setState(0x913c, 0x3260, 0x670, 0x3869, 0x5a1f, 0xf076, 0x1, 0x0);
        gbc.writeMem(0x913c, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x38);
        EXPECT(gbc.c(),  0x69);
        EXPECT(gbc.d(),  0x5a);
        EXPECT(gbc.e(),  0x1f);
        EXPECT(gbc.h(),  0xf0);
        EXPECT(gbc.l(),  0x76);
        EXPECT(gbc.sp(), 0x3260);
        EXPECT(gbc.pc(), 0x913d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x913c), 0xa4);
        // A4 00AB
        gbc.setState(0x2657, 0xa6ae, 0x8620, 0x9fbc, 0xbc2c, 0x9cfa, 0x1, 0x1);
        gbc.writeMem(0x2657, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x84);
        EXPECT(gbc.b(),  0x9f);
        EXPECT(gbc.c(),  0xbc);
        EXPECT(gbc.d(),  0xbc);
        EXPECT(gbc.e(),  0x2c);
        EXPECT(gbc.h(),  0x9c);
        EXPECT(gbc.l(),  0xfa);
        EXPECT(gbc.sp(), 0xa6ae);
        EXPECT(gbc.pc(), 0x2658);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00AC
        gbc.setState(0xd42f, 0xdd02, 0x9ce0, 0x9594, 0x7b68, 0x9fa0, 0x0, 0x1);
        gbc.writeMem(0xd42f, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x9c);
        EXPECT(gbc.b(),  0x95);
        EXPECT(gbc.c(),  0x94);
        EXPECT(gbc.d(),  0x7b);
        EXPECT(gbc.e(),  0x68);
        EXPECT(gbc.h(),  0x9f);
        EXPECT(gbc.l(),  0xa0);
        EXPECT(gbc.sp(), 0xdd02);
        EXPECT(gbc.pc(), 0xd430);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd42f), 0xa4);
        // A4 00AD
        gbc.setState(0x3df3, 0x7ae7, 0x7430, 0xa8c5, 0xc140, 0x9be6, 0x0, 0x1);
        gbc.writeMem(0x3df3, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0xa8);
        EXPECT(gbc.c(),  0xc5);
        EXPECT(gbc.d(),  0xc1);
        EXPECT(gbc.e(),  0x40);
        EXPECT(gbc.h(),  0x9b);
        EXPECT(gbc.l(),  0xe6);
        EXPECT(gbc.sp(), 0x7ae7);
        EXPECT(gbc.pc(), 0x3df4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00AE
        gbc.setState(0xcee6, 0x8cb3, 0x8650, 0x48f6, 0xb6a5, 0xf63c, 0x1, 0x0);
        gbc.writeMem(0xcee6, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x86);
        EXPECT(gbc.b(),  0x48);
        EXPECT(gbc.c(),  0xf6);
        EXPECT(gbc.d(),  0xb6);
        EXPECT(gbc.e(),  0xa5);
        EXPECT(gbc.h(),  0xf6);
        EXPECT(gbc.l(),  0x3c);
        EXPECT(gbc.sp(), 0x8cb3);
        EXPECT(gbc.pc(), 0xcee7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcee6), 0xa4);
        // A4 00AF
        gbc.setState(0x9f76, 0xb5b, 0xff90, 0x9005, 0x6ba7, 0x9232, 0x1, 0x1);
        gbc.writeMem(0x9f76, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x92);
        EXPECT(gbc.b(),  0x90);
        EXPECT(gbc.c(),  0x5);
        EXPECT(gbc.d(),  0x6b);
        EXPECT(gbc.e(),  0xa7);
        EXPECT(gbc.h(),  0x92);
        EXPECT(gbc.l(),  0x32);
        EXPECT(gbc.sp(), 0xb5b);
        EXPECT(gbc.pc(), 0x9f77);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9f76), 0xa4);
        // A4 00B0
        gbc.setState(0xb3c, 0x4dec, 0x7eb0, 0x5328, 0x6929, 0x3749, 0x1, 0x0);
        gbc.writeMem(0xb3c, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x36);
        EXPECT(gbc.b(),  0x53);
        EXPECT(gbc.c(),  0x28);
        EXPECT(gbc.d(),  0x69);
        EXPECT(gbc.e(),  0x29);
        EXPECT(gbc.h(),  0x37);
        EXPECT(gbc.l(),  0x49);
        EXPECT(gbc.sp(), 0x4dec);
        EXPECT(gbc.pc(), 0xb3d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00B1
        gbc.setState(0x4c86, 0x1814, 0x42a0, 0x5d32, 0xc3d7, 0xb336, 0x1, 0x0);
        gbc.writeMem(0x4c86, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0x5d);
        EXPECT(gbc.c(),  0x32);
        EXPECT(gbc.d(),  0xc3);
        EXPECT(gbc.e(),  0xd7);
        EXPECT(gbc.h(),  0xb3);
        EXPECT(gbc.l(),  0x36);
        EXPECT(gbc.sp(), 0x1814);
        EXPECT(gbc.pc(), 0x4c87);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00B2
        gbc.setState(0x630f, 0x71ab, 0x1870, 0x978b, 0x1460, 0x49df, 0x0, 0x0);
        gbc.writeMem(0x630f, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0x97);
        EXPECT(gbc.c(),  0x8b);
        EXPECT(gbc.d(),  0x14);
        EXPECT(gbc.e(),  0x60);
        EXPECT(gbc.h(),  0x49);
        EXPECT(gbc.l(),  0xdf);
        EXPECT(gbc.sp(), 0x71ab);
        EXPECT(gbc.pc(), 0x6310);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00B4
        gbc.setState(0x8c77, 0x2855, 0xb130, 0xd8b0, 0x1f35, 0xfcd7, 0x1, 0x0);
        gbc.writeMem(0x8c77, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb0);
        EXPECT(gbc.b(),  0xd8);
        EXPECT(gbc.c(),  0xb0);
        EXPECT(gbc.d(),  0x1f);
        EXPECT(gbc.e(),  0x35);
        EXPECT(gbc.h(),  0xfc);
        EXPECT(gbc.l(),  0xd7);
        EXPECT(gbc.sp(), 0x2855);
        EXPECT(gbc.pc(), 0x8c78);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8c77), 0xa4);
        // A4 00B5
        gbc.setState(0x8f0a, 0xf0e2, 0xb5e0, 0x2e30, 0x2b8b, 0xdef0, 0x0, 0x0);
        gbc.writeMem(0x8f0a, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x94);
        EXPECT(gbc.b(),  0x2e);
        EXPECT(gbc.c(),  0x30);
        EXPECT(gbc.d(),  0x2b);
        EXPECT(gbc.e(),  0x8b);
        EXPECT(gbc.h(),  0xde);
        EXPECT(gbc.l(),  0xf0);
        EXPECT(gbc.sp(), 0xf0e2);
        EXPECT(gbc.pc(), 0x8f0b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8f0a), 0xa4);
        // A4 00B6
        gbc.setState(0x89a5, 0x7ab5, 0xfda0, 0x27d0, 0x7015, 0x11f8, 0x0, 0x1);
        gbc.writeMem(0x89a5, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x11);
        EXPECT(gbc.b(),  0x27);
        EXPECT(gbc.c(),  0xd0);
        EXPECT(gbc.d(),  0x70);
        EXPECT(gbc.e(),  0x15);
        EXPECT(gbc.h(),  0x11);
        EXPECT(gbc.l(),  0xf8);
        EXPECT(gbc.sp(), 0x7ab5);
        EXPECT(gbc.pc(), 0x89a6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x89a5), 0xa4);
        // A4 00B7
        gbc.setState(0x9a13, 0x8c76, 0x9da0, 0x543b, 0xfb2c, 0xc8da, 0x0, 0x0);
        gbc.writeMem(0x9a13, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x88);
        EXPECT(gbc.b(),  0x54);
        EXPECT(gbc.c(),  0x3b);
        EXPECT(gbc.d(),  0xfb);
        EXPECT(gbc.e(),  0x2c);
        EXPECT(gbc.h(),  0xc8);
        EXPECT(gbc.l(),  0xda);
        EXPECT(gbc.sp(), 0x8c76);
        EXPECT(gbc.pc(), 0x9a14);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9a13), 0xa4);
        // A4 00B8
        gbc.setState(0x5304, 0xdfa, 0xb460, 0xe3c1, 0x8851, 0xb2ca, 0x0, 0x0);
        gbc.writeMem(0x5304, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb0);
        EXPECT(gbc.b(),  0xe3);
        EXPECT(gbc.c(),  0xc1);
        EXPECT(gbc.d(),  0x88);
        EXPECT(gbc.e(),  0x51);
        EXPECT(gbc.h(),  0xb2);
        EXPECT(gbc.l(),  0xca);
        EXPECT(gbc.sp(), 0xdfa);
        EXPECT(gbc.pc(), 0x5305);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00B9
        gbc.setState(0xb56c, 0x610d, 0x11f0, 0xe7cf, 0xa0c2, 0x6727, 0x0, 0x1);
        gbc.writeMem(0xb56c, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0xe7);
        EXPECT(gbc.c(),  0xcf);
        EXPECT(gbc.d(),  0xa0);
        EXPECT(gbc.e(),  0xc2);
        EXPECT(gbc.h(),  0x67);
        EXPECT(gbc.l(),  0x27);
        EXPECT(gbc.sp(), 0x610d);
        EXPECT(gbc.pc(), 0xb56d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb56c), 0xa4);
        // A4 00BA
        gbc.setState(0x31cb, 0xaa6e, 0xd2b0, 0xdbfc, 0x1849, 0x9738, 0x1, 0x0);
        gbc.writeMem(0x31cb, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x92);
        EXPECT(gbc.b(),  0xdb);
        EXPECT(gbc.c(),  0xfc);
        EXPECT(gbc.d(),  0x18);
        EXPECT(gbc.e(),  0x49);
        EXPECT(gbc.h(),  0x97);
        EXPECT(gbc.l(),  0x38);
        EXPECT(gbc.sp(), 0xaa6e);
        EXPECT(gbc.pc(), 0x31cc);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00BC
        gbc.setState(0xd327, 0x2c19, 0x3400, 0xf4fd, 0x6aaa, 0xca22, 0x0, 0x0);
        gbc.writeMem(0xd327, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0xf4);
        EXPECT(gbc.c(),  0xfd);
        EXPECT(gbc.d(),  0x6a);
        EXPECT(gbc.e(),  0xaa);
        EXPECT(gbc.h(),  0xca);
        EXPECT(gbc.l(),  0x22);
        EXPECT(gbc.sp(), 0x2c19);
        EXPECT(gbc.pc(), 0xd328);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd327), 0xa4);
        // A4 00BE
        gbc.setState(0xc6dd, 0xad89, 0x6f90, 0xe760, 0xbff0, 0x158b, 0x0, 0x0);
        gbc.writeMem(0xc6dd, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x5);
        EXPECT(gbc.b(),  0xe7);
        EXPECT(gbc.c(),  0x60);
        EXPECT(gbc.d(),  0xbf);
        EXPECT(gbc.e(),  0xf0);
        EXPECT(gbc.h(),  0x15);
        EXPECT(gbc.l(),  0x8b);
        EXPECT(gbc.sp(), 0xad89);
        EXPECT(gbc.pc(), 0xc6de);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc6dd), 0xa4);
        // A4 00BF
        gbc.setState(0x4510, 0xe6f4, 0x3770, 0xa42e, 0x5c99, 0xf94e, 0x0, 0x0);
        gbc.writeMem(0x4510, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x31);
        EXPECT(gbc.b(),  0xa4);
        EXPECT(gbc.c(),  0x2e);
        EXPECT(gbc.d(),  0x5c);
        EXPECT(gbc.e(),  0x99);
        EXPECT(gbc.h(),  0xf9);
        EXPECT(gbc.l(),  0x4e);
        EXPECT(gbc.sp(), 0xe6f4);
        EXPECT(gbc.pc(), 0x4511);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00C0
        gbc.setState(0x865c, 0xed8e, 0x9920, 0x27aa, 0xb5bb, 0x2f1a, 0x0, 0x0);
        gbc.writeMem(0x865c, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x9);
        EXPECT(gbc.b(),  0x27);
        EXPECT(gbc.c(),  0xaa);
        EXPECT(gbc.d(),  0xb5);
        EXPECT(gbc.e(),  0xbb);
        EXPECT(gbc.h(),  0x2f);
        EXPECT(gbc.l(),  0x1a);
        EXPECT(gbc.sp(), 0xed8e);
        EXPECT(gbc.pc(), 0x865d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x865c), 0xa4);
        // A4 00C1
        gbc.setState(0x798d, 0xeaf, 0xb390, 0xf00, 0x7ff4, 0x7c24, 0x0, 0x0);
        gbc.writeMem(0x798d, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x30);
        EXPECT(gbc.b(),  0xf);
        EXPECT(gbc.c(),  0x0);
        EXPECT(gbc.d(),  0x7f);
        EXPECT(gbc.e(),  0xf4);
        EXPECT(gbc.h(),  0x7c);
        EXPECT(gbc.l(),  0x24);
        EXPECT(gbc.sp(), 0xeaf);
        EXPECT(gbc.pc(), 0x798e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00C2
        gbc.setState(0x4968, 0x2086, 0x4290, 0x3eb7, 0x656d, 0x2d24, 0x0, 0x1);
        gbc.writeMem(0x4968, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x3e);
        EXPECT(gbc.c(),  0xb7);
        EXPECT(gbc.d(),  0x65);
        EXPECT(gbc.e(),  0x6d);
        EXPECT(gbc.h(),  0x2d);
        EXPECT(gbc.l(),  0x24);
        EXPECT(gbc.sp(), 0x2086);
        EXPECT(gbc.pc(), 0x4969);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00C3
        gbc.setState(0xa98e, 0xdcb1, 0x3610, 0xd52d, 0x915e, 0x7b9f, 0x0, 0x1);
        gbc.writeMem(0xa98e, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x32);
        EXPECT(gbc.b(),  0xd5);
        EXPECT(gbc.c(),  0x2d);
        EXPECT(gbc.d(),  0x91);
        EXPECT(gbc.e(),  0x5e);
        EXPECT(gbc.h(),  0x7b);
        EXPECT(gbc.l(),  0x9f);
        EXPECT(gbc.sp(), 0xdcb1);
        EXPECT(gbc.pc(), 0xa98f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa98e), 0xa4);
        // A4 00C5
        gbc.setState(0xaae5, 0x7bb7, 0xde10, 0xc4b4, 0x27aa, 0x4330, 0x1, 0x1);
        gbc.writeMem(0xaae5, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x42);
        EXPECT(gbc.b(),  0xc4);
        EXPECT(gbc.c(),  0xb4);
        EXPECT(gbc.d(),  0x27);
        EXPECT(gbc.e(),  0xaa);
        EXPECT(gbc.h(),  0x43);
        EXPECT(gbc.l(),  0x30);
        EXPECT(gbc.sp(), 0x7bb7);
        EXPECT(gbc.pc(), 0xaae6);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xaae5), 0xa4);
        // A4 00C6
        gbc.setState(0x3d75, 0x77ee, 0xc000, 0xe263, 0x6a67, 0x9b9f, 0x0, 0x1);
        gbc.writeMem(0x3d75, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0xe2);
        EXPECT(gbc.c(),  0x63);
        EXPECT(gbc.d(),  0x6a);
        EXPECT(gbc.e(),  0x67);
        EXPECT(gbc.h(),  0x9b);
        EXPECT(gbc.l(),  0x9f);
        EXPECT(gbc.sp(), 0x77ee);
        EXPECT(gbc.pc(), 0x3d76);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00C7
        gbc.setState(0x1291, 0x51e4, 0x50b0, 0x873a, 0x663d, 0x39bc, 0x0, 0x1);
        gbc.writeMem(0x1291, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0x87);
        EXPECT(gbc.c(),  0x3a);
        EXPECT(gbc.d(),  0x66);
        EXPECT(gbc.e(),  0x3d);
        EXPECT(gbc.h(),  0x39);
        EXPECT(gbc.l(),  0xbc);
        EXPECT(gbc.sp(), 0x51e4);
        EXPECT(gbc.pc(), 0x1292);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00C8
        gbc.setState(0x964, 0xc3d1, 0x96a0, 0xe0dc, 0xeb43, 0xddb9, 0x1, 0x1);
        gbc.writeMem(0x964, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x94);
        EXPECT(gbc.b(),  0xe0);
        EXPECT(gbc.c(),  0xdc);
        EXPECT(gbc.d(),  0xeb);
        EXPECT(gbc.e(),  0x43);
        EXPECT(gbc.h(),  0xdd);
        EXPECT(gbc.l(),  0xb9);
        EXPECT(gbc.sp(), 0xc3d1);
        EXPECT(gbc.pc(), 0x965);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00C9
        gbc.setState(0x7b14, 0xbee9, 0x9b10, 0x29ac, 0xa194, 0x36b1, 0x0, 0x0);
        gbc.writeMem(0x7b14, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x12);
        EXPECT(gbc.b(),  0x29);
        EXPECT(gbc.c(),  0xac);
        EXPECT(gbc.d(),  0xa1);
        EXPECT(gbc.e(),  0x94);
        EXPECT(gbc.h(),  0x36);
        EXPECT(gbc.l(),  0xb1);
        EXPECT(gbc.sp(), 0xbee9);
        EXPECT(gbc.pc(), 0x7b15);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00CA
        gbc.setState(0xdfc7, 0x1d50, 0xe360, 0xd6df, 0x3e9e, 0x4b67, 0x1, 0x1);
        gbc.writeMem(0xdfc7, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x43);
        EXPECT(gbc.b(),  0xd6);
        EXPECT(gbc.c(),  0xdf);
        EXPECT(gbc.d(),  0x3e);
        EXPECT(gbc.e(),  0x9e);
        EXPECT(gbc.h(),  0x4b);
        EXPECT(gbc.l(),  0x67);
        EXPECT(gbc.sp(), 0x1d50);
        EXPECT(gbc.pc(), 0xdfc8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdfc7), 0xa4);
        // A4 00CB
        gbc.setState(0x740a, 0x8cde, 0xfd0, 0x4810, 0xbcfa, 0xa1a5, 0x0, 0x1);
        gbc.writeMem(0x740a, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0x48);
        EXPECT(gbc.c(),  0x10);
        EXPECT(gbc.d(),  0xbc);
        EXPECT(gbc.e(),  0xfa);
        EXPECT(gbc.h(),  0xa1);
        EXPECT(gbc.l(),  0xa5);
        EXPECT(gbc.sp(), 0x8cde);
        EXPECT(gbc.pc(), 0x740b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00CC
        gbc.setState(0xd40e, 0xbe75, 0xafd0, 0x8792, 0x825e, 0xdc09, 0x1, 0x0);
        gbc.writeMem(0xd40e, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8c);
        EXPECT(gbc.b(),  0x87);
        EXPECT(gbc.c(),  0x92);
        EXPECT(gbc.d(),  0x82);
        EXPECT(gbc.e(),  0x5e);
        EXPECT(gbc.h(),  0xdc);
        EXPECT(gbc.l(),  0x9);
        EXPECT(gbc.sp(), 0xbe75);
        EXPECT(gbc.pc(), 0xd40f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd40e), 0xa4);
        // A4 00CD
        gbc.setState(0x1b7b, 0xd8a2, 0xe380, 0xd1f5, 0xf158, 0x4700, 0x1, 0x0);
        gbc.writeMem(0x1b7b, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x43);
        EXPECT(gbc.b(),  0xd1);
        EXPECT(gbc.c(),  0xf5);
        EXPECT(gbc.d(),  0xf1);
        EXPECT(gbc.e(),  0x58);
        EXPECT(gbc.h(),  0x47);
        EXPECT(gbc.l(),  0x0);
        EXPECT(gbc.sp(), 0xd8a2);
        EXPECT(gbc.pc(), 0x1b7c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00CE
        gbc.setState(0xe5a8, 0xea8d, 0x9130, 0xb5ca, 0x83df, 0x3c95, 0x0, 0x0);
        gbc.writeMem(0xe5a8, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0xb5);
        EXPECT(gbc.c(),  0xca);
        EXPECT(gbc.d(),  0x83);
        EXPECT(gbc.e(),  0xdf);
        EXPECT(gbc.h(),  0x3c);
        EXPECT(gbc.l(),  0x95);
        EXPECT(gbc.sp(), 0xea8d);
        EXPECT(gbc.pc(), 0xe5a9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe5a8), 0xa4);
        // A4 00CF
        gbc.setState(0x590d, 0x572, 0xf520, 0x9727, 0xd382, 0xc00d, 0x1, 0x1);
        gbc.writeMem(0x590d, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc0);
        EXPECT(gbc.b(),  0x97);
        EXPECT(gbc.c(),  0x27);
        EXPECT(gbc.d(),  0xd3);
        EXPECT(gbc.e(),  0x82);
        EXPECT(gbc.h(),  0xc0);
        EXPECT(gbc.l(),  0xd);
        EXPECT(gbc.sp(), 0x572);
        EXPECT(gbc.pc(), 0x590e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00D0
        gbc.setState(0x6f33, 0x7127, 0xf1a0, 0x27ad, 0xd8e, 0x85bc, 0x1, 0x0);
        gbc.writeMem(0x6f33, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x81);
        EXPECT(gbc.b(),  0x27);
        EXPECT(gbc.c(),  0xad);
        EXPECT(gbc.d(),  0xd);
        EXPECT(gbc.e(),  0x8e);
        EXPECT(gbc.h(),  0x85);
        EXPECT(gbc.l(),  0xbc);
        EXPECT(gbc.sp(), 0x7127);
        EXPECT(gbc.pc(), 0x6f34);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00D1
        gbc.setState(0x90ed, 0x6b6a, 0x8000, 0x2d0f, 0x1987, 0xefcf, 0x1, 0x0);
        gbc.writeMem(0x90ed, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0x2d);
        EXPECT(gbc.c(),  0xf);
        EXPECT(gbc.d(),  0x19);
        EXPECT(gbc.e(),  0x87);
        EXPECT(gbc.h(),  0xef);
        EXPECT(gbc.l(),  0xcf);
        EXPECT(gbc.sp(), 0x6b6a);
        EXPECT(gbc.pc(), 0x90ee);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x90ed), 0xa4);
        // A4 00D2
        gbc.setState(0x7311, 0x8a81, 0xe340, 0x9062, 0x5c15, 0xfaa9, 0x0, 0x1);
        gbc.writeMem(0x7311, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe2);
        EXPECT(gbc.b(),  0x90);
        EXPECT(gbc.c(),  0x62);
        EXPECT(gbc.d(),  0x5c);
        EXPECT(gbc.e(),  0x15);
        EXPECT(gbc.h(),  0xfa);
        EXPECT(gbc.l(),  0xa9);
        EXPECT(gbc.sp(), 0x8a81);
        EXPECT(gbc.pc(), 0x7312);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00D3
        gbc.setState(0xc915, 0x3a77, 0x15a0, 0x3461, 0x545c, 0x8996, 0x1, 0x1);
        gbc.writeMem(0xc915, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0x34);
        EXPECT(gbc.c(),  0x61);
        EXPECT(gbc.d(),  0x54);
        EXPECT(gbc.e(),  0x5c);
        EXPECT(gbc.h(),  0x89);
        EXPECT(gbc.l(),  0x96);
        EXPECT(gbc.sp(), 0x3a77);
        EXPECT(gbc.pc(), 0xc916);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc915), 0xa4);
        // A4 00D4
        gbc.setState(0x9165, 0x151c, 0xda80, 0x86f5, 0x5085, 0x4974, 0x0, 0x0);
        gbc.writeMem(0x9165, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x48);
        EXPECT(gbc.b(),  0x86);
        EXPECT(gbc.c(),  0xf5);
        EXPECT(gbc.d(),  0x50);
        EXPECT(gbc.e(),  0x85);
        EXPECT(gbc.h(),  0x49);
        EXPECT(gbc.l(),  0x74);
        EXPECT(gbc.sp(), 0x151c);
        EXPECT(gbc.pc(), 0x9166);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9165), 0xa4);
        // A4 00D5
        gbc.setState(0x8b32, 0x76c2, 0x7bf0, 0xe4e, 0x14a1, 0x3cda, 0x1, 0x0);
        gbc.writeMem(0x8b32, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x38);
        EXPECT(gbc.b(),  0xe);
        EXPECT(gbc.c(),  0x4e);
        EXPECT(gbc.d(),  0x14);
        EXPECT(gbc.e(),  0xa1);
        EXPECT(gbc.h(),  0x3c);
        EXPECT(gbc.l(),  0xda);
        EXPECT(gbc.sp(), 0x76c2);
        EXPECT(gbc.pc(), 0x8b33);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8b32), 0xa4);
        // A4 00D6
        gbc.setState(0xca3, 0x6ee3, 0x2260, 0x83bd, 0x2dc4, 0x78da, 0x1, 0x0);
        gbc.writeMem(0xca3, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0x83);
        EXPECT(gbc.c(),  0xbd);
        EXPECT(gbc.d(),  0x2d);
        EXPECT(gbc.e(),  0xc4);
        EXPECT(gbc.h(),  0x78);
        EXPECT(gbc.l(),  0xda);
        EXPECT(gbc.sp(), 0x6ee3);
        EXPECT(gbc.pc(), 0xca4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00D7
        gbc.setState(0x9e57, 0xf41, 0x9760, 0x70ab, 0x4d46, 0xb063, 0x0, 0x0);
        gbc.writeMem(0x9e57, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x90);
        EXPECT(gbc.b(),  0x70);
        EXPECT(gbc.c(),  0xab);
        EXPECT(gbc.d(),  0x4d);
        EXPECT(gbc.e(),  0x46);
        EXPECT(gbc.h(),  0xb0);
        EXPECT(gbc.l(),  0x63);
        EXPECT(gbc.sp(), 0xf41);
        EXPECT(gbc.pc(), 0x9e58);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9e57), 0xa4);
        // A4 00D8
        gbc.setState(0x942c, 0xf181, 0x5550, 0xa82e, 0x1c5b, 0xa5a6, 0x0, 0x0);
        gbc.writeMem(0x942c, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x5);
        EXPECT(gbc.b(),  0xa8);
        EXPECT(gbc.c(),  0x2e);
        EXPECT(gbc.d(),  0x1c);
        EXPECT(gbc.e(),  0x5b);
        EXPECT(gbc.h(),  0xa5);
        EXPECT(gbc.l(),  0xa6);
        EXPECT(gbc.sp(), 0xf181);
        EXPECT(gbc.pc(), 0x942d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x942c), 0xa4);
        // A4 00D9
        gbc.setState(0xcfbe, 0x5e1f, 0xf490, 0x9f56, 0x4fd9, 0xe7a6, 0x0, 0x0);
        gbc.writeMem(0xcfbe, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe4);
        EXPECT(gbc.b(),  0x9f);
        EXPECT(gbc.c(),  0x56);
        EXPECT(gbc.d(),  0x4f);
        EXPECT(gbc.e(),  0xd9);
        EXPECT(gbc.h(),  0xe7);
        EXPECT(gbc.l(),  0xa6);
        EXPECT(gbc.sp(), 0x5e1f);
        EXPECT(gbc.pc(), 0xcfbf);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcfbe), 0xa4);
        // A4 00DA
        gbc.setState(0x2ba7, 0x16d1, 0x8ba0, 0x10ae, 0x2f48, 0xf72a, 0x1, 0x1);
        gbc.writeMem(0x2ba7, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x83);
        EXPECT(gbc.b(),  0x10);
        EXPECT(gbc.c(),  0xae);
        EXPECT(gbc.d(),  0x2f);
        EXPECT(gbc.e(),  0x48);
        EXPECT(gbc.h(),  0xf7);
        EXPECT(gbc.l(),  0x2a);
        EXPECT(gbc.sp(), 0x16d1);
        EXPECT(gbc.pc(), 0x2ba8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00DB
        gbc.setState(0x1614, 0x1074, 0x3fc0, 0xbca9, 0xb72e, 0x126, 0x0, 0x1);
        gbc.writeMem(0x1614, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0xbc);
        EXPECT(gbc.c(),  0xa9);
        EXPECT(gbc.d(),  0xb7);
        EXPECT(gbc.e(),  0x2e);
        EXPECT(gbc.h(),  0x1);
        EXPECT(gbc.l(),  0x26);
        EXPECT(gbc.sp(), 0x1074);
        EXPECT(gbc.pc(), 0x1615);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00DC
        gbc.setState(0xa294, 0x8585, 0x46c0, 0xb9b9, 0xc7b6, 0x33dd, 0x1, 0x1);
        gbc.writeMem(0xa294, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0xb9);
        EXPECT(gbc.c(),  0xb9);
        EXPECT(gbc.d(),  0xc7);
        EXPECT(gbc.e(),  0xb6);
        EXPECT(gbc.h(),  0x33);
        EXPECT(gbc.l(),  0xdd);
        EXPECT(gbc.sp(), 0x8585);
        EXPECT(gbc.pc(), 0xa295);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa294), 0xa4);
        // A4 00DD
        gbc.setState(0x7b98, 0x9895, 0x1100, 0x76a, 0x69e3, 0x83cd, 0x1, 0x1);
        gbc.writeMem(0x7b98, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0x7);
        EXPECT(gbc.c(),  0x6a);
        EXPECT(gbc.d(),  0x69);
        EXPECT(gbc.e(),  0xe3);
        EXPECT(gbc.h(),  0x83);
        EXPECT(gbc.l(),  0xcd);
        EXPECT(gbc.sp(), 0x9895);
        EXPECT(gbc.pc(), 0x7b99);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00DE
        gbc.setState(0x24d6, 0xffd6, 0xe550, 0x34c7, 0x5ee0, 0x4970, 0x0, 0x1);
        gbc.writeMem(0x24d6, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x41);
        EXPECT(gbc.b(),  0x34);
        EXPECT(gbc.c(),  0xc7);
        EXPECT(gbc.d(),  0x5e);
        EXPECT(gbc.e(),  0xe0);
        EXPECT(gbc.h(),  0x49);
        EXPECT(gbc.l(),  0x70);
        EXPECT(gbc.sp(), 0xffd6);
        EXPECT(gbc.pc(), 0x24d7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00DF
        gbc.setState(0xdeda, 0x9548, 0x9710, 0xc01e, 0x87d8, 0x757f, 0x0, 0x0);
        gbc.writeMem(0xdeda, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x15);
        EXPECT(gbc.b(),  0xc0);
        EXPECT(gbc.c(),  0x1e);
        EXPECT(gbc.d(),  0x87);
        EXPECT(gbc.e(),  0xd8);
        EXPECT(gbc.h(),  0x75);
        EXPECT(gbc.l(),  0x7f);
        EXPECT(gbc.sp(), 0x9548);
        EXPECT(gbc.pc(), 0xdedb);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdeda), 0xa4);
        // A4 00E0
        gbc.setState(0x181, 0x25d5, 0xad70, 0x7140, 0x6079, 0x6e62, 0x1, 0x0);
        gbc.writeMem(0x181, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2c);
        EXPECT(gbc.b(),  0x71);
        EXPECT(gbc.c(),  0x40);
        EXPECT(gbc.d(),  0x60);
        EXPECT(gbc.e(),  0x79);
        EXPECT(gbc.h(),  0x6e);
        EXPECT(gbc.l(),  0x62);
        EXPECT(gbc.sp(), 0x25d5);
        EXPECT(gbc.pc(), 0x182);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00E1
        gbc.setState(0x6183, 0xeec6, 0x2750, 0x604, 0x6d49, 0x5fdc, 0x0, 0x1);
        gbc.writeMem(0x6183, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x7);
        EXPECT(gbc.b(),  0x6);
        EXPECT(gbc.c(),  0x4);
        EXPECT(gbc.d(),  0x6d);
        EXPECT(gbc.e(),  0x49);
        EXPECT(gbc.h(),  0x5f);
        EXPECT(gbc.l(),  0xdc);
        EXPECT(gbc.sp(), 0xeec6);
        EXPECT(gbc.pc(), 0x6184);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00E2
        gbc.setState(0x185d, 0xf1a2, 0x4450, 0xb339, 0x7f02, 0x8ba3, 0x1, 0x1);
        gbc.writeMem(0x185d, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0xb3);
        EXPECT(gbc.c(),  0x39);
        EXPECT(gbc.d(),  0x7f);
        EXPECT(gbc.e(),  0x2);
        EXPECT(gbc.h(),  0x8b);
        EXPECT(gbc.l(),  0xa3);
        EXPECT(gbc.sp(), 0xf1a2);
        EXPECT(gbc.pc(), 0x185e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00E3
        gbc.setState(0xce2b, 0x3439, 0xd750, 0x680f, 0xc9b, 0x2417, 0x1, 0x1);
        gbc.writeMem(0xce2b, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0x68);
        EXPECT(gbc.c(),  0xf);
        EXPECT(gbc.d(),  0xc);
        EXPECT(gbc.e(),  0x9b);
        EXPECT(gbc.h(),  0x24);
        EXPECT(gbc.l(),  0x17);
        EXPECT(gbc.sp(), 0x3439);
        EXPECT(gbc.pc(), 0xce2c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xce2b), 0xa4);
        // A4 00E4
        gbc.setState(0xab3d, 0x8fc1, 0xa970, 0x13e2, 0xc55e, 0xaf7a, 0x0, 0x0);
        gbc.writeMem(0xab3d, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa9);
        EXPECT(gbc.b(),  0x13);
        EXPECT(gbc.c(),  0xe2);
        EXPECT(gbc.d(),  0xc5);
        EXPECT(gbc.e(),  0x5e);
        EXPECT(gbc.h(),  0xaf);
        EXPECT(gbc.l(),  0x7a);
        EXPECT(gbc.sp(), 0x8fc1);
        EXPECT(gbc.pc(), 0xab3e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xab3d), 0xa4);
        // A4 00E5
        gbc.setState(0x3f9f, 0x626a, 0xbdc0, 0xa2eb, 0xa157, 0x9a7f, 0x1, 0x1);
        gbc.writeMem(0x3f9f, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x98);
        EXPECT(gbc.b(),  0xa2);
        EXPECT(gbc.c(),  0xeb);
        EXPECT(gbc.d(),  0xa1);
        EXPECT(gbc.e(),  0x57);
        EXPECT(gbc.h(),  0x9a);
        EXPECT(gbc.l(),  0x7f);
        EXPECT(gbc.sp(), 0x626a);
        EXPECT(gbc.pc(), 0x3fa0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00E6
        gbc.setState(0x5c71, 0x76f4, 0xb620, 0xea12, 0x1966, 0x8a54, 0x1, 0x1);
        gbc.writeMem(0x5c71, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x82);
        EXPECT(gbc.b(),  0xea);
        EXPECT(gbc.c(),  0x12);
        EXPECT(gbc.d(),  0x19);
        EXPECT(gbc.e(),  0x66);
        EXPECT(gbc.h(),  0x8a);
        EXPECT(gbc.l(),  0x54);
        EXPECT(gbc.sp(), 0x76f4);
        EXPECT(gbc.pc(), 0x5c72);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00E7
        gbc.setState(0x8664, 0x453a, 0xf70, 0x5b87, 0xa2e4, 0xc25c, 0x1, 0x0);
        gbc.writeMem(0x8664, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0x5b);
        EXPECT(gbc.c(),  0x87);
        EXPECT(gbc.d(),  0xa2);
        EXPECT(gbc.e(),  0xe4);
        EXPECT(gbc.h(),  0xc2);
        EXPECT(gbc.l(),  0x5c);
        EXPECT(gbc.sp(), 0x453a);
        EXPECT(gbc.pc(), 0x8665);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8664), 0xa4);
        // A4 00E8
        gbc.setState(0xbf10, 0xfdec, 0x6010, 0x2969, 0xf3ca, 0x4dcc, 0x0, 0x0);
        gbc.writeMem(0xbf10, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0x29);
        EXPECT(gbc.c(),  0x69);
        EXPECT(gbc.d(),  0xf3);
        EXPECT(gbc.e(),  0xca);
        EXPECT(gbc.h(),  0x4d);
        EXPECT(gbc.l(),  0xcc);
        EXPECT(gbc.sp(), 0xfdec);
        EXPECT(gbc.pc(), 0xbf11);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbf10), 0xa4);
        // A4 00E9
        gbc.setState(0x545e, 0xdbc8, 0xd0c0, 0xfe7e, 0x1565, 0x8147, 0x0, 0x1);
        gbc.writeMem(0x545e, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0xfe);
        EXPECT(gbc.c(),  0x7e);
        EXPECT(gbc.d(),  0x15);
        EXPECT(gbc.e(),  0x65);
        EXPECT(gbc.h(),  0x81);
        EXPECT(gbc.l(),  0x47);
        EXPECT(gbc.sp(), 0xdbc8);
        EXPECT(gbc.pc(), 0x545f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00EA
        gbc.setState(0xe94e, 0xacf3, 0x1b00, 0xbdbb, 0x1265, 0xbc98, 0x1, 0x0);
        gbc.writeMem(0xe94e, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x18);
        EXPECT(gbc.b(),  0xbd);
        EXPECT(gbc.c(),  0xbb);
        EXPECT(gbc.d(),  0x12);
        EXPECT(gbc.e(),  0x65);
        EXPECT(gbc.h(),  0xbc);
        EXPECT(gbc.l(),  0x98);
        EXPECT(gbc.sp(), 0xacf3);
        EXPECT(gbc.pc(), 0xe94f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe94e), 0xa4);
        // A4 00EB
        gbc.setState(0x442e, 0xadd8, 0xe00, 0x1a16, 0x4c7, 0x8ade, 0x1, 0x1);
        gbc.writeMem(0x442e, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa);
        EXPECT(gbc.b(),  0x1a);
        EXPECT(gbc.c(),  0x16);
        EXPECT(gbc.d(),  0x4);
        EXPECT(gbc.e(),  0xc7);
        EXPECT(gbc.h(),  0x8a);
        EXPECT(gbc.l(),  0xde);
        EXPECT(gbc.sp(), 0xadd8);
        EXPECT(gbc.pc(), 0x442f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00EC
        gbc.setState(0xd27d, 0x405f, 0x7f30, 0x31da, 0x1b2, 0x6729, 0x0, 0x1);
        gbc.writeMem(0xd27d, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x67);
        EXPECT(gbc.b(),  0x31);
        EXPECT(gbc.c(),  0xda);
        EXPECT(gbc.d(),  0x1);
        EXPECT(gbc.e(),  0xb2);
        EXPECT(gbc.h(),  0x67);
        EXPECT(gbc.l(),  0x29);
        EXPECT(gbc.sp(), 0x405f);
        EXPECT(gbc.pc(), 0xd27e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd27d), 0xa4);
        // A4 00ED
        gbc.setState(0xaee, 0x3252, 0x2900, 0x40a8, 0x6d9d, 0x5c18, 0x1, 0x1);
        gbc.writeMem(0xaee, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0x40);
        EXPECT(gbc.c(),  0xa8);
        EXPECT(gbc.d(),  0x6d);
        EXPECT(gbc.e(),  0x9d);
        EXPECT(gbc.h(),  0x5c);
        EXPECT(gbc.l(),  0x18);
        EXPECT(gbc.sp(), 0x3252);
        EXPECT(gbc.pc(), 0xaef);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00EE
        gbc.setState(0xdbc2, 0xfc51, 0x1cf0, 0xcf1e, 0xbf77, 0xc0bc, 0x0, 0x1);
        gbc.writeMem(0xdbc2, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0xcf);
        EXPECT(gbc.c(),  0x1e);
        EXPECT(gbc.d(),  0xbf);
        EXPECT(gbc.e(),  0x77);
        EXPECT(gbc.h(),  0xc0);
        EXPECT(gbc.l(),  0xbc);
        EXPECT(gbc.sp(), 0xfc51);
        EXPECT(gbc.pc(), 0xdbc3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdbc2), 0xa4);
        // A4 00EF
        gbc.setState(0x89b5, 0x55e6, 0x4f60, 0x27e5, 0x99bb, 0xe511, 0x0, 0x1);
        gbc.writeMem(0x89b5, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x45);
        EXPECT(gbc.b(),  0x27);
        EXPECT(gbc.c(),  0xe5);
        EXPECT(gbc.d(),  0x99);
        EXPECT(gbc.e(),  0xbb);
        EXPECT(gbc.h(),  0xe5);
        EXPECT(gbc.l(),  0x11);
        EXPECT(gbc.sp(), 0x55e6);
        EXPECT(gbc.pc(), 0x89b6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x89b5), 0xa4);
        // A4 00F1
        gbc.setState(0xbd05, 0x32b5, 0x48e0, 0xebd8, 0xae6a, 0x1769, 0x1, 0x1);
        gbc.writeMem(0xbd05, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0xeb);
        EXPECT(gbc.c(),  0xd8);
        EXPECT(gbc.d(),  0xae);
        EXPECT(gbc.e(),  0x6a);
        EXPECT(gbc.h(),  0x17);
        EXPECT(gbc.l(),  0x69);
        EXPECT(gbc.sp(), 0x32b5);
        EXPECT(gbc.pc(), 0xbd06);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbd05), 0xa4);
        // A4 00F2
        gbc.setState(0x6e89, 0xc43c, 0x7360, 0x9d92, 0xc8e4, 0xe9b6, 0x1, 0x1);
        gbc.writeMem(0x6e89, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x61);
        EXPECT(gbc.b(),  0x9d);
        EXPECT(gbc.c(),  0x92);
        EXPECT(gbc.d(),  0xc8);
        EXPECT(gbc.e(),  0xe4);
        EXPECT(gbc.h(),  0xe9);
        EXPECT(gbc.l(),  0xb6);
        EXPECT(gbc.sp(), 0xc43c);
        EXPECT(gbc.pc(), 0x6e8a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00F3
        gbc.setState(0x687c, 0xe2a3, 0x3a80, 0xd08f, 0xb36b, 0xdc4c, 0x1, 0x0);
        gbc.writeMem(0x687c, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x18);
        EXPECT(gbc.b(),  0xd0);
        EXPECT(gbc.c(),  0x8f);
        EXPECT(gbc.d(),  0xb3);
        EXPECT(gbc.e(),  0x6b);
        EXPECT(gbc.h(),  0xdc);
        EXPECT(gbc.l(),  0x4c);
        EXPECT(gbc.sp(), 0xe2a3);
        EXPECT(gbc.pc(), 0x687d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00F4
        gbc.setState(0xae26, 0x92fd, 0x52b0, 0xf38c, 0xa577, 0xc10d, 0x1, 0x1);
        gbc.writeMem(0xae26, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0xf3);
        EXPECT(gbc.c(),  0x8c);
        EXPECT(gbc.d(),  0xa5);
        EXPECT(gbc.e(),  0x77);
        EXPECT(gbc.h(),  0xc1);
        EXPECT(gbc.l(),  0xd);
        EXPECT(gbc.sp(), 0x92fd);
        EXPECT(gbc.pc(), 0xae27);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xae26), 0xa4);
        // A4 00F5
        gbc.setState(0xdf38, 0x815b, 0xb8d0, 0x9213, 0xa6ed, 0x59e1, 0x0, 0x0);
        gbc.writeMem(0xdf38, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x18);
        EXPECT(gbc.b(),  0x92);
        EXPECT(gbc.c(),  0x13);
        EXPECT(gbc.d(),  0xa6);
        EXPECT(gbc.e(),  0xed);
        EXPECT(gbc.h(),  0x59);
        EXPECT(gbc.l(),  0xe1);
        EXPECT(gbc.sp(), 0x815b);
        EXPECT(gbc.pc(), 0xdf39);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdf38), 0xa4);
        // A4 00F6
        gbc.setState(0x8a12, 0x80c3, 0xaf90, 0x55c, 0xf073, 0x2055, 0x0, 0x0);
        gbc.writeMem(0x8a12, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0x5);
        EXPECT(gbc.c(),  0x5c);
        EXPECT(gbc.d(),  0xf0);
        EXPECT(gbc.e(),  0x73);
        EXPECT(gbc.h(),  0x20);
        EXPECT(gbc.l(),  0x55);
        EXPECT(gbc.sp(), 0x80c3);
        EXPECT(gbc.pc(), 0x8a13);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8a12), 0xa4);
        // A4 00F7
        gbc.setState(0x57b6, 0xe40, 0x680, 0x3dcd, 0x5aee, 0xc9f0, 0x0, 0x1);
        gbc.writeMem(0x57b6, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x3d);
        EXPECT(gbc.c(),  0xcd);
        EXPECT(gbc.d(),  0x5a);
        EXPECT(gbc.e(),  0xee);
        EXPECT(gbc.h(),  0xc9);
        EXPECT(gbc.l(),  0xf0);
        EXPECT(gbc.sp(), 0xe40);
        EXPECT(gbc.pc(), 0x57b7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00F8
        gbc.setState(0x23b7, 0x6976, 0xfd00, 0x5adc, 0x8b73, 0x57e7, 0x0, 0x0);
        gbc.writeMem(0x23b7, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x55);
        EXPECT(gbc.b(),  0x5a);
        EXPECT(gbc.c(),  0xdc);
        EXPECT(gbc.d(),  0x8b);
        EXPECT(gbc.e(),  0x73);
        EXPECT(gbc.h(),  0x57);
        EXPECT(gbc.l(),  0xe7);
        EXPECT(gbc.sp(), 0x6976);
        EXPECT(gbc.pc(), 0x23b8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00F9
        gbc.setState(0xb442, 0x83c5, 0x8bc0, 0xaf04, 0xeace, 0x2219, 0x1, 0x0);
        gbc.writeMem(0xb442, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0xaf);
        EXPECT(gbc.c(),  0x4);
        EXPECT(gbc.d(),  0xea);
        EXPECT(gbc.e(),  0xce);
        EXPECT(gbc.h(),  0x22);
        EXPECT(gbc.l(),  0x19);
        EXPECT(gbc.sp(), 0x83c5);
        EXPECT(gbc.pc(), 0xb443);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb442), 0xa4);
        // A4 00FA
        gbc.setState(0x3dfa, 0xa2bc, 0x5370, 0x546c, 0x2f06, 0x540, 0x1, 0x1);
        gbc.writeMem(0x3dfa, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0x54);
        EXPECT(gbc.c(),  0x6c);
        EXPECT(gbc.d(),  0x2f);
        EXPECT(gbc.e(),  0x6);
        EXPECT(gbc.h(),  0x5);
        EXPECT(gbc.l(),  0x40);
        EXPECT(gbc.sp(), 0xa2bc);
        EXPECT(gbc.pc(), 0x3dfb);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00FB
        gbc.setState(0xc01b, 0x1a0b, 0x4fa0, 0xf2f3, 0x35d0, 0xee58, 0x0, 0x0);
        gbc.writeMem(0xc01b, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4e);
        EXPECT(gbc.b(),  0xf2);
        EXPECT(gbc.c(),  0xf3);
        EXPECT(gbc.d(),  0x35);
        EXPECT(gbc.e(),  0xd0);
        EXPECT(gbc.h(),  0xee);
        EXPECT(gbc.l(),  0x58);
        EXPECT(gbc.sp(), 0x1a0b);
        EXPECT(gbc.pc(), 0xc01c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc01b), 0xa4);
        // A4 00FC
        gbc.setState(0x1ce2, 0xb404, 0x8aa0, 0xe6ec, 0x903, 0xc882, 0x0, 0x0);
        gbc.writeMem(0x1ce2, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x88);
        EXPECT(gbc.b(),  0xe6);
        EXPECT(gbc.c(),  0xec);
        EXPECT(gbc.d(),  0x9);
        EXPECT(gbc.e(),  0x3);
        EXPECT(gbc.h(),  0xc8);
        EXPECT(gbc.l(),  0x82);
        EXPECT(gbc.sp(), 0xb404);
        EXPECT(gbc.pc(), 0x1ce3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00FD
        gbc.setState(0x1375, 0x3bbc, 0x1b0, 0xd0de, 0x2f98, 0x56f5, 0x0, 0x1);
        gbc.writeMem(0x1375, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0xd0);
        EXPECT(gbc.c(),  0xde);
        EXPECT(gbc.d(),  0x2f);
        EXPECT(gbc.e(),  0x98);
        EXPECT(gbc.h(),  0x56);
        EXPECT(gbc.l(),  0xf5);
        EXPECT(gbc.sp(), 0x3bbc);
        EXPECT(gbc.pc(), 0x1376);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 00FE
        gbc.setState(0xd67b, 0x7020, 0x2d70, 0xa8c0, 0x78c8, 0xedc2, 0x1, 0x1);
        gbc.writeMem(0xd67b, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2d);
        EXPECT(gbc.b(),  0xa8);
        EXPECT(gbc.c(),  0xc0);
        EXPECT(gbc.d(),  0x78);
        EXPECT(gbc.e(),  0xc8);
        EXPECT(gbc.h(),  0xed);
        EXPECT(gbc.l(),  0xc2);
        EXPECT(gbc.sp(), 0x7020);
        EXPECT(gbc.pc(), 0xd67c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd67b), 0xa4);
        // A4 00FF
        gbc.setState(0xb4a0, 0xe190, 0x2650, 0xd334, 0xe864, 0x2289, 0x0, 0x0);
        gbc.writeMem(0xb4a0, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x22);
        EXPECT(gbc.b(),  0xd3);
        EXPECT(gbc.c(),  0x34);
        EXPECT(gbc.d(),  0xe8);
        EXPECT(gbc.e(),  0x64);
        EXPECT(gbc.h(),  0x22);
        EXPECT(gbc.l(),  0x89);
        EXPECT(gbc.sp(), 0xe190);
        EXPECT(gbc.pc(), 0xb4a1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb4a0), 0xa4);
        // A4 0100
        gbc.setState(0xbf53, 0xebea, 0xc080, 0x106b, 0x3d77, 0xeb72, 0x1, 0x0);
        gbc.writeMem(0xbf53, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc0);
        EXPECT(gbc.b(),  0x10);
        EXPECT(gbc.c(),  0x6b);
        EXPECT(gbc.d(),  0x3d);
        EXPECT(gbc.e(),  0x77);
        EXPECT(gbc.h(),  0xeb);
        EXPECT(gbc.l(),  0x72);
        EXPECT(gbc.sp(), 0xebea);
        EXPECT(gbc.pc(), 0xbf54);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbf53), 0xa4);
        // A4 0101
        gbc.setState(0x9916, 0xaa11, 0xa3f0, 0x1f6d, 0x9069, 0x817f, 0x1, 0x1);
        gbc.writeMem(0x9916, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x81);
        EXPECT(gbc.b(),  0x1f);
        EXPECT(gbc.c(),  0x6d);
        EXPECT(gbc.d(),  0x90);
        EXPECT(gbc.e(),  0x69);
        EXPECT(gbc.h(),  0x81);
        EXPECT(gbc.l(),  0x7f);
        EXPECT(gbc.sp(), 0xaa11);
        EXPECT(gbc.pc(), 0x9917);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9916), 0xa4);
        // A4 0102
        gbc.setState(0x6c2b, 0xd34, 0xeba0, 0x963d, 0x654, 0x698, 0x0, 0x0);
        gbc.writeMem(0x6c2b, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0x96);
        EXPECT(gbc.c(),  0x3d);
        EXPECT(gbc.d(),  0x6);
        EXPECT(gbc.e(),  0x54);
        EXPECT(gbc.h(),  0x6);
        EXPECT(gbc.l(),  0x98);
        EXPECT(gbc.sp(), 0xd34);
        EXPECT(gbc.pc(), 0x6c2c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0103
        gbc.setState(0xa26d, 0x7cb6, 0xf40, 0xadbc, 0x44b8, 0xc3de, 0x1, 0x0);
        gbc.writeMem(0xa26d, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3);
        EXPECT(gbc.b(),  0xad);
        EXPECT(gbc.c(),  0xbc);
        EXPECT(gbc.d(),  0x44);
        EXPECT(gbc.e(),  0xb8);
        EXPECT(gbc.h(),  0xc3);
        EXPECT(gbc.l(),  0xde);
        EXPECT(gbc.sp(), 0x7cb6);
        EXPECT(gbc.pc(), 0xa26e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa26d), 0xa4);
        // A4 0104
        gbc.setState(0x34d, 0xaad2, 0x5310, 0xdf08, 0xa1bd, 0x9494, 0x1, 0x0);
        gbc.writeMem(0x34d, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0xdf);
        EXPECT(gbc.c(),  0x8);
        EXPECT(gbc.d(),  0xa1);
        EXPECT(gbc.e(),  0xbd);
        EXPECT(gbc.h(),  0x94);
        EXPECT(gbc.l(),  0x94);
        EXPECT(gbc.sp(), 0xaad2);
        EXPECT(gbc.pc(), 0x34e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0105
        gbc.setState(0xa327, 0xc7a7, 0xdbc0, 0x1535, 0x2861, 0xbf69, 0x1, 0x1);
        gbc.writeMem(0xa327, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x9b);
        EXPECT(gbc.b(),  0x15);
        EXPECT(gbc.c(),  0x35);
        EXPECT(gbc.d(),  0x28);
        EXPECT(gbc.e(),  0x61);
        EXPECT(gbc.h(),  0xbf);
        EXPECT(gbc.l(),  0x69);
        EXPECT(gbc.sp(), 0xc7a7);
        EXPECT(gbc.pc(), 0xa328);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa327), 0xa4);
        // A4 0106
        gbc.setState(0x9096, 0x862c, 0x23f0, 0x8714, 0x6115, 0x6cfe, 0x0, 0x1);
        gbc.writeMem(0x9096, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0x87);
        EXPECT(gbc.c(),  0x14);
        EXPECT(gbc.d(),  0x61);
        EXPECT(gbc.e(),  0x15);
        EXPECT(gbc.h(),  0x6c);
        EXPECT(gbc.l(),  0xfe);
        EXPECT(gbc.sp(), 0x862c);
        EXPECT(gbc.pc(), 0x9097);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9096), 0xa4);
        // A4 0107
        gbc.setState(0x81a5, 0xa747, 0x6220, 0x6eb3, 0x381d, 0x9e82, 0x1, 0x0);
        gbc.writeMem(0x81a5, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0x6e);
        EXPECT(gbc.c(),  0xb3);
        EXPECT(gbc.d(),  0x38);
        EXPECT(gbc.e(),  0x1d);
        EXPECT(gbc.h(),  0x9e);
        EXPECT(gbc.l(),  0x82);
        EXPECT(gbc.sp(), 0xa747);
        EXPECT(gbc.pc(), 0x81a6);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x81a5), 0xa4);
        // A4 0108
        gbc.setState(0x8d42, 0x3b41, 0xf6b0, 0x3462, 0xbe7, 0x49f9, 0x1, 0x1);
        gbc.writeMem(0x8d42, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0x34);
        EXPECT(gbc.c(),  0x62);
        EXPECT(gbc.d(),  0xb);
        EXPECT(gbc.e(),  0xe7);
        EXPECT(gbc.h(),  0x49);
        EXPECT(gbc.l(),  0xf9);
        EXPECT(gbc.sp(), 0x3b41);
        EXPECT(gbc.pc(), 0x8d43);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8d42), 0xa4);
        // A4 0109
        gbc.setState(0x5474, 0x3506, 0x1950, 0x896b, 0xc823, 0xa51a, 0x0, 0x0);
        gbc.writeMem(0x5474, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0x89);
        EXPECT(gbc.c(),  0x6b);
        EXPECT(gbc.d(),  0xc8);
        EXPECT(gbc.e(),  0x23);
        EXPECT(gbc.h(),  0xa5);
        EXPECT(gbc.l(),  0x1a);
        EXPECT(gbc.sp(), 0x3506);
        EXPECT(gbc.pc(), 0x5475);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 010A
        gbc.setState(0x7615, 0x155f, 0x4460, 0xd9ec, 0xbdb0, 0x808d, 0x0, 0x1);
        gbc.writeMem(0x7615, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0xd9);
        EXPECT(gbc.c(),  0xec);
        EXPECT(gbc.d(),  0xbd);
        EXPECT(gbc.e(),  0xb0);
        EXPECT(gbc.h(),  0x80);
        EXPECT(gbc.l(),  0x8d);
        EXPECT(gbc.sp(), 0x155f);
        EXPECT(gbc.pc(), 0x7616);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 010B
        gbc.setState(0xdcbd, 0x64c0, 0x1380, 0xbf6f, 0x4feb, 0xabfd, 0x0, 0x1);
        gbc.writeMem(0xdcbd, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3);
        EXPECT(gbc.b(),  0xbf);
        EXPECT(gbc.c(),  0x6f);
        EXPECT(gbc.d(),  0x4f);
        EXPECT(gbc.e(),  0xeb);
        EXPECT(gbc.h(),  0xab);
        EXPECT(gbc.l(),  0xfd);
        EXPECT(gbc.sp(), 0x64c0);
        EXPECT(gbc.pc(), 0xdcbe);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdcbd), 0xa4);
        // A4 010C
        gbc.setState(0x80ce, 0x598, 0x8e20, 0x3b62, 0x28ed, 0x4525, 0x0, 0x1);
        gbc.writeMem(0x80ce, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0x3b);
        EXPECT(gbc.c(),  0x62);
        EXPECT(gbc.d(),  0x28);
        EXPECT(gbc.e(),  0xed);
        EXPECT(gbc.h(),  0x45);
        EXPECT(gbc.l(),  0x25);
        EXPECT(gbc.sp(), 0x598);
        EXPECT(gbc.pc(), 0x80cf);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x80ce), 0xa4);
        // A4 010D
        gbc.setState(0x6a57, 0x9321, 0xed50, 0x184e, 0xb607, 0x8f4f, 0x0, 0x1);
        gbc.writeMem(0x6a57, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8d);
        EXPECT(gbc.b(),  0x18);
        EXPECT(gbc.c(),  0x4e);
        EXPECT(gbc.d(),  0xb6);
        EXPECT(gbc.e(),  0x7);
        EXPECT(gbc.h(),  0x8f);
        EXPECT(gbc.l(),  0x4f);
        EXPECT(gbc.sp(), 0x9321);
        EXPECT(gbc.pc(), 0x6a58);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 010E
        gbc.setState(0x15de, 0xe1d1, 0xd860, 0xfd83, 0x8cac, 0x6713, 0x0, 0x1);
        gbc.writeMem(0x15de, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0xfd);
        EXPECT(gbc.c(),  0x83);
        EXPECT(gbc.d(),  0x8c);
        EXPECT(gbc.e(),  0xac);
        EXPECT(gbc.h(),  0x67);
        EXPECT(gbc.l(),  0x13);
        EXPECT(gbc.sp(), 0xe1d1);
        EXPECT(gbc.pc(), 0x15df);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 010F
        gbc.setState(0x7645, 0x89b5, 0x2430, 0xf240, 0xdc93, 0xcad5, 0x0, 0x1);
        gbc.writeMem(0x7645, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0xf2);
        EXPECT(gbc.c(),  0x40);
        EXPECT(gbc.d(),  0xdc);
        EXPECT(gbc.e(),  0x93);
        EXPECT(gbc.h(),  0xca);
        EXPECT(gbc.l(),  0xd5);
        EXPECT(gbc.sp(), 0x89b5);
        EXPECT(gbc.pc(), 0x7646);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0110
        gbc.setState(0x5c9d, 0x7a6, 0x1270, 0x8ac, 0x51b1, 0x6bf7, 0x1, 0x1);
        gbc.writeMem(0x5c9d, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0x8);
        EXPECT(gbc.c(),  0xac);
        EXPECT(gbc.d(),  0x51);
        EXPECT(gbc.e(),  0xb1);
        EXPECT(gbc.h(),  0x6b);
        EXPECT(gbc.l(),  0xf7);
        EXPECT(gbc.sp(), 0x7a6);
        EXPECT(gbc.pc(), 0x5c9e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0111
        gbc.setState(0xf27, 0x658a, 0x68b0, 0x4d4e, 0x5f45, 0x9f4f, 0x0, 0x1);
        gbc.writeMem(0xf27, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0x4d);
        EXPECT(gbc.c(),  0x4e);
        EXPECT(gbc.d(),  0x5f);
        EXPECT(gbc.e(),  0x45);
        EXPECT(gbc.h(),  0x9f);
        EXPECT(gbc.l(),  0x4f);
        EXPECT(gbc.sp(), 0x658a);
        EXPECT(gbc.pc(), 0xf28);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0112
        gbc.setState(0x4218, 0x561c, 0x7980, 0x99aa, 0xd927, 0xe05f, 0x0, 0x1);
        gbc.writeMem(0x4218, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x60);
        EXPECT(gbc.b(),  0x99);
        EXPECT(gbc.c(),  0xaa);
        EXPECT(gbc.d(),  0xd9);
        EXPECT(gbc.e(),  0x27);
        EXPECT(gbc.h(),  0xe0);
        EXPECT(gbc.l(),  0x5f);
        EXPECT(gbc.sp(), 0x561c);
        EXPECT(gbc.pc(), 0x4219);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0113
        gbc.setState(0x8fcf, 0xe738, 0xa4c0, 0x5ee, 0x4514, 0xf0b9, 0x0, 0x1);
        gbc.writeMem(0x8fcf, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa0);
        EXPECT(gbc.b(),  0x5);
        EXPECT(gbc.c(),  0xee);
        EXPECT(gbc.d(),  0x45);
        EXPECT(gbc.e(),  0x14);
        EXPECT(gbc.h(),  0xf0);
        EXPECT(gbc.l(),  0xb9);
        EXPECT(gbc.sp(), 0xe738);
        EXPECT(gbc.pc(), 0x8fd0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8fcf), 0xa4);
        // A4 0114
        gbc.setState(0xfd1, 0xf331, 0xef20, 0x9ee1, 0x9f66, 0x6179, 0x1, 0x1);
        gbc.writeMem(0xfd1, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x61);
        EXPECT(gbc.b(),  0x9e);
        EXPECT(gbc.c(),  0xe1);
        EXPECT(gbc.d(),  0x9f);
        EXPECT(gbc.e(),  0x66);
        EXPECT(gbc.h(),  0x61);
        EXPECT(gbc.l(),  0x79);
        EXPECT(gbc.sp(), 0xf331);
        EXPECT(gbc.pc(), 0xfd2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0115
        gbc.setState(0xd7b2, 0xd7d4, 0x9380, 0x15a7, 0xd1d3, 0x992, 0x0, 0x0);
        gbc.writeMem(0xd7b2, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0x15);
        EXPECT(gbc.c(),  0xa7);
        EXPECT(gbc.d(),  0xd1);
        EXPECT(gbc.e(),  0xd3);
        EXPECT(gbc.h(),  0x9);
        EXPECT(gbc.l(),  0x92);
        EXPECT(gbc.sp(), 0xd7d4);
        EXPECT(gbc.pc(), 0xd7b3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd7b2), 0xa4);
        // A4 0116
        gbc.setState(0xcd, 0xa584, 0x2ca0, 0xcadc, 0xf0dc, 0x6893, 0x0, 0x1);
        gbc.writeMem(0xcd, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0xca);
        EXPECT(gbc.c(),  0xdc);
        EXPECT(gbc.d(),  0xf0);
        EXPECT(gbc.e(),  0xdc);
        EXPECT(gbc.h(),  0x68);
        EXPECT(gbc.l(),  0x93);
        EXPECT(gbc.sp(), 0xa584);
        EXPECT(gbc.pc(), 0xce);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0117
        gbc.setState(0xb0e8, 0x66c4, 0x9fe0, 0x47ae, 0xa38e, 0xb7ba, 0x0, 0x1);
        gbc.writeMem(0xb0e8, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x97);
        EXPECT(gbc.b(),  0x47);
        EXPECT(gbc.c(),  0xae);
        EXPECT(gbc.d(),  0xa3);
        EXPECT(gbc.e(),  0x8e);
        EXPECT(gbc.h(),  0xb7);
        EXPECT(gbc.l(),  0xba);
        EXPECT(gbc.sp(), 0x66c4);
        EXPECT(gbc.pc(), 0xb0e9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb0e8), 0xa4);
        // A4 0118
        gbc.setState(0x604e, 0x298b, 0xcb50, 0xbd90, 0xf662, 0x1d42, 0x1, 0x0);
        gbc.writeMem(0x604e, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x9);
        EXPECT(gbc.b(),  0xbd);
        EXPECT(gbc.c(),  0x90);
        EXPECT(gbc.d(),  0xf6);
        EXPECT(gbc.e(),  0x62);
        EXPECT(gbc.h(),  0x1d);
        EXPECT(gbc.l(),  0x42);
        EXPECT(gbc.sp(), 0x298b);
        EXPECT(gbc.pc(), 0x604f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0119
        gbc.setState(0xe859, 0xb9f8, 0x4460, 0x8333, 0x954, 0x4644, 0x0, 0x1);
        gbc.writeMem(0xe859, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x44);
        EXPECT(gbc.b(),  0x83);
        EXPECT(gbc.c(),  0x33);
        EXPECT(gbc.d(),  0x9);
        EXPECT(gbc.e(),  0x54);
        EXPECT(gbc.h(),  0x46);
        EXPECT(gbc.l(),  0x44);
        EXPECT(gbc.sp(), 0xb9f8);
        EXPECT(gbc.pc(), 0xe85a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe859), 0xa4);
        // A4 011A
        gbc.setState(0x9848, 0x8235, 0xe660, 0xc2ef, 0xd7e3, 0x27a5, 0x1, 0x0);
        gbc.writeMem(0x9848, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x26);
        EXPECT(gbc.b(),  0xc2);
        EXPECT(gbc.c(),  0xef);
        EXPECT(gbc.d(),  0xd7);
        EXPECT(gbc.e(),  0xe3);
        EXPECT(gbc.h(),  0x27);
        EXPECT(gbc.l(),  0xa5);
        EXPECT(gbc.sp(), 0x8235);
        EXPECT(gbc.pc(), 0x9849);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9848), 0xa4);
        // A4 011B
        gbc.setState(0x1ac2, 0x7fc8, 0xa730, 0x2b80, 0xda71, 0x30e2, 0x1, 0x1);
        gbc.writeMem(0x1ac2, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0x2b);
        EXPECT(gbc.c(),  0x80);
        EXPECT(gbc.d(),  0xda);
        EXPECT(gbc.e(),  0x71);
        EXPECT(gbc.h(),  0x30);
        EXPECT(gbc.l(),  0xe2);
        EXPECT(gbc.sp(), 0x7fc8);
        EXPECT(gbc.pc(), 0x1ac3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 011C
        gbc.setState(0xc3a7, 0x4f9c, 0xb370, 0xc824, 0x7a81, 0xa041, 0x1, 0x1);
        gbc.writeMem(0xc3a7, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa0);
        EXPECT(gbc.b(),  0xc8);
        EXPECT(gbc.c(),  0x24);
        EXPECT(gbc.d(),  0x7a);
        EXPECT(gbc.e(),  0x81);
        EXPECT(gbc.h(),  0xa0);
        EXPECT(gbc.l(),  0x41);
        EXPECT(gbc.sp(), 0x4f9c);
        EXPECT(gbc.pc(), 0xc3a8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc3a7), 0xa4);
        // A4 011D
        gbc.setState(0x6e08, 0xdd76, 0x2020, 0x2394, 0xb186, 0x4d11, 0x1, 0x1);
        gbc.writeMem(0x6e08, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x23);
        EXPECT(gbc.c(),  0x94);
        EXPECT(gbc.d(),  0xb1);
        EXPECT(gbc.e(),  0x86);
        EXPECT(gbc.h(),  0x4d);
        EXPECT(gbc.l(),  0x11);
        EXPECT(gbc.sp(), 0xdd76);
        EXPECT(gbc.pc(), 0x6e09);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 011E
        gbc.setState(0x38e7, 0xc591, 0xf0f0, 0xfc8f, 0xb498, 0x7f27, 0x1, 0x0);
        gbc.writeMem(0x38e7, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x70);
        EXPECT(gbc.b(),  0xfc);
        EXPECT(gbc.c(),  0x8f);
        EXPECT(gbc.d(),  0xb4);
        EXPECT(gbc.e(),  0x98);
        EXPECT(gbc.h(),  0x7f);
        EXPECT(gbc.l(),  0x27);
        EXPECT(gbc.sp(), 0xc591);
        EXPECT(gbc.pc(), 0x38e8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 011F
        gbc.setState(0x6de2, 0x576f, 0xacf0, 0x172, 0xf438, 0xb89, 0x0, 0x1);
        gbc.writeMem(0x6de2, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0x1);
        EXPECT(gbc.c(),  0x72);
        EXPECT(gbc.d(),  0xf4);
        EXPECT(gbc.e(),  0x38);
        EXPECT(gbc.h(),  0xb);
        EXPECT(gbc.l(),  0x89);
        EXPECT(gbc.sp(), 0x576f);
        EXPECT(gbc.pc(), 0x6de3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0120
        gbc.setState(0x1b54, 0x3435, 0xfee0, 0x8d95, 0xad2f, 0x1009, 0x0, 0x0);
        gbc.writeMem(0x1b54, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0x8d);
        EXPECT(gbc.c(),  0x95);
        EXPECT(gbc.d(),  0xad);
        EXPECT(gbc.e(),  0x2f);
        EXPECT(gbc.h(),  0x10);
        EXPECT(gbc.l(),  0x9);
        EXPECT(gbc.sp(), 0x3435);
        EXPECT(gbc.pc(), 0x1b55);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0121
        gbc.setState(0x3ed6, 0x26ec, 0x3ed0, 0xc2e7, 0xa795, 0x6fc8, 0x0, 0x1);
        gbc.writeMem(0x3ed6, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2e);
        EXPECT(gbc.b(),  0xc2);
        EXPECT(gbc.c(),  0xe7);
        EXPECT(gbc.d(),  0xa7);
        EXPECT(gbc.e(),  0x95);
        EXPECT(gbc.h(),  0x6f);
        EXPECT(gbc.l(),  0xc8);
        EXPECT(gbc.sp(), 0x26ec);
        EXPECT(gbc.pc(), 0x3ed7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0122
        gbc.setState(0x1c99, 0x6f0c, 0x5bf0, 0x377, 0x7f54, 0x974c, 0x1, 0x0);
        gbc.writeMem(0x1c99, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x13);
        EXPECT(gbc.b(),  0x3);
        EXPECT(gbc.c(),  0x77);
        EXPECT(gbc.d(),  0x7f);
        EXPECT(gbc.e(),  0x54);
        EXPECT(gbc.h(),  0x97);
        EXPECT(gbc.l(),  0x4c);
        EXPECT(gbc.sp(), 0x6f0c);
        EXPECT(gbc.pc(), 0x1c9a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0124
        gbc.setState(0x82e3, 0x2621, 0xf610, 0xc473, 0x9e04, 0x80e5, 0x0, 0x1);
        gbc.writeMem(0x82e3, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0xc4);
        EXPECT(gbc.c(),  0x73);
        EXPECT(gbc.d(),  0x9e);
        EXPECT(gbc.e(),  0x4);
        EXPECT(gbc.h(),  0x80);
        EXPECT(gbc.l(),  0xe5);
        EXPECT(gbc.sp(), 0x2621);
        EXPECT(gbc.pc(), 0x82e4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x82e3), 0xa4);
        // A4 0125
        gbc.setState(0xc173, 0xd1da, 0xfd80, 0xce19, 0x6ecf, 0x9c53, 0x0, 0x0);
        gbc.writeMem(0xc173, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x9c);
        EXPECT(gbc.b(),  0xce);
        EXPECT(gbc.c(),  0x19);
        EXPECT(gbc.d(),  0x6e);
        EXPECT(gbc.e(),  0xcf);
        EXPECT(gbc.h(),  0x9c);
        EXPECT(gbc.l(),  0x53);
        EXPECT(gbc.sp(), 0xd1da);
        EXPECT(gbc.pc(), 0xc174);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc173), 0xa4);
        // A4 0126
        gbc.setState(0xb5c4, 0x6be9, 0xe6a0, 0x25fe, 0xff2d, 0xa34b, 0x0, 0x1);
        gbc.writeMem(0xb5c4, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa2);
        EXPECT(gbc.b(),  0x25);
        EXPECT(gbc.c(),  0xfe);
        EXPECT(gbc.d(),  0xff);
        EXPECT(gbc.e(),  0x2d);
        EXPECT(gbc.h(),  0xa3);
        EXPECT(gbc.l(),  0x4b);
        EXPECT(gbc.sp(), 0x6be9);
        EXPECT(gbc.pc(), 0xb5c5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb5c4), 0xa4);
        // A4 0127
        gbc.setState(0x6123, 0xbec, 0x1290, 0xee14, 0xa55c, 0x1acb, 0x0, 0x1);
        gbc.writeMem(0x6123, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x12);
        EXPECT(gbc.b(),  0xee);
        EXPECT(gbc.c(),  0x14);
        EXPECT(gbc.d(),  0xa5);
        EXPECT(gbc.e(),  0x5c);
        EXPECT(gbc.h(),  0x1a);
        EXPECT(gbc.l(),  0xcb);
        EXPECT(gbc.sp(), 0xbec);
        EXPECT(gbc.pc(), 0x6124);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0128
        gbc.setState(0x9b19, 0x44e1, 0xc720, 0x3fab, 0x2507, 0xf948, 0x1, 0x1);
        gbc.writeMem(0x9b19, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc1);
        EXPECT(gbc.b(),  0x3f);
        EXPECT(gbc.c(),  0xab);
        EXPECT(gbc.d(),  0x25);
        EXPECT(gbc.e(),  0x7);
        EXPECT(gbc.h(),  0xf9);
        EXPECT(gbc.l(),  0x48);
        EXPECT(gbc.sp(), 0x44e1);
        EXPECT(gbc.pc(), 0x9b1a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9b19), 0xa4);
        // A4 012A
        gbc.setState(0xd2dd, 0x8345, 0x7a50, 0xbd2a, 0xbdbc, 0x2ba4, 0x0, 0x0);
        gbc.writeMem(0xd2dd, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2a);
        EXPECT(gbc.b(),  0xbd);
        EXPECT(gbc.c(),  0x2a);
        EXPECT(gbc.d(),  0xbd);
        EXPECT(gbc.e(),  0xbc);
        EXPECT(gbc.h(),  0x2b);
        EXPECT(gbc.l(),  0xa4);
        EXPECT(gbc.sp(), 0x8345);
        EXPECT(gbc.pc(), 0xd2de);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd2dd), 0xa4);
        // A4 012B
        gbc.setState(0x4232, 0xa173, 0xea70, 0xf7b, 0x7ad9, 0x5c8e, 0x0, 0x0);
        gbc.writeMem(0x4232, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x48);
        EXPECT(gbc.b(),  0xf);
        EXPECT(gbc.c(),  0x7b);
        EXPECT(gbc.d(),  0x7a);
        EXPECT(gbc.e(),  0xd9);
        EXPECT(gbc.h(),  0x5c);
        EXPECT(gbc.l(),  0x8e);
        EXPECT(gbc.sp(), 0xa173);
        EXPECT(gbc.pc(), 0x4233);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 012D
        gbc.setState(0xe27, 0xca54, 0xc590, 0x3dd2, 0x39e5, 0x7695, 0x0, 0x0);
        gbc.writeMem(0xe27, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x44);
        EXPECT(gbc.b(),  0x3d);
        EXPECT(gbc.c(),  0xd2);
        EXPECT(gbc.d(),  0x39);
        EXPECT(gbc.e(),  0xe5);
        EXPECT(gbc.h(),  0x76);
        EXPECT(gbc.l(),  0x95);
        EXPECT(gbc.sp(), 0xca54);
        EXPECT(gbc.pc(), 0xe28);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 012E
        gbc.setState(0x5062, 0x2bcd, 0x3a80, 0x87ba, 0x1c82, 0x4666, 0x1, 0x0);
        gbc.writeMem(0x5062, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0x87);
        EXPECT(gbc.c(),  0xba);
        EXPECT(gbc.d(),  0x1c);
        EXPECT(gbc.e(),  0x82);
        EXPECT(gbc.h(),  0x46);
        EXPECT(gbc.l(),  0x66);
        EXPECT(gbc.sp(), 0x2bcd);
        EXPECT(gbc.pc(), 0x5063);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 012F
        gbc.setState(0xbdc1, 0x95b9, 0x4df0, 0xb84c, 0xe0c6, 0xc68a, 0x1, 0x1);
        gbc.writeMem(0xbdc1, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x44);
        EXPECT(gbc.b(),  0xb8);
        EXPECT(gbc.c(),  0x4c);
        EXPECT(gbc.d(),  0xe0);
        EXPECT(gbc.e(),  0xc6);
        EXPECT(gbc.h(),  0xc6);
        EXPECT(gbc.l(),  0x8a);
        EXPECT(gbc.sp(), 0x95b9);
        EXPECT(gbc.pc(), 0xbdc2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbdc1), 0xa4);
        // A4 0130
        gbc.setState(0x1fb1, 0x6a00, 0x7b90, 0x615e, 0x1f75, 0xd9a8, 0x1, 0x1);
        gbc.writeMem(0x1fb1, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x59);
        EXPECT(gbc.b(),  0x61);
        EXPECT(gbc.c(),  0x5e);
        EXPECT(gbc.d(),  0x1f);
        EXPECT(gbc.e(),  0x75);
        EXPECT(gbc.h(),  0xd9);
        EXPECT(gbc.l(),  0xa8);
        EXPECT(gbc.sp(), 0x6a00);
        EXPECT(gbc.pc(), 0x1fb2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0131
        gbc.setState(0xd692, 0x786e, 0xc890, 0xddcd, 0x62ce, 0x2aa3, 0x1, 0x0);
        gbc.writeMem(0xd692, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0xdd);
        EXPECT(gbc.c(),  0xcd);
        EXPECT(gbc.d(),  0x62);
        EXPECT(gbc.e(),  0xce);
        EXPECT(gbc.h(),  0x2a);
        EXPECT(gbc.l(),  0xa3);
        EXPECT(gbc.sp(), 0x786e);
        EXPECT(gbc.pc(), 0xd693);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd692), 0xa4);
        // A4 0132
        gbc.setState(0x602f, 0xb490, 0xa7d0, 0x1f86, 0x1cef, 0xd758, 0x1, 0x1);
        gbc.writeMem(0x602f, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x87);
        EXPECT(gbc.b(),  0x1f);
        EXPECT(gbc.c(),  0x86);
        EXPECT(gbc.d(),  0x1c);
        EXPECT(gbc.e(),  0xef);
        EXPECT(gbc.h(),  0xd7);
        EXPECT(gbc.l(),  0x58);
        EXPECT(gbc.sp(), 0xb490);
        EXPECT(gbc.pc(), 0x6030);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0133
        gbc.setState(0x52c5, 0x8ad3, 0x7e50, 0x887b, 0x1216, 0xa862, 0x1, 0x0);
        gbc.writeMem(0x52c5, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0x88);
        EXPECT(gbc.c(),  0x7b);
        EXPECT(gbc.d(),  0x12);
        EXPECT(gbc.e(),  0x16);
        EXPECT(gbc.h(),  0xa8);
        EXPECT(gbc.l(),  0x62);
        EXPECT(gbc.sp(), 0x8ad3);
        EXPECT(gbc.pc(), 0x52c6);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0134
        gbc.setState(0x8c51, 0xadf3, 0x8f50, 0xbf8b, 0xb25b, 0x8c06, 0x1, 0x0);
        gbc.writeMem(0x8c51, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8c);
        EXPECT(gbc.b(),  0xbf);
        EXPECT(gbc.c(),  0x8b);
        EXPECT(gbc.d(),  0xb2);
        EXPECT(gbc.e(),  0x5b);
        EXPECT(gbc.h(),  0x8c);
        EXPECT(gbc.l(),  0x6);
        EXPECT(gbc.sp(), 0xadf3);
        EXPECT(gbc.pc(), 0x8c52);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8c51), 0xa4);
        // A4 0136
        gbc.setState(0xa3f7, 0x39e9, 0xed80, 0x300b, 0xc0af, 0x8126, 0x1, 0x1);
        gbc.writeMem(0xa3f7, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x81);
        EXPECT(gbc.b(),  0x30);
        EXPECT(gbc.c(),  0xb);
        EXPECT(gbc.d(),  0xc0);
        EXPECT(gbc.e(),  0xaf);
        EXPECT(gbc.h(),  0x81);
        EXPECT(gbc.l(),  0x26);
        EXPECT(gbc.sp(), 0x39e9);
        EXPECT(gbc.pc(), 0xa3f8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa3f7), 0xa4);
        // A4 0137
        gbc.setState(0x5537, 0x488, 0x61f0, 0xa7d, 0x4f52, 0x6c1d, 0x1, 0x1);
        gbc.writeMem(0x5537, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x60);
        EXPECT(gbc.b(),  0xa);
        EXPECT(gbc.c(),  0x7d);
        EXPECT(gbc.d(),  0x4f);
        EXPECT(gbc.e(),  0x52);
        EXPECT(gbc.h(),  0x6c);
        EXPECT(gbc.l(),  0x1d);
        EXPECT(gbc.sp(), 0x488);
        EXPECT(gbc.pc(), 0x5538);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0139
        gbc.setState(0x355e, 0x7bf0, 0x12f0, 0x1fca, 0xbeae, 0x1c8a, 0x1, 0x1);
        gbc.writeMem(0x355e, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0x1f);
        EXPECT(gbc.c(),  0xca);
        EXPECT(gbc.d(),  0xbe);
        EXPECT(gbc.e(),  0xae);
        EXPECT(gbc.h(),  0x1c);
        EXPECT(gbc.l(),  0x8a);
        EXPECT(gbc.sp(), 0x7bf0);
        EXPECT(gbc.pc(), 0x355f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 013A
        gbc.setState(0x8823, 0x5d69, 0xaab0, 0xa7a3, 0x66f2, 0xdc5, 0x0, 0x0);
        gbc.writeMem(0x8823, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0xa7);
        EXPECT(gbc.c(),  0xa3);
        EXPECT(gbc.d(),  0x66);
        EXPECT(gbc.e(),  0xf2);
        EXPECT(gbc.h(),  0xd);
        EXPECT(gbc.l(),  0xc5);
        EXPECT(gbc.sp(), 0x5d69);
        EXPECT(gbc.pc(), 0x8824);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8823), 0xa4);
        // A4 013B
        gbc.setState(0xdf7a, 0x3377, 0x2e20, 0xbf66, 0x9446, 0x50f5, 0x1, 0x1);
        gbc.writeMem(0xdf7a, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0xbf);
        EXPECT(gbc.c(),  0x66);
        EXPECT(gbc.d(),  0x94);
        EXPECT(gbc.e(),  0x46);
        EXPECT(gbc.h(),  0x50);
        EXPECT(gbc.l(),  0xf5);
        EXPECT(gbc.sp(), 0x3377);
        EXPECT(gbc.pc(), 0xdf7b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdf7a), 0xa4);
        // A4 013C
        gbc.setState(0x79e1, 0x5a75, 0x8bd0, 0xdb59, 0xc89b, 0x6fa1, 0x0, 0x0);
        gbc.writeMem(0x79e1, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb);
        EXPECT(gbc.b(),  0xdb);
        EXPECT(gbc.c(),  0x59);
        EXPECT(gbc.d(),  0xc8);
        EXPECT(gbc.e(),  0x9b);
        EXPECT(gbc.h(),  0x6f);
        EXPECT(gbc.l(),  0xa1);
        EXPECT(gbc.sp(), 0x5a75);
        EXPECT(gbc.pc(), 0x79e2);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 013D
        gbc.setState(0xdf45, 0x12e4, 0x48f0, 0xceb9, 0x6352, 0xf035, 0x0, 0x1);
        gbc.writeMem(0xdf45, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0xce);
        EXPECT(gbc.c(),  0xb9);
        EXPECT(gbc.d(),  0x63);
        EXPECT(gbc.e(),  0x52);
        EXPECT(gbc.h(),  0xf0);
        EXPECT(gbc.l(),  0x35);
        EXPECT(gbc.sp(), 0x12e4);
        EXPECT(gbc.pc(), 0xdf46);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdf45), 0xa4);
        // A4 013E
        gbc.setState(0x7a29, 0x72c, 0xfd70, 0x6431, 0x353, 0xad42, 0x1, 0x1);
        gbc.writeMem(0x7a29, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xad);
        EXPECT(gbc.b(),  0x64);
        EXPECT(gbc.c(),  0x31);
        EXPECT(gbc.d(),  0x3);
        EXPECT(gbc.e(),  0x53);
        EXPECT(gbc.h(),  0xad);
        EXPECT(gbc.l(),  0x42);
        EXPECT(gbc.sp(), 0x72c);
        EXPECT(gbc.pc(), 0x7a2a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 013F
        gbc.setState(0xdc5a, 0xb1e7, 0x7e20, 0xb549, 0x987a, 0xdfb2, 0x0, 0x0);
        gbc.writeMem(0xdc5a, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x5e);
        EXPECT(gbc.b(),  0xb5);
        EXPECT(gbc.c(),  0x49);
        EXPECT(gbc.d(),  0x98);
        EXPECT(gbc.e(),  0x7a);
        EXPECT(gbc.h(),  0xdf);
        EXPECT(gbc.l(),  0xb2);
        EXPECT(gbc.sp(), 0xb1e7);
        EXPECT(gbc.pc(), 0xdc5b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdc5a), 0xa4);
        // A4 0140
        gbc.setState(0xf03, 0x630f, 0x7aa0, 0xf0dc, 0x7bbe, 0x3a1c, 0x1, 0x0);
        gbc.writeMem(0xf03, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3a);
        EXPECT(gbc.b(),  0xf0);
        EXPECT(gbc.c(),  0xdc);
        EXPECT(gbc.d(),  0x7b);
        EXPECT(gbc.e(),  0xbe);
        EXPECT(gbc.h(),  0x3a);
        EXPECT(gbc.l(),  0x1c);
        EXPECT(gbc.sp(), 0x630f);
        EXPECT(gbc.pc(), 0xf04);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0141
        gbc.setState(0x1f5d, 0xcd04, 0xc220, 0xc674, 0x1163, 0x651a, 0x1, 0x1);
        gbc.writeMem(0x1f5d, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0xc6);
        EXPECT(gbc.c(),  0x74);
        EXPECT(gbc.d(),  0x11);
        EXPECT(gbc.e(),  0x63);
        EXPECT(gbc.h(),  0x65);
        EXPECT(gbc.l(),  0x1a);
        EXPECT(gbc.sp(), 0xcd04);
        EXPECT(gbc.pc(), 0x1f5e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0142
        gbc.setState(0xd00c, 0x47a9, 0x95a0, 0xa41b, 0x9e22, 0xf35e, 0x0, 0x0);
        gbc.writeMem(0xd00c, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x91);
        EXPECT(gbc.b(),  0xa4);
        EXPECT(gbc.c(),  0x1b);
        EXPECT(gbc.d(),  0x9e);
        EXPECT(gbc.e(),  0x22);
        EXPECT(gbc.h(),  0xf3);
        EXPECT(gbc.l(),  0x5e);
        EXPECT(gbc.sp(), 0x47a9);
        EXPECT(gbc.pc(), 0xd00d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd00c), 0xa4);
        // A4 0143
        gbc.setState(0xca7c, 0xfdc4, 0xce10, 0xd409, 0x9f5, 0x35ac, 0x0, 0x1);
        gbc.writeMem(0xca7c, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0xd4);
        EXPECT(gbc.c(),  0x9);
        EXPECT(gbc.d(),  0x9);
        EXPECT(gbc.e(),  0xf5);
        EXPECT(gbc.h(),  0x35);
        EXPECT(gbc.l(),  0xac);
        EXPECT(gbc.sp(), 0xfdc4);
        EXPECT(gbc.pc(), 0xca7d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xca7c), 0xa4);
        // A4 0144
        gbc.setState(0x3c00, 0xa1e, 0x4030, 0xeb33, 0x8321, 0x2779, 0x0, 0x1);
        gbc.writeMem(0x3c00, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0xeb);
        EXPECT(gbc.c(),  0x33);
        EXPECT(gbc.d(),  0x83);
        EXPECT(gbc.e(),  0x21);
        EXPECT(gbc.h(),  0x27);
        EXPECT(gbc.l(),  0x79);
        EXPECT(gbc.sp(), 0xa1e);
        EXPECT(gbc.pc(), 0x3c01);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0145
        gbc.setState(0x1d42, 0x1721, 0x4ff0, 0x9bab, 0x9ea, 0xc75, 0x0, 0x1);
        gbc.writeMem(0x1d42, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc);
        EXPECT(gbc.b(),  0x9b);
        EXPECT(gbc.c(),  0xab);
        EXPECT(gbc.d(),  0x9);
        EXPECT(gbc.e(),  0xea);
        EXPECT(gbc.h(),  0xc);
        EXPECT(gbc.l(),  0x75);
        EXPECT(gbc.sp(), 0x1721);
        EXPECT(gbc.pc(), 0x1d43);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0146
        gbc.setState(0x8abd, 0xfec6, 0xa140, 0xa2d6, 0x18a4, 0x8532, 0x1, 0x0);
        gbc.writeMem(0x8abd, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x81);
        EXPECT(gbc.b(),  0xa2);
        EXPECT(gbc.c(),  0xd6);
        EXPECT(gbc.d(),  0x18);
        EXPECT(gbc.e(),  0xa4);
        EXPECT(gbc.h(),  0x85);
        EXPECT(gbc.l(),  0x32);
        EXPECT(gbc.sp(), 0xfec6);
        EXPECT(gbc.pc(), 0x8abe);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8abd), 0xa4);
        // A4 0147
        gbc.setState(0xa028, 0x9bbc, 0xee70, 0xa4e1, 0xe63f, 0x78d3, 0x0, 0x0);
        gbc.writeMem(0xa028, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x68);
        EXPECT(gbc.b(),  0xa4);
        EXPECT(gbc.c(),  0xe1);
        EXPECT(gbc.d(),  0xe6);
        EXPECT(gbc.e(),  0x3f);
        EXPECT(gbc.h(),  0x78);
        EXPECT(gbc.l(),  0xd3);
        EXPECT(gbc.sp(), 0x9bbc);
        EXPECT(gbc.pc(), 0xa029);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa028), 0xa4);
        // A4 0148
        gbc.setState(0x5d30, 0xf843, 0x4c20, 0xd877, 0x6e07, 0x5e1d, 0x1, 0x1);
        gbc.writeMem(0x5d30, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4c);
        EXPECT(gbc.b(),  0xd8);
        EXPECT(gbc.c(),  0x77);
        EXPECT(gbc.d(),  0x6e);
        EXPECT(gbc.e(),  0x7);
        EXPECT(gbc.h(),  0x5e);
        EXPECT(gbc.l(),  0x1d);
        EXPECT(gbc.sp(), 0xf843);
        EXPECT(gbc.pc(), 0x5d31);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0149
        gbc.setState(0x6ac, 0xcd34, 0xaeb0, 0xd9d4, 0xf2aa, 0xb38, 0x1, 0x0);
        gbc.writeMem(0x6ac, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa);
        EXPECT(gbc.b(),  0xd9);
        EXPECT(gbc.c(),  0xd4);
        EXPECT(gbc.d(),  0xf2);
        EXPECT(gbc.e(),  0xaa);
        EXPECT(gbc.h(),  0xb);
        EXPECT(gbc.l(),  0x38);
        EXPECT(gbc.sp(), 0xcd34);
        EXPECT(gbc.pc(), 0x6ad);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 014A
        gbc.setState(0x87f7, 0x43e5, 0xd9b0, 0x7050, 0xa8fa, 0x5191, 0x1, 0x1);
        gbc.writeMem(0x87f7, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x51);
        EXPECT(gbc.b(),  0x70);
        EXPECT(gbc.c(),  0x50);
        EXPECT(gbc.d(),  0xa8);
        EXPECT(gbc.e(),  0xfa);
        EXPECT(gbc.h(),  0x51);
        EXPECT(gbc.l(),  0x91);
        EXPECT(gbc.sp(), 0x43e5);
        EXPECT(gbc.pc(), 0x87f8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x87f7), 0xa4);
        // A4 014B
        gbc.setState(0xb1d5, 0x947d, 0x5400, 0x10b5, 0x9a9f, 0xb762, 0x0, 0x1);
        gbc.writeMem(0xb1d5, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x14);
        EXPECT(gbc.b(),  0x10);
        EXPECT(gbc.c(),  0xb5);
        EXPECT(gbc.d(),  0x9a);
        EXPECT(gbc.e(),  0x9f);
        EXPECT(gbc.h(),  0xb7);
        EXPECT(gbc.l(),  0x62);
        EXPECT(gbc.sp(), 0x947d);
        EXPECT(gbc.pc(), 0xb1d6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb1d5), 0xa4);
        // A4 014C
        gbc.setState(0x2861, 0x723b, 0x9400, 0xef66, 0x45fb, 0xa58, 0x1, 0x1);
        gbc.writeMem(0x2861, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0xef);
        EXPECT(gbc.c(),  0x66);
        EXPECT(gbc.d(),  0x45);
        EXPECT(gbc.e(),  0xfb);
        EXPECT(gbc.h(),  0xa);
        EXPECT(gbc.l(),  0x58);
        EXPECT(gbc.sp(), 0x723b);
        EXPECT(gbc.pc(), 0x2862);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 014D
        gbc.setState(0x363f, 0x64c5, 0x3d30, 0xb3c4, 0xf98a, 0x5233, 0x1, 0x0);
        gbc.writeMem(0x363f, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0xb3);
        EXPECT(gbc.c(),  0xc4);
        EXPECT(gbc.d(),  0xf9);
        EXPECT(gbc.e(),  0x8a);
        EXPECT(gbc.h(),  0x52);
        EXPECT(gbc.l(),  0x33);
        EXPECT(gbc.sp(), 0x64c5);
        EXPECT(gbc.pc(), 0x3640);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 014E
        gbc.setState(0x4e9c, 0x7f73, 0x9b70, 0x9409, 0x342c, 0x626a, 0x1, 0x1);
        gbc.writeMem(0x4e9c, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0x94);
        EXPECT(gbc.c(),  0x9);
        EXPECT(gbc.d(),  0x34);
        EXPECT(gbc.e(),  0x2c);
        EXPECT(gbc.h(),  0x62);
        EXPECT(gbc.l(),  0x6a);
        EXPECT(gbc.sp(), 0x7f73);
        EXPECT(gbc.pc(), 0x4e9d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 014F
        gbc.setState(0x1fd3, 0x1f04, 0x1370, 0xad59, 0x47aa, 0x3d0, 0x1, 0x0);
        gbc.writeMem(0x1fd3, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3);
        EXPECT(gbc.b(),  0xad);
        EXPECT(gbc.c(),  0x59);
        EXPECT(gbc.d(),  0x47);
        EXPECT(gbc.e(),  0xaa);
        EXPECT(gbc.h(),  0x3);
        EXPECT(gbc.l(),  0xd0);
        EXPECT(gbc.sp(), 0x1f04);
        EXPECT(gbc.pc(), 0x1fd4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0150
        gbc.setState(0x5230, 0x39b9, 0x5a10, 0x3bf7, 0x769e, 0x9b86, 0x0, 0x1);
        gbc.writeMem(0x5230, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1a);
        EXPECT(gbc.b(),  0x3b);
        EXPECT(gbc.c(),  0xf7);
        EXPECT(gbc.d(),  0x76);
        EXPECT(gbc.e(),  0x9e);
        EXPECT(gbc.h(),  0x9b);
        EXPECT(gbc.l(),  0x86);
        EXPECT(gbc.sp(), 0x39b9);
        EXPECT(gbc.pc(), 0x5231);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0151
        gbc.setState(0xdf53, 0x3952, 0xf3b0, 0xc39b, 0x64bc, 0xb9af, 0x1, 0x1);
        gbc.writeMem(0xdf53, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb1);
        EXPECT(gbc.b(),  0xc3);
        EXPECT(gbc.c(),  0x9b);
        EXPECT(gbc.d(),  0x64);
        EXPECT(gbc.e(),  0xbc);
        EXPECT(gbc.h(),  0xb9);
        EXPECT(gbc.l(),  0xaf);
        EXPECT(gbc.sp(), 0x3952);
        EXPECT(gbc.pc(), 0xdf54);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdf53), 0xa4);
        // A4 0152
        gbc.setState(0xad43, 0x16a4, 0x3990, 0x68b3, 0xa1c3, 0x45d0, 0x1, 0x1);
        gbc.writeMem(0xad43, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0x68);
        EXPECT(gbc.c(),  0xb3);
        EXPECT(gbc.d(),  0xa1);
        EXPECT(gbc.e(),  0xc3);
        EXPECT(gbc.h(),  0x45);
        EXPECT(gbc.l(),  0xd0);
        EXPECT(gbc.sp(), 0x16a4);
        EXPECT(gbc.pc(), 0xad44);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xad43), 0xa4);
        // A4 0153
        gbc.setState(0x54d1, 0x7655, 0x4bf0, 0xe68e, 0x8dc3, 0xa911, 0x0, 0x1);
        gbc.writeMem(0x54d1, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x9);
        EXPECT(gbc.b(),  0xe6);
        EXPECT(gbc.c(),  0x8e);
        EXPECT(gbc.d(),  0x8d);
        EXPECT(gbc.e(),  0xc3);
        EXPECT(gbc.h(),  0xa9);
        EXPECT(gbc.l(),  0x11);
        EXPECT(gbc.sp(), 0x7655);
        EXPECT(gbc.pc(), 0x54d2);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0154
        gbc.setState(0x152e, 0xec9d, 0x8720, 0x5994, 0xc14e, 0x84ba, 0x1, 0x0);
        gbc.writeMem(0x152e, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x84);
        EXPECT(gbc.b(),  0x59);
        EXPECT(gbc.c(),  0x94);
        EXPECT(gbc.d(),  0xc1);
        EXPECT(gbc.e(),  0x4e);
        EXPECT(gbc.h(),  0x84);
        EXPECT(gbc.l(),  0xba);
        EXPECT(gbc.sp(), 0xec9d);
        EXPECT(gbc.pc(), 0x152f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0155
        gbc.setState(0x4934, 0x5c4f, 0xca20, 0xae08, 0xcd9, 0x4a43, 0x0, 0x1);
        gbc.writeMem(0x4934, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4a);
        EXPECT(gbc.b(),  0xae);
        EXPECT(gbc.c(),  0x8);
        EXPECT(gbc.d(),  0xc);
        EXPECT(gbc.e(),  0xd9);
        EXPECT(gbc.h(),  0x4a);
        EXPECT(gbc.l(),  0x43);
        EXPECT(gbc.sp(), 0x5c4f);
        EXPECT(gbc.pc(), 0x4935);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0156
        gbc.setState(0xda3a, 0x2e3d, 0xbf60, 0x3ded, 0x4e70, 0x6b61, 0x1, 0x1);
        gbc.writeMem(0xda3a, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2b);
        EXPECT(gbc.b(),  0x3d);
        EXPECT(gbc.c(),  0xed);
        EXPECT(gbc.d(),  0x4e);
        EXPECT(gbc.e(),  0x70);
        EXPECT(gbc.h(),  0x6b);
        EXPECT(gbc.l(),  0x61);
        EXPECT(gbc.sp(), 0x2e3d);
        EXPECT(gbc.pc(), 0xda3b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xda3a), 0xa4);
        // A4 0157
        gbc.setState(0x705d, 0xd3dd, 0xe5e0, 0xbb7f, 0x263a, 0x9800, 0x1, 0x1);
        gbc.writeMem(0x705d, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0xbb);
        EXPECT(gbc.c(),  0x7f);
        EXPECT(gbc.d(),  0x26);
        EXPECT(gbc.e(),  0x3a);
        EXPECT(gbc.h(),  0x98);
        EXPECT(gbc.l(),  0x0);
        EXPECT(gbc.sp(), 0xd3dd);
        EXPECT(gbc.pc(), 0x705e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0158
        gbc.setState(0xb87f, 0xb746, 0xa7d0, 0x3d2a, 0xd622, 0xd2e9, 0x0, 0x0);
        gbc.writeMem(0xb87f, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x82);
        EXPECT(gbc.b(),  0x3d);
        EXPECT(gbc.c(),  0x2a);
        EXPECT(gbc.d(),  0xd6);
        EXPECT(gbc.e(),  0x22);
        EXPECT(gbc.h(),  0xd2);
        EXPECT(gbc.l(),  0xe9);
        EXPECT(gbc.sp(), 0xb746);
        EXPECT(gbc.pc(), 0xb880);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb87f), 0xa4);
        // A4 0159
        gbc.setState(0xe540, 0xb2cc, 0x1a40, 0x6d59, 0x925e, 0x784d, 0x0, 0x0);
        gbc.writeMem(0xe540, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x18);
        EXPECT(gbc.b(),  0x6d);
        EXPECT(gbc.c(),  0x59);
        EXPECT(gbc.d(),  0x92);
        EXPECT(gbc.e(),  0x5e);
        EXPECT(gbc.h(),  0x78);
        EXPECT(gbc.l(),  0x4d);
        EXPECT(gbc.sp(), 0xb2cc);
        EXPECT(gbc.pc(), 0xe541);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe540), 0xa4);
        // A4 015A
        gbc.setState(0xba59, 0xd94d, 0xee80, 0xa91e, 0xbdbe, 0x446f, 0x0, 0x1);
        gbc.writeMem(0xba59, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x44);
        EXPECT(gbc.b(),  0xa9);
        EXPECT(gbc.c(),  0x1e);
        EXPECT(gbc.d(),  0xbd);
        EXPECT(gbc.e(),  0xbe);
        EXPECT(gbc.h(),  0x44);
        EXPECT(gbc.l(),  0x6f);
        EXPECT(gbc.sp(), 0xd94d);
        EXPECT(gbc.pc(), 0xba5a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xba59), 0xa4);
        // A4 015B
        gbc.setState(0x1476, 0x680c, 0x4980, 0x661d, 0x590c, 0xa575, 0x1, 0x1);
        gbc.writeMem(0x1476, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0x66);
        EXPECT(gbc.c(),  0x1d);
        EXPECT(gbc.d(),  0x59);
        EXPECT(gbc.e(),  0xc);
        EXPECT(gbc.h(),  0xa5);
        EXPECT(gbc.l(),  0x75);
        EXPECT(gbc.sp(), 0x680c);
        EXPECT(gbc.pc(), 0x1477);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 015C
        gbc.setState(0xd693, 0xd8a0, 0x9da0, 0x9959, 0x5261, 0x38ed, 0x0, 0x0);
        gbc.writeMem(0xd693, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x18);
        EXPECT(gbc.b(),  0x99);
        EXPECT(gbc.c(),  0x59);
        EXPECT(gbc.d(),  0x52);
        EXPECT(gbc.e(),  0x61);
        EXPECT(gbc.h(),  0x38);
        EXPECT(gbc.l(),  0xed);
        EXPECT(gbc.sp(), 0xd8a0);
        EXPECT(gbc.pc(), 0xd694);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd693), 0xa4);
        // A4 015D
        gbc.setState(0x6bfa, 0x9cc, 0xc10, 0x69c0, 0x35ed, 0x7ea1, 0x1, 0x0);
        gbc.writeMem(0x6bfa, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc);
        EXPECT(gbc.b(),  0x69);
        EXPECT(gbc.c(),  0xc0);
        EXPECT(gbc.d(),  0x35);
        EXPECT(gbc.e(),  0xed);
        EXPECT(gbc.h(),  0x7e);
        EXPECT(gbc.l(),  0xa1);
        EXPECT(gbc.sp(), 0x9cc);
        EXPECT(gbc.pc(), 0x6bfb);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 015E
        gbc.setState(0x65a4, 0x4767, 0x3780, 0x8144, 0x9fc0, 0x9267, 0x1, 0x1);
        gbc.writeMem(0x65a4, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x12);
        EXPECT(gbc.b(),  0x81);
        EXPECT(gbc.c(),  0x44);
        EXPECT(gbc.d(),  0x9f);
        EXPECT(gbc.e(),  0xc0);
        EXPECT(gbc.h(),  0x92);
        EXPECT(gbc.l(),  0x67);
        EXPECT(gbc.sp(), 0x4767);
        EXPECT(gbc.pc(), 0x65a5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 015F
        gbc.setState(0xa6c, 0x7df0, 0xe3f0, 0x87c1, 0x815a, 0x8a4f, 0x0, 0x1);
        gbc.writeMem(0xa6c, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x82);
        EXPECT(gbc.b(),  0x87);
        EXPECT(gbc.c(),  0xc1);
        EXPECT(gbc.d(),  0x81);
        EXPECT(gbc.e(),  0x5a);
        EXPECT(gbc.h(),  0x8a);
        EXPECT(gbc.l(),  0x4f);
        EXPECT(gbc.sp(), 0x7df0);
        EXPECT(gbc.pc(), 0xa6d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0160
        gbc.setState(0xb429, 0x58b5, 0xad40, 0xc6f9, 0x156b, 0x28d0, 0x1, 0x0);
        gbc.writeMem(0xb429, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0xc6);
        EXPECT(gbc.c(),  0xf9);
        EXPECT(gbc.d(),  0x15);
        EXPECT(gbc.e(),  0x6b);
        EXPECT(gbc.h(),  0x28);
        EXPECT(gbc.l(),  0xd0);
        EXPECT(gbc.sp(), 0x58b5);
        EXPECT(gbc.pc(), 0xb42a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb429), 0xa4);
        // A4 0161
        gbc.setState(0xde30, 0x55a7, 0xe850, 0x944d, 0x867a, 0xe21e, 0x1, 0x0);
        gbc.writeMem(0xde30, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe0);
        EXPECT(gbc.b(),  0x94);
        EXPECT(gbc.c(),  0x4d);
        EXPECT(gbc.d(),  0x86);
        EXPECT(gbc.e(),  0x7a);
        EXPECT(gbc.h(),  0xe2);
        EXPECT(gbc.l(),  0x1e);
        EXPECT(gbc.sp(), 0x55a7);
        EXPECT(gbc.pc(), 0xde31);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xde30), 0xa4);
        // A4 0162
        gbc.setState(0xc1b9, 0xa707, 0x7b50, 0xbea7, 0x1a68, 0xe800, 0x1, 0x1);
        gbc.writeMem(0xc1b9, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x68);
        EXPECT(gbc.b(),  0xbe);
        EXPECT(gbc.c(),  0xa7);
        EXPECT(gbc.d(),  0x1a);
        EXPECT(gbc.e(),  0x68);
        EXPECT(gbc.h(),  0xe8);
        EXPECT(gbc.l(),  0x0);
        EXPECT(gbc.sp(), 0xa707);
        EXPECT(gbc.pc(), 0xc1ba);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc1b9), 0xa4);
        // A4 0163
        gbc.setState(0x2010, 0xdf63, 0x5700, 0x3abc, 0xb90f, 0x92b1, 0x0, 0x0);
        gbc.writeMem(0x2010, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x12);
        EXPECT(gbc.b(),  0x3a);
        EXPECT(gbc.c(),  0xbc);
        EXPECT(gbc.d(),  0xb9);
        EXPECT(gbc.e(),  0xf);
        EXPECT(gbc.h(),  0x92);
        EXPECT(gbc.l(),  0xb1);
        EXPECT(gbc.sp(), 0xdf63);
        EXPECT(gbc.pc(), 0x2011);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0164
        gbc.setState(0x395, 0x99ed, 0x33e0, 0xf23e, 0x5663, 0xf390, 0x1, 0x0);
        gbc.writeMem(0x395, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x33);
        EXPECT(gbc.b(),  0xf2);
        EXPECT(gbc.c(),  0x3e);
        EXPECT(gbc.d(),  0x56);
        EXPECT(gbc.e(),  0x63);
        EXPECT(gbc.h(),  0xf3);
        EXPECT(gbc.l(),  0x90);
        EXPECT(gbc.sp(), 0x99ed);
        EXPECT(gbc.pc(), 0x396);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0165
        gbc.setState(0x6a6, 0x792b, 0xc900, 0x34d, 0x53bd, 0xb40c, 0x0, 0x1);
        gbc.writeMem(0x6a6, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0x3);
        EXPECT(gbc.c(),  0x4d);
        EXPECT(gbc.d(),  0x53);
        EXPECT(gbc.e(),  0xbd);
        EXPECT(gbc.h(),  0xb4);
        EXPECT(gbc.l(),  0xc);
        EXPECT(gbc.sp(), 0x792b);
        EXPECT(gbc.pc(), 0x6a7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0166
        gbc.setState(0x55e0, 0x1c9d, 0xba30, 0x24f6, 0x2485, 0x60ce, 0x0, 0x0);
        gbc.writeMem(0x55e0, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0x24);
        EXPECT(gbc.c(),  0xf6);
        EXPECT(gbc.d(),  0x24);
        EXPECT(gbc.e(),  0x85);
        EXPECT(gbc.h(),  0x60);
        EXPECT(gbc.l(),  0xce);
        EXPECT(gbc.sp(), 0x1c9d);
        EXPECT(gbc.pc(), 0x55e1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0167
        gbc.setState(0x77d7, 0x8a99, 0x9b60, 0xaebd, 0xff65, 0x4c9a, 0x0, 0x1);
        gbc.writeMem(0x77d7, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0xae);
        EXPECT(gbc.c(),  0xbd);
        EXPECT(gbc.d(),  0xff);
        EXPECT(gbc.e(),  0x65);
        EXPECT(gbc.h(),  0x4c);
        EXPECT(gbc.l(),  0x9a);
        EXPECT(gbc.sp(), 0x8a99);
        EXPECT(gbc.pc(), 0x77d8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0168
        gbc.setState(0x7522, 0x39a1, 0x4900, 0x287e, 0x304a, 0x8c09, 0x0, 0x0);
        gbc.writeMem(0x7522, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0x28);
        EXPECT(gbc.c(),  0x7e);
        EXPECT(gbc.d(),  0x30);
        EXPECT(gbc.e(),  0x4a);
        EXPECT(gbc.h(),  0x8c);
        EXPECT(gbc.l(),  0x9);
        EXPECT(gbc.sp(), 0x39a1);
        EXPECT(gbc.pc(), 0x7523);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 016A
        gbc.setState(0x24bd, 0xe1ae, 0x2ab0, 0xf44a, 0x9b37, 0xf078, 0x1, 0x0);
        gbc.writeMem(0x24bd, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0xf4);
        EXPECT(gbc.c(),  0x4a);
        EXPECT(gbc.d(),  0x9b);
        EXPECT(gbc.e(),  0x37);
        EXPECT(gbc.h(),  0xf0);
        EXPECT(gbc.l(),  0x78);
        EXPECT(gbc.sp(), 0xe1ae);
        EXPECT(gbc.pc(), 0x24be);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 016B
        gbc.setState(0x9426, 0xdfd9, 0x1470, 0xdb8c, 0x2ab5, 0x23cb, 0x0, 0x1);
        gbc.writeMem(0x9426, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0xdb);
        EXPECT(gbc.c(),  0x8c);
        EXPECT(gbc.d(),  0x2a);
        EXPECT(gbc.e(),  0xb5);
        EXPECT(gbc.h(),  0x23);
        EXPECT(gbc.l(),  0xcb);
        EXPECT(gbc.sp(), 0xdfd9);
        EXPECT(gbc.pc(), 0x9427);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9426), 0xa4);
        // A4 016D
        gbc.setState(0x35e2, 0x8c68, 0x2330, 0x399c, 0xaf38, 0x3b24, 0x1, 0x0);
        gbc.writeMem(0x35e2, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x23);
        EXPECT(gbc.b(),  0x39);
        EXPECT(gbc.c(),  0x9c);
        EXPECT(gbc.d(),  0xaf);
        EXPECT(gbc.e(),  0x38);
        EXPECT(gbc.h(),  0x3b);
        EXPECT(gbc.l(),  0x24);
        EXPECT(gbc.sp(), 0x8c68);
        EXPECT(gbc.pc(), 0x35e3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 016E
        gbc.setState(0x9f3c, 0x3eed, 0x1ce0, 0xaf18, 0x3cc0, 0x5150, 0x1, 0x1);
        gbc.writeMem(0x9f3c, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0xaf);
        EXPECT(gbc.c(),  0x18);
        EXPECT(gbc.d(),  0x3c);
        EXPECT(gbc.e(),  0xc0);
        EXPECT(gbc.h(),  0x51);
        EXPECT(gbc.l(),  0x50);
        EXPECT(gbc.sp(), 0x3eed);
        EXPECT(gbc.pc(), 0x9f3d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9f3c), 0xa4);
        // A4 016F
        gbc.setState(0x2d61, 0xed78, 0x6f80, 0x4b7d, 0xd48d, 0x4724, 0x1, 0x1);
        gbc.writeMem(0x2d61, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x47);
        EXPECT(gbc.b(),  0x4b);
        EXPECT(gbc.c(),  0x7d);
        EXPECT(gbc.d(),  0xd4);
        EXPECT(gbc.e(),  0x8d);
        EXPECT(gbc.h(),  0x47);
        EXPECT(gbc.l(),  0x24);
        EXPECT(gbc.sp(), 0xed78);
        EXPECT(gbc.pc(), 0x2d62);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0170
        gbc.setState(0xb931, 0x7b95, 0x4e30, 0xf719, 0x777e, 0xba09, 0x0, 0x1);
        gbc.writeMem(0xb931, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa);
        EXPECT(gbc.b(),  0xf7);
        EXPECT(gbc.c(),  0x19);
        EXPECT(gbc.d(),  0x77);
        EXPECT(gbc.e(),  0x7e);
        EXPECT(gbc.h(),  0xba);
        EXPECT(gbc.l(),  0x9);
        EXPECT(gbc.sp(), 0x7b95);
        EXPECT(gbc.pc(), 0xb932);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb931), 0xa4);
        // A4 0171
        gbc.setState(0x1cb2, 0xedf8, 0x23c0, 0xe77e, 0x6c9c, 0x8b19, 0x0, 0x1);
        gbc.writeMem(0x1cb2, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3);
        EXPECT(gbc.b(),  0xe7);
        EXPECT(gbc.c(),  0x7e);
        EXPECT(gbc.d(),  0x6c);
        EXPECT(gbc.e(),  0x9c);
        EXPECT(gbc.h(),  0x8b);
        EXPECT(gbc.l(),  0x19);
        EXPECT(gbc.sp(), 0xedf8);
        EXPECT(gbc.pc(), 0x1cb3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0172
        gbc.setState(0x8285, 0xe5eb, 0xa20, 0x7444, 0xbf7e, 0xdb52, 0x0, 0x1);
        gbc.writeMem(0x8285, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa);
        EXPECT(gbc.b(),  0x74);
        EXPECT(gbc.c(),  0x44);
        EXPECT(gbc.d(),  0xbf);
        EXPECT(gbc.e(),  0x7e);
        EXPECT(gbc.h(),  0xdb);
        EXPECT(gbc.l(),  0x52);
        EXPECT(gbc.sp(), 0xe5eb);
        EXPECT(gbc.pc(), 0x8286);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8285), 0xa4);
        // A4 0173
        gbc.setState(0xea00, 0x7a6c, 0x1d90, 0x5d85, 0x97bf, 0x53df, 0x1, 0x1);
        gbc.writeMem(0xea00, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x11);
        EXPECT(gbc.b(),  0x5d);
        EXPECT(gbc.c(),  0x85);
        EXPECT(gbc.d(),  0x97);
        EXPECT(gbc.e(),  0xbf);
        EXPECT(gbc.h(),  0x53);
        EXPECT(gbc.l(),  0xdf);
        EXPECT(gbc.sp(), 0x7a6c);
        EXPECT(gbc.pc(), 0xea01);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xea00), 0xa4);
        // A4 0174
        gbc.setState(0xee5f, 0x9506, 0x5470, 0x34ca, 0xaa9a, 0x20b8, 0x0, 0x1);
        gbc.writeMem(0xee5f, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x34);
        EXPECT(gbc.c(),  0xca);
        EXPECT(gbc.d(),  0xaa);
        EXPECT(gbc.e(),  0x9a);
        EXPECT(gbc.h(),  0x20);
        EXPECT(gbc.l(),  0xb8);
        EXPECT(gbc.sp(), 0x9506);
        EXPECT(gbc.pc(), 0xee60);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xee5f), 0xa4);
        // A4 0175
        gbc.setState(0xd534, 0x4177, 0x1760, 0x7f88, 0x2e08, 0x4d26, 0x1, 0x1);
        gbc.writeMem(0xd534, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x5);
        EXPECT(gbc.b(),  0x7f);
        EXPECT(gbc.c(),  0x88);
        EXPECT(gbc.d(),  0x2e);
        EXPECT(gbc.e(),  0x8);
        EXPECT(gbc.h(),  0x4d);
        EXPECT(gbc.l(),  0x26);
        EXPECT(gbc.sp(), 0x4177);
        EXPECT(gbc.pc(), 0xd535);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd534), 0xa4);
        // A4 0177
        gbc.setState(0x645d, 0x610c, 0xda70, 0x9b55, 0xa719, 0x311a, 0x0, 0x0);
        gbc.writeMem(0x645d, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0x9b);
        EXPECT(gbc.c(),  0x55);
        EXPECT(gbc.d(),  0xa7);
        EXPECT(gbc.e(),  0x19);
        EXPECT(gbc.h(),  0x31);
        EXPECT(gbc.l(),  0x1a);
        EXPECT(gbc.sp(), 0x610c);
        EXPECT(gbc.pc(), 0x645e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0178
        gbc.setState(0x7092, 0x299e, 0x20b0, 0x33a5, 0x9627, 0x69ef, 0x1, 0x1);
        gbc.writeMem(0x7092, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0x33);
        EXPECT(gbc.c(),  0xa5);
        EXPECT(gbc.d(),  0x96);
        EXPECT(gbc.e(),  0x27);
        EXPECT(gbc.h(),  0x69);
        EXPECT(gbc.l(),  0xef);
        EXPECT(gbc.sp(), 0x299e);
        EXPECT(gbc.pc(), 0x7093);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0179
        gbc.setState(0x1320, 0x459d, 0x7290, 0xe95, 0x758, 0xd9c1, 0x0, 0x0);
        gbc.writeMem(0x1320, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x50);
        EXPECT(gbc.b(),  0xe);
        EXPECT(gbc.c(),  0x95);
        EXPECT(gbc.d(),  0x7);
        EXPECT(gbc.e(),  0x58);
        EXPECT(gbc.h(),  0xd9);
        EXPECT(gbc.l(),  0xc1);
        EXPECT(gbc.sp(), 0x459d);
        EXPECT(gbc.pc(), 0x1321);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 017A
        gbc.setState(0x93e0, 0x6aa0, 0x9530, 0xb92, 0x9d2b, 0x7602, 0x0, 0x0);
        gbc.writeMem(0x93e0, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x14);
        EXPECT(gbc.b(),  0xb);
        EXPECT(gbc.c(),  0x92);
        EXPECT(gbc.d(),  0x9d);
        EXPECT(gbc.e(),  0x2b);
        EXPECT(gbc.h(),  0x76);
        EXPECT(gbc.l(),  0x2);
        EXPECT(gbc.sp(), 0x6aa0);
        EXPECT(gbc.pc(), 0x93e1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x93e0), 0xa4);
        // A4 017B
        gbc.setState(0x5f22, 0x8c23, 0xcf60, 0xe6b4, 0x837, 0xe828, 0x1, 0x1);
        gbc.writeMem(0x5f22, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc8);
        EXPECT(gbc.b(),  0xe6);
        EXPECT(gbc.c(),  0xb4);
        EXPECT(gbc.d(),  0x8);
        EXPECT(gbc.e(),  0x37);
        EXPECT(gbc.h(),  0xe8);
        EXPECT(gbc.l(),  0x28);
        EXPECT(gbc.sp(), 0x8c23);
        EXPECT(gbc.pc(), 0x5f23);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 017C
        gbc.setState(0xb4d6, 0x6198, 0xf230, 0xac0c, 0x32a2, 0x67a9, 0x1, 0x1);
        gbc.writeMem(0xb4d6, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x62);
        EXPECT(gbc.b(),  0xac);
        EXPECT(gbc.c(),  0xc);
        EXPECT(gbc.d(),  0x32);
        EXPECT(gbc.e(),  0xa2);
        EXPECT(gbc.h(),  0x67);
        EXPECT(gbc.l(),  0xa9);
        EXPECT(gbc.sp(), 0x6198);
        EXPECT(gbc.pc(), 0xb4d7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb4d6), 0xa4);
        // A4 017D
        gbc.setState(0xa258, 0x34f2, 0xc340, 0x9f02, 0x1f8d, 0x8877, 0x1, 0x0);
        gbc.writeMem(0xa258, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0x9f);
        EXPECT(gbc.c(),  0x2);
        EXPECT(gbc.d(),  0x1f);
        EXPECT(gbc.e(),  0x8d);
        EXPECT(gbc.h(),  0x88);
        EXPECT(gbc.l(),  0x77);
        EXPECT(gbc.sp(), 0x34f2);
        EXPECT(gbc.pc(), 0xa259);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa258), 0xa4);
        // A4 017E
        gbc.setState(0x48df, 0x690c, 0xb3b0, 0xbdfb, 0x1002, 0xa698, 0x0, 0x1);
        gbc.writeMem(0x48df, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa2);
        EXPECT(gbc.b(),  0xbd);
        EXPECT(gbc.c(),  0xfb);
        EXPECT(gbc.d(),  0x10);
        EXPECT(gbc.e(),  0x2);
        EXPECT(gbc.h(),  0xa6);
        EXPECT(gbc.l(),  0x98);
        EXPECT(gbc.sp(), 0x690c);
        EXPECT(gbc.pc(), 0x48e0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 017F
        gbc.setState(0xc850, 0x15d8, 0x3c20, 0x8805, 0x9ce0, 0xc4d6, 0x1, 0x0);
        gbc.writeMem(0xc850, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0x88);
        EXPECT(gbc.c(),  0x5);
        EXPECT(gbc.d(),  0x9c);
        EXPECT(gbc.e(),  0xe0);
        EXPECT(gbc.h(),  0xc4);
        EXPECT(gbc.l(),  0xd6);
        EXPECT(gbc.sp(), 0x15d8);
        EXPECT(gbc.pc(), 0xc851);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc850), 0xa4);
        // A4 0180
        gbc.setState(0xe36b, 0x98ea, 0x5e20, 0x2688, 0x3057, 0xad94, 0x1, 0x1);
        gbc.writeMem(0xe36b, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc);
        EXPECT(gbc.b(),  0x26);
        EXPECT(gbc.c(),  0x88);
        EXPECT(gbc.d(),  0x30);
        EXPECT(gbc.e(),  0x57);
        EXPECT(gbc.h(),  0xad);
        EXPECT(gbc.l(),  0x94);
        EXPECT(gbc.sp(), 0x98ea);
        EXPECT(gbc.pc(), 0xe36c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe36b), 0xa4);
        // A4 0181
        gbc.setState(0xd68c, 0x764, 0xb860, 0x7d69, 0xbd7b, 0xeb1c, 0x0, 0x1);
        gbc.writeMem(0xd68c, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa8);
        EXPECT(gbc.b(),  0x7d);
        EXPECT(gbc.c(),  0x69);
        EXPECT(gbc.d(),  0xbd);
        EXPECT(gbc.e(),  0x7b);
        EXPECT(gbc.h(),  0xeb);
        EXPECT(gbc.l(),  0x1c);
        EXPECT(gbc.sp(), 0x764);
        EXPECT(gbc.pc(), 0xd68d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd68c), 0xa4);
        // A4 0182
        gbc.setState(0x33c0, 0x76cd, 0xfe30, 0x660c, 0x1e2f, 0xaa1f, 0x1, 0x1);
        gbc.writeMem(0x33c0, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xaa);
        EXPECT(gbc.b(),  0x66);
        EXPECT(gbc.c(),  0xc);
        EXPECT(gbc.d(),  0x1e);
        EXPECT(gbc.e(),  0x2f);
        EXPECT(gbc.h(),  0xaa);
        EXPECT(gbc.l(),  0x1f);
        EXPECT(gbc.sp(), 0x76cd);
        EXPECT(gbc.pc(), 0x33c1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0183
        gbc.setState(0x4463, 0xe291, 0xb8e0, 0x1218, 0xddd2, 0xa69e, 0x1, 0x1);
        gbc.writeMem(0x4463, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa0);
        EXPECT(gbc.b(),  0x12);
        EXPECT(gbc.c(),  0x18);
        EXPECT(gbc.d(),  0xdd);
        EXPECT(gbc.e(),  0xd2);
        EXPECT(gbc.h(),  0xa6);
        EXPECT(gbc.l(),  0x9e);
        EXPECT(gbc.sp(), 0xe291);
        EXPECT(gbc.pc(), 0x4464);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0184
        gbc.setState(0xaa35, 0xeeb0, 0xe080, 0xc1ba, 0xb0e, 0x44f6, 0x1, 0x1);
        gbc.writeMem(0xaa35, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0xc1);
        EXPECT(gbc.c(),  0xba);
        EXPECT(gbc.d(),  0xb);
        EXPECT(gbc.e(),  0xe);
        EXPECT(gbc.h(),  0x44);
        EXPECT(gbc.l(),  0xf6);
        EXPECT(gbc.sp(), 0xeeb0);
        EXPECT(gbc.pc(), 0xaa36);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xaa35), 0xa4);
        // A4 0185
        gbc.setState(0x8942, 0x79bb, 0xcc20, 0xd210, 0x7c1a, 0x5068, 0x1, 0x0);
        gbc.writeMem(0x8942, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0xd2);
        EXPECT(gbc.c(),  0x10);
        EXPECT(gbc.d(),  0x7c);
        EXPECT(gbc.e(),  0x1a);
        EXPECT(gbc.h(),  0x50);
        EXPECT(gbc.l(),  0x68);
        EXPECT(gbc.sp(), 0x79bb);
        EXPECT(gbc.pc(), 0x8943);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8942), 0xa4);
        // A4 0186
        gbc.setState(0x1b2a, 0x643d, 0xab60, 0xc9e, 0x1bb1, 0x39e2, 0x1, 0x1);
        gbc.writeMem(0x1b2a, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x29);
        EXPECT(gbc.b(),  0xc);
        EXPECT(gbc.c(),  0x9e);
        EXPECT(gbc.d(),  0x1b);
        EXPECT(gbc.e(),  0xb1);
        EXPECT(gbc.h(),  0x39);
        EXPECT(gbc.l(),  0xe2);
        EXPECT(gbc.sp(), 0x643d);
        EXPECT(gbc.pc(), 0x1b2b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0187
        gbc.setState(0x436b, 0xa513, 0x5510, 0x385a, 0x680a, 0xec60, 0x0, 0x1);
        gbc.writeMem(0x436b, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x44);
        EXPECT(gbc.b(),  0x38);
        EXPECT(gbc.c(),  0x5a);
        EXPECT(gbc.d(),  0x68);
        EXPECT(gbc.e(),  0xa);
        EXPECT(gbc.h(),  0xec);
        EXPECT(gbc.l(),  0x60);
        EXPECT(gbc.sp(), 0xa513);
        EXPECT(gbc.pc(), 0x436c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0188
        gbc.setState(0x7497, 0x982b, 0x6d30, 0x3c28, 0x1b71, 0xcd83, 0x1, 0x0);
        gbc.writeMem(0x7497, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4d);
        EXPECT(gbc.b(),  0x3c);
        EXPECT(gbc.c(),  0x28);
        EXPECT(gbc.d(),  0x1b);
        EXPECT(gbc.e(),  0x71);
        EXPECT(gbc.h(),  0xcd);
        EXPECT(gbc.l(),  0x83);
        EXPECT(gbc.sp(), 0x982b);
        EXPECT(gbc.pc(), 0x7498);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0189
        gbc.setState(0x66a7, 0x6504, 0x71b0, 0x25ae, 0x1b85, 0xa814, 0x1, 0x0);
        gbc.writeMem(0x66a7, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0x25);
        EXPECT(gbc.c(),  0xae);
        EXPECT(gbc.d(),  0x1b);
        EXPECT(gbc.e(),  0x85);
        EXPECT(gbc.h(),  0xa8);
        EXPECT(gbc.l(),  0x14);
        EXPECT(gbc.sp(), 0x6504);
        EXPECT(gbc.pc(), 0x66a8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 018A
        gbc.setState(0x880f, 0xa64c, 0x2ed0, 0xfdc0, 0x4c1e, 0xdc3c, 0x1, 0x1);
        gbc.writeMem(0x880f, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc);
        EXPECT(gbc.b(),  0xfd);
        EXPECT(gbc.c(),  0xc0);
        EXPECT(gbc.d(),  0x4c);
        EXPECT(gbc.e(),  0x1e);
        EXPECT(gbc.h(),  0xdc);
        EXPECT(gbc.l(),  0x3c);
        EXPECT(gbc.sp(), 0xa64c);
        EXPECT(gbc.pc(), 0x8810);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x880f), 0xa4);
        // A4 018B
        gbc.setState(0xc311, 0x454a, 0x45c0, 0xde6, 0x27a0, 0x87d1, 0x0, 0x0);
        gbc.writeMem(0xc311, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x5);
        EXPECT(gbc.b(),  0xd);
        EXPECT(gbc.c(),  0xe6);
        EXPECT(gbc.d(),  0x27);
        EXPECT(gbc.e(),  0xa0);
        EXPECT(gbc.h(),  0x87);
        EXPECT(gbc.l(),  0xd1);
        EXPECT(gbc.sp(), 0x454a);
        EXPECT(gbc.pc(), 0xc312);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc311), 0xa4);
        // A4 018C
        gbc.setState(0xa9b3, 0xda72, 0x1100, 0x636, 0xe02a, 0x7da0, 0x1, 0x0);
        gbc.writeMem(0xa9b3, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x11);
        EXPECT(gbc.b(),  0x6);
        EXPECT(gbc.c(),  0x36);
        EXPECT(gbc.d(),  0xe0);
        EXPECT(gbc.e(),  0x2a);
        EXPECT(gbc.h(),  0x7d);
        EXPECT(gbc.l(),  0xa0);
        EXPECT(gbc.sp(), 0xda72);
        EXPECT(gbc.pc(), 0xa9b4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa9b3), 0xa4);
        // A4 018D
        gbc.setState(0x27bd, 0xde01, 0xdad0, 0xa5ea, 0x2f91, 0xe281, 0x0, 0x1);
        gbc.writeMem(0x27bd, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc2);
        EXPECT(gbc.b(),  0xa5);
        EXPECT(gbc.c(),  0xea);
        EXPECT(gbc.d(),  0x2f);
        EXPECT(gbc.e(),  0x91);
        EXPECT(gbc.h(),  0xe2);
        EXPECT(gbc.l(),  0x81);
        EXPECT(gbc.sp(), 0xde01);
        EXPECT(gbc.pc(), 0x27be);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 018E
        gbc.setState(0x5126, 0x7eef, 0x2170, 0xcf45, 0xb713, 0xcbca, 0x1, 0x0);
        gbc.writeMem(0x5126, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0xcf);
        EXPECT(gbc.c(),  0x45);
        EXPECT(gbc.d(),  0xb7);
        EXPECT(gbc.e(),  0x13);
        EXPECT(gbc.h(),  0xcb);
        EXPECT(gbc.l(),  0xca);
        EXPECT(gbc.sp(), 0x7eef);
        EXPECT(gbc.pc(), 0x5127);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 018F
        gbc.setState(0xb105, 0x57da, 0x6be0, 0x1552, 0x3380, 0xd616, 0x1, 0x1);
        gbc.writeMem(0xb105, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x42);
        EXPECT(gbc.b(),  0x15);
        EXPECT(gbc.c(),  0x52);
        EXPECT(gbc.d(),  0x33);
        EXPECT(gbc.e(),  0x80);
        EXPECT(gbc.h(),  0xd6);
        EXPECT(gbc.l(),  0x16);
        EXPECT(gbc.sp(), 0x57da);
        EXPECT(gbc.pc(), 0xb106);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb105), 0xa4);
        // A4 0190
        gbc.setState(0x3c2b, 0x1e1e, 0xe330, 0x1307, 0xd845, 0x2ba5, 0x0, 0x1);
        gbc.writeMem(0x3c2b, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x23);
        EXPECT(gbc.b(),  0x13);
        EXPECT(gbc.c(),  0x7);
        EXPECT(gbc.d(),  0xd8);
        EXPECT(gbc.e(),  0x45);
        EXPECT(gbc.h(),  0x2b);
        EXPECT(gbc.l(),  0xa5);
        EXPECT(gbc.sp(), 0x1e1e);
        EXPECT(gbc.pc(), 0x3c2c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0191
        gbc.setState(0x9951, 0x25f2, 0xfc40, 0x41d, 0xb582, 0x86b6, 0x0, 0x1);
        gbc.writeMem(0x9951, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x84);
        EXPECT(gbc.b(),  0x4);
        EXPECT(gbc.c(),  0x1d);
        EXPECT(gbc.d(),  0xb5);
        EXPECT(gbc.e(),  0x82);
        EXPECT(gbc.h(),  0x86);
        EXPECT(gbc.l(),  0xb6);
        EXPECT(gbc.sp(), 0x25f2);
        EXPECT(gbc.pc(), 0x9952);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9951), 0xa4);
        // A4 0192
        gbc.setState(0x9685, 0xcb04, 0xead0, 0xa489, 0x395c, 0x2442, 0x1, 0x0);
        gbc.writeMem(0x9685, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0xa4);
        EXPECT(gbc.c(),  0x89);
        EXPECT(gbc.d(),  0x39);
        EXPECT(gbc.e(),  0x5c);
        EXPECT(gbc.h(),  0x24);
        EXPECT(gbc.l(),  0x42);
        EXPECT(gbc.sp(), 0xcb04);
        EXPECT(gbc.pc(), 0x9686);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9685), 0xa4);
        // A4 0193
        gbc.setState(0xc3c, 0x361c, 0xd2b0, 0x1d03, 0x69b8, 0x34f5, 0x0, 0x1);
        gbc.writeMem(0xc3c, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0x1d);
        EXPECT(gbc.c(),  0x3);
        EXPECT(gbc.d(),  0x69);
        EXPECT(gbc.e(),  0xb8);
        EXPECT(gbc.h(),  0x34);
        EXPECT(gbc.l(),  0xf5);
        EXPECT(gbc.sp(), 0x361c);
        EXPECT(gbc.pc(), 0xc3d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0194
        gbc.setState(0xb542, 0x14dc, 0xc7a0, 0x1e2b, 0xe80e, 0xc6f, 0x1, 0x1);
        gbc.writeMem(0xb542, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0x1e);
        EXPECT(gbc.c(),  0x2b);
        EXPECT(gbc.d(),  0xe8);
        EXPECT(gbc.e(),  0xe);
        EXPECT(gbc.h(),  0xc);
        EXPECT(gbc.l(),  0x6f);
        EXPECT(gbc.sp(), 0x14dc);
        EXPECT(gbc.pc(), 0xb543);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb542), 0xa4);
        // A4 0195
        gbc.setState(0x4023, 0x648, 0xd40, 0x7092, 0x6cfb, 0x6d84, 0x1, 0x1);
        gbc.writeMem(0x4023, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd);
        EXPECT(gbc.b(),  0x70);
        EXPECT(gbc.c(),  0x92);
        EXPECT(gbc.d(),  0x6c);
        EXPECT(gbc.e(),  0xfb);
        EXPECT(gbc.h(),  0x6d);
        EXPECT(gbc.l(),  0x84);
        EXPECT(gbc.sp(), 0x648);
        EXPECT(gbc.pc(), 0x4024);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0196
        gbc.setState(0xcc5e, 0x4e45, 0x6990, 0x7a84, 0x792, 0x36ba, 0x1, 0x0);
        gbc.writeMem(0xcc5e, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0x7a);
        EXPECT(gbc.c(),  0x84);
        EXPECT(gbc.d(),  0x7);
        EXPECT(gbc.e(),  0x92);
        EXPECT(gbc.h(),  0x36);
        EXPECT(gbc.l(),  0xba);
        EXPECT(gbc.sp(), 0x4e45);
        EXPECT(gbc.pc(), 0xcc5f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcc5e), 0xa4);
        // A4 0197
        gbc.setState(0x19a6, 0xf888, 0xea90, 0x1d89, 0x40a3, 0x3db6, 0x0, 0x0);
        gbc.writeMem(0x19a6, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0x1d);
        EXPECT(gbc.c(),  0x89);
        EXPECT(gbc.d(),  0x40);
        EXPECT(gbc.e(),  0xa3);
        EXPECT(gbc.h(),  0x3d);
        EXPECT(gbc.l(),  0xb6);
        EXPECT(gbc.sp(), 0xf888);
        EXPECT(gbc.pc(), 0x19a7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0198
        gbc.setState(0x8b96, 0x95d7, 0x95e0, 0x5e2f, 0x2f5, 0x9803, 0x0, 0x0);
        gbc.writeMem(0x8b96, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x90);
        EXPECT(gbc.b(),  0x5e);
        EXPECT(gbc.c(),  0x2f);
        EXPECT(gbc.d(),  0x2);
        EXPECT(gbc.e(),  0xf5);
        EXPECT(gbc.h(),  0x98);
        EXPECT(gbc.l(),  0x3);
        EXPECT(gbc.sp(), 0x95d7);
        EXPECT(gbc.pc(), 0x8b97);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8b96), 0xa4);
        // A4 0199
        gbc.setState(0xe3e3, 0x9bcb, 0xfdc0, 0xd0e5, 0xe70, 0x4229, 0x0, 0x1);
        gbc.writeMem(0xe3e3, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0xd0);
        EXPECT(gbc.c(),  0xe5);
        EXPECT(gbc.d(),  0xe);
        EXPECT(gbc.e(),  0x70);
        EXPECT(gbc.h(),  0x42);
        EXPECT(gbc.l(),  0x29);
        EXPECT(gbc.sp(), 0x9bcb);
        EXPECT(gbc.pc(), 0xe3e4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe3e3), 0xa4);
        // A4 019A
        gbc.setState(0xb439, 0xc91f, 0x4d00, 0xce3d, 0x5db8, 0x3b0, 0x1, 0x1);
        gbc.writeMem(0xb439, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0xce);
        EXPECT(gbc.c(),  0x3d);
        EXPECT(gbc.d(),  0x5d);
        EXPECT(gbc.e(),  0xb8);
        EXPECT(gbc.h(),  0x3);
        EXPECT(gbc.l(),  0xb0);
        EXPECT(gbc.sp(), 0xc91f);
        EXPECT(gbc.pc(), 0xb43a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb439), 0xa4);
        // A4 019B
        gbc.setState(0x2bb4, 0x4eae, 0x4440, 0xb1bc, 0x7609, 0x5a8a, 0x1, 0x1);
        gbc.writeMem(0x2bb4, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0xb1);
        EXPECT(gbc.c(),  0xbc);
        EXPECT(gbc.d(),  0x76);
        EXPECT(gbc.e(),  0x9);
        EXPECT(gbc.h(),  0x5a);
        EXPECT(gbc.l(),  0x8a);
        EXPECT(gbc.sp(), 0x4eae);
        EXPECT(gbc.pc(), 0x2bb5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 019C
        gbc.setState(0x5d83, 0xa78c, 0xf480, 0xb40, 0x6808, 0x30df, 0x0, 0x1);
        gbc.writeMem(0x5d83, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x30);
        EXPECT(gbc.b(),  0xb);
        EXPECT(gbc.c(),  0x40);
        EXPECT(gbc.d(),  0x68);
        EXPECT(gbc.e(),  0x8);
        EXPECT(gbc.h(),  0x30);
        EXPECT(gbc.l(),  0xdf);
        EXPECT(gbc.sp(), 0xa78c);
        EXPECT(gbc.pc(), 0x5d84);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 019D
        gbc.setState(0xb57f, 0x3c61, 0x48f0, 0xba75, 0x67be, 0xefc2, 0x1, 0x0);
        gbc.writeMem(0xb57f, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x48);
        EXPECT(gbc.b(),  0xba);
        EXPECT(gbc.c(),  0x75);
        EXPECT(gbc.d(),  0x67);
        EXPECT(gbc.e(),  0xbe);
        EXPECT(gbc.h(),  0xef);
        EXPECT(gbc.l(),  0xc2);
        EXPECT(gbc.sp(), 0x3c61);
        EXPECT(gbc.pc(), 0xb580);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb57f), 0xa4);
        // A4 019E
        gbc.setState(0x85ff, 0xc85e, 0x55b0, 0x7765, 0x1901, 0x538f, 0x1, 0x1);
        gbc.writeMem(0x85ff, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x51);
        EXPECT(gbc.b(),  0x77);
        EXPECT(gbc.c(),  0x65);
        EXPECT(gbc.d(),  0x19);
        EXPECT(gbc.e(),  0x1);
        EXPECT(gbc.h(),  0x53);
        EXPECT(gbc.l(),  0x8f);
        EXPECT(gbc.sp(), 0xc85e);
        EXPECT(gbc.pc(), 0x8600);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x85ff), 0xa4);
        // A4 019F
        gbc.setState(0xbae2, 0x670b, 0x5f90, 0x8019, 0x862, 0x4ce2, 0x1, 0x1);
        gbc.writeMem(0xbae2, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4c);
        EXPECT(gbc.b(),  0x80);
        EXPECT(gbc.c(),  0x19);
        EXPECT(gbc.d(),  0x8);
        EXPECT(gbc.e(),  0x62);
        EXPECT(gbc.h(),  0x4c);
        EXPECT(gbc.l(),  0xe2);
        EXPECT(gbc.sp(), 0x670b);
        EXPECT(gbc.pc(), 0xbae3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbae2), 0xa4);
        // A4 01A0
        gbc.setState(0xc9fd, 0x7836, 0xf920, 0xb301, 0xc209, 0x6976, 0x1, 0x1);
        gbc.writeMem(0xc9fd, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x69);
        EXPECT(gbc.b(),  0xb3);
        EXPECT(gbc.c(),  0x1);
        EXPECT(gbc.d(),  0xc2);
        EXPECT(gbc.e(),  0x9);
        EXPECT(gbc.h(),  0x69);
        EXPECT(gbc.l(),  0x76);
        EXPECT(gbc.sp(), 0x7836);
        EXPECT(gbc.pc(), 0xc9fe);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc9fd), 0xa4);
        // A4 01A1
        gbc.setState(0x9f35, 0xad53, 0x26c0, 0xd416, 0xccae, 0x85cb, 0x1, 0x0);
        gbc.writeMem(0x9f35, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0xd4);
        EXPECT(gbc.c(),  0x16);
        EXPECT(gbc.d(),  0xcc);
        EXPECT(gbc.e(),  0xae);
        EXPECT(gbc.h(),  0x85);
        EXPECT(gbc.l(),  0xcb);
        EXPECT(gbc.sp(), 0xad53);
        EXPECT(gbc.pc(), 0x9f36);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9f35), 0xa4);
        // A4 01A2
        gbc.setState(0xb938, 0x8676, 0xf040, 0x52e2, 0xb423, 0xf76c, 0x0, 0x0);
        gbc.writeMem(0xb938, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf0);
        EXPECT(gbc.b(),  0x52);
        EXPECT(gbc.c(),  0xe2);
        EXPECT(gbc.d(),  0xb4);
        EXPECT(gbc.e(),  0x23);
        EXPECT(gbc.h(),  0xf7);
        EXPECT(gbc.l(),  0x6c);
        EXPECT(gbc.sp(), 0x8676);
        EXPECT(gbc.pc(), 0xb939);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb938), 0xa4);
        // A4 01A3
        gbc.setState(0x7fb5, 0x4b09, 0x30b0, 0x9443, 0x9af6, 0x4141, 0x1, 0x1);
        gbc.writeMem(0x7fb5, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x94);
        EXPECT(gbc.c(),  0x43);
        EXPECT(gbc.d(),  0x9a);
        EXPECT(gbc.e(),  0xf6);
        EXPECT(gbc.h(),  0x41);
        EXPECT(gbc.l(),  0x41);
        EXPECT(gbc.sp(), 0x4b09);
        EXPECT(gbc.pc(), 0x7fb6);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01A4
        gbc.setState(0x596b, 0xf524, 0x64b0, 0xeb97, 0xbfd3, 0x6074, 0x0, 0x1);
        gbc.writeMem(0x596b, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x60);
        EXPECT(gbc.b(),  0xeb);
        EXPECT(gbc.c(),  0x97);
        EXPECT(gbc.d(),  0xbf);
        EXPECT(gbc.e(),  0xd3);
        EXPECT(gbc.h(),  0x60);
        EXPECT(gbc.l(),  0x74);
        EXPECT(gbc.sp(), 0xf524);
        EXPECT(gbc.pc(), 0x596c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01A5
        gbc.setState(0x4d82, 0x2e89, 0x9450, 0xf6ea, 0xe83a, 0xf37e, 0x0, 0x1);
        gbc.writeMem(0x4d82, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x90);
        EXPECT(gbc.b(),  0xf6);
        EXPECT(gbc.c(),  0xea);
        EXPECT(gbc.d(),  0xe8);
        EXPECT(gbc.e(),  0x3a);
        EXPECT(gbc.h(),  0xf3);
        EXPECT(gbc.l(),  0x7e);
        EXPECT(gbc.sp(), 0x2e89);
        EXPECT(gbc.pc(), 0x4d83);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01A7
        gbc.setState(0xeae6, 0x2b55, 0x76e0, 0x648e, 0xdce8, 0x3b48, 0x1, 0x1);
        gbc.writeMem(0xeae6, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x32);
        EXPECT(gbc.b(),  0x64);
        EXPECT(gbc.c(),  0x8e);
        EXPECT(gbc.d(),  0xdc);
        EXPECT(gbc.e(),  0xe8);
        EXPECT(gbc.h(),  0x3b);
        EXPECT(gbc.l(),  0x48);
        EXPECT(gbc.sp(), 0x2b55);
        EXPECT(gbc.pc(), 0xeae7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xeae6), 0xa4);
        // A4 01A8
        gbc.setState(0x4787, 0x7287, 0xf970, 0x35c3, 0xf6ab, 0xf8e2, 0x1, 0x1);
        gbc.writeMem(0x4787, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf8);
        EXPECT(gbc.b(),  0x35);
        EXPECT(gbc.c(),  0xc3);
        EXPECT(gbc.d(),  0xf6);
        EXPECT(gbc.e(),  0xab);
        EXPECT(gbc.h(),  0xf8);
        EXPECT(gbc.l(),  0xe2);
        EXPECT(gbc.sp(), 0x7287);
        EXPECT(gbc.pc(), 0x4788);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01A9
        gbc.setState(0x3131, 0x17df, 0xa150, 0xf5cd, 0xea16, 0x6254, 0x1, 0x1);
        gbc.writeMem(0x3131, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0xf5);
        EXPECT(gbc.c(),  0xcd);
        EXPECT(gbc.d(),  0xea);
        EXPECT(gbc.e(),  0x16);
        EXPECT(gbc.h(),  0x62);
        EXPECT(gbc.l(),  0x54);
        EXPECT(gbc.sp(), 0x17df);
        EXPECT(gbc.pc(), 0x3132);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01AA
        gbc.setState(0x3dd4, 0xe8a7, 0xfee0, 0x1e8e, 0x5510, 0x1a78, 0x0, 0x0);
        gbc.writeMem(0x3dd4, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1a);
        EXPECT(gbc.b(),  0x1e);
        EXPECT(gbc.c(),  0x8e);
        EXPECT(gbc.d(),  0x55);
        EXPECT(gbc.e(),  0x10);
        EXPECT(gbc.h(),  0x1a);
        EXPECT(gbc.l(),  0x78);
        EXPECT(gbc.sp(), 0xe8a7);
        EXPECT(gbc.pc(), 0x3dd5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01AB
        gbc.setState(0xa3e1, 0x8e11, 0xb7f0, 0xd156, 0xd599, 0xb8a8, 0x1, 0x0);
        gbc.writeMem(0xa3e1, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb0);
        EXPECT(gbc.b(),  0xd1);
        EXPECT(gbc.c(),  0x56);
        EXPECT(gbc.d(),  0xd5);
        EXPECT(gbc.e(),  0x99);
        EXPECT(gbc.h(),  0xb8);
        EXPECT(gbc.l(),  0xa8);
        EXPECT(gbc.sp(), 0x8e11);
        EXPECT(gbc.pc(), 0xa3e2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa3e1), 0xa4);
        // A4 01AC
        gbc.setState(0xe8a8, 0x23ae, 0xf380, 0xa8b3, 0x2c51, 0x5fd4, 0x0, 0x0);
        gbc.writeMem(0xe8a8, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x53);
        EXPECT(gbc.b(),  0xa8);
        EXPECT(gbc.c(),  0xb3);
        EXPECT(gbc.d(),  0x2c);
        EXPECT(gbc.e(),  0x51);
        EXPECT(gbc.h(),  0x5f);
        EXPECT(gbc.l(),  0xd4);
        EXPECT(gbc.sp(), 0x23ae);
        EXPECT(gbc.pc(), 0xe8a9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe8a8), 0xa4);
        // A4 01AD
        gbc.setState(0xf96, 0xa929, 0xf260, 0x1197, 0x9a4, 0xba3c, 0x0, 0x0);
        gbc.writeMem(0xf96, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb2);
        EXPECT(gbc.b(),  0x11);
        EXPECT(gbc.c(),  0x97);
        EXPECT(gbc.d(),  0x9);
        EXPECT(gbc.e(),  0xa4);
        EXPECT(gbc.h(),  0xba);
        EXPECT(gbc.l(),  0x3c);
        EXPECT(gbc.sp(), 0xa929);
        EXPECT(gbc.pc(), 0xf97);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01AE
        gbc.setState(0xc17b, 0xb6d3, 0x9fa0, 0x42af, 0x9bd0, 0xe0dd, 0x0, 0x1);
        gbc.writeMem(0xc17b, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0x42);
        EXPECT(gbc.c(),  0xaf);
        EXPECT(gbc.d(),  0x9b);
        EXPECT(gbc.e(),  0xd0);
        EXPECT(gbc.h(),  0xe0);
        EXPECT(gbc.l(),  0xdd);
        EXPECT(gbc.sp(), 0xb6d3);
        EXPECT(gbc.pc(), 0xc17c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc17b), 0xa4);
        // A4 01AF
        gbc.setState(0x6769, 0xfdc8, 0xd700, 0xb41, 0x9ce2, 0x25df, 0x0, 0x0);
        gbc.writeMem(0x6769, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x5);
        EXPECT(gbc.b(),  0xb);
        EXPECT(gbc.c(),  0x41);
        EXPECT(gbc.d(),  0x9c);
        EXPECT(gbc.e(),  0xe2);
        EXPECT(gbc.h(),  0x25);
        EXPECT(gbc.l(),  0xdf);
        EXPECT(gbc.sp(), 0xfdc8);
        EXPECT(gbc.pc(), 0x676a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01B0
        gbc.setState(0xac16, 0x5d38, 0x8ff0, 0xcb19, 0xf391, 0x94e2, 0x0, 0x1);
        gbc.writeMem(0xac16, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x84);
        EXPECT(gbc.b(),  0xcb);
        EXPECT(gbc.c(),  0x19);
        EXPECT(gbc.d(),  0xf3);
        EXPECT(gbc.e(),  0x91);
        EXPECT(gbc.h(),  0x94);
        EXPECT(gbc.l(),  0xe2);
        EXPECT(gbc.sp(), 0x5d38);
        EXPECT(gbc.pc(), 0xac17);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xac16), 0xa4);
        // A4 01B1
        gbc.setState(0x2df2, 0x8a85, 0xfdf0, 0x95c2, 0x2cb2, 0xe617, 0x1, 0x1);
        gbc.writeMem(0x2df2, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe4);
        EXPECT(gbc.b(),  0x95);
        EXPECT(gbc.c(),  0xc2);
        EXPECT(gbc.d(),  0x2c);
        EXPECT(gbc.e(),  0xb2);
        EXPECT(gbc.h(),  0xe6);
        EXPECT(gbc.l(),  0x17);
        EXPECT(gbc.sp(), 0x8a85);
        EXPECT(gbc.pc(), 0x2df3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01B2
        gbc.setState(0x647, 0x2a5c, 0x7b00, 0xbb3a, 0xaebd, 0xfae8, 0x1, 0x0);
        gbc.writeMem(0x647, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x7a);
        EXPECT(gbc.b(),  0xbb);
        EXPECT(gbc.c(),  0x3a);
        EXPECT(gbc.d(),  0xae);
        EXPECT(gbc.e(),  0xbd);
        EXPECT(gbc.h(),  0xfa);
        EXPECT(gbc.l(),  0xe8);
        EXPECT(gbc.sp(), 0x2a5c);
        EXPECT(gbc.pc(), 0x648);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01B3
        gbc.setState(0x522a, 0x7432, 0x9160, 0x47cf, 0x53ae, 0x1b8e, 0x1, 0x1);
        gbc.writeMem(0x522a, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x11);
        EXPECT(gbc.b(),  0x47);
        EXPECT(gbc.c(),  0xcf);
        EXPECT(gbc.d(),  0x53);
        EXPECT(gbc.e(),  0xae);
        EXPECT(gbc.h(),  0x1b);
        EXPECT(gbc.l(),  0x8e);
        EXPECT(gbc.sp(), 0x7432);
        EXPECT(gbc.pc(), 0x522b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01B4
        gbc.setState(0x1455, 0x4e77, 0x6c40, 0xc0a9, 0x93ed, 0x3c72, 0x0, 0x1);
        gbc.writeMem(0x1455, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2c);
        EXPECT(gbc.b(),  0xc0);
        EXPECT(gbc.c(),  0xa9);
        EXPECT(gbc.d(),  0x93);
        EXPECT(gbc.e(),  0xed);
        EXPECT(gbc.h(),  0x3c);
        EXPECT(gbc.l(),  0x72);
        EXPECT(gbc.sp(), 0x4e77);
        EXPECT(gbc.pc(), 0x1456);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01B5
        gbc.setState(0xb24c, 0xbbee, 0xc600, 0x8c22, 0x245d, 0x31ed, 0x0, 0x0);
        gbc.writeMem(0xb24c, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x8c);
        EXPECT(gbc.c(),  0x22);
        EXPECT(gbc.d(),  0x24);
        EXPECT(gbc.e(),  0x5d);
        EXPECT(gbc.h(),  0x31);
        EXPECT(gbc.l(),  0xed);
        EXPECT(gbc.sp(), 0xbbee);
        EXPECT(gbc.pc(), 0xb24d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb24c), 0xa4);
        // A4 01B6
        gbc.setState(0xe9d8, 0x500b, 0x3210, 0x7f44, 0xe09e, 0x24fc, 0x0, 0x0);
        gbc.writeMem(0xe9d8, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0x7f);
        EXPECT(gbc.c(),  0x44);
        EXPECT(gbc.d(),  0xe0);
        EXPECT(gbc.e(),  0x9e);
        EXPECT(gbc.h(),  0x24);
        EXPECT(gbc.l(),  0xfc);
        EXPECT(gbc.sp(), 0x500b);
        EXPECT(gbc.pc(), 0xe9d9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe9d8), 0xa4);
        // A4 01B7
        gbc.setState(0xb21f, 0xf388, 0xc1e0, 0x753c, 0x6467, 0x1e42, 0x0, 0x1);
        gbc.writeMem(0xb21f, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x75);
        EXPECT(gbc.c(),  0x3c);
        EXPECT(gbc.d(),  0x64);
        EXPECT(gbc.e(),  0x67);
        EXPECT(gbc.h(),  0x1e);
        EXPECT(gbc.l(),  0x42);
        EXPECT(gbc.sp(), 0xf388);
        EXPECT(gbc.pc(), 0xb220);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb21f), 0xa4);
        // A4 01B8
        gbc.setState(0x5413, 0x425b, 0x63a0, 0x29d3, 0xc624, 0x8141, 0x0, 0x1);
        gbc.writeMem(0x5413, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0x29);
        EXPECT(gbc.c(),  0xd3);
        EXPECT(gbc.d(),  0xc6);
        EXPECT(gbc.e(),  0x24);
        EXPECT(gbc.h(),  0x81);
        EXPECT(gbc.l(),  0x41);
        EXPECT(gbc.sp(), 0x425b);
        EXPECT(gbc.pc(), 0x5414);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01B9
        gbc.setState(0x9b20, 0xe2c4, 0xda10, 0x8811, 0xab55, 0x4078, 0x0, 0x0);
        gbc.writeMem(0x9b20, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0x88);
        EXPECT(gbc.c(),  0x11);
        EXPECT(gbc.d(),  0xab);
        EXPECT(gbc.e(),  0x55);
        EXPECT(gbc.h(),  0x40);
        EXPECT(gbc.l(),  0x78);
        EXPECT(gbc.sp(), 0xe2c4);
        EXPECT(gbc.pc(), 0x9b21);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9b20), 0xa4);
        // A4 01BA
        gbc.setState(0x84c5, 0x8187, 0x2fc0, 0xc444, 0xa55c, 0xd7c6, 0x0, 0x1);
        gbc.writeMem(0x84c5, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x7);
        EXPECT(gbc.b(),  0xc4);
        EXPECT(gbc.c(),  0x44);
        EXPECT(gbc.d(),  0xa5);
        EXPECT(gbc.e(),  0x5c);
        EXPECT(gbc.h(),  0xd7);
        EXPECT(gbc.l(),  0xc6);
        EXPECT(gbc.sp(), 0x8187);
        EXPECT(gbc.pc(), 0x84c6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x84c5), 0xa4);
        // A4 01BB
        gbc.setState(0xd966, 0x2927, 0x9c90, 0x7281, 0x2a30, 0x4fde, 0x0, 0x1);
        gbc.writeMem(0xd966, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc);
        EXPECT(gbc.b(),  0x72);
        EXPECT(gbc.c(),  0x81);
        EXPECT(gbc.d(),  0x2a);
        EXPECT(gbc.e(),  0x30);
        EXPECT(gbc.h(),  0x4f);
        EXPECT(gbc.l(),  0xde);
        EXPECT(gbc.sp(), 0x2927);
        EXPECT(gbc.pc(), 0xd967);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd966), 0xa4);
        // A4 01BC
        gbc.setState(0xa512, 0x91bc, 0xc650, 0x790c, 0x1bb6, 0x180c, 0x0, 0x0);
        gbc.writeMem(0xa512, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x79);
        EXPECT(gbc.c(),  0xc);
        EXPECT(gbc.d(),  0x1b);
        EXPECT(gbc.e(),  0xb6);
        EXPECT(gbc.h(),  0x18);
        EXPECT(gbc.l(),  0xc);
        EXPECT(gbc.sp(), 0x91bc);
        EXPECT(gbc.pc(), 0xa513);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa512), 0xa4);
        // A4 01BE
        gbc.setState(0xe498, 0xc1fc, 0xf2a0, 0x7c78, 0x2d5c, 0xfc33, 0x1, 0x0);
        gbc.writeMem(0xe498, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf0);
        EXPECT(gbc.b(),  0x7c);
        EXPECT(gbc.c(),  0x78);
        EXPECT(gbc.d(),  0x2d);
        EXPECT(gbc.e(),  0x5c);
        EXPECT(gbc.h(),  0xfc);
        EXPECT(gbc.l(),  0x33);
        EXPECT(gbc.sp(), 0xc1fc);
        EXPECT(gbc.pc(), 0xe499);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe498), 0xa4);
        // A4 01BF
        gbc.setState(0x4f06, 0x6de4, 0xdd0, 0xdbd2, 0xdcbe, 0x3db0, 0x0, 0x1);
        gbc.writeMem(0x4f06, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd);
        EXPECT(gbc.b(),  0xdb);
        EXPECT(gbc.c(),  0xd2);
        EXPECT(gbc.d(),  0xdc);
        EXPECT(gbc.e(),  0xbe);
        EXPECT(gbc.h(),  0x3d);
        EXPECT(gbc.l(),  0xb0);
        EXPECT(gbc.sp(), 0x6de4);
        EXPECT(gbc.pc(), 0x4f07);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01C0
        gbc.setState(0x25d9, 0x6dd9, 0x3bb0, 0x786f, 0xecdc, 0x525c, 0x0, 0x1);
        gbc.writeMem(0x25d9, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x12);
        EXPECT(gbc.b(),  0x78);
        EXPECT(gbc.c(),  0x6f);
        EXPECT(gbc.d(),  0xec);
        EXPECT(gbc.e(),  0xdc);
        EXPECT(gbc.h(),  0x52);
        EXPECT(gbc.l(),  0x5c);
        EXPECT(gbc.sp(), 0x6dd9);
        EXPECT(gbc.pc(), 0x25da);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01C1
        gbc.setState(0x8d9d, 0xb946, 0x91c0, 0x479e, 0x8ad, 0xbce6, 0x0, 0x0);
        gbc.writeMem(0x8d9d, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x90);
        EXPECT(gbc.b(),  0x47);
        EXPECT(gbc.c(),  0x9e);
        EXPECT(gbc.d(),  0x8);
        EXPECT(gbc.e(),  0xad);
        EXPECT(gbc.h(),  0xbc);
        EXPECT(gbc.l(),  0xe6);
        EXPECT(gbc.sp(), 0xb946);
        EXPECT(gbc.pc(), 0x8d9e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8d9d), 0xa4);
        // A4 01C2
        gbc.setState(0x41d, 0xea62, 0x56f0, 0x405d, 0x850e, 0xbfd3, 0x0, 0x1);
        gbc.writeMem(0x41d, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x16);
        EXPECT(gbc.b(),  0x40);
        EXPECT(gbc.c(),  0x5d);
        EXPECT(gbc.d(),  0x85);
        EXPECT(gbc.e(),  0xe);
        EXPECT(gbc.h(),  0xbf);
        EXPECT(gbc.l(),  0xd3);
        EXPECT(gbc.sp(), 0xea62);
        EXPECT(gbc.pc(), 0x41e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01C3
        gbc.setState(0x910b, 0x1660, 0x5ce0, 0x631e, 0x432f, 0x4eeb, 0x1, 0x1);
        gbc.writeMem(0x910b, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4c);
        EXPECT(gbc.b(),  0x63);
        EXPECT(gbc.c(),  0x1e);
        EXPECT(gbc.d(),  0x43);
        EXPECT(gbc.e(),  0x2f);
        EXPECT(gbc.h(),  0x4e);
        EXPECT(gbc.l(),  0xeb);
        EXPECT(gbc.sp(), 0x1660);
        EXPECT(gbc.pc(), 0x910c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x910b), 0xa4);
        // A4 01C4
        gbc.setState(0x76c6, 0x82d0, 0xdee0, 0x9a4d, 0xdfae, 0xb006, 0x0, 0x1);
        gbc.writeMem(0x76c6, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x90);
        EXPECT(gbc.b(),  0x9a);
        EXPECT(gbc.c(),  0x4d);
        EXPECT(gbc.d(),  0xdf);
        EXPECT(gbc.e(),  0xae);
        EXPECT(gbc.h(),  0xb0);
        EXPECT(gbc.l(),  0x6);
        EXPECT(gbc.sp(), 0x82d0);
        EXPECT(gbc.pc(), 0x76c7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01C5
        gbc.setState(0x182f, 0x22ad, 0xe360, 0x7fe7, 0xa852, 0xfb7b, 0x0, 0x1);
        gbc.writeMem(0x182f, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe3);
        EXPECT(gbc.b(),  0x7f);
        EXPECT(gbc.c(),  0xe7);
        EXPECT(gbc.d(),  0xa8);
        EXPECT(gbc.e(),  0x52);
        EXPECT(gbc.h(),  0xfb);
        EXPECT(gbc.l(),  0x7b);
        EXPECT(gbc.sp(), 0x22ad);
        EXPECT(gbc.pc(), 0x1830);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01C6
        gbc.setState(0x2d55, 0xd578, 0x2fa0, 0x6ef9, 0x63e, 0x7c52, 0x0, 0x1);
        gbc.writeMem(0x2d55, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2c);
        EXPECT(gbc.b(),  0x6e);
        EXPECT(gbc.c(),  0xf9);
        EXPECT(gbc.d(),  0x6);
        EXPECT(gbc.e(),  0x3e);
        EXPECT(gbc.h(),  0x7c);
        EXPECT(gbc.l(),  0x52);
        EXPECT(gbc.sp(), 0xd578);
        EXPECT(gbc.pc(), 0x2d56);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01C7
        gbc.setState(0x16e0, 0xeac9, 0xdc90, 0x4fd7, 0xbf94, 0x8e6b, 0x1, 0x1);
        gbc.writeMem(0x16e0, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8c);
        EXPECT(gbc.b(),  0x4f);
        EXPECT(gbc.c(),  0xd7);
        EXPECT(gbc.d(),  0xbf);
        EXPECT(gbc.e(),  0x94);
        EXPECT(gbc.h(),  0x8e);
        EXPECT(gbc.l(),  0x6b);
        EXPECT(gbc.sp(), 0xeac9);
        EXPECT(gbc.pc(), 0x16e1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01C8
        gbc.setState(0x19fc, 0xaf28, 0x4ea0, 0x1525, 0x8aad, 0x238f, 0x1, 0x0);
        gbc.writeMem(0x19fc, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0x15);
        EXPECT(gbc.c(),  0x25);
        EXPECT(gbc.d(),  0x8a);
        EXPECT(gbc.e(),  0xad);
        EXPECT(gbc.h(),  0x23);
        EXPECT(gbc.l(),  0x8f);
        EXPECT(gbc.sp(), 0xaf28);
        EXPECT(gbc.pc(), 0x19fd);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01C9
        gbc.setState(0x89d5, 0xc56f, 0x1350, 0x3810, 0x5a0e, 0xbd88, 0x0, 0x1);
        gbc.writeMem(0x89d5, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x11);
        EXPECT(gbc.b(),  0x38);
        EXPECT(gbc.c(),  0x10);
        EXPECT(gbc.d(),  0x5a);
        EXPECT(gbc.e(),  0xe);
        EXPECT(gbc.h(),  0xbd);
        EXPECT(gbc.l(),  0x88);
        EXPECT(gbc.sp(), 0xc56f);
        EXPECT(gbc.pc(), 0x89d6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x89d5), 0xa4);
        // A4 01CA
        gbc.setState(0xd092, 0xe802, 0x6e30, 0x159c, 0x4e63, 0x54cb, 0x0, 0x0);
        gbc.writeMem(0xd092, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x44);
        EXPECT(gbc.b(),  0x15);
        EXPECT(gbc.c(),  0x9c);
        EXPECT(gbc.d(),  0x4e);
        EXPECT(gbc.e(),  0x63);
        EXPECT(gbc.h(),  0x54);
        EXPECT(gbc.l(),  0xcb);
        EXPECT(gbc.sp(), 0xe802);
        EXPECT(gbc.pc(), 0xd093);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd092), 0xa4);
        // A4 01CB
        gbc.setState(0xcccb, 0x2078, 0xd920, 0xf2cc, 0x96d6, 0x5b1f, 0x1, 0x0);
        gbc.writeMem(0xcccb, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x59);
        EXPECT(gbc.b(),  0xf2);
        EXPECT(gbc.c(),  0xcc);
        EXPECT(gbc.d(),  0x96);
        EXPECT(gbc.e(),  0xd6);
        EXPECT(gbc.h(),  0x5b);
        EXPECT(gbc.l(),  0x1f);
        EXPECT(gbc.sp(), 0x2078);
        EXPECT(gbc.pc(), 0xcccc);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcccb), 0xa4);
        // A4 01CC
        gbc.setState(0x44d7, 0xf066, 0xae00, 0x5672, 0xe1d8, 0xbd50, 0x0, 0x1);
        gbc.writeMem(0x44d7, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xac);
        EXPECT(gbc.b(),  0x56);
        EXPECT(gbc.c(),  0x72);
        EXPECT(gbc.d(),  0xe1);
        EXPECT(gbc.e(),  0xd8);
        EXPECT(gbc.h(),  0xbd);
        EXPECT(gbc.l(),  0x50);
        EXPECT(gbc.sp(), 0xf066);
        EXPECT(gbc.pc(), 0x44d8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01CD
        gbc.setState(0x2184, 0x93d1, 0x3160, 0xf67d, 0xa1b3, 0x74a4, 0x1, 0x1);
        gbc.writeMem(0x2184, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x30);
        EXPECT(gbc.b(),  0xf6);
        EXPECT(gbc.c(),  0x7d);
        EXPECT(gbc.d(),  0xa1);
        EXPECT(gbc.e(),  0xb3);
        EXPECT(gbc.h(),  0x74);
        EXPECT(gbc.l(),  0xa4);
        EXPECT(gbc.sp(), 0x93d1);
        EXPECT(gbc.pc(), 0x2185);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01CE
        gbc.setState(0x596d, 0x8c2b, 0x97d0, 0x4bce, 0xe0cf, 0x342f, 0x0, 0x1);
        gbc.writeMem(0x596d, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x14);
        EXPECT(gbc.b(),  0x4b);
        EXPECT(gbc.c(),  0xce);
        EXPECT(gbc.d(),  0xe0);
        EXPECT(gbc.e(),  0xcf);
        EXPECT(gbc.h(),  0x34);
        EXPECT(gbc.l(),  0x2f);
        EXPECT(gbc.sp(), 0x8c2b);
        EXPECT(gbc.pc(), 0x596e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01CF
        gbc.setState(0xe59e, 0xe433, 0x8ac0, 0x3c6f, 0x6941, 0x8e83, 0x0, 0x0);
        gbc.writeMem(0xe59e, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8a);
        EXPECT(gbc.b(),  0x3c);
        EXPECT(gbc.c(),  0x6f);
        EXPECT(gbc.d(),  0x69);
        EXPECT(gbc.e(),  0x41);
        EXPECT(gbc.h(),  0x8e);
        EXPECT(gbc.l(),  0x83);
        EXPECT(gbc.sp(), 0xe433);
        EXPECT(gbc.pc(), 0xe59f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe59e), 0xa4);
        // A4 01D0
        gbc.setState(0x3d0f, 0xad4d, 0xa50, 0xbf0b, 0x1d97, 0x5b66, 0x1, 0x1);
        gbc.writeMem(0x3d0f, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa);
        EXPECT(gbc.b(),  0xbf);
        EXPECT(gbc.c(),  0xb);
        EXPECT(gbc.d(),  0x1d);
        EXPECT(gbc.e(),  0x97);
        EXPECT(gbc.h(),  0x5b);
        EXPECT(gbc.l(),  0x66);
        EXPECT(gbc.sp(), 0xad4d);
        EXPECT(gbc.pc(), 0x3d10);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01D1
        gbc.setState(0xc9c, 0x4c9, 0xfab0, 0xc9ac, 0x8a7c, 0x72b3, 0x1, 0x1);
        gbc.writeMem(0xc9c, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x72);
        EXPECT(gbc.b(),  0xc9);
        EXPECT(gbc.c(),  0xac);
        EXPECT(gbc.d(),  0x8a);
        EXPECT(gbc.e(),  0x7c);
        EXPECT(gbc.h(),  0x72);
        EXPECT(gbc.l(),  0xb3);
        EXPECT(gbc.sp(), 0x4c9);
        EXPECT(gbc.pc(), 0xc9d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01D2
        gbc.setState(0xe51b, 0x9801, 0xb9f0, 0xdf9a, 0xab79, 0xee4e, 0x1, 0x1);
        gbc.writeMem(0xe51b, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa8);
        EXPECT(gbc.b(),  0xdf);
        EXPECT(gbc.c(),  0x9a);
        EXPECT(gbc.d(),  0xab);
        EXPECT(gbc.e(),  0x79);
        EXPECT(gbc.h(),  0xee);
        EXPECT(gbc.l(),  0x4e);
        EXPECT(gbc.sp(), 0x9801);
        EXPECT(gbc.pc(), 0xe51c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe51b), 0xa4);
        // A4 01D3
        gbc.setState(0x5242, 0x894c, 0xfdd0, 0xb4d5, 0x735f, 0x5fbf, 0x1, 0x1);
        gbc.writeMem(0x5242, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x5d);
        EXPECT(gbc.b(),  0xb4);
        EXPECT(gbc.c(),  0xd5);
        EXPECT(gbc.d(),  0x73);
        EXPECT(gbc.e(),  0x5f);
        EXPECT(gbc.h(),  0x5f);
        EXPECT(gbc.l(),  0xbf);
        EXPECT(gbc.sp(), 0x894c);
        EXPECT(gbc.pc(), 0x5243);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01D4
        gbc.setState(0x9715, 0x3c32, 0xdca0, 0x557e, 0x3f76, 0xcd34, 0x0, 0x0);
        gbc.writeMem(0x9715, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xcc);
        EXPECT(gbc.b(),  0x55);
        EXPECT(gbc.c(),  0x7e);
        EXPECT(gbc.d(),  0x3f);
        EXPECT(gbc.e(),  0x76);
        EXPECT(gbc.h(),  0xcd);
        EXPECT(gbc.l(),  0x34);
        EXPECT(gbc.sp(), 0x3c32);
        EXPECT(gbc.pc(), 0x9716);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9715), 0xa4);
        // A4 01D5
        gbc.setState(0x338d, 0xe7cd, 0xa2f0, 0xdac5, 0x2f02, 0x4193, 0x1, 0x0);
        gbc.writeMem(0x338d, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0xda);
        EXPECT(gbc.c(),  0xc5);
        EXPECT(gbc.d(),  0x2f);
        EXPECT(gbc.e(),  0x2);
        EXPECT(gbc.h(),  0x41);
        EXPECT(gbc.l(),  0x93);
        EXPECT(gbc.sp(), 0xe7cd);
        EXPECT(gbc.pc(), 0x338e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01D6
        gbc.setState(0x4eb8, 0x5db2, 0xf760, 0xd00d, 0x1f9e, 0x1d14, 0x0, 0x0);
        gbc.writeMem(0x4eb8, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x15);
        EXPECT(gbc.b(),  0xd0);
        EXPECT(gbc.c(),  0xd);
        EXPECT(gbc.d(),  0x1f);
        EXPECT(gbc.e(),  0x9e);
        EXPECT(gbc.h(),  0x1d);
        EXPECT(gbc.l(),  0x14);
        EXPECT(gbc.sp(), 0x5db2);
        EXPECT(gbc.pc(), 0x4eb9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01D7
        gbc.setState(0x2cef, 0xd896, 0x42c0, 0xbf3c, 0xac3b, 0xd951, 0x1, 0x0);
        gbc.writeMem(0x2cef, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0xbf);
        EXPECT(gbc.c(),  0x3c);
        EXPECT(gbc.d(),  0xac);
        EXPECT(gbc.e(),  0x3b);
        EXPECT(gbc.h(),  0xd9);
        EXPECT(gbc.l(),  0x51);
        EXPECT(gbc.sp(), 0xd896);
        EXPECT(gbc.pc(), 0x2cf0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01D8
        gbc.setState(0x843c, 0x673e, 0xd440, 0x792, 0xce15, 0x2f4a, 0x0, 0x0);
        gbc.writeMem(0x843c, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0x7);
        EXPECT(gbc.c(),  0x92);
        EXPECT(gbc.d(),  0xce);
        EXPECT(gbc.e(),  0x15);
        EXPECT(gbc.h(),  0x2f);
        EXPECT(gbc.l(),  0x4a);
        EXPECT(gbc.sp(), 0x673e);
        EXPECT(gbc.pc(), 0x843d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x843c), 0xa4);
        // A4 01D9
        gbc.setState(0x8d1b, 0xd415, 0x41f0, 0xc1c, 0x9c27, 0x5d4e, 0x0, 0x0);
        gbc.writeMem(0x8d1b, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x41);
        EXPECT(gbc.b(),  0xc);
        EXPECT(gbc.c(),  0x1c);
        EXPECT(gbc.d(),  0x9c);
        EXPECT(gbc.e(),  0x27);
        EXPECT(gbc.h(),  0x5d);
        EXPECT(gbc.l(),  0x4e);
        EXPECT(gbc.sp(), 0xd415);
        EXPECT(gbc.pc(), 0x8d1c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8d1b), 0xa4);
        // A4 01DA
        gbc.setState(0x1f1b, 0xc57c, 0xcc50, 0x4227, 0xae21, 0xf47b, 0x1, 0x1);
        gbc.writeMem(0x1f1b, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc4);
        EXPECT(gbc.b(),  0x42);
        EXPECT(gbc.c(),  0x27);
        EXPECT(gbc.d(),  0xae);
        EXPECT(gbc.e(),  0x21);
        EXPECT(gbc.h(),  0xf4);
        EXPECT(gbc.l(),  0x7b);
        EXPECT(gbc.sp(), 0xc57c);
        EXPECT(gbc.pc(), 0x1f1c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01DB
        gbc.setState(0xcabe, 0x1941, 0x33f0, 0x2bb0, 0x6ba2, 0x6c5b, 0x0, 0x1);
        gbc.writeMem(0xcabe, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0x2b);
        EXPECT(gbc.c(),  0xb0);
        EXPECT(gbc.d(),  0x6b);
        EXPECT(gbc.e(),  0xa2);
        EXPECT(gbc.h(),  0x6c);
        EXPECT(gbc.l(),  0x5b);
        EXPECT(gbc.sp(), 0x1941);
        EXPECT(gbc.pc(), 0xcabf);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcabe), 0xa4);
        // A4 01DC
        gbc.setState(0x25b, 0xc2b, 0xcad0, 0xeeb2, 0x2a60, 0xae3, 0x1, 0x0);
        gbc.writeMem(0x25b, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa);
        EXPECT(gbc.b(),  0xee);
        EXPECT(gbc.c(),  0xb2);
        EXPECT(gbc.d(),  0x2a);
        EXPECT(gbc.e(),  0x60);
        EXPECT(gbc.h(),  0xa);
        EXPECT(gbc.l(),  0xe3);
        EXPECT(gbc.sp(), 0xc2b);
        EXPECT(gbc.pc(), 0x25c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01DD
        gbc.setState(0x9a71, 0x36c5, 0xf1e0, 0xdc9d, 0x4e8a, 0xcbee, 0x1, 0x0);
        gbc.writeMem(0x9a71, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc1);
        EXPECT(gbc.b(),  0xdc);
        EXPECT(gbc.c(),  0x9d);
        EXPECT(gbc.d(),  0x4e);
        EXPECT(gbc.e(),  0x8a);
        EXPECT(gbc.h(),  0xcb);
        EXPECT(gbc.l(),  0xee);
        EXPECT(gbc.sp(), 0x36c5);
        EXPECT(gbc.pc(), 0x9a72);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9a71), 0xa4);
        // A4 01DE
        gbc.setState(0x55cb, 0x3efe, 0xded0, 0xe887, 0xa9ec, 0xcca0, 0x0, 0x1);
        gbc.writeMem(0x55cb, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xcc);
        EXPECT(gbc.b(),  0xe8);
        EXPECT(gbc.c(),  0x87);
        EXPECT(gbc.d(),  0xa9);
        EXPECT(gbc.e(),  0xec);
        EXPECT(gbc.h(),  0xcc);
        EXPECT(gbc.l(),  0xa0);
        EXPECT(gbc.sp(), 0x3efe);
        EXPECT(gbc.pc(), 0x55cc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01DF
        gbc.setState(0x3e7f, 0x7507, 0x1b70, 0x56ca, 0xd341, 0xbe71, 0x0, 0x1);
        gbc.writeMem(0x3e7f, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1a);
        EXPECT(gbc.b(),  0x56);
        EXPECT(gbc.c(),  0xca);
        EXPECT(gbc.d(),  0xd3);
        EXPECT(gbc.e(),  0x41);
        EXPECT(gbc.h(),  0xbe);
        EXPECT(gbc.l(),  0x71);
        EXPECT(gbc.sp(), 0x7507);
        EXPECT(gbc.pc(), 0x3e80);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01E0
        gbc.setState(0x58c0, 0x5b27, 0x9ce0, 0xfe4, 0x59b7, 0x9527, 0x0, 0x0);
        gbc.writeMem(0x58c0, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x94);
        EXPECT(gbc.b(),  0xf);
        EXPECT(gbc.c(),  0xe4);
        EXPECT(gbc.d(),  0x59);
        EXPECT(gbc.e(),  0xb7);
        EXPECT(gbc.h(),  0x95);
        EXPECT(gbc.l(),  0x27);
        EXPECT(gbc.sp(), 0x5b27);
        EXPECT(gbc.pc(), 0x58c1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01E1
        gbc.setState(0x8c55, 0xeaa8, 0xfca0, 0x8d96, 0x80e0, 0x4d14, 0x1, 0x1);
        gbc.writeMem(0x8c55, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4c);
        EXPECT(gbc.b(),  0x8d);
        EXPECT(gbc.c(),  0x96);
        EXPECT(gbc.d(),  0x80);
        EXPECT(gbc.e(),  0xe0);
        EXPECT(gbc.h(),  0x4d);
        EXPECT(gbc.l(),  0x14);
        EXPECT(gbc.sp(), 0xeaa8);
        EXPECT(gbc.pc(), 0x8c56);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8c55), 0xa4);
        // A4 01E2
        gbc.setState(0xa289, 0xfc49, 0xed80, 0xf4e8, 0xb45f, 0xf3ec, 0x0, 0x1);
        gbc.writeMem(0xa289, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe1);
        EXPECT(gbc.b(),  0xf4);
        EXPECT(gbc.c(),  0xe8);
        EXPECT(gbc.d(),  0xb4);
        EXPECT(gbc.e(),  0x5f);
        EXPECT(gbc.h(),  0xf3);
        EXPECT(gbc.l(),  0xec);
        EXPECT(gbc.sp(), 0xfc49);
        EXPECT(gbc.pc(), 0xa28a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa289), 0xa4);
        // A4 01E3
        gbc.setState(0x2721, 0x9d30, 0x18d0, 0xf131, 0x935, 0x9ad0, 0x1, 0x1);
        gbc.writeMem(0x2721, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x18);
        EXPECT(gbc.b(),  0xf1);
        EXPECT(gbc.c(),  0x31);
        EXPECT(gbc.d(),  0x9);
        EXPECT(gbc.e(),  0x35);
        EXPECT(gbc.h(),  0x9a);
        EXPECT(gbc.l(),  0xd0);
        EXPECT(gbc.sp(), 0x9d30);
        EXPECT(gbc.pc(), 0x2722);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01E4
        gbc.setState(0xc830, 0xeb88, 0x2880, 0x1cea, 0x167a, 0x485b, 0x1, 0x0);
        gbc.writeMem(0xc830, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0x1c);
        EXPECT(gbc.c(),  0xea);
        EXPECT(gbc.d(),  0x16);
        EXPECT(gbc.e(),  0x7a);
        EXPECT(gbc.h(),  0x48);
        EXPECT(gbc.l(),  0x5b);
        EXPECT(gbc.sp(), 0xeb88);
        EXPECT(gbc.pc(), 0xc831);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc830), 0xa4);
        // A4 01E5
        gbc.setState(0x66f8, 0x2665, 0xa3f0, 0x4b81, 0xa424, 0x142b, 0x1, 0x1);
        gbc.writeMem(0x66f8, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x4b);
        EXPECT(gbc.c(),  0x81);
        EXPECT(gbc.d(),  0xa4);
        EXPECT(gbc.e(),  0x24);
        EXPECT(gbc.h(),  0x14);
        EXPECT(gbc.l(),  0x2b);
        EXPECT(gbc.sp(), 0x2665);
        EXPECT(gbc.pc(), 0x66f9);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01E6
        gbc.setState(0xa571, 0x8526, 0x83c0, 0x1226, 0x2393, 0x43ad, 0x1, 0x1);
        gbc.writeMem(0xa571, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3);
        EXPECT(gbc.b(),  0x12);
        EXPECT(gbc.c(),  0x26);
        EXPECT(gbc.d(),  0x23);
        EXPECT(gbc.e(),  0x93);
        EXPECT(gbc.h(),  0x43);
        EXPECT(gbc.l(),  0xad);
        EXPECT(gbc.sp(), 0x8526);
        EXPECT(gbc.pc(), 0xa572);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa571), 0xa4);
        // A4 01E7
        gbc.setState(0x22a6, 0x21af, 0xa6d0, 0x7f14, 0xf18f, 0x35fb, 0x0, 0x0);
        gbc.writeMem(0x22a6, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x24);
        EXPECT(gbc.b(),  0x7f);
        EXPECT(gbc.c(),  0x14);
        EXPECT(gbc.d(),  0xf1);
        EXPECT(gbc.e(),  0x8f);
        EXPECT(gbc.h(),  0x35);
        EXPECT(gbc.l(),  0xfb);
        EXPECT(gbc.sp(), 0x21af);
        EXPECT(gbc.pc(), 0x22a7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01E8
        gbc.setState(0x95b5, 0x4304, 0x41c0, 0x3c16, 0xcbe0, 0xbc03, 0x0, 0x1);
        gbc.writeMem(0x95b5, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x3c);
        EXPECT(gbc.c(),  0x16);
        EXPECT(gbc.d(),  0xcb);
        EXPECT(gbc.e(),  0xe0);
        EXPECT(gbc.h(),  0xbc);
        EXPECT(gbc.l(),  0x3);
        EXPECT(gbc.sp(), 0x4304);
        EXPECT(gbc.pc(), 0x95b6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x95b5), 0xa4);
        // A4 01E9
        gbc.setState(0xd3bc, 0xe3df, 0x4a60, 0x19bd, 0x5c5c, 0xe4e, 0x0, 0x1);
        gbc.writeMem(0xd3bc, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa);
        EXPECT(gbc.b(),  0x19);
        EXPECT(gbc.c(),  0xbd);
        EXPECT(gbc.d(),  0x5c);
        EXPECT(gbc.e(),  0x5c);
        EXPECT(gbc.h(),  0xe);
        EXPECT(gbc.l(),  0x4e);
        EXPECT(gbc.sp(), 0xe3df);
        EXPECT(gbc.pc(), 0xd3bd);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd3bc), 0xa4);
        // A4 01EA
        gbc.setState(0xbee6, 0x55bf, 0x3b70, 0xf03a, 0x1ecf, 0xa940, 0x0, 0x0);
        gbc.writeMem(0xbee6, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x29);
        EXPECT(gbc.b(),  0xf0);
        EXPECT(gbc.c(),  0x3a);
        EXPECT(gbc.d(),  0x1e);
        EXPECT(gbc.e(),  0xcf);
        EXPECT(gbc.h(),  0xa9);
        EXPECT(gbc.l(),  0x40);
        EXPECT(gbc.sp(), 0x55bf);
        EXPECT(gbc.pc(), 0xbee7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbee6), 0xa4);
        // A4 01EB
        gbc.setState(0xb67a, 0xe59f, 0x2c50, 0x23cb, 0x6cb0, 0xd7cb, 0x1, 0x1);
        gbc.writeMem(0xb67a, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0x23);
        EXPECT(gbc.c(),  0xcb);
        EXPECT(gbc.d(),  0x6c);
        EXPECT(gbc.e(),  0xb0);
        EXPECT(gbc.h(),  0xd7);
        EXPECT(gbc.l(),  0xcb);
        EXPECT(gbc.sp(), 0xe59f);
        EXPECT(gbc.pc(), 0xb67b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb67a), 0xa4);
        // A4 01EC
        gbc.setState(0xd679, 0x7445, 0x1790, 0x4a5d, 0x1cdc, 0x17b, 0x0, 0x0);
        gbc.writeMem(0xd679, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0x4a);
        EXPECT(gbc.c(),  0x5d);
        EXPECT(gbc.d(),  0x1c);
        EXPECT(gbc.e(),  0xdc);
        EXPECT(gbc.h(),  0x1);
        EXPECT(gbc.l(),  0x7b);
        EXPECT(gbc.sp(), 0x7445);
        EXPECT(gbc.pc(), 0xd67a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd679), 0xa4);
        // A4 01ED
        gbc.setState(0xccee, 0x7891, 0x6b40, 0xc335, 0x24d5, 0xff45, 0x1, 0x0);
        gbc.writeMem(0xccee, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x6b);
        EXPECT(gbc.b(),  0xc3);
        EXPECT(gbc.c(),  0x35);
        EXPECT(gbc.d(),  0x24);
        EXPECT(gbc.e(),  0xd5);
        EXPECT(gbc.h(),  0xff);
        EXPECT(gbc.l(),  0x45);
        EXPECT(gbc.sp(), 0x7891);
        EXPECT(gbc.pc(), 0xccef);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xccee), 0xa4);
        // A4 01EE
        gbc.setState(0xed6a, 0xfe60, 0x5f80, 0x4b19, 0x6119, 0xf691, 0x1, 0x1);
        gbc.writeMem(0xed6a, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x56);
        EXPECT(gbc.b(),  0x4b);
        EXPECT(gbc.c(),  0x19);
        EXPECT(gbc.d(),  0x61);
        EXPECT(gbc.e(),  0x19);
        EXPECT(gbc.h(),  0xf6);
        EXPECT(gbc.l(),  0x91);
        EXPECT(gbc.sp(), 0xfe60);
        EXPECT(gbc.pc(), 0xed6b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xed6a), 0xa4);
        // A4 01F0
        gbc.setState(0x5be6, 0x4632, 0x5600, 0x75dd, 0x79b5, 0x9632, 0x0, 0x1);
        gbc.writeMem(0x5be6, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x16);
        EXPECT(gbc.b(),  0x75);
        EXPECT(gbc.c(),  0xdd);
        EXPECT(gbc.d(),  0x79);
        EXPECT(gbc.e(),  0xb5);
        EXPECT(gbc.h(),  0x96);
        EXPECT(gbc.l(),  0x32);
        EXPECT(gbc.sp(), 0x4632);
        EXPECT(gbc.pc(), 0x5be7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01F1
        gbc.setState(0xb096, 0x22b7, 0x24b0, 0x575e, 0x2748, 0xcb95, 0x1, 0x1);
        gbc.writeMem(0xb096, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x57);
        EXPECT(gbc.c(),  0x5e);
        EXPECT(gbc.d(),  0x27);
        EXPECT(gbc.e(),  0x48);
        EXPECT(gbc.h(),  0xcb);
        EXPECT(gbc.l(),  0x95);
        EXPECT(gbc.sp(), 0x22b7);
        EXPECT(gbc.pc(), 0xb097);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb096), 0xa4);
        // A4 01F2
        gbc.setState(0x999e, 0x4553, 0x9890, 0x34a5, 0xc450, 0x83cd, 0x0, 0x1);
        gbc.writeMem(0x999e, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0x34);
        EXPECT(gbc.c(),  0xa5);
        EXPECT(gbc.d(),  0xc4);
        EXPECT(gbc.e(),  0x50);
        EXPECT(gbc.h(),  0x83);
        EXPECT(gbc.l(),  0xcd);
        EXPECT(gbc.sp(), 0x4553);
        EXPECT(gbc.pc(), 0x999f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x999e), 0xa4);
        // A4 01F3
        gbc.setState(0x506a, 0xc1a3, 0xc1b0, 0x6855, 0x35f8, 0x95cb, 0x1, 0x1);
        gbc.writeMem(0x506a, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x81);
        EXPECT(gbc.b(),  0x68);
        EXPECT(gbc.c(),  0x55);
        EXPECT(gbc.d(),  0x35);
        EXPECT(gbc.e(),  0xf8);
        EXPECT(gbc.h(),  0x95);
        EXPECT(gbc.l(),  0xcb);
        EXPECT(gbc.sp(), 0xc1a3);
        EXPECT(gbc.pc(), 0x506b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01F4
        gbc.setState(0x61db, 0xaa59, 0x4340, 0x10b8, 0xedad, 0x2a2f, 0x0, 0x0);
        gbc.writeMem(0x61db, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0x10);
        EXPECT(gbc.c(),  0xb8);
        EXPECT(gbc.d(),  0xed);
        EXPECT(gbc.e(),  0xad);
        EXPECT(gbc.h(),  0x2a);
        EXPECT(gbc.l(),  0x2f);
        EXPECT(gbc.sp(), 0xaa59);
        EXPECT(gbc.pc(), 0x61dc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01F5
        gbc.setState(0x9313, 0x7ac1, 0xfe70, 0x9a02, 0xaf19, 0x36d, 0x1, 0x1);
        gbc.writeMem(0x9313, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0x9a);
        EXPECT(gbc.c(),  0x2);
        EXPECT(gbc.d(),  0xaf);
        EXPECT(gbc.e(),  0x19);
        EXPECT(gbc.h(),  0x3);
        EXPECT(gbc.l(),  0x6d);
        EXPECT(gbc.sp(), 0x7ac1);
        EXPECT(gbc.pc(), 0x9314);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9313), 0xa4);
        // A4 01F6
        gbc.setState(0x7ea6, 0x8d20, 0x1870, 0x58de, 0x1500, 0xe8ea, 0x1, 0x0);
        gbc.writeMem(0x7ea6, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0x58);
        EXPECT(gbc.c(),  0xde);
        EXPECT(gbc.d(),  0x15);
        EXPECT(gbc.e(),  0x0);
        EXPECT(gbc.h(),  0xe8);
        EXPECT(gbc.l(),  0xea);
        EXPECT(gbc.sp(), 0x8d20);
        EXPECT(gbc.pc(), 0x7ea7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01F7
        gbc.setState(0x86c2, 0xc10f, 0xac50, 0x464e, 0x8e28, 0x649e, 0x1, 0x1);
        gbc.writeMem(0x86c2, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x24);
        EXPECT(gbc.b(),  0x46);
        EXPECT(gbc.c(),  0x4e);
        EXPECT(gbc.d(),  0x8e);
        EXPECT(gbc.e(),  0x28);
        EXPECT(gbc.h(),  0x64);
        EXPECT(gbc.l(),  0x9e);
        EXPECT(gbc.sp(), 0xc10f);
        EXPECT(gbc.pc(), 0x86c3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x86c2), 0xa4);
        // A4 01F8
        gbc.setState(0x76ad, 0x3f4d, 0x14d0, 0x882a, 0xc544, 0x5e3c, 0x0, 0x1);
        gbc.writeMem(0x76ad, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x14);
        EXPECT(gbc.b(),  0x88);
        EXPECT(gbc.c(),  0x2a);
        EXPECT(gbc.d(),  0xc5);
        EXPECT(gbc.e(),  0x44);
        EXPECT(gbc.h(),  0x5e);
        EXPECT(gbc.l(),  0x3c);
        EXPECT(gbc.sp(), 0x3f4d);
        EXPECT(gbc.pc(), 0x76ae);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01F9
        gbc.setState(0xb768, 0x25da, 0xb40, 0x269c, 0x6c78, 0xb80e, 0x0, 0x1);
        gbc.writeMem(0xb768, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0x26);
        EXPECT(gbc.c(),  0x9c);
        EXPECT(gbc.d(),  0x6c);
        EXPECT(gbc.e(),  0x78);
        EXPECT(gbc.h(),  0xb8);
        EXPECT(gbc.l(),  0xe);
        EXPECT(gbc.sp(), 0x25da);
        EXPECT(gbc.pc(), 0xb769);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb768), 0xa4);
        // A4 01FA
        gbc.setState(0xac28, 0xf46c, 0x5a00, 0x581e, 0xf927, 0xb4de, 0x1, 0x0);
        gbc.writeMem(0xac28, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0x58);
        EXPECT(gbc.c(),  0x1e);
        EXPECT(gbc.d(),  0xf9);
        EXPECT(gbc.e(),  0x27);
        EXPECT(gbc.h(),  0xb4);
        EXPECT(gbc.l(),  0xde);
        EXPECT(gbc.sp(), 0xf46c);
        EXPECT(gbc.pc(), 0xac29);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xac28), 0xa4);
        // A4 01FB
        gbc.setState(0x9c6e, 0x4f7d, 0xfca0, 0x726f, 0x75db, 0x170, 0x0, 0x0);
        gbc.writeMem(0x9c6e, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x72);
        EXPECT(gbc.c(),  0x6f);
        EXPECT(gbc.d(),  0x75);
        EXPECT(gbc.e(),  0xdb);
        EXPECT(gbc.h(),  0x1);
        EXPECT(gbc.l(),  0x70);
        EXPECT(gbc.sp(), 0x4f7d);
        EXPECT(gbc.pc(), 0x9c6f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9c6e), 0xa4);
        // A4 01FC
        gbc.setState(0x76fe, 0xb7fc, 0xf80, 0x369b, 0xea5f, 0x9243, 0x1, 0x1);
        gbc.writeMem(0x76fe, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0x36);
        EXPECT(gbc.c(),  0x9b);
        EXPECT(gbc.d(),  0xea);
        EXPECT(gbc.e(),  0x5f);
        EXPECT(gbc.h(),  0x92);
        EXPECT(gbc.l(),  0x43);
        EXPECT(gbc.sp(), 0xb7fc);
        EXPECT(gbc.pc(), 0x76ff);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01FD
        gbc.setState(0xedd4, 0xd3c7, 0xacb0, 0xd326, 0xd6e0, 0xc923, 0x0, 0x1);
        gbc.writeMem(0xedd4, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x88);
        EXPECT(gbc.b(),  0xd3);
        EXPECT(gbc.c(),  0x26);
        EXPECT(gbc.d(),  0xd6);
        EXPECT(gbc.e(),  0xe0);
        EXPECT(gbc.h(),  0xc9);
        EXPECT(gbc.l(),  0x23);
        EXPECT(gbc.sp(), 0xd3c7);
        EXPECT(gbc.pc(), 0xedd5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xedd4), 0xa4);
        // A4 01FE
        gbc.setState(0x45ac, 0xdb50, 0x6190, 0x26c3, 0x4d40, 0xd7ab, 0x1, 0x0);
        gbc.writeMem(0x45ac, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x41);
        EXPECT(gbc.b(),  0x26);
        EXPECT(gbc.c(),  0xc3);
        EXPECT(gbc.d(),  0x4d);
        EXPECT(gbc.e(),  0x40);
        EXPECT(gbc.h(),  0xd7);
        EXPECT(gbc.l(),  0xab);
        EXPECT(gbc.sp(), 0xdb50);
        EXPECT(gbc.pc(), 0x45ad);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 01FF
        gbc.setState(0x7360, 0xb21a, 0x64d0, 0x6a00, 0xf7e4, 0xab19, 0x1, 0x0);
        gbc.writeMem(0x7360, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0x6a);
        EXPECT(gbc.c(),  0x0);
        EXPECT(gbc.d(),  0xf7);
        EXPECT(gbc.e(),  0xe4);
        EXPECT(gbc.h(),  0xab);
        EXPECT(gbc.l(),  0x19);
        EXPECT(gbc.sp(), 0xb21a);
        EXPECT(gbc.pc(), 0x7361);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0200
        gbc.setState(0xaa37, 0x975f, 0xab80, 0xdf8f, 0x4931, 0x6059, 0x0, 0x1);
        gbc.writeMem(0xaa37, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0xdf);
        EXPECT(gbc.c(),  0x8f);
        EXPECT(gbc.d(),  0x49);
        EXPECT(gbc.e(),  0x31);
        EXPECT(gbc.h(),  0x60);
        EXPECT(gbc.l(),  0x59);
        EXPECT(gbc.sp(), 0x975f);
        EXPECT(gbc.pc(), 0xaa38);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xaa37), 0xa4);
        // A4 0201
        gbc.setState(0x4e71, 0xba36, 0xf880, 0x8ff3, 0x47f, 0x35dc, 0x1, 0x0);
        gbc.writeMem(0x4e71, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x30);
        EXPECT(gbc.b(),  0x8f);
        EXPECT(gbc.c(),  0xf3);
        EXPECT(gbc.d(),  0x4);
        EXPECT(gbc.e(),  0x7f);
        EXPECT(gbc.h(),  0x35);
        EXPECT(gbc.l(),  0xdc);
        EXPECT(gbc.sp(), 0xba36);
        EXPECT(gbc.pc(), 0x4e72);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0202
        gbc.setState(0x8255, 0x90b5, 0xdee0, 0x3c0, 0xd27e, 0xdb11, 0x1, 0x0);
        gbc.writeMem(0x8255, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xda);
        EXPECT(gbc.b(),  0x3);
        EXPECT(gbc.c(),  0xc0);
        EXPECT(gbc.d(),  0xd2);
        EXPECT(gbc.e(),  0x7e);
        EXPECT(gbc.h(),  0xdb);
        EXPECT(gbc.l(),  0x11);
        EXPECT(gbc.sp(), 0x90b5);
        EXPECT(gbc.pc(), 0x8256);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8255), 0xa4);
        // A4 0203
        gbc.setState(0x6254, 0x99ce, 0x2200, 0xa925, 0x2ed7, 0xf1b8, 0x1, 0x0);
        gbc.writeMem(0x6254, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0xa9);
        EXPECT(gbc.c(),  0x25);
        EXPECT(gbc.d(),  0x2e);
        EXPECT(gbc.e(),  0xd7);
        EXPECT(gbc.h(),  0xf1);
        EXPECT(gbc.l(),  0xb8);
        EXPECT(gbc.sp(), 0x99ce);
        EXPECT(gbc.pc(), 0x6255);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0204
        gbc.setState(0x4892, 0x6a80, 0x1d50, 0xf084, 0xdcee, 0x5763, 0x0, 0x1);
        gbc.writeMem(0x4892, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x15);
        EXPECT(gbc.b(),  0xf0);
        EXPECT(gbc.c(),  0x84);
        EXPECT(gbc.d(),  0xdc);
        EXPECT(gbc.e(),  0xee);
        EXPECT(gbc.h(),  0x57);
        EXPECT(gbc.l(),  0x63);
        EXPECT(gbc.sp(), 0x6a80);
        EXPECT(gbc.pc(), 0x4893);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0205
        gbc.setState(0xd765, 0xe94b, 0x2ce0, 0x31c5, 0x97fb, 0x1896, 0x0, 0x1);
        gbc.writeMem(0xd765, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0x31);
        EXPECT(gbc.c(),  0xc5);
        EXPECT(gbc.d(),  0x97);
        EXPECT(gbc.e(),  0xfb);
        EXPECT(gbc.h(),  0x18);
        EXPECT(gbc.l(),  0x96);
        EXPECT(gbc.sp(), 0xe94b);
        EXPECT(gbc.pc(), 0xd766);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd765), 0xa4);
        // A4 0206
        gbc.setState(0x7146, 0xd7cd, 0x5890, 0xe44d, 0x5575, 0xc6c3, 0x0, 0x0);
        gbc.writeMem(0x7146, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0xe4);
        EXPECT(gbc.c(),  0x4d);
        EXPECT(gbc.d(),  0x55);
        EXPECT(gbc.e(),  0x75);
        EXPECT(gbc.h(),  0xc6);
        EXPECT(gbc.l(),  0xc3);
        EXPECT(gbc.sp(), 0xd7cd);
        EXPECT(gbc.pc(), 0x7147);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0207
        gbc.setState(0xc82f, 0xb627, 0xd930, 0xcf9b, 0xd872, 0xfa43, 0x1, 0x0);
        gbc.writeMem(0xc82f, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd8);
        EXPECT(gbc.b(),  0xcf);
        EXPECT(gbc.c(),  0x9b);
        EXPECT(gbc.d(),  0xd8);
        EXPECT(gbc.e(),  0x72);
        EXPECT(gbc.h(),  0xfa);
        EXPECT(gbc.l(),  0x43);
        EXPECT(gbc.sp(), 0xb627);
        EXPECT(gbc.pc(), 0xc830);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc82f), 0xa4);
        // A4 0208
        gbc.setState(0x6077, 0x1bb6, 0x5fd0, 0x5bef, 0x835a, 0x3d17, 0x1, 0x0);
        gbc.writeMem(0x6077, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1d);
        EXPECT(gbc.b(),  0x5b);
        EXPECT(gbc.c(),  0xef);
        EXPECT(gbc.d(),  0x83);
        EXPECT(gbc.e(),  0x5a);
        EXPECT(gbc.h(),  0x3d);
        EXPECT(gbc.l(),  0x17);
        EXPECT(gbc.sp(), 0x1bb6);
        EXPECT(gbc.pc(), 0x6078);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0209
        gbc.setState(0x21df, 0x52ad, 0xb6a0, 0x6bec, 0x3c12, 0x9dd, 0x1, 0x1);
        gbc.writeMem(0x21df, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x6b);
        EXPECT(gbc.c(),  0xec);
        EXPECT(gbc.d(),  0x3c);
        EXPECT(gbc.e(),  0x12);
        EXPECT(gbc.h(),  0x9);
        EXPECT(gbc.l(),  0xdd);
        EXPECT(gbc.sp(), 0x52ad);
        EXPECT(gbc.pc(), 0x21e0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 020A
        gbc.setState(0x6072, 0xd7be, 0x4e80, 0x455b, 0x8d4b, 0x2146, 0x0, 0x1);
        gbc.writeMem(0x6072, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x45);
        EXPECT(gbc.c(),  0x5b);
        EXPECT(gbc.d(),  0x8d);
        EXPECT(gbc.e(),  0x4b);
        EXPECT(gbc.h(),  0x21);
        EXPECT(gbc.l(),  0x46);
        EXPECT(gbc.sp(), 0xd7be);
        EXPECT(gbc.pc(), 0x6073);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 020B
        gbc.setState(0xd86c, 0x147c, 0xb880, 0x3496, 0xbf2f, 0x19cc, 0x0, 0x0);
        gbc.writeMem(0xd86c, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x18);
        EXPECT(gbc.b(),  0x34);
        EXPECT(gbc.c(),  0x96);
        EXPECT(gbc.d(),  0xbf);
        EXPECT(gbc.e(),  0x2f);
        EXPECT(gbc.h(),  0x19);
        EXPECT(gbc.l(),  0xcc);
        EXPECT(gbc.sp(), 0x147c);
        EXPECT(gbc.pc(), 0xd86d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd86c), 0xa4);
        // A4 020C
        gbc.setState(0xbfb2, 0xa50c, 0xfd10, 0xd3c, 0xd6a6, 0x5b83, 0x0, 0x1);
        gbc.writeMem(0xbfb2, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x59);
        EXPECT(gbc.b(),  0xd);
        EXPECT(gbc.c(),  0x3c);
        EXPECT(gbc.d(),  0xd6);
        EXPECT(gbc.e(),  0xa6);
        EXPECT(gbc.h(),  0x5b);
        EXPECT(gbc.l(),  0x83);
        EXPECT(gbc.sp(), 0xa50c);
        EXPECT(gbc.pc(), 0xbfb3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbfb2), 0xa4);
        // A4 020D
        gbc.setState(0xb040, 0x5e17, 0x4ff0, 0x9925, 0xe9d, 0xd44, 0x0, 0x0);
        gbc.writeMem(0xb040, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd);
        EXPECT(gbc.b(),  0x99);
        EXPECT(gbc.c(),  0x25);
        EXPECT(gbc.d(),  0xe);
        EXPECT(gbc.e(),  0x9d);
        EXPECT(gbc.h(),  0xd);
        EXPECT(gbc.l(),  0x44);
        EXPECT(gbc.sp(), 0x5e17);
        EXPECT(gbc.pc(), 0xb041);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb040), 0xa4);
        // A4 020E
        gbc.setState(0xc929, 0x9e3b, 0x31a0, 0x2276, 0xe9c0, 0xf56f, 0x1, 0x0);
        gbc.writeMem(0xc929, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x31);
        EXPECT(gbc.b(),  0x22);
        EXPECT(gbc.c(),  0x76);
        EXPECT(gbc.d(),  0xe9);
        EXPECT(gbc.e(),  0xc0);
        EXPECT(gbc.h(),  0xf5);
        EXPECT(gbc.l(),  0x6f);
        EXPECT(gbc.sp(), 0x9e3b);
        EXPECT(gbc.pc(), 0xc92a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc929), 0xa4);
        // A4 020F
        gbc.setState(0x2f23, 0xf9b4, 0x47f0, 0x946d, 0xe8c7, 0xa88b, 0x1, 0x1);
        gbc.writeMem(0x2f23, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x94);
        EXPECT(gbc.c(),  0x6d);
        EXPECT(gbc.d(),  0xe8);
        EXPECT(gbc.e(),  0xc7);
        EXPECT(gbc.h(),  0xa8);
        EXPECT(gbc.l(),  0x8b);
        EXPECT(gbc.sp(), 0xf9b4);
        EXPECT(gbc.pc(), 0x2f24);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0210
        gbc.setState(0x4eb8, 0x573f, 0x3c90, 0xb9f5, 0x6366, 0xaaec, 0x0, 0x1);
        gbc.writeMem(0x4eb8, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0xb9);
        EXPECT(gbc.c(),  0xf5);
        EXPECT(gbc.d(),  0x63);
        EXPECT(gbc.e(),  0x66);
        EXPECT(gbc.h(),  0xaa);
        EXPECT(gbc.l(),  0xec);
        EXPECT(gbc.sp(), 0x573f);
        EXPECT(gbc.pc(), 0x4eb9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0211
        gbc.setState(0x255b, 0x6269, 0x7220, 0xd66d, 0x6c92, 0x2c65, 0x0, 0x1);
        gbc.writeMem(0x255b, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0xd6);
        EXPECT(gbc.c(),  0x6d);
        EXPECT(gbc.d(),  0x6c);
        EXPECT(gbc.e(),  0x92);
        EXPECT(gbc.h(),  0x2c);
        EXPECT(gbc.l(),  0x65);
        EXPECT(gbc.sp(), 0x6269);
        EXPECT(gbc.pc(), 0x255c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0212
        gbc.setState(0xb241, 0x8c99, 0xc250, 0x4695, 0xfd65, 0x9814, 0x1, 0x0);
        gbc.writeMem(0xb241, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0x46);
        EXPECT(gbc.c(),  0x95);
        EXPECT(gbc.d(),  0xfd);
        EXPECT(gbc.e(),  0x65);
        EXPECT(gbc.h(),  0x98);
        EXPECT(gbc.l(),  0x14);
        EXPECT(gbc.sp(), 0x8c99);
        EXPECT(gbc.pc(), 0xb242);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb241), 0xa4);
        // A4 0213
        gbc.setState(0x603a, 0xbab4, 0x7650, 0x25f, 0xb41b, 0xe89, 0x0, 0x1);
        gbc.writeMem(0x603a, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x6);
        EXPECT(gbc.b(),  0x2);
        EXPECT(gbc.c(),  0x5f);
        EXPECT(gbc.d(),  0xb4);
        EXPECT(gbc.e(),  0x1b);
        EXPECT(gbc.h(),  0xe);
        EXPECT(gbc.l(),  0x89);
        EXPECT(gbc.sp(), 0xbab4);
        EXPECT(gbc.pc(), 0x603b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0214
        gbc.setState(0x447d, 0xf51c, 0xf240, 0xcd3a, 0x29cb, 0x47cf, 0x0, 0x1);
        gbc.writeMem(0x447d, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x42);
        EXPECT(gbc.b(),  0xcd);
        EXPECT(gbc.c(),  0x3a);
        EXPECT(gbc.d(),  0x29);
        EXPECT(gbc.e(),  0xcb);
        EXPECT(gbc.h(),  0x47);
        EXPECT(gbc.l(),  0xcf);
        EXPECT(gbc.sp(), 0xf51c);
        EXPECT(gbc.pc(), 0x447e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0215
        gbc.setState(0x3779, 0x48fb, 0x7ad0, 0x8f92, 0x7f55, 0x2145, 0x0, 0x0);
        gbc.writeMem(0x3779, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0x8f);
        EXPECT(gbc.c(),  0x92);
        EXPECT(gbc.d(),  0x7f);
        EXPECT(gbc.e(),  0x55);
        EXPECT(gbc.h(),  0x21);
        EXPECT(gbc.l(),  0x45);
        EXPECT(gbc.sp(), 0x48fb);
        EXPECT(gbc.pc(), 0x377a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0216
        gbc.setState(0x7e03, 0x700b, 0xaea0, 0x6cbb, 0xd30b, 0x762d, 0x1, 0x0);
        gbc.writeMem(0x7e03, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x26);
        EXPECT(gbc.b(),  0x6c);
        EXPECT(gbc.c(),  0xbb);
        EXPECT(gbc.d(),  0xd3);
        EXPECT(gbc.e(),  0xb);
        EXPECT(gbc.h(),  0x76);
        EXPECT(gbc.l(),  0x2d);
        EXPECT(gbc.sp(), 0x700b);
        EXPECT(gbc.pc(), 0x7e04);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0217
        gbc.setState(0xe3d5, 0x68b, 0x570, 0x6806, 0x5c0e, 0x3c67, 0x0, 0x0);
        gbc.writeMem(0xe3d5, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0x68);
        EXPECT(gbc.c(),  0x6);
        EXPECT(gbc.d(),  0x5c);
        EXPECT(gbc.e(),  0xe);
        EXPECT(gbc.h(),  0x3c);
        EXPECT(gbc.l(),  0x67);
        EXPECT(gbc.sp(), 0x68b);
        EXPECT(gbc.pc(), 0xe3d6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe3d5), 0xa4);
        // A4 0218
        gbc.setState(0x342f, 0xecd1, 0x1c10, 0x9702, 0x6183, 0xdc98, 0x0, 0x1);
        gbc.writeMem(0x342f, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1c);
        EXPECT(gbc.b(),  0x97);
        EXPECT(gbc.c(),  0x2);
        EXPECT(gbc.d(),  0x61);
        EXPECT(gbc.e(),  0x83);
        EXPECT(gbc.h(),  0xdc);
        EXPECT(gbc.l(),  0x98);
        EXPECT(gbc.sp(), 0xecd1);
        EXPECT(gbc.pc(), 0x3430);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0219
        gbc.setState(0xef4f, 0x4ee8, 0x1010, 0x608a, 0x3a04, 0xe2a6, 0x0, 0x1);
        gbc.writeMem(0xef4f, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x60);
        EXPECT(gbc.c(),  0x8a);
        EXPECT(gbc.d(),  0x3a);
        EXPECT(gbc.e(),  0x4);
        EXPECT(gbc.h(),  0xe2);
        EXPECT(gbc.l(),  0xa6);
        EXPECT(gbc.sp(), 0x4ee8);
        EXPECT(gbc.pc(), 0xef50);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xef4f), 0xa4);
        // A4 021A
        gbc.setState(0x80e4, 0xbd0c, 0x950, 0xda84, 0x352, 0xe27a, 0x1, 0x1);
        gbc.writeMem(0x80e4, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0xda);
        EXPECT(gbc.c(),  0x84);
        EXPECT(gbc.d(),  0x3);
        EXPECT(gbc.e(),  0x52);
        EXPECT(gbc.h(),  0xe2);
        EXPECT(gbc.l(),  0x7a);
        EXPECT(gbc.sp(), 0xbd0c);
        EXPECT(gbc.pc(), 0x80e5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x80e4), 0xa4);
        // A4 021C
        gbc.setState(0xb68, 0xc36e, 0x7dc0, 0x4055, 0xd47c, 0x50e8, 0x1, 0x1);
        gbc.writeMem(0xb68, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x50);
        EXPECT(gbc.b(),  0x40);
        EXPECT(gbc.c(),  0x55);
        EXPECT(gbc.d(),  0xd4);
        EXPECT(gbc.e(),  0x7c);
        EXPECT(gbc.h(),  0x50);
        EXPECT(gbc.l(),  0xe8);
        EXPECT(gbc.sp(), 0xc36e);
        EXPECT(gbc.pc(), 0xb69);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 021D
        gbc.setState(0x2a57, 0x5b1b, 0xf040, 0xe9da, 0xd4fc, 0xbbc4, 0x1, 0x0);
        gbc.writeMem(0x2a57, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb0);
        EXPECT(gbc.b(),  0xe9);
        EXPECT(gbc.c(),  0xda);
        EXPECT(gbc.d(),  0xd4);
        EXPECT(gbc.e(),  0xfc);
        EXPECT(gbc.h(),  0xbb);
        EXPECT(gbc.l(),  0xc4);
        EXPECT(gbc.sp(), 0x5b1b);
        EXPECT(gbc.pc(), 0x2a58);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 021E
        gbc.setState(0xde53, 0x36f4, 0x6aa0, 0x6606, 0x89d8, 0x2a60, 0x1, 0x0);
        gbc.writeMem(0xde53, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2a);
        EXPECT(gbc.b(),  0x66);
        EXPECT(gbc.c(),  0x6);
        EXPECT(gbc.d(),  0x89);
        EXPECT(gbc.e(),  0xd8);
        EXPECT(gbc.h(),  0x2a);
        EXPECT(gbc.l(),  0x60);
        EXPECT(gbc.sp(), 0x36f4);
        EXPECT(gbc.pc(), 0xde54);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xde53), 0xa4);
        // A4 021F
        gbc.setState(0xdfbb, 0xa548, 0xd8a0, 0xdfde, 0xf2a6, 0x5469, 0x0, 0x1);
        gbc.writeMem(0xdfbb, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x50);
        EXPECT(gbc.b(),  0xdf);
        EXPECT(gbc.c(),  0xde);
        EXPECT(gbc.d(),  0xf2);
        EXPECT(gbc.e(),  0xa6);
        EXPECT(gbc.h(),  0x54);
        EXPECT(gbc.l(),  0x69);
        EXPECT(gbc.sp(), 0xa548);
        EXPECT(gbc.pc(), 0xdfbc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdfbb), 0xa4);
        // A4 0220
        gbc.setState(0x556a, 0x8344, 0x8180, 0xa891, 0x5e75, 0xdfed, 0x0, 0x0);
        gbc.writeMem(0x556a, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x81);
        EXPECT(gbc.b(),  0xa8);
        EXPECT(gbc.c(),  0x91);
        EXPECT(gbc.d(),  0x5e);
        EXPECT(gbc.e(),  0x75);
        EXPECT(gbc.h(),  0xdf);
        EXPECT(gbc.l(),  0xed);
        EXPECT(gbc.sp(), 0x8344);
        EXPECT(gbc.pc(), 0x556b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0221
        gbc.setState(0x62d2, 0xc29c, 0x34f0, 0x2e0a, 0xe536, 0x3d14, 0x0, 0x0);
        gbc.writeMem(0x62d2, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x34);
        EXPECT(gbc.b(),  0x2e);
        EXPECT(gbc.c(),  0xa);
        EXPECT(gbc.d(),  0xe5);
        EXPECT(gbc.e(),  0x36);
        EXPECT(gbc.h(),  0x3d);
        EXPECT(gbc.l(),  0x14);
        EXPECT(gbc.sp(), 0xc29c);
        EXPECT(gbc.pc(), 0x62d3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0222
        gbc.setState(0xcdb7, 0xeda4, 0x9ec0, 0x26ff, 0x86c2, 0x679c, 0x1, 0x1);
        gbc.writeMem(0xcdb7, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x6);
        EXPECT(gbc.b(),  0x26);
        EXPECT(gbc.c(),  0xff);
        EXPECT(gbc.d(),  0x86);
        EXPECT(gbc.e(),  0xc2);
        EXPECT(gbc.h(),  0x67);
        EXPECT(gbc.l(),  0x9c);
        EXPECT(gbc.sp(), 0xeda4);
        EXPECT(gbc.pc(), 0xcdb8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcdb7), 0xa4);
        // A4 0223
        gbc.setState(0xd1d6, 0xba32, 0x9820, 0x8eb7, 0x6389, 0xdb10, 0x1, 0x1);
        gbc.writeMem(0xd1d6, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x98);
        EXPECT(gbc.b(),  0x8e);
        EXPECT(gbc.c(),  0xb7);
        EXPECT(gbc.d(),  0x63);
        EXPECT(gbc.e(),  0x89);
        EXPECT(gbc.h(),  0xdb);
        EXPECT(gbc.l(),  0x10);
        EXPECT(gbc.sp(), 0xba32);
        EXPECT(gbc.pc(), 0xd1d7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd1d6), 0xa4);
        // A4 0224
        gbc.setState(0xbe3f, 0x1692, 0x9400, 0xd0f8, 0x93d2, 0xc946, 0x1, 0x0);
        gbc.writeMem(0xbe3f, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0xd0);
        EXPECT(gbc.c(),  0xf8);
        EXPECT(gbc.d(),  0x93);
        EXPECT(gbc.e(),  0xd2);
        EXPECT(gbc.h(),  0xc9);
        EXPECT(gbc.l(),  0x46);
        EXPECT(gbc.sp(), 0x1692);
        EXPECT(gbc.pc(), 0xbe40);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbe3f), 0xa4);
        // A4 0225
        gbc.setState(0x4071, 0x428f, 0xd630, 0xdfad, 0xd85d, 0x2efa, 0x1, 0x0);
        gbc.writeMem(0x4071, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x6);
        EXPECT(gbc.b(),  0xdf);
        EXPECT(gbc.c(),  0xad);
        EXPECT(gbc.d(),  0xd8);
        EXPECT(gbc.e(),  0x5d);
        EXPECT(gbc.h(),  0x2e);
        EXPECT(gbc.l(),  0xfa);
        EXPECT(gbc.sp(), 0x428f);
        EXPECT(gbc.pc(), 0x4072);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0226
        gbc.setState(0x3da6, 0x24a, 0x3850, 0x34d5, 0xef0, 0xc08e, 0x1, 0x0);
        gbc.writeMem(0x3da6, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x34);
        EXPECT(gbc.c(),  0xd5);
        EXPECT(gbc.d(),  0xe);
        EXPECT(gbc.e(),  0xf0);
        EXPECT(gbc.h(),  0xc0);
        EXPECT(gbc.l(),  0x8e);
        EXPECT(gbc.sp(), 0x24a);
        EXPECT(gbc.pc(), 0x3da7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0227
        gbc.setState(0x19e0, 0xcdb2, 0x9b00, 0x81b1, 0x53a8, 0x591d, 0x1, 0x0);
        gbc.writeMem(0x19e0, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x19);
        EXPECT(gbc.b(),  0x81);
        EXPECT(gbc.c(),  0xb1);
        EXPECT(gbc.d(),  0x53);
        EXPECT(gbc.e(),  0xa8);
        EXPECT(gbc.h(),  0x59);
        EXPECT(gbc.l(),  0x1d);
        EXPECT(gbc.sp(), 0xcdb2);
        EXPECT(gbc.pc(), 0x19e1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0228
        gbc.setState(0xc8ac, 0x9a89, 0x8c90, 0xc905, 0x37a9, 0x258d, 0x1, 0x0);
        gbc.writeMem(0xc8ac, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0xc9);
        EXPECT(gbc.c(),  0x5);
        EXPECT(gbc.d(),  0x37);
        EXPECT(gbc.e(),  0xa9);
        EXPECT(gbc.h(),  0x25);
        EXPECT(gbc.l(),  0x8d);
        EXPECT(gbc.sp(), 0x9a89);
        EXPECT(gbc.pc(), 0xc8ad);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc8ac), 0xa4);
        // A4 0229
        gbc.setState(0x5279, 0x4bef, 0x13d0, 0xfaac, 0x7bbe, 0xfc9b, 0x1, 0x0);
        gbc.writeMem(0x5279, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0xfa);
        EXPECT(gbc.c(),  0xac);
        EXPECT(gbc.d(),  0x7b);
        EXPECT(gbc.e(),  0xbe);
        EXPECT(gbc.h(),  0xfc);
        EXPECT(gbc.l(),  0x9b);
        EXPECT(gbc.sp(), 0x4bef);
        EXPECT(gbc.pc(), 0x527a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 022A
        gbc.setState(0x3d74, 0xcc5a, 0xd630, 0x194d, 0x9fc, 0x8055, 0x0, 0x1);
        gbc.writeMem(0x3d74, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0x19);
        EXPECT(gbc.c(),  0x4d);
        EXPECT(gbc.d(),  0x9);
        EXPECT(gbc.e(),  0xfc);
        EXPECT(gbc.h(),  0x80);
        EXPECT(gbc.l(),  0x55);
        EXPECT(gbc.sp(), 0xcc5a);
        EXPECT(gbc.pc(), 0x3d75);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 022B
        gbc.setState(0x6620, 0xfa9e, 0x9da0, 0x78a1, 0x6746, 0x1c3a, 0x0, 0x0);
        gbc.writeMem(0x6620, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1c);
        EXPECT(gbc.b(),  0x78);
        EXPECT(gbc.c(),  0xa1);
        EXPECT(gbc.d(),  0x67);
        EXPECT(gbc.e(),  0x46);
        EXPECT(gbc.h(),  0x1c);
        EXPECT(gbc.l(),  0x3a);
        EXPECT(gbc.sp(), 0xfa9e);
        EXPECT(gbc.pc(), 0x6621);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 022C
        gbc.setState(0x650e, 0x6df3, 0x5fa0, 0xc284, 0xe4ef, 0xaec8, 0x1, 0x0);
        gbc.writeMem(0x650e, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe);
        EXPECT(gbc.b(),  0xc2);
        EXPECT(gbc.c(),  0x84);
        EXPECT(gbc.d(),  0xe4);
        EXPECT(gbc.e(),  0xef);
        EXPECT(gbc.h(),  0xae);
        EXPECT(gbc.l(),  0xc8);
        EXPECT(gbc.sp(), 0x6df3);
        EXPECT(gbc.pc(), 0x650f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 022D
        gbc.setState(0xad7c, 0x7a6b, 0xcb50, 0x7db5, 0x74a1, 0x69b, 0x0, 0x0);
        gbc.writeMem(0xad7c, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0x7d);
        EXPECT(gbc.c(),  0xb5);
        EXPECT(gbc.d(),  0x74);
        EXPECT(gbc.e(),  0xa1);
        EXPECT(gbc.h(),  0x6);
        EXPECT(gbc.l(),  0x9b);
        EXPECT(gbc.sp(), 0x7a6b);
        EXPECT(gbc.pc(), 0xad7d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xad7c), 0xa4);
        // A4 022E
        gbc.setState(0x951a, 0xc361, 0x1230, 0xace9, 0xc6a2, 0x50d2, 0x1, 0x1);
        gbc.writeMem(0x951a, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0xac);
        EXPECT(gbc.c(),  0xe9);
        EXPECT(gbc.d(),  0xc6);
        EXPECT(gbc.e(),  0xa2);
        EXPECT(gbc.h(),  0x50);
        EXPECT(gbc.l(),  0xd2);
        EXPECT(gbc.sp(), 0xc361);
        EXPECT(gbc.pc(), 0x951b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x951a), 0xa4);
        // A4 022F
        gbc.setState(0xe326, 0x8454, 0xe2a0, 0xc171, 0x1d4e, 0x8781, 0x0, 0x0);
        gbc.writeMem(0xe326, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x82);
        EXPECT(gbc.b(),  0xc1);
        EXPECT(gbc.c(),  0x71);
        EXPECT(gbc.d(),  0x1d);
        EXPECT(gbc.e(),  0x4e);
        EXPECT(gbc.h(),  0x87);
        EXPECT(gbc.l(),  0x81);
        EXPECT(gbc.sp(), 0x8454);
        EXPECT(gbc.pc(), 0xe327);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe326), 0xa4);
        // A4 0230
        gbc.setState(0x956d, 0x16f1, 0x2480, 0x3281, 0x70bb, 0x416d, 0x0, 0x0);
        gbc.writeMem(0x956d, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x32);
        EXPECT(gbc.c(),  0x81);
        EXPECT(gbc.d(),  0x70);
        EXPECT(gbc.e(),  0xbb);
        EXPECT(gbc.h(),  0x41);
        EXPECT(gbc.l(),  0x6d);
        EXPECT(gbc.sp(), 0x16f1);
        EXPECT(gbc.pc(), 0x956e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x956d), 0xa4);
        // A4 0231
        gbc.setState(0x532b, 0xdcd1, 0x6d50, 0x115a, 0x6dbc, 0xbad1, 0x0, 0x1);
        gbc.writeMem(0x532b, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0x11);
        EXPECT(gbc.c(),  0x5a);
        EXPECT(gbc.d(),  0x6d);
        EXPECT(gbc.e(),  0xbc);
        EXPECT(gbc.h(),  0xba);
        EXPECT(gbc.l(),  0xd1);
        EXPECT(gbc.sp(), 0xdcd1);
        EXPECT(gbc.pc(), 0x532c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0232
        gbc.setState(0xab1f, 0xfc74, 0xfd80, 0xd45a, 0x4c2b, 0xa692, 0x1, 0x0);
        gbc.writeMem(0xab1f, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa4);
        EXPECT(gbc.b(),  0xd4);
        EXPECT(gbc.c(),  0x5a);
        EXPECT(gbc.d(),  0x4c);
        EXPECT(gbc.e(),  0x2b);
        EXPECT(gbc.h(),  0xa6);
        EXPECT(gbc.l(),  0x92);
        EXPECT(gbc.sp(), 0xfc74);
        EXPECT(gbc.pc(), 0xab20);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xab1f), 0xa4);
        // A4 0233
        gbc.setState(0x2008, 0x4b28, 0xe4f0, 0x4763, 0xc9ff, 0x57c3, 0x1, 0x1);
        gbc.writeMem(0x2008, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x44);
        EXPECT(gbc.b(),  0x47);
        EXPECT(gbc.c(),  0x63);
        EXPECT(gbc.d(),  0xc9);
        EXPECT(gbc.e(),  0xff);
        EXPECT(gbc.h(),  0x57);
        EXPECT(gbc.l(),  0xc3);
        EXPECT(gbc.sp(), 0x4b28);
        EXPECT(gbc.pc(), 0x2009);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0234
        gbc.setState(0x5d2d, 0xf24b, 0x2d00, 0x3271, 0x7398, 0xfd6d, 0x1, 0x0);
        gbc.writeMem(0x5d2d, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2d);
        EXPECT(gbc.b(),  0x32);
        EXPECT(gbc.c(),  0x71);
        EXPECT(gbc.d(),  0x73);
        EXPECT(gbc.e(),  0x98);
        EXPECT(gbc.h(),  0xfd);
        EXPECT(gbc.l(),  0x6d);
        EXPECT(gbc.sp(), 0xf24b);
        EXPECT(gbc.pc(), 0x5d2e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0235
        gbc.setState(0x7037, 0x2737, 0xa210, 0xfc82, 0xfae5, 0xcc09, 0x1, 0x1);
        gbc.writeMem(0x7037, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0xfc);
        EXPECT(gbc.c(),  0x82);
        EXPECT(gbc.d(),  0xfa);
        EXPECT(gbc.e(),  0xe5);
        EXPECT(gbc.h(),  0xcc);
        EXPECT(gbc.l(),  0x9);
        EXPECT(gbc.sp(), 0x2737);
        EXPECT(gbc.pc(), 0x7038);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0236
        gbc.setState(0x1ee0, 0x22bf, 0xee20, 0x5688, 0xf7ff, 0xa42e, 0x0, 0x1);
        gbc.writeMem(0x1ee0, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa4);
        EXPECT(gbc.b(),  0x56);
        EXPECT(gbc.c(),  0x88);
        EXPECT(gbc.d(),  0xf7);
        EXPECT(gbc.e(),  0xff);
        EXPECT(gbc.h(),  0xa4);
        EXPECT(gbc.l(),  0x2e);
        EXPECT(gbc.sp(), 0x22bf);
        EXPECT(gbc.pc(), 0x1ee1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0237
        gbc.setState(0xc5b6, 0xbb31, 0xeb40, 0x142a, 0x63b8, 0x3b1d, 0x1, 0x0);
        gbc.writeMem(0xc5b6, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2b);
        EXPECT(gbc.b(),  0x14);
        EXPECT(gbc.c(),  0x2a);
        EXPECT(gbc.d(),  0x63);
        EXPECT(gbc.e(),  0xb8);
        EXPECT(gbc.h(),  0x3b);
        EXPECT(gbc.l(),  0x1d);
        EXPECT(gbc.sp(), 0xbb31);
        EXPECT(gbc.pc(), 0xc5b7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc5b6), 0xa4);
        // A4 0238
        gbc.setState(0x376b, 0x96de, 0x1a50, 0xc361, 0x83e7, 0x511, 0x1, 0x0);
        gbc.writeMem(0x376b, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0xc3);
        EXPECT(gbc.c(),  0x61);
        EXPECT(gbc.d(),  0x83);
        EXPECT(gbc.e(),  0xe7);
        EXPECT(gbc.h(),  0x5);
        EXPECT(gbc.l(),  0x11);
        EXPECT(gbc.sp(), 0x96de);
        EXPECT(gbc.pc(), 0x376c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0239
        gbc.setState(0x94e1, 0x807d, 0xb090, 0x686b, 0x52c4, 0x41a4, 0x0, 0x1);
        gbc.writeMem(0x94e1, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x68);
        EXPECT(gbc.c(),  0x6b);
        EXPECT(gbc.d(),  0x52);
        EXPECT(gbc.e(),  0xc4);
        EXPECT(gbc.h(),  0x41);
        EXPECT(gbc.l(),  0xa4);
        EXPECT(gbc.sp(), 0x807d);
        EXPECT(gbc.pc(), 0x94e2);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x94e1), 0xa4);
        // A4 023A
        gbc.setState(0xd513, 0x651, 0x88d0, 0x3b8a, 0xc5f5, 0xb8cf, 0x1, 0x1);
        gbc.writeMem(0xd513, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x88);
        EXPECT(gbc.b(),  0x3b);
        EXPECT(gbc.c(),  0x8a);
        EXPECT(gbc.d(),  0xc5);
        EXPECT(gbc.e(),  0xf5);
        EXPECT(gbc.h(),  0xb8);
        EXPECT(gbc.l(),  0xcf);
        EXPECT(gbc.sp(), 0x651);
        EXPECT(gbc.pc(), 0xd514);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd513), 0xa4);
        // A4 023B
        gbc.setState(0xcb5b, 0x508f, 0xec10, 0x5d7a, 0x3d50, 0x3bdf, 0x0, 0x1);
        gbc.writeMem(0xcb5b, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0x5d);
        EXPECT(gbc.c(),  0x7a);
        EXPECT(gbc.d(),  0x3d);
        EXPECT(gbc.e(),  0x50);
        EXPECT(gbc.h(),  0x3b);
        EXPECT(gbc.l(),  0xdf);
        EXPECT(gbc.sp(), 0x508f);
        EXPECT(gbc.pc(), 0xcb5c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcb5b), 0xa4);
        // A4 023C
        gbc.setState(0x1b33, 0x4dba, 0xc40, 0xae0e, 0xe7f0, 0x21e4, 0x0, 0x1);
        gbc.writeMem(0x1b33, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0xae);
        EXPECT(gbc.c(),  0xe);
        EXPECT(gbc.d(),  0xe7);
        EXPECT(gbc.e(),  0xf0);
        EXPECT(gbc.h(),  0x21);
        EXPECT(gbc.l(),  0xe4);
        EXPECT(gbc.sp(), 0x4dba);
        EXPECT(gbc.pc(), 0x1b34);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 023D
        gbc.setState(0x6b95, 0x86eb, 0xfcc0, 0x4dc7, 0xc801, 0xef23, 0x0, 0x0);
        gbc.writeMem(0x6b95, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xec);
        EXPECT(gbc.b(),  0x4d);
        EXPECT(gbc.c(),  0xc7);
        EXPECT(gbc.d(),  0xc8);
        EXPECT(gbc.e(),  0x1);
        EXPECT(gbc.h(),  0xef);
        EXPECT(gbc.l(),  0x23);
        EXPECT(gbc.sp(), 0x86eb);
        EXPECT(gbc.pc(), 0x6b96);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 023F
        gbc.setState(0x53b5, 0xcba1, 0x8f00, 0xa706, 0x31a6, 0x477a, 0x1, 0x0);
        gbc.writeMem(0x53b5, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x7);
        EXPECT(gbc.b(),  0xa7);
        EXPECT(gbc.c(),  0x6);
        EXPECT(gbc.d(),  0x31);
        EXPECT(gbc.e(),  0xa6);
        EXPECT(gbc.h(),  0x47);
        EXPECT(gbc.l(),  0x7a);
        EXPECT(gbc.sp(), 0xcba1);
        EXPECT(gbc.pc(), 0x53b6);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0240
        gbc.setState(0x6c78, 0x53d3, 0x7980, 0xfdc2, 0x66b2, 0xbda8, 0x0, 0x1);
        gbc.writeMem(0x6c78, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x39);
        EXPECT(gbc.b(),  0xfd);
        EXPECT(gbc.c(),  0xc2);
        EXPECT(gbc.d(),  0x66);
        EXPECT(gbc.e(),  0xb2);
        EXPECT(gbc.h(),  0xbd);
        EXPECT(gbc.l(),  0xa8);
        EXPECT(gbc.sp(), 0x53d3);
        EXPECT(gbc.pc(), 0x6c79);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0241
        gbc.setState(0x66d2, 0xd431, 0x9e0, 0xbad4, 0x6991, 0xcf56, 0x1, 0x0);
        gbc.writeMem(0x66d2, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x9);
        EXPECT(gbc.b(),  0xba);
        EXPECT(gbc.c(),  0xd4);
        EXPECT(gbc.d(),  0x69);
        EXPECT(gbc.e(),  0x91);
        EXPECT(gbc.h(),  0xcf);
        EXPECT(gbc.l(),  0x56);
        EXPECT(gbc.sp(), 0xd431);
        EXPECT(gbc.pc(), 0x66d3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0242
        gbc.setState(0xd523, 0xa236, 0x97c0, 0xeace, 0x5bb9, 0x6613, 0x1, 0x0);
        gbc.writeMem(0xd523, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x6);
        EXPECT(gbc.b(),  0xea);
        EXPECT(gbc.c(),  0xce);
        EXPECT(gbc.d(),  0x5b);
        EXPECT(gbc.e(),  0xb9);
        EXPECT(gbc.h(),  0x66);
        EXPECT(gbc.l(),  0x13);
        EXPECT(gbc.sp(), 0xa236);
        EXPECT(gbc.pc(), 0xd524);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd523), 0xa4);
        // A4 0243
        gbc.setState(0x94c3, 0xbef3, 0x5b30, 0x3d0c, 0x1819, 0x6345, 0x0, 0x1);
        gbc.writeMem(0x94c3, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x43);
        EXPECT(gbc.b(),  0x3d);
        EXPECT(gbc.c(),  0xc);
        EXPECT(gbc.d(),  0x18);
        EXPECT(gbc.e(),  0x19);
        EXPECT(gbc.h(),  0x63);
        EXPECT(gbc.l(),  0x45);
        EXPECT(gbc.sp(), 0xbef3);
        EXPECT(gbc.pc(), 0x94c4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x94c3), 0xa4);
        // A4 0244
        gbc.setState(0x7b17, 0x5704, 0x1690, 0xaa7, 0x5dd2, 0xa9ab, 0x1, 0x0);
        gbc.writeMem(0x7b17, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0xa);
        EXPECT(gbc.c(),  0xa7);
        EXPECT(gbc.d(),  0x5d);
        EXPECT(gbc.e(),  0xd2);
        EXPECT(gbc.h(),  0xa9);
        EXPECT(gbc.l(),  0xab);
        EXPECT(gbc.sp(), 0x5704);
        EXPECT(gbc.pc(), 0x7b18);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0245
        gbc.setState(0x7e49, 0xa4b, 0x2840, 0x2d2c, 0x6b64, 0xb457, 0x1, 0x0);
        gbc.writeMem(0x7e49, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0x2d);
        EXPECT(gbc.c(),  0x2c);
        EXPECT(gbc.d(),  0x6b);
        EXPECT(gbc.e(),  0x64);
        EXPECT(gbc.h(),  0xb4);
        EXPECT(gbc.l(),  0x57);
        EXPECT(gbc.sp(), 0xa4b);
        EXPECT(gbc.pc(), 0x7e4a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0246
        gbc.setState(0x3032, 0x6f43, 0xfe90, 0x8cea, 0xa94, 0xe03b, 0x0, 0x0);
        gbc.writeMem(0x3032, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe0);
        EXPECT(gbc.b(),  0x8c);
        EXPECT(gbc.c(),  0xea);
        EXPECT(gbc.d(),  0xa);
        EXPECT(gbc.e(),  0x94);
        EXPECT(gbc.h(),  0xe0);
        EXPECT(gbc.l(),  0x3b);
        EXPECT(gbc.sp(), 0x6f43);
        EXPECT(gbc.pc(), 0x3033);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0247
        gbc.setState(0x7136, 0xb717, 0x6900, 0x18ba, 0x74c8, 0xd2ae, 0x1, 0x0);
        gbc.writeMem(0x7136, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0x18);
        EXPECT(gbc.c(),  0xba);
        EXPECT(gbc.d(),  0x74);
        EXPECT(gbc.e(),  0xc8);
        EXPECT(gbc.h(),  0xd2);
        EXPECT(gbc.l(),  0xae);
        EXPECT(gbc.sp(), 0xb717);
        EXPECT(gbc.pc(), 0x7137);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0248
        gbc.setState(0xa921, 0xb1f8, 0x4e40, 0xac65, 0x76bd, 0x4533, 0x1, 0x1);
        gbc.writeMem(0xa921, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x44);
        EXPECT(gbc.b(),  0xac);
        EXPECT(gbc.c(),  0x65);
        EXPECT(gbc.d(),  0x76);
        EXPECT(gbc.e(),  0xbd);
        EXPECT(gbc.h(),  0x45);
        EXPECT(gbc.l(),  0x33);
        EXPECT(gbc.sp(), 0xb1f8);
        EXPECT(gbc.pc(), 0xa922);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa921), 0xa4);
        // A4 0249
        gbc.setState(0x580a, 0xbc90, 0xcc30, 0xf5c0, 0x6083, 0xd230, 0x1, 0x1);
        gbc.writeMem(0x580a, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc0);
        EXPECT(gbc.b(),  0xf5);
        EXPECT(gbc.c(),  0xc0);
        EXPECT(gbc.d(),  0x60);
        EXPECT(gbc.e(),  0x83);
        EXPECT(gbc.h(),  0xd2);
        EXPECT(gbc.l(),  0x30);
        EXPECT(gbc.sp(), 0xbc90);
        EXPECT(gbc.pc(), 0x580b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 024A
        gbc.setState(0x4418, 0x4cd9, 0xea00, 0x2065, 0xc2b, 0xae15, 0x0, 0x1);
        gbc.writeMem(0x4418, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xaa);
        EXPECT(gbc.b(),  0x20);
        EXPECT(gbc.c(),  0x65);
        EXPECT(gbc.d(),  0xc);
        EXPECT(gbc.e(),  0x2b);
        EXPECT(gbc.h(),  0xae);
        EXPECT(gbc.l(),  0x15);
        EXPECT(gbc.sp(), 0x4cd9);
        EXPECT(gbc.pc(), 0x4419);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 024B
        gbc.setState(0x2b19, 0xcc41, 0x6ef0, 0x25b9, 0x2f34, 0x23e2, 0x0, 0x1);
        gbc.writeMem(0x2b19, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x22);
        EXPECT(gbc.b(),  0x25);
        EXPECT(gbc.c(),  0xb9);
        EXPECT(gbc.d(),  0x2f);
        EXPECT(gbc.e(),  0x34);
        EXPECT(gbc.h(),  0x23);
        EXPECT(gbc.l(),  0xe2);
        EXPECT(gbc.sp(), 0xcc41);
        EXPECT(gbc.pc(), 0x2b1a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 024C
        gbc.setState(0xc054, 0x6b77, 0xf90, 0x4476, 0xe20c, 0xa93, 0x0, 0x1);
        gbc.writeMem(0xc054, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa);
        EXPECT(gbc.b(),  0x44);
        EXPECT(gbc.c(),  0x76);
        EXPECT(gbc.d(),  0xe2);
        EXPECT(gbc.e(),  0xc);
        EXPECT(gbc.h(),  0xa);
        EXPECT(gbc.l(),  0x93);
        EXPECT(gbc.sp(), 0x6b77);
        EXPECT(gbc.pc(), 0xc055);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc054), 0xa4);
        // A4 024D
        gbc.setState(0xc716, 0xbe3a, 0x28c0, 0xcdca, 0xef01, 0x3de9, 0x1, 0x0);
        gbc.writeMem(0xc716, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0xcd);
        EXPECT(gbc.c(),  0xca);
        EXPECT(gbc.d(),  0xef);
        EXPECT(gbc.e(),  0x1);
        EXPECT(gbc.h(),  0x3d);
        EXPECT(gbc.l(),  0xe9);
        EXPECT(gbc.sp(), 0xbe3a);
        EXPECT(gbc.pc(), 0xc717);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc716), 0xa4);
        // A4 024F
        gbc.setState(0x2e0a, 0x766d, 0x16e0, 0x427a, 0xd357, 0xade2, 0x0, 0x1);
        gbc.writeMem(0x2e0a, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0x42);
        EXPECT(gbc.c(),  0x7a);
        EXPECT(gbc.d(),  0xd3);
        EXPECT(gbc.e(),  0x57);
        EXPECT(gbc.h(),  0xad);
        EXPECT(gbc.l(),  0xe2);
        EXPECT(gbc.sp(), 0x766d);
        EXPECT(gbc.pc(), 0x2e0b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0250
        gbc.setState(0x83f6, 0x659c, 0xf5f0, 0x1085, 0x72c0, 0x9969, 0x0, 0x0);
        gbc.writeMem(0x83f6, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x91);
        EXPECT(gbc.b(),  0x10);
        EXPECT(gbc.c(),  0x85);
        EXPECT(gbc.d(),  0x72);
        EXPECT(gbc.e(),  0xc0);
        EXPECT(gbc.h(),  0x99);
        EXPECT(gbc.l(),  0x69);
        EXPECT(gbc.sp(), 0x659c);
        EXPECT(gbc.pc(), 0x83f7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x83f6), 0xa4);
        // A4 0252
        gbc.setState(0x91b8, 0xef3f, 0x4f90, 0xf861, 0xa4f1, 0x447d, 0x0, 0x1);
        gbc.writeMem(0x91b8, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x44);
        EXPECT(gbc.b(),  0xf8);
        EXPECT(gbc.c(),  0x61);
        EXPECT(gbc.d(),  0xa4);
        EXPECT(gbc.e(),  0xf1);
        EXPECT(gbc.h(),  0x44);
        EXPECT(gbc.l(),  0x7d);
        EXPECT(gbc.sp(), 0xef3f);
        EXPECT(gbc.pc(), 0x91b9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x91b8), 0xa4);
        // A4 0253
        gbc.setState(0x44df, 0x8c93, 0x1da0, 0x7f78, 0x3cd4, 0xc36e, 0x1, 0x1);
        gbc.writeMem(0x44df, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0x7f);
        EXPECT(gbc.c(),  0x78);
        EXPECT(gbc.d(),  0x3c);
        EXPECT(gbc.e(),  0xd4);
        EXPECT(gbc.h(),  0xc3);
        EXPECT(gbc.l(),  0x6e);
        EXPECT(gbc.sp(), 0x8c93);
        EXPECT(gbc.pc(), 0x44e0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0254
        gbc.setState(0x3315, 0x6607, 0xc5c0, 0xdb5b, 0x609e, 0x20b6, 0x0, 0x0);
        gbc.writeMem(0x3315, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0xdb);
        EXPECT(gbc.c(),  0x5b);
        EXPECT(gbc.d(),  0x60);
        EXPECT(gbc.e(),  0x9e);
        EXPECT(gbc.h(),  0x20);
        EXPECT(gbc.l(),  0xb6);
        EXPECT(gbc.sp(), 0x6607);
        EXPECT(gbc.pc(), 0x3316);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0255
        gbc.setState(0x963b, 0x8c28, 0x3a90, 0x4340, 0xcd67, 0xaf98, 0x0, 0x0);
        gbc.writeMem(0x963b, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2a);
        EXPECT(gbc.b(),  0x43);
        EXPECT(gbc.c(),  0x40);
        EXPECT(gbc.d(),  0xcd);
        EXPECT(gbc.e(),  0x67);
        EXPECT(gbc.h(),  0xaf);
        EXPECT(gbc.l(),  0x98);
        EXPECT(gbc.sp(), 0x8c28);
        EXPECT(gbc.pc(), 0x963c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x963b), 0xa4);
        // A4 0256
        gbc.setState(0x7fbc, 0x9c7, 0xe980, 0x26e1, 0xceb8, 0x2a8a, 0x0, 0x1);
        gbc.writeMem(0x7fbc, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0x26);
        EXPECT(gbc.c(),  0xe1);
        EXPECT(gbc.d(),  0xce);
        EXPECT(gbc.e(),  0xb8);
        EXPECT(gbc.h(),  0x2a);
        EXPECT(gbc.l(),  0x8a);
        EXPECT(gbc.sp(), 0x9c7);
        EXPECT(gbc.pc(), 0x7fbd);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0257
        gbc.setState(0x392f, 0x3245, 0xe240, 0x9b51, 0xe3ad, 0x3e6a, 0x0, 0x1);
        gbc.writeMem(0x392f, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x22);
        EXPECT(gbc.b(),  0x9b);
        EXPECT(gbc.c(),  0x51);
        EXPECT(gbc.d(),  0xe3);
        EXPECT(gbc.e(),  0xad);
        EXPECT(gbc.h(),  0x3e);
        EXPECT(gbc.l(),  0x6a);
        EXPECT(gbc.sp(), 0x3245);
        EXPECT(gbc.pc(), 0x3930);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0258
        gbc.setState(0x5fcb, 0xf40a, 0xfb80, 0x4133, 0x666e, 0xba14, 0x0, 0x0);
        gbc.writeMem(0x5fcb, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xba);
        EXPECT(gbc.b(),  0x41);
        EXPECT(gbc.c(),  0x33);
        EXPECT(gbc.d(),  0x66);
        EXPECT(gbc.e(),  0x6e);
        EXPECT(gbc.h(),  0xba);
        EXPECT(gbc.l(),  0x14);
        EXPECT(gbc.sp(), 0xf40a);
        EXPECT(gbc.pc(), 0x5fcc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0259
        gbc.setState(0x1664, 0x9f54, 0x6ce0, 0xdfa2, 0xd211, 0x28a5, 0x1, 0x1);
        gbc.writeMem(0x1664, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0xdf);
        EXPECT(gbc.c(),  0xa2);
        EXPECT(gbc.d(),  0xd2);
        EXPECT(gbc.e(),  0x11);
        EXPECT(gbc.h(),  0x28);
        EXPECT(gbc.l(),  0xa5);
        EXPECT(gbc.sp(), 0x9f54);
        EXPECT(gbc.pc(), 0x1665);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 025A
        gbc.setState(0xdad4, 0xecdf, 0xb730, 0x2f7d, 0xd16a, 0x36c6, 0x0, 0x0);
        gbc.writeMem(0xdad4, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x36);
        EXPECT(gbc.b(),  0x2f);
        EXPECT(gbc.c(),  0x7d);
        EXPECT(gbc.d(),  0xd1);
        EXPECT(gbc.e(),  0x6a);
        EXPECT(gbc.h(),  0x36);
        EXPECT(gbc.l(),  0xc6);
        EXPECT(gbc.sp(), 0xecdf);
        EXPECT(gbc.pc(), 0xdad5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdad4), 0xa4);
        // A4 025B
        gbc.setState(0x2fbc, 0x1e5b, 0x4ee0, 0x4be5, 0x6bed, 0x4f75, 0x0, 0x0);
        gbc.writeMem(0x2fbc, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4e);
        EXPECT(gbc.b(),  0x4b);
        EXPECT(gbc.c(),  0xe5);
        EXPECT(gbc.d(),  0x6b);
        EXPECT(gbc.e(),  0xed);
        EXPECT(gbc.h(),  0x4f);
        EXPECT(gbc.l(),  0x75);
        EXPECT(gbc.sp(), 0x1e5b);
        EXPECT(gbc.pc(), 0x2fbd);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 025C
        gbc.setState(0x485a, 0xe427, 0xffb0, 0x5022, 0x27ba, 0x432d, 0x0, 0x1);
        gbc.writeMem(0x485a, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x43);
        EXPECT(gbc.b(),  0x50);
        EXPECT(gbc.c(),  0x22);
        EXPECT(gbc.d(),  0x27);
        EXPECT(gbc.e(),  0xba);
        EXPECT(gbc.h(),  0x43);
        EXPECT(gbc.l(),  0x2d);
        EXPECT(gbc.sp(), 0xe427);
        EXPECT(gbc.pc(), 0x485b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 025D
        gbc.setState(0xe108, 0x672, 0x5cd0, 0xae60, 0x3dcd, 0xf567, 0x1, 0x0);
        gbc.writeMem(0xe108, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x54);
        EXPECT(gbc.b(),  0xae);
        EXPECT(gbc.c(),  0x60);
        EXPECT(gbc.d(),  0x3d);
        EXPECT(gbc.e(),  0xcd);
        EXPECT(gbc.h(),  0xf5);
        EXPECT(gbc.l(),  0x67);
        EXPECT(gbc.sp(), 0x672);
        EXPECT(gbc.pc(), 0xe109);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe108), 0xa4);
        // A4 025E
        gbc.setState(0xe71c, 0x172f, 0x1bb0, 0x906f, 0xbf5b, 0x14fc, 0x0, 0x1);
        gbc.writeMem(0xe71c, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0x90);
        EXPECT(gbc.c(),  0x6f);
        EXPECT(gbc.d(),  0xbf);
        EXPECT(gbc.e(),  0x5b);
        EXPECT(gbc.h(),  0x14);
        EXPECT(gbc.l(),  0xfc);
        EXPECT(gbc.sp(), 0x172f);
        EXPECT(gbc.pc(), 0xe71d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe71c), 0xa4);
        // A4 025F
        gbc.setState(0x138d, 0x6f1c, 0xec30, 0x9663, 0xc4ef, 0x39d0, 0x0, 0x1);
        gbc.writeMem(0x138d, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0x96);
        EXPECT(gbc.c(),  0x63);
        EXPECT(gbc.d(),  0xc4);
        EXPECT(gbc.e(),  0xef);
        EXPECT(gbc.h(),  0x39);
        EXPECT(gbc.l(),  0xd0);
        EXPECT(gbc.sp(), 0x6f1c);
        EXPECT(gbc.pc(), 0x138e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0260
        gbc.setState(0xd4b8, 0xcd4c, 0x4b00, 0xb7fa, 0x3a27, 0xc943, 0x0, 0x1);
        gbc.writeMem(0xd4b8, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x49);
        EXPECT(gbc.b(),  0xb7);
        EXPECT(gbc.c(),  0xfa);
        EXPECT(gbc.d(),  0x3a);
        EXPECT(gbc.e(),  0x27);
        EXPECT(gbc.h(),  0xc9);
        EXPECT(gbc.l(),  0x43);
        EXPECT(gbc.sp(), 0xcd4c);
        EXPECT(gbc.pc(), 0xd4b9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd4b8), 0xa4);
        // A4 0261
        gbc.setState(0xc62a, 0x4764, 0xce60, 0x114a, 0xca2f, 0xe1, 0x1, 0x0);
        gbc.writeMem(0xc62a, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x11);
        EXPECT(gbc.c(),  0x4a);
        EXPECT(gbc.d(),  0xca);
        EXPECT(gbc.e(),  0x2f);
        EXPECT(gbc.h(),  0x0);
        EXPECT(gbc.l(),  0xe1);
        EXPECT(gbc.sp(), 0x4764);
        EXPECT(gbc.pc(), 0xc62b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc62a), 0xa4);
        // A4 0263
        gbc.setState(0x5621, 0x2777, 0xf80, 0x3765, 0xb0f5, 0x3a1a, 0x1, 0x0);
        gbc.writeMem(0x5621, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa);
        EXPECT(gbc.b(),  0x37);
        EXPECT(gbc.c(),  0x65);
        EXPECT(gbc.d(),  0xb0);
        EXPECT(gbc.e(),  0xf5);
        EXPECT(gbc.h(),  0x3a);
        EXPECT(gbc.l(),  0x1a);
        EXPECT(gbc.sp(), 0x2777);
        EXPECT(gbc.pc(), 0x5622);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0264
        gbc.setState(0x3e43, 0x7f89, 0xd5f0, 0xb41c, 0x6f0e, 0xead8, 0x0, 0x0);
        gbc.writeMem(0x3e43, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc0);
        EXPECT(gbc.b(),  0xb4);
        EXPECT(gbc.c(),  0x1c);
        EXPECT(gbc.d(),  0x6f);
        EXPECT(gbc.e(),  0xe);
        EXPECT(gbc.h(),  0xea);
        EXPECT(gbc.l(),  0xd8);
        EXPECT(gbc.sp(), 0x7f89);
        EXPECT(gbc.pc(), 0x3e44);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0265
        gbc.setState(0x17d8, 0xd79d, 0x32b0, 0x3d7d, 0x32b3, 0x790d, 0x0, 0x1);
        gbc.writeMem(0x17d8, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x30);
        EXPECT(gbc.b(),  0x3d);
        EXPECT(gbc.c(),  0x7d);
        EXPECT(gbc.d(),  0x32);
        EXPECT(gbc.e(),  0xb3);
        EXPECT(gbc.h(),  0x79);
        EXPECT(gbc.l(),  0xd);
        EXPECT(gbc.sp(), 0xd79d);
        EXPECT(gbc.pc(), 0x17d9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0266
        gbc.setState(0x2344, 0xa80b, 0xb3b0, 0x7d9d, 0xb891, 0x98ec, 0x0, 0x0);
        gbc.writeMem(0x2344, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x90);
        EXPECT(gbc.b(),  0x7d);
        EXPECT(gbc.c(),  0x9d);
        EXPECT(gbc.d(),  0xb8);
        EXPECT(gbc.e(),  0x91);
        EXPECT(gbc.h(),  0x98);
        EXPECT(gbc.l(),  0xec);
        EXPECT(gbc.sp(), 0xa80b);
        EXPECT(gbc.pc(), 0x2345);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0267
        gbc.setState(0xb3b3, 0xf863, 0x1920, 0x90f8, 0xa3c1, 0x2c82, 0x1, 0x0);
        gbc.writeMem(0xb3b3, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0x90);
        EXPECT(gbc.c(),  0xf8);
        EXPECT(gbc.d(),  0xa3);
        EXPECT(gbc.e(),  0xc1);
        EXPECT(gbc.h(),  0x2c);
        EXPECT(gbc.l(),  0x82);
        EXPECT(gbc.sp(), 0xf863);
        EXPECT(gbc.pc(), 0xb3b4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb3b3), 0xa4);
        // A4 0268
        gbc.setState(0xe635, 0xa5c9, 0xa7c0, 0xb388, 0x9dda, 0xe783, 0x0, 0x0);
        gbc.writeMem(0xe635, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa7);
        EXPECT(gbc.b(),  0xb3);
        EXPECT(gbc.c(),  0x88);
        EXPECT(gbc.d(),  0x9d);
        EXPECT(gbc.e(),  0xda);
        EXPECT(gbc.h(),  0xe7);
        EXPECT(gbc.l(),  0x83);
        EXPECT(gbc.sp(), 0xa5c9);
        EXPECT(gbc.pc(), 0xe636);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe635), 0xa4);
        // A4 0269
        gbc.setState(0xb3cf, 0xf91, 0x29e0, 0xbcdb, 0xea0f, 0xae6b, 0x1, 0x0);
        gbc.writeMem(0xb3cf, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0xbc);
        EXPECT(gbc.c(),  0xdb);
        EXPECT(gbc.d(),  0xea);
        EXPECT(gbc.e(),  0xf);
        EXPECT(gbc.h(),  0xae);
        EXPECT(gbc.l(),  0x6b);
        EXPECT(gbc.sp(), 0xf91);
        EXPECT(gbc.pc(), 0xb3d0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb3cf), 0xa4);
        // A4 026A
        gbc.setState(0x98a7, 0x7ff2, 0xc890, 0x9237, 0x1f0a, 0x1136, 0x1, 0x0);
        gbc.writeMem(0x98a7, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x92);
        EXPECT(gbc.c(),  0x37);
        EXPECT(gbc.d(),  0x1f);
        EXPECT(gbc.e(),  0xa);
        EXPECT(gbc.h(),  0x11);
        EXPECT(gbc.l(),  0x36);
        EXPECT(gbc.sp(), 0x7ff2);
        EXPECT(gbc.pc(), 0x98a8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x98a7), 0xa4);
        // A4 026B
        gbc.setState(0xe95, 0x7157, 0x8590, 0x8843, 0xa1b0, 0x3562, 0x0, 0x0);
        gbc.writeMem(0xe95, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x5);
        EXPECT(gbc.b(),  0x88);
        EXPECT(gbc.c(),  0x43);
        EXPECT(gbc.d(),  0xa1);
        EXPECT(gbc.e(),  0xb0);
        EXPECT(gbc.h(),  0x35);
        EXPECT(gbc.l(),  0x62);
        EXPECT(gbc.sp(), 0x7157);
        EXPECT(gbc.pc(), 0xe96);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 026C
        gbc.setState(0xb59e, 0x713a, 0x88f0, 0x517a, 0x846c, 0xbc31, 0x1, 0x0);
        gbc.writeMem(0xb59e, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x88);
        EXPECT(gbc.b(),  0x51);
        EXPECT(gbc.c(),  0x7a);
        EXPECT(gbc.d(),  0x84);
        EXPECT(gbc.e(),  0x6c);
        EXPECT(gbc.h(),  0xbc);
        EXPECT(gbc.l(),  0x31);
        EXPECT(gbc.sp(), 0x713a);
        EXPECT(gbc.pc(), 0xb59f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb59e), 0xa4);
        // A4 026D
        gbc.setState(0xec0b, 0xf82b, 0x1880, 0xa7a4, 0x4a2, 0x897, 0x0, 0x0);
        gbc.writeMem(0xec0b, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0xa7);
        EXPECT(gbc.c(),  0xa4);
        EXPECT(gbc.d(),  0x4);
        EXPECT(gbc.e(),  0xa2);
        EXPECT(gbc.h(),  0x8);
        EXPECT(gbc.l(),  0x97);
        EXPECT(gbc.sp(), 0xf82b);
        EXPECT(gbc.pc(), 0xec0c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xec0b), 0xa4);
        // A4 026E
        gbc.setState(0x9d7b, 0x5c09, 0x81a0, 0x11f1, 0x25e1, 0xa5b, 0x1, 0x0);
        gbc.writeMem(0x9d7b, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x11);
        EXPECT(gbc.c(),  0xf1);
        EXPECT(gbc.d(),  0x25);
        EXPECT(gbc.e(),  0xe1);
        EXPECT(gbc.h(),  0xa);
        EXPECT(gbc.l(),  0x5b);
        EXPECT(gbc.sp(), 0x5c09);
        EXPECT(gbc.pc(), 0x9d7c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9d7b), 0xa4);
        // A4 026F
        gbc.setState(0xe2aa, 0xa045, 0x1630, 0xda67, 0x9bed, 0x6a74, 0x0, 0x1);
        gbc.writeMem(0xe2aa, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0xda);
        EXPECT(gbc.c(),  0x67);
        EXPECT(gbc.d(),  0x9b);
        EXPECT(gbc.e(),  0xed);
        EXPECT(gbc.h(),  0x6a);
        EXPECT(gbc.l(),  0x74);
        EXPECT(gbc.sp(), 0xa045);
        EXPECT(gbc.pc(), 0xe2ab);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe2aa), 0xa4);
        // A4 0270
        gbc.setState(0x6a0, 0xbde3, 0x1970, 0xcd3d, 0x7eee, 0xaa87, 0x0, 0x0);
        gbc.writeMem(0x6a0, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0xcd);
        EXPECT(gbc.c(),  0x3d);
        EXPECT(gbc.d(),  0x7e);
        EXPECT(gbc.e(),  0xee);
        EXPECT(gbc.h(),  0xaa);
        EXPECT(gbc.l(),  0x87);
        EXPECT(gbc.sp(), 0xbde3);
        EXPECT(gbc.pc(), 0x6a1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0271
        gbc.setState(0x8c53, 0xfc40, 0x3a80, 0xbd39, 0xbbb4, 0x397c, 0x1, 0x1);
        gbc.writeMem(0x8c53, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x38);
        EXPECT(gbc.b(),  0xbd);
        EXPECT(gbc.c(),  0x39);
        EXPECT(gbc.d(),  0xbb);
        EXPECT(gbc.e(),  0xb4);
        EXPECT(gbc.h(),  0x39);
        EXPECT(gbc.l(),  0x7c);
        EXPECT(gbc.sp(), 0xfc40);
        EXPECT(gbc.pc(), 0x8c54);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8c53), 0xa4);
        // A4 0272
        gbc.setState(0x4a5d, 0x10ea, 0x9290, 0x86e3, 0xba1, 0xd59a, 0x1, 0x1);
        gbc.writeMem(0x4a5d, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x90);
        EXPECT(gbc.b(),  0x86);
        EXPECT(gbc.c(),  0xe3);
        EXPECT(gbc.d(),  0xb);
        EXPECT(gbc.e(),  0xa1);
        EXPECT(gbc.h(),  0xd5);
        EXPECT(gbc.l(),  0x9a);
        EXPECT(gbc.sp(), 0x10ea);
        EXPECT(gbc.pc(), 0x4a5e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0273
        gbc.setState(0x9d0b, 0x2f17, 0x1170, 0xfd10, 0xdd88, 0x72c8, 0x1, 0x1);
        gbc.writeMem(0x9d0b, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0xfd);
        EXPECT(gbc.c(),  0x10);
        EXPECT(gbc.d(),  0xdd);
        EXPECT(gbc.e(),  0x88);
        EXPECT(gbc.h(),  0x72);
        EXPECT(gbc.l(),  0xc8);
        EXPECT(gbc.sp(), 0x2f17);
        EXPECT(gbc.pc(), 0x9d0c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9d0b), 0xa4);
        // A4 0274
        gbc.setState(0xc58b, 0xfbbd, 0x660, 0x6436, 0x46b6, 0x7d6d, 0x1, 0x1);
        gbc.writeMem(0xc58b, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0x64);
        EXPECT(gbc.c(),  0x36);
        EXPECT(gbc.d(),  0x46);
        EXPECT(gbc.e(),  0xb6);
        EXPECT(gbc.h(),  0x7d);
        EXPECT(gbc.l(),  0x6d);
        EXPECT(gbc.sp(), 0xfbbd);
        EXPECT(gbc.pc(), 0xc58c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc58b), 0xa4);
        // A4 0275
        gbc.setState(0x1bf5, 0xbda4, 0xcce0, 0x14a9, 0x13, 0xcc49, 0x1, 0x1);
        gbc.writeMem(0x1bf5, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xcc);
        EXPECT(gbc.b(),  0x14);
        EXPECT(gbc.c(),  0xa9);
        EXPECT(gbc.d(),  0x0);
        EXPECT(gbc.e(),  0x13);
        EXPECT(gbc.h(),  0xcc);
        EXPECT(gbc.l(),  0x49);
        EXPECT(gbc.sp(), 0xbda4);
        EXPECT(gbc.pc(), 0x1bf6);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0276
        gbc.setState(0xc7, 0x7922, 0x9210, 0xf608, 0x5d23, 0xf252, 0x1, 0x0);
        gbc.writeMem(0xc7, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x92);
        EXPECT(gbc.b(),  0xf6);
        EXPECT(gbc.c(),  0x8);
        EXPECT(gbc.d(),  0x5d);
        EXPECT(gbc.e(),  0x23);
        EXPECT(gbc.h(),  0xf2);
        EXPECT(gbc.l(),  0x52);
        EXPECT(gbc.sp(), 0x7922);
        EXPECT(gbc.pc(), 0xc8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0277
        gbc.setState(0xb7d6, 0x250a, 0x7d90, 0xb1a0, 0xbdc8, 0x81c9, 0x1, 0x0);
        gbc.writeMem(0xb7d6, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0xb1);
        EXPECT(gbc.c(),  0xa0);
        EXPECT(gbc.d(),  0xbd);
        EXPECT(gbc.e(),  0xc8);
        EXPECT(gbc.h(),  0x81);
        EXPECT(gbc.l(),  0xc9);
        EXPECT(gbc.sp(), 0x250a);
        EXPECT(gbc.pc(), 0xb7d7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb7d6), 0xa4);
        // A4 0278
        gbc.setState(0xc21a, 0x129f, 0x5850, 0x138d, 0x3d07, 0x90af, 0x1, 0x1);
        gbc.writeMem(0xc21a, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0x13);
        EXPECT(gbc.c(),  0x8d);
        EXPECT(gbc.d(),  0x3d);
        EXPECT(gbc.e(),  0x7);
        EXPECT(gbc.h(),  0x90);
        EXPECT(gbc.l(),  0xaf);
        EXPECT(gbc.sp(), 0x129f);
        EXPECT(gbc.pc(), 0xc21b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc21a), 0xa4);
        // A4 0279
        gbc.setState(0x636f, 0x4a0a, 0xbd10, 0x868, 0x79fb, 0x1f8c, 0x0, 0x0);
        gbc.writeMem(0x636f, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1d);
        EXPECT(gbc.b(),  0x8);
        EXPECT(gbc.c(),  0x68);
        EXPECT(gbc.d(),  0x79);
        EXPECT(gbc.e(),  0xfb);
        EXPECT(gbc.h(),  0x1f);
        EXPECT(gbc.l(),  0x8c);
        EXPECT(gbc.sp(), 0x4a0a);
        EXPECT(gbc.pc(), 0x6370);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 027A
        gbc.setState(0x2812, 0xc60d, 0x7520, 0x7bc7, 0x8c07, 0x32dd, 0x1, 0x1);
        gbc.writeMem(0x2812, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x30);
        EXPECT(gbc.b(),  0x7b);
        EXPECT(gbc.c(),  0xc7);
        EXPECT(gbc.d(),  0x8c);
        EXPECT(gbc.e(),  0x7);
        EXPECT(gbc.h(),  0x32);
        EXPECT(gbc.l(),  0xdd);
        EXPECT(gbc.sp(), 0xc60d);
        EXPECT(gbc.pc(), 0x2813);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 027B
        gbc.setState(0x1f02, 0x8085, 0xea10, 0x9241, 0x7ed7, 0xb3a0, 0x1, 0x0);
        gbc.writeMem(0x1f02, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa2);
        EXPECT(gbc.b(),  0x92);
        EXPECT(gbc.c(),  0x41);
        EXPECT(gbc.d(),  0x7e);
        EXPECT(gbc.e(),  0xd7);
        EXPECT(gbc.h(),  0xb3);
        EXPECT(gbc.l(),  0xa0);
        EXPECT(gbc.sp(), 0x8085);
        EXPECT(gbc.pc(), 0x1f03);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 027C
        gbc.setState(0x8157, 0x266f, 0xaf50, 0xce37, 0x80d8, 0xbae2, 0x0, 0x0);
        gbc.writeMem(0x8157, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xaa);
        EXPECT(gbc.b(),  0xce);
        EXPECT(gbc.c(),  0x37);
        EXPECT(gbc.d(),  0x80);
        EXPECT(gbc.e(),  0xd8);
        EXPECT(gbc.h(),  0xba);
        EXPECT(gbc.l(),  0xe2);
        EXPECT(gbc.sp(), 0x266f);
        EXPECT(gbc.pc(), 0x8158);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8157), 0xa4);
        // A4 027D
        gbc.setState(0xa997, 0xd05, 0x850, 0x1e09, 0x9ee7, 0x9f2c, 0x1, 0x1);
        gbc.writeMem(0xa997, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0x1e);
        EXPECT(gbc.c(),  0x9);
        EXPECT(gbc.d(),  0x9e);
        EXPECT(gbc.e(),  0xe7);
        EXPECT(gbc.h(),  0x9f);
        EXPECT(gbc.l(),  0x2c);
        EXPECT(gbc.sp(), 0xd05);
        EXPECT(gbc.pc(), 0xa998);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa997), 0xa4);
        // A4 027E
        gbc.setState(0x3f33, 0xc04f, 0xbd70, 0x93a6, 0x20b7, 0x9a8d, 0x0, 0x0);
        gbc.writeMem(0x3f33, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x98);
        EXPECT(gbc.b(),  0x93);
        EXPECT(gbc.c(),  0xa6);
        EXPECT(gbc.d(),  0x20);
        EXPECT(gbc.e(),  0xb7);
        EXPECT(gbc.h(),  0x9a);
        EXPECT(gbc.l(),  0x8d);
        EXPECT(gbc.sp(), 0xc04f);
        EXPECT(gbc.pc(), 0x3f34);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 027F
        gbc.setState(0xebee, 0xb26, 0x9110, 0x3038, 0x2633, 0xbd9e, 0x0, 0x1);
        gbc.writeMem(0xebee, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x91);
        EXPECT(gbc.b(),  0x30);
        EXPECT(gbc.c(),  0x38);
        EXPECT(gbc.d(),  0x26);
        EXPECT(gbc.e(),  0x33);
        EXPECT(gbc.h(),  0xbd);
        EXPECT(gbc.l(),  0x9e);
        EXPECT(gbc.sp(), 0xb26);
        EXPECT(gbc.pc(), 0xebef);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xebee), 0xa4);
        // A4 0280
        gbc.setState(0x1554, 0xba84, 0xce60, 0x1f46, 0x984a, 0xd186, 0x1, 0x1);
        gbc.writeMem(0x1554, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc0);
        EXPECT(gbc.b(),  0x1f);
        EXPECT(gbc.c(),  0x46);
        EXPECT(gbc.d(),  0x98);
        EXPECT(gbc.e(),  0x4a);
        EXPECT(gbc.h(),  0xd1);
        EXPECT(gbc.l(),  0x86);
        EXPECT(gbc.sp(), 0xba84);
        EXPECT(gbc.pc(), 0x1555);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0281
        gbc.setState(0x7cd, 0x545d, 0x1020, 0x465b, 0x316b, 0x714b, 0x0, 0x1);
        gbc.writeMem(0x7cd, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0x46);
        EXPECT(gbc.c(),  0x5b);
        EXPECT(gbc.d(),  0x31);
        EXPECT(gbc.e(),  0x6b);
        EXPECT(gbc.h(),  0x71);
        EXPECT(gbc.l(),  0x4b);
        EXPECT(gbc.sp(), 0x545d);
        EXPECT(gbc.pc(), 0x7ce);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0282
        gbc.setState(0x5025, 0xf787, 0xdc0, 0x81d2, 0x7cfc, 0xb3f5, 0x0, 0x1);
        gbc.writeMem(0x5025, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0x81);
        EXPECT(gbc.c(),  0xd2);
        EXPECT(gbc.d(),  0x7c);
        EXPECT(gbc.e(),  0xfc);
        EXPECT(gbc.h(),  0xb3);
        EXPECT(gbc.l(),  0xf5);
        EXPECT(gbc.sp(), 0xf787);
        EXPECT(gbc.pc(), 0x5026);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0283
        gbc.setState(0x9ac6, 0xf06e, 0x52f0, 0xec0a, 0x5602, 0x6f24, 0x1, 0x1);
        gbc.writeMem(0x9ac6, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x42);
        EXPECT(gbc.b(),  0xec);
        EXPECT(gbc.c(),  0xa);
        EXPECT(gbc.d(),  0x56);
        EXPECT(gbc.e(),  0x2);
        EXPECT(gbc.h(),  0x6f);
        EXPECT(gbc.l(),  0x24);
        EXPECT(gbc.sp(), 0xf06e);
        EXPECT(gbc.pc(), 0x9ac7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9ac6), 0xa4);
        // A4 0284
        gbc.setState(0xaf47, 0x5f03, 0xd9c0, 0xf1a5, 0x6011, 0x4a28, 0x0, 0x1);
        gbc.writeMem(0xaf47, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x48);
        EXPECT(gbc.b(),  0xf1);
        EXPECT(gbc.c(),  0xa5);
        EXPECT(gbc.d(),  0x60);
        EXPECT(gbc.e(),  0x11);
        EXPECT(gbc.h(),  0x4a);
        EXPECT(gbc.l(),  0x28);
        EXPECT(gbc.sp(), 0x5f03);
        EXPECT(gbc.pc(), 0xaf48);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xaf47), 0xa4);
        // A4 0285
        gbc.setState(0xe49d, 0x7c1a, 0x3f0, 0xfc04, 0xc7ec, 0x27d3, 0x0, 0x1);
        gbc.writeMem(0xe49d, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3);
        EXPECT(gbc.b(),  0xfc);
        EXPECT(gbc.c(),  0x4);
        EXPECT(gbc.d(),  0xc7);
        EXPECT(gbc.e(),  0xec);
        EXPECT(gbc.h(),  0x27);
        EXPECT(gbc.l(),  0xd3);
        EXPECT(gbc.sp(), 0x7c1a);
        EXPECT(gbc.pc(), 0xe49e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe49d), 0xa4);
        // A4 0286
        gbc.setState(0x83ec, 0xe16b, 0xa40, 0xe542, 0xe9fa, 0xa28c, 0x0, 0x1);
        gbc.writeMem(0x83ec, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0xe5);
        EXPECT(gbc.c(),  0x42);
        EXPECT(gbc.d(),  0xe9);
        EXPECT(gbc.e(),  0xfa);
        EXPECT(gbc.h(),  0xa2);
        EXPECT(gbc.l(),  0x8c);
        EXPECT(gbc.sp(), 0xe16b);
        EXPECT(gbc.pc(), 0x83ed);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x83ec), 0xa4);
        // A4 0287
        gbc.setState(0x9d9b, 0x7ac2, 0x6af0, 0x26b0, 0x3cf3, 0xd021, 0x0, 0x1);
        gbc.writeMem(0x9d9b, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0x26);
        EXPECT(gbc.c(),  0xb0);
        EXPECT(gbc.d(),  0x3c);
        EXPECT(gbc.e(),  0xf3);
        EXPECT(gbc.h(),  0xd0);
        EXPECT(gbc.l(),  0x21);
        EXPECT(gbc.sp(), 0x7ac2);
        EXPECT(gbc.pc(), 0x9d9c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9d9b), 0xa4);
        // A4 0288
        gbc.setState(0x4d93, 0x20a9, 0x2c90, 0x5346, 0x15d8, 0x9be2, 0x1, 0x1);
        gbc.writeMem(0x4d93, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0x53);
        EXPECT(gbc.c(),  0x46);
        EXPECT(gbc.d(),  0x15);
        EXPECT(gbc.e(),  0xd8);
        EXPECT(gbc.h(),  0x9b);
        EXPECT(gbc.l(),  0xe2);
        EXPECT(gbc.sp(), 0x20a9);
        EXPECT(gbc.pc(), 0x4d94);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0289
        gbc.setState(0x436e, 0xbeb7, 0x70b0, 0x8cea, 0xae13, 0xb89b, 0x1, 0x0);
        gbc.writeMem(0x436e, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x30);
        EXPECT(gbc.b(),  0x8c);
        EXPECT(gbc.c(),  0xea);
        EXPECT(gbc.d(),  0xae);
        EXPECT(gbc.e(),  0x13);
        EXPECT(gbc.h(),  0xb8);
        EXPECT(gbc.l(),  0x9b);
        EXPECT(gbc.sp(), 0xbeb7);
        EXPECT(gbc.pc(), 0x436f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 028A
        gbc.setState(0xeb66, 0x622, 0xd0d0, 0xeb1f, 0xd299, 0xe88f, 0x0, 0x1);
        gbc.writeMem(0xeb66, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc0);
        EXPECT(gbc.b(),  0xeb);
        EXPECT(gbc.c(),  0x1f);
        EXPECT(gbc.d(),  0xd2);
        EXPECT(gbc.e(),  0x99);
        EXPECT(gbc.h(),  0xe8);
        EXPECT(gbc.l(),  0x8f);
        EXPECT(gbc.sp(), 0x622);
        EXPECT(gbc.pc(), 0xeb67);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xeb66), 0xa4);
        // A4 028B
        gbc.setState(0xd620, 0x42c8, 0x24b0, 0x27a5, 0x34fc, 0x3c97, 0x1, 0x1);
        gbc.writeMem(0xd620, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x24);
        EXPECT(gbc.b(),  0x27);
        EXPECT(gbc.c(),  0xa5);
        EXPECT(gbc.d(),  0x34);
        EXPECT(gbc.e(),  0xfc);
        EXPECT(gbc.h(),  0x3c);
        EXPECT(gbc.l(),  0x97);
        EXPECT(gbc.sp(), 0x42c8);
        EXPECT(gbc.pc(), 0xd621);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd620), 0xa4);
        // A4 028C
        gbc.setState(0x19c2, 0xe0b6, 0xc740, 0xe136, 0x192f, 0x7772, 0x0, 0x1);
        gbc.writeMem(0x19c2, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x47);
        EXPECT(gbc.b(),  0xe1);
        EXPECT(gbc.c(),  0x36);
        EXPECT(gbc.d(),  0x19);
        EXPECT(gbc.e(),  0x2f);
        EXPECT(gbc.h(),  0x77);
        EXPECT(gbc.l(),  0x72);
        EXPECT(gbc.sp(), 0xe0b6);
        EXPECT(gbc.pc(), 0x19c3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 028D
        gbc.setState(0xc820, 0xa582, 0x3750, 0x9cc8, 0x3f9, 0x3ba2, 0x0, 0x1);
        gbc.writeMem(0xc820, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x33);
        EXPECT(gbc.b(),  0x9c);
        EXPECT(gbc.c(),  0xc8);
        EXPECT(gbc.d(),  0x3);
        EXPECT(gbc.e(),  0xf9);
        EXPECT(gbc.h(),  0x3b);
        EXPECT(gbc.l(),  0xa2);
        EXPECT(gbc.sp(), 0xa582);
        EXPECT(gbc.pc(), 0xc821);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc820), 0xa4);
        // A4 028E
        gbc.setState(0x7d92, 0xcea4, 0x71e0, 0x449d, 0xbe18, 0x7a6, 0x0, 0x0);
        gbc.writeMem(0x7d92, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0x44);
        EXPECT(gbc.c(),  0x9d);
        EXPECT(gbc.d(),  0xbe);
        EXPECT(gbc.e(),  0x18);
        EXPECT(gbc.h(),  0x7);
        EXPECT(gbc.l(),  0xa6);
        EXPECT(gbc.sp(), 0xcea4);
        EXPECT(gbc.pc(), 0x7d93);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 028F
        gbc.setState(0x601a, 0x2aff, 0x5cd0, 0xce07, 0xbfdd, 0x8d20, 0x1, 0x0);
        gbc.writeMem(0x601a, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc);
        EXPECT(gbc.b(),  0xce);
        EXPECT(gbc.c(),  0x7);
        EXPECT(gbc.d(),  0xbf);
        EXPECT(gbc.e(),  0xdd);
        EXPECT(gbc.h(),  0x8d);
        EXPECT(gbc.l(),  0x20);
        EXPECT(gbc.sp(), 0x2aff);
        EXPECT(gbc.pc(), 0x601b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0290
        gbc.setState(0x7ac9, 0xa563, 0xec10, 0xdb19, 0x7f78, 0x6dcf, 0x0, 0x0);
        gbc.writeMem(0x7ac9, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x6c);
        EXPECT(gbc.b(),  0xdb);
        EXPECT(gbc.c(),  0x19);
        EXPECT(gbc.d(),  0x7f);
        EXPECT(gbc.e(),  0x78);
        EXPECT(gbc.h(),  0x6d);
        EXPECT(gbc.l(),  0xcf);
        EXPECT(gbc.sp(), 0xa563);
        EXPECT(gbc.pc(), 0x7aca);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0291
        gbc.setState(0x9bed, 0xbebd, 0x3d20, 0xe3e3, 0xadc2, 0x632b, 0x1, 0x1);
        gbc.writeMem(0x9bed, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x21);
        EXPECT(gbc.b(),  0xe3);
        EXPECT(gbc.c(),  0xe3);
        EXPECT(gbc.d(),  0xad);
        EXPECT(gbc.e(),  0xc2);
        EXPECT(gbc.h(),  0x63);
        EXPECT(gbc.l(),  0x2b);
        EXPECT(gbc.sp(), 0xbebd);
        EXPECT(gbc.pc(), 0x9bee);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9bed), 0xa4);
        // A4 0292
        gbc.setState(0xba37, 0x6cb1, 0xb840, 0x9358, 0xe88b, 0x97ee, 0x1, 0x0);
        gbc.writeMem(0xba37, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x90);
        EXPECT(gbc.b(),  0x93);
        EXPECT(gbc.c(),  0x58);
        EXPECT(gbc.d(),  0xe8);
        EXPECT(gbc.e(),  0x8b);
        EXPECT(gbc.h(),  0x97);
        EXPECT(gbc.l(),  0xee);
        EXPECT(gbc.sp(), 0x6cb1);
        EXPECT(gbc.pc(), 0xba38);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xba37), 0xa4);
        // A4 0293
        gbc.setState(0xd186, 0x2205, 0x1640, 0xc79a, 0x8c53, 0x2459, 0x1, 0x1);
        gbc.writeMem(0xd186, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0xc7);
        EXPECT(gbc.c(),  0x9a);
        EXPECT(gbc.d(),  0x8c);
        EXPECT(gbc.e(),  0x53);
        EXPECT(gbc.h(),  0x24);
        EXPECT(gbc.l(),  0x59);
        EXPECT(gbc.sp(), 0x2205);
        EXPECT(gbc.pc(), 0xd187);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd186), 0xa4);
        // A4 0295
        gbc.setState(0x9d3, 0x578d, 0x5f30, 0x696b, 0x843e, 0xc4f4, 0x0, 0x0);
        gbc.writeMem(0x9d3, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x44);
        EXPECT(gbc.b(),  0x69);
        EXPECT(gbc.c(),  0x6b);
        EXPECT(gbc.d(),  0x84);
        EXPECT(gbc.e(),  0x3e);
        EXPECT(gbc.h(),  0xc4);
        EXPECT(gbc.l(),  0xf4);
        EXPECT(gbc.sp(), 0x578d);
        EXPECT(gbc.pc(), 0x9d4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0296
        gbc.setState(0x3ee7, 0x14f2, 0xf540, 0x2e80, 0x4097, 0xff99, 0x1, 0x0);
        gbc.writeMem(0x3ee7, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf5);
        EXPECT(gbc.b(),  0x2e);
        EXPECT(gbc.c(),  0x80);
        EXPECT(gbc.d(),  0x40);
        EXPECT(gbc.e(),  0x97);
        EXPECT(gbc.h(),  0xff);
        EXPECT(gbc.l(),  0x99);
        EXPECT(gbc.sp(), 0x14f2);
        EXPECT(gbc.pc(), 0x3ee8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0297
        gbc.setState(0xc0c0, 0xa348, 0xf0b0, 0x12d9, 0xa58a, 0x49b, 0x1, 0x0);
        gbc.writeMem(0xc0c0, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x12);
        EXPECT(gbc.c(),  0xd9);
        EXPECT(gbc.d(),  0xa5);
        EXPECT(gbc.e(),  0x8a);
        EXPECT(gbc.h(),  0x4);
        EXPECT(gbc.l(),  0x9b);
        EXPECT(gbc.sp(), 0xa348);
        EXPECT(gbc.pc(), 0xc0c1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc0c0), 0xa4);
        // A4 0298
        gbc.setState(0xdf63, 0xa00b, 0x1eb0, 0x3b7f, 0x6044, 0x3f51, 0x1, 0x1);
        gbc.writeMem(0xdf63, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1e);
        EXPECT(gbc.b(),  0x3b);
        EXPECT(gbc.c(),  0x7f);
        EXPECT(gbc.d(),  0x60);
        EXPECT(gbc.e(),  0x44);
        EXPECT(gbc.h(),  0x3f);
        EXPECT(gbc.l(),  0x51);
        EXPECT(gbc.sp(), 0xa00b);
        EXPECT(gbc.pc(), 0xdf64);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdf63), 0xa4);
        // A4 0299
        gbc.setState(0xc890, 0xb7a7, 0x5c10, 0xc01a, 0xb36f, 0x54e, 0x1, 0x0);
        gbc.writeMem(0xc890, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0xc0);
        EXPECT(gbc.c(),  0x1a);
        EXPECT(gbc.d(),  0xb3);
        EXPECT(gbc.e(),  0x6f);
        EXPECT(gbc.h(),  0x5);
        EXPECT(gbc.l(),  0x4e);
        EXPECT(gbc.sp(), 0xb7a7);
        EXPECT(gbc.pc(), 0xc891);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc890), 0xa4);
        // A4 029A
        gbc.setState(0xd0db, 0x5475, 0x50d0, 0xfb4f, 0x2792, 0x176b, 0x0, 0x1);
        gbc.writeMem(0xd0db, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0xfb);
        EXPECT(gbc.c(),  0x4f);
        EXPECT(gbc.d(),  0x27);
        EXPECT(gbc.e(),  0x92);
        EXPECT(gbc.h(),  0x17);
        EXPECT(gbc.l(),  0x6b);
        EXPECT(gbc.sp(), 0x5475);
        EXPECT(gbc.pc(), 0xd0dc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd0db), 0xa4);
        // A4 029B
        gbc.setState(0x1e83, 0x75e6, 0xf140, 0x8ab3, 0xcce7, 0x6e1d, 0x0, 0x1);
        gbc.writeMem(0x1e83, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x60);
        EXPECT(gbc.b(),  0x8a);
        EXPECT(gbc.c(),  0xb3);
        EXPECT(gbc.d(),  0xcc);
        EXPECT(gbc.e(),  0xe7);
        EXPECT(gbc.h(),  0x6e);
        EXPECT(gbc.l(),  0x1d);
        EXPECT(gbc.sp(), 0x75e6);
        EXPECT(gbc.pc(), 0x1e84);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 029C
        gbc.setState(0x1f33, 0x86aa, 0xb950, 0xf4b4, 0x6510, 0xaa35, 0x0, 0x1);
        gbc.writeMem(0x1f33, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa8);
        EXPECT(gbc.b(),  0xf4);
        EXPECT(gbc.c(),  0xb4);
        EXPECT(gbc.d(),  0x65);
        EXPECT(gbc.e(),  0x10);
        EXPECT(gbc.h(),  0xaa);
        EXPECT(gbc.l(),  0x35);
        EXPECT(gbc.sp(), 0x86aa);
        EXPECT(gbc.pc(), 0x1f34);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 029D
        gbc.setState(0x448, 0xb0e8, 0xa390, 0xa521, 0x3f4d, 0xc463, 0x0, 0x0);
        gbc.writeMem(0x448, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0xa5);
        EXPECT(gbc.c(),  0x21);
        EXPECT(gbc.d(),  0x3f);
        EXPECT(gbc.e(),  0x4d);
        EXPECT(gbc.h(),  0xc4);
        EXPECT(gbc.l(),  0x63);
        EXPECT(gbc.sp(), 0xb0e8);
        EXPECT(gbc.pc(), 0x449);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 029E
        gbc.setState(0x9383, 0xa953, 0x2710, 0x1e06, 0xca4d, 0x54f2, 0x0, 0x0);
        gbc.writeMem(0x9383, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0x1e);
        EXPECT(gbc.c(),  0x6);
        EXPECT(gbc.d(),  0xca);
        EXPECT(gbc.e(),  0x4d);
        EXPECT(gbc.h(),  0x54);
        EXPECT(gbc.l(),  0xf2);
        EXPECT(gbc.sp(), 0xa953);
        EXPECT(gbc.pc(), 0x9384);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9383), 0xa4);
        // A4 029F
        gbc.setState(0x117f, 0x16ff, 0x71a0, 0x1216, 0x8f01, 0x5d3c, 0x0, 0x0);
        gbc.writeMem(0x117f, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x51);
        EXPECT(gbc.b(),  0x12);
        EXPECT(gbc.c(),  0x16);
        EXPECT(gbc.d(),  0x8f);
        EXPECT(gbc.e(),  0x1);
        EXPECT(gbc.h(),  0x5d);
        EXPECT(gbc.l(),  0x3c);
        EXPECT(gbc.sp(), 0x16ff);
        EXPECT(gbc.pc(), 0x1180);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02A0
        gbc.setState(0xb697, 0xdeb2, 0x80e0, 0xadfb, 0x9179, 0x941b, 0x0, 0x0);
        gbc.writeMem(0xb697, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0xad);
        EXPECT(gbc.c(),  0xfb);
        EXPECT(gbc.d(),  0x91);
        EXPECT(gbc.e(),  0x79);
        EXPECT(gbc.h(),  0x94);
        EXPECT(gbc.l(),  0x1b);
        EXPECT(gbc.sp(), 0xdeb2);
        EXPECT(gbc.pc(), 0xb698);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb697), 0xa4);
        // A4 02A1
        gbc.setState(0x713f, 0x99b8, 0xd390, 0xf83e, 0xed05, 0x34cf, 0x0, 0x1);
        gbc.writeMem(0x713f, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0xf8);
        EXPECT(gbc.c(),  0x3e);
        EXPECT(gbc.d(),  0xed);
        EXPECT(gbc.e(),  0x5);
        EXPECT(gbc.h(),  0x34);
        EXPECT(gbc.l(),  0xcf);
        EXPECT(gbc.sp(), 0x99b8);
        EXPECT(gbc.pc(), 0x7140);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02A2
        gbc.setState(0x28dc, 0x8d3d, 0x58a0, 0x5daf, 0xf76d, 0xed05, 0x1, 0x1);
        gbc.writeMem(0x28dc, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x48);
        EXPECT(gbc.b(),  0x5d);
        EXPECT(gbc.c(),  0xaf);
        EXPECT(gbc.d(),  0xf7);
        EXPECT(gbc.e(),  0x6d);
        EXPECT(gbc.h(),  0xed);
        EXPECT(gbc.l(),  0x5);
        EXPECT(gbc.sp(), 0x8d3d);
        EXPECT(gbc.pc(), 0x28dd);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02A3
        gbc.setState(0x9f5, 0x4985, 0xfd90, 0x568a, 0xd74f, 0x492, 0x1, 0x0);
        gbc.writeMem(0x9f5, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0x56);
        EXPECT(gbc.c(),  0x8a);
        EXPECT(gbc.d(),  0xd7);
        EXPECT(gbc.e(),  0x4f);
        EXPECT(gbc.h(),  0x4);
        EXPECT(gbc.l(),  0x92);
        EXPECT(gbc.sp(), 0x4985);
        EXPECT(gbc.pc(), 0x9f6);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02A4
        gbc.setState(0xcb25, 0xb133, 0x880, 0xabc5, 0x2e1b, 0x8aab, 0x1, 0x0);
        gbc.writeMem(0xcb25, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0xab);
        EXPECT(gbc.c(),  0xc5);
        EXPECT(gbc.d(),  0x2e);
        EXPECT(gbc.e(),  0x1b);
        EXPECT(gbc.h(),  0x8a);
        EXPECT(gbc.l(),  0xab);
        EXPECT(gbc.sp(), 0xb133);
        EXPECT(gbc.pc(), 0xcb26);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcb25), 0xa4);
        // A4 02A5
        gbc.setState(0x13e0, 0x7c85, 0x6470, 0x19ab, 0x6dd6, 0x7a08, 0x0, 0x0);
        gbc.writeMem(0x13e0, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x60);
        EXPECT(gbc.b(),  0x19);
        EXPECT(gbc.c(),  0xab);
        EXPECT(gbc.d(),  0x6d);
        EXPECT(gbc.e(),  0xd6);
        EXPECT(gbc.h(),  0x7a);
        EXPECT(gbc.l(),  0x8);
        EXPECT(gbc.sp(), 0x7c85);
        EXPECT(gbc.pc(), 0x13e1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02A6
        gbc.setState(0xcef0, 0x7bca, 0xef40, 0xa853, 0x789f, 0x6e47, 0x1, 0x0);
        gbc.writeMem(0xcef0, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x6e);
        EXPECT(gbc.b(),  0xa8);
        EXPECT(gbc.c(),  0x53);
        EXPECT(gbc.d(),  0x78);
        EXPECT(gbc.e(),  0x9f);
        EXPECT(gbc.h(),  0x6e);
        EXPECT(gbc.l(),  0x47);
        EXPECT(gbc.sp(), 0x7bca);
        EXPECT(gbc.pc(), 0xcef1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcef0), 0xa4);
        // A4 02A8
        gbc.setState(0xd966, 0xb0a3, 0x31d0, 0xc716, 0x2ea1, 0xc8ce, 0x1, 0x0);
        gbc.writeMem(0xd966, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0xc7);
        EXPECT(gbc.c(),  0x16);
        EXPECT(gbc.d(),  0x2e);
        EXPECT(gbc.e(),  0xa1);
        EXPECT(gbc.h(),  0xc8);
        EXPECT(gbc.l(),  0xce);
        EXPECT(gbc.sp(), 0xb0a3);
        EXPECT(gbc.pc(), 0xd967);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd966), 0xa4);
        // A4 02A9
        gbc.setState(0x53bf, 0x4411, 0x9f30, 0x83b1, 0xb2a8, 0xec2f, 0x0, 0x1);
        gbc.writeMem(0x53bf, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8c);
        EXPECT(gbc.b(),  0x83);
        EXPECT(gbc.c(),  0xb1);
        EXPECT(gbc.d(),  0xb2);
        EXPECT(gbc.e(),  0xa8);
        EXPECT(gbc.h(),  0xec);
        EXPECT(gbc.l(),  0x2f);
        EXPECT(gbc.sp(), 0x4411);
        EXPECT(gbc.pc(), 0x53c0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02AA
        gbc.setState(0x35f0, 0x605e, 0xac50, 0x799, 0xc842, 0x9d2b, 0x1, 0x1);
        gbc.writeMem(0x35f0, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8c);
        EXPECT(gbc.b(),  0x7);
        EXPECT(gbc.c(),  0x99);
        EXPECT(gbc.d(),  0xc8);
        EXPECT(gbc.e(),  0x42);
        EXPECT(gbc.h(),  0x9d);
        EXPECT(gbc.l(),  0x2b);
        EXPECT(gbc.sp(), 0x605e);
        EXPECT(gbc.pc(), 0x35f1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02AB
        gbc.setState(0xd8ce, 0xb60c, 0x53d0, 0xaf0b, 0x972b, 0x769a, 0x1, 0x0);
        gbc.writeMem(0xd8ce, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x52);
        EXPECT(gbc.b(),  0xaf);
        EXPECT(gbc.c(),  0xb);
        EXPECT(gbc.d(),  0x97);
        EXPECT(gbc.e(),  0x2b);
        EXPECT(gbc.h(),  0x76);
        EXPECT(gbc.l(),  0x9a);
        EXPECT(gbc.sp(), 0xb60c);
        EXPECT(gbc.pc(), 0xd8cf);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd8ce), 0xa4);
        // A4 02AC
        gbc.setState(0x53ec, 0xbeab, 0xdda0, 0x5c1, 0x2086, 0x14c4, 0x0, 0x0);
        gbc.writeMem(0x53ec, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x14);
        EXPECT(gbc.b(),  0x5);
        EXPECT(gbc.c(),  0xc1);
        EXPECT(gbc.d(),  0x20);
        EXPECT(gbc.e(),  0x86);
        EXPECT(gbc.h(),  0x14);
        EXPECT(gbc.l(),  0xc4);
        EXPECT(gbc.sp(), 0xbeab);
        EXPECT(gbc.pc(), 0x53ed);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02AE
        gbc.setState(0x25f1, 0xb0fa, 0xf980, 0xcce7, 0xfb65, 0x5f5a, 0x1, 0x0);
        gbc.writeMem(0x25f1, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x59);
        EXPECT(gbc.b(),  0xcc);
        EXPECT(gbc.c(),  0xe7);
        EXPECT(gbc.d(),  0xfb);
        EXPECT(gbc.e(),  0x65);
        EXPECT(gbc.h(),  0x5f);
        EXPECT(gbc.l(),  0x5a);
        EXPECT(gbc.sp(), 0xb0fa);
        EXPECT(gbc.pc(), 0x25f2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02AF
        gbc.setState(0x16ce, 0xe2c, 0x8ef0, 0xf98, 0x8b63, 0x84a9, 0x0, 0x1);
        gbc.writeMem(0x16ce, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x84);
        EXPECT(gbc.b(),  0xf);
        EXPECT(gbc.c(),  0x98);
        EXPECT(gbc.d(),  0x8b);
        EXPECT(gbc.e(),  0x63);
        EXPECT(gbc.h(),  0x84);
        EXPECT(gbc.l(),  0xa9);
        EXPECT(gbc.sp(), 0xe2c);
        EXPECT(gbc.pc(), 0x16cf);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02B0
        gbc.setState(0x172a, 0x808, 0xdb90, 0x5a5, 0x97a, 0x962e, 0x0, 0x0);
        gbc.writeMem(0x172a, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x92);
        EXPECT(gbc.b(),  0x5);
        EXPECT(gbc.c(),  0xa5);
        EXPECT(gbc.d(),  0x9);
        EXPECT(gbc.e(),  0x7a);
        EXPECT(gbc.h(),  0x96);
        EXPECT(gbc.l(),  0x2e);
        EXPECT(gbc.sp(), 0x808);
        EXPECT(gbc.pc(), 0x172b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02B1
        gbc.setState(0xdcde, 0x5a1c, 0x49e0, 0x61a5, 0x2751, 0x75bf, 0x1, 0x0);
        gbc.writeMem(0xdcde, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x41);
        EXPECT(gbc.b(),  0x61);
        EXPECT(gbc.c(),  0xa5);
        EXPECT(gbc.d(),  0x27);
        EXPECT(gbc.e(),  0x51);
        EXPECT(gbc.h(),  0x75);
        EXPECT(gbc.l(),  0xbf);
        EXPECT(gbc.sp(), 0x5a1c);
        EXPECT(gbc.pc(), 0xdcdf);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdcde), 0xa4);
        // A4 02B2
        gbc.setState(0x11c8, 0x8de0, 0x3b40, 0x6069, 0x2b8a, 0xca94, 0x0, 0x0);
        gbc.writeMem(0x11c8, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa);
        EXPECT(gbc.b(),  0x60);
        EXPECT(gbc.c(),  0x69);
        EXPECT(gbc.d(),  0x2b);
        EXPECT(gbc.e(),  0x8a);
        EXPECT(gbc.h(),  0xca);
        EXPECT(gbc.l(),  0x94);
        EXPECT(gbc.sp(), 0x8de0);
        EXPECT(gbc.pc(), 0x11c9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02B3
        gbc.setState(0x2623, 0xda87, 0x3140, 0x6126, 0xcfe3, 0x7cc9, 0x1, 0x0);
        gbc.writeMem(0x2623, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x30);
        EXPECT(gbc.b(),  0x61);
        EXPECT(gbc.c(),  0x26);
        EXPECT(gbc.d(),  0xcf);
        EXPECT(gbc.e(),  0xe3);
        EXPECT(gbc.h(),  0x7c);
        EXPECT(gbc.l(),  0xc9);
        EXPECT(gbc.sp(), 0xda87);
        EXPECT(gbc.pc(), 0x2624);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02B4
        gbc.setState(0x54fa, 0x1522, 0xce20, 0xaecc, 0x2758, 0x9bcd, 0x1, 0x0);
        gbc.writeMem(0x54fa, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8a);
        EXPECT(gbc.b(),  0xae);
        EXPECT(gbc.c(),  0xcc);
        EXPECT(gbc.d(),  0x27);
        EXPECT(gbc.e(),  0x58);
        EXPECT(gbc.h(),  0x9b);
        EXPECT(gbc.l(),  0xcd);
        EXPECT(gbc.sp(), 0x1522);
        EXPECT(gbc.pc(), 0x54fb);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02B5
        gbc.setState(0x52e2, 0xabae, 0x4590, 0x1dfa, 0x3078, 0xa5c3, 0x0, 0x1);
        gbc.writeMem(0x52e2, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x5);
        EXPECT(gbc.b(),  0x1d);
        EXPECT(gbc.c(),  0xfa);
        EXPECT(gbc.d(),  0x30);
        EXPECT(gbc.e(),  0x78);
        EXPECT(gbc.h(),  0xa5);
        EXPECT(gbc.l(),  0xc3);
        EXPECT(gbc.sp(), 0xabae);
        EXPECT(gbc.pc(), 0x52e3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02B6
        gbc.setState(0xb7b0, 0xb312, 0x6fc0, 0xae53, 0x3abd, 0x68ae, 0x0, 0x0);
        gbc.writeMem(0xb7b0, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x68);
        EXPECT(gbc.b(),  0xae);
        EXPECT(gbc.c(),  0x53);
        EXPECT(gbc.d(),  0x3a);
        EXPECT(gbc.e(),  0xbd);
        EXPECT(gbc.h(),  0x68);
        EXPECT(gbc.l(),  0xae);
        EXPECT(gbc.sp(), 0xb312);
        EXPECT(gbc.pc(), 0xb7b1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb7b0), 0xa4);
        // A4 02B7
        gbc.setState(0x978, 0xb2ac, 0x75c0, 0x6959, 0x2fed, 0x8eb3, 0x0, 0x1);
        gbc.writeMem(0x978, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0x69);
        EXPECT(gbc.c(),  0x59);
        EXPECT(gbc.d(),  0x2f);
        EXPECT(gbc.e(),  0xed);
        EXPECT(gbc.h(),  0x8e);
        EXPECT(gbc.l(),  0xb3);
        EXPECT(gbc.sp(), 0xb2ac);
        EXPECT(gbc.pc(), 0x979);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02B8
        gbc.setState(0xc2ae, 0x3629, 0xe010, 0xe074, 0xf0da, 0x4325, 0x0, 0x0);
        gbc.writeMem(0xc2ae, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0xe0);
        EXPECT(gbc.c(),  0x74);
        EXPECT(gbc.d(),  0xf0);
        EXPECT(gbc.e(),  0xda);
        EXPECT(gbc.h(),  0x43);
        EXPECT(gbc.l(),  0x25);
        EXPECT(gbc.sp(), 0x3629);
        EXPECT(gbc.pc(), 0xc2af);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc2ae), 0xa4);
        // A4 02B9
        gbc.setState(0x72a7, 0xe6c5, 0x5e20, 0x4e4b, 0x12e3, 0xf4c8, 0x1, 0x0);
        gbc.writeMem(0x72a7, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x54);
        EXPECT(gbc.b(),  0x4e);
        EXPECT(gbc.c(),  0x4b);
        EXPECT(gbc.d(),  0x12);
        EXPECT(gbc.e(),  0xe3);
        EXPECT(gbc.h(),  0xf4);
        EXPECT(gbc.l(),  0xc8);
        EXPECT(gbc.sp(), 0xe6c5);
        EXPECT(gbc.pc(), 0x72a8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02BA
        gbc.setState(0x1307, 0x5900, 0x3530, 0x6e13, 0xbdc3, 0x1a0a, 0x0, 0x1);
        gbc.writeMem(0x1307, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0x6e);
        EXPECT(gbc.c(),  0x13);
        EXPECT(gbc.d(),  0xbd);
        EXPECT(gbc.e(),  0xc3);
        EXPECT(gbc.h(),  0x1a);
        EXPECT(gbc.l(),  0xa);
        EXPECT(gbc.sp(), 0x5900);
        EXPECT(gbc.pc(), 0x1308);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02BB
        gbc.setState(0x5247, 0x3f62, 0xca50, 0x7183, 0xcfa6, 0x6d18, 0x1, 0x1);
        gbc.writeMem(0x5247, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x48);
        EXPECT(gbc.b(),  0x71);
        EXPECT(gbc.c(),  0x83);
        EXPECT(gbc.d(),  0xcf);
        EXPECT(gbc.e(),  0xa6);
        EXPECT(gbc.h(),  0x6d);
        EXPECT(gbc.l(),  0x18);
        EXPECT(gbc.sp(), 0x3f62);
        EXPECT(gbc.pc(), 0x5248);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02BC
        gbc.setState(0xc08, 0x459c, 0x9970, 0x6a8, 0xc434, 0x7415, 0x1, 0x0);
        gbc.writeMem(0xc08, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0x6);
        EXPECT(gbc.c(),  0xa8);
        EXPECT(gbc.d(),  0xc4);
        EXPECT(gbc.e(),  0x34);
        EXPECT(gbc.h(),  0x74);
        EXPECT(gbc.l(),  0x15);
        EXPECT(gbc.sp(), 0x459c);
        EXPECT(gbc.pc(), 0xc09);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02BD
        gbc.setState(0x19eb, 0x3819, 0xd270, 0xa1e3, 0x61a, 0x8cc8, 0x1, 0x1);
        gbc.writeMem(0x19eb, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0xa1);
        EXPECT(gbc.c(),  0xe3);
        EXPECT(gbc.d(),  0x6);
        EXPECT(gbc.e(),  0x1a);
        EXPECT(gbc.h(),  0x8c);
        EXPECT(gbc.l(),  0xc8);
        EXPECT(gbc.sp(), 0x3819);
        EXPECT(gbc.pc(), 0x19ec);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02BE
        gbc.setState(0x7955, 0xfd9c, 0x2c30, 0x204d, 0xaf00, 0xfcca, 0x1, 0x1);
        gbc.writeMem(0x7955, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2c);
        EXPECT(gbc.b(),  0x20);
        EXPECT(gbc.c(),  0x4d);
        EXPECT(gbc.d(),  0xaf);
        EXPECT(gbc.e(),  0x0);
        EXPECT(gbc.h(),  0xfc);
        EXPECT(gbc.l(),  0xca);
        EXPECT(gbc.sp(), 0xfd9c);
        EXPECT(gbc.pc(), 0x7956);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02BF
        gbc.setState(0x2774, 0xc18b, 0xaa0, 0x60d, 0xd6b8, 0xaac4, 0x0, 0x0);
        gbc.writeMem(0x2774, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa);
        EXPECT(gbc.b(),  0x6);
        EXPECT(gbc.c(),  0xd);
        EXPECT(gbc.d(),  0xd6);
        EXPECT(gbc.e(),  0xb8);
        EXPECT(gbc.h(),  0xaa);
        EXPECT(gbc.l(),  0xc4);
        EXPECT(gbc.sp(), 0xc18b);
        EXPECT(gbc.pc(), 0x2775);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02C0
        gbc.setState(0xa06f, 0x9d68, 0x830, 0xb080, 0xe200, 0xe8cf, 0x1, 0x1);
        gbc.writeMem(0xa06f, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0xb0);
        EXPECT(gbc.c(),  0x80);
        EXPECT(gbc.d(),  0xe2);
        EXPECT(gbc.e(),  0x0);
        EXPECT(gbc.h(),  0xe8);
        EXPECT(gbc.l(),  0xcf);
        EXPECT(gbc.sp(), 0x9d68);
        EXPECT(gbc.pc(), 0xa070);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa06f), 0xa4);
        // A4 02C1
        gbc.setState(0xab6, 0xf13, 0xe8d0, 0x2b02, 0xc251, 0xd7dc, 0x0, 0x0);
        gbc.writeMem(0xab6, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc0);
        EXPECT(gbc.b(),  0x2b);
        EXPECT(gbc.c(),  0x2);
        EXPECT(gbc.d(),  0xc2);
        EXPECT(gbc.e(),  0x51);
        EXPECT(gbc.h(),  0xd7);
        EXPECT(gbc.l(),  0xdc);
        EXPECT(gbc.sp(), 0xf13);
        EXPECT(gbc.pc(), 0xab7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02C2
        gbc.setState(0x1d00, 0xbc7b, 0x6870, 0xdcbd, 0xdbe1, 0x61ed, 0x1, 0x0);
        gbc.writeMem(0x1d00, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x60);
        EXPECT(gbc.b(),  0xdc);
        EXPECT(gbc.c(),  0xbd);
        EXPECT(gbc.d(),  0xdb);
        EXPECT(gbc.e(),  0xe1);
        EXPECT(gbc.h(),  0x61);
        EXPECT(gbc.l(),  0xed);
        EXPECT(gbc.sp(), 0xbc7b);
        EXPECT(gbc.pc(), 0x1d01);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02C3
        gbc.setState(0xe919, 0xbcfb, 0x8b10, 0x7cc3, 0x5465, 0x1603, 0x1, 0x1);
        gbc.writeMem(0xe919, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0x7c);
        EXPECT(gbc.c(),  0xc3);
        EXPECT(gbc.d(),  0x54);
        EXPECT(gbc.e(),  0x65);
        EXPECT(gbc.h(),  0x16);
        EXPECT(gbc.l(),  0x3);
        EXPECT(gbc.sp(), 0xbcfb);
        EXPECT(gbc.pc(), 0xe91a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe919), 0xa4);
        // A4 02C4
        gbc.setState(0xc294, 0x3d7a, 0xdcf0, 0xc9f9, 0x6e88, 0x4e70, 0x0, 0x1);
        gbc.writeMem(0xc294, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4c);
        EXPECT(gbc.b(),  0xc9);
        EXPECT(gbc.c(),  0xf9);
        EXPECT(gbc.d(),  0x6e);
        EXPECT(gbc.e(),  0x88);
        EXPECT(gbc.h(),  0x4e);
        EXPECT(gbc.l(),  0x70);
        EXPECT(gbc.sp(), 0x3d7a);
        EXPECT(gbc.pc(), 0xc295);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc294), 0xa4);
        // A4 02C5
        gbc.setState(0x46b4, 0xb38b, 0x5fe0, 0x3bae, 0xcdc, 0xd76f, 0x1, 0x0);
        gbc.writeMem(0x46b4, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x57);
        EXPECT(gbc.b(),  0x3b);
        EXPECT(gbc.c(),  0xae);
        EXPECT(gbc.d(),  0xc);
        EXPECT(gbc.e(),  0xdc);
        EXPECT(gbc.h(),  0xd7);
        EXPECT(gbc.l(),  0x6f);
        EXPECT(gbc.sp(), 0xb38b);
        EXPECT(gbc.pc(), 0x46b5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02C6
        gbc.setState(0x9796, 0x61d1, 0x90d0, 0x76e7, 0x75fb, 0xf97c, 0x0, 0x0);
        gbc.writeMem(0x9796, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x90);
        EXPECT(gbc.b(),  0x76);
        EXPECT(gbc.c(),  0xe7);
        EXPECT(gbc.d(),  0x75);
        EXPECT(gbc.e(),  0xfb);
        EXPECT(gbc.h(),  0xf9);
        EXPECT(gbc.l(),  0x7c);
        EXPECT(gbc.sp(), 0x61d1);
        EXPECT(gbc.pc(), 0x9797);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9796), 0xa4);
        // A4 02C7
        gbc.setState(0xea95, 0x5caf, 0xaa10, 0x4433, 0xade9, 0x709, 0x1, 0x1);
        gbc.writeMem(0xea95, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0x44);
        EXPECT(gbc.c(),  0x33);
        EXPECT(gbc.d(),  0xad);
        EXPECT(gbc.e(),  0xe9);
        EXPECT(gbc.h(),  0x7);
        EXPECT(gbc.l(),  0x9);
        EXPECT(gbc.sp(), 0x5caf);
        EXPECT(gbc.pc(), 0xea96);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xea95), 0xa4);
        // A4 02C8
        gbc.setState(0xd142, 0x1d61, 0xc300, 0x957c, 0x1d42, 0x1092, 0x1, 0x0);
        gbc.writeMem(0xd142, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x95);
        EXPECT(gbc.c(),  0x7c);
        EXPECT(gbc.d(),  0x1d);
        EXPECT(gbc.e(),  0x42);
        EXPECT(gbc.h(),  0x10);
        EXPECT(gbc.l(),  0x92);
        EXPECT(gbc.sp(), 0x1d61);
        EXPECT(gbc.pc(), 0xd143);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd142), 0xa4);
        // A4 02C9
        gbc.setState(0xa32f, 0x6d53, 0x5640, 0x6019, 0xa701, 0x640, 0x0, 0x1);
        gbc.writeMem(0xa32f, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x6);
        EXPECT(gbc.b(),  0x60);
        EXPECT(gbc.c(),  0x19);
        EXPECT(gbc.d(),  0xa7);
        EXPECT(gbc.e(),  0x1);
        EXPECT(gbc.h(),  0x6);
        EXPECT(gbc.l(),  0x40);
        EXPECT(gbc.sp(), 0x6d53);
        EXPECT(gbc.pc(), 0xa330);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa32f), 0xa4);
        // A4 02CA
        gbc.setState(0x27f9, 0x450e, 0xc3a0, 0xe416, 0x1faf, 0x96b9, 0x0, 0x0);
        gbc.writeMem(0x27f9, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x82);
        EXPECT(gbc.b(),  0xe4);
        EXPECT(gbc.c(),  0x16);
        EXPECT(gbc.d(),  0x1f);
        EXPECT(gbc.e(),  0xaf);
        EXPECT(gbc.h(),  0x96);
        EXPECT(gbc.l(),  0xb9);
        EXPECT(gbc.sp(), 0x450e);
        EXPECT(gbc.pc(), 0x27fa);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02CB
        gbc.setState(0xba42, 0x8735, 0xbef0, 0xd4e3, 0x5dda, 0xb504, 0x0, 0x1);
        gbc.writeMem(0xba42, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb4);
        EXPECT(gbc.b(),  0xd4);
        EXPECT(gbc.c(),  0xe3);
        EXPECT(gbc.d(),  0x5d);
        EXPECT(gbc.e(),  0xda);
        EXPECT(gbc.h(),  0xb5);
        EXPECT(gbc.l(),  0x4);
        EXPECT(gbc.sp(), 0x8735);
        EXPECT(gbc.pc(), 0xba43);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xba42), 0xa4);
        // A4 02CC
        gbc.setState(0x563, 0x873b, 0x6160, 0xe4f, 0x622d, 0x191d, 0x1, 0x1);
        gbc.writeMem(0x563, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0xe);
        EXPECT(gbc.c(),  0x4f);
        EXPECT(gbc.d(),  0x62);
        EXPECT(gbc.e(),  0x2d);
        EXPECT(gbc.h(),  0x19);
        EXPECT(gbc.l(),  0x1d);
        EXPECT(gbc.sp(), 0x873b);
        EXPECT(gbc.pc(), 0x564);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02CD
        gbc.setState(0x5588, 0x2c1b, 0x7f90, 0xc65d, 0x16c7, 0xb2ee, 0x0, 0x1);
        gbc.writeMem(0x5588, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x32);
        EXPECT(gbc.b(),  0xc6);
        EXPECT(gbc.c(),  0x5d);
        EXPECT(gbc.d(),  0x16);
        EXPECT(gbc.e(),  0xc7);
        EXPECT(gbc.h(),  0xb2);
        EXPECT(gbc.l(),  0xee);
        EXPECT(gbc.sp(), 0x2c1b);
        EXPECT(gbc.pc(), 0x5589);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02CF
        gbc.setState(0x1ece, 0xf627, 0x69d0, 0xb970, 0x10ee, 0x70eb, 0x0, 0x1);
        gbc.writeMem(0x1ece, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x60);
        EXPECT(gbc.b(),  0xb9);
        EXPECT(gbc.c(),  0x70);
        EXPECT(gbc.d(),  0x10);
        EXPECT(gbc.e(),  0xee);
        EXPECT(gbc.h(),  0x70);
        EXPECT(gbc.l(),  0xeb);
        EXPECT(gbc.sp(), 0xf627);
        EXPECT(gbc.pc(), 0x1ecf);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02D0
        gbc.setState(0x5587, 0x3d69, 0x19b0, 0xd290, 0x4959, 0x4cfe, 0x0, 0x1);
        gbc.writeMem(0x5587, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0xd2);
        EXPECT(gbc.c(),  0x90);
        EXPECT(gbc.d(),  0x49);
        EXPECT(gbc.e(),  0x59);
        EXPECT(gbc.h(),  0x4c);
        EXPECT(gbc.l(),  0xfe);
        EXPECT(gbc.sp(), 0x3d69);
        EXPECT(gbc.pc(), 0x5588);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02D1
        gbc.setState(0xd169, 0x3448, 0x850, 0x76ba, 0x3ac, 0xb247, 0x0, 0x1);
        gbc.writeMem(0xd169, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x76);
        EXPECT(gbc.c(),  0xba);
        EXPECT(gbc.d(),  0x3);
        EXPECT(gbc.e(),  0xac);
        EXPECT(gbc.h(),  0xb2);
        EXPECT(gbc.l(),  0x47);
        EXPECT(gbc.sp(), 0x3448);
        EXPECT(gbc.pc(), 0xd16a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd169), 0xa4);
        // A4 02D2
        gbc.setState(0x59e0, 0xcab, 0xf880, 0x2d3c, 0xe0a5, 0x2056, 0x1, 0x1);
        gbc.writeMem(0x59e0, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0x2d);
        EXPECT(gbc.c(),  0x3c);
        EXPECT(gbc.d(),  0xe0);
        EXPECT(gbc.e(),  0xa5);
        EXPECT(gbc.h(),  0x20);
        EXPECT(gbc.l(),  0x56);
        EXPECT(gbc.sp(), 0xcab);
        EXPECT(gbc.pc(), 0x59e1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02D3
        gbc.setState(0xb6f9, 0x1c59, 0xd530, 0x5f9a, 0xd4a1, 0x8fd6, 0x0, 0x0);
        gbc.writeMem(0xb6f9, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x85);
        EXPECT(gbc.b(),  0x5f);
        EXPECT(gbc.c(),  0x9a);
        EXPECT(gbc.d(),  0xd4);
        EXPECT(gbc.e(),  0xa1);
        EXPECT(gbc.h(),  0x8f);
        EXPECT(gbc.l(),  0xd6);
        EXPECT(gbc.sp(), 0x1c59);
        EXPECT(gbc.pc(), 0xb6fa);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb6f9), 0xa4);
        // A4 02D5
        gbc.setState(0x9468, 0x8134, 0x13f0, 0x585b, 0x3e3a, 0x38cb, 0x1, 0x0);
        gbc.writeMem(0x9468, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0x58);
        EXPECT(gbc.c(),  0x5b);
        EXPECT(gbc.d(),  0x3e);
        EXPECT(gbc.e(),  0x3a);
        EXPECT(gbc.h(),  0x38);
        EXPECT(gbc.l(),  0xcb);
        EXPECT(gbc.sp(), 0x8134);
        EXPECT(gbc.pc(), 0x9469);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9468), 0xa4);
        // A4 02D6
        gbc.setState(0xcab4, 0xcac0, 0x4420, 0xd04a, 0x1b20, 0x97e4, 0x1, 0x1);
        gbc.writeMem(0xcab4, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0xd0);
        EXPECT(gbc.c(),  0x4a);
        EXPECT(gbc.d(),  0x1b);
        EXPECT(gbc.e(),  0x20);
        EXPECT(gbc.h(),  0x97);
        EXPECT(gbc.l(),  0xe4);
        EXPECT(gbc.sp(), 0xcac0);
        EXPECT(gbc.pc(), 0xcab5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcab4), 0xa4);
        // A4 02D7
        gbc.setState(0x21ab, 0xdf86, 0xbc90, 0x11ef, 0xd010, 0xbac9, 0x0, 0x1);
        gbc.writeMem(0x21ab, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb8);
        EXPECT(gbc.b(),  0x11);
        EXPECT(gbc.c(),  0xef);
        EXPECT(gbc.d(),  0xd0);
        EXPECT(gbc.e(),  0x10);
        EXPECT(gbc.h(),  0xba);
        EXPECT(gbc.l(),  0xc9);
        EXPECT(gbc.sp(), 0xdf86);
        EXPECT(gbc.pc(), 0x21ac);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02D8
        gbc.setState(0x39d1, 0xbc8c, 0x4bd0, 0x3406, 0x24cc, 0xa5e6, 0x0, 0x0);
        gbc.writeMem(0x39d1, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0x34);
        EXPECT(gbc.c(),  0x6);
        EXPECT(gbc.d(),  0x24);
        EXPECT(gbc.e(),  0xcc);
        EXPECT(gbc.h(),  0xa5);
        EXPECT(gbc.l(),  0xe6);
        EXPECT(gbc.sp(), 0xbc8c);
        EXPECT(gbc.pc(), 0x39d2);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02D9
        gbc.setState(0x2ebe, 0xbcac, 0x6df0, 0xc4c2, 0xf41b, 0x14a9, 0x1, 0x0);
        gbc.writeMem(0x2ebe, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0xc4);
        EXPECT(gbc.c(),  0xc2);
        EXPECT(gbc.d(),  0xf4);
        EXPECT(gbc.e(),  0x1b);
        EXPECT(gbc.h(),  0x14);
        EXPECT(gbc.l(),  0xa9);
        EXPECT(gbc.sp(), 0xbcac);
        EXPECT(gbc.pc(), 0x2ebf);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02DA
        gbc.setState(0xe31a, 0xa61d, 0x1940, 0xa3c3, 0xef99, 0x5c6a, 0x1, 0x1);
        gbc.writeMem(0xe31a, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x18);
        EXPECT(gbc.b(),  0xa3);
        EXPECT(gbc.c(),  0xc3);
        EXPECT(gbc.d(),  0xef);
        EXPECT(gbc.e(),  0x99);
        EXPECT(gbc.h(),  0x5c);
        EXPECT(gbc.l(),  0x6a);
        EXPECT(gbc.sp(), 0xa61d);
        EXPECT(gbc.pc(), 0xe31b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe31a), 0xa4);
        // A4 02DB
        gbc.setState(0x47a, 0xd323, 0x1eb0, 0xd0cb, 0xed5f, 0x7563, 0x0, 0x0);
        gbc.writeMem(0x47a, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x14);
        EXPECT(gbc.b(),  0xd0);
        EXPECT(gbc.c(),  0xcb);
        EXPECT(gbc.d(),  0xed);
        EXPECT(gbc.e(),  0x5f);
        EXPECT(gbc.h(),  0x75);
        EXPECT(gbc.l(),  0x63);
        EXPECT(gbc.sp(), 0xd323);
        EXPECT(gbc.pc(), 0x47b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02DC
        gbc.setState(0x4dc9, 0x26e8, 0x33a0, 0x9efa, 0x8aed, 0x58c1, 0x1, 0x0);
        gbc.writeMem(0x4dc9, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0x9e);
        EXPECT(gbc.c(),  0xfa);
        EXPECT(gbc.d(),  0x8a);
        EXPECT(gbc.e(),  0xed);
        EXPECT(gbc.h(),  0x58);
        EXPECT(gbc.l(),  0xc1);
        EXPECT(gbc.sp(), 0x26e8);
        EXPECT(gbc.pc(), 0x4dca);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02DE
        gbc.setState(0x6ff9, 0xb610, 0xf980, 0x1a20, 0x9429, 0x50ee, 0x0, 0x0);
        gbc.writeMem(0x6ff9, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x50);
        EXPECT(gbc.b(),  0x1a);
        EXPECT(gbc.c(),  0x20);
        EXPECT(gbc.d(),  0x94);
        EXPECT(gbc.e(),  0x29);
        EXPECT(gbc.h(),  0x50);
        EXPECT(gbc.l(),  0xee);
        EXPECT(gbc.sp(), 0xb610);
        EXPECT(gbc.pc(), 0x6ffa);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02DF
        gbc.setState(0x614c, 0x58c4, 0x50, 0xba8b, 0xc7d, 0x766a, 0x0, 0x1);
        gbc.writeMem(0x614c, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0xba);
        EXPECT(gbc.c(),  0x8b);
        EXPECT(gbc.d(),  0xc);
        EXPECT(gbc.e(),  0x7d);
        EXPECT(gbc.h(),  0x76);
        EXPECT(gbc.l(),  0x6a);
        EXPECT(gbc.sp(), 0x58c4);
        EXPECT(gbc.pc(), 0x614d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02E0
        gbc.setState(0xac5d, 0xecb2, 0xb730, 0x4538, 0x4bbb, 0x9c96, 0x0, 0x0);
        gbc.writeMem(0xac5d, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x94);
        EXPECT(gbc.b(),  0x45);
        EXPECT(gbc.c(),  0x38);
        EXPECT(gbc.d(),  0x4b);
        EXPECT(gbc.e(),  0xbb);
        EXPECT(gbc.h(),  0x9c);
        EXPECT(gbc.l(),  0x96);
        EXPECT(gbc.sp(), 0xecb2);
        EXPECT(gbc.pc(), 0xac5e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xac5d), 0xa4);
        // A4 02E1
        gbc.setState(0x53bc, 0x5fe0, 0xe020, 0x5e40, 0x3daa, 0xa0ba, 0x0, 0x0);
        gbc.writeMem(0x53bc, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa0);
        EXPECT(gbc.b(),  0x5e);
        EXPECT(gbc.c(),  0x40);
        EXPECT(gbc.d(),  0x3d);
        EXPECT(gbc.e(),  0xaa);
        EXPECT(gbc.h(),  0xa0);
        EXPECT(gbc.l(),  0xba);
        EXPECT(gbc.sp(), 0x5fe0);
        EXPECT(gbc.pc(), 0x53bd);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02E2
        gbc.setState(0xbe02, 0xae26, 0x1260, 0xfa98, 0x4478, 0x7c7f, 0x1, 0x1);
        gbc.writeMem(0xbe02, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0xfa);
        EXPECT(gbc.c(),  0x98);
        EXPECT(gbc.d(),  0x44);
        EXPECT(gbc.e(),  0x78);
        EXPECT(gbc.h(),  0x7c);
        EXPECT(gbc.l(),  0x7f);
        EXPECT(gbc.sp(), 0xae26);
        EXPECT(gbc.pc(), 0xbe03);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbe02), 0xa4);
        // A4 02E3
        gbc.setState(0x79df, 0x112d, 0xcc30, 0xef4, 0xd937, 0xe7c3, 0x1, 0x1);
        gbc.writeMem(0x79df, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc4);
        EXPECT(gbc.b(),  0xe);
        EXPECT(gbc.c(),  0xf4);
        EXPECT(gbc.d(),  0xd9);
        EXPECT(gbc.e(),  0x37);
        EXPECT(gbc.h(),  0xe7);
        EXPECT(gbc.l(),  0xc3);
        EXPECT(gbc.sp(), 0x112d);
        EXPECT(gbc.pc(), 0x79e0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02E4
        gbc.setState(0x28c6, 0xd21b, 0x68d0, 0x8984, 0xcd38, 0xb5c3, 0x1, 0x1);
        gbc.writeMem(0x28c6, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0x89);
        EXPECT(gbc.c(),  0x84);
        EXPECT(gbc.d(),  0xcd);
        EXPECT(gbc.e(),  0x38);
        EXPECT(gbc.h(),  0xb5);
        EXPECT(gbc.l(),  0xc3);
        EXPECT(gbc.sp(), 0xd21b);
        EXPECT(gbc.pc(), 0x28c7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02E5
        gbc.setState(0x2b4, 0x1643, 0xa4e0, 0x990, 0x81ec, 0x640, 0x0, 0x1);
        gbc.writeMem(0x2b4, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0x9);
        EXPECT(gbc.c(),  0x90);
        EXPECT(gbc.d(),  0x81);
        EXPECT(gbc.e(),  0xec);
        EXPECT(gbc.h(),  0x6);
        EXPECT(gbc.l(),  0x40);
        EXPECT(gbc.sp(), 0x1643);
        EXPECT(gbc.pc(), 0x2b5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02E6
        gbc.setState(0x4b2b, 0xf961, 0xe420, 0x3f21, 0xbcf1, 0xdbf2, 0x0, 0x1);
        gbc.writeMem(0x4b2b, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc0);
        EXPECT(gbc.b(),  0x3f);
        EXPECT(gbc.c(),  0x21);
        EXPECT(gbc.d(),  0xbc);
        EXPECT(gbc.e(),  0xf1);
        EXPECT(gbc.h(),  0xdb);
        EXPECT(gbc.l(),  0xf2);
        EXPECT(gbc.sp(), 0xf961);
        EXPECT(gbc.pc(), 0x4b2c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02E7
        gbc.setState(0x31e6, 0x3b49, 0x1980, 0x62d6, 0xe824, 0x23b0, 0x0, 0x0);
        gbc.writeMem(0x31e6, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0x62);
        EXPECT(gbc.c(),  0xd6);
        EXPECT(gbc.d(),  0xe8);
        EXPECT(gbc.e(),  0x24);
        EXPECT(gbc.h(),  0x23);
        EXPECT(gbc.l(),  0xb0);
        EXPECT(gbc.sp(), 0x3b49);
        EXPECT(gbc.pc(), 0x31e7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02E8
        gbc.setState(0x6d18, 0x9b, 0x1660, 0x754, 0x3e9, 0xbb82, 0x1, 0x0);
        gbc.writeMem(0x6d18, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x12);
        EXPECT(gbc.b(),  0x7);
        EXPECT(gbc.c(),  0x54);
        EXPECT(gbc.d(),  0x3);
        EXPECT(gbc.e(),  0xe9);
        EXPECT(gbc.h(),  0xbb);
        EXPECT(gbc.l(),  0x82);
        EXPECT(gbc.sp(), 0x9b);
        EXPECT(gbc.pc(), 0x6d19);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02E9
        gbc.setState(0x4166, 0x77e5, 0xf310, 0xc9ea, 0x72ee, 0xca8b, 0x0, 0x1);
        gbc.writeMem(0x4166, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc2);
        EXPECT(gbc.b(),  0xc9);
        EXPECT(gbc.c(),  0xea);
        EXPECT(gbc.d(),  0x72);
        EXPECT(gbc.e(),  0xee);
        EXPECT(gbc.h(),  0xca);
        EXPECT(gbc.l(),  0x8b);
        EXPECT(gbc.sp(), 0x77e5);
        EXPECT(gbc.pc(), 0x4167);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02EA
        gbc.setState(0x894a, 0xf605, 0xeff0, 0x5768, 0x38a6, 0xa89f, 0x0, 0x0);
        gbc.writeMem(0x894a, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa8);
        EXPECT(gbc.b(),  0x57);
        EXPECT(gbc.c(),  0x68);
        EXPECT(gbc.d(),  0x38);
        EXPECT(gbc.e(),  0xa6);
        EXPECT(gbc.h(),  0xa8);
        EXPECT(gbc.l(),  0x9f);
        EXPECT(gbc.sp(), 0xf605);
        EXPECT(gbc.pc(), 0x894b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x894a), 0xa4);
        // A4 02EB
        gbc.setState(0x28fb, 0xcd7e, 0xf960, 0x273d, 0x4fc5, 0x63a3, 0x1, 0x1);
        gbc.writeMem(0x28fb, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x61);
        EXPECT(gbc.b(),  0x27);
        EXPECT(gbc.c(),  0x3d);
        EXPECT(gbc.d(),  0x4f);
        EXPECT(gbc.e(),  0xc5);
        EXPECT(gbc.h(),  0x63);
        EXPECT(gbc.l(),  0xa3);
        EXPECT(gbc.sp(), 0xcd7e);
        EXPECT(gbc.pc(), 0x28fc);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02EC
        gbc.setState(0xc5cf, 0x14f7, 0xccf0, 0xc96b, 0xefdc, 0x1e64, 0x0, 0x0);
        gbc.writeMem(0xc5cf, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc);
        EXPECT(gbc.b(),  0xc9);
        EXPECT(gbc.c(),  0x6b);
        EXPECT(gbc.d(),  0xef);
        EXPECT(gbc.e(),  0xdc);
        EXPECT(gbc.h(),  0x1e);
        EXPECT(gbc.l(),  0x64);
        EXPECT(gbc.sp(), 0x14f7);
        EXPECT(gbc.pc(), 0xc5d0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc5cf), 0xa4);
        // A4 02ED
        gbc.setState(0x37d8, 0x61bb, 0x5350, 0x6bbc, 0x52ef, 0xe7b, 0x1, 0x1);
        gbc.writeMem(0x37d8, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0x6b);
        EXPECT(gbc.c(),  0xbc);
        EXPECT(gbc.d(),  0x52);
        EXPECT(gbc.e(),  0xef);
        EXPECT(gbc.h(),  0xe);
        EXPECT(gbc.l(),  0x7b);
        EXPECT(gbc.sp(), 0x61bb);
        EXPECT(gbc.pc(), 0x37d9);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02EE
        gbc.setState(0x4496, 0xf213, 0xb800, 0x6b5e, 0x1965, 0x88f2, 0x0, 0x0);
        gbc.writeMem(0x4496, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x88);
        EXPECT(gbc.b(),  0x6b);
        EXPECT(gbc.c(),  0x5e);
        EXPECT(gbc.d(),  0x19);
        EXPECT(gbc.e(),  0x65);
        EXPECT(gbc.h(),  0x88);
        EXPECT(gbc.l(),  0xf2);
        EXPECT(gbc.sp(), 0xf213);
        EXPECT(gbc.pc(), 0x4497);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02EF
        gbc.setState(0x32ac, 0x67de, 0x92c0, 0x81f8, 0xf01d, 0xfff0, 0x0, 0x1);
        gbc.writeMem(0x32ac, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x92);
        EXPECT(gbc.b(),  0x81);
        EXPECT(gbc.c(),  0xf8);
        EXPECT(gbc.d(),  0xf0);
        EXPECT(gbc.e(),  0x1d);
        EXPECT(gbc.h(),  0xff);
        EXPECT(gbc.l(),  0xf0);
        EXPECT(gbc.sp(), 0x67de);
        EXPECT(gbc.pc(), 0x32ad);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02F0
        gbc.setState(0xa68e, 0x4364, 0x1b70, 0xd1a3, 0x4706, 0xd987, 0x0, 0x0);
        gbc.writeMem(0xa68e, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x19);
        EXPECT(gbc.b(),  0xd1);
        EXPECT(gbc.c(),  0xa3);
        EXPECT(gbc.d(),  0x47);
        EXPECT(gbc.e(),  0x6);
        EXPECT(gbc.h(),  0xd9);
        EXPECT(gbc.l(),  0x87);
        EXPECT(gbc.sp(), 0x4364);
        EXPECT(gbc.pc(), 0xa68f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa68e), 0xa4);
        // A4 02F1
        gbc.setState(0x6278, 0x7b85, 0xc0f0, 0x8ad7, 0xb1d1, 0x6a28, 0x0, 0x0);
        gbc.writeMem(0x6278, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0x8a);
        EXPECT(gbc.c(),  0xd7);
        EXPECT(gbc.d(),  0xb1);
        EXPECT(gbc.e(),  0xd1);
        EXPECT(gbc.h(),  0x6a);
        EXPECT(gbc.l(),  0x28);
        EXPECT(gbc.sp(), 0x7b85);
        EXPECT(gbc.pc(), 0x6279);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02F2
        gbc.setState(0x2aa8, 0x8dd4, 0x7550, 0x5926, 0x13f3, 0x581d, 0x0, 0x1);
        gbc.writeMem(0x2aa8, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x50);
        EXPECT(gbc.b(),  0x59);
        EXPECT(gbc.c(),  0x26);
        EXPECT(gbc.d(),  0x13);
        EXPECT(gbc.e(),  0xf3);
        EXPECT(gbc.h(),  0x58);
        EXPECT(gbc.l(),  0x1d);
        EXPECT(gbc.sp(), 0x8dd4);
        EXPECT(gbc.pc(), 0x2aa9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02F4
        gbc.setState(0x25ea, 0xb478, 0x3c00, 0x7150, 0xae6d, 0xb1c3, 0x1, 0x1);
        gbc.writeMem(0x25ea, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x30);
        EXPECT(gbc.b(),  0x71);
        EXPECT(gbc.c(),  0x50);
        EXPECT(gbc.d(),  0xae);
        EXPECT(gbc.e(),  0x6d);
        EXPECT(gbc.h(),  0xb1);
        EXPECT(gbc.l(),  0xc3);
        EXPECT(gbc.sp(), 0xb478);
        EXPECT(gbc.pc(), 0x25eb);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02F5
        gbc.setState(0xee4f, 0x64e9, 0x8490, 0x7c43, 0x857f, 0xf0bb, 0x1, 0x1);
        gbc.writeMem(0xee4f, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0x7c);
        EXPECT(gbc.c(),  0x43);
        EXPECT(gbc.d(),  0x85);
        EXPECT(gbc.e(),  0x7f);
        EXPECT(gbc.h(),  0xf0);
        EXPECT(gbc.l(),  0xbb);
        EXPECT(gbc.sp(), 0x64e9);
        EXPECT(gbc.pc(), 0xee50);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xee4f), 0xa4);
        // A4 02F6
        gbc.setState(0x5e5, 0x7390, 0x5b10, 0x4faf, 0x236d, 0x20fc, 0x0, 0x0);
        gbc.writeMem(0x5e5, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x4f);
        EXPECT(gbc.c(),  0xaf);
        EXPECT(gbc.d(),  0x23);
        EXPECT(gbc.e(),  0x6d);
        EXPECT(gbc.h(),  0x20);
        EXPECT(gbc.l(),  0xfc);
        EXPECT(gbc.sp(), 0x7390);
        EXPECT(gbc.pc(), 0x5e6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02F7
        gbc.setState(0x425f, 0x7f16, 0x59b0, 0xd252, 0x104f, 0x51d1, 0x0, 0x0);
        gbc.writeMem(0x425f, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x51);
        EXPECT(gbc.b(),  0xd2);
        EXPECT(gbc.c(),  0x52);
        EXPECT(gbc.d(),  0x10);
        EXPECT(gbc.e(),  0x4f);
        EXPECT(gbc.h(),  0x51);
        EXPECT(gbc.l(),  0xd1);
        EXPECT(gbc.sp(), 0x7f16);
        EXPECT(gbc.pc(), 0x4260);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02F8
        gbc.setState(0x4f28, 0x689f, 0xb4e0, 0x2690, 0xf118, 0xd2a4, 0x1, 0x0);
        gbc.writeMem(0x4f28, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x90);
        EXPECT(gbc.b(),  0x26);
        EXPECT(gbc.c(),  0x90);
        EXPECT(gbc.d(),  0xf1);
        EXPECT(gbc.e(),  0x18);
        EXPECT(gbc.h(),  0xd2);
        EXPECT(gbc.l(),  0xa4);
        EXPECT(gbc.sp(), 0x689f);
        EXPECT(gbc.pc(), 0x4f29);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02F9
        gbc.setState(0x5474, 0xa142, 0xf930, 0xdc92, 0x5ba0, 0xfd9, 0x1, 0x1);
        gbc.writeMem(0x5474, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x9);
        EXPECT(gbc.b(),  0xdc);
        EXPECT(gbc.c(),  0x92);
        EXPECT(gbc.d(),  0x5b);
        EXPECT(gbc.e(),  0xa0);
        EXPECT(gbc.h(),  0xf);
        EXPECT(gbc.l(),  0xd9);
        EXPECT(gbc.sp(), 0xa142);
        EXPECT(gbc.pc(), 0x5475);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02FA
        gbc.setState(0xc874, 0xce37, 0x6c60, 0x3981, 0xe9df, 0x39d4, 0x0, 0x0);
        gbc.writeMem(0xc874, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0x39);
        EXPECT(gbc.c(),  0x81);
        EXPECT(gbc.d(),  0xe9);
        EXPECT(gbc.e(),  0xdf);
        EXPECT(gbc.h(),  0x39);
        EXPECT(gbc.l(),  0xd4);
        EXPECT(gbc.sp(), 0xce37);
        EXPECT(gbc.pc(), 0xc875);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc874), 0xa4);
        // A4 02FB
        gbc.setState(0xc698, 0xfef8, 0x6860, 0x21aa, 0xbf36, 0x4d9a, 0x0, 0x0);
        gbc.writeMem(0xc698, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x48);
        EXPECT(gbc.b(),  0x21);
        EXPECT(gbc.c(),  0xaa);
        EXPECT(gbc.d(),  0xbf);
        EXPECT(gbc.e(),  0x36);
        EXPECT(gbc.h(),  0x4d);
        EXPECT(gbc.l(),  0x9a);
        EXPECT(gbc.sp(), 0xfef8);
        EXPECT(gbc.pc(), 0xc699);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc698), 0xa4);
        // A4 02FC
        gbc.setState(0xc91, 0x2a1a, 0xab60, 0xde45, 0x5a4d, 0xf49, 0x1, 0x1);
        gbc.writeMem(0xc91, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb);
        EXPECT(gbc.b(),  0xde);
        EXPECT(gbc.c(),  0x45);
        EXPECT(gbc.d(),  0x5a);
        EXPECT(gbc.e(),  0x4d);
        EXPECT(gbc.h(),  0xf);
        EXPECT(gbc.l(),  0x49);
        EXPECT(gbc.sp(), 0x2a1a);
        EXPECT(gbc.pc(), 0xc92);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02FD
        gbc.setState(0x3bdb, 0x3ac4, 0xd010, 0xda59, 0x9408, 0xf516, 0x0, 0x0);
        gbc.writeMem(0x3bdb, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd0);
        EXPECT(gbc.b(),  0xda);
        EXPECT(gbc.c(),  0x59);
        EXPECT(gbc.d(),  0x94);
        EXPECT(gbc.e(),  0x8);
        EXPECT(gbc.h(),  0xf5);
        EXPECT(gbc.l(),  0x16);
        EXPECT(gbc.sp(), 0x3ac4);
        EXPECT(gbc.pc(), 0x3bdc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02FE
        gbc.setState(0x586, 0x5c31, 0x4fa0, 0x877b, 0x1866, 0xfc3, 0x0, 0x1);
        gbc.writeMem(0x586, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf);
        EXPECT(gbc.b(),  0x87);
        EXPECT(gbc.c(),  0x7b);
        EXPECT(gbc.d(),  0x18);
        EXPECT(gbc.e(),  0x66);
        EXPECT(gbc.h(),  0xf);
        EXPECT(gbc.l(),  0xc3);
        EXPECT(gbc.sp(), 0x5c31);
        EXPECT(gbc.pc(), 0x587);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 02FF
        gbc.setState(0x83, 0xaf13, 0x1c0, 0x7a3, 0x3f6, 0x3627, 0x0, 0x1);
        gbc.writeMem(0x83, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x7);
        EXPECT(gbc.c(),  0xa3);
        EXPECT(gbc.d(),  0x3);
        EXPECT(gbc.e(),  0xf6);
        EXPECT(gbc.h(),  0x36);
        EXPECT(gbc.l(),  0x27);
        EXPECT(gbc.sp(), 0xaf13);
        EXPECT(gbc.pc(), 0x84);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0300
        gbc.setState(0x56f5, 0xf639, 0x52a0, 0x1820, 0x45bc, 0x5e43, 0x0, 0x1);
        gbc.writeMem(0x56f5, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x52);
        EXPECT(gbc.b(),  0x18);
        EXPECT(gbc.c(),  0x20);
        EXPECT(gbc.d(),  0x45);
        EXPECT(gbc.e(),  0xbc);
        EXPECT(gbc.h(),  0x5e);
        EXPECT(gbc.l(),  0x43);
        EXPECT(gbc.sp(), 0xf639);
        EXPECT(gbc.pc(), 0x56f6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0301
        gbc.setState(0xcace, 0x1136, 0x1300, 0x187e, 0x7a3, 0xfae6, 0x0, 0x0);
        gbc.writeMem(0xcace, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x12);
        EXPECT(gbc.b(),  0x18);
        EXPECT(gbc.c(),  0x7e);
        EXPECT(gbc.d(),  0x7);
        EXPECT(gbc.e(),  0xa3);
        EXPECT(gbc.h(),  0xfa);
        EXPECT(gbc.l(),  0xe6);
        EXPECT(gbc.sp(), 0x1136);
        EXPECT(gbc.pc(), 0xcacf);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcace), 0xa4);
        // A4 0302
        gbc.setState(0xc4ad, 0xdd5b, 0x1de0, 0x4971, 0xf3ec, 0x7f29, 0x0, 0x0);
        gbc.writeMem(0xc4ad, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1d);
        EXPECT(gbc.b(),  0x49);
        EXPECT(gbc.c(),  0x71);
        EXPECT(gbc.d(),  0xf3);
        EXPECT(gbc.e(),  0xec);
        EXPECT(gbc.h(),  0x7f);
        EXPECT(gbc.l(),  0x29);
        EXPECT(gbc.sp(), 0xdd5b);
        EXPECT(gbc.pc(), 0xc4ae);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc4ad), 0xa4);
        // A4 0303
        gbc.setState(0x9129, 0xe475, 0x1960, 0x725f, 0x8979, 0x5556, 0x0, 0x0);
        gbc.writeMem(0x9129, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x11);
        EXPECT(gbc.b(),  0x72);
        EXPECT(gbc.c(),  0x5f);
        EXPECT(gbc.d(),  0x89);
        EXPECT(gbc.e(),  0x79);
        EXPECT(gbc.h(),  0x55);
        EXPECT(gbc.l(),  0x56);
        EXPECT(gbc.sp(), 0xe475);
        EXPECT(gbc.pc(), 0x912a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9129), 0xa4);
        // A4 0304
        gbc.setState(0xef3f, 0xbba, 0xb4d0, 0x2fd3, 0xae58, 0xc366, 0x1, 0x1);
        gbc.writeMem(0xef3f, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0x2f);
        EXPECT(gbc.c(),  0xd3);
        EXPECT(gbc.d(),  0xae);
        EXPECT(gbc.e(),  0x58);
        EXPECT(gbc.h(),  0xc3);
        EXPECT(gbc.l(),  0x66);
        EXPECT(gbc.sp(), 0xbba);
        EXPECT(gbc.pc(), 0xef40);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xef3f), 0xa4);
        // A4 0305
        gbc.setState(0x7ef0, 0x30e4, 0x84e0, 0xcbff, 0xce67, 0xbc3c, 0x1, 0x0);
        gbc.writeMem(0x7ef0, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x84);
        EXPECT(gbc.b(),  0xcb);
        EXPECT(gbc.c(),  0xff);
        EXPECT(gbc.d(),  0xce);
        EXPECT(gbc.e(),  0x67);
        EXPECT(gbc.h(),  0xbc);
        EXPECT(gbc.l(),  0x3c);
        EXPECT(gbc.sp(), 0x30e4);
        EXPECT(gbc.pc(), 0x7ef1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0306
        gbc.setState(0x3af1, 0x6f1d, 0x6340, 0xcade, 0xdd13, 0xc7c7, 0x0, 0x0);
        gbc.writeMem(0x3af1, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x43);
        EXPECT(gbc.b(),  0xca);
        EXPECT(gbc.c(),  0xde);
        EXPECT(gbc.d(),  0xdd);
        EXPECT(gbc.e(),  0x13);
        EXPECT(gbc.h(),  0xc7);
        EXPECT(gbc.l(),  0xc7);
        EXPECT(gbc.sp(), 0x6f1d);
        EXPECT(gbc.pc(), 0x3af2);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0307
        gbc.setState(0x2fe4, 0xfd92, 0x9e90, 0x5ab1, 0xa47, 0xf01b, 0x0, 0x1);
        gbc.writeMem(0x2fe4, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x90);
        EXPECT(gbc.b(),  0x5a);
        EXPECT(gbc.c(),  0xb1);
        EXPECT(gbc.d(),  0xa);
        EXPECT(gbc.e(),  0x47);
        EXPECT(gbc.h(),  0xf0);
        EXPECT(gbc.l(),  0x1b);
        EXPECT(gbc.sp(), 0xfd92);
        EXPECT(gbc.pc(), 0x2fe5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0309
        gbc.setState(0x49f2, 0x380, 0x1040, 0xf914, 0x4933, 0x7525, 0x0, 0x0);
        gbc.writeMem(0x49f2, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0xf9);
        EXPECT(gbc.c(),  0x14);
        EXPECT(gbc.d(),  0x49);
        EXPECT(gbc.e(),  0x33);
        EXPECT(gbc.h(),  0x75);
        EXPECT(gbc.l(),  0x25);
        EXPECT(gbc.sp(), 0x380);
        EXPECT(gbc.pc(), 0x49f3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 030A
        gbc.setState(0x2ece, 0x4e72, 0x3530, 0x5273, 0x862f, 0x41c0, 0x0, 0x0);
        gbc.writeMem(0x2ece, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0x52);
        EXPECT(gbc.c(),  0x73);
        EXPECT(gbc.d(),  0x86);
        EXPECT(gbc.e(),  0x2f);
        EXPECT(gbc.h(),  0x41);
        EXPECT(gbc.l(),  0xc0);
        EXPECT(gbc.sp(), 0x4e72);
        EXPECT(gbc.pc(), 0x2ecf);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 030B
        gbc.setState(0xe702, 0xe075, 0x16b0, 0xd9e3, 0xee7f, 0xf194, 0x1, 0x0);
        gbc.writeMem(0xe702, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0xd9);
        EXPECT(gbc.c(),  0xe3);
        EXPECT(gbc.d(),  0xee);
        EXPECT(gbc.e(),  0x7f);
        EXPECT(gbc.h(),  0xf1);
        EXPECT(gbc.l(),  0x94);
        EXPECT(gbc.sp(), 0xe075);
        EXPECT(gbc.pc(), 0xe703);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe702), 0xa4);
        // A4 030C
        gbc.setState(0x1af4, 0x3cd, 0xfd80, 0x3db4, 0xc1e5, 0x28d0, 0x1, 0x0);
        gbc.writeMem(0x1af4, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0x3d);
        EXPECT(gbc.c(),  0xb4);
        EXPECT(gbc.d(),  0xc1);
        EXPECT(gbc.e(),  0xe5);
        EXPECT(gbc.h(),  0x28);
        EXPECT(gbc.l(),  0xd0);
        EXPECT(gbc.sp(), 0x3cd);
        EXPECT(gbc.pc(), 0x1af5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 030D
        gbc.setState(0x4e5c, 0x913f, 0x81e0, 0x774a, 0xef84, 0x61a2, 0x0, 0x1);
        gbc.writeMem(0x4e5c, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0x77);
        EXPECT(gbc.c(),  0x4a);
        EXPECT(gbc.d(),  0xef);
        EXPECT(gbc.e(),  0x84);
        EXPECT(gbc.h(),  0x61);
        EXPECT(gbc.l(),  0xa2);
        EXPECT(gbc.sp(), 0x913f);
        EXPECT(gbc.pc(), 0x4e5d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 030E
        gbc.setState(0x4005, 0xf541, 0xd660, 0x4dc6, 0xaf1a, 0x71ab, 0x1, 0x0);
        gbc.writeMem(0x4005, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x50);
        EXPECT(gbc.b(),  0x4d);
        EXPECT(gbc.c(),  0xc6);
        EXPECT(gbc.d(),  0xaf);
        EXPECT(gbc.e(),  0x1a);
        EXPECT(gbc.h(),  0x71);
        EXPECT(gbc.l(),  0xab);
        EXPECT(gbc.sp(), 0xf541);
        EXPECT(gbc.pc(), 0x4006);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 030F
        gbc.setState(0xb5e6, 0x312f, 0x16f0, 0xbbf1, 0x17a5, 0x106b, 0x1, 0x0);
        gbc.writeMem(0xb5e6, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0xbb);
        EXPECT(gbc.c(),  0xf1);
        EXPECT(gbc.d(),  0x17);
        EXPECT(gbc.e(),  0xa5);
        EXPECT(gbc.h(),  0x10);
        EXPECT(gbc.l(),  0x6b);
        EXPECT(gbc.sp(), 0x312f);
        EXPECT(gbc.pc(), 0xb5e7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb5e6), 0xa4);
        // A4 0310
        gbc.setState(0x61c, 0xf0d9, 0x43b0, 0xd8d3, 0x8d, 0xf19f, 0x1, 0x1);
        gbc.writeMem(0x61c, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x41);
        EXPECT(gbc.b(),  0xd8);
        EXPECT(gbc.c(),  0xd3);
        EXPECT(gbc.d(),  0x0);
        EXPECT(gbc.e(),  0x8d);
        EXPECT(gbc.h(),  0xf1);
        EXPECT(gbc.l(),  0x9f);
        EXPECT(gbc.sp(), 0xf0d9);
        EXPECT(gbc.pc(), 0x61d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0311
        gbc.setState(0x7aff, 0x664c, 0x3e10, 0xd523, 0xf47a, 0x3b8e, 0x0, 0x1);
        gbc.writeMem(0x7aff, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3a);
        EXPECT(gbc.b(),  0xd5);
        EXPECT(gbc.c(),  0x23);
        EXPECT(gbc.d(),  0xf4);
        EXPECT(gbc.e(),  0x7a);
        EXPECT(gbc.h(),  0x3b);
        EXPECT(gbc.l(),  0x8e);
        EXPECT(gbc.sp(), 0x664c);
        EXPECT(gbc.pc(), 0x7b00);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0312
        gbc.setState(0xa35b, 0x53cb, 0x1a70, 0xcc5d, 0x26b0, 0xc613, 0x0, 0x1);
        gbc.writeMem(0xa35b, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0xcc);
        EXPECT(gbc.c(),  0x5d);
        EXPECT(gbc.d(),  0x26);
        EXPECT(gbc.e(),  0xb0);
        EXPECT(gbc.h(),  0xc6);
        EXPECT(gbc.l(),  0x13);
        EXPECT(gbc.sp(), 0x53cb);
        EXPECT(gbc.pc(), 0xa35c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa35b), 0xa4);
        // A4 0313
        gbc.setState(0x2054, 0x89d4, 0xc4f0, 0xf183, 0x261a, 0xf34a, 0x1, 0x0);
        gbc.writeMem(0x2054, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc0);
        EXPECT(gbc.b(),  0xf1);
        EXPECT(gbc.c(),  0x83);
        EXPECT(gbc.d(),  0x26);
        EXPECT(gbc.e(),  0x1a);
        EXPECT(gbc.h(),  0xf3);
        EXPECT(gbc.l(),  0x4a);
        EXPECT(gbc.sp(), 0x89d4);
        EXPECT(gbc.pc(), 0x2055);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0314
        gbc.setState(0xbc11, 0x1b32, 0x3370, 0x7daa, 0x527c, 0x360e, 0x1, 0x0);
        gbc.writeMem(0xbc11, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x32);
        EXPECT(gbc.b(),  0x7d);
        EXPECT(gbc.c(),  0xaa);
        EXPECT(gbc.d(),  0x52);
        EXPECT(gbc.e(),  0x7c);
        EXPECT(gbc.h(),  0x36);
        EXPECT(gbc.l(),  0xe);
        EXPECT(gbc.sp(), 0x1b32);
        EXPECT(gbc.pc(), 0xbc12);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbc11), 0xa4);
        // A4 0315
        gbc.setState(0x4f1b, 0x7e45, 0xe030, 0x2e43, 0x4dd5, 0x6e70, 0x0, 0x1);
        gbc.writeMem(0x4f1b, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x60);
        EXPECT(gbc.b(),  0x2e);
        EXPECT(gbc.c(),  0x43);
        EXPECT(gbc.d(),  0x4d);
        EXPECT(gbc.e(),  0xd5);
        EXPECT(gbc.h(),  0x6e);
        EXPECT(gbc.l(),  0x70);
        EXPECT(gbc.sp(), 0x7e45);
        EXPECT(gbc.pc(), 0x4f1c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0316
        gbc.setState(0x9dc4, 0xc551, 0x4c40, 0xad9f, 0xf195, 0xf9db, 0x0, 0x0);
        gbc.writeMem(0x9dc4, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x48);
        EXPECT(gbc.b(),  0xad);
        EXPECT(gbc.c(),  0x9f);
        EXPECT(gbc.d(),  0xf1);
        EXPECT(gbc.e(),  0x95);
        EXPECT(gbc.h(),  0xf9);
        EXPECT(gbc.l(),  0xdb);
        EXPECT(gbc.sp(), 0xc551);
        EXPECT(gbc.pc(), 0x9dc5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9dc4), 0xa4);
        // A4 0318
        gbc.setState(0x52ff, 0xbb28, 0x4650, 0xf04c, 0xc7c8, 0x5228, 0x0, 0x1);
        gbc.writeMem(0x52ff, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x42);
        EXPECT(gbc.b(),  0xf0);
        EXPECT(gbc.c(),  0x4c);
        EXPECT(gbc.d(),  0xc7);
        EXPECT(gbc.e(),  0xc8);
        EXPECT(gbc.h(),  0x52);
        EXPECT(gbc.l(),  0x28);
        EXPECT(gbc.sp(), 0xbb28);
        EXPECT(gbc.pc(), 0x5300);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0319
        gbc.setState(0xb675, 0x99dd, 0x1370, 0xc905, 0x6e26, 0xb36a, 0x1, 0x1);
        gbc.writeMem(0xb675, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x13);
        EXPECT(gbc.b(),  0xc9);
        EXPECT(gbc.c(),  0x5);
        EXPECT(gbc.d(),  0x6e);
        EXPECT(gbc.e(),  0x26);
        EXPECT(gbc.h(),  0xb3);
        EXPECT(gbc.l(),  0x6a);
        EXPECT(gbc.sp(), 0x99dd);
        EXPECT(gbc.pc(), 0xb676);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb675), 0xa4);
        // A4 031A
        gbc.setState(0x58c1, 0xcf12, 0x10b0, 0x5581, 0x9957, 0xb45f, 0x0, 0x0);
        gbc.writeMem(0x58c1, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0x55);
        EXPECT(gbc.c(),  0x81);
        EXPECT(gbc.d(),  0x99);
        EXPECT(gbc.e(),  0x57);
        EXPECT(gbc.h(),  0xb4);
        EXPECT(gbc.l(),  0x5f);
        EXPECT(gbc.sp(), 0xcf12);
        EXPECT(gbc.pc(), 0x58c2);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 031B
        gbc.setState(0x51f9, 0x6c79, 0xcba0, 0x7f01, 0x8e4e, 0xca31, 0x0, 0x0);
        gbc.writeMem(0x51f9, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xca);
        EXPECT(gbc.b(),  0x7f);
        EXPECT(gbc.c(),  0x1);
        EXPECT(gbc.d(),  0x8e);
        EXPECT(gbc.e(),  0x4e);
        EXPECT(gbc.h(),  0xca);
        EXPECT(gbc.l(),  0x31);
        EXPECT(gbc.sp(), 0x6c79);
        EXPECT(gbc.pc(), 0x51fa);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 031C
        gbc.setState(0xb9ea, 0x3b5e, 0x7110, 0x951a, 0x47a0, 0x2d92, 0x1, 0x0);
        gbc.writeMem(0xb9ea, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x21);
        EXPECT(gbc.b(),  0x95);
        EXPECT(gbc.c(),  0x1a);
        EXPECT(gbc.d(),  0x47);
        EXPECT(gbc.e(),  0xa0);
        EXPECT(gbc.h(),  0x2d);
        EXPECT(gbc.l(),  0x92);
        EXPECT(gbc.sp(), 0x3b5e);
        EXPECT(gbc.pc(), 0xb9eb);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb9ea), 0xa4);
        // A4 031D
        gbc.setState(0xb184, 0xb137, 0xaf20, 0x9a3c, 0x4694, 0xcfc8, 0x0, 0x0);
        gbc.writeMem(0xb184, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8f);
        EXPECT(gbc.b(),  0x9a);
        EXPECT(gbc.c(),  0x3c);
        EXPECT(gbc.d(),  0x46);
        EXPECT(gbc.e(),  0x94);
        EXPECT(gbc.h(),  0xcf);
        EXPECT(gbc.l(),  0xc8);
        EXPECT(gbc.sp(), 0xb137);
        EXPECT(gbc.pc(), 0xb185);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb184), 0xa4);
        // A4 031E
        gbc.setState(0x3fd, 0xbebb, 0x9950, 0x4eec, 0x2d51, 0xb79b, 0x0, 0x0);
        gbc.writeMem(0x3fd, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x91);
        EXPECT(gbc.b(),  0x4e);
        EXPECT(gbc.c(),  0xec);
        EXPECT(gbc.d(),  0x2d);
        EXPECT(gbc.e(),  0x51);
        EXPECT(gbc.h(),  0xb7);
        EXPECT(gbc.l(),  0x9b);
        EXPECT(gbc.sp(), 0xbebb);
        EXPECT(gbc.pc(), 0x3fe);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0320
        gbc.setState(0x4243, 0xd8e3, 0xbe70, 0xc405, 0xdda2, 0x4ae4, 0x0, 0x1);
        gbc.writeMem(0x4243, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa);
        EXPECT(gbc.b(),  0xc4);
        EXPECT(gbc.c(),  0x5);
        EXPECT(gbc.d(),  0xdd);
        EXPECT(gbc.e(),  0xa2);
        EXPECT(gbc.h(),  0x4a);
        EXPECT(gbc.l(),  0xe4);
        EXPECT(gbc.sp(), 0xd8e3);
        EXPECT(gbc.pc(), 0x4244);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0321
        gbc.setState(0x278d, 0x3904, 0x19a0, 0x5610, 0x704a, 0x75c4, 0x0, 0x1);
        gbc.writeMem(0x278d, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x11);
        EXPECT(gbc.b(),  0x56);
        EXPECT(gbc.c(),  0x10);
        EXPECT(gbc.d(),  0x70);
        EXPECT(gbc.e(),  0x4a);
        EXPECT(gbc.h(),  0x75);
        EXPECT(gbc.l(),  0xc4);
        EXPECT(gbc.sp(), 0x3904);
        EXPECT(gbc.pc(), 0x278e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0322
        gbc.setState(0x2ecb, 0x8ba3, 0x3a30, 0xec0, 0x7481, 0xb74e, 0x0, 0x0);
        gbc.writeMem(0x2ecb, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x32);
        EXPECT(gbc.b(),  0xe);
        EXPECT(gbc.c(),  0xc0);
        EXPECT(gbc.d(),  0x74);
        EXPECT(gbc.e(),  0x81);
        EXPECT(gbc.h(),  0xb7);
        EXPECT(gbc.l(),  0x4e);
        EXPECT(gbc.sp(), 0x8ba3);
        EXPECT(gbc.pc(), 0x2ecc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0323
        gbc.setState(0xdd96, 0x497e, 0xfa80, 0x97b9, 0xfe56, 0xc720, 0x1, 0x0);
        gbc.writeMem(0xdd96, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc2);
        EXPECT(gbc.b(),  0x97);
        EXPECT(gbc.c(),  0xb9);
        EXPECT(gbc.d(),  0xfe);
        EXPECT(gbc.e(),  0x56);
        EXPECT(gbc.h(),  0xc7);
        EXPECT(gbc.l(),  0x20);
        EXPECT(gbc.sp(), 0x497e);
        EXPECT(gbc.pc(), 0xdd97);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdd96), 0xa4);
        // A4 0324
        gbc.setState(0x99bc, 0x11e2, 0x2a50, 0x42c3, 0xb8e9, 0xfa64, 0x0, 0x1);
        gbc.writeMem(0x99bc, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2a);
        EXPECT(gbc.b(),  0x42);
        EXPECT(gbc.c(),  0xc3);
        EXPECT(gbc.d(),  0xb8);
        EXPECT(gbc.e(),  0xe9);
        EXPECT(gbc.h(),  0xfa);
        EXPECT(gbc.l(),  0x64);
        EXPECT(gbc.sp(), 0x11e2);
        EXPECT(gbc.pc(), 0x99bd);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x99bc), 0xa4);
        // A4 0325
        gbc.setState(0x1ec9, 0x3a90, 0x3330, 0xda47, 0x6e6a, 0xea11, 0x0, 0x1);
        gbc.writeMem(0x1ec9, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x22);
        EXPECT(gbc.b(),  0xda);
        EXPECT(gbc.c(),  0x47);
        EXPECT(gbc.d(),  0x6e);
        EXPECT(gbc.e(),  0x6a);
        EXPECT(gbc.h(),  0xea);
        EXPECT(gbc.l(),  0x11);
        EXPECT(gbc.sp(), 0x3a90);
        EXPECT(gbc.pc(), 0x1eca);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0326
        gbc.setState(0x7bc6, 0xa426, 0x72f0, 0x9672, 0x1cb1, 0x973f, 0x1, 0x1);
        gbc.writeMem(0x7bc6, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x12);
        EXPECT(gbc.b(),  0x96);
        EXPECT(gbc.c(),  0x72);
        EXPECT(gbc.d(),  0x1c);
        EXPECT(gbc.e(),  0xb1);
        EXPECT(gbc.h(),  0x97);
        EXPECT(gbc.l(),  0x3f);
        EXPECT(gbc.sp(), 0xa426);
        EXPECT(gbc.pc(), 0x7bc7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0327
        gbc.setState(0x6f5f, 0x7612, 0x8880, 0x683, 0xec28, 0x51d4, 0x0, 0x1);
        gbc.writeMem(0x6f5f, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x6);
        EXPECT(gbc.c(),  0x83);
        EXPECT(gbc.d(),  0xec);
        EXPECT(gbc.e(),  0x28);
        EXPECT(gbc.h(),  0x51);
        EXPECT(gbc.l(),  0xd4);
        EXPECT(gbc.sp(), 0x7612);
        EXPECT(gbc.pc(), 0x6f60);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0328
        gbc.setState(0x179, 0xe2c0, 0x7350, 0x70e3, 0x378a, 0x52dd, 0x1, 0x0);
        gbc.writeMem(0x179, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x52);
        EXPECT(gbc.b(),  0x70);
        EXPECT(gbc.c(),  0xe3);
        EXPECT(gbc.d(),  0x37);
        EXPECT(gbc.e(),  0x8a);
        EXPECT(gbc.h(),  0x52);
        EXPECT(gbc.l(),  0xdd);
        EXPECT(gbc.sp(), 0xe2c0);
        EXPECT(gbc.pc(), 0x17a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0329
        gbc.setState(0xb638, 0xa614, 0x48d0, 0x350a, 0x7f3a, 0xf8e, 0x0, 0x1);
        gbc.writeMem(0xb638, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0x35);
        EXPECT(gbc.c(),  0xa);
        EXPECT(gbc.d(),  0x7f);
        EXPECT(gbc.e(),  0x3a);
        EXPECT(gbc.h(),  0xf);
        EXPECT(gbc.l(),  0x8e);
        EXPECT(gbc.sp(), 0xa614);
        EXPECT(gbc.pc(), 0xb639);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb638), 0xa4);
        // A4 032A
        gbc.setState(0x3806, 0x7e46, 0x8960, 0xb0e4, 0xe326, 0x81ab, 0x0, 0x1);
        gbc.writeMem(0x3806, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x81);
        EXPECT(gbc.b(),  0xb0);
        EXPECT(gbc.c(),  0xe4);
        EXPECT(gbc.d(),  0xe3);
        EXPECT(gbc.e(),  0x26);
        EXPECT(gbc.h(),  0x81);
        EXPECT(gbc.l(),  0xab);
        EXPECT(gbc.sp(), 0x7e46);
        EXPECT(gbc.pc(), 0x3807);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 032B
        gbc.setState(0x2f4c, 0xf767, 0x5e00, 0x555d, 0x28b6, 0x5644, 0x0, 0x0);
        gbc.writeMem(0x2f4c, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x56);
        EXPECT(gbc.b(),  0x55);
        EXPECT(gbc.c(),  0x5d);
        EXPECT(gbc.d(),  0x28);
        EXPECT(gbc.e(),  0xb6);
        EXPECT(gbc.h(),  0x56);
        EXPECT(gbc.l(),  0x44);
        EXPECT(gbc.sp(), 0xf767);
        EXPECT(gbc.pc(), 0x2f4d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 032C
        gbc.setState(0xab18, 0xd301, 0x1140, 0x3149, 0x6636, 0x9fe8, 0x1, 0x0);
        gbc.writeMem(0xab18, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x11);
        EXPECT(gbc.b(),  0x31);
        EXPECT(gbc.c(),  0x49);
        EXPECT(gbc.d(),  0x66);
        EXPECT(gbc.e(),  0x36);
        EXPECT(gbc.h(),  0x9f);
        EXPECT(gbc.l(),  0xe8);
        EXPECT(gbc.sp(), 0xd301);
        EXPECT(gbc.pc(), 0xab19);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xab18), 0xa4);
        // A4 032D
        gbc.setState(0xce13, 0x3e2b, 0x8790, 0xc76e, 0x7e62, 0xd02f, 0x1, 0x0);
        gbc.writeMem(0xce13, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0xc7);
        EXPECT(gbc.c(),  0x6e);
        EXPECT(gbc.d(),  0x7e);
        EXPECT(gbc.e(),  0x62);
        EXPECT(gbc.h(),  0xd0);
        EXPECT(gbc.l(),  0x2f);
        EXPECT(gbc.sp(), 0x3e2b);
        EXPECT(gbc.pc(), 0xce14);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xce13), 0xa4);
        // A4 032E
        gbc.setState(0x6501, 0x369b, 0xa7a0, 0xfc42, 0x21d6, 0x1cc6, 0x0, 0x1);
        gbc.writeMem(0x6501, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0xfc);
        EXPECT(gbc.c(),  0x42);
        EXPECT(gbc.d(),  0x21);
        EXPECT(gbc.e(),  0xd6);
        EXPECT(gbc.h(),  0x1c);
        EXPECT(gbc.l(),  0xc6);
        EXPECT(gbc.sp(), 0x369b);
        EXPECT(gbc.pc(), 0x6502);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 032F
        gbc.setState(0x46b7, 0x4f0e, 0xf760, 0x9f96, 0x2458, 0x8f21, 0x1, 0x0);
        gbc.writeMem(0x46b7, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x87);
        EXPECT(gbc.b(),  0x9f);
        EXPECT(gbc.c(),  0x96);
        EXPECT(gbc.d(),  0x24);
        EXPECT(gbc.e(),  0x58);
        EXPECT(gbc.h(),  0x8f);
        EXPECT(gbc.l(),  0x21);
        EXPECT(gbc.sp(), 0x4f0e);
        EXPECT(gbc.pc(), 0x46b8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0330
        gbc.setState(0xc237, 0x33aa, 0xeb30, 0x3efa, 0xb4d5, 0x5e63, 0x0, 0x0);
        gbc.writeMem(0xc237, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4a);
        EXPECT(gbc.b(),  0x3e);
        EXPECT(gbc.c(),  0xfa);
        EXPECT(gbc.d(),  0xb4);
        EXPECT(gbc.e(),  0xd5);
        EXPECT(gbc.h(),  0x5e);
        EXPECT(gbc.l(),  0x63);
        EXPECT(gbc.sp(), 0x33aa);
        EXPECT(gbc.pc(), 0xc238);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc237), 0xa4);
        // A4 0331
        gbc.setState(0x2c55, 0x5190, 0x7080, 0xbcf2, 0xcd22, 0xa627, 0x0, 0x1);
        gbc.writeMem(0x2c55, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0xbc);
        EXPECT(gbc.c(),  0xf2);
        EXPECT(gbc.d(),  0xcd);
        EXPECT(gbc.e(),  0x22);
        EXPECT(gbc.h(),  0xa6);
        EXPECT(gbc.l(),  0x27);
        EXPECT(gbc.sp(), 0x5190);
        EXPECT(gbc.pc(), 0x2c56);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0332
        gbc.setState(0x315c, 0x9eaa, 0x81e0, 0xe731, 0xefb, 0x6706, 0x0, 0x1);
        gbc.writeMem(0x315c, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0xe7);
        EXPECT(gbc.c(),  0x31);
        EXPECT(gbc.d(),  0xe);
        EXPECT(gbc.e(),  0xfb);
        EXPECT(gbc.h(),  0x67);
        EXPECT(gbc.l(),  0x6);
        EXPECT(gbc.sp(), 0x9eaa);
        EXPECT(gbc.pc(), 0x315d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0333
        gbc.setState(0x3fc2, 0xccd1, 0xeed0, 0x8afc, 0x1afa, 0xc50b, 0x0, 0x1);
        gbc.writeMem(0x3fc2, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc4);
        EXPECT(gbc.b(),  0x8a);
        EXPECT(gbc.c(),  0xfc);
        EXPECT(gbc.d(),  0x1a);
        EXPECT(gbc.e(),  0xfa);
        EXPECT(gbc.h(),  0xc5);
        EXPECT(gbc.l(),  0xb);
        EXPECT(gbc.sp(), 0xccd1);
        EXPECT(gbc.pc(), 0x3fc3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0334
        gbc.setState(0x1ba4, 0x2a12, 0x9f50, 0xbb95, 0x7ea, 0xb1a0, 0x0, 0x1);
        gbc.writeMem(0x1ba4, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x91);
        EXPECT(gbc.b(),  0xbb);
        EXPECT(gbc.c(),  0x95);
        EXPECT(gbc.d(),  0x7);
        EXPECT(gbc.e(),  0xea);
        EXPECT(gbc.h(),  0xb1);
        EXPECT(gbc.l(),  0xa0);
        EXPECT(gbc.sp(), 0x2a12);
        EXPECT(gbc.pc(), 0x1ba5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0335
        gbc.setState(0xb950, 0xd5a8, 0x66c0, 0xa54b, 0xa13c, 0x472f, 0x0, 0x0);
        gbc.writeMem(0xb950, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x46);
        EXPECT(gbc.b(),  0xa5);
        EXPECT(gbc.c(),  0x4b);
        EXPECT(gbc.d(),  0xa1);
        EXPECT(gbc.e(),  0x3c);
        EXPECT(gbc.h(),  0x47);
        EXPECT(gbc.l(),  0x2f);
        EXPECT(gbc.sp(), 0xd5a8);
        EXPECT(gbc.pc(), 0xb951);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb950), 0xa4);
        // A4 0336
        gbc.setState(0xbedc, 0x2974, 0xebe0, 0x9e7e, 0x4890, 0x59b2, 0x1, 0x1);
        gbc.writeMem(0xbedc, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x49);
        EXPECT(gbc.b(),  0x9e);
        EXPECT(gbc.c(),  0x7e);
        EXPECT(gbc.d(),  0x48);
        EXPECT(gbc.e(),  0x90);
        EXPECT(gbc.h(),  0x59);
        EXPECT(gbc.l(),  0xb2);
        EXPECT(gbc.sp(), 0x2974);
        EXPECT(gbc.pc(), 0xbedd);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbedc), 0xa4);
        // A4 0338
        gbc.setState(0xd606, 0x848b, 0x7440, 0xdcc6, 0xdcff, 0x162f, 0x1, 0x0);
        gbc.writeMem(0xd606, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x14);
        EXPECT(gbc.b(),  0xdc);
        EXPECT(gbc.c(),  0xc6);
        EXPECT(gbc.d(),  0xdc);
        EXPECT(gbc.e(),  0xff);
        EXPECT(gbc.h(),  0x16);
        EXPECT(gbc.l(),  0x2f);
        EXPECT(gbc.sp(), 0x848b);
        EXPECT(gbc.pc(), 0xd607);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd606), 0xa4);
        // A4 0339
        gbc.setState(0x6482, 0x7a8c, 0x8b10, 0xc6a, 0x95e9, 0x96ec, 0x0, 0x0);
        gbc.writeMem(0x6482, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x82);
        EXPECT(gbc.b(),  0xc);
        EXPECT(gbc.c(),  0x6a);
        EXPECT(gbc.d(),  0x95);
        EXPECT(gbc.e(),  0xe9);
        EXPECT(gbc.h(),  0x96);
        EXPECT(gbc.l(),  0xec);
        EXPECT(gbc.sp(), 0x7a8c);
        EXPECT(gbc.pc(), 0x6483);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 033A
        gbc.setState(0x8ec, 0xdc71, 0x8720, 0xaff6, 0x9224, 0x7ca8, 0x1, 0x0);
        gbc.writeMem(0x8ec, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0xaf);
        EXPECT(gbc.c(),  0xf6);
        EXPECT(gbc.d(),  0x92);
        EXPECT(gbc.e(),  0x24);
        EXPECT(gbc.h(),  0x7c);
        EXPECT(gbc.l(),  0xa8);
        EXPECT(gbc.sp(), 0xdc71);
        EXPECT(gbc.pc(), 0x8ed);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 033B
        gbc.setState(0x18c6, 0xf535, 0x1030, 0x7cf, 0x243e, 0x1b6a, 0x1, 0x1);
        gbc.writeMem(0x18c6, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0x7);
        EXPECT(gbc.c(),  0xcf);
        EXPECT(gbc.d(),  0x24);
        EXPECT(gbc.e(),  0x3e);
        EXPECT(gbc.h(),  0x1b);
        EXPECT(gbc.l(),  0x6a);
        EXPECT(gbc.sp(), 0xf535);
        EXPECT(gbc.pc(), 0x18c7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 033C
        gbc.setState(0x92bc, 0x5708, 0xc950, 0x4bb7, 0x3fe0, 0x1a2a, 0x1, 0x0);
        gbc.writeMem(0x92bc, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0x4b);
        EXPECT(gbc.c(),  0xb7);
        EXPECT(gbc.d(),  0x3f);
        EXPECT(gbc.e(),  0xe0);
        EXPECT(gbc.h(),  0x1a);
        EXPECT(gbc.l(),  0x2a);
        EXPECT(gbc.sp(), 0x5708);
        EXPECT(gbc.pc(), 0x92bd);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x92bc), 0xa4);
        // A4 033E
        gbc.setState(0xbf5d, 0xe5ef, 0xc90, 0xc1db, 0x27d3, 0xc913, 0x0, 0x1);
        gbc.writeMem(0xbf5d, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0xc1);
        EXPECT(gbc.c(),  0xdb);
        EXPECT(gbc.d(),  0x27);
        EXPECT(gbc.e(),  0xd3);
        EXPECT(gbc.h(),  0xc9);
        EXPECT(gbc.l(),  0x13);
        EXPECT(gbc.sp(), 0xe5ef);
        EXPECT(gbc.pc(), 0xbf5e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbf5d), 0xa4);
        // A4 033F
        gbc.setState(0x65eb, 0x35dd, 0x96d0, 0xae91, 0x4507, 0x72cc, 0x1, 0x0);
        gbc.writeMem(0x65eb, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x12);
        EXPECT(gbc.b(),  0xae);
        EXPECT(gbc.c(),  0x91);
        EXPECT(gbc.d(),  0x45);
        EXPECT(gbc.e(),  0x7);
        EXPECT(gbc.h(),  0x72);
        EXPECT(gbc.l(),  0xcc);
        EXPECT(gbc.sp(), 0x35dd);
        EXPECT(gbc.pc(), 0x65ec);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0340
        gbc.setState(0xb330, 0x68ce, 0xabb0, 0xc785, 0xcb81, 0x2b2b, 0x1, 0x0);
        gbc.writeMem(0xb330, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2b);
        EXPECT(gbc.b(),  0xc7);
        EXPECT(gbc.c(),  0x85);
        EXPECT(gbc.d(),  0xcb);
        EXPECT(gbc.e(),  0x81);
        EXPECT(gbc.h(),  0x2b);
        EXPECT(gbc.l(),  0x2b);
        EXPECT(gbc.sp(), 0x68ce);
        EXPECT(gbc.pc(), 0xb331);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb330), 0xa4);
        // A4 0341
        gbc.setState(0x6cb6, 0xf324, 0x7590, 0x7de4, 0xcf01, 0xdc22, 0x0, 0x1);
        gbc.writeMem(0x6cb6, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x54);
        EXPECT(gbc.b(),  0x7d);
        EXPECT(gbc.c(),  0xe4);
        EXPECT(gbc.d(),  0xcf);
        EXPECT(gbc.e(),  0x1);
        EXPECT(gbc.h(),  0xdc);
        EXPECT(gbc.l(),  0x22);
        EXPECT(gbc.sp(), 0xf324);
        EXPECT(gbc.pc(), 0x6cb7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0342
        gbc.setState(0x4a71, 0x6e75, 0x2d80, 0x45ca, 0xa6f6, 0x2ace, 0x0, 0x1);
        gbc.writeMem(0x4a71, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0x45);
        EXPECT(gbc.c(),  0xca);
        EXPECT(gbc.d(),  0xa6);
        EXPECT(gbc.e(),  0xf6);
        EXPECT(gbc.h(),  0x2a);
        EXPECT(gbc.l(),  0xce);
        EXPECT(gbc.sp(), 0x6e75);
        EXPECT(gbc.pc(), 0x4a72);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0343
        gbc.setState(0x3c45, 0x21fc, 0xf080, 0xc8e0, 0x51b4, 0xc62c, 0x0, 0x1);
        gbc.writeMem(0x3c45, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc0);
        EXPECT(gbc.b(),  0xc8);
        EXPECT(gbc.c(),  0xe0);
        EXPECT(gbc.d(),  0x51);
        EXPECT(gbc.e(),  0xb4);
        EXPECT(gbc.h(),  0xc6);
        EXPECT(gbc.l(),  0x2c);
        EXPECT(gbc.sp(), 0x21fc);
        EXPECT(gbc.pc(), 0x3c46);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0344
        gbc.setState(0xd1ae, 0xd55c, 0x3520, 0xe75d, 0xbfe2, 0x49fa, 0x0, 0x0);
        gbc.writeMem(0xd1ae, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0xe7);
        EXPECT(gbc.c(),  0x5d);
        EXPECT(gbc.d(),  0xbf);
        EXPECT(gbc.e(),  0xe2);
        EXPECT(gbc.h(),  0x49);
        EXPECT(gbc.l(),  0xfa);
        EXPECT(gbc.sp(), 0xd55c);
        EXPECT(gbc.pc(), 0xd1af);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd1ae), 0xa4);
        // A4 0345
        gbc.setState(0x1053, 0x6e7f, 0xf860, 0x65ef, 0x7c73, 0xf920, 0x0, 0x0);
        gbc.writeMem(0x1053, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf8);
        EXPECT(gbc.b(),  0x65);
        EXPECT(gbc.c(),  0xef);
        EXPECT(gbc.d(),  0x7c);
        EXPECT(gbc.e(),  0x73);
        EXPECT(gbc.h(),  0xf9);
        EXPECT(gbc.l(),  0x20);
        EXPECT(gbc.sp(), 0x6e7f);
        EXPECT(gbc.pc(), 0x1054);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0346
        gbc.setState(0xfed, 0xa7f6, 0xce40, 0x6a0b, 0xf1dc, 0x421b, 0x0, 0x0);
        gbc.writeMem(0xfed, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x42);
        EXPECT(gbc.b(),  0x6a);
        EXPECT(gbc.c(),  0xb);
        EXPECT(gbc.d(),  0xf1);
        EXPECT(gbc.e(),  0xdc);
        EXPECT(gbc.h(),  0x42);
        EXPECT(gbc.l(),  0x1b);
        EXPECT(gbc.sp(), 0xa7f6);
        EXPECT(gbc.pc(), 0xfee);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0347
        gbc.setState(0xdf2b, 0x6b8c, 0xa280, 0x9e7a, 0x3fa7, 0x5cd0, 0x0, 0x1);
        gbc.writeMem(0xdf2b, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x9e);
        EXPECT(gbc.c(),  0x7a);
        EXPECT(gbc.d(),  0x3f);
        EXPECT(gbc.e(),  0xa7);
        EXPECT(gbc.h(),  0x5c);
        EXPECT(gbc.l(),  0xd0);
        EXPECT(gbc.sp(), 0x6b8c);
        EXPECT(gbc.pc(), 0xdf2c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdf2b), 0xa4);
        // A4 0348
        gbc.setState(0x217a, 0x7a24, 0xbf70, 0x2f35, 0x1f0d, 0xcfc3, 0x0, 0x0);
        gbc.writeMem(0x217a, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8f);
        EXPECT(gbc.b(),  0x2f);
        EXPECT(gbc.c(),  0x35);
        EXPECT(gbc.d(),  0x1f);
        EXPECT(gbc.e(),  0xd);
        EXPECT(gbc.h(),  0xcf);
        EXPECT(gbc.l(),  0xc3);
        EXPECT(gbc.sp(), 0x7a24);
        EXPECT(gbc.pc(), 0x217b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0349
        gbc.setState(0x6339, 0x82fe, 0x62e0, 0x560c, 0x79cc, 0x53b8, 0x0, 0x0);
        gbc.writeMem(0x6339, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x42);
        EXPECT(gbc.b(),  0x56);
        EXPECT(gbc.c(),  0xc);
        EXPECT(gbc.d(),  0x79);
        EXPECT(gbc.e(),  0xcc);
        EXPECT(gbc.h(),  0x53);
        EXPECT(gbc.l(),  0xb8);
        EXPECT(gbc.sp(), 0x82fe);
        EXPECT(gbc.pc(), 0x633a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 034A
        gbc.setState(0xcb49, 0xd06b, 0xd890, 0x6ce, 0xc4b0, 0xce16, 0x1, 0x0);
        gbc.writeMem(0xcb49, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc8);
        EXPECT(gbc.b(),  0x6);
        EXPECT(gbc.c(),  0xce);
        EXPECT(gbc.d(),  0xc4);
        EXPECT(gbc.e(),  0xb0);
        EXPECT(gbc.h(),  0xce);
        EXPECT(gbc.l(),  0x16);
        EXPECT(gbc.sp(), 0xd06b);
        EXPECT(gbc.pc(), 0xcb4a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcb49), 0xa4);
        // A4 034B
        gbc.setState(0xb54d, 0x98de, 0x2380, 0x603c, 0x6daa, 0x9dfa, 0x1, 0x1);
        gbc.writeMem(0xb54d, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0x60);
        EXPECT(gbc.c(),  0x3c);
        EXPECT(gbc.d(),  0x6d);
        EXPECT(gbc.e(),  0xaa);
        EXPECT(gbc.h(),  0x9d);
        EXPECT(gbc.l(),  0xfa);
        EXPECT(gbc.sp(), 0x98de);
        EXPECT(gbc.pc(), 0xb54e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb54d), 0xa4);
        // A4 034C
        gbc.setState(0x3f8b, 0x6d0c, 0xc220, 0xf6e, 0xbd0b, 0xae91, 0x0, 0x1);
        gbc.writeMem(0x3f8b, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x82);
        EXPECT(gbc.b(),  0xf);
        EXPECT(gbc.c(),  0x6e);
        EXPECT(gbc.d(),  0xbd);
        EXPECT(gbc.e(),  0xb);
        EXPECT(gbc.h(),  0xae);
        EXPECT(gbc.l(),  0x91);
        EXPECT(gbc.sp(), 0x6d0c);
        EXPECT(gbc.pc(), 0x3f8c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 034D
        gbc.setState(0x535b, 0x2610, 0xf610, 0x33e6, 0x507a, 0xbb27, 0x0, 0x0);
        gbc.writeMem(0x535b, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb2);
        EXPECT(gbc.b(),  0x33);
        EXPECT(gbc.c(),  0xe6);
        EXPECT(gbc.d(),  0x50);
        EXPECT(gbc.e(),  0x7a);
        EXPECT(gbc.h(),  0xbb);
        EXPECT(gbc.l(),  0x27);
        EXPECT(gbc.sp(), 0x2610);
        EXPECT(gbc.pc(), 0x535c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 034E
        gbc.setState(0xe418, 0x9c14, 0x40a0, 0xa57b, 0xcafe, 0xf0be, 0x0, 0x0);
        gbc.writeMem(0xe418, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0xa5);
        EXPECT(gbc.c(),  0x7b);
        EXPECT(gbc.d(),  0xca);
        EXPECT(gbc.e(),  0xfe);
        EXPECT(gbc.h(),  0xf0);
        EXPECT(gbc.l(),  0xbe);
        EXPECT(gbc.sp(), 0x9c14);
        EXPECT(gbc.pc(), 0xe419);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe418), 0xa4);
        // A4 034F
        gbc.setState(0xbd37, 0xe017, 0x7850, 0x992d, 0x5af4, 0xb05c, 0x0, 0x0);
        gbc.writeMem(0xbd37, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x30);
        EXPECT(gbc.b(),  0x99);
        EXPECT(gbc.c(),  0x2d);
        EXPECT(gbc.d(),  0x5a);
        EXPECT(gbc.e(),  0xf4);
        EXPECT(gbc.h(),  0xb0);
        EXPECT(gbc.l(),  0x5c);
        EXPECT(gbc.sp(), 0xe017);
        EXPECT(gbc.pc(), 0xbd38);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbd37), 0xa4);
        // A4 0350
        gbc.setState(0x16b5, 0x9f9, 0xc100, 0xffa6, 0x80f5, 0x9d9a, 0x0, 0x1);
        gbc.writeMem(0x16b5, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x81);
        EXPECT(gbc.b(),  0xff);
        EXPECT(gbc.c(),  0xa6);
        EXPECT(gbc.d(),  0x80);
        EXPECT(gbc.e(),  0xf5);
        EXPECT(gbc.h(),  0x9d);
        EXPECT(gbc.l(),  0x9a);
        EXPECT(gbc.sp(), 0x9f9);
        EXPECT(gbc.pc(), 0x16b6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0351
        gbc.setState(0xe110, 0x900a, 0xc1f0, 0x1dc0, 0xebd6, 0x9e5b, 0x1, 0x0);
        gbc.writeMem(0xe110, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0x1d);
        EXPECT(gbc.c(),  0xc0);
        EXPECT(gbc.d(),  0xeb);
        EXPECT(gbc.e(),  0xd6);
        EXPECT(gbc.h(),  0x9e);
        EXPECT(gbc.l(),  0x5b);
        EXPECT(gbc.sp(), 0x900a);
        EXPECT(gbc.pc(), 0xe111);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe110), 0xa4);
        // A4 0352
        gbc.setState(0x199e, 0xf3a5, 0xfad0, 0xc721, 0xf7ed, 0x1855, 0x0, 0x0);
        gbc.writeMem(0x199e, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x18);
        EXPECT(gbc.b(),  0xc7);
        EXPECT(gbc.c(),  0x21);
        EXPECT(gbc.d(),  0xf7);
        EXPECT(gbc.e(),  0xed);
        EXPECT(gbc.h(),  0x18);
        EXPECT(gbc.l(),  0x55);
        EXPECT(gbc.sp(), 0xf3a5);
        EXPECT(gbc.pc(), 0x199f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0353
        gbc.setState(0x9a8d, 0xd514, 0x5f30, 0x1db6, 0x79cd, 0x11df, 0x0, 0x0);
        gbc.writeMem(0x9a8d, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x11);
        EXPECT(gbc.b(),  0x1d);
        EXPECT(gbc.c(),  0xb6);
        EXPECT(gbc.d(),  0x79);
        EXPECT(gbc.e(),  0xcd);
        EXPECT(gbc.h(),  0x11);
        EXPECT(gbc.l(),  0xdf);
        EXPECT(gbc.sp(), 0xd514);
        EXPECT(gbc.pc(), 0x9a8e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9a8d), 0xa4);
        // A4 0355
        gbc.setState(0x4f5d, 0xeff8, 0x47d0, 0x796, 0x8f72, 0x8e07, 0x0, 0x0);
        gbc.writeMem(0x4f5d, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x6);
        EXPECT(gbc.b(),  0x7);
        EXPECT(gbc.c(),  0x96);
        EXPECT(gbc.d(),  0x8f);
        EXPECT(gbc.e(),  0x72);
        EXPECT(gbc.h(),  0x8e);
        EXPECT(gbc.l(),  0x7);
        EXPECT(gbc.sp(), 0xeff8);
        EXPECT(gbc.pc(), 0x4f5e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0356
        gbc.setState(0x195a, 0xb0ca, 0x7490, 0x293e, 0x1627, 0xfea0, 0x0, 0x1);
        gbc.writeMem(0x195a, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x74);
        EXPECT(gbc.b(),  0x29);
        EXPECT(gbc.c(),  0x3e);
        EXPECT(gbc.d(),  0x16);
        EXPECT(gbc.e(),  0x27);
        EXPECT(gbc.h(),  0xfe);
        EXPECT(gbc.l(),  0xa0);
        EXPECT(gbc.sp(), 0xb0ca);
        EXPECT(gbc.pc(), 0x195b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0357
        gbc.setState(0xd015, 0x7595, 0x17e0, 0xc337, 0x484b, 0xc8f, 0x0, 0x1);
        gbc.writeMem(0xd015, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0xc3);
        EXPECT(gbc.c(),  0x37);
        EXPECT(gbc.d(),  0x48);
        EXPECT(gbc.e(),  0x4b);
        EXPECT(gbc.h(),  0xc);
        EXPECT(gbc.l(),  0x8f);
        EXPECT(gbc.sp(), 0x7595);
        EXPECT(gbc.pc(), 0xd016);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd015), 0xa4);
        // A4 0358
        gbc.setState(0x9408, 0xf927, 0xba10, 0x236d, 0x2e13, 0x6249, 0x1, 0x1);
        gbc.writeMem(0x9408, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x22);
        EXPECT(gbc.b(),  0x23);
        EXPECT(gbc.c(),  0x6d);
        EXPECT(gbc.d(),  0x2e);
        EXPECT(gbc.e(),  0x13);
        EXPECT(gbc.h(),  0x62);
        EXPECT(gbc.l(),  0x49);
        EXPECT(gbc.sp(), 0xf927);
        EXPECT(gbc.pc(), 0x9409);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9408), 0xa4);
        // A4 0359
        gbc.setState(0x8d1e, 0x5269, 0x25d0, 0xc8e0, 0xb12b, 0x912, 0x1, 0x1);
        gbc.writeMem(0x8d1e, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0xc8);
        EXPECT(gbc.c(),  0xe0);
        EXPECT(gbc.d(),  0xb1);
        EXPECT(gbc.e(),  0x2b);
        EXPECT(gbc.h(),  0x9);
        EXPECT(gbc.l(),  0x12);
        EXPECT(gbc.sp(), 0x5269);
        EXPECT(gbc.pc(), 0x8d1f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8d1e), 0xa4);
        // A4 035A
        gbc.setState(0x828c, 0x105e, 0xf0, 0xd5aa, 0xb040, 0xa4e4, 0x1, 0x1);
        gbc.writeMem(0x828c, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0xd5);
        EXPECT(gbc.c(),  0xaa);
        EXPECT(gbc.d(),  0xb0);
        EXPECT(gbc.e(),  0x40);
        EXPECT(gbc.h(),  0xa4);
        EXPECT(gbc.l(),  0xe4);
        EXPECT(gbc.sp(), 0x105e);
        EXPECT(gbc.pc(), 0x828d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x828c), 0xa4);
        // A4 035B
        gbc.setState(0xcc35, 0x261b, 0xc630, 0x33f4, 0x94b8, 0x6fcc, 0x0, 0x1);
        gbc.writeMem(0xcc35, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x46);
        EXPECT(gbc.b(),  0x33);
        EXPECT(gbc.c(),  0xf4);
        EXPECT(gbc.d(),  0x94);
        EXPECT(gbc.e(),  0xb8);
        EXPECT(gbc.h(),  0x6f);
        EXPECT(gbc.l(),  0xcc);
        EXPECT(gbc.sp(), 0x261b);
        EXPECT(gbc.pc(), 0xcc36);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcc35), 0xa4);
        // A4 035C
        gbc.setState(0x63dd, 0x8063, 0x4160, 0x97d5, 0x4be5, 0xcc00, 0x0, 0x1);
        gbc.writeMem(0x63dd, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0x97);
        EXPECT(gbc.c(),  0xd5);
        EXPECT(gbc.d(),  0x4b);
        EXPECT(gbc.e(),  0xe5);
        EXPECT(gbc.h(),  0xcc);
        EXPECT(gbc.l(),  0x0);
        EXPECT(gbc.sp(), 0x8063);
        EXPECT(gbc.pc(), 0x63de);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 035D
        gbc.setState(0xa86e, 0x7a7d, 0xcd10, 0x8566, 0xc3cd, 0xbef7, 0x0, 0x0);
        gbc.writeMem(0xa86e, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8c);
        EXPECT(gbc.b(),  0x85);
        EXPECT(gbc.c(),  0x66);
        EXPECT(gbc.d(),  0xc3);
        EXPECT(gbc.e(),  0xcd);
        EXPECT(gbc.h(),  0xbe);
        EXPECT(gbc.l(),  0xf7);
        EXPECT(gbc.sp(), 0x7a7d);
        EXPECT(gbc.pc(), 0xa86f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa86e), 0xa4);
        // A4 035E
        gbc.setState(0xbe2b, 0x65f1, 0x48d0, 0xb26b, 0x895b, 0xc416, 0x1, 0x1);
        gbc.writeMem(0xbe2b, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0xb2);
        EXPECT(gbc.c(),  0x6b);
        EXPECT(gbc.d(),  0x89);
        EXPECT(gbc.e(),  0x5b);
        EXPECT(gbc.h(),  0xc4);
        EXPECT(gbc.l(),  0x16);
        EXPECT(gbc.sp(), 0x65f1);
        EXPECT(gbc.pc(), 0xbe2c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbe2b), 0xa4);
        // A4 035F
        gbc.setState(0x32dc, 0xc880, 0x3310, 0xc160, 0xa551, 0xd526, 0x1, 0x1);
        gbc.writeMem(0x32dc, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x11);
        EXPECT(gbc.b(),  0xc1);
        EXPECT(gbc.c(),  0x60);
        EXPECT(gbc.d(),  0xa5);
        EXPECT(gbc.e(),  0x51);
        EXPECT(gbc.h(),  0xd5);
        EXPECT(gbc.l(),  0x26);
        EXPECT(gbc.sp(), 0xc880);
        EXPECT(gbc.pc(), 0x32dd);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0360
        gbc.setState(0x531, 0x8ff5, 0x7e50, 0x883d, 0x1c8e, 0xc2c3, 0x0, 0x1);
        gbc.writeMem(0x531, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x42);
        EXPECT(gbc.b(),  0x88);
        EXPECT(gbc.c(),  0x3d);
        EXPECT(gbc.d(),  0x1c);
        EXPECT(gbc.e(),  0x8e);
        EXPECT(gbc.h(),  0xc2);
        EXPECT(gbc.l(),  0xc3);
        EXPECT(gbc.sp(), 0x8ff5);
        EXPECT(gbc.pc(), 0x532);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0361
        gbc.setState(0x723c, 0xc9fc, 0x5310, 0x6cbb, 0x4dbd, 0xdd40, 0x1, 0x0);
        gbc.writeMem(0x723c, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x51);
        EXPECT(gbc.b(),  0x6c);
        EXPECT(gbc.c(),  0xbb);
        EXPECT(gbc.d(),  0x4d);
        EXPECT(gbc.e(),  0xbd);
        EXPECT(gbc.h(),  0xdd);
        EXPECT(gbc.l(),  0x40);
        EXPECT(gbc.sp(), 0xc9fc);
        EXPECT(gbc.pc(), 0x723d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0362
        gbc.setState(0xad40, 0x7e5, 0x9120, 0x6a5b, 0xe1e2, 0x938e, 0x0, 0x0);
        gbc.writeMem(0xad40, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x91);
        EXPECT(gbc.b(),  0x6a);
        EXPECT(gbc.c(),  0x5b);
        EXPECT(gbc.d(),  0xe1);
        EXPECT(gbc.e(),  0xe2);
        EXPECT(gbc.h(),  0x93);
        EXPECT(gbc.l(),  0x8e);
        EXPECT(gbc.sp(), 0x7e5);
        EXPECT(gbc.pc(), 0xad41);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xad40), 0xa4);
        // A4 0363
        gbc.setState(0x7413, 0x6c06, 0x8350, 0x5034, 0x5bd5, 0x2ed7, 0x0, 0x0);
        gbc.writeMem(0x7413, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0x50);
        EXPECT(gbc.c(),  0x34);
        EXPECT(gbc.d(),  0x5b);
        EXPECT(gbc.e(),  0xd5);
        EXPECT(gbc.h(),  0x2e);
        EXPECT(gbc.l(),  0xd7);
        EXPECT(gbc.sp(), 0x6c06);
        EXPECT(gbc.pc(), 0x7414);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0364
        gbc.setState(0x715a, 0x60d3, 0xa9a0, 0x95d0, 0x2665, 0xd155, 0x0, 0x1);
        gbc.writeMem(0x715a, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x81);
        EXPECT(gbc.b(),  0x95);
        EXPECT(gbc.c(),  0xd0);
        EXPECT(gbc.d(),  0x26);
        EXPECT(gbc.e(),  0x65);
        EXPECT(gbc.h(),  0xd1);
        EXPECT(gbc.l(),  0x55);
        EXPECT(gbc.sp(), 0x60d3);
        EXPECT(gbc.pc(), 0x715b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0365
        gbc.setState(0xef96, 0x38b4, 0xd950, 0x1f4f, 0x2ddd, 0x7bec, 0x0, 0x1);
        gbc.writeMem(0xef96, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x59);
        EXPECT(gbc.b(),  0x1f);
        EXPECT(gbc.c(),  0x4f);
        EXPECT(gbc.d(),  0x2d);
        EXPECT(gbc.e(),  0xdd);
        EXPECT(gbc.h(),  0x7b);
        EXPECT(gbc.l(),  0xec);
        EXPECT(gbc.sp(), 0x38b4);
        EXPECT(gbc.pc(), 0xef97);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xef96), 0xa4);
        // A4 0366
        gbc.setState(0x971c, 0xc190, 0x65f0, 0x8b2f, 0x7eb8, 0xaa7d, 0x1, 0x0);
        gbc.writeMem(0x971c, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0x8b);
        EXPECT(gbc.c(),  0x2f);
        EXPECT(gbc.d(),  0x7e);
        EXPECT(gbc.e(),  0xb8);
        EXPECT(gbc.h(),  0xaa);
        EXPECT(gbc.l(),  0x7d);
        EXPECT(gbc.sp(), 0xc190);
        EXPECT(gbc.pc(), 0x971d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x971c), 0xa4);
        // A4 0367
        gbc.setState(0xb5b2, 0xc049, 0xc200, 0xd559, 0x9da7, 0x5664, 0x0, 0x1);
        gbc.writeMem(0xb5b2, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x42);
        EXPECT(gbc.b(),  0xd5);
        EXPECT(gbc.c(),  0x59);
        EXPECT(gbc.d(),  0x9d);
        EXPECT(gbc.e(),  0xa7);
        EXPECT(gbc.h(),  0x56);
        EXPECT(gbc.l(),  0x64);
        EXPECT(gbc.sp(), 0xc049);
        EXPECT(gbc.pc(), 0xb5b3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb5b2), 0xa4);
        // A4 0368
        gbc.setState(0xceae, 0xa4a9, 0xc9f0, 0xdcaf, 0xf931, 0xc7fe, 0x0, 0x0);
        gbc.writeMem(0xceae, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc1);
        EXPECT(gbc.b(),  0xdc);
        EXPECT(gbc.c(),  0xaf);
        EXPECT(gbc.d(),  0xf9);
        EXPECT(gbc.e(),  0x31);
        EXPECT(gbc.h(),  0xc7);
        EXPECT(gbc.l(),  0xfe);
        EXPECT(gbc.sp(), 0xa4a9);
        EXPECT(gbc.pc(), 0xceaf);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xceae), 0xa4);
        // A4 0369
        gbc.setState(0xd1ad, 0x41e8, 0x3ad0, 0xcab6, 0x600, 0xf7c8, 0x0, 0x0);
        gbc.writeMem(0xd1ad, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x32);
        EXPECT(gbc.b(),  0xca);
        EXPECT(gbc.c(),  0xb6);
        EXPECT(gbc.d(),  0x6);
        EXPECT(gbc.e(),  0x0);
        EXPECT(gbc.h(),  0xf7);
        EXPECT(gbc.l(),  0xc8);
        EXPECT(gbc.sp(), 0x41e8);
        EXPECT(gbc.pc(), 0xd1ae);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd1ad), 0xa4);
        // A4 036A
        gbc.setState(0x8d5c, 0x5b8d, 0xbd10, 0xed6d, 0xeb7, 0x6a3, 0x1, 0x0);
        gbc.writeMem(0x8d5c, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0xed);
        EXPECT(gbc.c(),  0x6d);
        EXPECT(gbc.d(),  0xe);
        EXPECT(gbc.e(),  0xb7);
        EXPECT(gbc.h(),  0x6);
        EXPECT(gbc.l(),  0xa3);
        EXPECT(gbc.sp(), 0x5b8d);
        EXPECT(gbc.pc(), 0x8d5d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8d5c), 0xa4);
        // A4 036B
        gbc.setState(0x80d5, 0x6831, 0x6440, 0x36d, 0x4fe6, 0x329b, 0x1, 0x0);
        gbc.writeMem(0x80d5, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0x3);
        EXPECT(gbc.c(),  0x6d);
        EXPECT(gbc.d(),  0x4f);
        EXPECT(gbc.e(),  0xe6);
        EXPECT(gbc.h(),  0x32);
        EXPECT(gbc.l(),  0x9b);
        EXPECT(gbc.sp(), 0x6831);
        EXPECT(gbc.pc(), 0x80d6);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x80d5), 0xa4);
        // A4 036C
        gbc.setState(0x98c0, 0xfb2a, 0xdb70, 0xebd5, 0x2a82, 0x88c9, 0x1, 0x1);
        gbc.writeMem(0x98c0, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x88);
        EXPECT(gbc.b(),  0xeb);
        EXPECT(gbc.c(),  0xd5);
        EXPECT(gbc.d(),  0x2a);
        EXPECT(gbc.e(),  0x82);
        EXPECT(gbc.h(),  0x88);
        EXPECT(gbc.l(),  0xc9);
        EXPECT(gbc.sp(), 0xfb2a);
        EXPECT(gbc.pc(), 0x98c1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x98c0), 0xa4);
        // A4 036D
        gbc.setState(0xb9e5, 0x34eb, 0x6e70, 0x81c6, 0xfa44, 0x628d, 0x0, 0x0);
        gbc.writeMem(0xb9e5, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x62);
        EXPECT(gbc.b(),  0x81);
        EXPECT(gbc.c(),  0xc6);
        EXPECT(gbc.d(),  0xfa);
        EXPECT(gbc.e(),  0x44);
        EXPECT(gbc.h(),  0x62);
        EXPECT(gbc.l(),  0x8d);
        EXPECT(gbc.sp(), 0x34eb);
        EXPECT(gbc.pc(), 0xb9e6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb9e5), 0xa4);
        // A4 036E
        gbc.setState(0xd5a1, 0xf73d, 0xec10, 0x15c, 0x781f, 0x4b76, 0x0, 0x0);
        gbc.writeMem(0xd5a1, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x48);
        EXPECT(gbc.b(),  0x1);
        EXPECT(gbc.c(),  0x5c);
        EXPECT(gbc.d(),  0x78);
        EXPECT(gbc.e(),  0x1f);
        EXPECT(gbc.h(),  0x4b);
        EXPECT(gbc.l(),  0x76);
        EXPECT(gbc.sp(), 0xf73d);
        EXPECT(gbc.pc(), 0xd5a2);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd5a1), 0xa4);
        // A4 036F
        gbc.setState(0x6ca, 0xe62f, 0xdec0, 0x5f97, 0x4b13, 0xfc73, 0x1, 0x1);
        gbc.writeMem(0x6ca, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xdc);
        EXPECT(gbc.b(),  0x5f);
        EXPECT(gbc.c(),  0x97);
        EXPECT(gbc.d(),  0x4b);
        EXPECT(gbc.e(),  0x13);
        EXPECT(gbc.h(),  0xfc);
        EXPECT(gbc.l(),  0x73);
        EXPECT(gbc.sp(), 0xe62f);
        EXPECT(gbc.pc(), 0x6cb);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0370
        gbc.setState(0x9bcb, 0x5930, 0x8570, 0xb75d, 0x1bf, 0x9ee2, 0x0, 0x0);
        gbc.writeMem(0x9bcb, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x84);
        EXPECT(gbc.b(),  0xb7);
        EXPECT(gbc.c(),  0x5d);
        EXPECT(gbc.d(),  0x1);
        EXPECT(gbc.e(),  0xbf);
        EXPECT(gbc.h(),  0x9e);
        EXPECT(gbc.l(),  0xe2);
        EXPECT(gbc.sp(), 0x5930);
        EXPECT(gbc.pc(), 0x9bcc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9bcb), 0xa4);
        // A4 0371
        gbc.setState(0xeb86, 0xf089, 0xbc80, 0xa3fe, 0xac09, 0x576d, 0x1, 0x0);
        gbc.writeMem(0xeb86, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x14);
        EXPECT(gbc.b(),  0xa3);
        EXPECT(gbc.c(),  0xfe);
        EXPECT(gbc.d(),  0xac);
        EXPECT(gbc.e(),  0x9);
        EXPECT(gbc.h(),  0x57);
        EXPECT(gbc.l(),  0x6d);
        EXPECT(gbc.sp(), 0xf089);
        EXPECT(gbc.pc(), 0xeb87);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xeb86), 0xa4);
        // A4 0372
        gbc.setState(0xcaa8, 0x23a9, 0x9500, 0x800a, 0x9d5e, 0x6d58, 0x0, 0x1);
        gbc.writeMem(0xcaa8, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x5);
        EXPECT(gbc.b(),  0x80);
        EXPECT(gbc.c(),  0xa);
        EXPECT(gbc.d(),  0x9d);
        EXPECT(gbc.e(),  0x5e);
        EXPECT(gbc.h(),  0x6d);
        EXPECT(gbc.l(),  0x58);
        EXPECT(gbc.sp(), 0x23a9);
        EXPECT(gbc.pc(), 0xcaa9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcaa8), 0xa4);
        // A4 0373
        gbc.setState(0x5ac7, 0x5a3e, 0x6e0, 0x490a, 0x9884, 0xe62a, 0x0, 0x1);
        gbc.writeMem(0x5ac7, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x6);
        EXPECT(gbc.b(),  0x49);
        EXPECT(gbc.c(),  0xa);
        EXPECT(gbc.d(),  0x98);
        EXPECT(gbc.e(),  0x84);
        EXPECT(gbc.h(),  0xe6);
        EXPECT(gbc.l(),  0x2a);
        EXPECT(gbc.sp(), 0x5a3e);
        EXPECT(gbc.pc(), 0x5ac8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0374
        gbc.setState(0xe043, 0x6fbf, 0x2100, 0xa198, 0xa012, 0xcff0, 0x1, 0x0);
        gbc.writeMem(0xe043, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0xa1);
        EXPECT(gbc.c(),  0x98);
        EXPECT(gbc.d(),  0xa0);
        EXPECT(gbc.e(),  0x12);
        EXPECT(gbc.h(),  0xcf);
        EXPECT(gbc.l(),  0xf0);
        EXPECT(gbc.sp(), 0x6fbf);
        EXPECT(gbc.pc(), 0xe044);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe043), 0xa4);
        // A4 0375
        gbc.setState(0x1c2, 0x8515, 0xbfc0, 0x2235, 0x83e4, 0x4448, 0x1, 0x1);
        gbc.writeMem(0x1c2, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0x22);
        EXPECT(gbc.c(),  0x35);
        EXPECT(gbc.d(),  0x83);
        EXPECT(gbc.e(),  0xe4);
        EXPECT(gbc.h(),  0x44);
        EXPECT(gbc.l(),  0x48);
        EXPECT(gbc.sp(), 0x8515);
        EXPECT(gbc.pc(), 0x1c3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0376
        gbc.setState(0x628c, 0xee71, 0xf100, 0xf1bd, 0x307f, 0xe27c, 0x0, 0x0);
        gbc.writeMem(0x628c, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe0);
        EXPECT(gbc.b(),  0xf1);
        EXPECT(gbc.c(),  0xbd);
        EXPECT(gbc.d(),  0x30);
        EXPECT(gbc.e(),  0x7f);
        EXPECT(gbc.h(),  0xe2);
        EXPECT(gbc.l(),  0x7c);
        EXPECT(gbc.sp(), 0xee71);
        EXPECT(gbc.pc(), 0x628d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0377
        gbc.setState(0xebb7, 0x1bb6, 0xefc0, 0x4558, 0x7a52, 0x49fc, 0x1, 0x0);
        gbc.writeMem(0xebb7, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x49);
        EXPECT(gbc.b(),  0x45);
        EXPECT(gbc.c(),  0x58);
        EXPECT(gbc.d(),  0x7a);
        EXPECT(gbc.e(),  0x52);
        EXPECT(gbc.h(),  0x49);
        EXPECT(gbc.l(),  0xfc);
        EXPECT(gbc.sp(), 0x1bb6);
        EXPECT(gbc.pc(), 0xebb8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xebb7), 0xa4);
        // A4 0378
        gbc.setState(0x9afb, 0x4fa2, 0xf050, 0x120d, 0x9b8d, 0x2262, 0x1, 0x0);
        gbc.writeMem(0x9afb, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0x12);
        EXPECT(gbc.c(),  0xd);
        EXPECT(gbc.d(),  0x9b);
        EXPECT(gbc.e(),  0x8d);
        EXPECT(gbc.h(),  0x22);
        EXPECT(gbc.l(),  0x62);
        EXPECT(gbc.sp(), 0x4fa2);
        EXPECT(gbc.pc(), 0x9afc);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9afb), 0xa4);
        // A4 0379
        gbc.setState(0x4799, 0x2359, 0x9730, 0x8aa9, 0xa88, 0xa092, 0x1, 0x1);
        gbc.writeMem(0x4799, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0x8a);
        EXPECT(gbc.c(),  0xa9);
        EXPECT(gbc.d(),  0xa);
        EXPECT(gbc.e(),  0x88);
        EXPECT(gbc.h(),  0xa0);
        EXPECT(gbc.l(),  0x92);
        EXPECT(gbc.sp(), 0x2359);
        EXPECT(gbc.pc(), 0x479a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 037A
        gbc.setState(0x38d3, 0xb246, 0x4e00, 0x23b, 0x55e6, 0xace2, 0x1, 0x0);
        gbc.writeMem(0x38d3, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc);
        EXPECT(gbc.b(),  0x2);
        EXPECT(gbc.c(),  0x3b);
        EXPECT(gbc.d(),  0x55);
        EXPECT(gbc.e(),  0xe6);
        EXPECT(gbc.h(),  0xac);
        EXPECT(gbc.l(),  0xe2);
        EXPECT(gbc.sp(), 0xb246);
        EXPECT(gbc.pc(), 0x38d4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 037B
        gbc.setState(0x1284, 0xf17d, 0xd950, 0x95a1, 0xa11d, 0xdbb2, 0x1, 0x0);
        gbc.writeMem(0x1284, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd9);
        EXPECT(gbc.b(),  0x95);
        EXPECT(gbc.c(),  0xa1);
        EXPECT(gbc.d(),  0xa1);
        EXPECT(gbc.e(),  0x1d);
        EXPECT(gbc.h(),  0xdb);
        EXPECT(gbc.l(),  0xb2);
        EXPECT(gbc.sp(), 0xf17d);
        EXPECT(gbc.pc(), 0x1285);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 037C
        gbc.setState(0x6398, 0x6fcb, 0x4970, 0x39b9, 0x65b2, 0x9887, 0x0, 0x1);
        gbc.writeMem(0x6398, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0x39);
        EXPECT(gbc.c(),  0xb9);
        EXPECT(gbc.d(),  0x65);
        EXPECT(gbc.e(),  0xb2);
        EXPECT(gbc.h(),  0x98);
        EXPECT(gbc.l(),  0x87);
        EXPECT(gbc.sp(), 0x6fcb);
        EXPECT(gbc.pc(), 0x6399);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 037D
        gbc.setState(0x61bd, 0x3afa, 0x53d0, 0xbd97, 0xf0c3, 0xcb1f, 0x1, 0x1);
        gbc.writeMem(0x61bd, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x43);
        EXPECT(gbc.b(),  0xbd);
        EXPECT(gbc.c(),  0x97);
        EXPECT(gbc.d(),  0xf0);
        EXPECT(gbc.e(),  0xc3);
        EXPECT(gbc.h(),  0xcb);
        EXPECT(gbc.l(),  0x1f);
        EXPECT(gbc.sp(), 0x3afa);
        EXPECT(gbc.pc(), 0x61be);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 037E
        gbc.setState(0x8484, 0xfd50, 0x62a0, 0xf4c0, 0xe8f0, 0xf883, 0x1, 0x1);
        gbc.writeMem(0x8484, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x60);
        EXPECT(gbc.b(),  0xf4);
        EXPECT(gbc.c(),  0xc0);
        EXPECT(gbc.d(),  0xe8);
        EXPECT(gbc.e(),  0xf0);
        EXPECT(gbc.h(),  0xf8);
        EXPECT(gbc.l(),  0x83);
        EXPECT(gbc.sp(), 0xfd50);
        EXPECT(gbc.pc(), 0x8485);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8484), 0xa4);
        // A4 037F
        gbc.setState(0x1b40, 0x1e11, 0xedd0, 0x710b, 0x7003, 0x9bdd, 0x0, 0x0);
        gbc.writeMem(0x1b40, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x89);
        EXPECT(gbc.b(),  0x71);
        EXPECT(gbc.c(),  0xb);
        EXPECT(gbc.d(),  0x70);
        EXPECT(gbc.e(),  0x3);
        EXPECT(gbc.h(),  0x9b);
        EXPECT(gbc.l(),  0xdd);
        EXPECT(gbc.sp(), 0x1e11);
        EXPECT(gbc.pc(), 0x1b41);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0380
        gbc.setState(0x685a, 0x51a6, 0x1a20, 0xd4cc, 0xaab, 0x5d1c, 0x1, 0x1);
        gbc.writeMem(0x685a, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x18);
        EXPECT(gbc.b(),  0xd4);
        EXPECT(gbc.c(),  0xcc);
        EXPECT(gbc.d(),  0xa);
        EXPECT(gbc.e(),  0xab);
        EXPECT(gbc.h(),  0x5d);
        EXPECT(gbc.l(),  0x1c);
        EXPECT(gbc.sp(), 0x51a6);
        EXPECT(gbc.pc(), 0x685b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0381
        gbc.setState(0xa46f, 0x7fa1, 0x24b0, 0x8154, 0x5e5b, 0xc292, 0x1, 0x0);
        gbc.writeMem(0xa46f, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x81);
        EXPECT(gbc.c(),  0x54);
        EXPECT(gbc.d(),  0x5e);
        EXPECT(gbc.e(),  0x5b);
        EXPECT(gbc.h(),  0xc2);
        EXPECT(gbc.l(),  0x92);
        EXPECT(gbc.sp(), 0x7fa1);
        EXPECT(gbc.pc(), 0xa470);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa46f), 0xa4);
        // A4 0382
        gbc.setState(0xbb34, 0xef5f, 0xef90, 0xb38b, 0xd3, 0x86e7, 0x0, 0x1);
        gbc.writeMem(0xbb34, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x86);
        EXPECT(gbc.b(),  0xb3);
        EXPECT(gbc.c(),  0x8b);
        EXPECT(gbc.d(),  0x0);
        EXPECT(gbc.e(),  0xd3);
        EXPECT(gbc.h(),  0x86);
        EXPECT(gbc.l(),  0xe7);
        EXPECT(gbc.sp(), 0xef5f);
        EXPECT(gbc.pc(), 0xbb35);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbb34), 0xa4);
        // A4 0383
        gbc.setState(0x3919, 0xa075, 0xc360, 0x4d05, 0xc9cf, 0x6d81, 0x1, 0x0);
        gbc.writeMem(0x3919, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x41);
        EXPECT(gbc.b(),  0x4d);
        EXPECT(gbc.c(),  0x5);
        EXPECT(gbc.d(),  0xc9);
        EXPECT(gbc.e(),  0xcf);
        EXPECT(gbc.h(),  0x6d);
        EXPECT(gbc.l(),  0x81);
        EXPECT(gbc.sp(), 0xa075);
        EXPECT(gbc.pc(), 0x391a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0384
        gbc.setState(0xa208, 0x9c62, 0x5340, 0x246e, 0x58fa, 0x53b0, 0x0, 0x0);
        gbc.writeMem(0xa208, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x53);
        EXPECT(gbc.b(),  0x24);
        EXPECT(gbc.c(),  0x6e);
        EXPECT(gbc.d(),  0x58);
        EXPECT(gbc.e(),  0xfa);
        EXPECT(gbc.h(),  0x53);
        EXPECT(gbc.l(),  0xb0);
        EXPECT(gbc.sp(), 0x9c62);
        EXPECT(gbc.pc(), 0xa209);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa208), 0xa4);
        // A4 0385
        gbc.setState(0x4c29, 0x7486, 0x5480, 0x2106, 0xe8a6, 0xb45c, 0x0, 0x1);
        gbc.writeMem(0x4c29, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x14);
        EXPECT(gbc.b(),  0x21);
        EXPECT(gbc.c(),  0x6);
        EXPECT(gbc.d(),  0xe8);
        EXPECT(gbc.e(),  0xa6);
        EXPECT(gbc.h(),  0xb4);
        EXPECT(gbc.l(),  0x5c);
        EXPECT(gbc.sp(), 0x7486);
        EXPECT(gbc.pc(), 0x4c2a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0386
        gbc.setState(0x711f, 0x8281, 0xc030, 0xae7d, 0x34c3, 0xc2e3, 0x1, 0x0);
        gbc.writeMem(0x711f, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc0);
        EXPECT(gbc.b(),  0xae);
        EXPECT(gbc.c(),  0x7d);
        EXPECT(gbc.d(),  0x34);
        EXPECT(gbc.e(),  0xc3);
        EXPECT(gbc.h(),  0xc2);
        EXPECT(gbc.l(),  0xe3);
        EXPECT(gbc.sp(), 0x8281);
        EXPECT(gbc.pc(), 0x7120);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0388
        gbc.setState(0x14ec, 0xe09c, 0xbcf0, 0xffbe, 0x4e6a, 0x45d7, 0x0, 0x0);
        gbc.writeMem(0x14ec, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0xff);
        EXPECT(gbc.c(),  0xbe);
        EXPECT(gbc.d(),  0x4e);
        EXPECT(gbc.e(),  0x6a);
        EXPECT(gbc.h(),  0x45);
        EXPECT(gbc.l(),  0xd7);
        EXPECT(gbc.sp(), 0xe09c);
        EXPECT(gbc.pc(), 0x14ed);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0389
        gbc.setState(0xbd8c, 0x401b, 0x9c80, 0xa970, 0x57d7, 0x2124, 0x0, 0x0);
        gbc.writeMem(0xbd8c, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0xa9);
        EXPECT(gbc.c(),  0x70);
        EXPECT(gbc.d(),  0x57);
        EXPECT(gbc.e(),  0xd7);
        EXPECT(gbc.h(),  0x21);
        EXPECT(gbc.l(),  0x24);
        EXPECT(gbc.sp(), 0x401b);
        EXPECT(gbc.pc(), 0xbd8d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbd8c), 0xa4);
        // A4 038A
        gbc.setState(0x2e66, 0xf066, 0xfa50, 0x4989, 0x8c7, 0x77f5, 0x1, 0x0);
        gbc.writeMem(0x2e66, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x72);
        EXPECT(gbc.b(),  0x49);
        EXPECT(gbc.c(),  0x89);
        EXPECT(gbc.d(),  0x8);
        EXPECT(gbc.e(),  0xc7);
        EXPECT(gbc.h(),  0x77);
        EXPECT(gbc.l(),  0xf5);
        EXPECT(gbc.sp(), 0xf066);
        EXPECT(gbc.pc(), 0x2e67);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 038B
        gbc.setState(0xef42, 0x40c7, 0xd1e0, 0xeee7, 0x8480, 0x895, 0x1, 0x1);
        gbc.writeMem(0xef42, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0xee);
        EXPECT(gbc.c(),  0xe7);
        EXPECT(gbc.d(),  0x84);
        EXPECT(gbc.e(),  0x80);
        EXPECT(gbc.h(),  0x8);
        EXPECT(gbc.l(),  0x95);
        EXPECT(gbc.sp(), 0x40c7);
        EXPECT(gbc.pc(), 0xef43);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xef42), 0xa4);
        // A4 038C
        gbc.setState(0x85bd, 0x509c, 0x5d90, 0x3fe6, 0xe81b, 0xb799, 0x0, 0x1);
        gbc.writeMem(0x85bd, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x15);
        EXPECT(gbc.b(),  0x3f);
        EXPECT(gbc.c(),  0xe6);
        EXPECT(gbc.d(),  0xe8);
        EXPECT(gbc.e(),  0x1b);
        EXPECT(gbc.h(),  0xb7);
        EXPECT(gbc.l(),  0x99);
        EXPECT(gbc.sp(), 0x509c);
        EXPECT(gbc.pc(), 0x85be);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x85bd), 0xa4);
        // A4 038D
        gbc.setState(0x52f8, 0x6a79, 0xb300, 0xcd2d, 0x556e, 0x2f2b, 0x1, 0x0);
        gbc.writeMem(0x52f8, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x23);
        EXPECT(gbc.b(),  0xcd);
        EXPECT(gbc.c(),  0x2d);
        EXPECT(gbc.d(),  0x55);
        EXPECT(gbc.e(),  0x6e);
        EXPECT(gbc.h(),  0x2f);
        EXPECT(gbc.l(),  0x2b);
        EXPECT(gbc.sp(), 0x6a79);
        EXPECT(gbc.pc(), 0x52f9);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 038E
        gbc.setState(0x52e2, 0x374b, 0x5030, 0xf611, 0x9939, 0xeb37, 0x1, 0x1);
        gbc.writeMem(0x52e2, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0xf6);
        EXPECT(gbc.c(),  0x11);
        EXPECT(gbc.d(),  0x99);
        EXPECT(gbc.e(),  0x39);
        EXPECT(gbc.h(),  0xeb);
        EXPECT(gbc.l(),  0x37);
        EXPECT(gbc.sp(), 0x374b);
        EXPECT(gbc.pc(), 0x52e3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 038F
        gbc.setState(0xb555, 0x1066, 0x6cc0, 0xfed1, 0xbe9a, 0x1c0b, 0x0, 0x0);
        gbc.writeMem(0xb555, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc);
        EXPECT(gbc.b(),  0xfe);
        EXPECT(gbc.c(),  0xd1);
        EXPECT(gbc.d(),  0xbe);
        EXPECT(gbc.e(),  0x9a);
        EXPECT(gbc.h(),  0x1c);
        EXPECT(gbc.l(),  0xb);
        EXPECT(gbc.sp(), 0x1066);
        EXPECT(gbc.pc(), 0xb556);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb555), 0xa4);
        // A4 0391
        gbc.setState(0x7b9a, 0xfb33, 0xae30, 0x5c97, 0xf647, 0x7051, 0x1, 0x1);
        gbc.writeMem(0x7b9a, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0x5c);
        EXPECT(gbc.c(),  0x97);
        EXPECT(gbc.d(),  0xf6);
        EXPECT(gbc.e(),  0x47);
        EXPECT(gbc.h(),  0x70);
        EXPECT(gbc.l(),  0x51);
        EXPECT(gbc.sp(), 0xfb33);
        EXPECT(gbc.pc(), 0x7b9b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0392
        gbc.setState(0xdd4, 0x514b, 0x4260, 0xcfe8, 0x627e, 0x9a81, 0x1, 0x1);
        gbc.writeMem(0xdd4, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0xcf);
        EXPECT(gbc.c(),  0xe8);
        EXPECT(gbc.d(),  0x62);
        EXPECT(gbc.e(),  0x7e);
        EXPECT(gbc.h(),  0x9a);
        EXPECT(gbc.l(),  0x81);
        EXPECT(gbc.sp(), 0x514b);
        EXPECT(gbc.pc(), 0xdd5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0393
        gbc.setState(0x32a4, 0xaf80, 0x1910, 0x921b, 0x8aa0, 0xaa10, 0x1, 0x0);
        gbc.writeMem(0x32a4, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0x92);
        EXPECT(gbc.c(),  0x1b);
        EXPECT(gbc.d(),  0x8a);
        EXPECT(gbc.e(),  0xa0);
        EXPECT(gbc.h(),  0xaa);
        EXPECT(gbc.l(),  0x10);
        EXPECT(gbc.sp(), 0xaf80);
        EXPECT(gbc.pc(), 0x32a5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0394
        gbc.setState(0xa5f8, 0xba11, 0xa760, 0x9225, 0x395d, 0xebbd, 0x0, 0x0);
        gbc.writeMem(0xa5f8, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa3);
        EXPECT(gbc.b(),  0x92);
        EXPECT(gbc.c(),  0x25);
        EXPECT(gbc.d(),  0x39);
        EXPECT(gbc.e(),  0x5d);
        EXPECT(gbc.h(),  0xeb);
        EXPECT(gbc.l(),  0xbd);
        EXPECT(gbc.sp(), 0xba11);
        EXPECT(gbc.pc(), 0xa5f9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa5f8), 0xa4);
        // A4 0395
        gbc.setState(0x632b, 0xe439, 0x2e30, 0xbd65, 0x8fb2, 0xfb7e, 0x1, 0x1);
        gbc.writeMem(0x632b, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2a);
        EXPECT(gbc.b(),  0xbd);
        EXPECT(gbc.c(),  0x65);
        EXPECT(gbc.d(),  0x8f);
        EXPECT(gbc.e(),  0xb2);
        EXPECT(gbc.h(),  0xfb);
        EXPECT(gbc.l(),  0x7e);
        EXPECT(gbc.sp(), 0xe439);
        EXPECT(gbc.pc(), 0x632c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0396
        gbc.setState(0x34df, 0xf197, 0x1d10, 0xdcd0, 0x2181, 0x8b53, 0x1, 0x1);
        gbc.writeMem(0x34df, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x9);
        EXPECT(gbc.b(),  0xdc);
        EXPECT(gbc.c(),  0xd0);
        EXPECT(gbc.d(),  0x21);
        EXPECT(gbc.e(),  0x81);
        EXPECT(gbc.h(),  0x8b);
        EXPECT(gbc.l(),  0x53);
        EXPECT(gbc.sp(), 0xf197);
        EXPECT(gbc.pc(), 0x34e0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0397
        gbc.setState(0x71d9, 0x59a1, 0xb7a0, 0x847d, 0xc87a, 0x4ce9, 0x1, 0x1);
        gbc.writeMem(0x71d9, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0x84);
        EXPECT(gbc.c(),  0x7d);
        EXPECT(gbc.d(),  0xc8);
        EXPECT(gbc.e(),  0x7a);
        EXPECT(gbc.h(),  0x4c);
        EXPECT(gbc.l(),  0xe9);
        EXPECT(gbc.sp(), 0x59a1);
        EXPECT(gbc.pc(), 0x71da);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0398
        gbc.setState(0x4fb7, 0x3b3f, 0x5950, 0xb6e7, 0xa325, 0xa9e7, 0x1, 0x1);
        gbc.writeMem(0x4fb7, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x9);
        EXPECT(gbc.b(),  0xb6);
        EXPECT(gbc.c(),  0xe7);
        EXPECT(gbc.d(),  0xa3);
        EXPECT(gbc.e(),  0x25);
        EXPECT(gbc.h(),  0xa9);
        EXPECT(gbc.l(),  0xe7);
        EXPECT(gbc.sp(), 0x3b3f);
        EXPECT(gbc.pc(), 0x4fb8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 0399
        gbc.setState(0x410d, 0x3eb4, 0x4d90, 0x5370, 0x7639, 0x1e7, 0x0, 0x0);
        gbc.writeMem(0x410d, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0x53);
        EXPECT(gbc.c(),  0x70);
        EXPECT(gbc.d(),  0x76);
        EXPECT(gbc.e(),  0x39);
        EXPECT(gbc.h(),  0x1);
        EXPECT(gbc.l(),  0xe7);
        EXPECT(gbc.sp(), 0x3eb4);
        EXPECT(gbc.pc(), 0x410e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 039A
        gbc.setState(0x884e, 0x5d1e, 0xabb0, 0x7f7e, 0x1d15, 0xf4bf, 0x1, 0x0);
        gbc.writeMem(0x884e, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa0);
        EXPECT(gbc.b(),  0x7f);
        EXPECT(gbc.c(),  0x7e);
        EXPECT(gbc.d(),  0x1d);
        EXPECT(gbc.e(),  0x15);
        EXPECT(gbc.h(),  0xf4);
        EXPECT(gbc.l(),  0xbf);
        EXPECT(gbc.sp(), 0x5d1e);
        EXPECT(gbc.pc(), 0x884f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x884e), 0xa4);
        // A4 039B
        gbc.setState(0xbc8a, 0xa171, 0xc740, 0x9592, 0xbbd9, 0xf31e, 0x1, 0x0);
        gbc.writeMem(0xbc8a, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc3);
        EXPECT(gbc.b(),  0x95);
        EXPECT(gbc.c(),  0x92);
        EXPECT(gbc.d(),  0xbb);
        EXPECT(gbc.e(),  0xd9);
        EXPECT(gbc.h(),  0xf3);
        EXPECT(gbc.l(),  0x1e);
        EXPECT(gbc.sp(), 0xa171);
        EXPECT(gbc.pc(), 0xbc8b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbc8a), 0xa4);
        // A4 039C
        gbc.setState(0xe27d, 0x413f, 0xba40, 0x2192, 0x2e4d, 0xeb71, 0x0, 0x0);
        gbc.writeMem(0xe27d, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xaa);
        EXPECT(gbc.b(),  0x21);
        EXPECT(gbc.c(),  0x92);
        EXPECT(gbc.d(),  0x2e);
        EXPECT(gbc.e(),  0x4d);
        EXPECT(gbc.h(),  0xeb);
        EXPECT(gbc.l(),  0x71);
        EXPECT(gbc.sp(), 0x413f);
        EXPECT(gbc.pc(), 0xe27e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe27d), 0xa4);
        // A4 039D
        gbc.setState(0xc97, 0xfbaa, 0x7e60, 0x5fcb, 0x9eea, 0x3de4, 0x1, 0x1);
        gbc.writeMem(0xc97, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3c);
        EXPECT(gbc.b(),  0x5f);
        EXPECT(gbc.c(),  0xcb);
        EXPECT(gbc.d(),  0x9e);
        EXPECT(gbc.e(),  0xea);
        EXPECT(gbc.h(),  0x3d);
        EXPECT(gbc.l(),  0xe4);
        EXPECT(gbc.sp(), 0xfbaa);
        EXPECT(gbc.pc(), 0xc98);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 039E
        gbc.setState(0xafa4, 0xb58e, 0x5be0, 0x5835, 0xe06b, 0x6614, 0x0, 0x1);
        gbc.writeMem(0xafa4, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x42);
        EXPECT(gbc.b(),  0x58);
        EXPECT(gbc.c(),  0x35);
        EXPECT(gbc.d(),  0xe0);
        EXPECT(gbc.e(),  0x6b);
        EXPECT(gbc.h(),  0x66);
        EXPECT(gbc.l(),  0x14);
        EXPECT(gbc.sp(), 0xb58e);
        EXPECT(gbc.pc(), 0xafa5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xafa4), 0xa4);
        // A4 03A0
        gbc.setState(0x2055, 0x30f1, 0x9e40, 0x68ed, 0xc1d4, 0x3631, 0x0, 0x1);
        gbc.writeMem(0x2055, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x16);
        EXPECT(gbc.b(),  0x68);
        EXPECT(gbc.c(),  0xed);
        EXPECT(gbc.d(),  0xc1);
        EXPECT(gbc.e(),  0xd4);
        EXPECT(gbc.h(),  0x36);
        EXPECT(gbc.l(),  0x31);
        EXPECT(gbc.sp(), 0x30f1);
        EXPECT(gbc.pc(), 0x2056);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 03A1
        gbc.setState(0xa7a6, 0x9703, 0x9310, 0x441d, 0x5363, 0x54c4, 0x0, 0x1);
        gbc.writeMem(0xa7a6, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0x44);
        EXPECT(gbc.c(),  0x1d);
        EXPECT(gbc.d(),  0x53);
        EXPECT(gbc.e(),  0x63);
        EXPECT(gbc.h(),  0x54);
        EXPECT(gbc.l(),  0xc4);
        EXPECT(gbc.sp(), 0x9703);
        EXPECT(gbc.pc(), 0xa7a7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa7a6), 0xa4);
        // A4 03A2
        gbc.setState(0x4767, 0x75ba, 0x88b0, 0x560e, 0xc02f, 0x774d, 0x0, 0x0);
        gbc.writeMem(0x4767, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x56);
        EXPECT(gbc.c(),  0xe);
        EXPECT(gbc.d(),  0xc0);
        EXPECT(gbc.e(),  0x2f);
        EXPECT(gbc.h(),  0x77);
        EXPECT(gbc.l(),  0x4d);
        EXPECT(gbc.sp(), 0x75ba);
        EXPECT(gbc.pc(), 0x4768);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 03A4
        gbc.setState(0x7107, 0xf254, 0xe960, 0x2e0f, 0xfaf3, 0xe533, 0x1, 0x1);
        gbc.writeMem(0x7107, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe1);
        EXPECT(gbc.b(),  0x2e);
        EXPECT(gbc.c(),  0xf);
        EXPECT(gbc.d(),  0xfa);
        EXPECT(gbc.e(),  0xf3);
        EXPECT(gbc.h(),  0xe5);
        EXPECT(gbc.l(),  0x33);
        EXPECT(gbc.sp(), 0xf254);
        EXPECT(gbc.pc(), 0x7108);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 03A5
        gbc.setState(0xc7ad, 0x9453, 0x1a0, 0xa132, 0xc5b9, 0xf65a, 0x0, 0x0);
        gbc.writeMem(0xc7ad, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0xa1);
        EXPECT(gbc.c(),  0x32);
        EXPECT(gbc.d(),  0xc5);
        EXPECT(gbc.e(),  0xb9);
        EXPECT(gbc.h(),  0xf6);
        EXPECT(gbc.l(),  0x5a);
        EXPECT(gbc.sp(), 0x9453);
        EXPECT(gbc.pc(), 0xc7ae);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc7ad), 0xa4);
        // A4 03A7
        gbc.setState(0xca23, 0xfa7, 0xf3e0, 0x822a, 0xb77f, 0xb382, 0x0, 0x0);
        gbc.writeMem(0xca23, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb3);
        EXPECT(gbc.b(),  0x82);
        EXPECT(gbc.c(),  0x2a);
        EXPECT(gbc.d(),  0xb7);
        EXPECT(gbc.e(),  0x7f);
        EXPECT(gbc.h(),  0xb3);
        EXPECT(gbc.l(),  0x82);
        EXPECT(gbc.sp(), 0xfa7);
        EXPECT(gbc.pc(), 0xca24);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xca23), 0xa4);
        // A4 03A8
        gbc.setState(0xe8ca, 0x4e21, 0xaf00, 0x461, 0xea10, 0x2bea, 0x0, 0x1);
        gbc.writeMem(0xe8ca, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2b);
        EXPECT(gbc.b(),  0x4);
        EXPECT(gbc.c(),  0x61);
        EXPECT(gbc.d(),  0xea);
        EXPECT(gbc.e(),  0x10);
        EXPECT(gbc.h(),  0x2b);
        EXPECT(gbc.l(),  0xea);
        EXPECT(gbc.sp(), 0x4e21);
        EXPECT(gbc.pc(), 0xe8cb);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe8ca), 0xa4);
        // A4 03A9
        gbc.setState(0x848a, 0x957c, 0xc20, 0xef71, 0xa251, 0x9f9b, 0x0, 0x1);
        gbc.writeMem(0x848a, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc);
        EXPECT(gbc.b(),  0xef);
        EXPECT(gbc.c(),  0x71);
        EXPECT(gbc.d(),  0xa2);
        EXPECT(gbc.e(),  0x51);
        EXPECT(gbc.h(),  0x9f);
        EXPECT(gbc.l(),  0x9b);
        EXPECT(gbc.sp(), 0x957c);
        EXPECT(gbc.pc(), 0x848b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x848a), 0xa4);
        // A4 03AB
        gbc.setState(0xa2ac, 0x57fb, 0x6040, 0x12ee, 0x6665, 0xeb28, 0x0, 0x1);
        gbc.writeMem(0xa2ac, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x60);
        EXPECT(gbc.b(),  0x12);
        EXPECT(gbc.c(),  0xee);
        EXPECT(gbc.d(),  0x66);
        EXPECT(gbc.e(),  0x65);
        EXPECT(gbc.h(),  0xeb);
        EXPECT(gbc.l(),  0x28);
        EXPECT(gbc.sp(), 0x57fb);
        EXPECT(gbc.pc(), 0xa2ad);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa2ac), 0xa4);
        // A4 03AC
        gbc.setState(0x7a7c, 0xa2b7, 0xd170, 0xb04d, 0xab11, 0x7c51, 0x0, 0x0);
        gbc.writeMem(0x7a7c, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x50);
        EXPECT(gbc.b(),  0xb0);
        EXPECT(gbc.c(),  0x4d);
        EXPECT(gbc.d(),  0xab);
        EXPECT(gbc.e(),  0x11);
        EXPECT(gbc.h(),  0x7c);
        EXPECT(gbc.l(),  0x51);
        EXPECT(gbc.sp(), 0xa2b7);
        EXPECT(gbc.pc(), 0x7a7d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 03AD
        gbc.setState(0x80e4, 0xbce9, 0x92c0, 0x7172, 0xa238, 0x4476, 0x0, 0x1);
        gbc.writeMem(0x80e4, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x71);
        EXPECT(gbc.c(),  0x72);
        EXPECT(gbc.d(),  0xa2);
        EXPECT(gbc.e(),  0x38);
        EXPECT(gbc.h(),  0x44);
        EXPECT(gbc.l(),  0x76);
        EXPECT(gbc.sp(), 0xbce9);
        EXPECT(gbc.pc(), 0x80e5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x80e4), 0xa4);
        // A4 03AE
        gbc.setState(0x3202, 0xe6c3, 0x94e0, 0x7ca1, 0xce7a, 0xf1ae, 0x1, 0x1);
        gbc.writeMem(0x3202, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x90);
        EXPECT(gbc.b(),  0x7c);
        EXPECT(gbc.c(),  0xa1);
        EXPECT(gbc.d(),  0xce);
        EXPECT(gbc.e(),  0x7a);
        EXPECT(gbc.h(),  0xf1);
        EXPECT(gbc.l(),  0xae);
        EXPECT(gbc.sp(), 0xe6c3);
        EXPECT(gbc.pc(), 0x3203);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 03AF
        gbc.setState(0xd0f, 0xbf2f, 0xf320, 0x5473, 0x1d01, 0xa1c3, 0x1, 0x1);
        gbc.writeMem(0xd0f, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa1);
        EXPECT(gbc.b(),  0x54);
        EXPECT(gbc.c(),  0x73);
        EXPECT(gbc.d(),  0x1d);
        EXPECT(gbc.e(),  0x1);
        EXPECT(gbc.h(),  0xa1);
        EXPECT(gbc.l(),  0xc3);
        EXPECT(gbc.sp(), 0xbf2f);
        EXPECT(gbc.pc(), 0xd10);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 03B0
        gbc.setState(0xdf05, 0x7ca4, 0xe310, 0x5fb2, 0xa48c, 0x39ee, 0x1, 0x0);
        gbc.writeMem(0xdf05, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x21);
        EXPECT(gbc.b(),  0x5f);
        EXPECT(gbc.c(),  0xb2);
        EXPECT(gbc.d(),  0xa4);
        EXPECT(gbc.e(),  0x8c);
        EXPECT(gbc.h(),  0x39);
        EXPECT(gbc.l(),  0xee);
        EXPECT(gbc.sp(), 0x7ca4);
        EXPECT(gbc.pc(), 0xdf06);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdf05), 0xa4);
        // A4 03B2
        gbc.setState(0x2b8f, 0xdedf, 0x71d0, 0x3136, 0x70b1, 0x85e9, 0x0, 0x0);
        gbc.writeMem(0x2b8f, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0x31);
        EXPECT(gbc.c(),  0x36);
        EXPECT(gbc.d(),  0x70);
        EXPECT(gbc.e(),  0xb1);
        EXPECT(gbc.h(),  0x85);
        EXPECT(gbc.l(),  0xe9);
        EXPECT(gbc.sp(), 0xdedf);
        EXPECT(gbc.pc(), 0x2b90);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 03B3
        gbc.setState(0x9062, 0x6a1a, 0x8ac0, 0xddc2, 0x1160, 0x93d4, 0x0, 0x0);
        gbc.writeMem(0x9062, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x82);
        EXPECT(gbc.b(),  0xdd);
        EXPECT(gbc.c(),  0xc2);
        EXPECT(gbc.d(),  0x11);
        EXPECT(gbc.e(),  0x60);
        EXPECT(gbc.h(),  0x93);
        EXPECT(gbc.l(),  0xd4);
        EXPECT(gbc.sp(), 0x6a1a);
        EXPECT(gbc.pc(), 0x9063);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9062), 0xa4);
        // A4 03B4
        gbc.setState(0x82c6, 0x473d, 0xcc90, 0xe834, 0x4492, 0x8b7a, 0x1, 0x1);
        gbc.writeMem(0x82c6, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x88);
        EXPECT(gbc.b(),  0xe8);
        EXPECT(gbc.c(),  0x34);
        EXPECT(gbc.d(),  0x44);
        EXPECT(gbc.e(),  0x92);
        EXPECT(gbc.h(),  0x8b);
        EXPECT(gbc.l(),  0x7a);
        EXPECT(gbc.sp(), 0x473d);
        EXPECT(gbc.pc(), 0x82c7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x82c6), 0xa4);
        // A4 03B5
        gbc.setState(0xcd38, 0xf2bd, 0xb590, 0x5af1, 0x8d7f, 0xba83, 0x1, 0x1);
        gbc.writeMem(0xcd38, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb0);
        EXPECT(gbc.b(),  0x5a);
        EXPECT(gbc.c(),  0xf1);
        EXPECT(gbc.d(),  0x8d);
        EXPECT(gbc.e(),  0x7f);
        EXPECT(gbc.h(),  0xba);
        EXPECT(gbc.l(),  0x83);
        EXPECT(gbc.sp(), 0xf2bd);
        EXPECT(gbc.pc(), 0xcd39);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcd38), 0xa4);
        // A4 03B6
        gbc.setState(0x3e23, 0xbe08, 0x8270, 0x69be, 0xd220, 0xe512, 0x1, 0x0);
        gbc.writeMem(0x3e23, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0x69);
        EXPECT(gbc.c(),  0xbe);
        EXPECT(gbc.d(),  0xd2);
        EXPECT(gbc.e(),  0x20);
        EXPECT(gbc.h(),  0xe5);
        EXPECT(gbc.l(),  0x12);
        EXPECT(gbc.sp(), 0xbe08);
        EXPECT(gbc.pc(), 0x3e24);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 03B7
        gbc.setState(0x96e7, 0x799a, 0x9ab0, 0xc16e, 0xe11a, 0xa027, 0x1, 0x0);
        gbc.writeMem(0x96e7, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0xc1);
        EXPECT(gbc.c(),  0x6e);
        EXPECT(gbc.d(),  0xe1);
        EXPECT(gbc.e(),  0x1a);
        EXPECT(gbc.h(),  0xa0);
        EXPECT(gbc.l(),  0x27);
        EXPECT(gbc.sp(), 0x799a);
        EXPECT(gbc.pc(), 0x96e8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x96e7), 0xa4);
        // A4 03B8
        gbc.setState(0x882, 0x38b3, 0x3460, 0x47b1, 0x47a, 0x93b1, 0x0, 0x1);
        gbc.writeMem(0x882, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0x47);
        EXPECT(gbc.c(),  0xb1);
        EXPECT(gbc.d(),  0x4);
        EXPECT(gbc.e(),  0x7a);
        EXPECT(gbc.h(),  0x93);
        EXPECT(gbc.l(),  0xb1);
        EXPECT(gbc.sp(), 0x38b3);
        EXPECT(gbc.pc(), 0x883);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 03B9
        gbc.setState(0x3e6b, 0x5741, 0x6990, 0xbe4e, 0xa78f, 0x27b5, 0x0, 0x0);
        gbc.writeMem(0x3e6b, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x21);
        EXPECT(gbc.b(),  0xbe);
        EXPECT(gbc.c(),  0x4e);
        EXPECT(gbc.d(),  0xa7);
        EXPECT(gbc.e(),  0x8f);
        EXPECT(gbc.h(),  0x27);
        EXPECT(gbc.l(),  0xb5);
        EXPECT(gbc.sp(), 0x5741);
        EXPECT(gbc.pc(), 0x3e6c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 03BA
        gbc.setState(0x1960, 0x2662, 0x8ae0, 0x8897, 0x7c1e, 0x85d4, 0x0, 0x0);
        gbc.writeMem(0x1960, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0x88);
        EXPECT(gbc.c(),  0x97);
        EXPECT(gbc.d(),  0x7c);
        EXPECT(gbc.e(),  0x1e);
        EXPECT(gbc.h(),  0x85);
        EXPECT(gbc.l(),  0xd4);
        EXPECT(gbc.sp(), 0x2662);
        EXPECT(gbc.pc(), 0x1961);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 03BB
        gbc.setState(0x7109, 0x54ef, 0x8e0, 0xedf2, 0xfb25, 0x59ee, 0x0, 0x1);
        gbc.writeMem(0x7109, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0xed);
        EXPECT(gbc.c(),  0xf2);
        EXPECT(gbc.d(),  0xfb);
        EXPECT(gbc.e(),  0x25);
        EXPECT(gbc.h(),  0x59);
        EXPECT(gbc.l(),  0xee);
        EXPECT(gbc.sp(), 0x54ef);
        EXPECT(gbc.pc(), 0x710a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 03BC
        gbc.setState(0x9b48, 0x9c0a, 0x8e0, 0x67f9, 0x7665, 0x537, 0x1, 0x1);
        gbc.writeMem(0x9b48, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x67);
        EXPECT(gbc.c(),  0xf9);
        EXPECT(gbc.d(),  0x76);
        EXPECT(gbc.e(),  0x65);
        EXPECT(gbc.h(),  0x5);
        EXPECT(gbc.l(),  0x37);
        EXPECT(gbc.sp(), 0x9c0a);
        EXPECT(gbc.pc(), 0x9b49);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9b48), 0xa4);
        // A4 03BD
        gbc.setState(0x4a90, 0x5a83, 0xe2b0, 0x3a1, 0xba0, 0x51e3, 0x1, 0x0);
        gbc.writeMem(0x4a90, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0x3);
        EXPECT(gbc.c(),  0xa1);
        EXPECT(gbc.d(),  0xb);
        EXPECT(gbc.e(),  0xa0);
        EXPECT(gbc.h(),  0x51);
        EXPECT(gbc.l(),  0xe3);
        EXPECT(gbc.sp(), 0x5a83);
        EXPECT(gbc.pc(), 0x4a91);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 03BE
        gbc.setState(0x5a79, 0x3de, 0x6c00, 0x8d2, 0x339a, 0x7721, 0x0, 0x1);
        gbc.writeMem(0x5a79, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x64);
        EXPECT(gbc.b(),  0x8);
        EXPECT(gbc.c(),  0xd2);
        EXPECT(gbc.d(),  0x33);
        EXPECT(gbc.e(),  0x9a);
        EXPECT(gbc.h(),  0x77);
        EXPECT(gbc.l(),  0x21);
        EXPECT(gbc.sp(), 0x3de);
        EXPECT(gbc.pc(), 0x5a7a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 03BF
        gbc.setState(0x2ad0, 0xd04f, 0xcc60, 0xc5d2, 0x468f, 0xff10, 0x1, 0x0);
        gbc.writeMem(0x2ad0, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xcc);
        EXPECT(gbc.b(),  0xc5);
        EXPECT(gbc.c(),  0xd2);
        EXPECT(gbc.d(),  0x46);
        EXPECT(gbc.e(),  0x8f);
        EXPECT(gbc.h(),  0xff);
        EXPECT(gbc.l(),  0x10);
        EXPECT(gbc.sp(), 0xd04f);
        EXPECT(gbc.pc(), 0x2ad1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 03C0
        gbc.setState(0xa29f, 0x3f8f, 0xb7d0, 0x12df, 0xad78, 0x5bb2, 0x1, 0x1);
        gbc.writeMem(0xa29f, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x13);
        EXPECT(gbc.b(),  0x12);
        EXPECT(gbc.c(),  0xdf);
        EXPECT(gbc.d(),  0xad);
        EXPECT(gbc.e(),  0x78);
        EXPECT(gbc.h(),  0x5b);
        EXPECT(gbc.l(),  0xb2);
        EXPECT(gbc.sp(), 0x3f8f);
        EXPECT(gbc.pc(), 0xa2a0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa29f), 0xa4);
        // A4 03C1
        gbc.setState(0x6fdf, 0x4b7a, 0x7010, 0xf376, 0xa95e, 0xb1be, 0x1, 0x0);
        gbc.writeMem(0x6fdf, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x30);
        EXPECT(gbc.b(),  0xf3);
        EXPECT(gbc.c(),  0x76);
        EXPECT(gbc.d(),  0xa9);
        EXPECT(gbc.e(),  0x5e);
        EXPECT(gbc.h(),  0xb1);
        EXPECT(gbc.l(),  0xbe);
        EXPECT(gbc.sp(), 0x4b7a);
        EXPECT(gbc.pc(), 0x6fe0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 03C2
        gbc.setState(0xa59a, 0x27f9, 0xe350, 0xefc, 0xbcc5, 0xf838, 0x1, 0x1);
        gbc.writeMem(0xa59a, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe0);
        EXPECT(gbc.b(),  0xe);
        EXPECT(gbc.c(),  0xfc);
        EXPECT(gbc.d(),  0xbc);
        EXPECT(gbc.e(),  0xc5);
        EXPECT(gbc.h(),  0xf8);
        EXPECT(gbc.l(),  0x38);
        EXPECT(gbc.sp(), 0x27f9);
        EXPECT(gbc.pc(), 0xa59b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa59a), 0xa4);
        // A4 03C3
        gbc.setState(0x487b, 0xea19, 0x84e0, 0x758f, 0xb407, 0x32b2, 0x0, 0x1);
        gbc.writeMem(0x487b, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x75);
        EXPECT(gbc.c(),  0x8f);
        EXPECT(gbc.d(),  0xb4);
        EXPECT(gbc.e(),  0x7);
        EXPECT(gbc.h(),  0x32);
        EXPECT(gbc.l(),  0xb2);
        EXPECT(gbc.sp(), 0xea19);
        EXPECT(gbc.pc(), 0x487c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 03C4
        gbc.setState(0x802b, 0xb1b9, 0xb740, 0x5f6b, 0xa6a1, 0xd354, 0x0, 0x1);
        gbc.writeMem(0x802b, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x93);
        EXPECT(gbc.b(),  0x5f);
        EXPECT(gbc.c(),  0x6b);
        EXPECT(gbc.d(),  0xa6);
        EXPECT(gbc.e(),  0xa1);
        EXPECT(gbc.h(),  0xd3);
        EXPECT(gbc.l(),  0x54);
        EXPECT(gbc.sp(), 0xb1b9);
        EXPECT(gbc.pc(), 0x802c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x802b), 0xa4);
        // A4 03C5
        gbc.setState(0x82c0, 0xe529, 0x4120, 0xdd6c, 0x2e97, 0x7241, 0x0, 0x1);
        gbc.writeMem(0x82c0, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0xdd);
        EXPECT(gbc.c(),  0x6c);
        EXPECT(gbc.d(),  0x2e);
        EXPECT(gbc.e(),  0x97);
        EXPECT(gbc.h(),  0x72);
        EXPECT(gbc.l(),  0x41);
        EXPECT(gbc.sp(), 0xe529);
        EXPECT(gbc.pc(), 0x82c1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x82c0), 0xa4);
        // A4 03C6
        gbc.setState(0x24dd, 0xe5f4, 0xa50, 0xa0c7, 0x638b, 0x8a7d, 0x1, 0x1);
        gbc.writeMem(0x24dd, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa);
        EXPECT(gbc.b(),  0xa0);
        EXPECT(gbc.c(),  0xc7);
        EXPECT(gbc.d(),  0x63);
        EXPECT(gbc.e(),  0x8b);
        EXPECT(gbc.h(),  0x8a);
        EXPECT(gbc.l(),  0x7d);
        EXPECT(gbc.sp(), 0xe5f4);
        EXPECT(gbc.pc(), 0x24de);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 03C7
        gbc.setState(0xa4cf, 0x3731, 0x5100, 0x64d2, 0x35a8, 0xdbc0, 0x0, 0x0);
        gbc.writeMem(0xa4cf, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x51);
        EXPECT(gbc.b(),  0x64);
        EXPECT(gbc.c(),  0xd2);
        EXPECT(gbc.d(),  0x35);
        EXPECT(gbc.e(),  0xa8);
        EXPECT(gbc.h(),  0xdb);
        EXPECT(gbc.l(),  0xc0);
        EXPECT(gbc.sp(), 0x3731);
        EXPECT(gbc.pc(), 0xa4d0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa4cf), 0xa4);
        // A4 03C8
        gbc.setState(0x7795, 0x2126, 0x26f0, 0x2b73, 0x35c4, 0x8d71, 0x0, 0x0);
        gbc.writeMem(0x7795, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0x2b);
        EXPECT(gbc.c(),  0x73);
        EXPECT(gbc.d(),  0x35);
        EXPECT(gbc.e(),  0xc4);
        EXPECT(gbc.h(),  0x8d);
        EXPECT(gbc.l(),  0x71);
        EXPECT(gbc.sp(), 0x2126);
        EXPECT(gbc.pc(), 0x7796);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 03C9
        gbc.setState(0x875e, 0x642d, 0xb770, 0xd142, 0xf879, 0x9a51, 0x0, 0x1);
        gbc.writeMem(0x875e, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x92);
        EXPECT(gbc.b(),  0xd1);
        EXPECT(gbc.c(),  0x42);
        EXPECT(gbc.d(),  0xf8);
        EXPECT(gbc.e(),  0x79);
        EXPECT(gbc.h(),  0x9a);
        EXPECT(gbc.l(),  0x51);
        EXPECT(gbc.sp(), 0x642d);
        EXPECT(gbc.pc(), 0x875f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x875e), 0xa4);
        // A4 03CA
        gbc.setState(0x8226, 0x8321, 0x18f0, 0xf6fc, 0x7092, 0x5f6, 0x0, 0x1);
        gbc.writeMem(0x8226, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0xf6);
        EXPECT(gbc.c(),  0xfc);
        EXPECT(gbc.d(),  0x70);
        EXPECT(gbc.e(),  0x92);
        EXPECT(gbc.h(),  0x5);
        EXPECT(gbc.l(),  0xf6);
        EXPECT(gbc.sp(), 0x8321);
        EXPECT(gbc.pc(), 0x8227);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8226), 0xa4);
        // A4 03CB
        gbc.setState(0xcb81, 0x780d, 0xbee0, 0x8a50, 0xabb2, 0xc326, 0x0, 0x1);
        gbc.writeMem(0xcb81, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x82);
        EXPECT(gbc.b(),  0x8a);
        EXPECT(gbc.c(),  0x50);
        EXPECT(gbc.d(),  0xab);
        EXPECT(gbc.e(),  0xb2);
        EXPECT(gbc.h(),  0xc3);
        EXPECT(gbc.l(),  0x26);
        EXPECT(gbc.sp(), 0x780d);
        EXPECT(gbc.pc(), 0xcb82);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcb81), 0xa4);
        // A4 03CC
        gbc.setState(0x692f, 0xd4d7, 0xbcb0, 0xcd51, 0xc898, 0x803, 0x0, 0x0);
        gbc.writeMem(0x692f, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0xcd);
        EXPECT(gbc.c(),  0x51);
        EXPECT(gbc.d(),  0xc8);
        EXPECT(gbc.e(),  0x98);
        EXPECT(gbc.h(),  0x8);
        EXPECT(gbc.l(),  0x3);
        EXPECT(gbc.sp(), 0xd4d7);
        EXPECT(gbc.pc(), 0x6930);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 03CD
        gbc.setState(0x140, 0x36bd, 0x8cc0, 0xd6f3, 0x3bd5, 0xd76c, 0x0, 0x0);
        gbc.writeMem(0x140, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x84);
        EXPECT(gbc.b(),  0xd6);
        EXPECT(gbc.c(),  0xf3);
        EXPECT(gbc.d(),  0x3b);
        EXPECT(gbc.e(),  0xd5);
        EXPECT(gbc.h(),  0xd7);
        EXPECT(gbc.l(),  0x6c);
        EXPECT(gbc.sp(), 0x36bd);
        EXPECT(gbc.pc(), 0x141);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 03CE
        gbc.setState(0xa352, 0xfaa2, 0x2530, 0xb111, 0x5001, 0x1e70, 0x0, 0x0);
        gbc.writeMem(0xa352, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0xb1);
        EXPECT(gbc.c(),  0x11);
        EXPECT(gbc.d(),  0x50);
        EXPECT(gbc.e(),  0x1);
        EXPECT(gbc.h(),  0x1e);
        EXPECT(gbc.l(),  0x70);
        EXPECT(gbc.sp(), 0xfaa2);
        EXPECT(gbc.pc(), 0xa353);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa352), 0xa4);
        // A4 03CF
        gbc.setState(0xad7e, 0xeddb, 0x8700, 0xcdd0, 0xfd0, 0xef9b, 0x1, 0x0);
        gbc.writeMem(0xad7e, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x87);
        EXPECT(gbc.b(),  0xcd);
        EXPECT(gbc.c(),  0xd0);
        EXPECT(gbc.d(),  0xf);
        EXPECT(gbc.e(),  0xd0);
        EXPECT(gbc.h(),  0xef);
        EXPECT(gbc.l(),  0x9b);
        EXPECT(gbc.sp(), 0xeddb);
        EXPECT(gbc.pc(), 0xad7f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xad7e), 0xa4);
        // A4 03D0
        gbc.setState(0x335c, 0x7db3, 0x2e70, 0xed64, 0xbe03, 0xbadf, 0x0, 0x1);
        gbc.writeMem(0x335c, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2a);
        EXPECT(gbc.b(),  0xed);
        EXPECT(gbc.c(),  0x64);
        EXPECT(gbc.d(),  0xbe);
        EXPECT(gbc.e(),  0x3);
        EXPECT(gbc.h(),  0xba);
        EXPECT(gbc.l(),  0xdf);
        EXPECT(gbc.sp(), 0x7db3);
        EXPECT(gbc.pc(), 0x335d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 03D1
        gbc.setState(0x80e9, 0x97dd, 0x4f0, 0x445d, 0xdb77, 0xec91, 0x1, 0x1);
        gbc.writeMem(0x80e9, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0x44);
        EXPECT(gbc.c(),  0x5d);
        EXPECT(gbc.d(),  0xdb);
        EXPECT(gbc.e(),  0x77);
        EXPECT(gbc.h(),  0xec);
        EXPECT(gbc.l(),  0x91);
        EXPECT(gbc.sp(), 0x97dd);
        EXPECT(gbc.pc(), 0x80ea);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x80e9), 0xa4);
        // A4 03D2
        gbc.setState(0x95d5, 0x20f4, 0x71b0, 0xcef4, 0xb0e1, 0x7300, 0x0, 0x0);
        gbc.writeMem(0x95d5, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x71);
        EXPECT(gbc.b(),  0xce);
        EXPECT(gbc.c(),  0xf4);
        EXPECT(gbc.d(),  0xb0);
        EXPECT(gbc.e(),  0xe1);
        EXPECT(gbc.h(),  0x73);
        EXPECT(gbc.l(),  0x0);
        EXPECT(gbc.sp(), 0x20f4);
        EXPECT(gbc.pc(), 0x95d6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x95d5), 0xa4);
        // A4 03D3
        gbc.setState(0xadc9, 0x2436, 0x4ac0, 0x9103, 0x711f, 0xf703, 0x0, 0x1);
        gbc.writeMem(0xadc9, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x42);
        EXPECT(gbc.b(),  0x91);
        EXPECT(gbc.c(),  0x3);
        EXPECT(gbc.d(),  0x71);
        EXPECT(gbc.e(),  0x1f);
        EXPECT(gbc.h(),  0xf7);
        EXPECT(gbc.l(),  0x3);
        EXPECT(gbc.sp(), 0x2436);
        EXPECT(gbc.pc(), 0xadca);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xadc9), 0xa4);
        // A4 03D4
        gbc.setState(0x49bd, 0xc3a3, 0x50a0, 0xd049, 0xffb3, 0x406a, 0x1, 0x0);
        gbc.writeMem(0x49bd, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0xd0);
        EXPECT(gbc.c(),  0x49);
        EXPECT(gbc.d(),  0xff);
        EXPECT(gbc.e(),  0xb3);
        EXPECT(gbc.h(),  0x40);
        EXPECT(gbc.l(),  0x6a);
        EXPECT(gbc.sp(), 0xc3a3);
        EXPECT(gbc.pc(), 0x49be);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 03D6
        gbc.setState(0xcbfb, 0x557a, 0xaf90, 0xa62f, 0x7d30, 0x7c4e, 0x0, 0x0);
        gbc.writeMem(0xcbfb, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2c);
        EXPECT(gbc.b(),  0xa6);
        EXPECT(gbc.c(),  0x2f);
        EXPECT(gbc.d(),  0x7d);
        EXPECT(gbc.e(),  0x30);
        EXPECT(gbc.h(),  0x7c);
        EXPECT(gbc.l(),  0x4e);
        EXPECT(gbc.sp(), 0x557a);
        EXPECT(gbc.pc(), 0xcbfc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcbfb), 0xa4);
        // A4 03D7
        gbc.setState(0x8b90, 0xb4ef, 0x3da0, 0x387b, 0xd772, 0x75f4, 0x0, 0x0);
        gbc.writeMem(0x8b90, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x35);
        EXPECT(gbc.b(),  0x38);
        EXPECT(gbc.c(),  0x7b);
        EXPECT(gbc.d(),  0xd7);
        EXPECT(gbc.e(),  0x72);
        EXPECT(gbc.h(),  0x75);
        EXPECT(gbc.l(),  0xf4);
        EXPECT(gbc.sp(), 0xb4ef);
        EXPECT(gbc.pc(), 0x8b91);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8b90), 0xa4);
        // A4 03D8
        gbc.setState(0x6c28, 0x22e5, 0x2540, 0x4cab, 0x50af, 0xf626, 0x1, 0x1);
        gbc.writeMem(0x6c28, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x24);
        EXPECT(gbc.b(),  0x4c);
        EXPECT(gbc.c(),  0xab);
        EXPECT(gbc.d(),  0x50);
        EXPECT(gbc.e(),  0xaf);
        EXPECT(gbc.h(),  0xf6);
        EXPECT(gbc.l(),  0x26);
        EXPECT(gbc.sp(), 0x22e5);
        EXPECT(gbc.pc(), 0x6c29);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 03D9
        gbc.setState(0x61ac, 0x88b8, 0xf150, 0xfc2b, 0x41db, 0x8e4a, 0x0, 0x1);
        gbc.writeMem(0x61ac, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0xfc);
        EXPECT(gbc.c(),  0x2b);
        EXPECT(gbc.d(),  0x41);
        EXPECT(gbc.e(),  0xdb);
        EXPECT(gbc.h(),  0x8e);
        EXPECT(gbc.l(),  0x4a);
        EXPECT(gbc.sp(), 0x88b8);
        EXPECT(gbc.pc(), 0x61ad);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 03DA
        gbc.setState(0x98a0, 0xfd73, 0x3400, 0x9eb3, 0xccaf, 0xf0a, 0x1, 0x1);
        gbc.writeMem(0x98a0, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0x9e);
        EXPECT(gbc.c(),  0xb3);
        EXPECT(gbc.d(),  0xcc);
        EXPECT(gbc.e(),  0xaf);
        EXPECT(gbc.h(),  0xf);
        EXPECT(gbc.l(),  0xa);
        EXPECT(gbc.sp(), 0xfd73);
        EXPECT(gbc.pc(), 0x98a1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x98a0), 0xa4);
        // A4 03DB
        gbc.setState(0x2974, 0x126c, 0x9ca0, 0x624e, 0xc50, 0xf00, 0x1, 0x0);
        gbc.writeMem(0x2974, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc);
        EXPECT(gbc.b(),  0x62);
        EXPECT(gbc.c(),  0x4e);
        EXPECT(gbc.d(),  0xc);
        EXPECT(gbc.e(),  0x50);
        EXPECT(gbc.h(),  0xf);
        EXPECT(gbc.l(),  0x0);
        EXPECT(gbc.sp(), 0x126c);
        EXPECT(gbc.pc(), 0x2975);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 03DC
        gbc.setState(0xd358, 0x25ab, 0x690, 0x14f9, 0x1fdb, 0x591e, 0x1, 0x0);
        gbc.writeMem(0xd358, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x14);
        EXPECT(gbc.c(),  0xf9);
        EXPECT(gbc.d(),  0x1f);
        EXPECT(gbc.e(),  0xdb);
        EXPECT(gbc.h(),  0x59);
        EXPECT(gbc.l(),  0x1e);
        EXPECT(gbc.sp(), 0x25ab);
        EXPECT(gbc.pc(), 0xd359);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd358), 0xa4);
        // A4 03DD
        gbc.setState(0x1a9b, 0x599c, 0xafb0, 0xed9, 0x2f36, 0x8ae2, 0x1, 0x1);
        gbc.writeMem(0x1a9b, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8a);
        EXPECT(gbc.b(),  0xe);
        EXPECT(gbc.c(),  0xd9);
        EXPECT(gbc.d(),  0x2f);
        EXPECT(gbc.e(),  0x36);
        EXPECT(gbc.h(),  0x8a);
        EXPECT(gbc.l(),  0xe2);
        EXPECT(gbc.sp(), 0x599c);
        EXPECT(gbc.pc(), 0x1a9c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 03DE
        gbc.setState(0xc931, 0xfb66, 0x9220, 0x46e6, 0xa690, 0xb192, 0x1, 0x1);
        gbc.writeMem(0xc931, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x90);
        EXPECT(gbc.b(),  0x46);
        EXPECT(gbc.c(),  0xe6);
        EXPECT(gbc.d(),  0xa6);
        EXPECT(gbc.e(),  0x90);
        EXPECT(gbc.h(),  0xb1);
        EXPECT(gbc.l(),  0x92);
        EXPECT(gbc.sp(), 0xfb66);
        EXPECT(gbc.pc(), 0xc932);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc931), 0xa4);
        // A4 03DF
        gbc.setState(0xb8f2, 0xc21d, 0x6df0, 0xa604, 0xf68e, 0xb9a9, 0x1, 0x0);
        gbc.writeMem(0xb8f2, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x29);
        EXPECT(gbc.b(),  0xa6);
        EXPECT(gbc.c(),  0x4);
        EXPECT(gbc.d(),  0xf6);
        EXPECT(gbc.e(),  0x8e);
        EXPECT(gbc.h(),  0xb9);
        EXPECT(gbc.l(),  0xa9);
        EXPECT(gbc.sp(), 0xc21d);
        EXPECT(gbc.pc(), 0xb8f3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb8f2), 0xa4);
        // A4 03E0
        gbc.setState(0x4e24, 0xb983, 0x5890, 0xdf5c, 0xb5d1, 0x1b52, 0x0, 0x1);
        gbc.writeMem(0x4e24, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x18);
        EXPECT(gbc.b(),  0xdf);
        EXPECT(gbc.c(),  0x5c);
        EXPECT(gbc.d(),  0xb5);
        EXPECT(gbc.e(),  0xd1);
        EXPECT(gbc.h(),  0x1b);
        EXPECT(gbc.l(),  0x52);
        EXPECT(gbc.sp(), 0xb983);
        EXPECT(gbc.pc(), 0x4e25);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 03E1
        gbc.setState(0x40e4, 0xf893, 0xfe20, 0xc2b4, 0x79ee, 0x3b8, 0x0, 0x0);
        gbc.writeMem(0x40e4, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0xc2);
        EXPECT(gbc.c(),  0xb4);
        EXPECT(gbc.d(),  0x79);
        EXPECT(gbc.e(),  0xee);
        EXPECT(gbc.h(),  0x3);
        EXPECT(gbc.l(),  0xb8);
        EXPECT(gbc.sp(), 0xf893);
        EXPECT(gbc.pc(), 0x40e5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 03E2
        gbc.setState(0x13be, 0x3681, 0xe2b0, 0xe01f, 0xda81, 0xba12, 0x0, 0x1);
        gbc.writeMem(0x13be, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa2);
        EXPECT(gbc.b(),  0xe0);
        EXPECT(gbc.c(),  0x1f);
        EXPECT(gbc.d(),  0xda);
        EXPECT(gbc.e(),  0x81);
        EXPECT(gbc.h(),  0xba);
        EXPECT(gbc.l(),  0x12);
        EXPECT(gbc.sp(), 0x3681);
        EXPECT(gbc.pc(), 0x13bf);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 03E3
        gbc.setState(0x614d, 0xdb5f, 0x1a0, 0xd1c9, 0xd195, 0x770e, 0x0, 0x1);
        gbc.writeMem(0x614d, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0xd1);
        EXPECT(gbc.c(),  0xc9);
        EXPECT(gbc.d(),  0xd1);
        EXPECT(gbc.e(),  0x95);
        EXPECT(gbc.h(),  0x77);
        EXPECT(gbc.l(),  0xe);
        EXPECT(gbc.sp(), 0xdb5f);
        EXPECT(gbc.pc(), 0x614e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 03E4
        gbc.setState(0x6afb, 0xbf61, 0x6660, 0x99c9, 0xf584, 0xf678, 0x0, 0x1);
        gbc.writeMem(0x6afb, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x66);
        EXPECT(gbc.b(),  0x99);
        EXPECT(gbc.c(),  0xc9);
        EXPECT(gbc.d(),  0xf5);
        EXPECT(gbc.e(),  0x84);
        EXPECT(gbc.h(),  0xf6);
        EXPECT(gbc.l(),  0x78);
        EXPECT(gbc.sp(), 0xbf61);
        EXPECT(gbc.pc(), 0x6afc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 03E5
        gbc.setState(0xcfa3, 0xb5c5, 0x6d60, 0xd4be, 0xf48e, 0x34b5, 0x1, 0x0);
        gbc.writeMem(0xcfa3, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x24);
        EXPECT(gbc.b(),  0xd4);
        EXPECT(gbc.c(),  0xbe);
        EXPECT(gbc.d(),  0xf4);
        EXPECT(gbc.e(),  0x8e);
        EXPECT(gbc.h(),  0x34);
        EXPECT(gbc.l(),  0xb5);
        EXPECT(gbc.sp(), 0xb5c5);
        EXPECT(gbc.pc(), 0xcfa4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcfa3), 0xa4);
        // A4 03E6
        gbc.setState(0x28b2, 0x4033, 0x6fe0, 0x7b8c, 0x6169, 0xcc50, 0x1, 0x1);
        gbc.writeMem(0x28b2, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4c);
        EXPECT(gbc.b(),  0x7b);
        EXPECT(gbc.c(),  0x8c);
        EXPECT(gbc.d(),  0x61);
        EXPECT(gbc.e(),  0x69);
        EXPECT(gbc.h(),  0xcc);
        EXPECT(gbc.l(),  0x50);
        EXPECT(gbc.sp(), 0x4033);
        EXPECT(gbc.pc(), 0x28b3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // A4 03E7
        gbc.setState(0x63c1, 0x5ccf, 0xfc20, 0xdaa3, 0x6cfe, 0x2b02, 0x0, 0x1);
        gbc.writeMem(0x63c1, { 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0xda);
        EXPECT(gbc.c(),  0xa3);
        EXPECT(gbc.d(),  0x6c);
        EXPECT(gbc.e(),  0xfe);
        EXPECT(gbc.h(),  0x2b);
        EXPECT(gbc.l(),  0x2);
        EXPECT(gbc.sp(), 0x5ccf);
        EXPECT(gbc.pc(), 0x63c2);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
    }
}
#endif
