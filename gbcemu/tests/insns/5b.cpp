#include "../gbctests_insns.h"
#if (defined GBCEMU_INSNS_TESTS_ALL) || (defined GBCEMU_INSNS_TESTS_5b)
#include "../gbctests.h"

namespace rckid::gbcemu {

    TEST(gbcemu, opcode_5b) {
        GBCEmu gbc{};
        uint8_t cartridge[0x8000];
        cartridge[0x149] = 0x02; // 8kb external RAM
        gbc.loadCartridge(new FlashGamePak(cartridge));
        // 5B 0001
        gbc.setState(0x178a, 0x1f4a, 0x53a0, 0xd8e3, 0x8e9f, 0x138f, 0x0, 0x0);
        gbc.writeMem(0x178a, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x53);
        EXPECT(gbc.b(),  0xd8);
        EXPECT(gbc.c(),  0xe3);
        EXPECT(gbc.d(),  0x8e);
        EXPECT(gbc.e(),  0x9f);
        EXPECT(gbc.h(),  0x13);
        EXPECT(gbc.l(),  0x8f);
        EXPECT(gbc.sp(), 0x1f4a);
        EXPECT(gbc.pc(), 0x178b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0002
        gbc.setState(0xdb37, 0x33f0, 0xe650, 0xa0e0, 0x3b9d, 0xc8ef, 0x1, 0x1);
        gbc.writeMem(0xdb37, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xe6);
        EXPECT(gbc.b(),  0xa0);
        EXPECT(gbc.c(),  0xe0);
        EXPECT(gbc.d(),  0x3b);
        EXPECT(gbc.e(),  0x9d);
        EXPECT(gbc.h(),  0xc8);
        EXPECT(gbc.l(),  0xef);
        EXPECT(gbc.sp(), 0x33f0);
        EXPECT(gbc.pc(), 0xdb38);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xdb37), 0x5b);
        // 5B 0003
        gbc.setState(0x922c, 0x109f, 0x80e0, 0xabf9, 0xb536, 0x3e72, 0x0, 0x0);
        gbc.writeMem(0x922c, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0xab);
        EXPECT(gbc.c(),  0xf9);
        EXPECT(gbc.d(),  0xb5);
        EXPECT(gbc.e(),  0x36);
        EXPECT(gbc.h(),  0x3e);
        EXPECT(gbc.l(),  0x72);
        EXPECT(gbc.sp(), 0x109f);
        EXPECT(gbc.pc(), 0x922d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x922c), 0x5b);
        // 5B 0004
        gbc.setState(0x6910, 0x836f, 0x1f80, 0x4add, 0xb7ae, 0x4e6d, 0x0, 0x0);
        gbc.writeMem(0x6910, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x1f);
        EXPECT(gbc.b(),  0x4a);
        EXPECT(gbc.c(),  0xdd);
        EXPECT(gbc.d(),  0xb7);
        EXPECT(gbc.e(),  0xae);
        EXPECT(gbc.h(),  0x4e);
        EXPECT(gbc.l(),  0x6d);
        EXPECT(gbc.sp(), 0x836f);
        EXPECT(gbc.pc(), 0x6911);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0005
        gbc.setState(0x8346, 0x6d5, 0xc10, 0x5d7c, 0x4ea0, 0x5f7e, 0x0, 0x1);
        gbc.writeMem(0x8346, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xc);
        EXPECT(gbc.b(),  0x5d);
        EXPECT(gbc.c(),  0x7c);
        EXPECT(gbc.d(),  0x4e);
        EXPECT(gbc.e(),  0xa0);
        EXPECT(gbc.h(),  0x5f);
        EXPECT(gbc.l(),  0x7e);
        EXPECT(gbc.sp(), 0x6d5);
        EXPECT(gbc.pc(), 0x8347);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8346), 0x5b);
        // 5B 0006
        gbc.setState(0x9a84, 0x72f, 0xe750, 0x7b0e, 0x7cde, 0x118d, 0x1, 0x1);
        gbc.writeMem(0x9a84, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xe7);
        EXPECT(gbc.b(),  0x7b);
        EXPECT(gbc.c(),  0xe);
        EXPECT(gbc.d(),  0x7c);
        EXPECT(gbc.e(),  0xde);
        EXPECT(gbc.h(),  0x11);
        EXPECT(gbc.l(),  0x8d);
        EXPECT(gbc.sp(), 0x72f);
        EXPECT(gbc.pc(), 0x9a85);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9a84), 0x5b);
        // 5B 0007
        gbc.setState(0x385, 0x95ff, 0x4460, 0xc9b1, 0xd5a8, 0x7d96, 0x0, 0x1);
        gbc.writeMem(0x385, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x44);
        EXPECT(gbc.b(),  0xc9);
        EXPECT(gbc.c(),  0xb1);
        EXPECT(gbc.d(),  0xd5);
        EXPECT(gbc.e(),  0xa8);
        EXPECT(gbc.h(),  0x7d);
        EXPECT(gbc.l(),  0x96);
        EXPECT(gbc.sp(), 0x95ff);
        EXPECT(gbc.pc(), 0x386);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0008
        gbc.setState(0x1478, 0xf3ab, 0x9a70, 0xfc85, 0x3c5a, 0x8602, 0x1, 0x0);
        gbc.writeMem(0x1478, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x9a);
        EXPECT(gbc.b(),  0xfc);
        EXPECT(gbc.c(),  0x85);
        EXPECT(gbc.d(),  0x3c);
        EXPECT(gbc.e(),  0x5a);
        EXPECT(gbc.h(),  0x86);
        EXPECT(gbc.l(),  0x2);
        EXPECT(gbc.sp(), 0xf3ab);
        EXPECT(gbc.pc(), 0x1479);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0009
        gbc.setState(0x9d8c, 0x6a40, 0x3cf0, 0x6110, 0xba05, 0x1e51, 0x1, 0x0);
        gbc.writeMem(0x9d8c, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x3c);
        EXPECT(gbc.b(),  0x61);
        EXPECT(gbc.c(),  0x10);
        EXPECT(gbc.d(),  0xba);
        EXPECT(gbc.e(),  0x5);
        EXPECT(gbc.h(),  0x1e);
        EXPECT(gbc.l(),  0x51);
        EXPECT(gbc.sp(), 0x6a40);
        EXPECT(gbc.pc(), 0x9d8d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9d8c), 0x5b);
        // 5B 000A
        gbc.setState(0x1008, 0x3b5b, 0x4b90, 0x32fc, 0x3643, 0xb2f4, 0x0, 0x1);
        gbc.writeMem(0x1008, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x4b);
        EXPECT(gbc.b(),  0x32);
        EXPECT(gbc.c(),  0xfc);
        EXPECT(gbc.d(),  0x36);
        EXPECT(gbc.e(),  0x43);
        EXPECT(gbc.h(),  0xb2);
        EXPECT(gbc.l(),  0xf4);
        EXPECT(gbc.sp(), 0x3b5b);
        EXPECT(gbc.pc(), 0x1009);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 000B
        gbc.setState(0x2f65, 0xaa5c, 0x28a0, 0x6e7f, 0x8b08, 0x202e, 0x0, 0x0);
        gbc.writeMem(0x2f65, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0x6e);
        EXPECT(gbc.c(),  0x7f);
        EXPECT(gbc.d(),  0x8b);
        EXPECT(gbc.e(),  0x8);
        EXPECT(gbc.h(),  0x20);
        EXPECT(gbc.l(),  0x2e);
        EXPECT(gbc.sp(), 0xaa5c);
        EXPECT(gbc.pc(), 0x2f66);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 000C
        gbc.setState(0x40ff, 0x9233, 0xc100, 0x9fdc, 0x832f, 0x7db9, 0x0, 0x1);
        gbc.writeMem(0x40ff, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xc1);
        EXPECT(gbc.b(),  0x9f);
        EXPECT(gbc.c(),  0xdc);
        EXPECT(gbc.d(),  0x83);
        EXPECT(gbc.e(),  0x2f);
        EXPECT(gbc.h(),  0x7d);
        EXPECT(gbc.l(),  0xb9);
        EXPECT(gbc.sp(), 0x9233);
        EXPECT(gbc.pc(), 0x4100);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 000D
        gbc.setState(0xd991, 0x59d6, 0xc440, 0x649f, 0xe37e, 0x750d, 0x0, 0x0);
        gbc.writeMem(0xd991, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xc4);
        EXPECT(gbc.b(),  0x64);
        EXPECT(gbc.c(),  0x9f);
        EXPECT(gbc.d(),  0xe3);
        EXPECT(gbc.e(),  0x7e);
        EXPECT(gbc.h(),  0x75);
        EXPECT(gbc.l(),  0xd);
        EXPECT(gbc.sp(), 0x59d6);
        EXPECT(gbc.pc(), 0xd992);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd991), 0x5b);
        // 5B 000E
        gbc.setState(0xbc61, 0x1af6, 0x53e0, 0x16dc, 0xe7fd, 0xa753, 0x1, 0x1);
        gbc.writeMem(0xbc61, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x53);
        EXPECT(gbc.b(),  0x16);
        EXPECT(gbc.c(),  0xdc);
        EXPECT(gbc.d(),  0xe7);
        EXPECT(gbc.e(),  0xfd);
        EXPECT(gbc.h(),  0xa7);
        EXPECT(gbc.l(),  0x53);
        EXPECT(gbc.sp(), 0x1af6);
        EXPECT(gbc.pc(), 0xbc62);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbc61), 0x5b);
        // 5B 000F
        gbc.setState(0xa525, 0x7ca2, 0x1af0, 0x2f0a, 0x4193, 0x9295, 0x1, 0x0);
        gbc.writeMem(0xa525, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x1a);
        EXPECT(gbc.b(),  0x2f);
        EXPECT(gbc.c(),  0xa);
        EXPECT(gbc.d(),  0x41);
        EXPECT(gbc.e(),  0x93);
        EXPECT(gbc.h(),  0x92);
        EXPECT(gbc.l(),  0x95);
        EXPECT(gbc.sp(), 0x7ca2);
        EXPECT(gbc.pc(), 0xa526);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa525), 0x5b);
        // 5B 0010
        gbc.setState(0x74da, 0x604, 0xbbe0, 0xcc6f, 0xb8e2, 0xbf7f, 0x1, 0x0);
        gbc.writeMem(0x74da, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xbb);
        EXPECT(gbc.b(),  0xcc);
        EXPECT(gbc.c(),  0x6f);
        EXPECT(gbc.d(),  0xb8);
        EXPECT(gbc.e(),  0xe2);
        EXPECT(gbc.h(),  0xbf);
        EXPECT(gbc.l(),  0x7f);
        EXPECT(gbc.sp(), 0x604);
        EXPECT(gbc.pc(), 0x74db);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0012
        gbc.setState(0x857f, 0x51b6, 0xef50, 0x6989, 0x69fd, 0x6e38, 0x1, 0x1);
        gbc.writeMem(0x857f, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xef);
        EXPECT(gbc.b(),  0x69);
        EXPECT(gbc.c(),  0x89);
        EXPECT(gbc.d(),  0x69);
        EXPECT(gbc.e(),  0xfd);
        EXPECT(gbc.h(),  0x6e);
        EXPECT(gbc.l(),  0x38);
        EXPECT(gbc.sp(), 0x51b6);
        EXPECT(gbc.pc(), 0x8580);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x857f), 0x5b);
        // 5B 0013
        gbc.setState(0x9d05, 0xcdc7, 0x1050, 0x4129, 0xdc2e, 0xea94, 0x0, 0x0);
        gbc.writeMem(0x9d05, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0x41);
        EXPECT(gbc.c(),  0x29);
        EXPECT(gbc.d(),  0xdc);
        EXPECT(gbc.e(),  0x2e);
        EXPECT(gbc.h(),  0xea);
        EXPECT(gbc.l(),  0x94);
        EXPECT(gbc.sp(), 0xcdc7);
        EXPECT(gbc.pc(), 0x9d06);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9d05), 0x5b);
        // 5B 0014
        gbc.setState(0x2513, 0x8d38, 0x1940, 0x2609, 0x375d, 0x9813, 0x1, 0x1);
        gbc.writeMem(0x2513, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x19);
        EXPECT(gbc.b(),  0x26);
        EXPECT(gbc.c(),  0x9);
        EXPECT(gbc.d(),  0x37);
        EXPECT(gbc.e(),  0x5d);
        EXPECT(gbc.h(),  0x98);
        EXPECT(gbc.l(),  0x13);
        EXPECT(gbc.sp(), 0x8d38);
        EXPECT(gbc.pc(), 0x2514);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0015
        gbc.setState(0xb43f, 0xbff9, 0xe5f0, 0xe3ef, 0xf149, 0xb212, 0x1, 0x0);
        gbc.writeMem(0xb43f, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xe5);
        EXPECT(gbc.b(),  0xe3);
        EXPECT(gbc.c(),  0xef);
        EXPECT(gbc.d(),  0xf1);
        EXPECT(gbc.e(),  0x49);
        EXPECT(gbc.h(),  0xb2);
        EXPECT(gbc.l(),  0x12);
        EXPECT(gbc.sp(), 0xbff9);
        EXPECT(gbc.pc(), 0xb440);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb43f), 0x5b);
        // 5B 0016
        gbc.setState(0x5d45, 0xf10a, 0x3a60, 0xe611, 0xe682, 0xcf53, 0x1, 0x1);
        gbc.writeMem(0x5d45, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x3a);
        EXPECT(gbc.b(),  0xe6);
        EXPECT(gbc.c(),  0x11);
        EXPECT(gbc.d(),  0xe6);
        EXPECT(gbc.e(),  0x82);
        EXPECT(gbc.h(),  0xcf);
        EXPECT(gbc.l(),  0x53);
        EXPECT(gbc.sp(), 0xf10a);
        EXPECT(gbc.pc(), 0x5d46);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0017
        gbc.setState(0xe355, 0x176e, 0x35a0, 0xf335, 0x61e4, 0x5361, 0x0, 0x1);
        gbc.writeMem(0xe355, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x35);
        EXPECT(gbc.b(),  0xf3);
        EXPECT(gbc.c(),  0x35);
        EXPECT(gbc.d(),  0x61);
        EXPECT(gbc.e(),  0xe4);
        EXPECT(gbc.h(),  0x53);
        EXPECT(gbc.l(),  0x61);
        EXPECT(gbc.sp(), 0x176e);
        EXPECT(gbc.pc(), 0xe356);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe355), 0x5b);
        // 5B 0018
        gbc.setState(0x5585, 0x9df7, 0xdc10, 0xbb03, 0x1165, 0xdac, 0x0, 0x1);
        gbc.writeMem(0x5585, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xdc);
        EXPECT(gbc.b(),  0xbb);
        EXPECT(gbc.c(),  0x3);
        EXPECT(gbc.d(),  0x11);
        EXPECT(gbc.e(),  0x65);
        EXPECT(gbc.h(),  0xd);
        EXPECT(gbc.l(),  0xac);
        EXPECT(gbc.sp(), 0x9df7);
        EXPECT(gbc.pc(), 0x5586);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 0019
        gbc.setState(0x7778, 0xb489, 0x9060, 0xe3f7, 0xafe4, 0x73e5, 0x1, 0x0);
        gbc.writeMem(0x7778, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x90);
        EXPECT(gbc.b(),  0xe3);
        EXPECT(gbc.c(),  0xf7);
        EXPECT(gbc.d(),  0xaf);
        EXPECT(gbc.e(),  0xe4);
        EXPECT(gbc.h(),  0x73);
        EXPECT(gbc.l(),  0xe5);
        EXPECT(gbc.sp(), 0xb489);
        EXPECT(gbc.pc(), 0x7779);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 001A
        gbc.setState(0x2ba5, 0x2f44, 0xbb60, 0x1568, 0x7908, 0xeac, 0x0, 0x1);
        gbc.writeMem(0x2ba5, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xbb);
        EXPECT(gbc.b(),  0x15);
        EXPECT(gbc.c(),  0x68);
        EXPECT(gbc.d(),  0x79);
        EXPECT(gbc.e(),  0x8);
        EXPECT(gbc.h(),  0xe);
        EXPECT(gbc.l(),  0xac);
        EXPECT(gbc.sp(), 0x2f44);
        EXPECT(gbc.pc(), 0x2ba6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 001B
        gbc.setState(0xd429, 0x99dc, 0x3730, 0xa287, 0xc0fb, 0x95c9, 0x0, 0x1);
        gbc.writeMem(0xd429, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x37);
        EXPECT(gbc.b(),  0xa2);
        EXPECT(gbc.c(),  0x87);
        EXPECT(gbc.d(),  0xc0);
        EXPECT(gbc.e(),  0xfb);
        EXPECT(gbc.h(),  0x95);
        EXPECT(gbc.l(),  0xc9);
        EXPECT(gbc.sp(), 0x99dc);
        EXPECT(gbc.pc(), 0xd42a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd429), 0x5b);
        // 5B 001C
        gbc.setState(0x10ea, 0xf2ee, 0x6ee0, 0x7504, 0x55ae, 0x4077, 0x0, 0x1);
        gbc.writeMem(0x10ea, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x6e);
        EXPECT(gbc.b(),  0x75);
        EXPECT(gbc.c(),  0x4);
        EXPECT(gbc.d(),  0x55);
        EXPECT(gbc.e(),  0xae);
        EXPECT(gbc.h(),  0x40);
        EXPECT(gbc.l(),  0x77);
        EXPECT(gbc.sp(), 0xf2ee);
        EXPECT(gbc.pc(), 0x10eb);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 001D
        gbc.setState(0x953e, 0x917c, 0x8dd0, 0x933f, 0x7383, 0x32f9, 0x1, 0x1);
        gbc.writeMem(0x953e, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x8d);
        EXPECT(gbc.b(),  0x93);
        EXPECT(gbc.c(),  0x3f);
        EXPECT(gbc.d(),  0x73);
        EXPECT(gbc.e(),  0x83);
        EXPECT(gbc.h(),  0x32);
        EXPECT(gbc.l(),  0xf9);
        EXPECT(gbc.sp(), 0x917c);
        EXPECT(gbc.pc(), 0x953f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x953e), 0x5b);
        // 5B 001E
        gbc.setState(0xe545, 0x58f8, 0xf450, 0x49ab, 0xe668, 0xd3bd, 0x0, 0x0);
        gbc.writeMem(0xe545, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf4);
        EXPECT(gbc.b(),  0x49);
        EXPECT(gbc.c(),  0xab);
        EXPECT(gbc.d(),  0xe6);
        EXPECT(gbc.e(),  0x68);
        EXPECT(gbc.h(),  0xd3);
        EXPECT(gbc.l(),  0xbd);
        EXPECT(gbc.sp(), 0x58f8);
        EXPECT(gbc.pc(), 0xe546);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe545), 0x5b);
        // 5B 001F
        gbc.setState(0x6ca2, 0xd03c, 0x5670, 0x738a, 0x4d81, 0xa5ba, 0x0, 0x0);
        gbc.writeMem(0x6ca2, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x56);
        EXPECT(gbc.b(),  0x73);
        EXPECT(gbc.c(),  0x8a);
        EXPECT(gbc.d(),  0x4d);
        EXPECT(gbc.e(),  0x81);
        EXPECT(gbc.h(),  0xa5);
        EXPECT(gbc.l(),  0xba);
        EXPECT(gbc.sp(), 0xd03c);
        EXPECT(gbc.pc(), 0x6ca3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0020
        gbc.setState(0x358a, 0x155d, 0xf390, 0x3f0, 0x8bf, 0x4acc, 0x0, 0x1);
        gbc.writeMem(0x358a, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf3);
        EXPECT(gbc.b(),  0x3);
        EXPECT(gbc.c(),  0xf0);
        EXPECT(gbc.d(),  0x8);
        EXPECT(gbc.e(),  0xbf);
        EXPECT(gbc.h(),  0x4a);
        EXPECT(gbc.l(),  0xcc);
        EXPECT(gbc.sp(), 0x155d);
        EXPECT(gbc.pc(), 0x358b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 0021
        gbc.setState(0xd83, 0x29db, 0x4db0, 0xf224, 0xa67, 0x9802, 0x0, 0x1);
        gbc.writeMem(0xd83, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x4d);
        EXPECT(gbc.b(),  0xf2);
        EXPECT(gbc.c(),  0x24);
        EXPECT(gbc.d(),  0xa);
        EXPECT(gbc.e(),  0x67);
        EXPECT(gbc.h(),  0x98);
        EXPECT(gbc.l(),  0x2);
        EXPECT(gbc.sp(), 0x29db);
        EXPECT(gbc.pc(), 0xd84);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0022
        gbc.setState(0x1e98, 0x540, 0x950, 0x45b2, 0x861a, 0x5af8, 0x1, 0x1);
        gbc.writeMem(0x1e98, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x9);
        EXPECT(gbc.b(),  0x45);
        EXPECT(gbc.c(),  0xb2);
        EXPECT(gbc.d(),  0x86);
        EXPECT(gbc.e(),  0x1a);
        EXPECT(gbc.h(),  0x5a);
        EXPECT(gbc.l(),  0xf8);
        EXPECT(gbc.sp(), 0x540);
        EXPECT(gbc.pc(), 0x1e99);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 0023
        gbc.setState(0xc960, 0x2cb2, 0x2d0, 0xeec9, 0xd968, 0x8ae0, 0x1, 0x1);
        gbc.writeMem(0xc960, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0xee);
        EXPECT(gbc.c(),  0xc9);
        EXPECT(gbc.d(),  0xd9);
        EXPECT(gbc.e(),  0x68);
        EXPECT(gbc.h(),  0x8a);
        EXPECT(gbc.l(),  0xe0);
        EXPECT(gbc.sp(), 0x2cb2);
        EXPECT(gbc.pc(), 0xc961);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc960), 0x5b);
        // 5B 0024
        gbc.setState(0x6e99, 0x6ab9, 0xc290, 0xbc1e, 0x7653, 0xe99d, 0x1, 0x1);
        gbc.writeMem(0x6e99, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xc2);
        EXPECT(gbc.b(),  0xbc);
        EXPECT(gbc.c(),  0x1e);
        EXPECT(gbc.d(),  0x76);
        EXPECT(gbc.e(),  0x53);
        EXPECT(gbc.h(),  0xe9);
        EXPECT(gbc.l(),  0x9d);
        EXPECT(gbc.sp(), 0x6ab9);
        EXPECT(gbc.pc(), 0x6e9a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 0025
        gbc.setState(0xcbbf, 0xecf4, 0xb1f0, 0x5c4, 0x58e4, 0x41eb, 0x1, 0x0);
        gbc.writeMem(0xcbbf, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xb1);
        EXPECT(gbc.b(),  0x5);
        EXPECT(gbc.c(),  0xc4);
        EXPECT(gbc.d(),  0x58);
        EXPECT(gbc.e(),  0xe4);
        EXPECT(gbc.h(),  0x41);
        EXPECT(gbc.l(),  0xeb);
        EXPECT(gbc.sp(), 0xecf4);
        EXPECT(gbc.pc(), 0xcbc0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcbbf), 0x5b);
        // 5B 0026
        gbc.setState(0x83f2, 0xec1, 0xd2d0, 0xd837, 0x56af, 0x39ec, 0x1, 0x1);
        gbc.writeMem(0x83f2, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd2);
        EXPECT(gbc.b(),  0xd8);
        EXPECT(gbc.c(),  0x37);
        EXPECT(gbc.d(),  0x56);
        EXPECT(gbc.e(),  0xaf);
        EXPECT(gbc.h(),  0x39);
        EXPECT(gbc.l(),  0xec);
        EXPECT(gbc.sp(), 0xec1);
        EXPECT(gbc.pc(), 0x83f3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x83f2), 0x5b);
        // 5B 0027
        gbc.setState(0x2db9, 0x12b2, 0xc00, 0x6ce3, 0x8882, 0x962c, 0x1, 0x1);
        gbc.writeMem(0x2db9, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xc);
        EXPECT(gbc.b(),  0x6c);
        EXPECT(gbc.c(),  0xe3);
        EXPECT(gbc.d(),  0x88);
        EXPECT(gbc.e(),  0x82);
        EXPECT(gbc.h(),  0x96);
        EXPECT(gbc.l(),  0x2c);
        EXPECT(gbc.sp(), 0x12b2);
        EXPECT(gbc.pc(), 0x2dba);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0028
        gbc.setState(0xe85f, 0x705f, 0x2d0, 0x523f, 0x4994, 0x95bd, 0x0, 0x1);
        gbc.writeMem(0xe85f, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0x52);
        EXPECT(gbc.c(),  0x3f);
        EXPECT(gbc.d(),  0x49);
        EXPECT(gbc.e(),  0x94);
        EXPECT(gbc.h(),  0x95);
        EXPECT(gbc.l(),  0xbd);
        EXPECT(gbc.sp(), 0x705f);
        EXPECT(gbc.pc(), 0xe860);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe85f), 0x5b);
        // 5B 0029
        gbc.setState(0xce8e, 0xc7ba, 0xdcb0, 0xe3b, 0x64d1, 0x7492, 0x0, 0x1);
        gbc.writeMem(0xce8e, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xdc);
        EXPECT(gbc.b(),  0xe);
        EXPECT(gbc.c(),  0x3b);
        EXPECT(gbc.d(),  0x64);
        EXPECT(gbc.e(),  0xd1);
        EXPECT(gbc.h(),  0x74);
        EXPECT(gbc.l(),  0x92);
        EXPECT(gbc.sp(), 0xc7ba);
        EXPECT(gbc.pc(), 0xce8f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xce8e), 0x5b);
        // 5B 002A
        gbc.setState(0x157a, 0x9141, 0x7e20, 0xc58e, 0x6089, 0x1996, 0x0, 0x0);
        gbc.writeMem(0x157a, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x7e);
        EXPECT(gbc.b(),  0xc5);
        EXPECT(gbc.c(),  0x8e);
        EXPECT(gbc.d(),  0x60);
        EXPECT(gbc.e(),  0x89);
        EXPECT(gbc.h(),  0x19);
        EXPECT(gbc.l(),  0x96);
        EXPECT(gbc.sp(), 0x9141);
        EXPECT(gbc.pc(), 0x157b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 002C
        gbc.setState(0xa7d0, 0xaee8, 0xc350, 0x96f, 0x4248, 0x4a32, 0x1, 0x1);
        gbc.writeMem(0xa7d0, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xc3);
        EXPECT(gbc.b(),  0x9);
        EXPECT(gbc.c(),  0x6f);
        EXPECT(gbc.d(),  0x42);
        EXPECT(gbc.e(),  0x48);
        EXPECT(gbc.h(),  0x4a);
        EXPECT(gbc.l(),  0x32);
        EXPECT(gbc.sp(), 0xaee8);
        EXPECT(gbc.pc(), 0xa7d1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa7d0), 0x5b);
        // 5B 002D
        gbc.setState(0x3bbb, 0xefe3, 0x43b0, 0xaac5, 0x7285, 0x6d7c, 0x1, 0x1);
        gbc.writeMem(0x3bbb, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x43);
        EXPECT(gbc.b(),  0xaa);
        EXPECT(gbc.c(),  0xc5);
        EXPECT(gbc.d(),  0x72);
        EXPECT(gbc.e(),  0x85);
        EXPECT(gbc.h(),  0x6d);
        EXPECT(gbc.l(),  0x7c);
        EXPECT(gbc.sp(), 0xefe3);
        EXPECT(gbc.pc(), 0x3bbc);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 002E
        gbc.setState(0xb74f, 0xff1e, 0xf2b0, 0xe126, 0x875d, 0x9431, 0x0, 0x1);
        gbc.writeMem(0xb74f, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf2);
        EXPECT(gbc.b(),  0xe1);
        EXPECT(gbc.c(),  0x26);
        EXPECT(gbc.d(),  0x87);
        EXPECT(gbc.e(),  0x5d);
        EXPECT(gbc.h(),  0x94);
        EXPECT(gbc.l(),  0x31);
        EXPECT(gbc.sp(), 0xff1e);
        EXPECT(gbc.pc(), 0xb750);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb74f), 0x5b);
        // 5B 002F
        gbc.setState(0x7b84, 0x4be5, 0x2740, 0x2fb7, 0x2d1, 0x836e, 0x0, 0x1);
        gbc.writeMem(0x7b84, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x27);
        EXPECT(gbc.b(),  0x2f);
        EXPECT(gbc.c(),  0xb7);
        EXPECT(gbc.d(),  0x2);
        EXPECT(gbc.e(),  0xd1);
        EXPECT(gbc.h(),  0x83);
        EXPECT(gbc.l(),  0x6e);
        EXPECT(gbc.sp(), 0x4be5);
        EXPECT(gbc.pc(), 0x7b85);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0030
        gbc.setState(0x68bc, 0x4977, 0x7280, 0xbd4e, 0xddbe, 0x232a, 0x0, 0x1);
        gbc.writeMem(0x68bc, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x72);
        EXPECT(gbc.b(),  0xbd);
        EXPECT(gbc.c(),  0x4e);
        EXPECT(gbc.d(),  0xdd);
        EXPECT(gbc.e(),  0xbe);
        EXPECT(gbc.h(),  0x23);
        EXPECT(gbc.l(),  0x2a);
        EXPECT(gbc.sp(), 0x4977);
        EXPECT(gbc.pc(), 0x68bd);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0032
        gbc.setState(0x924, 0xfa23, 0xf00, 0x48ed, 0xa256, 0x1ea1, 0x1, 0x0);
        gbc.writeMem(0x924, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf);
        EXPECT(gbc.b(),  0x48);
        EXPECT(gbc.c(),  0xed);
        EXPECT(gbc.d(),  0xa2);
        EXPECT(gbc.e(),  0x56);
        EXPECT(gbc.h(),  0x1e);
        EXPECT(gbc.l(),  0xa1);
        EXPECT(gbc.sp(), 0xfa23);
        EXPECT(gbc.pc(), 0x925);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0033
        gbc.setState(0x3e65, 0x2981, 0xb660, 0x25f, 0x13e2, 0x8cee, 0x0, 0x1);
        gbc.writeMem(0x3e65, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xb6);
        EXPECT(gbc.b(),  0x2);
        EXPECT(gbc.c(),  0x5f);
        EXPECT(gbc.d(),  0x13);
        EXPECT(gbc.e(),  0xe2);
        EXPECT(gbc.h(),  0x8c);
        EXPECT(gbc.l(),  0xee);
        EXPECT(gbc.sp(), 0x2981);
        EXPECT(gbc.pc(), 0x3e66);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0034
        gbc.setState(0x9e06, 0x3517, 0xdd30, 0x3eba, 0x9b33, 0x482f, 0x1, 0x0);
        gbc.writeMem(0x9e06, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xdd);
        EXPECT(gbc.b(),  0x3e);
        EXPECT(gbc.c(),  0xba);
        EXPECT(gbc.d(),  0x9b);
        EXPECT(gbc.e(),  0x33);
        EXPECT(gbc.h(),  0x48);
        EXPECT(gbc.l(),  0x2f);
        EXPECT(gbc.sp(), 0x3517);
        EXPECT(gbc.pc(), 0x9e07);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9e06), 0x5b);
        // 5B 0035
        gbc.setState(0x9a85, 0x2a5e, 0x7af0, 0xb69b, 0xd6ba, 0x185a, 0x1, 0x1);
        gbc.writeMem(0x9a85, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x7a);
        EXPECT(gbc.b(),  0xb6);
        EXPECT(gbc.c(),  0x9b);
        EXPECT(gbc.d(),  0xd6);
        EXPECT(gbc.e(),  0xba);
        EXPECT(gbc.h(),  0x18);
        EXPECT(gbc.l(),  0x5a);
        EXPECT(gbc.sp(), 0x2a5e);
        EXPECT(gbc.pc(), 0x9a86);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9a85), 0x5b);
        // 5B 0036
        gbc.setState(0x5456, 0xad28, 0x7830, 0x46e5, 0x62a1, 0x5149, 0x0, 0x0);
        gbc.writeMem(0x5456, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x78);
        EXPECT(gbc.b(),  0x46);
        EXPECT(gbc.c(),  0xe5);
        EXPECT(gbc.d(),  0x62);
        EXPECT(gbc.e(),  0xa1);
        EXPECT(gbc.h(),  0x51);
        EXPECT(gbc.l(),  0x49);
        EXPECT(gbc.sp(), 0xad28);
        EXPECT(gbc.pc(), 0x5457);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0037
        gbc.setState(0xb684, 0x922a, 0x4c10, 0x94b5, 0x4f3b, 0x8005, 0x1, 0x0);
        gbc.writeMem(0xb684, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x4c);
        EXPECT(gbc.b(),  0x94);
        EXPECT(gbc.c(),  0xb5);
        EXPECT(gbc.d(),  0x4f);
        EXPECT(gbc.e(),  0x3b);
        EXPECT(gbc.h(),  0x80);
        EXPECT(gbc.l(),  0x5);
        EXPECT(gbc.sp(), 0x922a);
        EXPECT(gbc.pc(), 0xb685);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb684), 0x5b);
        // 5B 0038
        gbc.setState(0xe763, 0xf761, 0x9d40, 0x45d, 0x8fa6, 0xfaf4, 0x1, 0x1);
        gbc.writeMem(0xe763, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x9d);
        EXPECT(gbc.b(),  0x4);
        EXPECT(gbc.c(),  0x5d);
        EXPECT(gbc.d(),  0x8f);
        EXPECT(gbc.e(),  0xa6);
        EXPECT(gbc.h(),  0xfa);
        EXPECT(gbc.l(),  0xf4);
        EXPECT(gbc.sp(), 0xf761);
        EXPECT(gbc.pc(), 0xe764);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe763), 0x5b);
        // 5B 0039
        gbc.setState(0xbbbf, 0x3999, 0xd90, 0x6749, 0x89d3, 0x494, 0x0, 0x1);
        gbc.writeMem(0xbbbf, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd);
        EXPECT(gbc.b(),  0x67);
        EXPECT(gbc.c(),  0x49);
        EXPECT(gbc.d(),  0x89);
        EXPECT(gbc.e(),  0xd3);
        EXPECT(gbc.h(),  0x4);
        EXPECT(gbc.l(),  0x94);
        EXPECT(gbc.sp(), 0x3999);
        EXPECT(gbc.pc(), 0xbbc0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbbbf), 0x5b);
        // 5B 003A
        gbc.setState(0xa9d2, 0x8111, 0xf40, 0x6118, 0x8940, 0xba96, 0x0, 0x1);
        gbc.writeMem(0xa9d2, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf);
        EXPECT(gbc.b(),  0x61);
        EXPECT(gbc.c(),  0x18);
        EXPECT(gbc.d(),  0x89);
        EXPECT(gbc.e(),  0x40);
        EXPECT(gbc.h(),  0xba);
        EXPECT(gbc.l(),  0x96);
        EXPECT(gbc.sp(), 0x8111);
        EXPECT(gbc.pc(), 0xa9d3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa9d2), 0x5b);
        // 5B 003B
        gbc.setState(0x65ff, 0x94e9, 0xbef0, 0xc81a, 0x363b, 0xd5f3, 0x1, 0x1);
        gbc.writeMem(0x65ff, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xbe);
        EXPECT(gbc.b(),  0xc8);
        EXPECT(gbc.c(),  0x1a);
        EXPECT(gbc.d(),  0x36);
        EXPECT(gbc.e(),  0x3b);
        EXPECT(gbc.h(),  0xd5);
        EXPECT(gbc.l(),  0xf3);
        EXPECT(gbc.sp(), 0x94e9);
        EXPECT(gbc.pc(), 0x6600);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 003C
        gbc.setState(0x894d, 0xa62e, 0x94b0, 0xf6d0, 0xce17, 0x5755, 0x0, 0x0);
        gbc.writeMem(0x894d, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x94);
        EXPECT(gbc.b(),  0xf6);
        EXPECT(gbc.c(),  0xd0);
        EXPECT(gbc.d(),  0xce);
        EXPECT(gbc.e(),  0x17);
        EXPECT(gbc.h(),  0x57);
        EXPECT(gbc.l(),  0x55);
        EXPECT(gbc.sp(), 0xa62e);
        EXPECT(gbc.pc(), 0x894e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x894d), 0x5b);
        // 5B 003D
        gbc.setState(0x6487, 0x4152, 0x41d0, 0x89c8, 0x3988, 0x6978, 0x1, 0x1);
        gbc.writeMem(0x6487, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x41);
        EXPECT(gbc.b(),  0x89);
        EXPECT(gbc.c(),  0xc8);
        EXPECT(gbc.d(),  0x39);
        EXPECT(gbc.e(),  0x88);
        EXPECT(gbc.h(),  0x69);
        EXPECT(gbc.l(),  0x78);
        EXPECT(gbc.sp(), 0x4152);
        EXPECT(gbc.pc(), 0x6488);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 003E
        gbc.setState(0x854a, 0xffe3, 0x4e90, 0x5b6f, 0xb6d, 0x98f2, 0x1, 0x0);
        gbc.writeMem(0x854a, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x4e);
        EXPECT(gbc.b(),  0x5b);
        EXPECT(gbc.c(),  0x6f);
        EXPECT(gbc.d(),  0xb);
        EXPECT(gbc.e(),  0x6d);
        EXPECT(gbc.h(),  0x98);
        EXPECT(gbc.l(),  0xf2);
        EXPECT(gbc.sp(), 0xffe3);
        EXPECT(gbc.pc(), 0x854b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x854a), 0x5b);
        // 5B 003F
        gbc.setState(0x7d15, 0x1aa7, 0x9b50, 0x5640, 0xc98f, 0xb14d, 0x1, 0x1);
        gbc.writeMem(0x7d15, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x9b);
        EXPECT(gbc.b(),  0x56);
        EXPECT(gbc.c(),  0x40);
        EXPECT(gbc.d(),  0xc9);
        EXPECT(gbc.e(),  0x8f);
        EXPECT(gbc.h(),  0xb1);
        EXPECT(gbc.l(),  0x4d);
        EXPECT(gbc.sp(), 0x1aa7);
        EXPECT(gbc.pc(), 0x7d16);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 0040
        gbc.setState(0x8a38, 0x77eb, 0xa260, 0xcf7f, 0x45f0, 0x52e1, 0x1, 0x1);
        gbc.writeMem(0x8a38, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa2);
        EXPECT(gbc.b(),  0xcf);
        EXPECT(gbc.c(),  0x7f);
        EXPECT(gbc.d(),  0x45);
        EXPECT(gbc.e(),  0xf0);
        EXPECT(gbc.h(),  0x52);
        EXPECT(gbc.l(),  0xe1);
        EXPECT(gbc.sp(), 0x77eb);
        EXPECT(gbc.pc(), 0x8a39);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8a38), 0x5b);
        // 5B 0041
        gbc.setState(0x3647, 0x434d, 0x4950, 0xdc3b, 0xf51c, 0x419b, 0x1, 0x1);
        gbc.writeMem(0x3647, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x49);
        EXPECT(gbc.b(),  0xdc);
        EXPECT(gbc.c(),  0x3b);
        EXPECT(gbc.d(),  0xf5);
        EXPECT(gbc.e(),  0x1c);
        EXPECT(gbc.h(),  0x41);
        EXPECT(gbc.l(),  0x9b);
        EXPECT(gbc.sp(), 0x434d);
        EXPECT(gbc.pc(), 0x3648);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 0042
        gbc.setState(0x1ac0, 0x7b04, 0x860, 0xb954, 0xf682, 0x9ff5, 0x0, 0x0);
        gbc.writeMem(0x1ac0, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0xb9);
        EXPECT(gbc.c(),  0x54);
        EXPECT(gbc.d(),  0xf6);
        EXPECT(gbc.e(),  0x82);
        EXPECT(gbc.h(),  0x9f);
        EXPECT(gbc.l(),  0xf5);
        EXPECT(gbc.sp(), 0x7b04);
        EXPECT(gbc.pc(), 0x1ac1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0043
        gbc.setState(0x9be5, 0x45ab, 0xffe0, 0x442a, 0x5564, 0x42, 0x0, 0x0);
        gbc.writeMem(0x9be5, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xff);
        EXPECT(gbc.b(),  0x44);
        EXPECT(gbc.c(),  0x2a);
        EXPECT(gbc.d(),  0x55);
        EXPECT(gbc.e(),  0x64);
        EXPECT(gbc.h(),  0x0);
        EXPECT(gbc.l(),  0x42);
        EXPECT(gbc.sp(), 0x45ab);
        EXPECT(gbc.pc(), 0x9be6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9be5), 0x5b);
        // 5B 0044
        gbc.setState(0xbf9e, 0xbf31, 0xa4a0, 0xd604, 0x50b7, 0xd932, 0x0, 0x1);
        gbc.writeMem(0xbf9e, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa4);
        EXPECT(gbc.b(),  0xd6);
        EXPECT(gbc.c(),  0x4);
        EXPECT(gbc.d(),  0x50);
        EXPECT(gbc.e(),  0xb7);
        EXPECT(gbc.h(),  0xd9);
        EXPECT(gbc.l(),  0x32);
        EXPECT(gbc.sp(), 0xbf31);
        EXPECT(gbc.pc(), 0xbf9f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbf9e), 0x5b);
        // 5B 0045
        gbc.setState(0xd41b, 0xb954, 0x4fb0, 0x59bb, 0x1488, 0x3361, 0x1, 0x0);
        gbc.writeMem(0xd41b, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x4f);
        EXPECT(gbc.b(),  0x59);
        EXPECT(gbc.c(),  0xbb);
        EXPECT(gbc.d(),  0x14);
        EXPECT(gbc.e(),  0x88);
        EXPECT(gbc.h(),  0x33);
        EXPECT(gbc.l(),  0x61);
        EXPECT(gbc.sp(), 0xb954);
        EXPECT(gbc.pc(), 0xd41c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd41b), 0x5b);
        // 5B 0046
        gbc.setState(0xb5be, 0xeb34, 0x4d70, 0x426e, 0x2aa0, 0xede6, 0x0, 0x1);
        gbc.writeMem(0xb5be, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x4d);
        EXPECT(gbc.b(),  0x42);
        EXPECT(gbc.c(),  0x6e);
        EXPECT(gbc.d(),  0x2a);
        EXPECT(gbc.e(),  0xa0);
        EXPECT(gbc.h(),  0xed);
        EXPECT(gbc.l(),  0xe6);
        EXPECT(gbc.sp(), 0xeb34);
        EXPECT(gbc.pc(), 0xb5bf);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb5be), 0x5b);
        // 5B 0047
        gbc.setState(0x7038, 0x4a44, 0x8990, 0xf17c, 0x8881, 0x48f0, 0x0, 0x1);
        gbc.writeMem(0x7038, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x89);
        EXPECT(gbc.b(),  0xf1);
        EXPECT(gbc.c(),  0x7c);
        EXPECT(gbc.d(),  0x88);
        EXPECT(gbc.e(),  0x81);
        EXPECT(gbc.h(),  0x48);
        EXPECT(gbc.l(),  0xf0);
        EXPECT(gbc.sp(), 0x4a44);
        EXPECT(gbc.pc(), 0x7039);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 0048
        gbc.setState(0xdc94, 0xae46, 0x49b0, 0xb134, 0x2eb6, 0x6205, 0x0, 0x1);
        gbc.writeMem(0xdc94, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x49);
        EXPECT(gbc.b(),  0xb1);
        EXPECT(gbc.c(),  0x34);
        EXPECT(gbc.d(),  0x2e);
        EXPECT(gbc.e(),  0xb6);
        EXPECT(gbc.h(),  0x62);
        EXPECT(gbc.l(),  0x5);
        EXPECT(gbc.sp(), 0xae46);
        EXPECT(gbc.pc(), 0xdc95);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xdc94), 0x5b);
        // 5B 0049
        gbc.setState(0xade3, 0xe00a, 0xe1d0, 0xe6f6, 0x36b9, 0x719c, 0x0, 0x0);
        gbc.writeMem(0xade3, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xe1);
        EXPECT(gbc.b(),  0xe6);
        EXPECT(gbc.c(),  0xf6);
        EXPECT(gbc.d(),  0x36);
        EXPECT(gbc.e(),  0xb9);
        EXPECT(gbc.h(),  0x71);
        EXPECT(gbc.l(),  0x9c);
        EXPECT(gbc.sp(), 0xe00a);
        EXPECT(gbc.pc(), 0xade4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xade3), 0x5b);
        // 5B 004A
        gbc.setState(0x5533, 0xcd4d, 0xa5e0, 0x4850, 0xa4a3, 0x257, 0x0, 0x1);
        gbc.writeMem(0x5533, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa5);
        EXPECT(gbc.b(),  0x48);
        EXPECT(gbc.c(),  0x50);
        EXPECT(gbc.d(),  0xa4);
        EXPECT(gbc.e(),  0xa3);
        EXPECT(gbc.h(),  0x2);
        EXPECT(gbc.l(),  0x57);
        EXPECT(gbc.sp(), 0xcd4d);
        EXPECT(gbc.pc(), 0x5534);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 004B
        gbc.setState(0x84ab, 0x1604, 0xe810, 0x727e, 0x1afc, 0x6bd3, 0x1, 0x0);
        gbc.writeMem(0x84ab, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xe8);
        EXPECT(gbc.b(),  0x72);
        EXPECT(gbc.c(),  0x7e);
        EXPECT(gbc.d(),  0x1a);
        EXPECT(gbc.e(),  0xfc);
        EXPECT(gbc.h(),  0x6b);
        EXPECT(gbc.l(),  0xd3);
        EXPECT(gbc.sp(), 0x1604);
        EXPECT(gbc.pc(), 0x84ac);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x84ab), 0x5b);
        // 5B 004C
        gbc.setState(0xd6e2, 0x65f5, 0xfc30, 0x67b9, 0x770c, 0x9fec, 0x1, 0x1);
        gbc.writeMem(0xd6e2, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xfc);
        EXPECT(gbc.b(),  0x67);
        EXPECT(gbc.c(),  0xb9);
        EXPECT(gbc.d(),  0x77);
        EXPECT(gbc.e(),  0xc);
        EXPECT(gbc.h(),  0x9f);
        EXPECT(gbc.l(),  0xec);
        EXPECT(gbc.sp(), 0x65f5);
        EXPECT(gbc.pc(), 0xd6e3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd6e2), 0x5b);
        // 5B 004D
        gbc.setState(0x7e45, 0x59a2, 0xe670, 0xdbb6, 0x5a8d, 0x1448, 0x1, 0x0);
        gbc.writeMem(0x7e45, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xe6);
        EXPECT(gbc.b(),  0xdb);
        EXPECT(gbc.c(),  0xb6);
        EXPECT(gbc.d(),  0x5a);
        EXPECT(gbc.e(),  0x8d);
        EXPECT(gbc.h(),  0x14);
        EXPECT(gbc.l(),  0x48);
        EXPECT(gbc.sp(), 0x59a2);
        EXPECT(gbc.pc(), 0x7e46);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 004E
        gbc.setState(0x5d86, 0xd91f, 0x67b0, 0xac0b, 0xaff8, 0x5bb8, 0x0, 0x1);
        gbc.writeMem(0x5d86, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x67);
        EXPECT(gbc.b(),  0xac);
        EXPECT(gbc.c(),  0xb);
        EXPECT(gbc.d(),  0xaf);
        EXPECT(gbc.e(),  0xf8);
        EXPECT(gbc.h(),  0x5b);
        EXPECT(gbc.l(),  0xb8);
        EXPECT(gbc.sp(), 0xd91f);
        EXPECT(gbc.pc(), 0x5d87);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 004F
        gbc.setState(0x24ba, 0xc705, 0x2db0, 0xa895, 0xf3ee, 0x6137, 0x1, 0x0);
        gbc.writeMem(0x24ba, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x2d);
        EXPECT(gbc.b(),  0xa8);
        EXPECT(gbc.c(),  0x95);
        EXPECT(gbc.d(),  0xf3);
        EXPECT(gbc.e(),  0xee);
        EXPECT(gbc.h(),  0x61);
        EXPECT(gbc.l(),  0x37);
        EXPECT(gbc.sp(), 0xc705);
        EXPECT(gbc.pc(), 0x24bb);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0050
        gbc.setState(0x1aea, 0x245, 0x8d20, 0x859a, 0xdb03, 0x3dcc, 0x0, 0x0);
        gbc.writeMem(0x1aea, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x8d);
        EXPECT(gbc.b(),  0x85);
        EXPECT(gbc.c(),  0x9a);
        EXPECT(gbc.d(),  0xdb);
        EXPECT(gbc.e(),  0x3);
        EXPECT(gbc.h(),  0x3d);
        EXPECT(gbc.l(),  0xcc);
        EXPECT(gbc.sp(), 0x245);
        EXPECT(gbc.pc(), 0x1aeb);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0051
        gbc.setState(0x7b76, 0x6dcb, 0xcec0, 0xe22, 0xb6e9, 0x9053, 0x1, 0x0);
        gbc.writeMem(0x7b76, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xce);
        EXPECT(gbc.b(),  0xe);
        EXPECT(gbc.c(),  0x22);
        EXPECT(gbc.d(),  0xb6);
        EXPECT(gbc.e(),  0xe9);
        EXPECT(gbc.h(),  0x90);
        EXPECT(gbc.l(),  0x53);
        EXPECT(gbc.sp(), 0x6dcb);
        EXPECT(gbc.pc(), 0x7b77);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0052
        gbc.setState(0xd2be, 0x1b0a, 0x2940, 0x281c, 0x963c, 0xae78, 0x0, 0x0);
        gbc.writeMem(0xd2be, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x29);
        EXPECT(gbc.b(),  0x28);
        EXPECT(gbc.c(),  0x1c);
        EXPECT(gbc.d(),  0x96);
        EXPECT(gbc.e(),  0x3c);
        EXPECT(gbc.h(),  0xae);
        EXPECT(gbc.l(),  0x78);
        EXPECT(gbc.sp(), 0x1b0a);
        EXPECT(gbc.pc(), 0xd2bf);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd2be), 0x5b);
        // 5B 0053
        gbc.setState(0x24e3, 0xe204, 0xa9d0, 0x1062, 0x149b, 0xf73d, 0x0, 0x0);
        gbc.writeMem(0x24e3, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa9);
        EXPECT(gbc.b(),  0x10);
        EXPECT(gbc.c(),  0x62);
        EXPECT(gbc.d(),  0x14);
        EXPECT(gbc.e(),  0x9b);
        EXPECT(gbc.h(),  0xf7);
        EXPECT(gbc.l(),  0x3d);
        EXPECT(gbc.sp(), 0xe204);
        EXPECT(gbc.pc(), 0x24e4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 0054
        gbc.setState(0xd9d2, 0x7d10, 0x9fa0, 0x18ef, 0x3a5d, 0x19cf, 0x1, 0x1);
        gbc.writeMem(0xd9d2, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x9f);
        EXPECT(gbc.b(),  0x18);
        EXPECT(gbc.c(),  0xef);
        EXPECT(gbc.d(),  0x3a);
        EXPECT(gbc.e(),  0x5d);
        EXPECT(gbc.h(),  0x19);
        EXPECT(gbc.l(),  0xcf);
        EXPECT(gbc.sp(), 0x7d10);
        EXPECT(gbc.pc(), 0xd9d3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd9d2), 0x5b);
        // 5B 0056
        gbc.setState(0x41e2, 0x7cc2, 0x2580, 0x62f9, 0x2ed0, 0x1c8c, 0x0, 0x0);
        gbc.writeMem(0x41e2, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x25);
        EXPECT(gbc.b(),  0x62);
        EXPECT(gbc.c(),  0xf9);
        EXPECT(gbc.d(),  0x2e);
        EXPECT(gbc.e(),  0xd0);
        EXPECT(gbc.h(),  0x1c);
        EXPECT(gbc.l(),  0x8c);
        EXPECT(gbc.sp(), 0x7cc2);
        EXPECT(gbc.pc(), 0x41e3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0057
        gbc.setState(0x6ee9, 0x9734, 0x68d0, 0x9430, 0xdf66, 0x656c, 0x1, 0x0);
        gbc.writeMem(0x6ee9, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x68);
        EXPECT(gbc.b(),  0x94);
        EXPECT(gbc.c(),  0x30);
        EXPECT(gbc.d(),  0xdf);
        EXPECT(gbc.e(),  0x66);
        EXPECT(gbc.h(),  0x65);
        EXPECT(gbc.l(),  0x6c);
        EXPECT(gbc.sp(), 0x9734);
        EXPECT(gbc.pc(), 0x6eea);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 0058
        gbc.setState(0x6bc6, 0x5d96, 0x8670, 0xa5a0, 0x8b23, 0x80d7, 0x0, 0x0);
        gbc.writeMem(0x6bc6, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x86);
        EXPECT(gbc.b(),  0xa5);
        EXPECT(gbc.c(),  0xa0);
        EXPECT(gbc.d(),  0x8b);
        EXPECT(gbc.e(),  0x23);
        EXPECT(gbc.h(),  0x80);
        EXPECT(gbc.l(),  0xd7);
        EXPECT(gbc.sp(), 0x5d96);
        EXPECT(gbc.pc(), 0x6bc7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0059
        gbc.setState(0xe717, 0x19af, 0xffd0, 0x4216, 0xee38, 0x79f2, 0x1, 0x1);
        gbc.writeMem(0xe717, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xff);
        EXPECT(gbc.b(),  0x42);
        EXPECT(gbc.c(),  0x16);
        EXPECT(gbc.d(),  0xee);
        EXPECT(gbc.e(),  0x38);
        EXPECT(gbc.h(),  0x79);
        EXPECT(gbc.l(),  0xf2);
        EXPECT(gbc.sp(), 0x19af);
        EXPECT(gbc.pc(), 0xe718);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe717), 0x5b);
        // 5B 005A
        gbc.setState(0x2e67, 0xb492, 0x4de0, 0xc2d5, 0xfc87, 0xa907, 0x1, 0x0);
        gbc.writeMem(0x2e67, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x4d);
        EXPECT(gbc.b(),  0xc2);
        EXPECT(gbc.c(),  0xd5);
        EXPECT(gbc.d(),  0xfc);
        EXPECT(gbc.e(),  0x87);
        EXPECT(gbc.h(),  0xa9);
        EXPECT(gbc.l(),  0x7);
        EXPECT(gbc.sp(), 0xb492);
        EXPECT(gbc.pc(), 0x2e68);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 005B
        gbc.setState(0x7d9c, 0x6fdb, 0xe80, 0xe725, 0x6805, 0xa8d8, 0x1, 0x1);
        gbc.writeMem(0x7d9c, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xe);
        EXPECT(gbc.b(),  0xe7);
        EXPECT(gbc.c(),  0x25);
        EXPECT(gbc.d(),  0x68);
        EXPECT(gbc.e(),  0x5);
        EXPECT(gbc.h(),  0xa8);
        EXPECT(gbc.l(),  0xd8);
        EXPECT(gbc.sp(), 0x6fdb);
        EXPECT(gbc.pc(), 0x7d9d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 005C
        gbc.setState(0xdf77, 0x7446, 0xb650, 0x600b, 0x1dd5, 0xd338, 0x0, 0x0);
        gbc.writeMem(0xdf77, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xb6);
        EXPECT(gbc.b(),  0x60);
        EXPECT(gbc.c(),  0xb);
        EXPECT(gbc.d(),  0x1d);
        EXPECT(gbc.e(),  0xd5);
        EXPECT(gbc.h(),  0xd3);
        EXPECT(gbc.l(),  0x38);
        EXPECT(gbc.sp(), 0x7446);
        EXPECT(gbc.pc(), 0xdf78);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xdf77), 0x5b);
        // 5B 005D
        gbc.setState(0x83a4, 0xcf8, 0x3660, 0x71b6, 0x865a, 0x5084, 0x0, 0x1);
        gbc.writeMem(0x83a4, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x36);
        EXPECT(gbc.b(),  0x71);
        EXPECT(gbc.c(),  0xb6);
        EXPECT(gbc.d(),  0x86);
        EXPECT(gbc.e(),  0x5a);
        EXPECT(gbc.h(),  0x50);
        EXPECT(gbc.l(),  0x84);
        EXPECT(gbc.sp(), 0xcf8);
        EXPECT(gbc.pc(), 0x83a5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x83a4), 0x5b);
        // 5B 005F
        gbc.setState(0xb1cf, 0xab65, 0xd020, 0x4b75, 0x6067, 0x4405, 0x1, 0x1);
        gbc.writeMem(0xb1cf, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd0);
        EXPECT(gbc.b(),  0x4b);
        EXPECT(gbc.c(),  0x75);
        EXPECT(gbc.d(),  0x60);
        EXPECT(gbc.e(),  0x67);
        EXPECT(gbc.h(),  0x44);
        EXPECT(gbc.l(),  0x5);
        EXPECT(gbc.sp(), 0xab65);
        EXPECT(gbc.pc(), 0xb1d0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb1cf), 0x5b);
        // 5B 0060
        gbc.setState(0xe32c, 0x75f8, 0x1cb0, 0x9f2b, 0xee5a, 0xf946, 0x1, 0x0);
        gbc.writeMem(0xe32c, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x1c);
        EXPECT(gbc.b(),  0x9f);
        EXPECT(gbc.c(),  0x2b);
        EXPECT(gbc.d(),  0xee);
        EXPECT(gbc.e(),  0x5a);
        EXPECT(gbc.h(),  0xf9);
        EXPECT(gbc.l(),  0x46);
        EXPECT(gbc.sp(), 0x75f8);
        EXPECT(gbc.pc(), 0xe32d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe32c), 0x5b);
        // 5B 0061
        gbc.setState(0x3e20, 0xcfef, 0xcc70, 0x3fb1, 0x97ca, 0x4243, 0x0, 0x0);
        gbc.writeMem(0x3e20, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xcc);
        EXPECT(gbc.b(),  0x3f);
        EXPECT(gbc.c(),  0xb1);
        EXPECT(gbc.d(),  0x97);
        EXPECT(gbc.e(),  0xca);
        EXPECT(gbc.h(),  0x42);
        EXPECT(gbc.l(),  0x43);
        EXPECT(gbc.sp(), 0xcfef);
        EXPECT(gbc.pc(), 0x3e21);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0062
        gbc.setState(0xe4b, 0x234e, 0x6700, 0x23f2, 0x21c6, 0xb6c, 0x1, 0x1);
        gbc.writeMem(0xe4b, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x67);
        EXPECT(gbc.b(),  0x23);
        EXPECT(gbc.c(),  0xf2);
        EXPECT(gbc.d(),  0x21);
        EXPECT(gbc.e(),  0xc6);
        EXPECT(gbc.h(),  0xb);
        EXPECT(gbc.l(),  0x6c);
        EXPECT(gbc.sp(), 0x234e);
        EXPECT(gbc.pc(), 0xe4c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0063
        gbc.setState(0x8eb6, 0xd85b, 0x19d0, 0x425c, 0x7892, 0xa15c, 0x1, 0x0);
        gbc.writeMem(0x8eb6, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x19);
        EXPECT(gbc.b(),  0x42);
        EXPECT(gbc.c(),  0x5c);
        EXPECT(gbc.d(),  0x78);
        EXPECT(gbc.e(),  0x92);
        EXPECT(gbc.h(),  0xa1);
        EXPECT(gbc.l(),  0x5c);
        EXPECT(gbc.sp(), 0xd85b);
        EXPECT(gbc.pc(), 0x8eb7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8eb6), 0x5b);
        // 5B 0064
        gbc.setState(0x36fa, 0x48df, 0x77a0, 0x952c, 0x1dca, 0x5507, 0x1, 0x1);
        gbc.writeMem(0x36fa, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x77);
        EXPECT(gbc.b(),  0x95);
        EXPECT(gbc.c(),  0x2c);
        EXPECT(gbc.d(),  0x1d);
        EXPECT(gbc.e(),  0xca);
        EXPECT(gbc.h(),  0x55);
        EXPECT(gbc.l(),  0x7);
        EXPECT(gbc.sp(), 0x48df);
        EXPECT(gbc.pc(), 0x36fb);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0065
        gbc.setState(0x39bb, 0xb2ed, 0x7500, 0x6d04, 0x448b, 0xe258, 0x1, 0x0);
        gbc.writeMem(0x39bb, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x75);
        EXPECT(gbc.b(),  0x6d);
        EXPECT(gbc.c(),  0x4);
        EXPECT(gbc.d(),  0x44);
        EXPECT(gbc.e(),  0x8b);
        EXPECT(gbc.h(),  0xe2);
        EXPECT(gbc.l(),  0x58);
        EXPECT(gbc.sp(), 0xb2ed);
        EXPECT(gbc.pc(), 0x39bc);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0066
        gbc.setState(0x1ae, 0x5319, 0xe3e0, 0x3c37, 0xc48f, 0x776d, 0x1, 0x1);
        gbc.writeMem(0x1ae, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xe3);
        EXPECT(gbc.b(),  0x3c);
        EXPECT(gbc.c(),  0x37);
        EXPECT(gbc.d(),  0xc4);
        EXPECT(gbc.e(),  0x8f);
        EXPECT(gbc.h(),  0x77);
        EXPECT(gbc.l(),  0x6d);
        EXPECT(gbc.sp(), 0x5319);
        EXPECT(gbc.pc(), 0x1af);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0067
        gbc.setState(0xaea4, 0x4e8b, 0x290, 0xc4e7, 0x3e1, 0xb749, 0x1, 0x1);
        gbc.writeMem(0xaea4, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0xc4);
        EXPECT(gbc.c(),  0xe7);
        EXPECT(gbc.d(),  0x3);
        EXPECT(gbc.e(),  0xe1);
        EXPECT(gbc.h(),  0xb7);
        EXPECT(gbc.l(),  0x49);
        EXPECT(gbc.sp(), 0x4e8b);
        EXPECT(gbc.pc(), 0xaea5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xaea4), 0x5b);
        // 5B 0068
        gbc.setState(0x6840, 0x3629, 0x1480, 0x4c6f, 0x846b, 0x30c9, 0x0, 0x1);
        gbc.writeMem(0x6840, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x14);
        EXPECT(gbc.b(),  0x4c);
        EXPECT(gbc.c(),  0x6f);
        EXPECT(gbc.d(),  0x84);
        EXPECT(gbc.e(),  0x6b);
        EXPECT(gbc.h(),  0x30);
        EXPECT(gbc.l(),  0xc9);
        EXPECT(gbc.sp(), 0x3629);
        EXPECT(gbc.pc(), 0x6841);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0069
        gbc.setState(0xc329, 0xe161, 0x6910, 0x4a93, 0xf7cc, 0x2910, 0x1, 0x0);
        gbc.writeMem(0xc329, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x69);
        EXPECT(gbc.b(),  0x4a);
        EXPECT(gbc.c(),  0x93);
        EXPECT(gbc.d(),  0xf7);
        EXPECT(gbc.e(),  0xcc);
        EXPECT(gbc.h(),  0x29);
        EXPECT(gbc.l(),  0x10);
        EXPECT(gbc.sp(), 0xe161);
        EXPECT(gbc.pc(), 0xc32a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc329), 0x5b);
        // 5B 006A
        gbc.setState(0x662e, 0x3cd1, 0x1e0, 0x8d2b, 0x1659, 0x5a17, 0x0, 0x0);
        gbc.writeMem(0x662e, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0x8d);
        EXPECT(gbc.c(),  0x2b);
        EXPECT(gbc.d(),  0x16);
        EXPECT(gbc.e(),  0x59);
        EXPECT(gbc.h(),  0x5a);
        EXPECT(gbc.l(),  0x17);
        EXPECT(gbc.sp(), 0x3cd1);
        EXPECT(gbc.pc(), 0x662f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 006B
        gbc.setState(0xea74, 0x6c39, 0x75d0, 0x36df, 0xa814, 0xad79, 0x0, 0x1);
        gbc.writeMem(0xea74, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x75);
        EXPECT(gbc.b(),  0x36);
        EXPECT(gbc.c(),  0xdf);
        EXPECT(gbc.d(),  0xa8);
        EXPECT(gbc.e(),  0x14);
        EXPECT(gbc.h(),  0xad);
        EXPECT(gbc.l(),  0x79);
        EXPECT(gbc.sp(), 0x6c39);
        EXPECT(gbc.pc(), 0xea75);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xea74), 0x5b);
        // 5B 006C
        gbc.setState(0x76c0, 0x1e64, 0xd640, 0x5008, 0x5288, 0xf8a8, 0x1, 0x1);
        gbc.writeMem(0x76c0, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd6);
        EXPECT(gbc.b(),  0x50);
        EXPECT(gbc.c(),  0x8);
        EXPECT(gbc.d(),  0x52);
        EXPECT(gbc.e(),  0x88);
        EXPECT(gbc.h(),  0xf8);
        EXPECT(gbc.l(),  0xa8);
        EXPECT(gbc.sp(), 0x1e64);
        EXPECT(gbc.pc(), 0x76c1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 006E
        gbc.setState(0x3589, 0xe350, 0x4050, 0xac39, 0xdb92, 0x4b1d, 0x0, 0x1);
        gbc.writeMem(0x3589, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0xac);
        EXPECT(gbc.c(),  0x39);
        EXPECT(gbc.d(),  0xdb);
        EXPECT(gbc.e(),  0x92);
        EXPECT(gbc.h(),  0x4b);
        EXPECT(gbc.l(),  0x1d);
        EXPECT(gbc.sp(), 0xe350);
        EXPECT(gbc.pc(), 0x358a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 006F
        gbc.setState(0xaaee, 0x6a89, 0xf280, 0x80a5, 0x570, 0x68ca, 0x1, 0x1);
        gbc.writeMem(0xaaee, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf2);
        EXPECT(gbc.b(),  0x80);
        EXPECT(gbc.c(),  0xa5);
        EXPECT(gbc.d(),  0x5);
        EXPECT(gbc.e(),  0x70);
        EXPECT(gbc.h(),  0x68);
        EXPECT(gbc.l(),  0xca);
        EXPECT(gbc.sp(), 0x6a89);
        EXPECT(gbc.pc(), 0xaaef);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xaaee), 0x5b);
        // 5B 0070
        gbc.setState(0x2226, 0xa5fe, 0x96f0, 0x7244, 0xb091, 0x570f, 0x0, 0x1);
        gbc.writeMem(0x2226, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x96);
        EXPECT(gbc.b(),  0x72);
        EXPECT(gbc.c(),  0x44);
        EXPECT(gbc.d(),  0xb0);
        EXPECT(gbc.e(),  0x91);
        EXPECT(gbc.h(),  0x57);
        EXPECT(gbc.l(),  0xf);
        EXPECT(gbc.sp(), 0xa5fe);
        EXPECT(gbc.pc(), 0x2227);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0071
        gbc.setState(0x4f80, 0xe908, 0x7540, 0x4bdf, 0x6e67, 0x84b6, 0x0, 0x1);
        gbc.writeMem(0x4f80, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x75);
        EXPECT(gbc.b(),  0x4b);
        EXPECT(gbc.c(),  0xdf);
        EXPECT(gbc.d(),  0x6e);
        EXPECT(gbc.e(),  0x67);
        EXPECT(gbc.h(),  0x84);
        EXPECT(gbc.l(),  0xb6);
        EXPECT(gbc.sp(), 0xe908);
        EXPECT(gbc.pc(), 0x4f81);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0072
        gbc.setState(0xddf6, 0xfe6f, 0x1b30, 0xa58c, 0x8955, 0x2cfe, 0x0, 0x1);
        gbc.writeMem(0xddf6, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x1b);
        EXPECT(gbc.b(),  0xa5);
        EXPECT(gbc.c(),  0x8c);
        EXPECT(gbc.d(),  0x89);
        EXPECT(gbc.e(),  0x55);
        EXPECT(gbc.h(),  0x2c);
        EXPECT(gbc.l(),  0xfe);
        EXPECT(gbc.sp(), 0xfe6f);
        EXPECT(gbc.pc(), 0xddf7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xddf6), 0x5b);
        // 5B 0073
        gbc.setState(0xdb33, 0xbc18, 0x6c90, 0x7c96, 0x5ef0, 0x8f47, 0x1, 0x0);
        gbc.writeMem(0xdb33, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x6c);
        EXPECT(gbc.b(),  0x7c);
        EXPECT(gbc.c(),  0x96);
        EXPECT(gbc.d(),  0x5e);
        EXPECT(gbc.e(),  0xf0);
        EXPECT(gbc.h(),  0x8f);
        EXPECT(gbc.l(),  0x47);
        EXPECT(gbc.sp(), 0xbc18);
        EXPECT(gbc.pc(), 0xdb34);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xdb33), 0x5b);
        // 5B 0075
        gbc.setState(0x7b06, 0xd3c9, 0xd5e0, 0xdd5f, 0x7ab8, 0x86d1, 0x1, 0x0);
        gbc.writeMem(0x7b06, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd5);
        EXPECT(gbc.b(),  0xdd);
        EXPECT(gbc.c(),  0x5f);
        EXPECT(gbc.d(),  0x7a);
        EXPECT(gbc.e(),  0xb8);
        EXPECT(gbc.h(),  0x86);
        EXPECT(gbc.l(),  0xd1);
        EXPECT(gbc.sp(), 0xd3c9);
        EXPECT(gbc.pc(), 0x7b07);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0076
        gbc.setState(0xab2b, 0x6699, 0xde50, 0xc014, 0x7227, 0x607f, 0x0, 0x1);
        gbc.writeMem(0xab2b, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xde);
        EXPECT(gbc.b(),  0xc0);
        EXPECT(gbc.c(),  0x14);
        EXPECT(gbc.d(),  0x72);
        EXPECT(gbc.e(),  0x27);
        EXPECT(gbc.h(),  0x60);
        EXPECT(gbc.l(),  0x7f);
        EXPECT(gbc.sp(), 0x6699);
        EXPECT(gbc.pc(), 0xab2c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xab2b), 0x5b);
        // 5B 0077
        gbc.setState(0x5a6c, 0x81f, 0x6970, 0x1eb6, 0xffaa, 0x1580, 0x0, 0x0);
        gbc.writeMem(0x5a6c, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x69);
        EXPECT(gbc.b(),  0x1e);
        EXPECT(gbc.c(),  0xb6);
        EXPECT(gbc.d(),  0xff);
        EXPECT(gbc.e(),  0xaa);
        EXPECT(gbc.h(),  0x15);
        EXPECT(gbc.l(),  0x80);
        EXPECT(gbc.sp(), 0x81f);
        EXPECT(gbc.pc(), 0x5a6d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0078
        gbc.setState(0xd074, 0xc7d4, 0x4160, 0xaf97, 0x4ebf, 0x8f2e, 0x1, 0x1);
        gbc.writeMem(0xd074, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x41);
        EXPECT(gbc.b(),  0xaf);
        EXPECT(gbc.c(),  0x97);
        EXPECT(gbc.d(),  0x4e);
        EXPECT(gbc.e(),  0xbf);
        EXPECT(gbc.h(),  0x8f);
        EXPECT(gbc.l(),  0x2e);
        EXPECT(gbc.sp(), 0xc7d4);
        EXPECT(gbc.pc(), 0xd075);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd074), 0x5b);
        // 5B 0079
        gbc.setState(0x12bf, 0x5850, 0x8ff0, 0xed5b, 0x48b4, 0x405a, 0x0, 0x1);
        gbc.writeMem(0x12bf, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x8f);
        EXPECT(gbc.b(),  0xed);
        EXPECT(gbc.c(),  0x5b);
        EXPECT(gbc.d(),  0x48);
        EXPECT(gbc.e(),  0xb4);
        EXPECT(gbc.h(),  0x40);
        EXPECT(gbc.l(),  0x5a);
        EXPECT(gbc.sp(), 0x5850);
        EXPECT(gbc.pc(), 0x12c0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 007A
        gbc.setState(0xd1f6, 0xb217, 0x8010, 0xeb47, 0x2411, 0x55dd, 0x0, 0x1);
        gbc.writeMem(0xd1f6, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0xeb);
        EXPECT(gbc.c(),  0x47);
        EXPECT(gbc.d(),  0x24);
        EXPECT(gbc.e(),  0x11);
        EXPECT(gbc.h(),  0x55);
        EXPECT(gbc.l(),  0xdd);
        EXPECT(gbc.sp(), 0xb217);
        EXPECT(gbc.pc(), 0xd1f7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd1f6), 0x5b);
        // 5B 007B
        gbc.setState(0x152b, 0x15e, 0x77c0, 0x3cc9, 0xba1c, 0x4e6f, 0x1, 0x0);
        gbc.writeMem(0x152b, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x77);
        EXPECT(gbc.b(),  0x3c);
        EXPECT(gbc.c(),  0xc9);
        EXPECT(gbc.d(),  0xba);
        EXPECT(gbc.e(),  0x1c);
        EXPECT(gbc.h(),  0x4e);
        EXPECT(gbc.l(),  0x6f);
        EXPECT(gbc.sp(), 0x15e);
        EXPECT(gbc.pc(), 0x152c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 007D
        gbc.setState(0x35ec, 0xfda9, 0xabf0, 0x6a1c, 0xd035, 0xd645, 0x1, 0x0);
        gbc.writeMem(0x35ec, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xab);
        EXPECT(gbc.b(),  0x6a);
        EXPECT(gbc.c(),  0x1c);
        EXPECT(gbc.d(),  0xd0);
        EXPECT(gbc.e(),  0x35);
        EXPECT(gbc.h(),  0xd6);
        EXPECT(gbc.l(),  0x45);
        EXPECT(gbc.sp(), 0xfda9);
        EXPECT(gbc.pc(), 0x35ed);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 007E
        gbc.setState(0x3660, 0xf9d9, 0x8ae0, 0x21ed, 0x5ff1, 0x5e65, 0x0, 0x1);
        gbc.writeMem(0x3660, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x8a);
        EXPECT(gbc.b(),  0x21);
        EXPECT(gbc.c(),  0xed);
        EXPECT(gbc.d(),  0x5f);
        EXPECT(gbc.e(),  0xf1);
        EXPECT(gbc.h(),  0x5e);
        EXPECT(gbc.l(),  0x65);
        EXPECT(gbc.sp(), 0xf9d9);
        EXPECT(gbc.pc(), 0x3661);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 007F
        gbc.setState(0x2e4, 0xeda9, 0x3ec0, 0x62a4, 0xfa40, 0x11f9, 0x1, 0x1);
        gbc.writeMem(0x2e4, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x3e);
        EXPECT(gbc.b(),  0x62);
        EXPECT(gbc.c(),  0xa4);
        EXPECT(gbc.d(),  0xfa);
        EXPECT(gbc.e(),  0x40);
        EXPECT(gbc.h(),  0x11);
        EXPECT(gbc.l(),  0xf9);
        EXPECT(gbc.sp(), 0xeda9);
        EXPECT(gbc.pc(), 0x2e5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0080
        gbc.setState(0x62d7, 0x2565, 0x35b0, 0x14d5, 0xd064, 0x959c, 0x0, 0x1);
        gbc.writeMem(0x62d7, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x35);
        EXPECT(gbc.b(),  0x14);
        EXPECT(gbc.c(),  0xd5);
        EXPECT(gbc.d(),  0xd0);
        EXPECT(gbc.e(),  0x64);
        EXPECT(gbc.h(),  0x95);
        EXPECT(gbc.l(),  0x9c);
        EXPECT(gbc.sp(), 0x2565);
        EXPECT(gbc.pc(), 0x62d8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0081
        gbc.setState(0x61fb, 0x2db7, 0x2520, 0x4de3, 0x7ade, 0x1802, 0x0, 0x0);
        gbc.writeMem(0x61fb, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x25);
        EXPECT(gbc.b(),  0x4d);
        EXPECT(gbc.c(),  0xe3);
        EXPECT(gbc.d(),  0x7a);
        EXPECT(gbc.e(),  0xde);
        EXPECT(gbc.h(),  0x18);
        EXPECT(gbc.l(),  0x2);
        EXPECT(gbc.sp(), 0x2db7);
        EXPECT(gbc.pc(), 0x61fc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0083
        gbc.setState(0x94da, 0x9e68, 0xf8a0, 0xf08f, 0x448a, 0xca9a, 0x0, 0x1);
        gbc.writeMem(0x94da, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf8);
        EXPECT(gbc.b(),  0xf0);
        EXPECT(gbc.c(),  0x8f);
        EXPECT(gbc.d(),  0x44);
        EXPECT(gbc.e(),  0x8a);
        EXPECT(gbc.h(),  0xca);
        EXPECT(gbc.l(),  0x9a);
        EXPECT(gbc.sp(), 0x9e68);
        EXPECT(gbc.pc(), 0x94db);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x94da), 0x5b);
        // 5B 0084
        gbc.setState(0x482a, 0x5c32, 0xef10, 0xb0d4, 0x2e73, 0xf7b4, 0x0, 0x1);
        gbc.writeMem(0x482a, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xef);
        EXPECT(gbc.b(),  0xb0);
        EXPECT(gbc.c(),  0xd4);
        EXPECT(gbc.d(),  0x2e);
        EXPECT(gbc.e(),  0x73);
        EXPECT(gbc.h(),  0xf7);
        EXPECT(gbc.l(),  0xb4);
        EXPECT(gbc.sp(), 0x5c32);
        EXPECT(gbc.pc(), 0x482b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 0087
        gbc.setState(0x7635, 0x8056, 0x67a0, 0xcd35, 0x677e, 0x985a, 0x1, 0x0);
        gbc.writeMem(0x7635, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x67);
        EXPECT(gbc.b(),  0xcd);
        EXPECT(gbc.c(),  0x35);
        EXPECT(gbc.d(),  0x67);
        EXPECT(gbc.e(),  0x7e);
        EXPECT(gbc.h(),  0x98);
        EXPECT(gbc.l(),  0x5a);
        EXPECT(gbc.sp(), 0x8056);
        EXPECT(gbc.pc(), 0x7636);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0088
        gbc.setState(0x5d03, 0xa115, 0x6770, 0x9efc, 0x379, 0xeb15, 0x0, 0x1);
        gbc.writeMem(0x5d03, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x67);
        EXPECT(gbc.b(),  0x9e);
        EXPECT(gbc.c(),  0xfc);
        EXPECT(gbc.d(),  0x3);
        EXPECT(gbc.e(),  0x79);
        EXPECT(gbc.h(),  0xeb);
        EXPECT(gbc.l(),  0x15);
        EXPECT(gbc.sp(), 0xa115);
        EXPECT(gbc.pc(), 0x5d04);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0089
        gbc.setState(0x1f65, 0x657f, 0xf330, 0x7c88, 0xc204, 0xcf2e, 0x0, 0x0);
        gbc.writeMem(0x1f65, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf3);
        EXPECT(gbc.b(),  0x7c);
        EXPECT(gbc.c(),  0x88);
        EXPECT(gbc.d(),  0xc2);
        EXPECT(gbc.e(),  0x4);
        EXPECT(gbc.h(),  0xcf);
        EXPECT(gbc.l(),  0x2e);
        EXPECT(gbc.sp(), 0x657f);
        EXPECT(gbc.pc(), 0x1f66);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 008A
        gbc.setState(0xc9bb, 0x88cc, 0xa880, 0xee84, 0xba17, 0x22a5, 0x1, 0x0);
        gbc.writeMem(0xc9bb, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa8);
        EXPECT(gbc.b(),  0xee);
        EXPECT(gbc.c(),  0x84);
        EXPECT(gbc.d(),  0xba);
        EXPECT(gbc.e(),  0x17);
        EXPECT(gbc.h(),  0x22);
        EXPECT(gbc.l(),  0xa5);
        EXPECT(gbc.sp(), 0x88cc);
        EXPECT(gbc.pc(), 0xc9bc);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc9bb), 0x5b);
        // 5B 008B
        gbc.setState(0x1be3, 0xe7d8, 0x4730, 0x4301, 0x4d55, 0x79a9, 0x0, 0x0);
        gbc.writeMem(0x1be3, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x47);
        EXPECT(gbc.b(),  0x43);
        EXPECT(gbc.c(),  0x1);
        EXPECT(gbc.d(),  0x4d);
        EXPECT(gbc.e(),  0x55);
        EXPECT(gbc.h(),  0x79);
        EXPECT(gbc.l(),  0xa9);
        EXPECT(gbc.sp(), 0xe7d8);
        EXPECT(gbc.pc(), 0x1be4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 008C
        gbc.setState(0x2b22, 0x1303, 0xd370, 0x2923, 0x6ba7, 0x8d7, 0x0, 0x1);
        gbc.writeMem(0x2b22, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd3);
        EXPECT(gbc.b(),  0x29);
        EXPECT(gbc.c(),  0x23);
        EXPECT(gbc.d(),  0x6b);
        EXPECT(gbc.e(),  0xa7);
        EXPECT(gbc.h(),  0x8);
        EXPECT(gbc.l(),  0xd7);
        EXPECT(gbc.sp(), 0x1303);
        EXPECT(gbc.pc(), 0x2b23);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 008D
        gbc.setState(0x416d, 0x4fc2, 0x4cd0, 0xc141, 0xc0d5, 0xbb69, 0x0, 0x0);
        gbc.writeMem(0x416d, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x4c);
        EXPECT(gbc.b(),  0xc1);
        EXPECT(gbc.c(),  0x41);
        EXPECT(gbc.d(),  0xc0);
        EXPECT(gbc.e(),  0xd5);
        EXPECT(gbc.h(),  0xbb);
        EXPECT(gbc.l(),  0x69);
        EXPECT(gbc.sp(), 0x4fc2);
        EXPECT(gbc.pc(), 0x416e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 008E
        gbc.setState(0x5dec, 0xd32a, 0x2b0, 0x56ec, 0x795b, 0xd534, 0x1, 0x1);
        gbc.writeMem(0x5dec, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0x56);
        EXPECT(gbc.c(),  0xec);
        EXPECT(gbc.d(),  0x79);
        EXPECT(gbc.e(),  0x5b);
        EXPECT(gbc.h(),  0xd5);
        EXPECT(gbc.l(),  0x34);
        EXPECT(gbc.sp(), 0xd32a);
        EXPECT(gbc.pc(), 0x5ded);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0091
        gbc.setState(0xd3b1, 0x1426, 0xa220, 0x1c2f, 0xdcda, 0x33a6, 0x1, 0x0);
        gbc.writeMem(0xd3b1, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa2);
        EXPECT(gbc.b(),  0x1c);
        EXPECT(gbc.c(),  0x2f);
        EXPECT(gbc.d(),  0xdc);
        EXPECT(gbc.e(),  0xda);
        EXPECT(gbc.h(),  0x33);
        EXPECT(gbc.l(),  0xa6);
        EXPECT(gbc.sp(), 0x1426);
        EXPECT(gbc.pc(), 0xd3b2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd3b1), 0x5b);
        // 5B 0092
        gbc.setState(0xc8f8, 0x8319, 0xab30, 0xd783, 0x71f0, 0x69e9, 0x0, 0x0);
        gbc.writeMem(0xc8f8, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xab);
        EXPECT(gbc.b(),  0xd7);
        EXPECT(gbc.c(),  0x83);
        EXPECT(gbc.d(),  0x71);
        EXPECT(gbc.e(),  0xf0);
        EXPECT(gbc.h(),  0x69);
        EXPECT(gbc.l(),  0xe9);
        EXPECT(gbc.sp(), 0x8319);
        EXPECT(gbc.pc(), 0xc8f9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc8f8), 0x5b);
        // 5B 0094
        gbc.setState(0x652c, 0x8c4c, 0xffb0, 0xf4b9, 0xc3d7, 0x51b4, 0x1, 0x1);
        gbc.writeMem(0x652c, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xff);
        EXPECT(gbc.b(),  0xf4);
        EXPECT(gbc.c(),  0xb9);
        EXPECT(gbc.d(),  0xc3);
        EXPECT(gbc.e(),  0xd7);
        EXPECT(gbc.h(),  0x51);
        EXPECT(gbc.l(),  0xb4);
        EXPECT(gbc.sp(), 0x8c4c);
        EXPECT(gbc.pc(), 0x652d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0095
        gbc.setState(0xe1f0, 0x5c5e, 0xd80, 0x52b7, 0x69ff, 0xe927, 0x0, 0x1);
        gbc.writeMem(0xe1f0, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd);
        EXPECT(gbc.b(),  0x52);
        EXPECT(gbc.c(),  0xb7);
        EXPECT(gbc.d(),  0x69);
        EXPECT(gbc.e(),  0xff);
        EXPECT(gbc.h(),  0xe9);
        EXPECT(gbc.l(),  0x27);
        EXPECT(gbc.sp(), 0x5c5e);
        EXPECT(gbc.pc(), 0xe1f1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe1f0), 0x5b);
        // 5B 0096
        gbc.setState(0x8eef, 0x3f02, 0x3cd0, 0xb79b, 0x2b86, 0xd8c6, 0x1, 0x1);
        gbc.writeMem(0x8eef, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x3c);
        EXPECT(gbc.b(),  0xb7);
        EXPECT(gbc.c(),  0x9b);
        EXPECT(gbc.d(),  0x2b);
        EXPECT(gbc.e(),  0x86);
        EXPECT(gbc.h(),  0xd8);
        EXPECT(gbc.l(),  0xc6);
        EXPECT(gbc.sp(), 0x3f02);
        EXPECT(gbc.pc(), 0x8ef0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8eef), 0x5b);
        // 5B 0097
        gbc.setState(0x5f31, 0xdc5, 0xfb20, 0x86d5, 0x6c61, 0x7fff, 0x0, 0x1);
        gbc.writeMem(0x5f31, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xfb);
        EXPECT(gbc.b(),  0x86);
        EXPECT(gbc.c(),  0xd5);
        EXPECT(gbc.d(),  0x6c);
        EXPECT(gbc.e(),  0x61);
        EXPECT(gbc.h(),  0x7f);
        EXPECT(gbc.l(),  0xff);
        EXPECT(gbc.sp(), 0xdc5);
        EXPECT(gbc.pc(), 0x5f32);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0098
        gbc.setState(0x4b41, 0x3c25, 0x9c90, 0x4937, 0x9e29, 0x10d5, 0x0, 0x1);
        gbc.writeMem(0x4b41, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x9c);
        EXPECT(gbc.b(),  0x49);
        EXPECT(gbc.c(),  0x37);
        EXPECT(gbc.d(),  0x9e);
        EXPECT(gbc.e(),  0x29);
        EXPECT(gbc.h(),  0x10);
        EXPECT(gbc.l(),  0xd5);
        EXPECT(gbc.sp(), 0x3c25);
        EXPECT(gbc.pc(), 0x4b42);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 0099
        gbc.setState(0xd16e, 0x5e6b, 0xc910, 0xaa0d, 0x4d8e, 0x5523, 0x0, 0x1);
        gbc.writeMem(0xd16e, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xc9);
        EXPECT(gbc.b(),  0xaa);
        EXPECT(gbc.c(),  0xd);
        EXPECT(gbc.d(),  0x4d);
        EXPECT(gbc.e(),  0x8e);
        EXPECT(gbc.h(),  0x55);
        EXPECT(gbc.l(),  0x23);
        EXPECT(gbc.sp(), 0x5e6b);
        EXPECT(gbc.pc(), 0xd16f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd16e), 0x5b);
        // 5B 009A
        gbc.setState(0x7056, 0x7faa, 0xe830, 0x8b23, 0x341e, 0xfbec, 0x1, 0x0);
        gbc.writeMem(0x7056, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xe8);
        EXPECT(gbc.b(),  0x8b);
        EXPECT(gbc.c(),  0x23);
        EXPECT(gbc.d(),  0x34);
        EXPECT(gbc.e(),  0x1e);
        EXPECT(gbc.h(),  0xfb);
        EXPECT(gbc.l(),  0xec);
        EXPECT(gbc.sp(), 0x7faa);
        EXPECT(gbc.pc(), 0x7057);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 009C
        gbc.setState(0x3b34, 0x955b, 0x5be0, 0x406f, 0xb031, 0xa356, 0x0, 0x1);
        gbc.writeMem(0x3b34, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x5b);
        EXPECT(gbc.b(),  0x40);
        EXPECT(gbc.c(),  0x6f);
        EXPECT(gbc.d(),  0xb0);
        EXPECT(gbc.e(),  0x31);
        EXPECT(gbc.h(),  0xa3);
        EXPECT(gbc.l(),  0x56);
        EXPECT(gbc.sp(), 0x955b);
        EXPECT(gbc.pc(), 0x3b35);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 009D
        gbc.setState(0xe4b4, 0x3bc7, 0x1b0, 0x14e, 0x78e1, 0x3b42, 0x1, 0x0);
        gbc.writeMem(0xe4b4, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0x1);
        EXPECT(gbc.c(),  0x4e);
        EXPECT(gbc.d(),  0x78);
        EXPECT(gbc.e(),  0xe1);
        EXPECT(gbc.h(),  0x3b);
        EXPECT(gbc.l(),  0x42);
        EXPECT(gbc.sp(), 0x3bc7);
        EXPECT(gbc.pc(), 0xe4b5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe4b4), 0x5b);
        // 5B 009E
        gbc.setState(0xc1cf, 0x6b83, 0xfa60, 0xc550, 0xfbfa, 0x15b4, 0x0, 0x1);
        gbc.writeMem(0xc1cf, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xfa);
        EXPECT(gbc.b(),  0xc5);
        EXPECT(gbc.c(),  0x50);
        EXPECT(gbc.d(),  0xfb);
        EXPECT(gbc.e(),  0xfa);
        EXPECT(gbc.h(),  0x15);
        EXPECT(gbc.l(),  0xb4);
        EXPECT(gbc.sp(), 0x6b83);
        EXPECT(gbc.pc(), 0xc1d0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc1cf), 0x5b);
        // 5B 009F
        gbc.setState(0xb533, 0x8ce0, 0x4280, 0x96ae, 0x32ab, 0xe8c8, 0x0, 0x1);
        gbc.writeMem(0xb533, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x42);
        EXPECT(gbc.b(),  0x96);
        EXPECT(gbc.c(),  0xae);
        EXPECT(gbc.d(),  0x32);
        EXPECT(gbc.e(),  0xab);
        EXPECT(gbc.h(),  0xe8);
        EXPECT(gbc.l(),  0xc8);
        EXPECT(gbc.sp(), 0x8ce0);
        EXPECT(gbc.pc(), 0xb534);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb533), 0x5b);
        // 5B 00A0
        gbc.setState(0xd7d8, 0xa7c5, 0x9e10, 0x604, 0xecae, 0xc99d, 0x1, 0x0);
        gbc.writeMem(0xd7d8, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x9e);
        EXPECT(gbc.b(),  0x6);
        EXPECT(gbc.c(),  0x4);
        EXPECT(gbc.d(),  0xec);
        EXPECT(gbc.e(),  0xae);
        EXPECT(gbc.h(),  0xc9);
        EXPECT(gbc.l(),  0x9d);
        EXPECT(gbc.sp(), 0xa7c5);
        EXPECT(gbc.pc(), 0xd7d9);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd7d8), 0x5b);
        // 5B 00A1
        gbc.setState(0xad7, 0x794d, 0xc500, 0x57b3, 0xafe9, 0x2531, 0x1, 0x1);
        gbc.writeMem(0xad7, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xc5);
        EXPECT(gbc.b(),  0x57);
        EXPECT(gbc.c(),  0xb3);
        EXPECT(gbc.d(),  0xaf);
        EXPECT(gbc.e(),  0xe9);
        EXPECT(gbc.h(),  0x25);
        EXPECT(gbc.l(),  0x31);
        EXPECT(gbc.sp(), 0x794d);
        EXPECT(gbc.pc(), 0xad8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 00A2
        gbc.setState(0xc150, 0xe27f, 0x8810, 0x5d23, 0xefa5, 0x1a9e, 0x0, 0x1);
        gbc.writeMem(0xc150, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x88);
        EXPECT(gbc.b(),  0x5d);
        EXPECT(gbc.c(),  0x23);
        EXPECT(gbc.d(),  0xef);
        EXPECT(gbc.e(),  0xa5);
        EXPECT(gbc.h(),  0x1a);
        EXPECT(gbc.l(),  0x9e);
        EXPECT(gbc.sp(), 0xe27f);
        EXPECT(gbc.pc(), 0xc151);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc150), 0x5b);
        // 5B 00A3
        gbc.setState(0x9603, 0x8e60, 0xa780, 0x183f, 0x44d4, 0x6090, 0x0, 0x1);
        gbc.writeMem(0x9603, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa7);
        EXPECT(gbc.b(),  0x18);
        EXPECT(gbc.c(),  0x3f);
        EXPECT(gbc.d(),  0x44);
        EXPECT(gbc.e(),  0xd4);
        EXPECT(gbc.h(),  0x60);
        EXPECT(gbc.l(),  0x90);
        EXPECT(gbc.sp(), 0x8e60);
        EXPECT(gbc.pc(), 0x9604);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9603), 0x5b);
        // 5B 00A4
        gbc.setState(0xec9a, 0x2cb8, 0x3590, 0xc074, 0x3f22, 0xbd78, 0x1, 0x1);
        gbc.writeMem(0xec9a, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x35);
        EXPECT(gbc.b(),  0xc0);
        EXPECT(gbc.c(),  0x74);
        EXPECT(gbc.d(),  0x3f);
        EXPECT(gbc.e(),  0x22);
        EXPECT(gbc.h(),  0xbd);
        EXPECT(gbc.l(),  0x78);
        EXPECT(gbc.sp(), 0x2cb8);
        EXPECT(gbc.pc(), 0xec9b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xec9a), 0x5b);
        // 5B 00A5
        gbc.setState(0x17e1, 0x8e72, 0xa910, 0x5f1d, 0x4fe5, 0x35cd, 0x0, 0x0);
        gbc.writeMem(0x17e1, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa9);
        EXPECT(gbc.b(),  0x5f);
        EXPECT(gbc.c(),  0x1d);
        EXPECT(gbc.d(),  0x4f);
        EXPECT(gbc.e(),  0xe5);
        EXPECT(gbc.h(),  0x35);
        EXPECT(gbc.l(),  0xcd);
        EXPECT(gbc.sp(), 0x8e72);
        EXPECT(gbc.pc(), 0x17e2);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 00A6
        gbc.setState(0x2e8d, 0xa225, 0x89a0, 0xdee9, 0xfb3e, 0x8c8a, 0x1, 0x1);
        gbc.writeMem(0x2e8d, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x89);
        EXPECT(gbc.b(),  0xde);
        EXPECT(gbc.c(),  0xe9);
        EXPECT(gbc.d(),  0xfb);
        EXPECT(gbc.e(),  0x3e);
        EXPECT(gbc.h(),  0x8c);
        EXPECT(gbc.l(),  0x8a);
        EXPECT(gbc.sp(), 0xa225);
        EXPECT(gbc.pc(), 0x2e8e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 00A7
        gbc.setState(0x1781, 0xeae5, 0xb210, 0xc9ae, 0xe6c, 0xb453, 0x1, 0x1);
        gbc.writeMem(0x1781, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xb2);
        EXPECT(gbc.b(),  0xc9);
        EXPECT(gbc.c(),  0xae);
        EXPECT(gbc.d(),  0xe);
        EXPECT(gbc.e(),  0x6c);
        EXPECT(gbc.h(),  0xb4);
        EXPECT(gbc.l(),  0x53);
        EXPECT(gbc.sp(), 0xeae5);
        EXPECT(gbc.pc(), 0x1782);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 00A8
        gbc.setState(0xba8b, 0x898b, 0x1700, 0x492a, 0x4073, 0x157b, 0x1, 0x1);
        gbc.writeMem(0xba8b, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x17);
        EXPECT(gbc.b(),  0x49);
        EXPECT(gbc.c(),  0x2a);
        EXPECT(gbc.d(),  0x40);
        EXPECT(gbc.e(),  0x73);
        EXPECT(gbc.h(),  0x15);
        EXPECT(gbc.l(),  0x7b);
        EXPECT(gbc.sp(), 0x898b);
        EXPECT(gbc.pc(), 0xba8c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xba8b), 0x5b);
        // 5B 00A9
        gbc.setState(0x4479, 0x13ab, 0xcc50, 0x8960, 0x7856, 0x4036, 0x0, 0x0);
        gbc.writeMem(0x4479, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xcc);
        EXPECT(gbc.b(),  0x89);
        EXPECT(gbc.c(),  0x60);
        EXPECT(gbc.d(),  0x78);
        EXPECT(gbc.e(),  0x56);
        EXPECT(gbc.h(),  0x40);
        EXPECT(gbc.l(),  0x36);
        EXPECT(gbc.sp(), 0x13ab);
        EXPECT(gbc.pc(), 0x447a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 00AA
        gbc.setState(0xedee, 0x88c6, 0x1400, 0x9e9d, 0xab79, 0x510, 0x0, 0x0);
        gbc.writeMem(0xedee, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x14);
        EXPECT(gbc.b(),  0x9e);
        EXPECT(gbc.c(),  0x9d);
        EXPECT(gbc.d(),  0xab);
        EXPECT(gbc.e(),  0x79);
        EXPECT(gbc.h(),  0x5);
        EXPECT(gbc.l(),  0x10);
        EXPECT(gbc.sp(), 0x88c6);
        EXPECT(gbc.pc(), 0xedef);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xedee), 0x5b);
        // 5B 00AB
        gbc.setState(0xa97c, 0x2d1b, 0xbcc0, 0xa584, 0x4dd5, 0x4a1b, 0x1, 0x1);
        gbc.writeMem(0xa97c, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xbc);
        EXPECT(gbc.b(),  0xa5);
        EXPECT(gbc.c(),  0x84);
        EXPECT(gbc.d(),  0x4d);
        EXPECT(gbc.e(),  0xd5);
        EXPECT(gbc.h(),  0x4a);
        EXPECT(gbc.l(),  0x1b);
        EXPECT(gbc.sp(), 0x2d1b);
        EXPECT(gbc.pc(), 0xa97d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa97c), 0x5b);
        // 5B 00AC
        gbc.setState(0x4b77, 0xc1f6, 0x9ae0, 0xa2b4, 0x4865, 0x1abb, 0x1, 0x1);
        gbc.writeMem(0x4b77, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x9a);
        EXPECT(gbc.b(),  0xa2);
        EXPECT(gbc.c(),  0xb4);
        EXPECT(gbc.d(),  0x48);
        EXPECT(gbc.e(),  0x65);
        EXPECT(gbc.h(),  0x1a);
        EXPECT(gbc.l(),  0xbb);
        EXPECT(gbc.sp(), 0xc1f6);
        EXPECT(gbc.pc(), 0x4b78);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 00AD
        gbc.setState(0xd626, 0xf204, 0x6b20, 0x9d53, 0xd81, 0xcb1e, 0x0, 0x1);
        gbc.writeMem(0xd626, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x6b);
        EXPECT(gbc.b(),  0x9d);
        EXPECT(gbc.c(),  0x53);
        EXPECT(gbc.d(),  0xd);
        EXPECT(gbc.e(),  0x81);
        EXPECT(gbc.h(),  0xcb);
        EXPECT(gbc.l(),  0x1e);
        EXPECT(gbc.sp(), 0xf204);
        EXPECT(gbc.pc(), 0xd627);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd626), 0x5b);
        // 5B 00AE
        gbc.setState(0x3fe4, 0xcb2b, 0x8480, 0x76de, 0xa, 0x86b6, 0x1, 0x1);
        gbc.writeMem(0x3fe4, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x84);
        EXPECT(gbc.b(),  0x76);
        EXPECT(gbc.c(),  0xde);
        EXPECT(gbc.d(),  0x0);
        EXPECT(gbc.e(),  0xa);
        EXPECT(gbc.h(),  0x86);
        EXPECT(gbc.l(),  0xb6);
        EXPECT(gbc.sp(), 0xcb2b);
        EXPECT(gbc.pc(), 0x3fe5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 00AF
        gbc.setState(0xe518, 0xbd75, 0xcd10, 0xefbc, 0xb3e, 0x39c0, 0x0, 0x0);
        gbc.writeMem(0xe518, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xcd);
        EXPECT(gbc.b(),  0xef);
        EXPECT(gbc.c(),  0xbc);
        EXPECT(gbc.d(),  0xb);
        EXPECT(gbc.e(),  0x3e);
        EXPECT(gbc.h(),  0x39);
        EXPECT(gbc.l(),  0xc0);
        EXPECT(gbc.sp(), 0xbd75);
        EXPECT(gbc.pc(), 0xe519);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe518), 0x5b);
        // 5B 00B0
        gbc.setState(0x5406, 0xee52, 0x7590, 0x6e20, 0x8f6d, 0xcb08, 0x1, 0x1);
        gbc.writeMem(0x5406, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x75);
        EXPECT(gbc.b(),  0x6e);
        EXPECT(gbc.c(),  0x20);
        EXPECT(gbc.d(),  0x8f);
        EXPECT(gbc.e(),  0x6d);
        EXPECT(gbc.h(),  0xcb);
        EXPECT(gbc.l(),  0x8);
        EXPECT(gbc.sp(), 0xee52);
        EXPECT(gbc.pc(), 0x5407);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 00B2
        gbc.setState(0xd205, 0x5a6a, 0xf0a0, 0x6f5c, 0x8c1d, 0x693d, 0x1, 0x1);
        gbc.writeMem(0xd205, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf0);
        EXPECT(gbc.b(),  0x6f);
        EXPECT(gbc.c(),  0x5c);
        EXPECT(gbc.d(),  0x8c);
        EXPECT(gbc.e(),  0x1d);
        EXPECT(gbc.h(),  0x69);
        EXPECT(gbc.l(),  0x3d);
        EXPECT(gbc.sp(), 0x5a6a);
        EXPECT(gbc.pc(), 0xd206);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd205), 0x5b);
        // 5B 00B4
        gbc.setState(0x9854, 0x9bb7, 0xf540, 0xe044, 0x5762, 0xa6d5, 0x0, 0x1);
        gbc.writeMem(0x9854, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf5);
        EXPECT(gbc.b(),  0xe0);
        EXPECT(gbc.c(),  0x44);
        EXPECT(gbc.d(),  0x57);
        EXPECT(gbc.e(),  0x62);
        EXPECT(gbc.h(),  0xa6);
        EXPECT(gbc.l(),  0xd5);
        EXPECT(gbc.sp(), 0x9bb7);
        EXPECT(gbc.pc(), 0x9855);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9854), 0x5b);
        // 5B 00B5
        gbc.setState(0x271c, 0xe045, 0x6cc0, 0xaebb, 0xece5, 0xf19d, 0x0, 0x1);
        gbc.writeMem(0x271c, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x6c);
        EXPECT(gbc.b(),  0xae);
        EXPECT(gbc.c(),  0xbb);
        EXPECT(gbc.d(),  0xec);
        EXPECT(gbc.e(),  0xe5);
        EXPECT(gbc.h(),  0xf1);
        EXPECT(gbc.l(),  0x9d);
        EXPECT(gbc.sp(), 0xe045);
        EXPECT(gbc.pc(), 0x271d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 00B6
        gbc.setState(0xec78, 0xb2fe, 0x1c30, 0xafe5, 0x4909, 0xd3d5, 0x1, 0x1);
        gbc.writeMem(0xec78, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x1c);
        EXPECT(gbc.b(),  0xaf);
        EXPECT(gbc.c(),  0xe5);
        EXPECT(gbc.d(),  0x49);
        EXPECT(gbc.e(),  0x9);
        EXPECT(gbc.h(),  0xd3);
        EXPECT(gbc.l(),  0xd5);
        EXPECT(gbc.sp(), 0xb2fe);
        EXPECT(gbc.pc(), 0xec79);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xec78), 0x5b);
        // 5B 00B7
        gbc.setState(0xbe6b, 0x8366, 0x1dc0, 0xbd35, 0xe39a, 0x3b52, 0x0, 0x0);
        gbc.writeMem(0xbe6b, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x1d);
        EXPECT(gbc.b(),  0xbd);
        EXPECT(gbc.c(),  0x35);
        EXPECT(gbc.d(),  0xe3);
        EXPECT(gbc.e(),  0x9a);
        EXPECT(gbc.h(),  0x3b);
        EXPECT(gbc.l(),  0x52);
        EXPECT(gbc.sp(), 0x8366);
        EXPECT(gbc.pc(), 0xbe6c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbe6b), 0x5b);
        // 5B 00B8
        gbc.setState(0x1ba7, 0x14d6, 0xe50, 0xebe6, 0x3, 0x6c, 0x0, 0x0);
        gbc.writeMem(0x1ba7, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xe);
        EXPECT(gbc.b(),  0xeb);
        EXPECT(gbc.c(),  0xe6);
        EXPECT(gbc.d(),  0x0);
        EXPECT(gbc.e(),  0x3);
        EXPECT(gbc.h(),  0x0);
        EXPECT(gbc.l(),  0x6c);
        EXPECT(gbc.sp(), 0x14d6);
        EXPECT(gbc.pc(), 0x1ba8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 00B9
        gbc.setState(0xb869, 0xdf4e, 0x5230, 0x909a, 0xb0d7, 0xa83b, 0x1, 0x1);
        gbc.writeMem(0xb869, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x52);
        EXPECT(gbc.b(),  0x90);
        EXPECT(gbc.c(),  0x9a);
        EXPECT(gbc.d(),  0xb0);
        EXPECT(gbc.e(),  0xd7);
        EXPECT(gbc.h(),  0xa8);
        EXPECT(gbc.l(),  0x3b);
        EXPECT(gbc.sp(), 0xdf4e);
        EXPECT(gbc.pc(), 0xb86a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb869), 0x5b);
        // 5B 00BA
        gbc.setState(0xbd2d, 0x51ec, 0x20d0, 0x7f41, 0xbb66, 0xbdff, 0x1, 0x1);
        gbc.writeMem(0xbd2d, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0x7f);
        EXPECT(gbc.c(),  0x41);
        EXPECT(gbc.d(),  0xbb);
        EXPECT(gbc.e(),  0x66);
        EXPECT(gbc.h(),  0xbd);
        EXPECT(gbc.l(),  0xff);
        EXPECT(gbc.sp(), 0x51ec);
        EXPECT(gbc.pc(), 0xbd2e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbd2d), 0x5b);
        // 5B 00BB
        gbc.setState(0x483f, 0xe1b9, 0xe8d0, 0xc0c9, 0x7a52, 0x1949, 0x0, 0x1);
        gbc.writeMem(0x483f, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xe8);
        EXPECT(gbc.b(),  0xc0);
        EXPECT(gbc.c(),  0xc9);
        EXPECT(gbc.d(),  0x7a);
        EXPECT(gbc.e(),  0x52);
        EXPECT(gbc.h(),  0x19);
        EXPECT(gbc.l(),  0x49);
        EXPECT(gbc.sp(), 0xe1b9);
        EXPECT(gbc.pc(), 0x4840);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 00BD
        gbc.setState(0xc36b, 0x19f2, 0x1e00, 0xa349, 0x2f71, 0xc92a, 0x0, 0x1);
        gbc.writeMem(0xc36b, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x1e);
        EXPECT(gbc.b(),  0xa3);
        EXPECT(gbc.c(),  0x49);
        EXPECT(gbc.d(),  0x2f);
        EXPECT(gbc.e(),  0x71);
        EXPECT(gbc.h(),  0xc9);
        EXPECT(gbc.l(),  0x2a);
        EXPECT(gbc.sp(), 0x19f2);
        EXPECT(gbc.pc(), 0xc36c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc36b), 0x5b);
        // 5B 00BE
        gbc.setState(0xd6f7, 0xbc5c, 0x5a10, 0x727b, 0xfd1f, 0xc164, 0x0, 0x1);
        gbc.writeMem(0xd6f7, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x5a);
        EXPECT(gbc.b(),  0x72);
        EXPECT(gbc.c(),  0x7b);
        EXPECT(gbc.d(),  0xfd);
        EXPECT(gbc.e(),  0x1f);
        EXPECT(gbc.h(),  0xc1);
        EXPECT(gbc.l(),  0x64);
        EXPECT(gbc.sp(), 0xbc5c);
        EXPECT(gbc.pc(), 0xd6f8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd6f7), 0x5b);
        // 5B 00BF
        gbc.setState(0x71a0, 0xf3c5, 0x5a40, 0x384, 0x63c9, 0xc4d0, 0x1, 0x0);
        gbc.writeMem(0x71a0, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x5a);
        EXPECT(gbc.b(),  0x3);
        EXPECT(gbc.c(),  0x84);
        EXPECT(gbc.d(),  0x63);
        EXPECT(gbc.e(),  0xc9);
        EXPECT(gbc.h(),  0xc4);
        EXPECT(gbc.l(),  0xd0);
        EXPECT(gbc.sp(), 0xf3c5);
        EXPECT(gbc.pc(), 0x71a1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 00C0
        gbc.setState(0xe345, 0x95c8, 0xe0f0, 0xbbdc, 0x9945, 0xa7fa, 0x1, 0x0);
        gbc.writeMem(0xe345, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xe0);
        EXPECT(gbc.b(),  0xbb);
        EXPECT(gbc.c(),  0xdc);
        EXPECT(gbc.d(),  0x99);
        EXPECT(gbc.e(),  0x45);
        EXPECT(gbc.h(),  0xa7);
        EXPECT(gbc.l(),  0xfa);
        EXPECT(gbc.sp(), 0x95c8);
        EXPECT(gbc.pc(), 0xe346);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe345), 0x5b);
        // 5B 00C1
        gbc.setState(0x1f7d, 0x480d, 0x5fb0, 0xb778, 0x9c9f, 0xd322, 0x1, 0x0);
        gbc.writeMem(0x1f7d, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x5f);
        EXPECT(gbc.b(),  0xb7);
        EXPECT(gbc.c(),  0x78);
        EXPECT(gbc.d(),  0x9c);
        EXPECT(gbc.e(),  0x9f);
        EXPECT(gbc.h(),  0xd3);
        EXPECT(gbc.l(),  0x22);
        EXPECT(gbc.sp(), 0x480d);
        EXPECT(gbc.pc(), 0x1f7e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 00C2
        gbc.setState(0x81f6, 0x62b2, 0xfc60, 0x615, 0x5246, 0x7bd9, 0x1, 0x0);
        gbc.writeMem(0x81f6, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xfc);
        EXPECT(gbc.b(),  0x6);
        EXPECT(gbc.c(),  0x15);
        EXPECT(gbc.d(),  0x52);
        EXPECT(gbc.e(),  0x46);
        EXPECT(gbc.h(),  0x7b);
        EXPECT(gbc.l(),  0xd9);
        EXPECT(gbc.sp(), 0x62b2);
        EXPECT(gbc.pc(), 0x81f7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x81f6), 0x5b);
        // 5B 00C3
        gbc.setState(0xdc4d, 0x34c2, 0x1d90, 0x55dd, 0x1a66, 0x974, 0x1, 0x1);
        gbc.writeMem(0xdc4d, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x1d);
        EXPECT(gbc.b(),  0x55);
        EXPECT(gbc.c(),  0xdd);
        EXPECT(gbc.d(),  0x1a);
        EXPECT(gbc.e(),  0x66);
        EXPECT(gbc.h(),  0x9);
        EXPECT(gbc.l(),  0x74);
        EXPECT(gbc.sp(), 0x34c2);
        EXPECT(gbc.pc(), 0xdc4e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xdc4d), 0x5b);
        // 5B 00C4
        gbc.setState(0xbc5d, 0x16a9, 0x52b0, 0x502, 0x415c, 0x756f, 0x0, 0x0);
        gbc.writeMem(0xbc5d, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x52);
        EXPECT(gbc.b(),  0x5);
        EXPECT(gbc.c(),  0x2);
        EXPECT(gbc.d(),  0x41);
        EXPECT(gbc.e(),  0x5c);
        EXPECT(gbc.h(),  0x75);
        EXPECT(gbc.l(),  0x6f);
        EXPECT(gbc.sp(), 0x16a9);
        EXPECT(gbc.pc(), 0xbc5e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbc5d), 0x5b);
        // 5B 00C5
        gbc.setState(0xd5e7, 0x8f63, 0x9b40, 0x2ddc, 0x7c8f, 0xe665, 0x0, 0x0);
        gbc.writeMem(0xd5e7, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x9b);
        EXPECT(gbc.b(),  0x2d);
        EXPECT(gbc.c(),  0xdc);
        EXPECT(gbc.d(),  0x7c);
        EXPECT(gbc.e(),  0x8f);
        EXPECT(gbc.h(),  0xe6);
        EXPECT(gbc.l(),  0x65);
        EXPECT(gbc.sp(), 0x8f63);
        EXPECT(gbc.pc(), 0xd5e8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd5e7), 0x5b);
        // 5B 00C6
        gbc.setState(0x5d5b, 0x835b, 0x6d60, 0x9b5, 0xe5c0, 0x9e20, 0x1, 0x0);
        gbc.writeMem(0x5d5b, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x6d);
        EXPECT(gbc.b(),  0x9);
        EXPECT(gbc.c(),  0xb5);
        EXPECT(gbc.d(),  0xe5);
        EXPECT(gbc.e(),  0xc0);
        EXPECT(gbc.h(),  0x9e);
        EXPECT(gbc.l(),  0x20);
        EXPECT(gbc.sp(), 0x835b);
        EXPECT(gbc.pc(), 0x5d5c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 00C7
        gbc.setState(0x4be, 0x60b3, 0x4fb0, 0x602e, 0x5b72, 0x63b6, 0x0, 0x0);
        gbc.writeMem(0x4be, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x4f);
        EXPECT(gbc.b(),  0x60);
        EXPECT(gbc.c(),  0x2e);
        EXPECT(gbc.d(),  0x5b);
        EXPECT(gbc.e(),  0x72);
        EXPECT(gbc.h(),  0x63);
        EXPECT(gbc.l(),  0xb6);
        EXPECT(gbc.sp(), 0x60b3);
        EXPECT(gbc.pc(), 0x4bf);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 00C9
        gbc.setState(0x5ede, 0x93d6, 0x8300, 0xdfd7, 0x199b, 0xab3b, 0x0, 0x1);
        gbc.writeMem(0x5ede, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x83);
        EXPECT(gbc.b(),  0xdf);
        EXPECT(gbc.c(),  0xd7);
        EXPECT(gbc.d(),  0x19);
        EXPECT(gbc.e(),  0x9b);
        EXPECT(gbc.h(),  0xab);
        EXPECT(gbc.l(),  0x3b);
        EXPECT(gbc.sp(), 0x93d6);
        EXPECT(gbc.pc(), 0x5edf);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 00CB
        gbc.setState(0xaffc, 0xb3e4, 0x7b10, 0x54bb, 0x77f7, 0x5772, 0x0, 0x1);
        gbc.writeMem(0xaffc, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x7b);
        EXPECT(gbc.b(),  0x54);
        EXPECT(gbc.c(),  0xbb);
        EXPECT(gbc.d(),  0x77);
        EXPECT(gbc.e(),  0xf7);
        EXPECT(gbc.h(),  0x57);
        EXPECT(gbc.l(),  0x72);
        EXPECT(gbc.sp(), 0xb3e4);
        EXPECT(gbc.pc(), 0xaffd);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xaffc), 0x5b);
        // 5B 00CC
        gbc.setState(0x7fcf, 0x8705, 0x1760, 0xa945, 0x407c, 0x9d5d, 0x1, 0x0);
        gbc.writeMem(0x7fcf, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x17);
        EXPECT(gbc.b(),  0xa9);
        EXPECT(gbc.c(),  0x45);
        EXPECT(gbc.d(),  0x40);
        EXPECT(gbc.e(),  0x7c);
        EXPECT(gbc.h(),  0x9d);
        EXPECT(gbc.l(),  0x5d);
        EXPECT(gbc.sp(), 0x8705);
        EXPECT(gbc.pc(), 0x7fd0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 00CE
        gbc.setState(0xb22b, 0xf8e1, 0xe420, 0x8549, 0x2a3b, 0xf197, 0x1, 0x1);
        gbc.writeMem(0xb22b, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xe4);
        EXPECT(gbc.b(),  0x85);
        EXPECT(gbc.c(),  0x49);
        EXPECT(gbc.d(),  0x2a);
        EXPECT(gbc.e(),  0x3b);
        EXPECT(gbc.h(),  0xf1);
        EXPECT(gbc.l(),  0x97);
        EXPECT(gbc.sp(), 0xf8e1);
        EXPECT(gbc.pc(), 0xb22c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb22b), 0x5b);
        // 5B 00CF
        gbc.setState(0x62f8, 0x1ce4, 0x9b90, 0xf3b3, 0x2f4d, 0xc2cd, 0x0, 0x1);
        gbc.writeMem(0x62f8, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x9b);
        EXPECT(gbc.b(),  0xf3);
        EXPECT(gbc.c(),  0xb3);
        EXPECT(gbc.d(),  0x2f);
        EXPECT(gbc.e(),  0x4d);
        EXPECT(gbc.h(),  0xc2);
        EXPECT(gbc.l(),  0xcd);
        EXPECT(gbc.sp(), 0x1ce4);
        EXPECT(gbc.pc(), 0x62f9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 00D0
        gbc.setState(0xbc39, 0xcfa8, 0xd560, 0xf1a9, 0x4b55, 0x1c66, 0x0, 0x1);
        gbc.writeMem(0xbc39, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd5);
        EXPECT(gbc.b(),  0xf1);
        EXPECT(gbc.c(),  0xa9);
        EXPECT(gbc.d(),  0x4b);
        EXPECT(gbc.e(),  0x55);
        EXPECT(gbc.h(),  0x1c);
        EXPECT(gbc.l(),  0x66);
        EXPECT(gbc.sp(), 0xcfa8);
        EXPECT(gbc.pc(), 0xbc3a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbc39), 0x5b);
        // 5B 00D1
        gbc.setState(0x25f1, 0x6c27, 0xaea0, 0x5d8f, 0xd133, 0xd293, 0x1, 0x1);
        gbc.writeMem(0x25f1, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xae);
        EXPECT(gbc.b(),  0x5d);
        EXPECT(gbc.c(),  0x8f);
        EXPECT(gbc.d(),  0xd1);
        EXPECT(gbc.e(),  0x33);
        EXPECT(gbc.h(),  0xd2);
        EXPECT(gbc.l(),  0x93);
        EXPECT(gbc.sp(), 0x6c27);
        EXPECT(gbc.pc(), 0x25f2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 00D2
        gbc.setState(0x8508, 0x1fb, 0x5e00, 0x712e, 0x71b6, 0xf141, 0x0, 0x0);
        gbc.writeMem(0x8508, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x5e);
        EXPECT(gbc.b(),  0x71);
        EXPECT(gbc.c(),  0x2e);
        EXPECT(gbc.d(),  0x71);
        EXPECT(gbc.e(),  0xb6);
        EXPECT(gbc.h(),  0xf1);
        EXPECT(gbc.l(),  0x41);
        EXPECT(gbc.sp(), 0x1fb);
        EXPECT(gbc.pc(), 0x8509);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8508), 0x5b);
        // 5B 00D3
        gbc.setState(0x7d07, 0x23e3, 0x4120, 0x4a7b, 0xee5f, 0x931f, 0x1, 0x1);
        gbc.writeMem(0x7d07, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x41);
        EXPECT(gbc.b(),  0x4a);
        EXPECT(gbc.c(),  0x7b);
        EXPECT(gbc.d(),  0xee);
        EXPECT(gbc.e(),  0x5f);
        EXPECT(gbc.h(),  0x93);
        EXPECT(gbc.l(),  0x1f);
        EXPECT(gbc.sp(), 0x23e3);
        EXPECT(gbc.pc(), 0x7d08);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 00D4
        gbc.setState(0xedd6, 0x1402, 0xd990, 0xc94e, 0x221c, 0xa045, 0x1, 0x1);
        gbc.writeMem(0xedd6, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd9);
        EXPECT(gbc.b(),  0xc9);
        EXPECT(gbc.c(),  0x4e);
        EXPECT(gbc.d(),  0x22);
        EXPECT(gbc.e(),  0x1c);
        EXPECT(gbc.h(),  0xa0);
        EXPECT(gbc.l(),  0x45);
        EXPECT(gbc.sp(), 0x1402);
        EXPECT(gbc.pc(), 0xedd7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xedd6), 0x5b);
        // 5B 00D5
        gbc.setState(0x1b27, 0x9ab5, 0xc130, 0xae3b, 0x4254, 0x762, 0x1, 0x0);
        gbc.writeMem(0x1b27, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xc1);
        EXPECT(gbc.b(),  0xae);
        EXPECT(gbc.c(),  0x3b);
        EXPECT(gbc.d(),  0x42);
        EXPECT(gbc.e(),  0x54);
        EXPECT(gbc.h(),  0x7);
        EXPECT(gbc.l(),  0x62);
        EXPECT(gbc.sp(), 0x9ab5);
        EXPECT(gbc.pc(), 0x1b28);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 00D6
        gbc.setState(0xdd25, 0xe70f, 0xb050, 0xf7c1, 0xd81d, 0x4df8, 0x0, 0x1);
        gbc.writeMem(0xdd25, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xb0);
        EXPECT(gbc.b(),  0xf7);
        EXPECT(gbc.c(),  0xc1);
        EXPECT(gbc.d(),  0xd8);
        EXPECT(gbc.e(),  0x1d);
        EXPECT(gbc.h(),  0x4d);
        EXPECT(gbc.l(),  0xf8);
        EXPECT(gbc.sp(), 0xe70f);
        EXPECT(gbc.pc(), 0xdd26);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xdd25), 0x5b);
        // 5B 00D7
        gbc.setState(0xb77d, 0x3e4, 0x62f0, 0xdc54, 0x5c4e, 0xabaa, 0x0, 0x1);
        gbc.writeMem(0xb77d, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x62);
        EXPECT(gbc.b(),  0xdc);
        EXPECT(gbc.c(),  0x54);
        EXPECT(gbc.d(),  0x5c);
        EXPECT(gbc.e(),  0x4e);
        EXPECT(gbc.h(),  0xab);
        EXPECT(gbc.l(),  0xaa);
        EXPECT(gbc.sp(), 0x3e4);
        EXPECT(gbc.pc(), 0xb77e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb77d), 0x5b);
        // 5B 00D8
        gbc.setState(0x3bec, 0xa801, 0x1dc0, 0xc88b, 0xbea, 0xb9c5, 0x0, 0x1);
        gbc.writeMem(0x3bec, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x1d);
        EXPECT(gbc.b(),  0xc8);
        EXPECT(gbc.c(),  0x8b);
        EXPECT(gbc.d(),  0xb);
        EXPECT(gbc.e(),  0xea);
        EXPECT(gbc.h(),  0xb9);
        EXPECT(gbc.l(),  0xc5);
        EXPECT(gbc.sp(), 0xa801);
        EXPECT(gbc.pc(), 0x3bed);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 00D9
        gbc.setState(0x10be, 0x97e7, 0x91d0, 0xe931, 0xbbbe, 0xf947, 0x0, 0x0);
        gbc.writeMem(0x10be, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x91);
        EXPECT(gbc.b(),  0xe9);
        EXPECT(gbc.c(),  0x31);
        EXPECT(gbc.d(),  0xbb);
        EXPECT(gbc.e(),  0xbe);
        EXPECT(gbc.h(),  0xf9);
        EXPECT(gbc.l(),  0x47);
        EXPECT(gbc.sp(), 0x97e7);
        EXPECT(gbc.pc(), 0x10bf);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 00DA
        gbc.setState(0x5b75, 0x40e2, 0xa300, 0x789d, 0xab8e, 0x5c95, 0x1, 0x1);
        gbc.writeMem(0x5b75, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa3);
        EXPECT(gbc.b(),  0x78);
        EXPECT(gbc.c(),  0x9d);
        EXPECT(gbc.d(),  0xab);
        EXPECT(gbc.e(),  0x8e);
        EXPECT(gbc.h(),  0x5c);
        EXPECT(gbc.l(),  0x95);
        EXPECT(gbc.sp(), 0x40e2);
        EXPECT(gbc.pc(), 0x5b76);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 00DB
        gbc.setState(0x8021, 0x1998, 0x9c50, 0xa13a, 0x5ce0, 0x64, 0x1, 0x0);
        gbc.writeMem(0x8021, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x9c);
        EXPECT(gbc.b(),  0xa1);
        EXPECT(gbc.c(),  0x3a);
        EXPECT(gbc.d(),  0x5c);
        EXPECT(gbc.e(),  0xe0);
        EXPECT(gbc.h(),  0x0);
        EXPECT(gbc.l(),  0x64);
        EXPECT(gbc.sp(), 0x1998);
        EXPECT(gbc.pc(), 0x8022);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8021), 0x5b);
        // 5B 00DC
        gbc.setState(0x91ab, 0xa20f, 0x2e90, 0x3461, 0xdbab, 0x40bd, 0x1, 0x0);
        gbc.writeMem(0x91ab, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x2e);
        EXPECT(gbc.b(),  0x34);
        EXPECT(gbc.c(),  0x61);
        EXPECT(gbc.d(),  0xdb);
        EXPECT(gbc.e(),  0xab);
        EXPECT(gbc.h(),  0x40);
        EXPECT(gbc.l(),  0xbd);
        EXPECT(gbc.sp(), 0xa20f);
        EXPECT(gbc.pc(), 0x91ac);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x91ab), 0x5b);
        // 5B 00DD
        gbc.setState(0x2cc0, 0x827b, 0xa760, 0xcc76, 0x3581, 0x3d18, 0x1, 0x0);
        gbc.writeMem(0x2cc0, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa7);
        EXPECT(gbc.b(),  0xcc);
        EXPECT(gbc.c(),  0x76);
        EXPECT(gbc.d(),  0x35);
        EXPECT(gbc.e(),  0x81);
        EXPECT(gbc.h(),  0x3d);
        EXPECT(gbc.l(),  0x18);
        EXPECT(gbc.sp(), 0x827b);
        EXPECT(gbc.pc(), 0x2cc1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 00DE
        gbc.setState(0xe1c1, 0x226c, 0x2f20, 0x919d, 0x9d3c, 0xee3c, 0x0, 0x0);
        gbc.writeMem(0xe1c1, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x2f);
        EXPECT(gbc.b(),  0x91);
        EXPECT(gbc.c(),  0x9d);
        EXPECT(gbc.d(),  0x9d);
        EXPECT(gbc.e(),  0x3c);
        EXPECT(gbc.h(),  0xee);
        EXPECT(gbc.l(),  0x3c);
        EXPECT(gbc.sp(), 0x226c);
        EXPECT(gbc.pc(), 0xe1c2);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe1c1), 0x5b);
        // 5B 00E0
        gbc.setState(0x224d, 0xbe2d, 0x7d20, 0x6053, 0x85cb, 0xa0a, 0x1, 0x0);
        gbc.writeMem(0x224d, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x7d);
        EXPECT(gbc.b(),  0x60);
        EXPECT(gbc.c(),  0x53);
        EXPECT(gbc.d(),  0x85);
        EXPECT(gbc.e(),  0xcb);
        EXPECT(gbc.h(),  0xa);
        EXPECT(gbc.l(),  0xa);
        EXPECT(gbc.sp(), 0xbe2d);
        EXPECT(gbc.pc(), 0x224e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 00E1
        gbc.setState(0xd36, 0xd567, 0xa4c0, 0xe572, 0x8007, 0x2653, 0x0, 0x0);
        gbc.writeMem(0xd36, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa4);
        EXPECT(gbc.b(),  0xe5);
        EXPECT(gbc.c(),  0x72);
        EXPECT(gbc.d(),  0x80);
        EXPECT(gbc.e(),  0x7);
        EXPECT(gbc.h(),  0x26);
        EXPECT(gbc.l(),  0x53);
        EXPECT(gbc.sp(), 0xd567);
        EXPECT(gbc.pc(), 0xd37);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 00E2
        gbc.setState(0x7463, 0x75a2, 0x2e60, 0x48e0, 0xea2c, 0x8878, 0x0, 0x1);
        gbc.writeMem(0x7463, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x2e);
        EXPECT(gbc.b(),  0x48);
        EXPECT(gbc.c(),  0xe0);
        EXPECT(gbc.d(),  0xea);
        EXPECT(gbc.e(),  0x2c);
        EXPECT(gbc.h(),  0x88);
        EXPECT(gbc.l(),  0x78);
        EXPECT(gbc.sp(), 0x75a2);
        EXPECT(gbc.pc(), 0x7464);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 00E3
        gbc.setState(0xe22c, 0x62cc, 0x400, 0x25ad, 0x8d68, 0x8cb2, 0x1, 0x1);
        gbc.writeMem(0xe22c, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0x25);
        EXPECT(gbc.c(),  0xad);
        EXPECT(gbc.d(),  0x8d);
        EXPECT(gbc.e(),  0x68);
        EXPECT(gbc.h(),  0x8c);
        EXPECT(gbc.l(),  0xb2);
        EXPECT(gbc.sp(), 0x62cc);
        EXPECT(gbc.pc(), 0xe22d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe22c), 0x5b);
        // 5B 00E4
        gbc.setState(0xc2dd, 0x7d85, 0xd10, 0x7eb5, 0x473d, 0x4350, 0x0, 0x1);
        gbc.writeMem(0xc2dd, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd);
        EXPECT(gbc.b(),  0x7e);
        EXPECT(gbc.c(),  0xb5);
        EXPECT(gbc.d(),  0x47);
        EXPECT(gbc.e(),  0x3d);
        EXPECT(gbc.h(),  0x43);
        EXPECT(gbc.l(),  0x50);
        EXPECT(gbc.sp(), 0x7d85);
        EXPECT(gbc.pc(), 0xc2de);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc2dd), 0x5b);
        // 5B 00E5
        gbc.setState(0x7919, 0x742c, 0xf10, 0x4670, 0x837a, 0x4122, 0x1, 0x1);
        gbc.writeMem(0x7919, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf);
        EXPECT(gbc.b(),  0x46);
        EXPECT(gbc.c(),  0x70);
        EXPECT(gbc.d(),  0x83);
        EXPECT(gbc.e(),  0x7a);
        EXPECT(gbc.h(),  0x41);
        EXPECT(gbc.l(),  0x22);
        EXPECT(gbc.sp(), 0x742c);
        EXPECT(gbc.pc(), 0x791a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 00E6
        gbc.setState(0x9244, 0xa348, 0xdf60, 0xca07, 0x81bf, 0xb345, 0x1, 0x0);
        gbc.writeMem(0x9244, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xdf);
        EXPECT(gbc.b(),  0xca);
        EXPECT(gbc.c(),  0x7);
        EXPECT(gbc.d(),  0x81);
        EXPECT(gbc.e(),  0xbf);
        EXPECT(gbc.h(),  0xb3);
        EXPECT(gbc.l(),  0x45);
        EXPECT(gbc.sp(), 0xa348);
        EXPECT(gbc.pc(), 0x9245);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9244), 0x5b);
        // 5B 00E7
        gbc.setState(0x53ae, 0xfc5e, 0xd8b0, 0x47e, 0x8fd2, 0xdd32, 0x0, 0x1);
        gbc.writeMem(0x53ae, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd8);
        EXPECT(gbc.b(),  0x4);
        EXPECT(gbc.c(),  0x7e);
        EXPECT(gbc.d(),  0x8f);
        EXPECT(gbc.e(),  0xd2);
        EXPECT(gbc.h(),  0xdd);
        EXPECT(gbc.l(),  0x32);
        EXPECT(gbc.sp(), 0xfc5e);
        EXPECT(gbc.pc(), 0x53af);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 00E8
        gbc.setState(0xc036, 0x85a8, 0x36a0, 0xa3d1, 0x4106, 0x2c1c, 0x1, 0x1);
        gbc.writeMem(0xc036, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x36);
        EXPECT(gbc.b(),  0xa3);
        EXPECT(gbc.c(),  0xd1);
        EXPECT(gbc.d(),  0x41);
        EXPECT(gbc.e(),  0x6);
        EXPECT(gbc.h(),  0x2c);
        EXPECT(gbc.l(),  0x1c);
        EXPECT(gbc.sp(), 0x85a8);
        EXPECT(gbc.pc(), 0xc037);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc036), 0x5b);
        // 5B 00E9
        gbc.setState(0x419, 0xad79, 0x1ff0, 0xf10f, 0x2e1c, 0xf516, 0x0, 0x1);
        gbc.writeMem(0x419, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x1f);
        EXPECT(gbc.b(),  0xf1);
        EXPECT(gbc.c(),  0xf);
        EXPECT(gbc.d(),  0x2e);
        EXPECT(gbc.e(),  0x1c);
        EXPECT(gbc.h(),  0xf5);
        EXPECT(gbc.l(),  0x16);
        EXPECT(gbc.sp(), 0xad79);
        EXPECT(gbc.pc(), 0x41a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 00EA
        gbc.setState(0x3177, 0x1694, 0xc3c0, 0xba8f, 0xaa0, 0x3336, 0x0, 0x0);
        gbc.writeMem(0x3177, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xc3);
        EXPECT(gbc.b(),  0xba);
        EXPECT(gbc.c(),  0x8f);
        EXPECT(gbc.d(),  0xa);
        EXPECT(gbc.e(),  0xa0);
        EXPECT(gbc.h(),  0x33);
        EXPECT(gbc.l(),  0x36);
        EXPECT(gbc.sp(), 0x1694);
        EXPECT(gbc.pc(), 0x3178);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 00EC
        gbc.setState(0x1e6d, 0x1e3d, 0x89f0, 0xf0e8, 0xc92, 0x3865, 0x0, 0x1);
        gbc.writeMem(0x1e6d, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x89);
        EXPECT(gbc.b(),  0xf0);
        EXPECT(gbc.c(),  0xe8);
        EXPECT(gbc.d(),  0xc);
        EXPECT(gbc.e(),  0x92);
        EXPECT(gbc.h(),  0x38);
        EXPECT(gbc.l(),  0x65);
        EXPECT(gbc.sp(), 0x1e3d);
        EXPECT(gbc.pc(), 0x1e6e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 00ED
        gbc.setState(0x74ab, 0xc7f1, 0xb010, 0xca60, 0x8c88, 0xf55a, 0x0, 0x0);
        gbc.writeMem(0x74ab, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xb0);
        EXPECT(gbc.b(),  0xca);
        EXPECT(gbc.c(),  0x60);
        EXPECT(gbc.d(),  0x8c);
        EXPECT(gbc.e(),  0x88);
        EXPECT(gbc.h(),  0xf5);
        EXPECT(gbc.l(),  0x5a);
        EXPECT(gbc.sp(), 0xc7f1);
        EXPECT(gbc.pc(), 0x74ac);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 00EE
        gbc.setState(0x836a, 0x7b4f, 0x25a0, 0x7670, 0xbed1, 0xeae8, 0x0, 0x0);
        gbc.writeMem(0x836a, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x25);
        EXPECT(gbc.b(),  0x76);
        EXPECT(gbc.c(),  0x70);
        EXPECT(gbc.d(),  0xbe);
        EXPECT(gbc.e(),  0xd1);
        EXPECT(gbc.h(),  0xea);
        EXPECT(gbc.l(),  0xe8);
        EXPECT(gbc.sp(), 0x7b4f);
        EXPECT(gbc.pc(), 0x836b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x836a), 0x5b);
        // 5B 00EF
        gbc.setState(0x5b69, 0x3185, 0xdf30, 0xe209, 0x6452, 0x2932, 0x1, 0x0);
        gbc.writeMem(0x5b69, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xdf);
        EXPECT(gbc.b(),  0xe2);
        EXPECT(gbc.c(),  0x9);
        EXPECT(gbc.d(),  0x64);
        EXPECT(gbc.e(),  0x52);
        EXPECT(gbc.h(),  0x29);
        EXPECT(gbc.l(),  0x32);
        EXPECT(gbc.sp(), 0x3185);
        EXPECT(gbc.pc(), 0x5b6a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 00F0
        gbc.setState(0xafa6, 0xd51a, 0x9600, 0x686a, 0xc44f, 0xccb, 0x1, 0x1);
        gbc.writeMem(0xafa6, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x96);
        EXPECT(gbc.b(),  0x68);
        EXPECT(gbc.c(),  0x6a);
        EXPECT(gbc.d(),  0xc4);
        EXPECT(gbc.e(),  0x4f);
        EXPECT(gbc.h(),  0xc);
        EXPECT(gbc.l(),  0xcb);
        EXPECT(gbc.sp(), 0xd51a);
        EXPECT(gbc.pc(), 0xafa7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xafa6), 0x5b);
        // 5B 00F1
        gbc.setState(0x3c37, 0x95d6, 0x1f10, 0x7c6e, 0x23c5, 0xcc, 0x1, 0x1);
        gbc.writeMem(0x3c37, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x1f);
        EXPECT(gbc.b(),  0x7c);
        EXPECT(gbc.c(),  0x6e);
        EXPECT(gbc.d(),  0x23);
        EXPECT(gbc.e(),  0xc5);
        EXPECT(gbc.h(),  0x0);
        EXPECT(gbc.l(),  0xcc);
        EXPECT(gbc.sp(), 0x95d6);
        EXPECT(gbc.pc(), 0x3c38);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 00F2
        gbc.setState(0xc301, 0xe123, 0xc410, 0xa8a, 0x36e3, 0x41b8, 0x0, 0x1);
        gbc.writeMem(0xc301, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xc4);
        EXPECT(gbc.b(),  0xa);
        EXPECT(gbc.c(),  0x8a);
        EXPECT(gbc.d(),  0x36);
        EXPECT(gbc.e(),  0xe3);
        EXPECT(gbc.h(),  0x41);
        EXPECT(gbc.l(),  0xb8);
        EXPECT(gbc.sp(), 0xe123);
        EXPECT(gbc.pc(), 0xc302);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc301), 0x5b);
        // 5B 00F3
        gbc.setState(0x85f0, 0x1090, 0x5540, 0x6ccb, 0x57fc, 0xf605, 0x0, 0x1);
        gbc.writeMem(0x85f0, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x55);
        EXPECT(gbc.b(),  0x6c);
        EXPECT(gbc.c(),  0xcb);
        EXPECT(gbc.d(),  0x57);
        EXPECT(gbc.e(),  0xfc);
        EXPECT(gbc.h(),  0xf6);
        EXPECT(gbc.l(),  0x5);
        EXPECT(gbc.sp(), 0x1090);
        EXPECT(gbc.pc(), 0x85f1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x85f0), 0x5b);
        // 5B 00F4
        gbc.setState(0x71fa, 0xf8a, 0x67a0, 0xbf1b, 0x570c, 0x95c0, 0x0, 0x0);
        gbc.writeMem(0x71fa, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x67);
        EXPECT(gbc.b(),  0xbf);
        EXPECT(gbc.c(),  0x1b);
        EXPECT(gbc.d(),  0x57);
        EXPECT(gbc.e(),  0xc);
        EXPECT(gbc.h(),  0x95);
        EXPECT(gbc.l(),  0xc0);
        EXPECT(gbc.sp(), 0xf8a);
        EXPECT(gbc.pc(), 0x71fb);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 00F5
        gbc.setState(0x42d, 0xa690, 0xd100, 0xa5d4, 0xfab4, 0xda54, 0x1, 0x0);
        gbc.writeMem(0x42d, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd1);
        EXPECT(gbc.b(),  0xa5);
        EXPECT(gbc.c(),  0xd4);
        EXPECT(gbc.d(),  0xfa);
        EXPECT(gbc.e(),  0xb4);
        EXPECT(gbc.h(),  0xda);
        EXPECT(gbc.l(),  0x54);
        EXPECT(gbc.sp(), 0xa690);
        EXPECT(gbc.pc(), 0x42e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 00F6
        gbc.setState(0xcbd5, 0x6154, 0xbe50, 0xb98f, 0xd391, 0x5063, 0x1, 0x0);
        gbc.writeMem(0xcbd5, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xbe);
        EXPECT(gbc.b(),  0xb9);
        EXPECT(gbc.c(),  0x8f);
        EXPECT(gbc.d(),  0xd3);
        EXPECT(gbc.e(),  0x91);
        EXPECT(gbc.h(),  0x50);
        EXPECT(gbc.l(),  0x63);
        EXPECT(gbc.sp(), 0x6154);
        EXPECT(gbc.pc(), 0xcbd6);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcbd5), 0x5b);
        // 5B 00F7
        gbc.setState(0xe3de, 0x93c2, 0x75d0, 0x1844, 0x72a, 0x2f3b, 0x0, 0x1);
        gbc.writeMem(0xe3de, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x75);
        EXPECT(gbc.b(),  0x18);
        EXPECT(gbc.c(),  0x44);
        EXPECT(gbc.d(),  0x7);
        EXPECT(gbc.e(),  0x2a);
        EXPECT(gbc.h(),  0x2f);
        EXPECT(gbc.l(),  0x3b);
        EXPECT(gbc.sp(), 0x93c2);
        EXPECT(gbc.pc(), 0xe3df);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe3de), 0x5b);
        // 5B 00F8
        gbc.setState(0x4537, 0x81a3, 0x9fd0, 0x20c0, 0x6d19, 0xce39, 0x1, 0x0);
        gbc.writeMem(0x4537, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x9f);
        EXPECT(gbc.b(),  0x20);
        EXPECT(gbc.c(),  0xc0);
        EXPECT(gbc.d(),  0x6d);
        EXPECT(gbc.e(),  0x19);
        EXPECT(gbc.h(),  0xce);
        EXPECT(gbc.l(),  0x39);
        EXPECT(gbc.sp(), 0x81a3);
        EXPECT(gbc.pc(), 0x4538);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 00F9
        gbc.setState(0x7c7a, 0xcf2f, 0x8700, 0x323a, 0x79a0, 0xae49, 0x1, 0x0);
        gbc.writeMem(0x7c7a, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x87);
        EXPECT(gbc.b(),  0x32);
        EXPECT(gbc.c(),  0x3a);
        EXPECT(gbc.d(),  0x79);
        EXPECT(gbc.e(),  0xa0);
        EXPECT(gbc.h(),  0xae);
        EXPECT(gbc.l(),  0x49);
        EXPECT(gbc.sp(), 0xcf2f);
        EXPECT(gbc.pc(), 0x7c7b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 00FA
        gbc.setState(0x1bd2, 0xce2f, 0x1530, 0x1493, 0x4b1f, 0x8231, 0x1, 0x1);
        gbc.writeMem(0x1bd2, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x15);
        EXPECT(gbc.b(),  0x14);
        EXPECT(gbc.c(),  0x93);
        EXPECT(gbc.d(),  0x4b);
        EXPECT(gbc.e(),  0x1f);
        EXPECT(gbc.h(),  0x82);
        EXPECT(gbc.l(),  0x31);
        EXPECT(gbc.sp(), 0xce2f);
        EXPECT(gbc.pc(), 0x1bd3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 00FB
        gbc.setState(0x9615, 0x9cc1, 0xc230, 0x2a0, 0xb123, 0xd816, 0x1, 0x1);
        gbc.writeMem(0x9615, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xc2);
        EXPECT(gbc.b(),  0x2);
        EXPECT(gbc.c(),  0xa0);
        EXPECT(gbc.d(),  0xb1);
        EXPECT(gbc.e(),  0x23);
        EXPECT(gbc.h(),  0xd8);
        EXPECT(gbc.l(),  0x16);
        EXPECT(gbc.sp(), 0x9cc1);
        EXPECT(gbc.pc(), 0x9616);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9615), 0x5b);
        // 5B 00FC
        gbc.setState(0x2edc, 0xdb4b, 0x1900, 0x95c6, 0xfc2e, 0x220c, 0x1, 0x1);
        gbc.writeMem(0x2edc, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x19);
        EXPECT(gbc.b(),  0x95);
        EXPECT(gbc.c(),  0xc6);
        EXPECT(gbc.d(),  0xfc);
        EXPECT(gbc.e(),  0x2e);
        EXPECT(gbc.h(),  0x22);
        EXPECT(gbc.l(),  0xc);
        EXPECT(gbc.sp(), 0xdb4b);
        EXPECT(gbc.pc(), 0x2edd);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 00FD
        gbc.setState(0x1472, 0x9595, 0x3ee0, 0xe9a0, 0xedde, 0xc9d9, 0x0, 0x1);
        gbc.writeMem(0x1472, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x3e);
        EXPECT(gbc.b(),  0xe9);
        EXPECT(gbc.c(),  0xa0);
        EXPECT(gbc.d(),  0xed);
        EXPECT(gbc.e(),  0xde);
        EXPECT(gbc.h(),  0xc9);
        EXPECT(gbc.l(),  0xd9);
        EXPECT(gbc.sp(), 0x9595);
        EXPECT(gbc.pc(), 0x1473);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 00FE
        gbc.setState(0xad96, 0x8b72, 0xc6a0, 0x956c, 0x60ca, 0xa89d, 0x1, 0x1);
        gbc.writeMem(0xad96, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xc6);
        EXPECT(gbc.b(),  0x95);
        EXPECT(gbc.c(),  0x6c);
        EXPECT(gbc.d(),  0x60);
        EXPECT(gbc.e(),  0xca);
        EXPECT(gbc.h(),  0xa8);
        EXPECT(gbc.l(),  0x9d);
        EXPECT(gbc.sp(), 0x8b72);
        EXPECT(gbc.pc(), 0xad97);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xad96), 0x5b);
        // 5B 00FF
        gbc.setState(0x5c52, 0x8f54, 0xb010, 0x1692, 0x341a, 0x4024, 0x1, 0x0);
        gbc.writeMem(0x5c52, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xb0);
        EXPECT(gbc.b(),  0x16);
        EXPECT(gbc.c(),  0x92);
        EXPECT(gbc.d(),  0x34);
        EXPECT(gbc.e(),  0x1a);
        EXPECT(gbc.h(),  0x40);
        EXPECT(gbc.l(),  0x24);
        EXPECT(gbc.sp(), 0x8f54);
        EXPECT(gbc.pc(), 0x5c53);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 0100
        gbc.setState(0x1e98, 0x917d, 0x800, 0x7bf1, 0x7a6f, 0xa49e, 0x0, 0x1);
        gbc.writeMem(0x1e98, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0x7b);
        EXPECT(gbc.c(),  0xf1);
        EXPECT(gbc.d(),  0x7a);
        EXPECT(gbc.e(),  0x6f);
        EXPECT(gbc.h(),  0xa4);
        EXPECT(gbc.l(),  0x9e);
        EXPECT(gbc.sp(), 0x917d);
        EXPECT(gbc.pc(), 0x1e99);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0101
        gbc.setState(0x55aa, 0x4e72, 0x9c10, 0x58e6, 0xbb70, 0x31a, 0x0, 0x0);
        gbc.writeMem(0x55aa, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x9c);
        EXPECT(gbc.b(),  0x58);
        EXPECT(gbc.c(),  0xe6);
        EXPECT(gbc.d(),  0xbb);
        EXPECT(gbc.e(),  0x70);
        EXPECT(gbc.h(),  0x3);
        EXPECT(gbc.l(),  0x1a);
        EXPECT(gbc.sp(), 0x4e72);
        EXPECT(gbc.pc(), 0x55ab);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 0102
        gbc.setState(0xe6a4, 0x814d, 0xa560, 0x3c1c, 0x2739, 0x6c42, 0x1, 0x1);
        gbc.writeMem(0xe6a4, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa5);
        EXPECT(gbc.b(),  0x3c);
        EXPECT(gbc.c(),  0x1c);
        EXPECT(gbc.d(),  0x27);
        EXPECT(gbc.e(),  0x39);
        EXPECT(gbc.h(),  0x6c);
        EXPECT(gbc.l(),  0x42);
        EXPECT(gbc.sp(), 0x814d);
        EXPECT(gbc.pc(), 0xe6a5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe6a4), 0x5b);
        // 5B 0103
        gbc.setState(0xe340, 0xdb36, 0x790, 0x7ba, 0x8e15, 0x7d48, 0x1, 0x0);
        gbc.writeMem(0xe340, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x7);
        EXPECT(gbc.b(),  0x7);
        EXPECT(gbc.c(),  0xba);
        EXPECT(gbc.d(),  0x8e);
        EXPECT(gbc.e(),  0x15);
        EXPECT(gbc.h(),  0x7d);
        EXPECT(gbc.l(),  0x48);
        EXPECT(gbc.sp(), 0xdb36);
        EXPECT(gbc.pc(), 0xe341);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe340), 0x5b);
        // 5B 0104
        gbc.setState(0x5e81, 0x1f1f, 0x17e0, 0xe49c, 0x20c7, 0x84a7, 0x0, 0x1);
        gbc.writeMem(0x5e81, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x17);
        EXPECT(gbc.b(),  0xe4);
        EXPECT(gbc.c(),  0x9c);
        EXPECT(gbc.d(),  0x20);
        EXPECT(gbc.e(),  0xc7);
        EXPECT(gbc.h(),  0x84);
        EXPECT(gbc.l(),  0xa7);
        EXPECT(gbc.sp(), 0x1f1f);
        EXPECT(gbc.pc(), 0x5e82);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0105
        gbc.setState(0xb375, 0x7b1a, 0xaa70, 0x10b5, 0x9fb4, 0xb665, 0x1, 0x1);
        gbc.writeMem(0xb375, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xaa);
        EXPECT(gbc.b(),  0x10);
        EXPECT(gbc.c(),  0xb5);
        EXPECT(gbc.d(),  0x9f);
        EXPECT(gbc.e(),  0xb4);
        EXPECT(gbc.h(),  0xb6);
        EXPECT(gbc.l(),  0x65);
        EXPECT(gbc.sp(), 0x7b1a);
        EXPECT(gbc.pc(), 0xb376);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb375), 0x5b);
        // 5B 0106
        gbc.setState(0xddae, 0xe628, 0x41f0, 0x33e9, 0xbde6, 0x51a3, 0x0, 0x0);
        gbc.writeMem(0xddae, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x41);
        EXPECT(gbc.b(),  0x33);
        EXPECT(gbc.c(),  0xe9);
        EXPECT(gbc.d(),  0xbd);
        EXPECT(gbc.e(),  0xe6);
        EXPECT(gbc.h(),  0x51);
        EXPECT(gbc.l(),  0xa3);
        EXPECT(gbc.sp(), 0xe628);
        EXPECT(gbc.pc(), 0xddaf);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xddae), 0x5b);
        // 5B 0107
        gbc.setState(0xee1a, 0xcf95, 0xf390, 0xcb3, 0x5b98, 0x75ae, 0x1, 0x1);
        gbc.writeMem(0xee1a, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf3);
        EXPECT(gbc.b(),  0xc);
        EXPECT(gbc.c(),  0xb3);
        EXPECT(gbc.d(),  0x5b);
        EXPECT(gbc.e(),  0x98);
        EXPECT(gbc.h(),  0x75);
        EXPECT(gbc.l(),  0xae);
        EXPECT(gbc.sp(), 0xcf95);
        EXPECT(gbc.pc(), 0xee1b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xee1a), 0x5b);
        // 5B 0108
        gbc.setState(0x907f, 0x146b, 0x3010, 0x5d28, 0x7542, 0xc16b, 0x1, 0x0);
        gbc.writeMem(0x907f, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x30);
        EXPECT(gbc.b(),  0x5d);
        EXPECT(gbc.c(),  0x28);
        EXPECT(gbc.d(),  0x75);
        EXPECT(gbc.e(),  0x42);
        EXPECT(gbc.h(),  0xc1);
        EXPECT(gbc.l(),  0x6b);
        EXPECT(gbc.sp(), 0x146b);
        EXPECT(gbc.pc(), 0x9080);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x907f), 0x5b);
        // 5B 0109
        gbc.setState(0xd332, 0xea7d, 0xced0, 0x10d7, 0x631d, 0x46ef, 0x1, 0x0);
        gbc.writeMem(0xd332, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xce);
        EXPECT(gbc.b(),  0x10);
        EXPECT(gbc.c(),  0xd7);
        EXPECT(gbc.d(),  0x63);
        EXPECT(gbc.e(),  0x1d);
        EXPECT(gbc.h(),  0x46);
        EXPECT(gbc.l(),  0xef);
        EXPECT(gbc.sp(), 0xea7d);
        EXPECT(gbc.pc(), 0xd333);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd332), 0x5b);
        // 5B 010A
        gbc.setState(0x387, 0x652a, 0xdb70, 0xa9ab, 0x447a, 0xc4a8, 0x1, 0x0);
        gbc.writeMem(0x387, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xdb);
        EXPECT(gbc.b(),  0xa9);
        EXPECT(gbc.c(),  0xab);
        EXPECT(gbc.d(),  0x44);
        EXPECT(gbc.e(),  0x7a);
        EXPECT(gbc.h(),  0xc4);
        EXPECT(gbc.l(),  0xa8);
        EXPECT(gbc.sp(), 0x652a);
        EXPECT(gbc.pc(), 0x388);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 010B
        gbc.setState(0xc8ab, 0x9b9e, 0xa30, 0xbc36, 0x3cff, 0x459d, 0x0, 0x0);
        gbc.writeMem(0xc8ab, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa);
        EXPECT(gbc.b(),  0xbc);
        EXPECT(gbc.c(),  0x36);
        EXPECT(gbc.d(),  0x3c);
        EXPECT(gbc.e(),  0xff);
        EXPECT(gbc.h(),  0x45);
        EXPECT(gbc.l(),  0x9d);
        EXPECT(gbc.sp(), 0x9b9e);
        EXPECT(gbc.pc(), 0xc8ac);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc8ab), 0x5b);
        // 5B 010C
        gbc.setState(0xd240, 0xcd3c, 0x4d00, 0xa913, 0x221f, 0x6bc7, 0x1, 0x1);
        gbc.writeMem(0xd240, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x4d);
        EXPECT(gbc.b(),  0xa9);
        EXPECT(gbc.c(),  0x13);
        EXPECT(gbc.d(),  0x22);
        EXPECT(gbc.e(),  0x1f);
        EXPECT(gbc.h(),  0x6b);
        EXPECT(gbc.l(),  0xc7);
        EXPECT(gbc.sp(), 0xcd3c);
        EXPECT(gbc.pc(), 0xd241);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd240), 0x5b);
        // 5B 010D
        gbc.setState(0xd153, 0x3c1b, 0x85c0, 0x465b, 0xeaf8, 0x2f25, 0x0, 0x0);
        gbc.writeMem(0xd153, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x85);
        EXPECT(gbc.b(),  0x46);
        EXPECT(gbc.c(),  0x5b);
        EXPECT(gbc.d(),  0xea);
        EXPECT(gbc.e(),  0xf8);
        EXPECT(gbc.h(),  0x2f);
        EXPECT(gbc.l(),  0x25);
        EXPECT(gbc.sp(), 0x3c1b);
        EXPECT(gbc.pc(), 0xd154);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd153), 0x5b);
        // 5B 010E
        gbc.setState(0xe1b4, 0xc4ca, 0x18c0, 0x54b8, 0x2561, 0x9be5, 0x0, 0x1);
        gbc.writeMem(0xe1b4, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x18);
        EXPECT(gbc.b(),  0x54);
        EXPECT(gbc.c(),  0xb8);
        EXPECT(gbc.d(),  0x25);
        EXPECT(gbc.e(),  0x61);
        EXPECT(gbc.h(),  0x9b);
        EXPECT(gbc.l(),  0xe5);
        EXPECT(gbc.sp(), 0xc4ca);
        EXPECT(gbc.pc(), 0xe1b5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe1b4), 0x5b);
        // 5B 010F
        gbc.setState(0x7cea, 0x80e5, 0x1fb0, 0xdd48, 0x75b5, 0x25d4, 0x1, 0x0);
        gbc.writeMem(0x7cea, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x1f);
        EXPECT(gbc.b(),  0xdd);
        EXPECT(gbc.c(),  0x48);
        EXPECT(gbc.d(),  0x75);
        EXPECT(gbc.e(),  0xb5);
        EXPECT(gbc.h(),  0x25);
        EXPECT(gbc.l(),  0xd4);
        EXPECT(gbc.sp(), 0x80e5);
        EXPECT(gbc.pc(), 0x7ceb);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0110
        gbc.setState(0xf2d, 0xc60a, 0x2b20, 0xa73b, 0xe3c0, 0x29, 0x0, 0x1);
        gbc.writeMem(0xf2d, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x2b);
        EXPECT(gbc.b(),  0xa7);
        EXPECT(gbc.c(),  0x3b);
        EXPECT(gbc.d(),  0xe3);
        EXPECT(gbc.e(),  0xc0);
        EXPECT(gbc.h(),  0x0);
        EXPECT(gbc.l(),  0x29);
        EXPECT(gbc.sp(), 0xc60a);
        EXPECT(gbc.pc(), 0xf2e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0111
        gbc.setState(0xab96, 0xc39, 0xb420, 0xe1aa, 0x3a6, 0x9349, 0x0, 0x0);
        gbc.writeMem(0xab96, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xb4);
        EXPECT(gbc.b(),  0xe1);
        EXPECT(gbc.c(),  0xaa);
        EXPECT(gbc.d(),  0x3);
        EXPECT(gbc.e(),  0xa6);
        EXPECT(gbc.h(),  0x93);
        EXPECT(gbc.l(),  0x49);
        EXPECT(gbc.sp(), 0xc39);
        EXPECT(gbc.pc(), 0xab97);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xab96), 0x5b);
        // 5B 0112
        gbc.setState(0x2096, 0xdf6, 0x35f0, 0xefc7, 0xa2af, 0xcbf4, 0x0, 0x0);
        gbc.writeMem(0x2096, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x35);
        EXPECT(gbc.b(),  0xef);
        EXPECT(gbc.c(),  0xc7);
        EXPECT(gbc.d(),  0xa2);
        EXPECT(gbc.e(),  0xaf);
        EXPECT(gbc.h(),  0xcb);
        EXPECT(gbc.l(),  0xf4);
        EXPECT(gbc.sp(), 0xdf6);
        EXPECT(gbc.pc(), 0x2097);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0113
        gbc.setState(0x7773, 0xe5a, 0xf360, 0x2191, 0xf5d5, 0xd77, 0x0, 0x0);
        gbc.writeMem(0x7773, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf3);
        EXPECT(gbc.b(),  0x21);
        EXPECT(gbc.c(),  0x91);
        EXPECT(gbc.d(),  0xf5);
        EXPECT(gbc.e(),  0xd5);
        EXPECT(gbc.h(),  0xd);
        EXPECT(gbc.l(),  0x77);
        EXPECT(gbc.sp(), 0xe5a);
        EXPECT(gbc.pc(), 0x7774);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0114
        gbc.setState(0x9c6d, 0x23a7, 0xc90, 0xf73a, 0xd61c, 0x7aa1, 0x1, 0x0);
        gbc.writeMem(0x9c6d, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xc);
        EXPECT(gbc.b(),  0xf7);
        EXPECT(gbc.c(),  0x3a);
        EXPECT(gbc.d(),  0xd6);
        EXPECT(gbc.e(),  0x1c);
        EXPECT(gbc.h(),  0x7a);
        EXPECT(gbc.l(),  0xa1);
        EXPECT(gbc.sp(), 0x23a7);
        EXPECT(gbc.pc(), 0x9c6e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9c6d), 0x5b);
        // 5B 0115
        gbc.setState(0xd3c, 0xa7b9, 0x2220, 0xcef0, 0x40e8, 0x442e, 0x0, 0x1);
        gbc.writeMem(0xd3c, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x22);
        EXPECT(gbc.b(),  0xce);
        EXPECT(gbc.c(),  0xf0);
        EXPECT(gbc.d(),  0x40);
        EXPECT(gbc.e(),  0xe8);
        EXPECT(gbc.h(),  0x44);
        EXPECT(gbc.l(),  0x2e);
        EXPECT(gbc.sp(), 0xa7b9);
        EXPECT(gbc.pc(), 0xd3d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0116
        gbc.setState(0xb260, 0x3c2d, 0x63e0, 0xb92b, 0xa92f, 0xdec7, 0x0, 0x0);
        gbc.writeMem(0xb260, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x63);
        EXPECT(gbc.b(),  0xb9);
        EXPECT(gbc.c(),  0x2b);
        EXPECT(gbc.d(),  0xa9);
        EXPECT(gbc.e(),  0x2f);
        EXPECT(gbc.h(),  0xde);
        EXPECT(gbc.l(),  0xc7);
        EXPECT(gbc.sp(), 0x3c2d);
        EXPECT(gbc.pc(), 0xb261);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb260), 0x5b);
        // 5B 0117
        gbc.setState(0xdc43, 0x207d, 0x5640, 0x7728, 0xec6, 0x1853, 0x0, 0x1);
        gbc.writeMem(0xdc43, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x56);
        EXPECT(gbc.b(),  0x77);
        EXPECT(gbc.c(),  0x28);
        EXPECT(gbc.d(),  0xe);
        EXPECT(gbc.e(),  0xc6);
        EXPECT(gbc.h(),  0x18);
        EXPECT(gbc.l(),  0x53);
        EXPECT(gbc.sp(), 0x207d);
        EXPECT(gbc.pc(), 0xdc44);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdc43), 0x5b);
        // 5B 0118
        gbc.setState(0xf26, 0x10ee, 0xc290, 0xa88a, 0xc783, 0x6c39, 0x0, 0x1);
        gbc.writeMem(0xf26, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xc2);
        EXPECT(gbc.b(),  0xa8);
        EXPECT(gbc.c(),  0x8a);
        EXPECT(gbc.d(),  0xc7);
        EXPECT(gbc.e(),  0x83);
        EXPECT(gbc.h(),  0x6c);
        EXPECT(gbc.l(),  0x39);
        EXPECT(gbc.sp(), 0x10ee);
        EXPECT(gbc.pc(), 0xf27);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 0119
        gbc.setState(0x6880, 0x261a, 0xb9f0, 0x73ed, 0x21de, 0xff97, 0x0, 0x1);
        gbc.writeMem(0x6880, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xb9);
        EXPECT(gbc.b(),  0x73);
        EXPECT(gbc.c(),  0xed);
        EXPECT(gbc.d(),  0x21);
        EXPECT(gbc.e(),  0xde);
        EXPECT(gbc.h(),  0xff);
        EXPECT(gbc.l(),  0x97);
        EXPECT(gbc.sp(), 0x261a);
        EXPECT(gbc.pc(), 0x6881);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 011A
        gbc.setState(0x73a9, 0xb4f3, 0x8b30, 0x2467, 0xff22, 0xaa68, 0x0, 0x0);
        gbc.writeMem(0x73a9, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x8b);
        EXPECT(gbc.b(),  0x24);
        EXPECT(gbc.c(),  0x67);
        EXPECT(gbc.d(),  0xff);
        EXPECT(gbc.e(),  0x22);
        EXPECT(gbc.h(),  0xaa);
        EXPECT(gbc.l(),  0x68);
        EXPECT(gbc.sp(), 0xb4f3);
        EXPECT(gbc.pc(), 0x73aa);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 011B
        gbc.setState(0x8310, 0xe07e, 0x1310, 0xa97, 0x9335, 0x8bd, 0x0, 0x0);
        gbc.writeMem(0x8310, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x13);
        EXPECT(gbc.b(),  0xa);
        EXPECT(gbc.c(),  0x97);
        EXPECT(gbc.d(),  0x93);
        EXPECT(gbc.e(),  0x35);
        EXPECT(gbc.h(),  0x8);
        EXPECT(gbc.l(),  0xbd);
        EXPECT(gbc.sp(), 0xe07e);
        EXPECT(gbc.pc(), 0x8311);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8310), 0x5b);
        // 5B 011C
        gbc.setState(0x5954, 0x96e7, 0x9610, 0x3cc1, 0x8e43, 0xcbc2, 0x1, 0x0);
        gbc.writeMem(0x5954, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x96);
        EXPECT(gbc.b(),  0x3c);
        EXPECT(gbc.c(),  0xc1);
        EXPECT(gbc.d(),  0x8e);
        EXPECT(gbc.e(),  0x43);
        EXPECT(gbc.h(),  0xcb);
        EXPECT(gbc.l(),  0xc2);
        EXPECT(gbc.sp(), 0x96e7);
        EXPECT(gbc.pc(), 0x5955);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 011D
        gbc.setState(0x25fd, 0x650, 0x3070, 0x8a7d, 0xef41, 0x5100, 0x0, 0x1);
        gbc.writeMem(0x25fd, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x30);
        EXPECT(gbc.b(),  0x8a);
        EXPECT(gbc.c(),  0x7d);
        EXPECT(gbc.d(),  0xef);
        EXPECT(gbc.e(),  0x41);
        EXPECT(gbc.h(),  0x51);
        EXPECT(gbc.l(),  0x0);
        EXPECT(gbc.sp(), 0x650);
        EXPECT(gbc.pc(), 0x25fe);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 011E
        gbc.setState(0x8d48, 0xd4f, 0x1a40, 0xedc5, 0x9f1b, 0xbfa5, 0x1, 0x0);
        gbc.writeMem(0x8d48, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x1a);
        EXPECT(gbc.b(),  0xed);
        EXPECT(gbc.c(),  0xc5);
        EXPECT(gbc.d(),  0x9f);
        EXPECT(gbc.e(),  0x1b);
        EXPECT(gbc.h(),  0xbf);
        EXPECT(gbc.l(),  0xa5);
        EXPECT(gbc.sp(), 0xd4f);
        EXPECT(gbc.pc(), 0x8d49);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8d48), 0x5b);
        // 5B 011F
        gbc.setState(0x3582, 0x2718, 0xaf00, 0xdf6a, 0x6442, 0xb345, 0x0, 0x1);
        gbc.writeMem(0x3582, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xaf);
        EXPECT(gbc.b(),  0xdf);
        EXPECT(gbc.c(),  0x6a);
        EXPECT(gbc.d(),  0x64);
        EXPECT(gbc.e(),  0x42);
        EXPECT(gbc.h(),  0xb3);
        EXPECT(gbc.l(),  0x45);
        EXPECT(gbc.sp(), 0x2718);
        EXPECT(gbc.pc(), 0x3583);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0120
        gbc.setState(0xeb61, 0xb3ab, 0xde60, 0xfd09, 0xb8b4, 0xaa8, 0x1, 0x0);
        gbc.writeMem(0xeb61, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xde);
        EXPECT(gbc.b(),  0xfd);
        EXPECT(gbc.c(),  0x9);
        EXPECT(gbc.d(),  0xb8);
        EXPECT(gbc.e(),  0xb4);
        EXPECT(gbc.h(),  0xa);
        EXPECT(gbc.l(),  0xa8);
        EXPECT(gbc.sp(), 0xb3ab);
        EXPECT(gbc.pc(), 0xeb62);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xeb61), 0x5b);
        // 5B 0121
        gbc.setState(0x3127, 0x821f, 0x5520, 0x166f, 0x7f6c, 0x7822, 0x0, 0x0);
        gbc.writeMem(0x3127, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x55);
        EXPECT(gbc.b(),  0x16);
        EXPECT(gbc.c(),  0x6f);
        EXPECT(gbc.d(),  0x7f);
        EXPECT(gbc.e(),  0x6c);
        EXPECT(gbc.h(),  0x78);
        EXPECT(gbc.l(),  0x22);
        EXPECT(gbc.sp(), 0x821f);
        EXPECT(gbc.pc(), 0x3128);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0122
        gbc.setState(0x4fb7, 0x32ad, 0xb6d0, 0x2d2b, 0x89fd, 0xb355, 0x1, 0x1);
        gbc.writeMem(0x4fb7, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xb6);
        EXPECT(gbc.b(),  0x2d);
        EXPECT(gbc.c(),  0x2b);
        EXPECT(gbc.d(),  0x89);
        EXPECT(gbc.e(),  0xfd);
        EXPECT(gbc.h(),  0xb3);
        EXPECT(gbc.l(),  0x55);
        EXPECT(gbc.sp(), 0x32ad);
        EXPECT(gbc.pc(), 0x4fb8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 0123
        gbc.setState(0xd2b7, 0x86a0, 0xa9c0, 0xcd1e, 0x8f73, 0x219c, 0x1, 0x1);
        gbc.writeMem(0xd2b7, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa9);
        EXPECT(gbc.b(),  0xcd);
        EXPECT(gbc.c(),  0x1e);
        EXPECT(gbc.d(),  0x8f);
        EXPECT(gbc.e(),  0x73);
        EXPECT(gbc.h(),  0x21);
        EXPECT(gbc.l(),  0x9c);
        EXPECT(gbc.sp(), 0x86a0);
        EXPECT(gbc.pc(), 0xd2b8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd2b7), 0x5b);
        // 5B 0124
        gbc.setState(0x9a06, 0x7165, 0x7eb0, 0xc8ad, 0xc1b4, 0xba60, 0x0, 0x0);
        gbc.writeMem(0x9a06, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x7e);
        EXPECT(gbc.b(),  0xc8);
        EXPECT(gbc.c(),  0xad);
        EXPECT(gbc.d(),  0xc1);
        EXPECT(gbc.e(),  0xb4);
        EXPECT(gbc.h(),  0xba);
        EXPECT(gbc.l(),  0x60);
        EXPECT(gbc.sp(), 0x7165);
        EXPECT(gbc.pc(), 0x9a07);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9a06), 0x5b);
        // 5B 0125
        gbc.setState(0xd513, 0xa337, 0x9e40, 0xf7f, 0xdc83, 0x47ea, 0x1, 0x1);
        gbc.writeMem(0xd513, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x9e);
        EXPECT(gbc.b(),  0xf);
        EXPECT(gbc.c(),  0x7f);
        EXPECT(gbc.d(),  0xdc);
        EXPECT(gbc.e(),  0x83);
        EXPECT(gbc.h(),  0x47);
        EXPECT(gbc.l(),  0xea);
        EXPECT(gbc.sp(), 0xa337);
        EXPECT(gbc.pc(), 0xd514);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd513), 0x5b);
        // 5B 0126
        gbc.setState(0xa89b, 0xa28, 0x370, 0xadc, 0xf5d1, 0x92be, 0x0, 0x1);
        gbc.writeMem(0xa89b, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x3);
        EXPECT(gbc.b(),  0xa);
        EXPECT(gbc.c(),  0xdc);
        EXPECT(gbc.d(),  0xf5);
        EXPECT(gbc.e(),  0xd1);
        EXPECT(gbc.h(),  0x92);
        EXPECT(gbc.l(),  0xbe);
        EXPECT(gbc.sp(), 0xa28);
        EXPECT(gbc.pc(), 0xa89c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa89b), 0x5b);
        // 5B 0127
        gbc.setState(0xd974, 0xfefd, 0x3be0, 0xead5, 0xc761, 0x4b9d, 0x1, 0x0);
        gbc.writeMem(0xd974, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x3b);
        EXPECT(gbc.b(),  0xea);
        EXPECT(gbc.c(),  0xd5);
        EXPECT(gbc.d(),  0xc7);
        EXPECT(gbc.e(),  0x61);
        EXPECT(gbc.h(),  0x4b);
        EXPECT(gbc.l(),  0x9d);
        EXPECT(gbc.sp(), 0xfefd);
        EXPECT(gbc.pc(), 0xd975);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd974), 0x5b);
        // 5B 0128
        gbc.setState(0x6a4b, 0x4dc5, 0x3830, 0x5d96, 0x1a8, 0xeb25, 0x1, 0x0);
        gbc.writeMem(0x6a4b, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x38);
        EXPECT(gbc.b(),  0x5d);
        EXPECT(gbc.c(),  0x96);
        EXPECT(gbc.d(),  0x1);
        EXPECT(gbc.e(),  0xa8);
        EXPECT(gbc.h(),  0xeb);
        EXPECT(gbc.l(),  0x25);
        EXPECT(gbc.sp(), 0x4dc5);
        EXPECT(gbc.pc(), 0x6a4c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0129
        gbc.setState(0x99c7, 0xe3fd, 0xb400, 0xa079, 0x9ac6, 0x638, 0x0, 0x0);
        gbc.writeMem(0x99c7, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xb4);
        EXPECT(gbc.b(),  0xa0);
        EXPECT(gbc.c(),  0x79);
        EXPECT(gbc.d(),  0x9a);
        EXPECT(gbc.e(),  0xc6);
        EXPECT(gbc.h(),  0x6);
        EXPECT(gbc.l(),  0x38);
        EXPECT(gbc.sp(), 0xe3fd);
        EXPECT(gbc.pc(), 0x99c8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x99c7), 0x5b);
        // 5B 012A
        gbc.setState(0x5bc3, 0x40f2, 0x2be0, 0x8119, 0xc509, 0xdf4d, 0x0, 0x0);
        gbc.writeMem(0x5bc3, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x2b);
        EXPECT(gbc.b(),  0x81);
        EXPECT(gbc.c(),  0x19);
        EXPECT(gbc.d(),  0xc5);
        EXPECT(gbc.e(),  0x9);
        EXPECT(gbc.h(),  0xdf);
        EXPECT(gbc.l(),  0x4d);
        EXPECT(gbc.sp(), 0x40f2);
        EXPECT(gbc.pc(), 0x5bc4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 012B
        gbc.setState(0xf7a, 0x14ed, 0x56f0, 0x26c0, 0xf1ab, 0xc014, 0x1, 0x0);
        gbc.writeMem(0xf7a, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x56);
        EXPECT(gbc.b(),  0x26);
        EXPECT(gbc.c(),  0xc0);
        EXPECT(gbc.d(),  0xf1);
        EXPECT(gbc.e(),  0xab);
        EXPECT(gbc.h(),  0xc0);
        EXPECT(gbc.l(),  0x14);
        EXPECT(gbc.sp(), 0x14ed);
        EXPECT(gbc.pc(), 0xf7b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 012C
        gbc.setState(0x3352, 0x8627, 0xcc20, 0x59ae, 0x7d4b, 0x1d19, 0x1, 0x0);
        gbc.writeMem(0x3352, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xcc);
        EXPECT(gbc.b(),  0x59);
        EXPECT(gbc.c(),  0xae);
        EXPECT(gbc.d(),  0x7d);
        EXPECT(gbc.e(),  0x4b);
        EXPECT(gbc.h(),  0x1d);
        EXPECT(gbc.l(),  0x19);
        EXPECT(gbc.sp(), 0x8627);
        EXPECT(gbc.pc(), 0x3353);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 012D
        gbc.setState(0x972, 0x9924, 0xdb20, 0x524d, 0xa0e2, 0x5c67, 0x0, 0x1);
        gbc.writeMem(0x972, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xdb);
        EXPECT(gbc.b(),  0x52);
        EXPECT(gbc.c(),  0x4d);
        EXPECT(gbc.d(),  0xa0);
        EXPECT(gbc.e(),  0xe2);
        EXPECT(gbc.h(),  0x5c);
        EXPECT(gbc.l(),  0x67);
        EXPECT(gbc.sp(), 0x9924);
        EXPECT(gbc.pc(), 0x973);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 012E
        gbc.setState(0x740e, 0xa036, 0xbe90, 0xc1a2, 0x73cf, 0xf5c4, 0x0, 0x1);
        gbc.writeMem(0x740e, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xbe);
        EXPECT(gbc.b(),  0xc1);
        EXPECT(gbc.c(),  0xa2);
        EXPECT(gbc.d(),  0x73);
        EXPECT(gbc.e(),  0xcf);
        EXPECT(gbc.h(),  0xf5);
        EXPECT(gbc.l(),  0xc4);
        EXPECT(gbc.sp(), 0xa036);
        EXPECT(gbc.pc(), 0x740f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 012F
        gbc.setState(0xb142, 0xf332, 0xf420, 0x6196, 0x7bf, 0x192b, 0x0, 0x1);
        gbc.writeMem(0xb142, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf4);
        EXPECT(gbc.b(),  0x61);
        EXPECT(gbc.c(),  0x96);
        EXPECT(gbc.d(),  0x7);
        EXPECT(gbc.e(),  0xbf);
        EXPECT(gbc.h(),  0x19);
        EXPECT(gbc.l(),  0x2b);
        EXPECT(gbc.sp(), 0xf332);
        EXPECT(gbc.pc(), 0xb143);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb142), 0x5b);
        // 5B 0130
        gbc.setState(0x56d2, 0x310c, 0x2190, 0x6fa7, 0x4d9c, 0xa342, 0x1, 0x0);
        gbc.writeMem(0x56d2, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x21);
        EXPECT(gbc.b(),  0x6f);
        EXPECT(gbc.c(),  0xa7);
        EXPECT(gbc.d(),  0x4d);
        EXPECT(gbc.e(),  0x9c);
        EXPECT(gbc.h(),  0xa3);
        EXPECT(gbc.l(),  0x42);
        EXPECT(gbc.sp(), 0x310c);
        EXPECT(gbc.pc(), 0x56d3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 0131
        gbc.setState(0x9ef6, 0xf77a, 0xd9d0, 0xdfc3, 0x31d8, 0x7e35, 0x1, 0x0);
        gbc.writeMem(0x9ef6, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd9);
        EXPECT(gbc.b(),  0xdf);
        EXPECT(gbc.c(),  0xc3);
        EXPECT(gbc.d(),  0x31);
        EXPECT(gbc.e(),  0xd8);
        EXPECT(gbc.h(),  0x7e);
        EXPECT(gbc.l(),  0x35);
        EXPECT(gbc.sp(), 0xf77a);
        EXPECT(gbc.pc(), 0x9ef7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9ef6), 0x5b);
        // 5B 0132
        gbc.setState(0x6c29, 0x2789, 0xbab0, 0xadfc, 0xd1ca, 0xb6db, 0x0, 0x0);
        gbc.writeMem(0x6c29, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xba);
        EXPECT(gbc.b(),  0xad);
        EXPECT(gbc.c(),  0xfc);
        EXPECT(gbc.d(),  0xd1);
        EXPECT(gbc.e(),  0xca);
        EXPECT(gbc.h(),  0xb6);
        EXPECT(gbc.l(),  0xdb);
        EXPECT(gbc.sp(), 0x2789);
        EXPECT(gbc.pc(), 0x6c2a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0133
        gbc.setState(0x9c3f, 0xbd, 0x5a20, 0x650d, 0x8973, 0xad9e, 0x1, 0x1);
        gbc.writeMem(0x9c3f, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x5a);
        EXPECT(gbc.b(),  0x65);
        EXPECT(gbc.c(),  0xd);
        EXPECT(gbc.d(),  0x89);
        EXPECT(gbc.e(),  0x73);
        EXPECT(gbc.h(),  0xad);
        EXPECT(gbc.l(),  0x9e);
        EXPECT(gbc.sp(), 0xbd);
        EXPECT(gbc.pc(), 0x9c40);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9c3f), 0x5b);
        // 5B 0134
        gbc.setState(0xa3d9, 0x14c1, 0x71f0, 0x6e4, 0x9575, 0xb128, 0x1, 0x0);
        gbc.writeMem(0xa3d9, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x71);
        EXPECT(gbc.b(),  0x6);
        EXPECT(gbc.c(),  0xe4);
        EXPECT(gbc.d(),  0x95);
        EXPECT(gbc.e(),  0x75);
        EXPECT(gbc.h(),  0xb1);
        EXPECT(gbc.l(),  0x28);
        EXPECT(gbc.sp(), 0x14c1);
        EXPECT(gbc.pc(), 0xa3da);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa3d9), 0x5b);
        // 5B 0135
        gbc.setState(0xb8fb, 0xa118, 0xd710, 0xc537, 0x3b57, 0xc633, 0x0, 0x0);
        gbc.writeMem(0xb8fb, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd7);
        EXPECT(gbc.b(),  0xc5);
        EXPECT(gbc.c(),  0x37);
        EXPECT(gbc.d(),  0x3b);
        EXPECT(gbc.e(),  0x57);
        EXPECT(gbc.h(),  0xc6);
        EXPECT(gbc.l(),  0x33);
        EXPECT(gbc.sp(), 0xa118);
        EXPECT(gbc.pc(), 0xb8fc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb8fb), 0x5b);
        // 5B 0136
        gbc.setState(0xbc26, 0xc466, 0xe8b0, 0x6fcc, 0xaa15, 0x1cb6, 0x0, 0x0);
        gbc.writeMem(0xbc26, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xe8);
        EXPECT(gbc.b(),  0x6f);
        EXPECT(gbc.c(),  0xcc);
        EXPECT(gbc.d(),  0xaa);
        EXPECT(gbc.e(),  0x15);
        EXPECT(gbc.h(),  0x1c);
        EXPECT(gbc.l(),  0xb6);
        EXPECT(gbc.sp(), 0xc466);
        EXPECT(gbc.pc(), 0xbc27);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbc26), 0x5b);
        // 5B 0138
        gbc.setState(0x19b7, 0xf9b7, 0x3e80, 0x42d4, 0xbb79, 0x14f0, 0x1, 0x0);
        gbc.writeMem(0x19b7, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x3e);
        EXPECT(gbc.b(),  0x42);
        EXPECT(gbc.c(),  0xd4);
        EXPECT(gbc.d(),  0xbb);
        EXPECT(gbc.e(),  0x79);
        EXPECT(gbc.h(),  0x14);
        EXPECT(gbc.l(),  0xf0);
        EXPECT(gbc.sp(), 0xf9b7);
        EXPECT(gbc.pc(), 0x19b8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0139
        gbc.setState(0xd59b, 0x7a17, 0x77c0, 0xe56f, 0xa529, 0x5160, 0x1, 0x0);
        gbc.writeMem(0xd59b, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x77);
        EXPECT(gbc.b(),  0xe5);
        EXPECT(gbc.c(),  0x6f);
        EXPECT(gbc.d(),  0xa5);
        EXPECT(gbc.e(),  0x29);
        EXPECT(gbc.h(),  0x51);
        EXPECT(gbc.l(),  0x60);
        EXPECT(gbc.sp(), 0x7a17);
        EXPECT(gbc.pc(), 0xd59c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd59b), 0x5b);
        // 5B 013A
        gbc.setState(0xc4d6, 0xc83f, 0x5740, 0xa8d5, 0xa247, 0xbf7f, 0x0, 0x1);
        gbc.writeMem(0xc4d6, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x57);
        EXPECT(gbc.b(),  0xa8);
        EXPECT(gbc.c(),  0xd5);
        EXPECT(gbc.d(),  0xa2);
        EXPECT(gbc.e(),  0x47);
        EXPECT(gbc.h(),  0xbf);
        EXPECT(gbc.l(),  0x7f);
        EXPECT(gbc.sp(), 0xc83f);
        EXPECT(gbc.pc(), 0xc4d7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc4d6), 0x5b);
        // 5B 013B
        gbc.setState(0xcd36, 0x5879, 0x7eb0, 0x247b, 0x9960, 0xd13f, 0x0, 0x0);
        gbc.writeMem(0xcd36, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x7e);
        EXPECT(gbc.b(),  0x24);
        EXPECT(gbc.c(),  0x7b);
        EXPECT(gbc.d(),  0x99);
        EXPECT(gbc.e(),  0x60);
        EXPECT(gbc.h(),  0xd1);
        EXPECT(gbc.l(),  0x3f);
        EXPECT(gbc.sp(), 0x5879);
        EXPECT(gbc.pc(), 0xcd37);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcd36), 0x5b);
        // 5B 013C
        gbc.setState(0x4353, 0x724a, 0x6700, 0x3fb, 0xd55b, 0x65a9, 0x0, 0x0);
        gbc.writeMem(0x4353, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x67);
        EXPECT(gbc.b(),  0x3);
        EXPECT(gbc.c(),  0xfb);
        EXPECT(gbc.d(),  0xd5);
        EXPECT(gbc.e(),  0x5b);
        EXPECT(gbc.h(),  0x65);
        EXPECT(gbc.l(),  0xa9);
        EXPECT(gbc.sp(), 0x724a);
        EXPECT(gbc.pc(), 0x4354);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 013D
        gbc.setState(0x9042, 0x8e6e, 0x1f80, 0x4d5b, 0x98ba, 0x9868, 0x1, 0x0);
        gbc.writeMem(0x9042, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x1f);
        EXPECT(gbc.b(),  0x4d);
        EXPECT(gbc.c(),  0x5b);
        EXPECT(gbc.d(),  0x98);
        EXPECT(gbc.e(),  0xba);
        EXPECT(gbc.h(),  0x98);
        EXPECT(gbc.l(),  0x68);
        EXPECT(gbc.sp(), 0x8e6e);
        EXPECT(gbc.pc(), 0x9043);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9042), 0x5b);
        // 5B 013E
        gbc.setState(0xdf6f, 0x2bd2, 0x4ad0, 0xddd4, 0xc02, 0xd5f4, 0x0, 0x1);
        gbc.writeMem(0xdf6f, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x4a);
        EXPECT(gbc.b(),  0xdd);
        EXPECT(gbc.c(),  0xd4);
        EXPECT(gbc.d(),  0xc);
        EXPECT(gbc.e(),  0x2);
        EXPECT(gbc.h(),  0xd5);
        EXPECT(gbc.l(),  0xf4);
        EXPECT(gbc.sp(), 0x2bd2);
        EXPECT(gbc.pc(), 0xdf70);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xdf6f), 0x5b);
        // 5B 013F
        gbc.setState(0x41e1, 0xff09, 0x8bc0, 0x26f9, 0x2c4b, 0xd677, 0x1, 0x0);
        gbc.writeMem(0x41e1, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x8b);
        EXPECT(gbc.b(),  0x26);
        EXPECT(gbc.c(),  0xf9);
        EXPECT(gbc.d(),  0x2c);
        EXPECT(gbc.e(),  0x4b);
        EXPECT(gbc.h(),  0xd6);
        EXPECT(gbc.l(),  0x77);
        EXPECT(gbc.sp(), 0xff09);
        EXPECT(gbc.pc(), 0x41e2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0141
        gbc.setState(0x7119, 0xcf4e, 0x94a0, 0x57fc, 0x25a9, 0x59f5, 0x1, 0x1);
        gbc.writeMem(0x7119, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x94);
        EXPECT(gbc.b(),  0x57);
        EXPECT(gbc.c(),  0xfc);
        EXPECT(gbc.d(),  0x25);
        EXPECT(gbc.e(),  0xa9);
        EXPECT(gbc.h(),  0x59);
        EXPECT(gbc.l(),  0xf5);
        EXPECT(gbc.sp(), 0xcf4e);
        EXPECT(gbc.pc(), 0x711a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0142
        gbc.setState(0xefb6, 0x66fc, 0x3d50, 0x60d1, 0xd852, 0xf152, 0x0, 0x1);
        gbc.writeMem(0xefb6, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x3d);
        EXPECT(gbc.b(),  0x60);
        EXPECT(gbc.c(),  0xd1);
        EXPECT(gbc.d(),  0xd8);
        EXPECT(gbc.e(),  0x52);
        EXPECT(gbc.h(),  0xf1);
        EXPECT(gbc.l(),  0x52);
        EXPECT(gbc.sp(), 0x66fc);
        EXPECT(gbc.pc(), 0xefb7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xefb6), 0x5b);
        // 5B 0143
        gbc.setState(0xedc7, 0xbf82, 0x9d40, 0x3e44, 0xd77b, 0x1c1c, 0x1, 0x1);
        gbc.writeMem(0xedc7, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x9d);
        EXPECT(gbc.b(),  0x3e);
        EXPECT(gbc.c(),  0x44);
        EXPECT(gbc.d(),  0xd7);
        EXPECT(gbc.e(),  0x7b);
        EXPECT(gbc.h(),  0x1c);
        EXPECT(gbc.l(),  0x1c);
        EXPECT(gbc.sp(), 0xbf82);
        EXPECT(gbc.pc(), 0xedc8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xedc7), 0x5b);
        // 5B 0144
        gbc.setState(0x3a6f, 0xf2ec, 0x1470, 0xe5b8, 0x3b2f, 0x3613, 0x1, 0x0);
        gbc.writeMem(0x3a6f, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x14);
        EXPECT(gbc.b(),  0xe5);
        EXPECT(gbc.c(),  0xb8);
        EXPECT(gbc.d(),  0x3b);
        EXPECT(gbc.e(),  0x2f);
        EXPECT(gbc.h(),  0x36);
        EXPECT(gbc.l(),  0x13);
        EXPECT(gbc.sp(), 0xf2ec);
        EXPECT(gbc.pc(), 0x3a70);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0145
        gbc.setState(0x4bf3, 0xd359, 0x580, 0x1016, 0xabe, 0x935c, 0x0, 0x0);
        gbc.writeMem(0x4bf3, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x5);
        EXPECT(gbc.b(),  0x10);
        EXPECT(gbc.c(),  0x16);
        EXPECT(gbc.d(),  0xa);
        EXPECT(gbc.e(),  0xbe);
        EXPECT(gbc.h(),  0x93);
        EXPECT(gbc.l(),  0x5c);
        EXPECT(gbc.sp(), 0xd359);
        EXPECT(gbc.pc(), 0x4bf4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0146
        gbc.setState(0xd4fd, 0x5674, 0xe1c0, 0x358e, 0x7567, 0x8265, 0x1, 0x0);
        gbc.writeMem(0xd4fd, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xe1);
        EXPECT(gbc.b(),  0x35);
        EXPECT(gbc.c(),  0x8e);
        EXPECT(gbc.d(),  0x75);
        EXPECT(gbc.e(),  0x67);
        EXPECT(gbc.h(),  0x82);
        EXPECT(gbc.l(),  0x65);
        EXPECT(gbc.sp(), 0x5674);
        EXPECT(gbc.pc(), 0xd4fe);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd4fd), 0x5b);
        // 5B 0147
        gbc.setState(0x9baf, 0x381, 0xa7e0, 0x385f, 0x6884, 0xd665, 0x0, 0x1);
        gbc.writeMem(0x9baf, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa7);
        EXPECT(gbc.b(),  0x38);
        EXPECT(gbc.c(),  0x5f);
        EXPECT(gbc.d(),  0x68);
        EXPECT(gbc.e(),  0x84);
        EXPECT(gbc.h(),  0xd6);
        EXPECT(gbc.l(),  0x65);
        EXPECT(gbc.sp(), 0x381);
        EXPECT(gbc.pc(), 0x9bb0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9baf), 0x5b);
        // 5B 0148
        gbc.setState(0x8726, 0x564d, 0xc510, 0xaf23, 0xd91d, 0x376b, 0x1, 0x1);
        gbc.writeMem(0x8726, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xc5);
        EXPECT(gbc.b(),  0xaf);
        EXPECT(gbc.c(),  0x23);
        EXPECT(gbc.d(),  0xd9);
        EXPECT(gbc.e(),  0x1d);
        EXPECT(gbc.h(),  0x37);
        EXPECT(gbc.l(),  0x6b);
        EXPECT(gbc.sp(), 0x564d);
        EXPECT(gbc.pc(), 0x8727);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8726), 0x5b);
        // 5B 0149
        gbc.setState(0xb140, 0x4c57, 0xa9f0, 0x544c, 0x60e, 0x9bd4, 0x0, 0x0);
        gbc.writeMem(0xb140, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa9);
        EXPECT(gbc.b(),  0x54);
        EXPECT(gbc.c(),  0x4c);
        EXPECT(gbc.d(),  0x6);
        EXPECT(gbc.e(),  0xe);
        EXPECT(gbc.h(),  0x9b);
        EXPECT(gbc.l(),  0xd4);
        EXPECT(gbc.sp(), 0x4c57);
        EXPECT(gbc.pc(), 0xb141);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb140), 0x5b);
        // 5B 014A
        gbc.setState(0x66e1, 0x66e2, 0x2920, 0xcb3b, 0xf68f, 0x1ff9, 0x1, 0x1);
        gbc.writeMem(0x66e1, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x29);
        EXPECT(gbc.b(),  0xcb);
        EXPECT(gbc.c(),  0x3b);
        EXPECT(gbc.d(),  0xf6);
        EXPECT(gbc.e(),  0x8f);
        EXPECT(gbc.h(),  0x1f);
        EXPECT(gbc.l(),  0xf9);
        EXPECT(gbc.sp(), 0x66e2);
        EXPECT(gbc.pc(), 0x66e2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 014B
        gbc.setState(0xae6, 0x6ee2, 0xa230, 0xff93, 0xb322, 0x8e3b, 0x1, 0x0);
        gbc.writeMem(0xae6, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa2);
        EXPECT(gbc.b(),  0xff);
        EXPECT(gbc.c(),  0x93);
        EXPECT(gbc.d(),  0xb3);
        EXPECT(gbc.e(),  0x22);
        EXPECT(gbc.h(),  0x8e);
        EXPECT(gbc.l(),  0x3b);
        EXPECT(gbc.sp(), 0x6ee2);
        EXPECT(gbc.pc(), 0xae7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 014C
        gbc.setState(0xa2b3, 0x462f, 0x7810, 0x37a3, 0x620f, 0xad13, 0x1, 0x1);
        gbc.writeMem(0xa2b3, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x78);
        EXPECT(gbc.b(),  0x37);
        EXPECT(gbc.c(),  0xa3);
        EXPECT(gbc.d(),  0x62);
        EXPECT(gbc.e(),  0xf);
        EXPECT(gbc.h(),  0xad);
        EXPECT(gbc.l(),  0x13);
        EXPECT(gbc.sp(), 0x462f);
        EXPECT(gbc.pc(), 0xa2b4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa2b3), 0x5b);
        // 5B 014D
        gbc.setState(0xc3bf, 0xeba8, 0x8e70, 0xdb45, 0xaecf, 0xa4db, 0x0, 0x1);
        gbc.writeMem(0xc3bf, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x8e);
        EXPECT(gbc.b(),  0xdb);
        EXPECT(gbc.c(),  0x45);
        EXPECT(gbc.d(),  0xae);
        EXPECT(gbc.e(),  0xcf);
        EXPECT(gbc.h(),  0xa4);
        EXPECT(gbc.l(),  0xdb);
        EXPECT(gbc.sp(), 0xeba8);
        EXPECT(gbc.pc(), 0xc3c0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc3bf), 0x5b);
        // 5B 014E
        gbc.setState(0x49b7, 0xaf8e, 0x87d0, 0xf331, 0x555f, 0x5468, 0x0, 0x1);
        gbc.writeMem(0x49b7, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x87);
        EXPECT(gbc.b(),  0xf3);
        EXPECT(gbc.c(),  0x31);
        EXPECT(gbc.d(),  0x55);
        EXPECT(gbc.e(),  0x5f);
        EXPECT(gbc.h(),  0x54);
        EXPECT(gbc.l(),  0x68);
        EXPECT(gbc.sp(), 0xaf8e);
        EXPECT(gbc.pc(), 0x49b8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 014F
        gbc.setState(0xb244, 0x12cc, 0x4bb0, 0x1b2d, 0x85af, 0xa1d8, 0x0, 0x1);
        gbc.writeMem(0xb244, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x4b);
        EXPECT(gbc.b(),  0x1b);
        EXPECT(gbc.c(),  0x2d);
        EXPECT(gbc.d(),  0x85);
        EXPECT(gbc.e(),  0xaf);
        EXPECT(gbc.h(),  0xa1);
        EXPECT(gbc.l(),  0xd8);
        EXPECT(gbc.sp(), 0x12cc);
        EXPECT(gbc.pc(), 0xb245);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb244), 0x5b);
        // 5B 0150
        gbc.setState(0xab12, 0x2895, 0x7ec0, 0xca1c, 0x567f, 0x73ea, 0x1, 0x0);
        gbc.writeMem(0xab12, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x7e);
        EXPECT(gbc.b(),  0xca);
        EXPECT(gbc.c(),  0x1c);
        EXPECT(gbc.d(),  0x56);
        EXPECT(gbc.e(),  0x7f);
        EXPECT(gbc.h(),  0x73);
        EXPECT(gbc.l(),  0xea);
        EXPECT(gbc.sp(), 0x2895);
        EXPECT(gbc.pc(), 0xab13);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xab12), 0x5b);
        // 5B 0151
        gbc.setState(0xc4c6, 0x9763, 0x5c20, 0x4d11, 0x16eb, 0x8043, 0x1, 0x1);
        gbc.writeMem(0xc4c6, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x5c);
        EXPECT(gbc.b(),  0x4d);
        EXPECT(gbc.c(),  0x11);
        EXPECT(gbc.d(),  0x16);
        EXPECT(gbc.e(),  0xeb);
        EXPECT(gbc.h(),  0x80);
        EXPECT(gbc.l(),  0x43);
        EXPECT(gbc.sp(), 0x9763);
        EXPECT(gbc.pc(), 0xc4c7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc4c6), 0x5b);
        // 5B 0152
        gbc.setState(0xae95, 0xf935, 0x2140, 0xd724, 0xe938, 0xf6d9, 0x1, 0x1);
        gbc.writeMem(0xae95, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x21);
        EXPECT(gbc.b(),  0xd7);
        EXPECT(gbc.c(),  0x24);
        EXPECT(gbc.d(),  0xe9);
        EXPECT(gbc.e(),  0x38);
        EXPECT(gbc.h(),  0xf6);
        EXPECT(gbc.l(),  0xd9);
        EXPECT(gbc.sp(), 0xf935);
        EXPECT(gbc.pc(), 0xae96);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xae95), 0x5b);
        // 5B 0153
        gbc.setState(0x175a, 0x7ddf, 0xd920, 0x689d, 0xf6d4, 0xc24d, 0x0, 0x0);
        gbc.writeMem(0x175a, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd9);
        EXPECT(gbc.b(),  0x68);
        EXPECT(gbc.c(),  0x9d);
        EXPECT(gbc.d(),  0xf6);
        EXPECT(gbc.e(),  0xd4);
        EXPECT(gbc.h(),  0xc2);
        EXPECT(gbc.l(),  0x4d);
        EXPECT(gbc.sp(), 0x7ddf);
        EXPECT(gbc.pc(), 0x175b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0154
        gbc.setState(0x5bab, 0xf430, 0xba0, 0xe09a, 0xabff, 0x2e47, 0x0, 0x0);
        gbc.writeMem(0x5bab, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xb);
        EXPECT(gbc.b(),  0xe0);
        EXPECT(gbc.c(),  0x9a);
        EXPECT(gbc.d(),  0xab);
        EXPECT(gbc.e(),  0xff);
        EXPECT(gbc.h(),  0x2e);
        EXPECT(gbc.l(),  0x47);
        EXPECT(gbc.sp(), 0xf430);
        EXPECT(gbc.pc(), 0x5bac);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0155
        gbc.setState(0xc073, 0xe7ac, 0xf500, 0xf957, 0x5ca0, 0xb26b, 0x1, 0x0);
        gbc.writeMem(0xc073, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf5);
        EXPECT(gbc.b(),  0xf9);
        EXPECT(gbc.c(),  0x57);
        EXPECT(gbc.d(),  0x5c);
        EXPECT(gbc.e(),  0xa0);
        EXPECT(gbc.h(),  0xb2);
        EXPECT(gbc.l(),  0x6b);
        EXPECT(gbc.sp(), 0xe7ac);
        EXPECT(gbc.pc(), 0xc074);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc073), 0x5b);
        // 5B 0156
        gbc.setState(0x3e62, 0x9fb0, 0xa3b0, 0x4e68, 0x95c8, 0x5a1e, 0x1, 0x0);
        gbc.writeMem(0x3e62, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa3);
        EXPECT(gbc.b(),  0x4e);
        EXPECT(gbc.c(),  0x68);
        EXPECT(gbc.d(),  0x95);
        EXPECT(gbc.e(),  0xc8);
        EXPECT(gbc.h(),  0x5a);
        EXPECT(gbc.l(),  0x1e);
        EXPECT(gbc.sp(), 0x9fb0);
        EXPECT(gbc.pc(), 0x3e63);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0157
        gbc.setState(0x2e2c, 0x4180, 0x7c00, 0x8f2b, 0x81eb, 0xed3f, 0x1, 0x0);
        gbc.writeMem(0x2e2c, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x7c);
        EXPECT(gbc.b(),  0x8f);
        EXPECT(gbc.c(),  0x2b);
        EXPECT(gbc.d(),  0x81);
        EXPECT(gbc.e(),  0xeb);
        EXPECT(gbc.h(),  0xed);
        EXPECT(gbc.l(),  0x3f);
        EXPECT(gbc.sp(), 0x4180);
        EXPECT(gbc.pc(), 0x2e2d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0158
        gbc.setState(0x7117, 0x5240, 0x8f60, 0xfb1d, 0x13a3, 0x157c, 0x0, 0x1);
        gbc.writeMem(0x7117, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x8f);
        EXPECT(gbc.b(),  0xfb);
        EXPECT(gbc.c(),  0x1d);
        EXPECT(gbc.d(),  0x13);
        EXPECT(gbc.e(),  0xa3);
        EXPECT(gbc.h(),  0x15);
        EXPECT(gbc.l(),  0x7c);
        EXPECT(gbc.sp(), 0x5240);
        EXPECT(gbc.pc(), 0x7118);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0159
        gbc.setState(0xb55b, 0xd396, 0xacf0, 0x44, 0x4ef8, 0xa4a0, 0x1, 0x1);
        gbc.writeMem(0xb55b, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xac);
        EXPECT(gbc.b(),  0x0);
        EXPECT(gbc.c(),  0x44);
        EXPECT(gbc.d(),  0x4e);
        EXPECT(gbc.e(),  0xf8);
        EXPECT(gbc.h(),  0xa4);
        EXPECT(gbc.l(),  0xa0);
        EXPECT(gbc.sp(), 0xd396);
        EXPECT(gbc.pc(), 0xb55c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb55b), 0x5b);
        // 5B 015A
        gbc.setState(0x2c63, 0x1fbc, 0x7130, 0x8de9, 0xab02, 0xb0d5, 0x1, 0x0);
        gbc.writeMem(0x2c63, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x71);
        EXPECT(gbc.b(),  0x8d);
        EXPECT(gbc.c(),  0xe9);
        EXPECT(gbc.d(),  0xab);
        EXPECT(gbc.e(),  0x2);
        EXPECT(gbc.h(),  0xb0);
        EXPECT(gbc.l(),  0xd5);
        EXPECT(gbc.sp(), 0x1fbc);
        EXPECT(gbc.pc(), 0x2c64);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 015B
        gbc.setState(0x34d2, 0xed5, 0x7b50, 0x22d1, 0x1b09, 0x12ae, 0x1, 0x1);
        gbc.writeMem(0x34d2, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x7b);
        EXPECT(gbc.b(),  0x22);
        EXPECT(gbc.c(),  0xd1);
        EXPECT(gbc.d(),  0x1b);
        EXPECT(gbc.e(),  0x9);
        EXPECT(gbc.h(),  0x12);
        EXPECT(gbc.l(),  0xae);
        EXPECT(gbc.sp(), 0xed5);
        EXPECT(gbc.pc(), 0x34d3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 015C
        gbc.setState(0x48be, 0xadcd, 0x4440, 0x4579, 0xd670, 0x4ab7, 0x1, 0x0);
        gbc.writeMem(0x48be, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x44);
        EXPECT(gbc.b(),  0x45);
        EXPECT(gbc.c(),  0x79);
        EXPECT(gbc.d(),  0xd6);
        EXPECT(gbc.e(),  0x70);
        EXPECT(gbc.h(),  0x4a);
        EXPECT(gbc.l(),  0xb7);
        EXPECT(gbc.sp(), 0xadcd);
        EXPECT(gbc.pc(), 0x48bf);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 015D
        gbc.setState(0xa297, 0xe391, 0x4fc0, 0xdfaa, 0x96cd, 0x500c, 0x0, 0x0);
        gbc.writeMem(0xa297, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x4f);
        EXPECT(gbc.b(),  0xdf);
        EXPECT(gbc.c(),  0xaa);
        EXPECT(gbc.d(),  0x96);
        EXPECT(gbc.e(),  0xcd);
        EXPECT(gbc.h(),  0x50);
        EXPECT(gbc.l(),  0xc);
        EXPECT(gbc.sp(), 0xe391);
        EXPECT(gbc.pc(), 0xa298);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa297), 0x5b);
        // 5B 015E
        gbc.setState(0x1f1f, 0xa05, 0xdd70, 0x25ef, 0x7b01, 0x48a3, 0x0, 0x0);
        gbc.writeMem(0x1f1f, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xdd);
        EXPECT(gbc.b(),  0x25);
        EXPECT(gbc.c(),  0xef);
        EXPECT(gbc.d(),  0x7b);
        EXPECT(gbc.e(),  0x1);
        EXPECT(gbc.h(),  0x48);
        EXPECT(gbc.l(),  0xa3);
        EXPECT(gbc.sp(), 0xa05);
        EXPECT(gbc.pc(), 0x1f20);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0160
        gbc.setState(0x2d4f, 0xb1b4, 0x8b30, 0x76f, 0xae8, 0xd367, 0x0, 0x0);
        gbc.writeMem(0x2d4f, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x8b);
        EXPECT(gbc.b(),  0x7);
        EXPECT(gbc.c(),  0x6f);
        EXPECT(gbc.d(),  0xa);
        EXPECT(gbc.e(),  0xe8);
        EXPECT(gbc.h(),  0xd3);
        EXPECT(gbc.l(),  0x67);
        EXPECT(gbc.sp(), 0xb1b4);
        EXPECT(gbc.pc(), 0x2d50);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0162
        gbc.setState(0x6531, 0x9a24, 0xe150, 0x4065, 0x7b41, 0xd9ed, 0x0, 0x0);
        gbc.writeMem(0x6531, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xe1);
        EXPECT(gbc.b(),  0x40);
        EXPECT(gbc.c(),  0x65);
        EXPECT(gbc.d(),  0x7b);
        EXPECT(gbc.e(),  0x41);
        EXPECT(gbc.h(),  0xd9);
        EXPECT(gbc.l(),  0xed);
        EXPECT(gbc.sp(), 0x9a24);
        EXPECT(gbc.pc(), 0x6532);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 0163
        gbc.setState(0xa1cc, 0xed3b, 0xd900, 0xa42, 0x9a0e, 0x98eb, 0x1, 0x0);
        gbc.writeMem(0xa1cc, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd9);
        EXPECT(gbc.b(),  0xa);
        EXPECT(gbc.c(),  0x42);
        EXPECT(gbc.d(),  0x9a);
        EXPECT(gbc.e(),  0xe);
        EXPECT(gbc.h(),  0x98);
        EXPECT(gbc.l(),  0xeb);
        EXPECT(gbc.sp(), 0xed3b);
        EXPECT(gbc.pc(), 0xa1cd);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa1cc), 0x5b);
        // 5B 0164
        gbc.setState(0x69d1, 0xb972, 0x990, 0x6de1, 0x126, 0x174a, 0x1, 0x1);
        gbc.writeMem(0x69d1, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x9);
        EXPECT(gbc.b(),  0x6d);
        EXPECT(gbc.c(),  0xe1);
        EXPECT(gbc.d(),  0x1);
        EXPECT(gbc.e(),  0x26);
        EXPECT(gbc.h(),  0x17);
        EXPECT(gbc.l(),  0x4a);
        EXPECT(gbc.sp(), 0xb972);
        EXPECT(gbc.pc(), 0x69d2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 0165
        gbc.setState(0xc0d1, 0xd202, 0xbea0, 0x2f4c, 0x70bc, 0x7ff6, 0x1, 0x0);
        gbc.writeMem(0xc0d1, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xbe);
        EXPECT(gbc.b(),  0x2f);
        EXPECT(gbc.c(),  0x4c);
        EXPECT(gbc.d(),  0x70);
        EXPECT(gbc.e(),  0xbc);
        EXPECT(gbc.h(),  0x7f);
        EXPECT(gbc.l(),  0xf6);
        EXPECT(gbc.sp(), 0xd202);
        EXPECT(gbc.pc(), 0xc0d2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc0d1), 0x5b);
        // 5B 0166
        gbc.setState(0x3c13, 0x293b, 0x77d0, 0x6ee2, 0x65d0, 0x6f16, 0x1, 0x0);
        gbc.writeMem(0x3c13, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x77);
        EXPECT(gbc.b(),  0x6e);
        EXPECT(gbc.c(),  0xe2);
        EXPECT(gbc.d(),  0x65);
        EXPECT(gbc.e(),  0xd0);
        EXPECT(gbc.h(),  0x6f);
        EXPECT(gbc.l(),  0x16);
        EXPECT(gbc.sp(), 0x293b);
        EXPECT(gbc.pc(), 0x3c14);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 0167
        gbc.setState(0x8bbc, 0x16ba, 0x4ca0, 0xaede, 0xb276, 0x9ac, 0x0, 0x1);
        gbc.writeMem(0x8bbc, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x4c);
        EXPECT(gbc.b(),  0xae);
        EXPECT(gbc.c(),  0xde);
        EXPECT(gbc.d(),  0xb2);
        EXPECT(gbc.e(),  0x76);
        EXPECT(gbc.h(),  0x9);
        EXPECT(gbc.l(),  0xac);
        EXPECT(gbc.sp(), 0x16ba);
        EXPECT(gbc.pc(), 0x8bbd);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8bbc), 0x5b);
        // 5B 0168
        gbc.setState(0x64a9, 0x4d3c, 0xe8d0, 0xdb2b, 0x8e44, 0x7983, 0x1, 0x1);
        gbc.writeMem(0x64a9, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xe8);
        EXPECT(gbc.b(),  0xdb);
        EXPECT(gbc.c(),  0x2b);
        EXPECT(gbc.d(),  0x8e);
        EXPECT(gbc.e(),  0x44);
        EXPECT(gbc.h(),  0x79);
        EXPECT(gbc.l(),  0x83);
        EXPECT(gbc.sp(), 0x4d3c);
        EXPECT(gbc.pc(), 0x64aa);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 0169
        gbc.setState(0x22d8, 0x2bd7, 0x290, 0xa78a, 0x4367, 0x3da2, 0x1, 0x0);
        gbc.writeMem(0x22d8, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0xa7);
        EXPECT(gbc.c(),  0x8a);
        EXPECT(gbc.d(),  0x43);
        EXPECT(gbc.e(),  0x67);
        EXPECT(gbc.h(),  0x3d);
        EXPECT(gbc.l(),  0xa2);
        EXPECT(gbc.sp(), 0x2bd7);
        EXPECT(gbc.pc(), 0x22d9);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 016B
        gbc.setState(0xa810, 0x93b6, 0x1410, 0x7618, 0xdba8, 0x7f84, 0x1, 0x1);
        gbc.writeMem(0xa810, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x14);
        EXPECT(gbc.b(),  0x76);
        EXPECT(gbc.c(),  0x18);
        EXPECT(gbc.d(),  0xdb);
        EXPECT(gbc.e(),  0xa8);
        EXPECT(gbc.h(),  0x7f);
        EXPECT(gbc.l(),  0x84);
        EXPECT(gbc.sp(), 0x93b6);
        EXPECT(gbc.pc(), 0xa811);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa810), 0x5b);
        // 5B 016C
        gbc.setState(0x26e1, 0xe4bf, 0x7dc0, 0x14d8, 0x778b, 0x725e, 0x0, 0x0);
        gbc.writeMem(0x26e1, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x7d);
        EXPECT(gbc.b(),  0x14);
        EXPECT(gbc.c(),  0xd8);
        EXPECT(gbc.d(),  0x77);
        EXPECT(gbc.e(),  0x8b);
        EXPECT(gbc.h(),  0x72);
        EXPECT(gbc.l(),  0x5e);
        EXPECT(gbc.sp(), 0xe4bf);
        EXPECT(gbc.pc(), 0x26e2);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 016D
        gbc.setState(0x9045, 0x1f6d, 0x830, 0xc492, 0xf705, 0xcb5b, 0x1, 0x1);
        gbc.writeMem(0x9045, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0xc4);
        EXPECT(gbc.c(),  0x92);
        EXPECT(gbc.d(),  0xf7);
        EXPECT(gbc.e(),  0x5);
        EXPECT(gbc.h(),  0xcb);
        EXPECT(gbc.l(),  0x5b);
        EXPECT(gbc.sp(), 0x1f6d);
        EXPECT(gbc.pc(), 0x9046);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9045), 0x5b);
        // 5B 016E
        gbc.setState(0xbe81, 0x6c83, 0x3180, 0x865c, 0x9250, 0x1764, 0x1, 0x0);
        gbc.writeMem(0xbe81, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x31);
        EXPECT(gbc.b(),  0x86);
        EXPECT(gbc.c(),  0x5c);
        EXPECT(gbc.d(),  0x92);
        EXPECT(gbc.e(),  0x50);
        EXPECT(gbc.h(),  0x17);
        EXPECT(gbc.l(),  0x64);
        EXPECT(gbc.sp(), 0x6c83);
        EXPECT(gbc.pc(), 0xbe82);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbe81), 0x5b);
        // 5B 016F
        gbc.setState(0x8cda, 0xee84, 0xcf00, 0x9f97, 0x9ac4, 0x309f, 0x1, 0x0);
        gbc.writeMem(0x8cda, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xcf);
        EXPECT(gbc.b(),  0x9f);
        EXPECT(gbc.c(),  0x97);
        EXPECT(gbc.d(),  0x9a);
        EXPECT(gbc.e(),  0xc4);
        EXPECT(gbc.h(),  0x30);
        EXPECT(gbc.l(),  0x9f);
        EXPECT(gbc.sp(), 0xee84);
        EXPECT(gbc.pc(), 0x8cdb);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8cda), 0x5b);
        // 5B 0170
        gbc.setState(0xefb8, 0x4f57, 0x5cc0, 0xce5d, 0xae09, 0x7fa3, 0x0, 0x0);
        gbc.writeMem(0xefb8, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x5c);
        EXPECT(gbc.b(),  0xce);
        EXPECT(gbc.c(),  0x5d);
        EXPECT(gbc.d(),  0xae);
        EXPECT(gbc.e(),  0x9);
        EXPECT(gbc.h(),  0x7f);
        EXPECT(gbc.l(),  0xa3);
        EXPECT(gbc.sp(), 0x4f57);
        EXPECT(gbc.pc(), 0xefb9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xefb8), 0x5b);
        // 5B 0171
        gbc.setState(0xc9c5, 0x33af, 0x3ef0, 0xa282, 0x244c, 0xf346, 0x1, 0x0);
        gbc.writeMem(0xc9c5, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x3e);
        EXPECT(gbc.b(),  0xa2);
        EXPECT(gbc.c(),  0x82);
        EXPECT(gbc.d(),  0x24);
        EXPECT(gbc.e(),  0x4c);
        EXPECT(gbc.h(),  0xf3);
        EXPECT(gbc.l(),  0x46);
        EXPECT(gbc.sp(), 0x33af);
        EXPECT(gbc.pc(), 0xc9c6);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc9c5), 0x5b);
        // 5B 0172
        gbc.setState(0xdb96, 0x7416, 0x6650, 0xd12d, 0x7fd8, 0xa13f, 0x1, 0x1);
        gbc.writeMem(0xdb96, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x66);
        EXPECT(gbc.b(),  0xd1);
        EXPECT(gbc.c(),  0x2d);
        EXPECT(gbc.d(),  0x7f);
        EXPECT(gbc.e(),  0xd8);
        EXPECT(gbc.h(),  0xa1);
        EXPECT(gbc.l(),  0x3f);
        EXPECT(gbc.sp(), 0x7416);
        EXPECT(gbc.pc(), 0xdb97);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xdb96), 0x5b);
        // 5B 0173
        gbc.setState(0xc85a, 0xca0, 0xf230, 0x1895, 0x5c3b, 0xdfb4, 0x1, 0x1);
        gbc.writeMem(0xc85a, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf2);
        EXPECT(gbc.b(),  0x18);
        EXPECT(gbc.c(),  0x95);
        EXPECT(gbc.d(),  0x5c);
        EXPECT(gbc.e(),  0x3b);
        EXPECT(gbc.h(),  0xdf);
        EXPECT(gbc.l(),  0xb4);
        EXPECT(gbc.sp(), 0xca0);
        EXPECT(gbc.pc(), 0xc85b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc85a), 0x5b);
        // 5B 0174
        gbc.setState(0x8104, 0x2596, 0x2320, 0x8b62, 0x2631, 0x943c, 0x0, 0x1);
        gbc.writeMem(0x8104, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x23);
        EXPECT(gbc.b(),  0x8b);
        EXPECT(gbc.c(),  0x62);
        EXPECT(gbc.d(),  0x26);
        EXPECT(gbc.e(),  0x31);
        EXPECT(gbc.h(),  0x94);
        EXPECT(gbc.l(),  0x3c);
        EXPECT(gbc.sp(), 0x2596);
        EXPECT(gbc.pc(), 0x8105);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8104), 0x5b);
        // 5B 0175
        gbc.setState(0x43a6, 0x7af2, 0xee60, 0xa440, 0x8acf, 0xbb2d, 0x1, 0x1);
        gbc.writeMem(0x43a6, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xee);
        EXPECT(gbc.b(),  0xa4);
        EXPECT(gbc.c(),  0x40);
        EXPECT(gbc.d(),  0x8a);
        EXPECT(gbc.e(),  0xcf);
        EXPECT(gbc.h(),  0xbb);
        EXPECT(gbc.l(),  0x2d);
        EXPECT(gbc.sp(), 0x7af2);
        EXPECT(gbc.pc(), 0x43a7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0176
        gbc.setState(0x9e0e, 0x1024, 0x2160, 0x154a, 0xfb39, 0xcde5, 0x0, 0x0);
        gbc.writeMem(0x9e0e, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x21);
        EXPECT(gbc.b(),  0x15);
        EXPECT(gbc.c(),  0x4a);
        EXPECT(gbc.d(),  0xfb);
        EXPECT(gbc.e(),  0x39);
        EXPECT(gbc.h(),  0xcd);
        EXPECT(gbc.l(),  0xe5);
        EXPECT(gbc.sp(), 0x1024);
        EXPECT(gbc.pc(), 0x9e0f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9e0e), 0x5b);
        // 5B 0177
        gbc.setState(0xdc11, 0x5baa, 0xb130, 0x7d5d, 0xb58e, 0x5133, 0x1, 0x1);
        gbc.writeMem(0xdc11, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xb1);
        EXPECT(gbc.b(),  0x7d);
        EXPECT(gbc.c(),  0x5d);
        EXPECT(gbc.d(),  0xb5);
        EXPECT(gbc.e(),  0x8e);
        EXPECT(gbc.h(),  0x51);
        EXPECT(gbc.l(),  0x33);
        EXPECT(gbc.sp(), 0x5baa);
        EXPECT(gbc.pc(), 0xdc12);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xdc11), 0x5b);
        // 5B 0178
        gbc.setState(0x16d2, 0xbb53, 0xd9d0, 0x5d01, 0xb64e, 0x3b77, 0x1, 0x1);
        gbc.writeMem(0x16d2, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd9);
        EXPECT(gbc.b(),  0x5d);
        EXPECT(gbc.c(),  0x1);
        EXPECT(gbc.d(),  0xb6);
        EXPECT(gbc.e(),  0x4e);
        EXPECT(gbc.h(),  0x3b);
        EXPECT(gbc.l(),  0x77);
        EXPECT(gbc.sp(), 0xbb53);
        EXPECT(gbc.pc(), 0x16d3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 0179
        gbc.setState(0xbdf8, 0x5530, 0x9130, 0xdf7, 0x28f4, 0xc883, 0x0, 0x1);
        gbc.writeMem(0xbdf8, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x91);
        EXPECT(gbc.b(),  0xd);
        EXPECT(gbc.c(),  0xf7);
        EXPECT(gbc.d(),  0x28);
        EXPECT(gbc.e(),  0xf4);
        EXPECT(gbc.h(),  0xc8);
        EXPECT(gbc.l(),  0x83);
        EXPECT(gbc.sp(), 0x5530);
        EXPECT(gbc.pc(), 0xbdf9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbdf8), 0x5b);
        // 5B 017A
        gbc.setState(0xa013, 0x25b5, 0x5d30, 0xbce0, 0xe213, 0x1e79, 0x1, 0x1);
        gbc.writeMem(0xa013, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x5d);
        EXPECT(gbc.b(),  0xbc);
        EXPECT(gbc.c(),  0xe0);
        EXPECT(gbc.d(),  0xe2);
        EXPECT(gbc.e(),  0x13);
        EXPECT(gbc.h(),  0x1e);
        EXPECT(gbc.l(),  0x79);
        EXPECT(gbc.sp(), 0x25b5);
        EXPECT(gbc.pc(), 0xa014);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa013), 0x5b);
        // 5B 017B
        gbc.setState(0x81d3, 0xcfcc, 0xe170, 0x2174, 0xdbfe, 0x22c0, 0x1, 0x1);
        gbc.writeMem(0x81d3, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xe1);
        EXPECT(gbc.b(),  0x21);
        EXPECT(gbc.c(),  0x74);
        EXPECT(gbc.d(),  0xdb);
        EXPECT(gbc.e(),  0xfe);
        EXPECT(gbc.h(),  0x22);
        EXPECT(gbc.l(),  0xc0);
        EXPECT(gbc.sp(), 0xcfcc);
        EXPECT(gbc.pc(), 0x81d4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x81d3), 0x5b);
        // 5B 017C
        gbc.setState(0x51de, 0x306c, 0xffb0, 0x44d7, 0x45ba, 0xac23, 0x1, 0x1);
        gbc.writeMem(0x51de, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xff);
        EXPECT(gbc.b(),  0x44);
        EXPECT(gbc.c(),  0xd7);
        EXPECT(gbc.d(),  0x45);
        EXPECT(gbc.e(),  0xba);
        EXPECT(gbc.h(),  0xac);
        EXPECT(gbc.l(),  0x23);
        EXPECT(gbc.sp(), 0x306c);
        EXPECT(gbc.pc(), 0x51df);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 017D
        gbc.setState(0x4c68, 0xb1ce, 0x1850, 0x7f5e, 0xfc67, 0x58b4, 0x0, 0x1);
        gbc.writeMem(0x4c68, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x18);
        EXPECT(gbc.b(),  0x7f);
        EXPECT(gbc.c(),  0x5e);
        EXPECT(gbc.d(),  0xfc);
        EXPECT(gbc.e(),  0x67);
        EXPECT(gbc.h(),  0x58);
        EXPECT(gbc.l(),  0xb4);
        EXPECT(gbc.sp(), 0xb1ce);
        EXPECT(gbc.pc(), 0x4c69);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 017E
        gbc.setState(0x186a, 0x4923, 0x9370, 0x7f76, 0x19ba, 0x3a9a, 0x0, 0x0);
        gbc.writeMem(0x186a, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x93);
        EXPECT(gbc.b(),  0x7f);
        EXPECT(gbc.c(),  0x76);
        EXPECT(gbc.d(),  0x19);
        EXPECT(gbc.e(),  0xba);
        EXPECT(gbc.h(),  0x3a);
        EXPECT(gbc.l(),  0x9a);
        EXPECT(gbc.sp(), 0x4923);
        EXPECT(gbc.pc(), 0x186b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 017F
        gbc.setState(0xe4cd, 0x96e9, 0x6100, 0xd1a3, 0x9efd, 0xa698, 0x0, 0x0);
        gbc.writeMem(0xe4cd, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x61);
        EXPECT(gbc.b(),  0xd1);
        EXPECT(gbc.c(),  0xa3);
        EXPECT(gbc.d(),  0x9e);
        EXPECT(gbc.e(),  0xfd);
        EXPECT(gbc.h(),  0xa6);
        EXPECT(gbc.l(),  0x98);
        EXPECT(gbc.sp(), 0x96e9);
        EXPECT(gbc.pc(), 0xe4ce);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe4cd), 0x5b);
        // 5B 0180
        gbc.setState(0xa27a, 0x1c02, 0x3cc0, 0xb565, 0xef0a, 0x2b72, 0x1, 0x0);
        gbc.writeMem(0xa27a, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x3c);
        EXPECT(gbc.b(),  0xb5);
        EXPECT(gbc.c(),  0x65);
        EXPECT(gbc.d(),  0xef);
        EXPECT(gbc.e(),  0xa);
        EXPECT(gbc.h(),  0x2b);
        EXPECT(gbc.l(),  0x72);
        EXPECT(gbc.sp(), 0x1c02);
        EXPECT(gbc.pc(), 0xa27b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa27a), 0x5b);
        // 5B 0181
        gbc.setState(0xaff7, 0x8df7, 0xbbd0, 0x66f7, 0xc0d4, 0xfd7, 0x0, 0x0);
        gbc.writeMem(0xaff7, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xbb);
        EXPECT(gbc.b(),  0x66);
        EXPECT(gbc.c(),  0xf7);
        EXPECT(gbc.d(),  0xc0);
        EXPECT(gbc.e(),  0xd4);
        EXPECT(gbc.h(),  0xf);
        EXPECT(gbc.l(),  0xd7);
        EXPECT(gbc.sp(), 0x8df7);
        EXPECT(gbc.pc(), 0xaff8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xaff7), 0x5b);
        // 5B 0183
        gbc.setState(0x8f77, 0x2937, 0x5c60, 0x67ff, 0x115b, 0xb62, 0x0, 0x0);
        gbc.writeMem(0x8f77, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x5c);
        EXPECT(gbc.b(),  0x67);
        EXPECT(gbc.c(),  0xff);
        EXPECT(gbc.d(),  0x11);
        EXPECT(gbc.e(),  0x5b);
        EXPECT(gbc.h(),  0xb);
        EXPECT(gbc.l(),  0x62);
        EXPECT(gbc.sp(), 0x2937);
        EXPECT(gbc.pc(), 0x8f78);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8f77), 0x5b);
        // 5B 0184
        gbc.setState(0x70, 0x9d9d, 0x8370, 0x8cd6, 0x5bda, 0xa72f, 0x0, 0x0);
        gbc.writeMem(0x70, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x83);
        EXPECT(gbc.b(),  0x8c);
        EXPECT(gbc.c(),  0xd6);
        EXPECT(gbc.d(),  0x5b);
        EXPECT(gbc.e(),  0xda);
        EXPECT(gbc.h(),  0xa7);
        EXPECT(gbc.l(),  0x2f);
        EXPECT(gbc.sp(), 0x9d9d);
        EXPECT(gbc.pc(), 0x71);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0186
        gbc.setState(0xa171, 0x9c0e, 0xe2e0, 0x3388, 0x68e5, 0x78b9, 0x0, 0x1);
        gbc.writeMem(0xa171, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xe2);
        EXPECT(gbc.b(),  0x33);
        EXPECT(gbc.c(),  0x88);
        EXPECT(gbc.d(),  0x68);
        EXPECT(gbc.e(),  0xe5);
        EXPECT(gbc.h(),  0x78);
        EXPECT(gbc.l(),  0xb9);
        EXPECT(gbc.sp(), 0x9c0e);
        EXPECT(gbc.pc(), 0xa172);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa171), 0x5b);
        // 5B 0187
        gbc.setState(0xc437, 0x17d7, 0x2390, 0xbb5a, 0x5509, 0xbbdf, 0x0, 0x1);
        gbc.writeMem(0xc437, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x23);
        EXPECT(gbc.b(),  0xbb);
        EXPECT(gbc.c(),  0x5a);
        EXPECT(gbc.d(),  0x55);
        EXPECT(gbc.e(),  0x9);
        EXPECT(gbc.h(),  0xbb);
        EXPECT(gbc.l(),  0xdf);
        EXPECT(gbc.sp(), 0x17d7);
        EXPECT(gbc.pc(), 0xc438);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc437), 0x5b);
        // 5B 0188
        gbc.setState(0xec33, 0xabed, 0x6f80, 0xd057, 0x4728, 0x4265, 0x0, 0x0);
        gbc.writeMem(0xec33, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x6f);
        EXPECT(gbc.b(),  0xd0);
        EXPECT(gbc.c(),  0x57);
        EXPECT(gbc.d(),  0x47);
        EXPECT(gbc.e(),  0x28);
        EXPECT(gbc.h(),  0x42);
        EXPECT(gbc.l(),  0x65);
        EXPECT(gbc.sp(), 0xabed);
        EXPECT(gbc.pc(), 0xec34);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xec33), 0x5b);
        // 5B 0189
        gbc.setState(0x5259, 0xda13, 0x2ee0, 0x6450, 0xa539, 0x6db4, 0x1, 0x0);
        gbc.writeMem(0x5259, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x2e);
        EXPECT(gbc.b(),  0x64);
        EXPECT(gbc.c(),  0x50);
        EXPECT(gbc.d(),  0xa5);
        EXPECT(gbc.e(),  0x39);
        EXPECT(gbc.h(),  0x6d);
        EXPECT(gbc.l(),  0xb4);
        EXPECT(gbc.sp(), 0xda13);
        EXPECT(gbc.pc(), 0x525a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 018A
        gbc.setState(0x6713, 0xaf40, 0x4620, 0x1351, 0x9f52, 0xddc1, 0x1, 0x0);
        gbc.writeMem(0x6713, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x46);
        EXPECT(gbc.b(),  0x13);
        EXPECT(gbc.c(),  0x51);
        EXPECT(gbc.d(),  0x9f);
        EXPECT(gbc.e(),  0x52);
        EXPECT(gbc.h(),  0xdd);
        EXPECT(gbc.l(),  0xc1);
        EXPECT(gbc.sp(), 0xaf40);
        EXPECT(gbc.pc(), 0x6714);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 018B
        gbc.setState(0xe193, 0x1c80, 0x6d90, 0x488e, 0x54f, 0x2542, 0x0, 0x1);
        gbc.writeMem(0xe193, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x6d);
        EXPECT(gbc.b(),  0x48);
        EXPECT(gbc.c(),  0x8e);
        EXPECT(gbc.d(),  0x5);
        EXPECT(gbc.e(),  0x4f);
        EXPECT(gbc.h(),  0x25);
        EXPECT(gbc.l(),  0x42);
        EXPECT(gbc.sp(), 0x1c80);
        EXPECT(gbc.pc(), 0xe194);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe193), 0x5b);
        // 5B 018C
        gbc.setState(0x9a9e, 0xac51, 0xd9b0, 0x2c69, 0xe8db, 0x1a18, 0x0, 0x0);
        gbc.writeMem(0x9a9e, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd9);
        EXPECT(gbc.b(),  0x2c);
        EXPECT(gbc.c(),  0x69);
        EXPECT(gbc.d(),  0xe8);
        EXPECT(gbc.e(),  0xdb);
        EXPECT(gbc.h(),  0x1a);
        EXPECT(gbc.l(),  0x18);
        EXPECT(gbc.sp(), 0xac51);
        EXPECT(gbc.pc(), 0x9a9f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9a9e), 0x5b);
        // 5B 018D
        gbc.setState(0x1e3e, 0x485b, 0x8420, 0x5fe8, 0x82b3, 0x5cf, 0x0, 0x0);
        gbc.writeMem(0x1e3e, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x84);
        EXPECT(gbc.b(),  0x5f);
        EXPECT(gbc.c(),  0xe8);
        EXPECT(gbc.d(),  0x82);
        EXPECT(gbc.e(),  0xb3);
        EXPECT(gbc.h(),  0x5);
        EXPECT(gbc.l(),  0xcf);
        EXPECT(gbc.sp(), 0x485b);
        EXPECT(gbc.pc(), 0x1e3f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 018E
        gbc.setState(0x3521, 0xc7da, 0x6140, 0x31e2, 0x8fc6, 0xd417, 0x1, 0x0);
        gbc.writeMem(0x3521, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x61);
        EXPECT(gbc.b(),  0x31);
        EXPECT(gbc.c(),  0xe2);
        EXPECT(gbc.d(),  0x8f);
        EXPECT(gbc.e(),  0xc6);
        EXPECT(gbc.h(),  0xd4);
        EXPECT(gbc.l(),  0x17);
        EXPECT(gbc.sp(), 0xc7da);
        EXPECT(gbc.pc(), 0x3522);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 018F
        gbc.setState(0x962d, 0xb57c, 0x2cd0, 0xcd49, 0x7752, 0xd117, 0x1, 0x1);
        gbc.writeMem(0x962d, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x2c);
        EXPECT(gbc.b(),  0xcd);
        EXPECT(gbc.c(),  0x49);
        EXPECT(gbc.d(),  0x77);
        EXPECT(gbc.e(),  0x52);
        EXPECT(gbc.h(),  0xd1);
        EXPECT(gbc.l(),  0x17);
        EXPECT(gbc.sp(), 0xb57c);
        EXPECT(gbc.pc(), 0x962e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x962d), 0x5b);
        // 5B 0190
        gbc.setState(0x70d, 0xda56, 0xa860, 0x10b1, 0x80a0, 0x3c76, 0x0, 0x1);
        gbc.writeMem(0x70d, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa8);
        EXPECT(gbc.b(),  0x10);
        EXPECT(gbc.c(),  0xb1);
        EXPECT(gbc.d(),  0x80);
        EXPECT(gbc.e(),  0xa0);
        EXPECT(gbc.h(),  0x3c);
        EXPECT(gbc.l(),  0x76);
        EXPECT(gbc.sp(), 0xda56);
        EXPECT(gbc.pc(), 0x70e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0191
        gbc.setState(0x7ab, 0xa97c, 0x3370, 0xcce8, 0x102, 0x352f, 0x0, 0x0);
        gbc.writeMem(0x7ab, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x33);
        EXPECT(gbc.b(),  0xcc);
        EXPECT(gbc.c(),  0xe8);
        EXPECT(gbc.d(),  0x1);
        EXPECT(gbc.e(),  0x2);
        EXPECT(gbc.h(),  0x35);
        EXPECT(gbc.l(),  0x2f);
        EXPECT(gbc.sp(), 0xa97c);
        EXPECT(gbc.pc(), 0x7ac);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0192
        gbc.setState(0x105c, 0x7fa0, 0x8ff0, 0x63a7, 0x10e7, 0x99a2, 0x0, 0x0);
        gbc.writeMem(0x105c, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x8f);
        EXPECT(gbc.b(),  0x63);
        EXPECT(gbc.c(),  0xa7);
        EXPECT(gbc.d(),  0x10);
        EXPECT(gbc.e(),  0xe7);
        EXPECT(gbc.h(),  0x99);
        EXPECT(gbc.l(),  0xa2);
        EXPECT(gbc.sp(), 0x7fa0);
        EXPECT(gbc.pc(), 0x105d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0193
        gbc.setState(0x159, 0x180d, 0xa520, 0x38db, 0x66c, 0x482c, 0x0, 0x1);
        gbc.writeMem(0x159, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa5);
        EXPECT(gbc.b(),  0x38);
        EXPECT(gbc.c(),  0xdb);
        EXPECT(gbc.d(),  0x6);
        EXPECT(gbc.e(),  0x6c);
        EXPECT(gbc.h(),  0x48);
        EXPECT(gbc.l(),  0x2c);
        EXPECT(gbc.sp(), 0x180d);
        EXPECT(gbc.pc(), 0x15a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0194
        gbc.setState(0x9f1e, 0x63a9, 0xb500, 0x9321, 0x6704, 0xeda7, 0x1, 0x1);
        gbc.writeMem(0x9f1e, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xb5);
        EXPECT(gbc.b(),  0x93);
        EXPECT(gbc.c(),  0x21);
        EXPECT(gbc.d(),  0x67);
        EXPECT(gbc.e(),  0x4);
        EXPECT(gbc.h(),  0xed);
        EXPECT(gbc.l(),  0xa7);
        EXPECT(gbc.sp(), 0x63a9);
        EXPECT(gbc.pc(), 0x9f1f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9f1e), 0x5b);
        // 5B 0195
        gbc.setState(0x4855, 0x5e25, 0x2030, 0x15ff, 0x2586, 0xf583, 0x1, 0x0);
        gbc.writeMem(0x4855, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0x15);
        EXPECT(gbc.c(),  0xff);
        EXPECT(gbc.d(),  0x25);
        EXPECT(gbc.e(),  0x86);
        EXPECT(gbc.h(),  0xf5);
        EXPECT(gbc.l(),  0x83);
        EXPECT(gbc.sp(), 0x5e25);
        EXPECT(gbc.pc(), 0x4856);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0196
        gbc.setState(0xe30, 0x3f52, 0xad10, 0x37df, 0x7b54, 0x9cd2, 0x1, 0x1);
        gbc.writeMem(0xe30, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xad);
        EXPECT(gbc.b(),  0x37);
        EXPECT(gbc.c(),  0xdf);
        EXPECT(gbc.d(),  0x7b);
        EXPECT(gbc.e(),  0x54);
        EXPECT(gbc.h(),  0x9c);
        EXPECT(gbc.l(),  0xd2);
        EXPECT(gbc.sp(), 0x3f52);
        EXPECT(gbc.pc(), 0xe31);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 0197
        gbc.setState(0x35bb, 0x364b, 0xa9c0, 0xfbf3, 0x571d, 0x5477, 0x1, 0x1);
        gbc.writeMem(0x35bb, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa9);
        EXPECT(gbc.b(),  0xfb);
        EXPECT(gbc.c(),  0xf3);
        EXPECT(gbc.d(),  0x57);
        EXPECT(gbc.e(),  0x1d);
        EXPECT(gbc.h(),  0x54);
        EXPECT(gbc.l(),  0x77);
        EXPECT(gbc.sp(), 0x364b);
        EXPECT(gbc.pc(), 0x35bc);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0198
        gbc.setState(0x36de, 0x7e5c, 0xe4a0, 0xf20c, 0x7e59, 0x78ac, 0x0, 0x0);
        gbc.writeMem(0x36de, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xe4);
        EXPECT(gbc.b(),  0xf2);
        EXPECT(gbc.c(),  0xc);
        EXPECT(gbc.d(),  0x7e);
        EXPECT(gbc.e(),  0x59);
        EXPECT(gbc.h(),  0x78);
        EXPECT(gbc.l(),  0xac);
        EXPECT(gbc.sp(), 0x7e5c);
        EXPECT(gbc.pc(), 0x36df);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0199
        gbc.setState(0x1515, 0x4ab, 0x5b10, 0x3d55, 0xc920, 0x86f4, 0x1, 0x1);
        gbc.writeMem(0x1515, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x5b);
        EXPECT(gbc.b(),  0x3d);
        EXPECT(gbc.c(),  0x55);
        EXPECT(gbc.d(),  0xc9);
        EXPECT(gbc.e(),  0x20);
        EXPECT(gbc.h(),  0x86);
        EXPECT(gbc.l(),  0xf4);
        EXPECT(gbc.sp(), 0x4ab);
        EXPECT(gbc.pc(), 0x1516);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 019A
        gbc.setState(0xc95c, 0x38fb, 0xa460, 0x190a, 0xb35a, 0x9b50, 0x1, 0x1);
        gbc.writeMem(0xc95c, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa4);
        EXPECT(gbc.b(),  0x19);
        EXPECT(gbc.c(),  0xa);
        EXPECT(gbc.d(),  0xb3);
        EXPECT(gbc.e(),  0x5a);
        EXPECT(gbc.h(),  0x9b);
        EXPECT(gbc.l(),  0x50);
        EXPECT(gbc.sp(), 0x38fb);
        EXPECT(gbc.pc(), 0xc95d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc95c), 0x5b);
        // 5B 019B
        gbc.setState(0x69cc, 0x7690, 0xba10, 0xa7f3, 0x221, 0xc6c1, 0x0, 0x1);
        gbc.writeMem(0x69cc, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xba);
        EXPECT(gbc.b(),  0xa7);
        EXPECT(gbc.c(),  0xf3);
        EXPECT(gbc.d(),  0x2);
        EXPECT(gbc.e(),  0x21);
        EXPECT(gbc.h(),  0xc6);
        EXPECT(gbc.l(),  0xc1);
        EXPECT(gbc.sp(), 0x7690);
        EXPECT(gbc.pc(), 0x69cd);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 019C
        gbc.setState(0xc801, 0x2a74, 0x8ce0, 0x71d3, 0x6ff, 0xedb9, 0x1, 0x0);
        gbc.writeMem(0xc801, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x8c);
        EXPECT(gbc.b(),  0x71);
        EXPECT(gbc.c(),  0xd3);
        EXPECT(gbc.d(),  0x6);
        EXPECT(gbc.e(),  0xff);
        EXPECT(gbc.h(),  0xed);
        EXPECT(gbc.l(),  0xb9);
        EXPECT(gbc.sp(), 0x2a74);
        EXPECT(gbc.pc(), 0xc802);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc801), 0x5b);
        // 5B 019D
        gbc.setState(0xb6a7, 0x3341, 0x8690, 0xe235, 0x5cb7, 0xd23b, 0x1, 0x1);
        gbc.writeMem(0xb6a7, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x86);
        EXPECT(gbc.b(),  0xe2);
        EXPECT(gbc.c(),  0x35);
        EXPECT(gbc.d(),  0x5c);
        EXPECT(gbc.e(),  0xb7);
        EXPECT(gbc.h(),  0xd2);
        EXPECT(gbc.l(),  0x3b);
        EXPECT(gbc.sp(), 0x3341);
        EXPECT(gbc.pc(), 0xb6a8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb6a7), 0x5b);
        // 5B 019E
        gbc.setState(0x1d33, 0x6f95, 0xf3f0, 0xcaf3, 0x3113, 0xdb9d, 0x1, 0x0);
        gbc.writeMem(0x1d33, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf3);
        EXPECT(gbc.b(),  0xca);
        EXPECT(gbc.c(),  0xf3);
        EXPECT(gbc.d(),  0x31);
        EXPECT(gbc.e(),  0x13);
        EXPECT(gbc.h(),  0xdb);
        EXPECT(gbc.l(),  0x9d);
        EXPECT(gbc.sp(), 0x6f95);
        EXPECT(gbc.pc(), 0x1d34);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 019F
        gbc.setState(0xe4fe, 0x6075, 0x5920, 0xbf86, 0x89bd, 0x26dd, 0x0, 0x0);
        gbc.writeMem(0xe4fe, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x59);
        EXPECT(gbc.b(),  0xbf);
        EXPECT(gbc.c(),  0x86);
        EXPECT(gbc.d(),  0x89);
        EXPECT(gbc.e(),  0xbd);
        EXPECT(gbc.h(),  0x26);
        EXPECT(gbc.l(),  0xdd);
        EXPECT(gbc.sp(), 0x6075);
        EXPECT(gbc.pc(), 0xe4ff);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe4fe), 0x5b);
        // 5B 01A0
        gbc.setState(0x9588, 0xef5b, 0xe870, 0x37ec, 0x8ff0, 0xb92b, 0x1, 0x0);
        gbc.writeMem(0x9588, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xe8);
        EXPECT(gbc.b(),  0x37);
        EXPECT(gbc.c(),  0xec);
        EXPECT(gbc.d(),  0x8f);
        EXPECT(gbc.e(),  0xf0);
        EXPECT(gbc.h(),  0xb9);
        EXPECT(gbc.l(),  0x2b);
        EXPECT(gbc.sp(), 0xef5b);
        EXPECT(gbc.pc(), 0x9589);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9588), 0x5b);
        // 5B 01A1
        gbc.setState(0xd1dd, 0x274, 0x6a50, 0x4528, 0x2bbe, 0xb7dc, 0x1, 0x0);
        gbc.writeMem(0xd1dd, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x6a);
        EXPECT(gbc.b(),  0x45);
        EXPECT(gbc.c(),  0x28);
        EXPECT(gbc.d(),  0x2b);
        EXPECT(gbc.e(),  0xbe);
        EXPECT(gbc.h(),  0xb7);
        EXPECT(gbc.l(),  0xdc);
        EXPECT(gbc.sp(), 0x274);
        EXPECT(gbc.pc(), 0xd1de);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd1dd), 0x5b);
        // 5B 01A2
        gbc.setState(0x3108, 0x68ef, 0x41f0, 0xa025, 0xb60, 0xe628, 0x0, 0x1);
        gbc.writeMem(0x3108, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x41);
        EXPECT(gbc.b(),  0xa0);
        EXPECT(gbc.c(),  0x25);
        EXPECT(gbc.d(),  0xb);
        EXPECT(gbc.e(),  0x60);
        EXPECT(gbc.h(),  0xe6);
        EXPECT(gbc.l(),  0x28);
        EXPECT(gbc.sp(), 0x68ef);
        EXPECT(gbc.pc(), 0x3109);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 01A3
        gbc.setState(0xd3c7, 0xc8b4, 0x5d20, 0x1c24, 0xc3b1, 0xa5f1, 0x1, 0x1);
        gbc.writeMem(0xd3c7, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x5d);
        EXPECT(gbc.b(),  0x1c);
        EXPECT(gbc.c(),  0x24);
        EXPECT(gbc.d(),  0xc3);
        EXPECT(gbc.e(),  0xb1);
        EXPECT(gbc.h(),  0xa5);
        EXPECT(gbc.l(),  0xf1);
        EXPECT(gbc.sp(), 0xc8b4);
        EXPECT(gbc.pc(), 0xd3c8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd3c7), 0x5b);
        // 5B 01A4
        gbc.setState(0xf1c, 0x4b63, 0xf270, 0xe88, 0xcf6e, 0x962c, 0x1, 0x1);
        gbc.writeMem(0xf1c, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf2);
        EXPECT(gbc.b(),  0xe);
        EXPECT(gbc.c(),  0x88);
        EXPECT(gbc.d(),  0xcf);
        EXPECT(gbc.e(),  0x6e);
        EXPECT(gbc.h(),  0x96);
        EXPECT(gbc.l(),  0x2c);
        EXPECT(gbc.sp(), 0x4b63);
        EXPECT(gbc.pc(), 0xf1d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 01A5
        gbc.setState(0x6510, 0xc6c4, 0x5c70, 0x4fba, 0xf0c8, 0x804b, 0x0, 0x1);
        gbc.writeMem(0x6510, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x5c);
        EXPECT(gbc.b(),  0x4f);
        EXPECT(gbc.c(),  0xba);
        EXPECT(gbc.d(),  0xf0);
        EXPECT(gbc.e(),  0xc8);
        EXPECT(gbc.h(),  0x80);
        EXPECT(gbc.l(),  0x4b);
        EXPECT(gbc.sp(), 0xc6c4);
        EXPECT(gbc.pc(), 0x6511);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 01A6
        gbc.setState(0x8e60, 0x388b, 0x74d0, 0xff26, 0x9e59, 0x758e, 0x1, 0x1);
        gbc.writeMem(0x8e60, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x74);
        EXPECT(gbc.b(),  0xff);
        EXPECT(gbc.c(),  0x26);
        EXPECT(gbc.d(),  0x9e);
        EXPECT(gbc.e(),  0x59);
        EXPECT(gbc.h(),  0x75);
        EXPECT(gbc.l(),  0x8e);
        EXPECT(gbc.sp(), 0x388b);
        EXPECT(gbc.pc(), 0x8e61);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8e60), 0x5b);
        // 5B 01A7
        gbc.setState(0x6ef1, 0xc031, 0x3bc0, 0x4e84, 0x2ac4, 0xf935, 0x1, 0x1);
        gbc.writeMem(0x6ef1, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x3b);
        EXPECT(gbc.b(),  0x4e);
        EXPECT(gbc.c(),  0x84);
        EXPECT(gbc.d(),  0x2a);
        EXPECT(gbc.e(),  0xc4);
        EXPECT(gbc.h(),  0xf9);
        EXPECT(gbc.l(),  0x35);
        EXPECT(gbc.sp(), 0xc031);
        EXPECT(gbc.pc(), 0x6ef2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 01A8
        gbc.setState(0x90e5, 0x4e4b, 0xd1d0, 0x7736, 0x8ea7, 0x21b2, 0x0, 0x1);
        gbc.writeMem(0x90e5, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd1);
        EXPECT(gbc.b(),  0x77);
        EXPECT(gbc.c(),  0x36);
        EXPECT(gbc.d(),  0x8e);
        EXPECT(gbc.e(),  0xa7);
        EXPECT(gbc.h(),  0x21);
        EXPECT(gbc.l(),  0xb2);
        EXPECT(gbc.sp(), 0x4e4b);
        EXPECT(gbc.pc(), 0x90e6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x90e5), 0x5b);
        // 5B 01A9
        gbc.setState(0x25b3, 0x3591, 0x6e90, 0x21d1, 0xcc01, 0x56d3, 0x0, 0x0);
        gbc.writeMem(0x25b3, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x6e);
        EXPECT(gbc.b(),  0x21);
        EXPECT(gbc.c(),  0xd1);
        EXPECT(gbc.d(),  0xcc);
        EXPECT(gbc.e(),  0x1);
        EXPECT(gbc.h(),  0x56);
        EXPECT(gbc.l(),  0xd3);
        EXPECT(gbc.sp(), 0x3591);
        EXPECT(gbc.pc(), 0x25b4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 01AA
        gbc.setState(0x66da, 0xbb9, 0x7c00, 0x22eb, 0xb212, 0xb05b, 0x1, 0x1);
        gbc.writeMem(0x66da, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x7c);
        EXPECT(gbc.b(),  0x22);
        EXPECT(gbc.c(),  0xeb);
        EXPECT(gbc.d(),  0xb2);
        EXPECT(gbc.e(),  0x12);
        EXPECT(gbc.h(),  0xb0);
        EXPECT(gbc.l(),  0x5b);
        EXPECT(gbc.sp(), 0xbb9);
        EXPECT(gbc.pc(), 0x66db);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 01AB
        gbc.setState(0x87b4, 0x1c2f, 0x2af0, 0x5adb, 0x617f, 0xbea6, 0x0, 0x0);
        gbc.writeMem(0x87b4, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x2a);
        EXPECT(gbc.b(),  0x5a);
        EXPECT(gbc.c(),  0xdb);
        EXPECT(gbc.d(),  0x61);
        EXPECT(gbc.e(),  0x7f);
        EXPECT(gbc.h(),  0xbe);
        EXPECT(gbc.l(),  0xa6);
        EXPECT(gbc.sp(), 0x1c2f);
        EXPECT(gbc.pc(), 0x87b5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x87b4), 0x5b);
        // 5B 01AC
        gbc.setState(0x947e, 0xe71, 0xad40, 0x3baf, 0x3a53, 0x177f, 0x0, 0x1);
        gbc.writeMem(0x947e, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xad);
        EXPECT(gbc.b(),  0x3b);
        EXPECT(gbc.c(),  0xaf);
        EXPECT(gbc.d(),  0x3a);
        EXPECT(gbc.e(),  0x53);
        EXPECT(gbc.h(),  0x17);
        EXPECT(gbc.l(),  0x7f);
        EXPECT(gbc.sp(), 0xe71);
        EXPECT(gbc.pc(), 0x947f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x947e), 0x5b);
        // 5B 01AD
        gbc.setState(0xc20e, 0xd854, 0xc4f0, 0x745, 0x3622, 0x3877, 0x0, 0x1);
        gbc.writeMem(0xc20e, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xc4);
        EXPECT(gbc.b(),  0x7);
        EXPECT(gbc.c(),  0x45);
        EXPECT(gbc.d(),  0x36);
        EXPECT(gbc.e(),  0x22);
        EXPECT(gbc.h(),  0x38);
        EXPECT(gbc.l(),  0x77);
        EXPECT(gbc.sp(), 0xd854);
        EXPECT(gbc.pc(), 0xc20f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc20e), 0x5b);
        // 5B 01AE
        gbc.setState(0xda1c, 0x22b8, 0x86b0, 0x169e, 0x2b87, 0x5758, 0x0, 0x0);
        gbc.writeMem(0xda1c, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x86);
        EXPECT(gbc.b(),  0x16);
        EXPECT(gbc.c(),  0x9e);
        EXPECT(gbc.d(),  0x2b);
        EXPECT(gbc.e(),  0x87);
        EXPECT(gbc.h(),  0x57);
        EXPECT(gbc.l(),  0x58);
        EXPECT(gbc.sp(), 0x22b8);
        EXPECT(gbc.pc(), 0xda1d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xda1c), 0x5b);
        // 5B 01AF
        gbc.setState(0xaa55, 0x48f3, 0x90b0, 0x6516, 0x1092, 0xc69f, 0x0, 0x1);
        gbc.writeMem(0xaa55, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x90);
        EXPECT(gbc.b(),  0x65);
        EXPECT(gbc.c(),  0x16);
        EXPECT(gbc.d(),  0x10);
        EXPECT(gbc.e(),  0x92);
        EXPECT(gbc.h(),  0xc6);
        EXPECT(gbc.l(),  0x9f);
        EXPECT(gbc.sp(), 0x48f3);
        EXPECT(gbc.pc(), 0xaa56);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xaa55), 0x5b);
        // 5B 01B0
        gbc.setState(0x15b1, 0x58d1, 0xf9a0, 0x46f1, 0x9a0c, 0x2ac1, 0x1, 0x0);
        gbc.writeMem(0x15b1, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf9);
        EXPECT(gbc.b(),  0x46);
        EXPECT(gbc.c(),  0xf1);
        EXPECT(gbc.d(),  0x9a);
        EXPECT(gbc.e(),  0xc);
        EXPECT(gbc.h(),  0x2a);
        EXPECT(gbc.l(),  0xc1);
        EXPECT(gbc.sp(), 0x58d1);
        EXPECT(gbc.pc(), 0x15b2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 01B1
        gbc.setState(0xefb8, 0x9674, 0xa9b0, 0xab24, 0xc99c, 0x8c4c, 0x1, 0x1);
        gbc.writeMem(0xefb8, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa9);
        EXPECT(gbc.b(),  0xab);
        EXPECT(gbc.c(),  0x24);
        EXPECT(gbc.d(),  0xc9);
        EXPECT(gbc.e(),  0x9c);
        EXPECT(gbc.h(),  0x8c);
        EXPECT(gbc.l(),  0x4c);
        EXPECT(gbc.sp(), 0x9674);
        EXPECT(gbc.pc(), 0xefb9);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xefb8), 0x5b);
        // 5B 01B2
        gbc.setState(0xdd33, 0xf58a, 0x45d0, 0x398b, 0x2f3b, 0x548, 0x0, 0x0);
        gbc.writeMem(0xdd33, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x45);
        EXPECT(gbc.b(),  0x39);
        EXPECT(gbc.c(),  0x8b);
        EXPECT(gbc.d(),  0x2f);
        EXPECT(gbc.e(),  0x3b);
        EXPECT(gbc.h(),  0x5);
        EXPECT(gbc.l(),  0x48);
        EXPECT(gbc.sp(), 0xf58a);
        EXPECT(gbc.pc(), 0xdd34);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xdd33), 0x5b);
        // 5B 01B3
        gbc.setState(0x44e4, 0xa8ab, 0x9000, 0x3bcd, 0x4e08, 0x65b4, 0x0, 0x1);
        gbc.writeMem(0x44e4, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x90);
        EXPECT(gbc.b(),  0x3b);
        EXPECT(gbc.c(),  0xcd);
        EXPECT(gbc.d(),  0x4e);
        EXPECT(gbc.e(),  0x8);
        EXPECT(gbc.h(),  0x65);
        EXPECT(gbc.l(),  0xb4);
        EXPECT(gbc.sp(), 0xa8ab);
        EXPECT(gbc.pc(), 0x44e5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 01B5
        gbc.setState(0x7230, 0xf672, 0x7170, 0x9498, 0xfb6d, 0xf963, 0x1, 0x0);
        gbc.writeMem(0x7230, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x71);
        EXPECT(gbc.b(),  0x94);
        EXPECT(gbc.c(),  0x98);
        EXPECT(gbc.d(),  0xfb);
        EXPECT(gbc.e(),  0x6d);
        EXPECT(gbc.h(),  0xf9);
        EXPECT(gbc.l(),  0x63);
        EXPECT(gbc.sp(), 0xf672);
        EXPECT(gbc.pc(), 0x7231);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 01B6
        gbc.setState(0x71f8, 0x48a7, 0x6ee0, 0x137b, 0x6a14, 0x8c4c, 0x1, 0x1);
        gbc.writeMem(0x71f8, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x6e);
        EXPECT(gbc.b(),  0x13);
        EXPECT(gbc.c(),  0x7b);
        EXPECT(gbc.d(),  0x6a);
        EXPECT(gbc.e(),  0x14);
        EXPECT(gbc.h(),  0x8c);
        EXPECT(gbc.l(),  0x4c);
        EXPECT(gbc.sp(), 0x48a7);
        EXPECT(gbc.pc(), 0x71f9);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 01B7
        gbc.setState(0x8434, 0xc6d4, 0xc400, 0xf7fd, 0x2cb1, 0x8c2b, 0x1, 0x1);
        gbc.writeMem(0x8434, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xc4);
        EXPECT(gbc.b(),  0xf7);
        EXPECT(gbc.c(),  0xfd);
        EXPECT(gbc.d(),  0x2c);
        EXPECT(gbc.e(),  0xb1);
        EXPECT(gbc.h(),  0x8c);
        EXPECT(gbc.l(),  0x2b);
        EXPECT(gbc.sp(), 0xc6d4);
        EXPECT(gbc.pc(), 0x8435);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8434), 0x5b);
        // 5B 01B8
        gbc.setState(0x97e, 0x5a91, 0xa9d0, 0xf184, 0x15b8, 0x3964, 0x1, 0x0);
        gbc.writeMem(0x97e, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa9);
        EXPECT(gbc.b(),  0xf1);
        EXPECT(gbc.c(),  0x84);
        EXPECT(gbc.d(),  0x15);
        EXPECT(gbc.e(),  0xb8);
        EXPECT(gbc.h(),  0x39);
        EXPECT(gbc.l(),  0x64);
        EXPECT(gbc.sp(), 0x5a91);
        EXPECT(gbc.pc(), 0x97f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 01B9
        gbc.setState(0x336f, 0x5b9b, 0xe070, 0xbc75, 0x1813, 0xdfff, 0x0, 0x1);
        gbc.writeMem(0x336f, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xe0);
        EXPECT(gbc.b(),  0xbc);
        EXPECT(gbc.c(),  0x75);
        EXPECT(gbc.d(),  0x18);
        EXPECT(gbc.e(),  0x13);
        EXPECT(gbc.h(),  0xdf);
        EXPECT(gbc.l(),  0xff);
        EXPECT(gbc.sp(), 0x5b9b);
        EXPECT(gbc.pc(), 0x3370);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 01BA
        gbc.setState(0x1da2, 0x5c0e, 0x9590, 0x2164, 0xc9c, 0x716c, 0x0, 0x0);
        gbc.writeMem(0x1da2, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x95);
        EXPECT(gbc.b(),  0x21);
        EXPECT(gbc.c(),  0x64);
        EXPECT(gbc.d(),  0xc);
        EXPECT(gbc.e(),  0x9c);
        EXPECT(gbc.h(),  0x71);
        EXPECT(gbc.l(),  0x6c);
        EXPECT(gbc.sp(), 0x5c0e);
        EXPECT(gbc.pc(), 0x1da3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 01BB
        gbc.setState(0x524f, 0xf27a, 0x2d50, 0x40e6, 0x2e8a, 0x6852, 0x1, 0x1);
        gbc.writeMem(0x524f, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x2d);
        EXPECT(gbc.b(),  0x40);
        EXPECT(gbc.c(),  0xe6);
        EXPECT(gbc.d(),  0x2e);
        EXPECT(gbc.e(),  0x8a);
        EXPECT(gbc.h(),  0x68);
        EXPECT(gbc.l(),  0x52);
        EXPECT(gbc.sp(), 0xf27a);
        EXPECT(gbc.pc(), 0x5250);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 01BC
        gbc.setState(0xa400, 0x91dd, 0x1d30, 0x7732, 0x5862, 0xc37b, 0x1, 0x1);
        gbc.writeMem(0xa400, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x1d);
        EXPECT(gbc.b(),  0x77);
        EXPECT(gbc.c(),  0x32);
        EXPECT(gbc.d(),  0x58);
        EXPECT(gbc.e(),  0x62);
        EXPECT(gbc.h(),  0xc3);
        EXPECT(gbc.l(),  0x7b);
        EXPECT(gbc.sp(), 0x91dd);
        EXPECT(gbc.pc(), 0xa401);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa400), 0x5b);
        // 5B 01BD
        gbc.setState(0x3837, 0x9b45, 0x7590, 0x1cf7, 0xe02e, 0x92c8, 0x0, 0x0);
        gbc.writeMem(0x3837, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x75);
        EXPECT(gbc.b(),  0x1c);
        EXPECT(gbc.c(),  0xf7);
        EXPECT(gbc.d(),  0xe0);
        EXPECT(gbc.e(),  0x2e);
        EXPECT(gbc.h(),  0x92);
        EXPECT(gbc.l(),  0xc8);
        EXPECT(gbc.sp(), 0x9b45);
        EXPECT(gbc.pc(), 0x3838);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 01BE
        gbc.setState(0x8e25, 0xb277, 0x1500, 0x26cc, 0x8039, 0xe2e7, 0x1, 0x1);
        gbc.writeMem(0x8e25, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x15);
        EXPECT(gbc.b(),  0x26);
        EXPECT(gbc.c(),  0xcc);
        EXPECT(gbc.d(),  0x80);
        EXPECT(gbc.e(),  0x39);
        EXPECT(gbc.h(),  0xe2);
        EXPECT(gbc.l(),  0xe7);
        EXPECT(gbc.sp(), 0xb277);
        EXPECT(gbc.pc(), 0x8e26);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8e25), 0x5b);
        // 5B 01BF
        gbc.setState(0xe0d, 0x2c2b, 0xb830, 0xd3bc, 0xb741, 0x6366, 0x0, 0x0);
        gbc.writeMem(0xe0d, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xb8);
        EXPECT(gbc.b(),  0xd3);
        EXPECT(gbc.c(),  0xbc);
        EXPECT(gbc.d(),  0xb7);
        EXPECT(gbc.e(),  0x41);
        EXPECT(gbc.h(),  0x63);
        EXPECT(gbc.l(),  0x66);
        EXPECT(gbc.sp(), 0x2c2b);
        EXPECT(gbc.pc(), 0xe0e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 01C0
        gbc.setState(0x8b98, 0xa63f, 0x7030, 0x843, 0xb697, 0x8b3d, 0x0, 0x0);
        gbc.writeMem(0x8b98, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x70);
        EXPECT(gbc.b(),  0x8);
        EXPECT(gbc.c(),  0x43);
        EXPECT(gbc.d(),  0xb6);
        EXPECT(gbc.e(),  0x97);
        EXPECT(gbc.h(),  0x8b);
        EXPECT(gbc.l(),  0x3d);
        EXPECT(gbc.sp(), 0xa63f);
        EXPECT(gbc.pc(), 0x8b99);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8b98), 0x5b);
        // 5B 01C1
        gbc.setState(0x49b2, 0x9e2b, 0x65a0, 0xacad, 0x38a8, 0x8ab0, 0x1, 0x1);
        gbc.writeMem(0x49b2, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x65);
        EXPECT(gbc.b(),  0xac);
        EXPECT(gbc.c(),  0xad);
        EXPECT(gbc.d(),  0x38);
        EXPECT(gbc.e(),  0xa8);
        EXPECT(gbc.h(),  0x8a);
        EXPECT(gbc.l(),  0xb0);
        EXPECT(gbc.sp(), 0x9e2b);
        EXPECT(gbc.pc(), 0x49b3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 01C2
        gbc.setState(0x8f18, 0x7a17, 0xd7c0, 0xee7d, 0xeac2, 0xf091, 0x0, 0x0);
        gbc.writeMem(0x8f18, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd7);
        EXPECT(gbc.b(),  0xee);
        EXPECT(gbc.c(),  0x7d);
        EXPECT(gbc.d(),  0xea);
        EXPECT(gbc.e(),  0xc2);
        EXPECT(gbc.h(),  0xf0);
        EXPECT(gbc.l(),  0x91);
        EXPECT(gbc.sp(), 0x7a17);
        EXPECT(gbc.pc(), 0x8f19);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8f18), 0x5b);
        // 5B 01C3
        gbc.setState(0xaa3a, 0x182a, 0xeac0, 0x7a42, 0x6421, 0xa736, 0x1, 0x0);
        gbc.writeMem(0xaa3a, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xea);
        EXPECT(gbc.b(),  0x7a);
        EXPECT(gbc.c(),  0x42);
        EXPECT(gbc.d(),  0x64);
        EXPECT(gbc.e(),  0x21);
        EXPECT(gbc.h(),  0xa7);
        EXPECT(gbc.l(),  0x36);
        EXPECT(gbc.sp(), 0x182a);
        EXPECT(gbc.pc(), 0xaa3b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xaa3a), 0x5b);
        // 5B 01C4
        gbc.setState(0x6f3d, 0xfac8, 0x9400, 0xf9b7, 0x5954, 0x4720, 0x1, 0x1);
        gbc.writeMem(0x6f3d, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x94);
        EXPECT(gbc.b(),  0xf9);
        EXPECT(gbc.c(),  0xb7);
        EXPECT(gbc.d(),  0x59);
        EXPECT(gbc.e(),  0x54);
        EXPECT(gbc.h(),  0x47);
        EXPECT(gbc.l(),  0x20);
        EXPECT(gbc.sp(), 0xfac8);
        EXPECT(gbc.pc(), 0x6f3e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 01C5
        gbc.setState(0x5386, 0xfe29, 0x54d0, 0x9817, 0x60bd, 0x262a, 0x0, 0x0);
        gbc.writeMem(0x5386, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x54);
        EXPECT(gbc.b(),  0x98);
        EXPECT(gbc.c(),  0x17);
        EXPECT(gbc.d(),  0x60);
        EXPECT(gbc.e(),  0xbd);
        EXPECT(gbc.h(),  0x26);
        EXPECT(gbc.l(),  0x2a);
        EXPECT(gbc.sp(), 0xfe29);
        EXPECT(gbc.pc(), 0x5387);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 01C6
        gbc.setState(0x3656, 0xd8d9, 0x1c90, 0x756d, 0x2d35, 0xd491, 0x1, 0x1);
        gbc.writeMem(0x3656, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x1c);
        EXPECT(gbc.b(),  0x75);
        EXPECT(gbc.c(),  0x6d);
        EXPECT(gbc.d(),  0x2d);
        EXPECT(gbc.e(),  0x35);
        EXPECT(gbc.h(),  0xd4);
        EXPECT(gbc.l(),  0x91);
        EXPECT(gbc.sp(), 0xd8d9);
        EXPECT(gbc.pc(), 0x3657);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 01C7
        gbc.setState(0xeccf, 0x469e, 0x7f30, 0xb9ba, 0x38d0, 0x58ec, 0x1, 0x0);
        gbc.writeMem(0xeccf, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x7f);
        EXPECT(gbc.b(),  0xb9);
        EXPECT(gbc.c(),  0xba);
        EXPECT(gbc.d(),  0x38);
        EXPECT(gbc.e(),  0xd0);
        EXPECT(gbc.h(),  0x58);
        EXPECT(gbc.l(),  0xec);
        EXPECT(gbc.sp(), 0x469e);
        EXPECT(gbc.pc(), 0xecd0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xeccf), 0x5b);
        // 5B 01C9
        gbc.setState(0xa6cd, 0x8057, 0x6100, 0x87f1, 0x5657, 0x539c, 0x0, 0x1);
        gbc.writeMem(0xa6cd, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x61);
        EXPECT(gbc.b(),  0x87);
        EXPECT(gbc.c(),  0xf1);
        EXPECT(gbc.d(),  0x56);
        EXPECT(gbc.e(),  0x57);
        EXPECT(gbc.h(),  0x53);
        EXPECT(gbc.l(),  0x9c);
        EXPECT(gbc.sp(), 0x8057);
        EXPECT(gbc.pc(), 0xa6ce);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa6cd), 0x5b);
        // 5B 01CA
        gbc.setState(0xc622, 0x9dd7, 0x7000, 0x27dd, 0x4a50, 0xcdc, 0x1, 0x0);
        gbc.writeMem(0xc622, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x70);
        EXPECT(gbc.b(),  0x27);
        EXPECT(gbc.c(),  0xdd);
        EXPECT(gbc.d(),  0x4a);
        EXPECT(gbc.e(),  0x50);
        EXPECT(gbc.h(),  0xc);
        EXPECT(gbc.l(),  0xdc);
        EXPECT(gbc.sp(), 0x9dd7);
        EXPECT(gbc.pc(), 0xc623);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc622), 0x5b);
        // 5B 01CB
        gbc.setState(0x816a, 0x5b3e, 0xba20, 0x854d, 0x6789, 0x47e2, 0x1, 0x0);
        gbc.writeMem(0x816a, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xba);
        EXPECT(gbc.b(),  0x85);
        EXPECT(gbc.c(),  0x4d);
        EXPECT(gbc.d(),  0x67);
        EXPECT(gbc.e(),  0x89);
        EXPECT(gbc.h(),  0x47);
        EXPECT(gbc.l(),  0xe2);
        EXPECT(gbc.sp(), 0x5b3e);
        EXPECT(gbc.pc(), 0x816b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x816a), 0x5b);
        // 5B 01CC
        gbc.setState(0x6451, 0x6dc7, 0xe110, 0x58b7, 0x2066, 0x92e1, 0x1, 0x0);
        gbc.writeMem(0x6451, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xe1);
        EXPECT(gbc.b(),  0x58);
        EXPECT(gbc.c(),  0xb7);
        EXPECT(gbc.d(),  0x20);
        EXPECT(gbc.e(),  0x66);
        EXPECT(gbc.h(),  0x92);
        EXPECT(gbc.l(),  0xe1);
        EXPECT(gbc.sp(), 0x6dc7);
        EXPECT(gbc.pc(), 0x6452);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 01CD
        gbc.setState(0xc0fd, 0xdb4c, 0x3eb0, 0x7f8f, 0xd725, 0xbb76, 0x0, 0x1);
        gbc.writeMem(0xc0fd, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x3e);
        EXPECT(gbc.b(),  0x7f);
        EXPECT(gbc.c(),  0x8f);
        EXPECT(gbc.d(),  0xd7);
        EXPECT(gbc.e(),  0x25);
        EXPECT(gbc.h(),  0xbb);
        EXPECT(gbc.l(),  0x76);
        EXPECT(gbc.sp(), 0xdb4c);
        EXPECT(gbc.pc(), 0xc0fe);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc0fd), 0x5b);
        // 5B 01CE
        gbc.setState(0x3173, 0x5433, 0x4aa0, 0xf2eb, 0xdd45, 0x79c7, 0x1, 0x0);
        gbc.writeMem(0x3173, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x4a);
        EXPECT(gbc.b(),  0xf2);
        EXPECT(gbc.c(),  0xeb);
        EXPECT(gbc.d(),  0xdd);
        EXPECT(gbc.e(),  0x45);
        EXPECT(gbc.h(),  0x79);
        EXPECT(gbc.l(),  0xc7);
        EXPECT(gbc.sp(), 0x5433);
        EXPECT(gbc.pc(), 0x3174);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 01CF
        gbc.setState(0xd467, 0xa7ce, 0xcb30, 0xf189, 0x4fb4, 0xbd54, 0x0, 0x1);
        gbc.writeMem(0xd467, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xcb);
        EXPECT(gbc.b(),  0xf1);
        EXPECT(gbc.c(),  0x89);
        EXPECT(gbc.d(),  0x4f);
        EXPECT(gbc.e(),  0xb4);
        EXPECT(gbc.h(),  0xbd);
        EXPECT(gbc.l(),  0x54);
        EXPECT(gbc.sp(), 0xa7ce);
        EXPECT(gbc.pc(), 0xd468);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd467), 0x5b);
        // 5B 01D1
        gbc.setState(0xecba, 0xe5fc, 0xbf50, 0xa7a3, 0x460, 0x1cb6, 0x1, 0x0);
        gbc.writeMem(0xecba, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xbf);
        EXPECT(gbc.b(),  0xa7);
        EXPECT(gbc.c(),  0xa3);
        EXPECT(gbc.d(),  0x4);
        EXPECT(gbc.e(),  0x60);
        EXPECT(gbc.h(),  0x1c);
        EXPECT(gbc.l(),  0xb6);
        EXPECT(gbc.sp(), 0xe5fc);
        EXPECT(gbc.pc(), 0xecbb);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xecba), 0x5b);
        // 5B 01D2
        gbc.setState(0xea1b, 0x41cc, 0xe050, 0x5a34, 0xeffd, 0x3d3a, 0x0, 0x1);
        gbc.writeMem(0xea1b, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xe0);
        EXPECT(gbc.b(),  0x5a);
        EXPECT(gbc.c(),  0x34);
        EXPECT(gbc.d(),  0xef);
        EXPECT(gbc.e(),  0xfd);
        EXPECT(gbc.h(),  0x3d);
        EXPECT(gbc.l(),  0x3a);
        EXPECT(gbc.sp(), 0x41cc);
        EXPECT(gbc.pc(), 0xea1c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xea1b), 0x5b);
        // 5B 01D3
        gbc.setState(0xe703, 0x91b4, 0xb120, 0x775d, 0xdf38, 0x21b7, 0x0, 0x0);
        gbc.writeMem(0xe703, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xb1);
        EXPECT(gbc.b(),  0x77);
        EXPECT(gbc.c(),  0x5d);
        EXPECT(gbc.d(),  0xdf);
        EXPECT(gbc.e(),  0x38);
        EXPECT(gbc.h(),  0x21);
        EXPECT(gbc.l(),  0xb7);
        EXPECT(gbc.sp(), 0x91b4);
        EXPECT(gbc.pc(), 0xe704);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe703), 0x5b);
        // 5B 01D4
        gbc.setState(0xe1c2, 0xb9d8, 0x67b0, 0x6839, 0xdbcf, 0x5e6, 0x0, 0x0);
        gbc.writeMem(0xe1c2, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x67);
        EXPECT(gbc.b(),  0x68);
        EXPECT(gbc.c(),  0x39);
        EXPECT(gbc.d(),  0xdb);
        EXPECT(gbc.e(),  0xcf);
        EXPECT(gbc.h(),  0x5);
        EXPECT(gbc.l(),  0xe6);
        EXPECT(gbc.sp(), 0xb9d8);
        EXPECT(gbc.pc(), 0xe1c3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe1c2), 0x5b);
        // 5B 01D5
        gbc.setState(0xd8e0, 0xd4b8, 0x7af0, 0xce4d, 0xab31, 0x5109, 0x0, 0x0);
        gbc.writeMem(0xd8e0, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x7a);
        EXPECT(gbc.b(),  0xce);
        EXPECT(gbc.c(),  0x4d);
        EXPECT(gbc.d(),  0xab);
        EXPECT(gbc.e(),  0x31);
        EXPECT(gbc.h(),  0x51);
        EXPECT(gbc.l(),  0x9);
        EXPECT(gbc.sp(), 0xd4b8);
        EXPECT(gbc.pc(), 0xd8e1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd8e0), 0x5b);
        // 5B 01D6
        gbc.setState(0x2a54, 0x46e6, 0x9c70, 0xcbd, 0x4cd8, 0x24a4, 0x0, 0x1);
        gbc.writeMem(0x2a54, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x9c);
        EXPECT(gbc.b(),  0xc);
        EXPECT(gbc.c(),  0xbd);
        EXPECT(gbc.d(),  0x4c);
        EXPECT(gbc.e(),  0xd8);
        EXPECT(gbc.h(),  0x24);
        EXPECT(gbc.l(),  0xa4);
        EXPECT(gbc.sp(), 0x46e6);
        EXPECT(gbc.pc(), 0x2a55);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 01D7
        gbc.setState(0xc90e, 0x6ca0, 0xb6f0, 0x175f, 0xa692, 0x3959, 0x0, 0x0);
        gbc.writeMem(0xc90e, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xb6);
        EXPECT(gbc.b(),  0x17);
        EXPECT(gbc.c(),  0x5f);
        EXPECT(gbc.d(),  0xa6);
        EXPECT(gbc.e(),  0x92);
        EXPECT(gbc.h(),  0x39);
        EXPECT(gbc.l(),  0x59);
        EXPECT(gbc.sp(), 0x6ca0);
        EXPECT(gbc.pc(), 0xc90f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc90e), 0x5b);
        // 5B 01D8
        gbc.setState(0xdc77, 0xc78d, 0x2d70, 0x5811, 0xc462, 0xace, 0x1, 0x0);
        gbc.writeMem(0xdc77, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x2d);
        EXPECT(gbc.b(),  0x58);
        EXPECT(gbc.c(),  0x11);
        EXPECT(gbc.d(),  0xc4);
        EXPECT(gbc.e(),  0x62);
        EXPECT(gbc.h(),  0xa);
        EXPECT(gbc.l(),  0xce);
        EXPECT(gbc.sp(), 0xc78d);
        EXPECT(gbc.pc(), 0xdc78);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xdc77), 0x5b);
        // 5B 01D9
        gbc.setState(0x3f42, 0xb6dd, 0x28d0, 0xbede, 0x92d6, 0x9327, 0x0, 0x0);
        gbc.writeMem(0x3f42, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0xbe);
        EXPECT(gbc.c(),  0xde);
        EXPECT(gbc.d(),  0x92);
        EXPECT(gbc.e(),  0xd6);
        EXPECT(gbc.h(),  0x93);
        EXPECT(gbc.l(),  0x27);
        EXPECT(gbc.sp(), 0xb6dd);
        EXPECT(gbc.pc(), 0x3f43);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 01DA
        gbc.setState(0xb0f5, 0x93e1, 0x2ba0, 0x33b, 0x5022, 0xa4f1, 0x1, 0x0);
        gbc.writeMem(0xb0f5, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x2b);
        EXPECT(gbc.b(),  0x3);
        EXPECT(gbc.c(),  0x3b);
        EXPECT(gbc.d(),  0x50);
        EXPECT(gbc.e(),  0x22);
        EXPECT(gbc.h(),  0xa4);
        EXPECT(gbc.l(),  0xf1);
        EXPECT(gbc.sp(), 0x93e1);
        EXPECT(gbc.pc(), 0xb0f6);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb0f5), 0x5b);
        // 5B 01DB
        gbc.setState(0x30a5, 0xf103, 0xf0e0, 0x2c7a, 0x1703, 0x40f5, 0x0, 0x0);
        gbc.writeMem(0x30a5, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf0);
        EXPECT(gbc.b(),  0x2c);
        EXPECT(gbc.c(),  0x7a);
        EXPECT(gbc.d(),  0x17);
        EXPECT(gbc.e(),  0x3);
        EXPECT(gbc.h(),  0x40);
        EXPECT(gbc.l(),  0xf5);
        EXPECT(gbc.sp(), 0xf103);
        EXPECT(gbc.pc(), 0x30a6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 01DC
        gbc.setState(0xe64a, 0x842c, 0x1670, 0x151f, 0xd116, 0x1167, 0x1, 0x0);
        gbc.writeMem(0xe64a, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x16);
        EXPECT(gbc.b(),  0x15);
        EXPECT(gbc.c(),  0x1f);
        EXPECT(gbc.d(),  0xd1);
        EXPECT(gbc.e(),  0x16);
        EXPECT(gbc.h(),  0x11);
        EXPECT(gbc.l(),  0x67);
        EXPECT(gbc.sp(), 0x842c);
        EXPECT(gbc.pc(), 0xe64b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe64a), 0x5b);
        // 5B 01DD
        gbc.setState(0xdfe, 0x6dd9, 0x9d20, 0x1ba2, 0x40da, 0x2b4, 0x1, 0x1);
        gbc.writeMem(0xdfe, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x9d);
        EXPECT(gbc.b(),  0x1b);
        EXPECT(gbc.c(),  0xa2);
        EXPECT(gbc.d(),  0x40);
        EXPECT(gbc.e(),  0xda);
        EXPECT(gbc.h(),  0x2);
        EXPECT(gbc.l(),  0xb4);
        EXPECT(gbc.sp(), 0x6dd9);
        EXPECT(gbc.pc(), 0xdff);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 01DE
        gbc.setState(0x7f27, 0xde16, 0xf2d0, 0x24ae, 0x4a00, 0xcf26, 0x1, 0x1);
        gbc.writeMem(0x7f27, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf2);
        EXPECT(gbc.b(),  0x24);
        EXPECT(gbc.c(),  0xae);
        EXPECT(gbc.d(),  0x4a);
        EXPECT(gbc.e(),  0x0);
        EXPECT(gbc.h(),  0xcf);
        EXPECT(gbc.l(),  0x26);
        EXPECT(gbc.sp(), 0xde16);
        EXPECT(gbc.pc(), 0x7f28);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 01DF
        gbc.setState(0xaf3d, 0xb988, 0xecd0, 0xe35d, 0xa23d, 0x6d0d, 0x0, 0x0);
        gbc.writeMem(0xaf3d, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xec);
        EXPECT(gbc.b(),  0xe3);
        EXPECT(gbc.c(),  0x5d);
        EXPECT(gbc.d(),  0xa2);
        EXPECT(gbc.e(),  0x3d);
        EXPECT(gbc.h(),  0x6d);
        EXPECT(gbc.l(),  0xd);
        EXPECT(gbc.sp(), 0xb988);
        EXPECT(gbc.pc(), 0xaf3e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xaf3d), 0x5b);
        // 5B 01E0
        gbc.setState(0x4a0c, 0xc0d0, 0x6bd0, 0x7cef, 0xb2f7, 0x7a1d, 0x1, 0x1);
        gbc.writeMem(0x4a0c, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x6b);
        EXPECT(gbc.b(),  0x7c);
        EXPECT(gbc.c(),  0xef);
        EXPECT(gbc.d(),  0xb2);
        EXPECT(gbc.e(),  0xf7);
        EXPECT(gbc.h(),  0x7a);
        EXPECT(gbc.l(),  0x1d);
        EXPECT(gbc.sp(), 0xc0d0);
        EXPECT(gbc.pc(), 0x4a0d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 01E1
        gbc.setState(0x4b9a, 0x2146, 0x9b70, 0xad0a, 0x5dcf, 0xa0a3, 0x1, 0x1);
        gbc.writeMem(0x4b9a, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x9b);
        EXPECT(gbc.b(),  0xad);
        EXPECT(gbc.c(),  0xa);
        EXPECT(gbc.d(),  0x5d);
        EXPECT(gbc.e(),  0xcf);
        EXPECT(gbc.h(),  0xa0);
        EXPECT(gbc.l(),  0xa3);
        EXPECT(gbc.sp(), 0x2146);
        EXPECT(gbc.pc(), 0x4b9b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 01E2
        gbc.setState(0x7b12, 0xbb2a, 0xe960, 0xd9e4, 0xadb, 0xf239, 0x0, 0x0);
        gbc.writeMem(0x7b12, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xe9);
        EXPECT(gbc.b(),  0xd9);
        EXPECT(gbc.c(),  0xe4);
        EXPECT(gbc.d(),  0xa);
        EXPECT(gbc.e(),  0xdb);
        EXPECT(gbc.h(),  0xf2);
        EXPECT(gbc.l(),  0x39);
        EXPECT(gbc.sp(), 0xbb2a);
        EXPECT(gbc.pc(), 0x7b13);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 01E3
        gbc.setState(0x520d, 0xa166, 0xd180, 0xe094, 0xf74f, 0xc848, 0x1, 0x1);
        gbc.writeMem(0x520d, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd1);
        EXPECT(gbc.b(),  0xe0);
        EXPECT(gbc.c(),  0x94);
        EXPECT(gbc.d(),  0xf7);
        EXPECT(gbc.e(),  0x4f);
        EXPECT(gbc.h(),  0xc8);
        EXPECT(gbc.l(),  0x48);
        EXPECT(gbc.sp(), 0xa166);
        EXPECT(gbc.pc(), 0x520e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 01E4
        gbc.setState(0x9521, 0xeaa5, 0x2680, 0x3bab, 0xe195, 0x1f23, 0x1, 0x1);
        gbc.writeMem(0x9521, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x26);
        EXPECT(gbc.b(),  0x3b);
        EXPECT(gbc.c(),  0xab);
        EXPECT(gbc.d(),  0xe1);
        EXPECT(gbc.e(),  0x95);
        EXPECT(gbc.h(),  0x1f);
        EXPECT(gbc.l(),  0x23);
        EXPECT(gbc.sp(), 0xeaa5);
        EXPECT(gbc.pc(), 0x9522);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9521), 0x5b);
        // 5B 01E5
        gbc.setState(0xdedc, 0xfbf9, 0xff30, 0x81eb, 0xa4c, 0xe353, 0x0, 0x1);
        gbc.writeMem(0xdedc, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xff);
        EXPECT(gbc.b(),  0x81);
        EXPECT(gbc.c(),  0xeb);
        EXPECT(gbc.d(),  0xa);
        EXPECT(gbc.e(),  0x4c);
        EXPECT(gbc.h(),  0xe3);
        EXPECT(gbc.l(),  0x53);
        EXPECT(gbc.sp(), 0xfbf9);
        EXPECT(gbc.pc(), 0xdedd);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xdedc), 0x5b);
        // 5B 01E6
        gbc.setState(0xc8aa, 0xf384, 0x8700, 0x2ef5, 0x681c, 0xfd76, 0x1, 0x0);
        gbc.writeMem(0xc8aa, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x87);
        EXPECT(gbc.b(),  0x2e);
        EXPECT(gbc.c(),  0xf5);
        EXPECT(gbc.d(),  0x68);
        EXPECT(gbc.e(),  0x1c);
        EXPECT(gbc.h(),  0xfd);
        EXPECT(gbc.l(),  0x76);
        EXPECT(gbc.sp(), 0xf384);
        EXPECT(gbc.pc(), 0xc8ab);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc8aa), 0x5b);
        // 5B 01E7
        gbc.setState(0x46c, 0x5211, 0x49c0, 0xe2fe, 0x5914, 0x3756, 0x1, 0x0);
        gbc.writeMem(0x46c, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x49);
        EXPECT(gbc.b(),  0xe2);
        EXPECT(gbc.c(),  0xfe);
        EXPECT(gbc.d(),  0x59);
        EXPECT(gbc.e(),  0x14);
        EXPECT(gbc.h(),  0x37);
        EXPECT(gbc.l(),  0x56);
        EXPECT(gbc.sp(), 0x5211);
        EXPECT(gbc.pc(), 0x46d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 01E8
        gbc.setState(0x296, 0xba36, 0xc550, 0xf2eb, 0x8e7, 0x7df9, 0x1, 0x1);
        gbc.writeMem(0x296, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xc5);
        EXPECT(gbc.b(),  0xf2);
        EXPECT(gbc.c(),  0xeb);
        EXPECT(gbc.d(),  0x8);
        EXPECT(gbc.e(),  0xe7);
        EXPECT(gbc.h(),  0x7d);
        EXPECT(gbc.l(),  0xf9);
        EXPECT(gbc.sp(), 0xba36);
        EXPECT(gbc.pc(), 0x297);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 01E9
        gbc.setState(0xc7d7, 0x9f01, 0x4c50, 0xc058, 0x1f53, 0xd21f, 0x1, 0x1);
        gbc.writeMem(0xc7d7, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x4c);
        EXPECT(gbc.b(),  0xc0);
        EXPECT(gbc.c(),  0x58);
        EXPECT(gbc.d(),  0x1f);
        EXPECT(gbc.e(),  0x53);
        EXPECT(gbc.h(),  0xd2);
        EXPECT(gbc.l(),  0x1f);
        EXPECT(gbc.sp(), 0x9f01);
        EXPECT(gbc.pc(), 0xc7d8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc7d7), 0x5b);
        // 5B 01EA
        gbc.setState(0xc232, 0x4514, 0x3dd0, 0x1f87, 0xf4c6, 0x133d, 0x0, 0x1);
        gbc.writeMem(0xc232, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x3d);
        EXPECT(gbc.b(),  0x1f);
        EXPECT(gbc.c(),  0x87);
        EXPECT(gbc.d(),  0xf4);
        EXPECT(gbc.e(),  0xc6);
        EXPECT(gbc.h(),  0x13);
        EXPECT(gbc.l(),  0x3d);
        EXPECT(gbc.sp(), 0x4514);
        EXPECT(gbc.pc(), 0xc233);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc232), 0x5b);
        // 5B 01EC
        gbc.setState(0x1406, 0x1379, 0x1ff0, 0xd0ab, 0x4f21, 0x13b6, 0x1, 0x0);
        gbc.writeMem(0x1406, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x1f);
        EXPECT(gbc.b(),  0xd0);
        EXPECT(gbc.c(),  0xab);
        EXPECT(gbc.d(),  0x4f);
        EXPECT(gbc.e(),  0x21);
        EXPECT(gbc.h(),  0x13);
        EXPECT(gbc.l(),  0xb6);
        EXPECT(gbc.sp(), 0x1379);
        EXPECT(gbc.pc(), 0x1407);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 01ED
        gbc.setState(0x9598, 0x55d4, 0x2540, 0x5d0a, 0x9ed5, 0xf454, 0x0, 0x1);
        gbc.writeMem(0x9598, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x25);
        EXPECT(gbc.b(),  0x5d);
        EXPECT(gbc.c(),  0xa);
        EXPECT(gbc.d(),  0x9e);
        EXPECT(gbc.e(),  0xd5);
        EXPECT(gbc.h(),  0xf4);
        EXPECT(gbc.l(),  0x54);
        EXPECT(gbc.sp(), 0x55d4);
        EXPECT(gbc.pc(), 0x9599);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9598), 0x5b);
        // 5B 01EE
        gbc.setState(0xf65, 0x399d, 0xa980, 0xab03, 0x41f8, 0x118a, 0x0, 0x0);
        gbc.writeMem(0xf65, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa9);
        EXPECT(gbc.b(),  0xab);
        EXPECT(gbc.c(),  0x3);
        EXPECT(gbc.d(),  0x41);
        EXPECT(gbc.e(),  0xf8);
        EXPECT(gbc.h(),  0x11);
        EXPECT(gbc.l(),  0x8a);
        EXPECT(gbc.sp(), 0x399d);
        EXPECT(gbc.pc(), 0xf66);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 01EF
        gbc.setState(0x5f93, 0x5305, 0xa690, 0x97d, 0xeb5a, 0x306e, 0x1, 0x0);
        gbc.writeMem(0x5f93, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa6);
        EXPECT(gbc.b(),  0x9);
        EXPECT(gbc.c(),  0x7d);
        EXPECT(gbc.d(),  0xeb);
        EXPECT(gbc.e(),  0x5a);
        EXPECT(gbc.h(),  0x30);
        EXPECT(gbc.l(),  0x6e);
        EXPECT(gbc.sp(), 0x5305);
        EXPECT(gbc.pc(), 0x5f94);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 01F0
        gbc.setState(0xe282, 0xa2e, 0x3a0, 0xd118, 0x3968, 0x39ce, 0x0, 0x1);
        gbc.writeMem(0xe282, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x3);
        EXPECT(gbc.b(),  0xd1);
        EXPECT(gbc.c(),  0x18);
        EXPECT(gbc.d(),  0x39);
        EXPECT(gbc.e(),  0x68);
        EXPECT(gbc.h(),  0x39);
        EXPECT(gbc.l(),  0xce);
        EXPECT(gbc.sp(), 0xa2e);
        EXPECT(gbc.pc(), 0xe283);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe282), 0x5b);
        // 5B 01F1
        gbc.setState(0xd7f4, 0x128e, 0x7a20, 0xbb51, 0x9923, 0x592, 0x0, 0x0);
        gbc.writeMem(0xd7f4, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x7a);
        EXPECT(gbc.b(),  0xbb);
        EXPECT(gbc.c(),  0x51);
        EXPECT(gbc.d(),  0x99);
        EXPECT(gbc.e(),  0x23);
        EXPECT(gbc.h(),  0x5);
        EXPECT(gbc.l(),  0x92);
        EXPECT(gbc.sp(), 0x128e);
        EXPECT(gbc.pc(), 0xd7f5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd7f4), 0x5b);
        // 5B 01F4
        gbc.setState(0xbc91, 0x69cd, 0x8e50, 0xd4ba, 0xac54, 0xa90a, 0x1, 0x0);
        gbc.writeMem(0xbc91, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x8e);
        EXPECT(gbc.b(),  0xd4);
        EXPECT(gbc.c(),  0xba);
        EXPECT(gbc.d(),  0xac);
        EXPECT(gbc.e(),  0x54);
        EXPECT(gbc.h(),  0xa9);
        EXPECT(gbc.l(),  0xa);
        EXPECT(gbc.sp(), 0x69cd);
        EXPECT(gbc.pc(), 0xbc92);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbc91), 0x5b);
        // 5B 01F5
        gbc.setState(0x2a8, 0x96ff, 0xa7b0, 0x3b8d, 0xcbaf, 0xe42c, 0x1, 0x1);
        gbc.writeMem(0x2a8, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa7);
        EXPECT(gbc.b(),  0x3b);
        EXPECT(gbc.c(),  0x8d);
        EXPECT(gbc.d(),  0xcb);
        EXPECT(gbc.e(),  0xaf);
        EXPECT(gbc.h(),  0xe4);
        EXPECT(gbc.l(),  0x2c);
        EXPECT(gbc.sp(), 0x96ff);
        EXPECT(gbc.pc(), 0x2a9);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 01F6
        gbc.setState(0xe2cd, 0x6d99, 0x5ce0, 0x7d72, 0xce65, 0x775, 0x0, 0x0);
        gbc.writeMem(0xe2cd, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x5c);
        EXPECT(gbc.b(),  0x7d);
        EXPECT(gbc.c(),  0x72);
        EXPECT(gbc.d(),  0xce);
        EXPECT(gbc.e(),  0x65);
        EXPECT(gbc.h(),  0x7);
        EXPECT(gbc.l(),  0x75);
        EXPECT(gbc.sp(), 0x6d99);
        EXPECT(gbc.pc(), 0xe2ce);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe2cd), 0x5b);
        // 5B 01F7
        gbc.setState(0x491b, 0x9a9c, 0x3170, 0x64bb, 0x8364, 0x6146, 0x0, 0x0);
        gbc.writeMem(0x491b, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x31);
        EXPECT(gbc.b(),  0x64);
        EXPECT(gbc.c(),  0xbb);
        EXPECT(gbc.d(),  0x83);
        EXPECT(gbc.e(),  0x64);
        EXPECT(gbc.h(),  0x61);
        EXPECT(gbc.l(),  0x46);
        EXPECT(gbc.sp(), 0x9a9c);
        EXPECT(gbc.pc(), 0x491c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 01F8
        gbc.setState(0xbb51, 0xd311, 0xcaf0, 0xb6cb, 0x1491, 0x20d, 0x0, 0x1);
        gbc.writeMem(0xbb51, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xca);
        EXPECT(gbc.b(),  0xb6);
        EXPECT(gbc.c(),  0xcb);
        EXPECT(gbc.d(),  0x14);
        EXPECT(gbc.e(),  0x91);
        EXPECT(gbc.h(),  0x2);
        EXPECT(gbc.l(),  0xd);
        EXPECT(gbc.sp(), 0xd311);
        EXPECT(gbc.pc(), 0xbb52);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbb51), 0x5b);
        // 5B 01FA
        gbc.setState(0x78cf, 0x8f7, 0xa850, 0x6f6, 0x7b03, 0xf945, 0x1, 0x1);
        gbc.writeMem(0x78cf, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa8);
        EXPECT(gbc.b(),  0x6);
        EXPECT(gbc.c(),  0xf6);
        EXPECT(gbc.d(),  0x7b);
        EXPECT(gbc.e(),  0x3);
        EXPECT(gbc.h(),  0xf9);
        EXPECT(gbc.l(),  0x45);
        EXPECT(gbc.sp(), 0x8f7);
        EXPECT(gbc.pc(), 0x78d0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 01FB
        gbc.setState(0x834, 0x584, 0x4650, 0x72db, 0xebe6, 0xd45a, 0x1, 0x0);
        gbc.writeMem(0x834, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x46);
        EXPECT(gbc.b(),  0x72);
        EXPECT(gbc.c(),  0xdb);
        EXPECT(gbc.d(),  0xeb);
        EXPECT(gbc.e(),  0xe6);
        EXPECT(gbc.h(),  0xd4);
        EXPECT(gbc.l(),  0x5a);
        EXPECT(gbc.sp(), 0x584);
        EXPECT(gbc.pc(), 0x835);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 01FC
        gbc.setState(0xb50c, 0xc98, 0x81b0, 0xb92c, 0x68c8, 0x8a8d, 0x1, 0x0);
        gbc.writeMem(0xb50c, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x81);
        EXPECT(gbc.b(),  0xb9);
        EXPECT(gbc.c(),  0x2c);
        EXPECT(gbc.d(),  0x68);
        EXPECT(gbc.e(),  0xc8);
        EXPECT(gbc.h(),  0x8a);
        EXPECT(gbc.l(),  0x8d);
        EXPECT(gbc.sp(), 0xc98);
        EXPECT(gbc.pc(), 0xb50d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb50c), 0x5b);
        // 5B 01FD
        gbc.setState(0x9096, 0x8a73, 0xa700, 0x5a84, 0x354f, 0x8522, 0x1, 0x0);
        gbc.writeMem(0x9096, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa7);
        EXPECT(gbc.b(),  0x5a);
        EXPECT(gbc.c(),  0x84);
        EXPECT(gbc.d(),  0x35);
        EXPECT(gbc.e(),  0x4f);
        EXPECT(gbc.h(),  0x85);
        EXPECT(gbc.l(),  0x22);
        EXPECT(gbc.sp(), 0x8a73);
        EXPECT(gbc.pc(), 0x9097);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9096), 0x5b);
        // 5B 0200
        gbc.setState(0xb61a, 0x213f, 0x6ec0, 0x5d30, 0xbe2d, 0xcf18, 0x0, 0x1);
        gbc.writeMem(0xb61a, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x6e);
        EXPECT(gbc.b(),  0x5d);
        EXPECT(gbc.c(),  0x30);
        EXPECT(gbc.d(),  0xbe);
        EXPECT(gbc.e(),  0x2d);
        EXPECT(gbc.h(),  0xcf);
        EXPECT(gbc.l(),  0x18);
        EXPECT(gbc.sp(), 0x213f);
        EXPECT(gbc.pc(), 0xb61b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb61a), 0x5b);
        // 5B 0201
        gbc.setState(0x2a21, 0x70b3, 0xba20, 0x387c, 0x5814, 0xba61, 0x1, 0x0);
        gbc.writeMem(0x2a21, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xba);
        EXPECT(gbc.b(),  0x38);
        EXPECT(gbc.c(),  0x7c);
        EXPECT(gbc.d(),  0x58);
        EXPECT(gbc.e(),  0x14);
        EXPECT(gbc.h(),  0xba);
        EXPECT(gbc.l(),  0x61);
        EXPECT(gbc.sp(), 0x70b3);
        EXPECT(gbc.pc(), 0x2a22);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0203
        gbc.setState(0x5b2a, 0xc06c, 0x7530, 0x7dae, 0x876d, 0x1f41, 0x1, 0x0);
        gbc.writeMem(0x5b2a, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x75);
        EXPECT(gbc.b(),  0x7d);
        EXPECT(gbc.c(),  0xae);
        EXPECT(gbc.d(),  0x87);
        EXPECT(gbc.e(),  0x6d);
        EXPECT(gbc.h(),  0x1f);
        EXPECT(gbc.l(),  0x41);
        EXPECT(gbc.sp(), 0xc06c);
        EXPECT(gbc.pc(), 0x5b2b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0204
        gbc.setState(0xc8c3, 0x6a4c, 0x9160, 0x30af, 0x7000, 0xf314, 0x0, 0x0);
        gbc.writeMem(0xc8c3, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x91);
        EXPECT(gbc.b(),  0x30);
        EXPECT(gbc.c(),  0xaf);
        EXPECT(gbc.d(),  0x70);
        EXPECT(gbc.e(),  0x0);
        EXPECT(gbc.h(),  0xf3);
        EXPECT(gbc.l(),  0x14);
        EXPECT(gbc.sp(), 0x6a4c);
        EXPECT(gbc.pc(), 0xc8c4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc8c3), 0x5b);
        // 5B 0205
        gbc.setState(0x357e, 0xbce4, 0x17e0, 0xfadd, 0x8948, 0xdcef, 0x1, 0x0);
        gbc.writeMem(0x357e, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x17);
        EXPECT(gbc.b(),  0xfa);
        EXPECT(gbc.c(),  0xdd);
        EXPECT(gbc.d(),  0x89);
        EXPECT(gbc.e(),  0x48);
        EXPECT(gbc.h(),  0xdc);
        EXPECT(gbc.l(),  0xef);
        EXPECT(gbc.sp(), 0xbce4);
        EXPECT(gbc.pc(), 0x357f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0206
        gbc.setState(0x4e00, 0xd635, 0x9b20, 0x1396, 0x5159, 0x78ae, 0x0, 0x1);
        gbc.writeMem(0x4e00, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x9b);
        EXPECT(gbc.b(),  0x13);
        EXPECT(gbc.c(),  0x96);
        EXPECT(gbc.d(),  0x51);
        EXPECT(gbc.e(),  0x59);
        EXPECT(gbc.h(),  0x78);
        EXPECT(gbc.l(),  0xae);
        EXPECT(gbc.sp(), 0xd635);
        EXPECT(gbc.pc(), 0x4e01);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0207
        gbc.setState(0x5ab6, 0x9f67, 0xeda0, 0x66b0, 0xfd41, 0x1781, 0x1, 0x0);
        gbc.writeMem(0x5ab6, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xed);
        EXPECT(gbc.b(),  0x66);
        EXPECT(gbc.c(),  0xb0);
        EXPECT(gbc.d(),  0xfd);
        EXPECT(gbc.e(),  0x41);
        EXPECT(gbc.h(),  0x17);
        EXPECT(gbc.l(),  0x81);
        EXPECT(gbc.sp(), 0x9f67);
        EXPECT(gbc.pc(), 0x5ab7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0208
        gbc.setState(0x5cce, 0xc396, 0x69c0, 0x9982, 0x9363, 0x288b, 0x0, 0x1);
        gbc.writeMem(0x5cce, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x69);
        EXPECT(gbc.b(),  0x99);
        EXPECT(gbc.c(),  0x82);
        EXPECT(gbc.d(),  0x93);
        EXPECT(gbc.e(),  0x63);
        EXPECT(gbc.h(),  0x28);
        EXPECT(gbc.l(),  0x8b);
        EXPECT(gbc.sp(), 0xc396);
        EXPECT(gbc.pc(), 0x5ccf);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0209
        gbc.setState(0x4e7a, 0x68e3, 0x19d0, 0xe382, 0x6def, 0x2079, 0x0, 0x0);
        gbc.writeMem(0x4e7a, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x19);
        EXPECT(gbc.b(),  0xe3);
        EXPECT(gbc.c(),  0x82);
        EXPECT(gbc.d(),  0x6d);
        EXPECT(gbc.e(),  0xef);
        EXPECT(gbc.h(),  0x20);
        EXPECT(gbc.l(),  0x79);
        EXPECT(gbc.sp(), 0x68e3);
        EXPECT(gbc.pc(), 0x4e7b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 020A
        gbc.setState(0xb0c7, 0xf412, 0xc090, 0xd722, 0x6467, 0x230b, 0x0, 0x0);
        gbc.writeMem(0xb0c7, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xc0);
        EXPECT(gbc.b(),  0xd7);
        EXPECT(gbc.c(),  0x22);
        EXPECT(gbc.d(),  0x64);
        EXPECT(gbc.e(),  0x67);
        EXPECT(gbc.h(),  0x23);
        EXPECT(gbc.l(),  0xb);
        EXPECT(gbc.sp(), 0xf412);
        EXPECT(gbc.pc(), 0xb0c8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb0c7), 0x5b);
        // 5B 020B
        gbc.setState(0xb527, 0xef8f, 0xf430, 0x8e23, 0xcaa5, 0x450c, 0x0, 0x0);
        gbc.writeMem(0xb527, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf4);
        EXPECT(gbc.b(),  0x8e);
        EXPECT(gbc.c(),  0x23);
        EXPECT(gbc.d(),  0xca);
        EXPECT(gbc.e(),  0xa5);
        EXPECT(gbc.h(),  0x45);
        EXPECT(gbc.l(),  0xc);
        EXPECT(gbc.sp(), 0xef8f);
        EXPECT(gbc.pc(), 0xb528);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb527), 0x5b);
        // 5B 020C
        gbc.setState(0x2bb, 0x9070, 0xd100, 0x225f, 0x27fc, 0x8b53, 0x0, 0x1);
        gbc.writeMem(0x2bb, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd1);
        EXPECT(gbc.b(),  0x22);
        EXPECT(gbc.c(),  0x5f);
        EXPECT(gbc.d(),  0x27);
        EXPECT(gbc.e(),  0xfc);
        EXPECT(gbc.h(),  0x8b);
        EXPECT(gbc.l(),  0x53);
        EXPECT(gbc.sp(), 0x9070);
        EXPECT(gbc.pc(), 0x2bc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 020D
        gbc.setState(0x77d0, 0x83c0, 0x8e30, 0x6ae3, 0x42c0, 0x39e9, 0x0, 0x1);
        gbc.writeMem(0x77d0, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x8e);
        EXPECT(gbc.b(),  0x6a);
        EXPECT(gbc.c(),  0xe3);
        EXPECT(gbc.d(),  0x42);
        EXPECT(gbc.e(),  0xc0);
        EXPECT(gbc.h(),  0x39);
        EXPECT(gbc.l(),  0xe9);
        EXPECT(gbc.sp(), 0x83c0);
        EXPECT(gbc.pc(), 0x77d1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 020E
        gbc.setState(0x7057, 0x77da, 0x2d30, 0xe83c, 0xa42b, 0xda6b, 0x1, 0x1);
        gbc.writeMem(0x7057, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x2d);
        EXPECT(gbc.b(),  0xe8);
        EXPECT(gbc.c(),  0x3c);
        EXPECT(gbc.d(),  0xa4);
        EXPECT(gbc.e(),  0x2b);
        EXPECT(gbc.h(),  0xda);
        EXPECT(gbc.l(),  0x6b);
        EXPECT(gbc.sp(), 0x77da);
        EXPECT(gbc.pc(), 0x7058);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 020F
        gbc.setState(0xe75e, 0x6eca, 0xa760, 0x314c, 0x2be, 0xf03d, 0x0, 0x0);
        gbc.writeMem(0xe75e, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa7);
        EXPECT(gbc.b(),  0x31);
        EXPECT(gbc.c(),  0x4c);
        EXPECT(gbc.d(),  0x2);
        EXPECT(gbc.e(),  0xbe);
        EXPECT(gbc.h(),  0xf0);
        EXPECT(gbc.l(),  0x3d);
        EXPECT(gbc.sp(), 0x6eca);
        EXPECT(gbc.pc(), 0xe75f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe75e), 0x5b);
        // 5B 0210
        gbc.setState(0x6f08, 0xe0da, 0x7980, 0xa2c1, 0xfb65, 0x395b, 0x0, 0x1);
        gbc.writeMem(0x6f08, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x79);
        EXPECT(gbc.b(),  0xa2);
        EXPECT(gbc.c(),  0xc1);
        EXPECT(gbc.d(),  0xfb);
        EXPECT(gbc.e(),  0x65);
        EXPECT(gbc.h(),  0x39);
        EXPECT(gbc.l(),  0x5b);
        EXPECT(gbc.sp(), 0xe0da);
        EXPECT(gbc.pc(), 0x6f09);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0211
        gbc.setState(0x46cc, 0x134a, 0xfb50, 0x47cc, 0xdbb4, 0x9a94, 0x0, 0x0);
        gbc.writeMem(0x46cc, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xfb);
        EXPECT(gbc.b(),  0x47);
        EXPECT(gbc.c(),  0xcc);
        EXPECT(gbc.d(),  0xdb);
        EXPECT(gbc.e(),  0xb4);
        EXPECT(gbc.h(),  0x9a);
        EXPECT(gbc.l(),  0x94);
        EXPECT(gbc.sp(), 0x134a);
        EXPECT(gbc.pc(), 0x46cd);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 0213
        gbc.setState(0x6efa, 0x2acb, 0xad0, 0x9cdb, 0x6c8, 0xc212, 0x0, 0x0);
        gbc.writeMem(0x6efa, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa);
        EXPECT(gbc.b(),  0x9c);
        EXPECT(gbc.c(),  0xdb);
        EXPECT(gbc.d(),  0x6);
        EXPECT(gbc.e(),  0xc8);
        EXPECT(gbc.h(),  0xc2);
        EXPECT(gbc.l(),  0x12);
        EXPECT(gbc.sp(), 0x2acb);
        EXPECT(gbc.pc(), 0x6efb);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 0214
        gbc.setState(0x6557, 0x91c7, 0x56e0, 0x5355, 0x37d0, 0xbdf6, 0x0, 0x1);
        gbc.writeMem(0x6557, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x56);
        EXPECT(gbc.b(),  0x53);
        EXPECT(gbc.c(),  0x55);
        EXPECT(gbc.d(),  0x37);
        EXPECT(gbc.e(),  0xd0);
        EXPECT(gbc.h(),  0xbd);
        EXPECT(gbc.l(),  0xf6);
        EXPECT(gbc.sp(), 0x91c7);
        EXPECT(gbc.pc(), 0x6558);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0215
        gbc.setState(0xbc2e, 0x3136, 0x5a0, 0x22ab, 0x85e3, 0xebd1, 0x1, 0x0);
        gbc.writeMem(0xbc2e, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x5);
        EXPECT(gbc.b(),  0x22);
        EXPECT(gbc.c(),  0xab);
        EXPECT(gbc.d(),  0x85);
        EXPECT(gbc.e(),  0xe3);
        EXPECT(gbc.h(),  0xeb);
        EXPECT(gbc.l(),  0xd1);
        EXPECT(gbc.sp(), 0x3136);
        EXPECT(gbc.pc(), 0xbc2f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbc2e), 0x5b);
        // 5B 0217
        gbc.setState(0xc2d6, 0xba3d, 0x9290, 0xd161, 0x4d2c, 0x269b, 0x0, 0x1);
        gbc.writeMem(0xc2d6, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x92);
        EXPECT(gbc.b(),  0xd1);
        EXPECT(gbc.c(),  0x61);
        EXPECT(gbc.d(),  0x4d);
        EXPECT(gbc.e(),  0x2c);
        EXPECT(gbc.h(),  0x26);
        EXPECT(gbc.l(),  0x9b);
        EXPECT(gbc.sp(), 0xba3d);
        EXPECT(gbc.pc(), 0xc2d7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc2d6), 0x5b);
        // 5B 0218
        gbc.setState(0xa62a, 0x73b, 0x90, 0x4993, 0xd211, 0xa112, 0x1, 0x0);
        gbc.writeMem(0xa62a, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x49);
        EXPECT(gbc.c(),  0x93);
        EXPECT(gbc.d(),  0xd2);
        EXPECT(gbc.e(),  0x11);
        EXPECT(gbc.h(),  0xa1);
        EXPECT(gbc.l(),  0x12);
        EXPECT(gbc.sp(), 0x73b);
        EXPECT(gbc.pc(), 0xa62b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa62a), 0x5b);
        // 5B 0219
        gbc.setState(0x9b29, 0x2188, 0xac70, 0x7807, 0x9d34, 0x874b, 0x0, 0x1);
        gbc.writeMem(0x9b29, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xac);
        EXPECT(gbc.b(),  0x78);
        EXPECT(gbc.c(),  0x7);
        EXPECT(gbc.d(),  0x9d);
        EXPECT(gbc.e(),  0x34);
        EXPECT(gbc.h(),  0x87);
        EXPECT(gbc.l(),  0x4b);
        EXPECT(gbc.sp(), 0x2188);
        EXPECT(gbc.pc(), 0x9b2a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9b29), 0x5b);
        // 5B 021A
        gbc.setState(0x4abc, 0xb2e7, 0xc340, 0x646b, 0xd4d3, 0x3084, 0x0, 0x1);
        gbc.writeMem(0x4abc, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xc3);
        EXPECT(gbc.b(),  0x64);
        EXPECT(gbc.c(),  0x6b);
        EXPECT(gbc.d(),  0xd4);
        EXPECT(gbc.e(),  0xd3);
        EXPECT(gbc.h(),  0x30);
        EXPECT(gbc.l(),  0x84);
        EXPECT(gbc.sp(), 0xb2e7);
        EXPECT(gbc.pc(), 0x4abd);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 021B
        gbc.setState(0x192e, 0x77b9, 0x4d90, 0x6cb4, 0x4497, 0xcf4b, 0x0, 0x0);
        gbc.writeMem(0x192e, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x4d);
        EXPECT(gbc.b(),  0x6c);
        EXPECT(gbc.c(),  0xb4);
        EXPECT(gbc.d(),  0x44);
        EXPECT(gbc.e(),  0x97);
        EXPECT(gbc.h(),  0xcf);
        EXPECT(gbc.l(),  0x4b);
        EXPECT(gbc.sp(), 0x77b9);
        EXPECT(gbc.pc(), 0x192f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 021C
        gbc.setState(0xcb60, 0x8af9, 0xb1e0, 0xf688, 0xb202, 0x99ca, 0x1, 0x0);
        gbc.writeMem(0xcb60, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xb1);
        EXPECT(gbc.b(),  0xf6);
        EXPECT(gbc.c(),  0x88);
        EXPECT(gbc.d(),  0xb2);
        EXPECT(gbc.e(),  0x2);
        EXPECT(gbc.h(),  0x99);
        EXPECT(gbc.l(),  0xca);
        EXPECT(gbc.sp(), 0x8af9);
        EXPECT(gbc.pc(), 0xcb61);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcb60), 0x5b);
        // 5B 021D
        gbc.setState(0x307d, 0x2da9, 0x41c0, 0xb486, 0x7290, 0xb020, 0x0, 0x1);
        gbc.writeMem(0x307d, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x41);
        EXPECT(gbc.b(),  0xb4);
        EXPECT(gbc.c(),  0x86);
        EXPECT(gbc.d(),  0x72);
        EXPECT(gbc.e(),  0x90);
        EXPECT(gbc.h(),  0xb0);
        EXPECT(gbc.l(),  0x20);
        EXPECT(gbc.sp(), 0x2da9);
        EXPECT(gbc.pc(), 0x307e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 021E
        gbc.setState(0x46a6, 0xef8e, 0xfe50, 0x2bb8, 0x3a80, 0x7a55, 0x1, 0x0);
        gbc.writeMem(0x46a6, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xfe);
        EXPECT(gbc.b(),  0x2b);
        EXPECT(gbc.c(),  0xb8);
        EXPECT(gbc.d(),  0x3a);
        EXPECT(gbc.e(),  0x80);
        EXPECT(gbc.h(),  0x7a);
        EXPECT(gbc.l(),  0x55);
        EXPECT(gbc.sp(), 0xef8e);
        EXPECT(gbc.pc(), 0x46a7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 021F
        gbc.setState(0xa50a, 0x993c, 0x8a60, 0xe8b4, 0x9a73, 0x2f37, 0x0, 0x0);
        gbc.writeMem(0xa50a, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x8a);
        EXPECT(gbc.b(),  0xe8);
        EXPECT(gbc.c(),  0xb4);
        EXPECT(gbc.d(),  0x9a);
        EXPECT(gbc.e(),  0x73);
        EXPECT(gbc.h(),  0x2f);
        EXPECT(gbc.l(),  0x37);
        EXPECT(gbc.sp(), 0x993c);
        EXPECT(gbc.pc(), 0xa50b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa50a), 0x5b);
        // 5B 0220
        gbc.setState(0x2f12, 0x392a, 0xddf0, 0x1634, 0xd564, 0x8a35, 0x0, 0x0);
        gbc.writeMem(0x2f12, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xdd);
        EXPECT(gbc.b(),  0x16);
        EXPECT(gbc.c(),  0x34);
        EXPECT(gbc.d(),  0xd5);
        EXPECT(gbc.e(),  0x64);
        EXPECT(gbc.h(),  0x8a);
        EXPECT(gbc.l(),  0x35);
        EXPECT(gbc.sp(), 0x392a);
        EXPECT(gbc.pc(), 0x2f13);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0221
        gbc.setState(0xee9f, 0x7337, 0x8d90, 0x118, 0x5d00, 0xe5d2, 0x1, 0x0);
        gbc.writeMem(0xee9f, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x8d);
        EXPECT(gbc.b(),  0x1);
        EXPECT(gbc.c(),  0x18);
        EXPECT(gbc.d(),  0x5d);
        EXPECT(gbc.e(),  0x0);
        EXPECT(gbc.h(),  0xe5);
        EXPECT(gbc.l(),  0xd2);
        EXPECT(gbc.sp(), 0x7337);
        EXPECT(gbc.pc(), 0xeea0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xee9f), 0x5b);
        // 5B 0223
        gbc.setState(0x140c, 0x8690, 0xae0, 0x7b45, 0xd43e, 0x17eb, 0x1, 0x1);
        gbc.writeMem(0x140c, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa);
        EXPECT(gbc.b(),  0x7b);
        EXPECT(gbc.c(),  0x45);
        EXPECT(gbc.d(),  0xd4);
        EXPECT(gbc.e(),  0x3e);
        EXPECT(gbc.h(),  0x17);
        EXPECT(gbc.l(),  0xeb);
        EXPECT(gbc.sp(), 0x8690);
        EXPECT(gbc.pc(), 0x140d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0224
        gbc.setState(0x3e9b, 0x58f9, 0x19d0, 0xcb40, 0xb927, 0x3b0d, 0x0, 0x0);
        gbc.writeMem(0x3e9b, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x19);
        EXPECT(gbc.b(),  0xcb);
        EXPECT(gbc.c(),  0x40);
        EXPECT(gbc.d(),  0xb9);
        EXPECT(gbc.e(),  0x27);
        EXPECT(gbc.h(),  0x3b);
        EXPECT(gbc.l(),  0xd);
        EXPECT(gbc.sp(), 0x58f9);
        EXPECT(gbc.pc(), 0x3e9c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 0225
        gbc.setState(0x5c55, 0x625f, 0xafe0, 0x54cb, 0x187d, 0x5ea, 0x0, 0x1);
        gbc.writeMem(0x5c55, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xaf);
        EXPECT(gbc.b(),  0x54);
        EXPECT(gbc.c(),  0xcb);
        EXPECT(gbc.d(),  0x18);
        EXPECT(gbc.e(),  0x7d);
        EXPECT(gbc.h(),  0x5);
        EXPECT(gbc.l(),  0xea);
        EXPECT(gbc.sp(), 0x625f);
        EXPECT(gbc.pc(), 0x5c56);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0226
        gbc.setState(0x9350, 0x7af1, 0x8bd0, 0xd6d6, 0x35d1, 0xdfb, 0x0, 0x0);
        gbc.writeMem(0x9350, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x8b);
        EXPECT(gbc.b(),  0xd6);
        EXPECT(gbc.c(),  0xd6);
        EXPECT(gbc.d(),  0x35);
        EXPECT(gbc.e(),  0xd1);
        EXPECT(gbc.h(),  0xd);
        EXPECT(gbc.l(),  0xfb);
        EXPECT(gbc.sp(), 0x7af1);
        EXPECT(gbc.pc(), 0x9351);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9350), 0x5b);
        // 5B 0227
        gbc.setState(0x8ca4, 0xecd4, 0x4290, 0x194c, 0xd962, 0x7f37, 0x0, 0x1);
        gbc.writeMem(0x8ca4, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x42);
        EXPECT(gbc.b(),  0x19);
        EXPECT(gbc.c(),  0x4c);
        EXPECT(gbc.d(),  0xd9);
        EXPECT(gbc.e(),  0x62);
        EXPECT(gbc.h(),  0x7f);
        EXPECT(gbc.l(),  0x37);
        EXPECT(gbc.sp(), 0xecd4);
        EXPECT(gbc.pc(), 0x8ca5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8ca4), 0x5b);
        // 5B 0228
        gbc.setState(0x6edc, 0xebb5, 0x7da0, 0x535e, 0xda7f, 0xe495, 0x1, 0x1);
        gbc.writeMem(0x6edc, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x7d);
        EXPECT(gbc.b(),  0x53);
        EXPECT(gbc.c(),  0x5e);
        EXPECT(gbc.d(),  0xda);
        EXPECT(gbc.e(),  0x7f);
        EXPECT(gbc.h(),  0xe4);
        EXPECT(gbc.l(),  0x95);
        EXPECT(gbc.sp(), 0xebb5);
        EXPECT(gbc.pc(), 0x6edd);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0229
        gbc.setState(0x7d44, 0x9172, 0x5590, 0x4cda, 0xb5d9, 0xea98, 0x1, 0x0);
        gbc.writeMem(0x7d44, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x55);
        EXPECT(gbc.b(),  0x4c);
        EXPECT(gbc.c(),  0xda);
        EXPECT(gbc.d(),  0xb5);
        EXPECT(gbc.e(),  0xd9);
        EXPECT(gbc.h(),  0xea);
        EXPECT(gbc.l(),  0x98);
        EXPECT(gbc.sp(), 0x9172);
        EXPECT(gbc.pc(), 0x7d45);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 022A
        gbc.setState(0xc76b, 0xe5d1, 0x3fb0, 0xd11e, 0x8d2f, 0xe492, 0x1, 0x1);
        gbc.writeMem(0xc76b, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x3f);
        EXPECT(gbc.b(),  0xd1);
        EXPECT(gbc.c(),  0x1e);
        EXPECT(gbc.d(),  0x8d);
        EXPECT(gbc.e(),  0x2f);
        EXPECT(gbc.h(),  0xe4);
        EXPECT(gbc.l(),  0x92);
        EXPECT(gbc.sp(), 0xe5d1);
        EXPECT(gbc.pc(), 0xc76c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc76b), 0x5b);
        // 5B 022B
        gbc.setState(0x7c6, 0x4c92, 0xe790, 0x530c, 0x6d36, 0xe994, 0x0, 0x0);
        gbc.writeMem(0x7c6, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xe7);
        EXPECT(gbc.b(),  0x53);
        EXPECT(gbc.c(),  0xc);
        EXPECT(gbc.d(),  0x6d);
        EXPECT(gbc.e(),  0x36);
        EXPECT(gbc.h(),  0xe9);
        EXPECT(gbc.l(),  0x94);
        EXPECT(gbc.sp(), 0x4c92);
        EXPECT(gbc.pc(), 0x7c7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 022C
        gbc.setState(0x7ec2, 0xcf75, 0x2690, 0x887, 0xb75f, 0x3bc8, 0x0, 0x0);
        gbc.writeMem(0x7ec2, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x26);
        EXPECT(gbc.b(),  0x8);
        EXPECT(gbc.c(),  0x87);
        EXPECT(gbc.d(),  0xb7);
        EXPECT(gbc.e(),  0x5f);
        EXPECT(gbc.h(),  0x3b);
        EXPECT(gbc.l(),  0xc8);
        EXPECT(gbc.sp(), 0xcf75);
        EXPECT(gbc.pc(), 0x7ec3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 022D
        gbc.setState(0x36e7, 0xa862, 0x1190, 0x9833, 0x6588, 0x43b3, 0x1, 0x1);
        gbc.writeMem(0x36e7, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x11);
        EXPECT(gbc.b(),  0x98);
        EXPECT(gbc.c(),  0x33);
        EXPECT(gbc.d(),  0x65);
        EXPECT(gbc.e(),  0x88);
        EXPECT(gbc.h(),  0x43);
        EXPECT(gbc.l(),  0xb3);
        EXPECT(gbc.sp(), 0xa862);
        EXPECT(gbc.pc(), 0x36e8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 022F
        gbc.setState(0xc5ca, 0x439b, 0xf2f0, 0x19b6, 0x3200, 0xe7b8, 0x0, 0x0);
        gbc.writeMem(0xc5ca, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf2);
        EXPECT(gbc.b(),  0x19);
        EXPECT(gbc.c(),  0xb6);
        EXPECT(gbc.d(),  0x32);
        EXPECT(gbc.e(),  0x0);
        EXPECT(gbc.h(),  0xe7);
        EXPECT(gbc.l(),  0xb8);
        EXPECT(gbc.sp(), 0x439b);
        EXPECT(gbc.pc(), 0xc5cb);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc5ca), 0x5b);
        // 5B 0230
        gbc.setState(0xc04d, 0xd63a, 0xa930, 0xa1b9, 0x9900, 0x3e0e, 0x0, 0x1);
        gbc.writeMem(0xc04d, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa9);
        EXPECT(gbc.b(),  0xa1);
        EXPECT(gbc.c(),  0xb9);
        EXPECT(gbc.d(),  0x99);
        EXPECT(gbc.e(),  0x0);
        EXPECT(gbc.h(),  0x3e);
        EXPECT(gbc.l(),  0xe);
        EXPECT(gbc.sp(), 0xd63a);
        EXPECT(gbc.pc(), 0xc04e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc04d), 0x5b);
        // 5B 0231
        gbc.setState(0x6d2e, 0xfd62, 0x6570, 0x52b7, 0x47d7, 0x7d89, 0x0, 0x0);
        gbc.writeMem(0x6d2e, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x65);
        EXPECT(gbc.b(),  0x52);
        EXPECT(gbc.c(),  0xb7);
        EXPECT(gbc.d(),  0x47);
        EXPECT(gbc.e(),  0xd7);
        EXPECT(gbc.h(),  0x7d);
        EXPECT(gbc.l(),  0x89);
        EXPECT(gbc.sp(), 0xfd62);
        EXPECT(gbc.pc(), 0x6d2f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0232
        gbc.setState(0xbe2e, 0xe273, 0xe630, 0x4889, 0x5e9b, 0x9ec8, 0x0, 0x1);
        gbc.writeMem(0xbe2e, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xe6);
        EXPECT(gbc.b(),  0x48);
        EXPECT(gbc.c(),  0x89);
        EXPECT(gbc.d(),  0x5e);
        EXPECT(gbc.e(),  0x9b);
        EXPECT(gbc.h(),  0x9e);
        EXPECT(gbc.l(),  0xc8);
        EXPECT(gbc.sp(), 0xe273);
        EXPECT(gbc.pc(), 0xbe2f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbe2e), 0x5b);
        // 5B 0233
        gbc.setState(0xde95, 0x91e6, 0x2470, 0xe2ec, 0x296b, 0x92fe, 0x0, 0x1);
        gbc.writeMem(0xde95, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x24);
        EXPECT(gbc.b(),  0xe2);
        EXPECT(gbc.c(),  0xec);
        EXPECT(gbc.d(),  0x29);
        EXPECT(gbc.e(),  0x6b);
        EXPECT(gbc.h(),  0x92);
        EXPECT(gbc.l(),  0xfe);
        EXPECT(gbc.sp(), 0x91e6);
        EXPECT(gbc.pc(), 0xde96);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xde95), 0x5b);
        // 5B 0234
        gbc.setState(0x371c, 0xb220, 0x79f0, 0x1263, 0xa4b0, 0xf841, 0x0, 0x0);
        gbc.writeMem(0x371c, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x79);
        EXPECT(gbc.b(),  0x12);
        EXPECT(gbc.c(),  0x63);
        EXPECT(gbc.d(),  0xa4);
        EXPECT(gbc.e(),  0xb0);
        EXPECT(gbc.h(),  0xf8);
        EXPECT(gbc.l(),  0x41);
        EXPECT(gbc.sp(), 0xb220);
        EXPECT(gbc.pc(), 0x371d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0235
        gbc.setState(0x1612, 0x47c3, 0x7050, 0x29ab, 0x2c0c, 0x54cb, 0x0, 0x1);
        gbc.writeMem(0x1612, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x70);
        EXPECT(gbc.b(),  0x29);
        EXPECT(gbc.c(),  0xab);
        EXPECT(gbc.d(),  0x2c);
        EXPECT(gbc.e(),  0xc);
        EXPECT(gbc.h(),  0x54);
        EXPECT(gbc.l(),  0xcb);
        EXPECT(gbc.sp(), 0x47c3);
        EXPECT(gbc.pc(), 0x1613);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 0237
        gbc.setState(0xc5bc, 0xb6c7, 0x94c0, 0xf0c2, 0xfd9f, 0x91ad, 0x1, 0x1);
        gbc.writeMem(0xc5bc, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x94);
        EXPECT(gbc.b(),  0xf0);
        EXPECT(gbc.c(),  0xc2);
        EXPECT(gbc.d(),  0xfd);
        EXPECT(gbc.e(),  0x9f);
        EXPECT(gbc.h(),  0x91);
        EXPECT(gbc.l(),  0xad);
        EXPECT(gbc.sp(), 0xb6c7);
        EXPECT(gbc.pc(), 0xc5bd);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc5bc), 0x5b);
        // 5B 0238
        gbc.setState(0x5110, 0x98e4, 0x2e50, 0xd764, 0x14ae, 0xfb21, 0x0, 0x0);
        gbc.writeMem(0x5110, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x2e);
        EXPECT(gbc.b(),  0xd7);
        EXPECT(gbc.c(),  0x64);
        EXPECT(gbc.d(),  0x14);
        EXPECT(gbc.e(),  0xae);
        EXPECT(gbc.h(),  0xfb);
        EXPECT(gbc.l(),  0x21);
        EXPECT(gbc.sp(), 0x98e4);
        EXPECT(gbc.pc(), 0x5111);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 0239
        gbc.setState(0x52f8, 0x885c, 0x47e0, 0x3b98, 0x6bb6, 0xc007, 0x0, 0x1);
        gbc.writeMem(0x52f8, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x47);
        EXPECT(gbc.b(),  0x3b);
        EXPECT(gbc.c(),  0x98);
        EXPECT(gbc.d(),  0x6b);
        EXPECT(gbc.e(),  0xb6);
        EXPECT(gbc.h(),  0xc0);
        EXPECT(gbc.l(),  0x7);
        EXPECT(gbc.sp(), 0x885c);
        EXPECT(gbc.pc(), 0x52f9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 023A
        gbc.setState(0x3511, 0x9b80, 0x5670, 0x511b, 0x1c45, 0x412e, 0x0, 0x0);
        gbc.writeMem(0x3511, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x56);
        EXPECT(gbc.b(),  0x51);
        EXPECT(gbc.c(),  0x1b);
        EXPECT(gbc.d(),  0x1c);
        EXPECT(gbc.e(),  0x45);
        EXPECT(gbc.h(),  0x41);
        EXPECT(gbc.l(),  0x2e);
        EXPECT(gbc.sp(), 0x9b80);
        EXPECT(gbc.pc(), 0x3512);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 023B
        gbc.setState(0xdafc, 0x3f32, 0x1c80, 0xda94, 0x1947, 0xd38, 0x0, 0x0);
        gbc.writeMem(0xdafc, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x1c);
        EXPECT(gbc.b(),  0xda);
        EXPECT(gbc.c(),  0x94);
        EXPECT(gbc.d(),  0x19);
        EXPECT(gbc.e(),  0x47);
        EXPECT(gbc.h(),  0xd);
        EXPECT(gbc.l(),  0x38);
        EXPECT(gbc.sp(), 0x3f32);
        EXPECT(gbc.pc(), 0xdafd);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdafc), 0x5b);
        // 5B 023C
        gbc.setState(0xc36d, 0xb3ff, 0x50f0, 0xea2, 0x2253, 0xecf8, 0x1, 0x1);
        gbc.writeMem(0xc36d, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x50);
        EXPECT(gbc.b(),  0xe);
        EXPECT(gbc.c(),  0xa2);
        EXPECT(gbc.d(),  0x22);
        EXPECT(gbc.e(),  0x53);
        EXPECT(gbc.h(),  0xec);
        EXPECT(gbc.l(),  0xf8);
        EXPECT(gbc.sp(), 0xb3ff);
        EXPECT(gbc.pc(), 0xc36e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc36d), 0x5b);
        // 5B 023D
        gbc.setState(0x7b19, 0x8910, 0xbcc0, 0xbe88, 0xc4cd, 0xab16, 0x1, 0x1);
        gbc.writeMem(0x7b19, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xbc);
        EXPECT(gbc.b(),  0xbe);
        EXPECT(gbc.c(),  0x88);
        EXPECT(gbc.d(),  0xc4);
        EXPECT(gbc.e(),  0xcd);
        EXPECT(gbc.h(),  0xab);
        EXPECT(gbc.l(),  0x16);
        EXPECT(gbc.sp(), 0x8910);
        EXPECT(gbc.pc(), 0x7b1a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 023E
        gbc.setState(0xebff, 0x4990, 0x8d70, 0xa614, 0xd6da, 0xc518, 0x0, 0x1);
        gbc.writeMem(0xebff, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x8d);
        EXPECT(gbc.b(),  0xa6);
        EXPECT(gbc.c(),  0x14);
        EXPECT(gbc.d(),  0xd6);
        EXPECT(gbc.e(),  0xda);
        EXPECT(gbc.h(),  0xc5);
        EXPECT(gbc.l(),  0x18);
        EXPECT(gbc.sp(), 0x4990);
        EXPECT(gbc.pc(), 0xec00);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xebff), 0x5b);
        // 5B 023F
        gbc.setState(0xb84a, 0x6f65, 0x85a0, 0xc2a, 0xf0f5, 0x956a, 0x1, 0x0);
        gbc.writeMem(0xb84a, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x85);
        EXPECT(gbc.b(),  0xc);
        EXPECT(gbc.c(),  0x2a);
        EXPECT(gbc.d(),  0xf0);
        EXPECT(gbc.e(),  0xf5);
        EXPECT(gbc.h(),  0x95);
        EXPECT(gbc.l(),  0x6a);
        EXPECT(gbc.sp(), 0x6f65);
        EXPECT(gbc.pc(), 0xb84b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb84a), 0x5b);
        // 5B 0240
        gbc.setState(0x6529, 0x2779, 0x4450, 0xcdae, 0xe198, 0x7962, 0x1, 0x1);
        gbc.writeMem(0x6529, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x44);
        EXPECT(gbc.b(),  0xcd);
        EXPECT(gbc.c(),  0xae);
        EXPECT(gbc.d(),  0xe1);
        EXPECT(gbc.e(),  0x98);
        EXPECT(gbc.h(),  0x79);
        EXPECT(gbc.l(),  0x62);
        EXPECT(gbc.sp(), 0x2779);
        EXPECT(gbc.pc(), 0x652a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 0241
        gbc.setState(0xe8dc, 0x6aa1, 0xa30, 0xef79, 0xcf2f, 0x29a8, 0x0, 0x0);
        gbc.writeMem(0xe8dc, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa);
        EXPECT(gbc.b(),  0xef);
        EXPECT(gbc.c(),  0x79);
        EXPECT(gbc.d(),  0xcf);
        EXPECT(gbc.e(),  0x2f);
        EXPECT(gbc.h(),  0x29);
        EXPECT(gbc.l(),  0xa8);
        EXPECT(gbc.sp(), 0x6aa1);
        EXPECT(gbc.pc(), 0xe8dd);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe8dc), 0x5b);
        // 5B 0242
        gbc.setState(0x2ec6, 0xda36, 0x6610, 0xd64d, 0xc284, 0x3209, 0x0, 0x1);
        gbc.writeMem(0x2ec6, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x66);
        EXPECT(gbc.b(),  0xd6);
        EXPECT(gbc.c(),  0x4d);
        EXPECT(gbc.d(),  0xc2);
        EXPECT(gbc.e(),  0x84);
        EXPECT(gbc.h(),  0x32);
        EXPECT(gbc.l(),  0x9);
        EXPECT(gbc.sp(), 0xda36);
        EXPECT(gbc.pc(), 0x2ec7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 0243
        gbc.setState(0x8473, 0x85f5, 0xf840, 0x51fd, 0x2836, 0x41fa, 0x0, 0x1);
        gbc.writeMem(0x8473, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf8);
        EXPECT(gbc.b(),  0x51);
        EXPECT(gbc.c(),  0xfd);
        EXPECT(gbc.d(),  0x28);
        EXPECT(gbc.e(),  0x36);
        EXPECT(gbc.h(),  0x41);
        EXPECT(gbc.l(),  0xfa);
        EXPECT(gbc.sp(), 0x85f5);
        EXPECT(gbc.pc(), 0x8474);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8473), 0x5b);
        // 5B 0245
        gbc.setState(0x272c, 0x4182, 0x3f20, 0xcb95, 0xff64, 0xd029, 0x1, 0x1);
        gbc.writeMem(0x272c, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x3f);
        EXPECT(gbc.b(),  0xcb);
        EXPECT(gbc.c(),  0x95);
        EXPECT(gbc.d(),  0xff);
        EXPECT(gbc.e(),  0x64);
        EXPECT(gbc.h(),  0xd0);
        EXPECT(gbc.l(),  0x29);
        EXPECT(gbc.sp(), 0x4182);
        EXPECT(gbc.pc(), 0x272d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0247
        gbc.setState(0x4349, 0x1f46, 0x1400, 0xf9cf, 0xb2f8, 0x2d9a, 0x1, 0x0);
        gbc.writeMem(0x4349, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x14);
        EXPECT(gbc.b(),  0xf9);
        EXPECT(gbc.c(),  0xcf);
        EXPECT(gbc.d(),  0xb2);
        EXPECT(gbc.e(),  0xf8);
        EXPECT(gbc.h(),  0x2d);
        EXPECT(gbc.l(),  0x9a);
        EXPECT(gbc.sp(), 0x1f46);
        EXPECT(gbc.pc(), 0x434a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0248
        gbc.setState(0xe895, 0x6a9b, 0x3580, 0x51ca, 0x9c35, 0xd1c9, 0x1, 0x0);
        gbc.writeMem(0xe895, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x35);
        EXPECT(gbc.b(),  0x51);
        EXPECT(gbc.c(),  0xca);
        EXPECT(gbc.d(),  0x9c);
        EXPECT(gbc.e(),  0x35);
        EXPECT(gbc.h(),  0xd1);
        EXPECT(gbc.l(),  0xc9);
        EXPECT(gbc.sp(), 0x6a9b);
        EXPECT(gbc.pc(), 0xe896);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe895), 0x5b);
        // 5B 0249
        gbc.setState(0xca1b, 0x48a2, 0x1fd0, 0x17b2, 0xfdc3, 0xb4f0, 0x1, 0x1);
        gbc.writeMem(0xca1b, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x1f);
        EXPECT(gbc.b(),  0x17);
        EXPECT(gbc.c(),  0xb2);
        EXPECT(gbc.d(),  0xfd);
        EXPECT(gbc.e(),  0xc3);
        EXPECT(gbc.h(),  0xb4);
        EXPECT(gbc.l(),  0xf0);
        EXPECT(gbc.sp(), 0x48a2);
        EXPECT(gbc.pc(), 0xca1c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xca1b), 0x5b);
        // 5B 024A
        gbc.setState(0x43d2, 0x1444, 0x9e50, 0xa5f9, 0x851e, 0x6666, 0x1, 0x0);
        gbc.writeMem(0x43d2, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x9e);
        EXPECT(gbc.b(),  0xa5);
        EXPECT(gbc.c(),  0xf9);
        EXPECT(gbc.d(),  0x85);
        EXPECT(gbc.e(),  0x1e);
        EXPECT(gbc.h(),  0x66);
        EXPECT(gbc.l(),  0x66);
        EXPECT(gbc.sp(), 0x1444);
        EXPECT(gbc.pc(), 0x43d3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 024B
        gbc.setState(0x261f, 0x67bf, 0x32e0, 0xee95, 0x57dd, 0x972e, 0x1, 0x0);
        gbc.writeMem(0x261f, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x32);
        EXPECT(gbc.b(),  0xee);
        EXPECT(gbc.c(),  0x95);
        EXPECT(gbc.d(),  0x57);
        EXPECT(gbc.e(),  0xdd);
        EXPECT(gbc.h(),  0x97);
        EXPECT(gbc.l(),  0x2e);
        EXPECT(gbc.sp(), 0x67bf);
        EXPECT(gbc.pc(), 0x2620);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 024D
        gbc.setState(0xacfc, 0x5f76, 0xf080, 0x7f6b, 0xa51b, 0xeed1, 0x0, 0x0);
        gbc.writeMem(0xacfc, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf0);
        EXPECT(gbc.b(),  0x7f);
        EXPECT(gbc.c(),  0x6b);
        EXPECT(gbc.d(),  0xa5);
        EXPECT(gbc.e(),  0x1b);
        EXPECT(gbc.h(),  0xee);
        EXPECT(gbc.l(),  0xd1);
        EXPECT(gbc.sp(), 0x5f76);
        EXPECT(gbc.pc(), 0xacfd);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xacfc), 0x5b);
        // 5B 024E
        gbc.setState(0x37c3, 0x5431, 0xd750, 0xb8f7, 0x8533, 0x439a, 0x0, 0x0);
        gbc.writeMem(0x37c3, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd7);
        EXPECT(gbc.b(),  0xb8);
        EXPECT(gbc.c(),  0xf7);
        EXPECT(gbc.d(),  0x85);
        EXPECT(gbc.e(),  0x33);
        EXPECT(gbc.h(),  0x43);
        EXPECT(gbc.l(),  0x9a);
        EXPECT(gbc.sp(), 0x5431);
        EXPECT(gbc.pc(), 0x37c4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 024F
        gbc.setState(0x7ed6, 0x9dde, 0xf080, 0x7d45, 0x442, 0xaa02, 0x1, 0x1);
        gbc.writeMem(0x7ed6, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf0);
        EXPECT(gbc.b(),  0x7d);
        EXPECT(gbc.c(),  0x45);
        EXPECT(gbc.d(),  0x4);
        EXPECT(gbc.e(),  0x42);
        EXPECT(gbc.h(),  0xaa);
        EXPECT(gbc.l(),  0x2);
        EXPECT(gbc.sp(), 0x9dde);
        EXPECT(gbc.pc(), 0x7ed7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0250
        gbc.setState(0xd618, 0x7ad6, 0x39b0, 0xf414, 0x8d7f, 0x4d36, 0x0, 0x0);
        gbc.writeMem(0xd618, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x39);
        EXPECT(gbc.b(),  0xf4);
        EXPECT(gbc.c(),  0x14);
        EXPECT(gbc.d(),  0x8d);
        EXPECT(gbc.e(),  0x7f);
        EXPECT(gbc.h(),  0x4d);
        EXPECT(gbc.l(),  0x36);
        EXPECT(gbc.sp(), 0x7ad6);
        EXPECT(gbc.pc(), 0xd619);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd618), 0x5b);
        // 5B 0251
        gbc.setState(0xd50b, 0xd31e, 0xda80, 0x335d, 0xfcd2, 0xc432, 0x1, 0x1);
        gbc.writeMem(0xd50b, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xda);
        EXPECT(gbc.b(),  0x33);
        EXPECT(gbc.c(),  0x5d);
        EXPECT(gbc.d(),  0xfc);
        EXPECT(gbc.e(),  0xd2);
        EXPECT(gbc.h(),  0xc4);
        EXPECT(gbc.l(),  0x32);
        EXPECT(gbc.sp(), 0xd31e);
        EXPECT(gbc.pc(), 0xd50c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd50b), 0x5b);
        // 5B 0252
        gbc.setState(0xeb9c, 0xc4af, 0x7ab0, 0xb86b, 0x31e9, 0xe4b6, 0x1, 0x1);
        gbc.writeMem(0xeb9c, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x7a);
        EXPECT(gbc.b(),  0xb8);
        EXPECT(gbc.c(),  0x6b);
        EXPECT(gbc.d(),  0x31);
        EXPECT(gbc.e(),  0xe9);
        EXPECT(gbc.h(),  0xe4);
        EXPECT(gbc.l(),  0xb6);
        EXPECT(gbc.sp(), 0xc4af);
        EXPECT(gbc.pc(), 0xeb9d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xeb9c), 0x5b);
        // 5B 0253
        gbc.setState(0xe826, 0x6b32, 0xfeb0, 0x5267, 0xbe9e, 0xa5cd, 0x1, 0x1);
        gbc.writeMem(0xe826, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xfe);
        EXPECT(gbc.b(),  0x52);
        EXPECT(gbc.c(),  0x67);
        EXPECT(gbc.d(),  0xbe);
        EXPECT(gbc.e(),  0x9e);
        EXPECT(gbc.h(),  0xa5);
        EXPECT(gbc.l(),  0xcd);
        EXPECT(gbc.sp(), 0x6b32);
        EXPECT(gbc.pc(), 0xe827);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe826), 0x5b);
        // 5B 0254
        gbc.setState(0x21a7, 0x9a70, 0xb3d0, 0xeb1c, 0x332f, 0xf6e6, 0x0, 0x1);
        gbc.writeMem(0x21a7, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xb3);
        EXPECT(gbc.b(),  0xeb);
        EXPECT(gbc.c(),  0x1c);
        EXPECT(gbc.d(),  0x33);
        EXPECT(gbc.e(),  0x2f);
        EXPECT(gbc.h(),  0xf6);
        EXPECT(gbc.l(),  0xe6);
        EXPECT(gbc.sp(), 0x9a70);
        EXPECT(gbc.pc(), 0x21a8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 0255
        gbc.setState(0x63d7, 0x1701, 0xbe30, 0xb318, 0xbe02, 0x21de, 0x1, 0x1);
        gbc.writeMem(0x63d7, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xbe);
        EXPECT(gbc.b(),  0xb3);
        EXPECT(gbc.c(),  0x18);
        EXPECT(gbc.d(),  0xbe);
        EXPECT(gbc.e(),  0x2);
        EXPECT(gbc.h(),  0x21);
        EXPECT(gbc.l(),  0xde);
        EXPECT(gbc.sp(), 0x1701);
        EXPECT(gbc.pc(), 0x63d8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0256
        gbc.setState(0xbe41, 0x12b, 0xd8d0, 0x6c2f, 0x736, 0x5b4c, 0x0, 0x0);
        gbc.writeMem(0xbe41, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd8);
        EXPECT(gbc.b(),  0x6c);
        EXPECT(gbc.c(),  0x2f);
        EXPECT(gbc.d(),  0x7);
        EXPECT(gbc.e(),  0x36);
        EXPECT(gbc.h(),  0x5b);
        EXPECT(gbc.l(),  0x4c);
        EXPECT(gbc.sp(), 0x12b);
        EXPECT(gbc.pc(), 0xbe42);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbe41), 0x5b);
        // 5B 0257
        gbc.setState(0x5b60, 0xf502, 0xd2e0, 0x3d63, 0x5d7c, 0x9e32, 0x1, 0x1);
        gbc.writeMem(0x5b60, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd2);
        EXPECT(gbc.b(),  0x3d);
        EXPECT(gbc.c(),  0x63);
        EXPECT(gbc.d(),  0x5d);
        EXPECT(gbc.e(),  0x7c);
        EXPECT(gbc.h(),  0x9e);
        EXPECT(gbc.l(),  0x32);
        EXPECT(gbc.sp(), 0xf502);
        EXPECT(gbc.pc(), 0x5b61);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0258
        gbc.setState(0xad27, 0x8882, 0x25b0, 0x6a2e, 0x34ff, 0x5323, 0x0, 0x0);
        gbc.writeMem(0xad27, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x25);
        EXPECT(gbc.b(),  0x6a);
        EXPECT(gbc.c(),  0x2e);
        EXPECT(gbc.d(),  0x34);
        EXPECT(gbc.e(),  0xff);
        EXPECT(gbc.h(),  0x53);
        EXPECT(gbc.l(),  0x23);
        EXPECT(gbc.sp(), 0x8882);
        EXPECT(gbc.pc(), 0xad28);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xad27), 0x5b);
        // 5B 0259
        gbc.setState(0x9264, 0xa067, 0x8d00, 0x3844, 0xa8b3, 0xf33d, 0x0, 0x0);
        gbc.writeMem(0x9264, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x8d);
        EXPECT(gbc.b(),  0x38);
        EXPECT(gbc.c(),  0x44);
        EXPECT(gbc.d(),  0xa8);
        EXPECT(gbc.e(),  0xb3);
        EXPECT(gbc.h(),  0xf3);
        EXPECT(gbc.l(),  0x3d);
        EXPECT(gbc.sp(), 0xa067);
        EXPECT(gbc.pc(), 0x9265);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9264), 0x5b);
        // 5B 025A
        gbc.setState(0x90f0, 0xfa8, 0xb670, 0x3c8, 0x4867, 0x633a, 0x1, 0x0);
        gbc.writeMem(0x90f0, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xb6);
        EXPECT(gbc.b(),  0x3);
        EXPECT(gbc.c(),  0xc8);
        EXPECT(gbc.d(),  0x48);
        EXPECT(gbc.e(),  0x67);
        EXPECT(gbc.h(),  0x63);
        EXPECT(gbc.l(),  0x3a);
        EXPECT(gbc.sp(), 0xfa8);
        EXPECT(gbc.pc(), 0x90f1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x90f0), 0x5b);
        // 5B 025B
        gbc.setState(0x53f8, 0x1f66, 0x8f00, 0x5ee2, 0xc0e3, 0x6950, 0x1, 0x1);
        gbc.writeMem(0x53f8, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x8f);
        EXPECT(gbc.b(),  0x5e);
        EXPECT(gbc.c(),  0xe2);
        EXPECT(gbc.d(),  0xc0);
        EXPECT(gbc.e(),  0xe3);
        EXPECT(gbc.h(),  0x69);
        EXPECT(gbc.l(),  0x50);
        EXPECT(gbc.sp(), 0x1f66);
        EXPECT(gbc.pc(), 0x53f9);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 025C
        gbc.setState(0x3024, 0xde66, 0x27b0, 0x1389, 0x5d04, 0xf3dc, 0x0, 0x1);
        gbc.writeMem(0x3024, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x27);
        EXPECT(gbc.b(),  0x13);
        EXPECT(gbc.c(),  0x89);
        EXPECT(gbc.d(),  0x5d);
        EXPECT(gbc.e(),  0x4);
        EXPECT(gbc.h(),  0xf3);
        EXPECT(gbc.l(),  0xdc);
        EXPECT(gbc.sp(), 0xde66);
        EXPECT(gbc.pc(), 0x3025);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 025D
        gbc.setState(0x1b30, 0xde78, 0xf430, 0x2be0, 0xf750, 0x3020, 0x0, 0x1);
        gbc.writeMem(0x1b30, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf4);
        EXPECT(gbc.b(),  0x2b);
        EXPECT(gbc.c(),  0xe0);
        EXPECT(gbc.d(),  0xf7);
        EXPECT(gbc.e(),  0x50);
        EXPECT(gbc.h(),  0x30);
        EXPECT(gbc.l(),  0x20);
        EXPECT(gbc.sp(), 0xde78);
        EXPECT(gbc.pc(), 0x1b31);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 025E
        gbc.setState(0x5485, 0xfa0c, 0x5dc0, 0x4301, 0x63af, 0x45a1, 0x1, 0x1);
        gbc.writeMem(0x5485, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x5d);
        EXPECT(gbc.b(),  0x43);
        EXPECT(gbc.c(),  0x1);
        EXPECT(gbc.d(),  0x63);
        EXPECT(gbc.e(),  0xaf);
        EXPECT(gbc.h(),  0x45);
        EXPECT(gbc.l(),  0xa1);
        EXPECT(gbc.sp(), 0xfa0c);
        EXPECT(gbc.pc(), 0x5486);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 025F
        gbc.setState(0x2a55, 0xdb4a, 0x6b00, 0x5db8, 0x1973, 0x10a8, 0x1, 0x1);
        gbc.writeMem(0x2a55, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x6b);
        EXPECT(gbc.b(),  0x5d);
        EXPECT(gbc.c(),  0xb8);
        EXPECT(gbc.d(),  0x19);
        EXPECT(gbc.e(),  0x73);
        EXPECT(gbc.h(),  0x10);
        EXPECT(gbc.l(),  0xa8);
        EXPECT(gbc.sp(), 0xdb4a);
        EXPECT(gbc.pc(), 0x2a56);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0260
        gbc.setState(0x5f6b, 0x5c28, 0x2290, 0xc95f, 0x10e4, 0x1371, 0x0, 0x1);
        gbc.writeMem(0x5f6b, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x22);
        EXPECT(gbc.b(),  0xc9);
        EXPECT(gbc.c(),  0x5f);
        EXPECT(gbc.d(),  0x10);
        EXPECT(gbc.e(),  0xe4);
        EXPECT(gbc.h(),  0x13);
        EXPECT(gbc.l(),  0x71);
        EXPECT(gbc.sp(), 0x5c28);
        EXPECT(gbc.pc(), 0x5f6c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 0261
        gbc.setState(0x4eef, 0x2c05, 0x84b0, 0x751c, 0x24b2, 0x1601, 0x1, 0x1);
        gbc.writeMem(0x4eef, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x84);
        EXPECT(gbc.b(),  0x75);
        EXPECT(gbc.c(),  0x1c);
        EXPECT(gbc.d(),  0x24);
        EXPECT(gbc.e(),  0xb2);
        EXPECT(gbc.h(),  0x16);
        EXPECT(gbc.l(),  0x1);
        EXPECT(gbc.sp(), 0x2c05);
        EXPECT(gbc.pc(), 0x4ef0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0262
        gbc.setState(0x2262, 0x8151, 0xe040, 0x8a79, 0x7ad0, 0xcd34, 0x1, 0x1);
        gbc.writeMem(0x2262, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xe0);
        EXPECT(gbc.b(),  0x8a);
        EXPECT(gbc.c(),  0x79);
        EXPECT(gbc.d(),  0x7a);
        EXPECT(gbc.e(),  0xd0);
        EXPECT(gbc.h(),  0xcd);
        EXPECT(gbc.l(),  0x34);
        EXPECT(gbc.sp(), 0x8151);
        EXPECT(gbc.pc(), 0x2263);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0263
        gbc.setState(0xbb40, 0xb98e, 0xf2b0, 0xe4e6, 0x6103, 0x3794, 0x0, 0x0);
        gbc.writeMem(0xbb40, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf2);
        EXPECT(gbc.b(),  0xe4);
        EXPECT(gbc.c(),  0xe6);
        EXPECT(gbc.d(),  0x61);
        EXPECT(gbc.e(),  0x3);
        EXPECT(gbc.h(),  0x37);
        EXPECT(gbc.l(),  0x94);
        EXPECT(gbc.sp(), 0xb98e);
        EXPECT(gbc.pc(), 0xbb41);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbb40), 0x5b);
        // 5B 0264
        gbc.setState(0x7aa1, 0x94d0, 0x7d50, 0xcc66, 0xbdc, 0x33f7, 0x1, 0x1);
        gbc.writeMem(0x7aa1, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x7d);
        EXPECT(gbc.b(),  0xcc);
        EXPECT(gbc.c(),  0x66);
        EXPECT(gbc.d(),  0xb);
        EXPECT(gbc.e(),  0xdc);
        EXPECT(gbc.h(),  0x33);
        EXPECT(gbc.l(),  0xf7);
        EXPECT(gbc.sp(), 0x94d0);
        EXPECT(gbc.pc(), 0x7aa2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 0265
        gbc.setState(0xdc5e, 0x8c41, 0x3ef0, 0xb290, 0xb0b3, 0x2396, 0x0, 0x0);
        gbc.writeMem(0xdc5e, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x3e);
        EXPECT(gbc.b(),  0xb2);
        EXPECT(gbc.c(),  0x90);
        EXPECT(gbc.d(),  0xb0);
        EXPECT(gbc.e(),  0xb3);
        EXPECT(gbc.h(),  0x23);
        EXPECT(gbc.l(),  0x96);
        EXPECT(gbc.sp(), 0x8c41);
        EXPECT(gbc.pc(), 0xdc5f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xdc5e), 0x5b);
        // 5B 0266
        gbc.setState(0x8761, 0x5299, 0x5020, 0x6991, 0x97b4, 0x74e8, 0x1, 0x0);
        gbc.writeMem(0x8761, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x50);
        EXPECT(gbc.b(),  0x69);
        EXPECT(gbc.c(),  0x91);
        EXPECT(gbc.d(),  0x97);
        EXPECT(gbc.e(),  0xb4);
        EXPECT(gbc.h(),  0x74);
        EXPECT(gbc.l(),  0xe8);
        EXPECT(gbc.sp(), 0x5299);
        EXPECT(gbc.pc(), 0x8762);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8761), 0x5b);
        // 5B 0267
        gbc.setState(0xad83, 0x1432, 0x2240, 0x4971, 0x5e49, 0x744b, 0x0, 0x1);
        gbc.writeMem(0xad83, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x22);
        EXPECT(gbc.b(),  0x49);
        EXPECT(gbc.c(),  0x71);
        EXPECT(gbc.d(),  0x5e);
        EXPECT(gbc.e(),  0x49);
        EXPECT(gbc.h(),  0x74);
        EXPECT(gbc.l(),  0x4b);
        EXPECT(gbc.sp(), 0x1432);
        EXPECT(gbc.pc(), 0xad84);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xad83), 0x5b);
        // 5B 0268
        gbc.setState(0xa93f, 0x6c57, 0x5210, 0x16d2, 0xcdba, 0x5d30, 0x0, 0x0);
        gbc.writeMem(0xa93f, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x52);
        EXPECT(gbc.b(),  0x16);
        EXPECT(gbc.c(),  0xd2);
        EXPECT(gbc.d(),  0xcd);
        EXPECT(gbc.e(),  0xba);
        EXPECT(gbc.h(),  0x5d);
        EXPECT(gbc.l(),  0x30);
        EXPECT(gbc.sp(), 0x6c57);
        EXPECT(gbc.pc(), 0xa940);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa93f), 0x5b);
        // 5B 0269
        gbc.setState(0x3825, 0xc321, 0xe9d0, 0xd51d, 0x1b8e, 0xc709, 0x0, 0x0);
        gbc.writeMem(0x3825, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xe9);
        EXPECT(gbc.b(),  0xd5);
        EXPECT(gbc.c(),  0x1d);
        EXPECT(gbc.d(),  0x1b);
        EXPECT(gbc.e(),  0x8e);
        EXPECT(gbc.h(),  0xc7);
        EXPECT(gbc.l(),  0x9);
        EXPECT(gbc.sp(), 0xc321);
        EXPECT(gbc.pc(), 0x3826);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 026A
        gbc.setState(0x8488, 0xddc8, 0xd890, 0xb9e, 0x196e, 0x75c2, 0x0, 0x0);
        gbc.writeMem(0x8488, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd8);
        EXPECT(gbc.b(),  0xb);
        EXPECT(gbc.c(),  0x9e);
        EXPECT(gbc.d(),  0x19);
        EXPECT(gbc.e(),  0x6e);
        EXPECT(gbc.h(),  0x75);
        EXPECT(gbc.l(),  0xc2);
        EXPECT(gbc.sp(), 0xddc8);
        EXPECT(gbc.pc(), 0x8489);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8488), 0x5b);
        // 5B 026B
        gbc.setState(0x86f6, 0x775, 0xd610, 0x8842, 0xcf96, 0xf939, 0x1, 0x0);
        gbc.writeMem(0x86f6, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd6);
        EXPECT(gbc.b(),  0x88);
        EXPECT(gbc.c(),  0x42);
        EXPECT(gbc.d(),  0xcf);
        EXPECT(gbc.e(),  0x96);
        EXPECT(gbc.h(),  0xf9);
        EXPECT(gbc.l(),  0x39);
        EXPECT(gbc.sp(), 0x775);
        EXPECT(gbc.pc(), 0x86f7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x86f6), 0x5b);
        // 5B 026C
        gbc.setState(0x68bc, 0x2bbe, 0x4df0, 0xe01b, 0x5347, 0x3e9f, 0x1, 0x0);
        gbc.writeMem(0x68bc, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x4d);
        EXPECT(gbc.b(),  0xe0);
        EXPECT(gbc.c(),  0x1b);
        EXPECT(gbc.d(),  0x53);
        EXPECT(gbc.e(),  0x47);
        EXPECT(gbc.h(),  0x3e);
        EXPECT(gbc.l(),  0x9f);
        EXPECT(gbc.sp(), 0x2bbe);
        EXPECT(gbc.pc(), 0x68bd);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 026D
        gbc.setState(0x65bd, 0xd065, 0xd5b0, 0x671b, 0xf17e, 0x5ce, 0x0, 0x1);
        gbc.writeMem(0x65bd, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd5);
        EXPECT(gbc.b(),  0x67);
        EXPECT(gbc.c(),  0x1b);
        EXPECT(gbc.d(),  0xf1);
        EXPECT(gbc.e(),  0x7e);
        EXPECT(gbc.h(),  0x5);
        EXPECT(gbc.l(),  0xce);
        EXPECT(gbc.sp(), 0xd065);
        EXPECT(gbc.pc(), 0x65be);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 026E
        gbc.setState(0x3d94, 0x6fa4, 0x2f70, 0x88db, 0x6609, 0x6a50, 0x0, 0x1);
        gbc.writeMem(0x3d94, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x2f);
        EXPECT(gbc.b(),  0x88);
        EXPECT(gbc.c(),  0xdb);
        EXPECT(gbc.d(),  0x66);
        EXPECT(gbc.e(),  0x9);
        EXPECT(gbc.h(),  0x6a);
        EXPECT(gbc.l(),  0x50);
        EXPECT(gbc.sp(), 0x6fa4);
        EXPECT(gbc.pc(), 0x3d95);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 026F
        gbc.setState(0x725c, 0x2245, 0xfc80, 0x139, 0x610a, 0x28b5, 0x0, 0x0);
        gbc.writeMem(0x725c, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xfc);
        EXPECT(gbc.b(),  0x1);
        EXPECT(gbc.c(),  0x39);
        EXPECT(gbc.d(),  0x61);
        EXPECT(gbc.e(),  0xa);
        EXPECT(gbc.h(),  0x28);
        EXPECT(gbc.l(),  0xb5);
        EXPECT(gbc.sp(), 0x2245);
        EXPECT(gbc.pc(), 0x725d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0270
        gbc.setState(0xa432, 0xe583, 0x3730, 0xc5f, 0xc26e, 0xe908, 0x1, 0x1);
        gbc.writeMem(0xa432, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x37);
        EXPECT(gbc.b(),  0xc);
        EXPECT(gbc.c(),  0x5f);
        EXPECT(gbc.d(),  0xc2);
        EXPECT(gbc.e(),  0x6e);
        EXPECT(gbc.h(),  0xe9);
        EXPECT(gbc.l(),  0x8);
        EXPECT(gbc.sp(), 0xe583);
        EXPECT(gbc.pc(), 0xa433);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa432), 0x5b);
        // 5B 0271
        gbc.setState(0xb525, 0x28a4, 0xdba0, 0x35c5, 0xd385, 0x6efd, 0x0, 0x0);
        gbc.writeMem(0xb525, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xdb);
        EXPECT(gbc.b(),  0x35);
        EXPECT(gbc.c(),  0xc5);
        EXPECT(gbc.d(),  0xd3);
        EXPECT(gbc.e(),  0x85);
        EXPECT(gbc.h(),  0x6e);
        EXPECT(gbc.l(),  0xfd);
        EXPECT(gbc.sp(), 0x28a4);
        EXPECT(gbc.pc(), 0xb526);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb525), 0x5b);
        // 5B 0272
        gbc.setState(0x9bd1, 0x8c26, 0x3270, 0x6efa, 0xf7f6, 0x20f7, 0x1, 0x0);
        gbc.writeMem(0x9bd1, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x32);
        EXPECT(gbc.b(),  0x6e);
        EXPECT(gbc.c(),  0xfa);
        EXPECT(gbc.d(),  0xf7);
        EXPECT(gbc.e(),  0xf6);
        EXPECT(gbc.h(),  0x20);
        EXPECT(gbc.l(),  0xf7);
        EXPECT(gbc.sp(), 0x8c26);
        EXPECT(gbc.pc(), 0x9bd2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9bd1), 0x5b);
        // 5B 0273
        gbc.setState(0x2bc1, 0x7b5e, 0x4040, 0x50fc, 0xb25d, 0x95c, 0x1, 0x1);
        gbc.writeMem(0x2bc1, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0x50);
        EXPECT(gbc.c(),  0xfc);
        EXPECT(gbc.d(),  0xb2);
        EXPECT(gbc.e(),  0x5d);
        EXPECT(gbc.h(),  0x9);
        EXPECT(gbc.l(),  0x5c);
        EXPECT(gbc.sp(), 0x7b5e);
        EXPECT(gbc.pc(), 0x2bc2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0274
        gbc.setState(0x8226, 0xe7de, 0xc130, 0xa20b, 0x5aae, 0xf968, 0x1, 0x1);
        gbc.writeMem(0x8226, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xc1);
        EXPECT(gbc.b(),  0xa2);
        EXPECT(gbc.c(),  0xb);
        EXPECT(gbc.d(),  0x5a);
        EXPECT(gbc.e(),  0xae);
        EXPECT(gbc.h(),  0xf9);
        EXPECT(gbc.l(),  0x68);
        EXPECT(gbc.sp(), 0xe7de);
        EXPECT(gbc.pc(), 0x8227);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8226), 0x5b);
        // 5B 0275
        gbc.setState(0xd6af, 0x114e, 0x17c0, 0x5048, 0x6098, 0x8abe, 0x0, 0x0);
        gbc.writeMem(0xd6af, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x17);
        EXPECT(gbc.b(),  0x50);
        EXPECT(gbc.c(),  0x48);
        EXPECT(gbc.d(),  0x60);
        EXPECT(gbc.e(),  0x98);
        EXPECT(gbc.h(),  0x8a);
        EXPECT(gbc.l(),  0xbe);
        EXPECT(gbc.sp(), 0x114e);
        EXPECT(gbc.pc(), 0xd6b0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd6af), 0x5b);
        // 5B 0276
        gbc.setState(0x45ad, 0xbba, 0x7760, 0x4516, 0xd6e2, 0x5dd9, 0x1, 0x0);
        gbc.writeMem(0x45ad, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x77);
        EXPECT(gbc.b(),  0x45);
        EXPECT(gbc.c(),  0x16);
        EXPECT(gbc.d(),  0xd6);
        EXPECT(gbc.e(),  0xe2);
        EXPECT(gbc.h(),  0x5d);
        EXPECT(gbc.l(),  0xd9);
        EXPECT(gbc.sp(), 0xbba);
        EXPECT(gbc.pc(), 0x45ae);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0277
        gbc.setState(0x2925, 0x573e, 0x8460, 0x3862, 0x660, 0x9822, 0x0, 0x0);
        gbc.writeMem(0x2925, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x84);
        EXPECT(gbc.b(),  0x38);
        EXPECT(gbc.c(),  0x62);
        EXPECT(gbc.d(),  0x6);
        EXPECT(gbc.e(),  0x60);
        EXPECT(gbc.h(),  0x98);
        EXPECT(gbc.l(),  0x22);
        EXPECT(gbc.sp(), 0x573e);
        EXPECT(gbc.pc(), 0x2926);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0278
        gbc.setState(0xe490, 0x75f0, 0x90c0, 0xd89c, 0x2296, 0x2879, 0x1, 0x0);
        gbc.writeMem(0xe490, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x90);
        EXPECT(gbc.b(),  0xd8);
        EXPECT(gbc.c(),  0x9c);
        EXPECT(gbc.d(),  0x22);
        EXPECT(gbc.e(),  0x96);
        EXPECT(gbc.h(),  0x28);
        EXPECT(gbc.l(),  0x79);
        EXPECT(gbc.sp(), 0x75f0);
        EXPECT(gbc.pc(), 0xe491);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe490), 0x5b);
        // 5B 0279
        gbc.setState(0x23be, 0x7cf8, 0x3a70, 0xdb8, 0xfafd, 0x96b0, 0x1, 0x1);
        gbc.writeMem(0x23be, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x3a);
        EXPECT(gbc.b(),  0xd);
        EXPECT(gbc.c(),  0xb8);
        EXPECT(gbc.d(),  0xfa);
        EXPECT(gbc.e(),  0xfd);
        EXPECT(gbc.h(),  0x96);
        EXPECT(gbc.l(),  0xb0);
        EXPECT(gbc.sp(), 0x7cf8);
        EXPECT(gbc.pc(), 0x23bf);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 027B
        gbc.setState(0xdba7, 0xe65c, 0x16f0, 0xe83f, 0xc7c9, 0x1bed, 0x1, 0x1);
        gbc.writeMem(0xdba7, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x16);
        EXPECT(gbc.b(),  0xe8);
        EXPECT(gbc.c(),  0x3f);
        EXPECT(gbc.d(),  0xc7);
        EXPECT(gbc.e(),  0xc9);
        EXPECT(gbc.h(),  0x1b);
        EXPECT(gbc.l(),  0xed);
        EXPECT(gbc.sp(), 0xe65c);
        EXPECT(gbc.pc(), 0xdba8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xdba7), 0x5b);
        // 5B 027D
        gbc.setState(0x1c47, 0x3403, 0xf980, 0xa586, 0x32d8, 0x3ce1, 0x0, 0x1);
        gbc.writeMem(0x1c47, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf9);
        EXPECT(gbc.b(),  0xa5);
        EXPECT(gbc.c(),  0x86);
        EXPECT(gbc.d(),  0x32);
        EXPECT(gbc.e(),  0xd8);
        EXPECT(gbc.h(),  0x3c);
        EXPECT(gbc.l(),  0xe1);
        EXPECT(gbc.sp(), 0x3403);
        EXPECT(gbc.pc(), 0x1c48);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 027E
        gbc.setState(0x69bb, 0x7b8f, 0xa680, 0x955f, 0x7d52, 0x5424, 0x0, 0x0);
        gbc.writeMem(0x69bb, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa6);
        EXPECT(gbc.b(),  0x95);
        EXPECT(gbc.c(),  0x5f);
        EXPECT(gbc.d(),  0x7d);
        EXPECT(gbc.e(),  0x52);
        EXPECT(gbc.h(),  0x54);
        EXPECT(gbc.l(),  0x24);
        EXPECT(gbc.sp(), 0x7b8f);
        EXPECT(gbc.pc(), 0x69bc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 027F
        gbc.setState(0x7311, 0x353b, 0x31b0, 0x6a88, 0x252, 0xf62a, 0x1, 0x1);
        gbc.writeMem(0x7311, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x31);
        EXPECT(gbc.b(),  0x6a);
        EXPECT(gbc.c(),  0x88);
        EXPECT(gbc.d(),  0x2);
        EXPECT(gbc.e(),  0x52);
        EXPECT(gbc.h(),  0xf6);
        EXPECT(gbc.l(),  0x2a);
        EXPECT(gbc.sp(), 0x353b);
        EXPECT(gbc.pc(), 0x7312);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0280
        gbc.setState(0x3eb8, 0xc328, 0x6dd0, 0x5b45, 0x3440, 0x5de1, 0x1, 0x0);
        gbc.writeMem(0x3eb8, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x6d);
        EXPECT(gbc.b(),  0x5b);
        EXPECT(gbc.c(),  0x45);
        EXPECT(gbc.d(),  0x34);
        EXPECT(gbc.e(),  0x40);
        EXPECT(gbc.h(),  0x5d);
        EXPECT(gbc.l(),  0xe1);
        EXPECT(gbc.sp(), 0xc328);
        EXPECT(gbc.pc(), 0x3eb9);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 0281
        gbc.setState(0x728a, 0x40ed, 0xcf0, 0x4045, 0x9f2, 0x2b0d, 0x1, 0x0);
        gbc.writeMem(0x728a, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xc);
        EXPECT(gbc.b(),  0x40);
        EXPECT(gbc.c(),  0x45);
        EXPECT(gbc.d(),  0x9);
        EXPECT(gbc.e(),  0xf2);
        EXPECT(gbc.h(),  0x2b);
        EXPECT(gbc.l(),  0xd);
        EXPECT(gbc.sp(), 0x40ed);
        EXPECT(gbc.pc(), 0x728b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0282
        gbc.setState(0xc978, 0x5d08, 0xa230, 0x86d9, 0x96d9, 0xafc3, 0x1, 0x0);
        gbc.writeMem(0xc978, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa2);
        EXPECT(gbc.b(),  0x86);
        EXPECT(gbc.c(),  0xd9);
        EXPECT(gbc.d(),  0x96);
        EXPECT(gbc.e(),  0xd9);
        EXPECT(gbc.h(),  0xaf);
        EXPECT(gbc.l(),  0xc3);
        EXPECT(gbc.sp(), 0x5d08);
        EXPECT(gbc.pc(), 0xc979);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc978), 0x5b);
        // 5B 0283
        gbc.setState(0x44cc, 0x2f67, 0x50c0, 0x5568, 0x355d, 0x317, 0x0, 0x0);
        gbc.writeMem(0x44cc, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x50);
        EXPECT(gbc.b(),  0x55);
        EXPECT(gbc.c(),  0x68);
        EXPECT(gbc.d(),  0x35);
        EXPECT(gbc.e(),  0x5d);
        EXPECT(gbc.h(),  0x3);
        EXPECT(gbc.l(),  0x17);
        EXPECT(gbc.sp(), 0x2f67);
        EXPECT(gbc.pc(), 0x44cd);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0284
        gbc.setState(0x9d43, 0x949a, 0x2570, 0x4f22, 0x4eec, 0x9283, 0x0, 0x0);
        gbc.writeMem(0x9d43, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x25);
        EXPECT(gbc.b(),  0x4f);
        EXPECT(gbc.c(),  0x22);
        EXPECT(gbc.d(),  0x4e);
        EXPECT(gbc.e(),  0xec);
        EXPECT(gbc.h(),  0x92);
        EXPECT(gbc.l(),  0x83);
        EXPECT(gbc.sp(), 0x949a);
        EXPECT(gbc.pc(), 0x9d44);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9d43), 0x5b);
        // 5B 0285
        gbc.setState(0x7913, 0x8e6, 0xb020, 0x5a67, 0x79e9, 0x38a6, 0x0, 0x0);
        gbc.writeMem(0x7913, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xb0);
        EXPECT(gbc.b(),  0x5a);
        EXPECT(gbc.c(),  0x67);
        EXPECT(gbc.d(),  0x79);
        EXPECT(gbc.e(),  0xe9);
        EXPECT(gbc.h(),  0x38);
        EXPECT(gbc.l(),  0xa6);
        EXPECT(gbc.sp(), 0x8e6);
        EXPECT(gbc.pc(), 0x7914);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0286
        gbc.setState(0x3d0c, 0x5700, 0xfee0, 0xbded, 0x26b7, 0x51dd, 0x1, 0x1);
        gbc.writeMem(0x3d0c, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xfe);
        EXPECT(gbc.b(),  0xbd);
        EXPECT(gbc.c(),  0xed);
        EXPECT(gbc.d(),  0x26);
        EXPECT(gbc.e(),  0xb7);
        EXPECT(gbc.h(),  0x51);
        EXPECT(gbc.l(),  0xdd);
        EXPECT(gbc.sp(), 0x5700);
        EXPECT(gbc.pc(), 0x3d0d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0288
        gbc.setState(0x377b, 0x3660, 0xdc0, 0x193f, 0xec0d, 0x56e4, 0x1, 0x0);
        gbc.writeMem(0x377b, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd);
        EXPECT(gbc.b(),  0x19);
        EXPECT(gbc.c(),  0x3f);
        EXPECT(gbc.d(),  0xec);
        EXPECT(gbc.e(),  0xd);
        EXPECT(gbc.h(),  0x56);
        EXPECT(gbc.l(),  0xe4);
        EXPECT(gbc.sp(), 0x3660);
        EXPECT(gbc.pc(), 0x377c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0289
        gbc.setState(0xc328, 0xd5dd, 0x2950, 0x9747, 0x51c1, 0xb830, 0x1, 0x1);
        gbc.writeMem(0xc328, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x29);
        EXPECT(gbc.b(),  0x97);
        EXPECT(gbc.c(),  0x47);
        EXPECT(gbc.d(),  0x51);
        EXPECT(gbc.e(),  0xc1);
        EXPECT(gbc.h(),  0xb8);
        EXPECT(gbc.l(),  0x30);
        EXPECT(gbc.sp(), 0xd5dd);
        EXPECT(gbc.pc(), 0xc329);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc328), 0x5b);
        // 5B 028A
        gbc.setState(0x7b45, 0xf5b1, 0xe8f0, 0x907e, 0x5624, 0x414e, 0x1, 0x1);
        gbc.writeMem(0x7b45, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xe8);
        EXPECT(gbc.b(),  0x90);
        EXPECT(gbc.c(),  0x7e);
        EXPECT(gbc.d(),  0x56);
        EXPECT(gbc.e(),  0x24);
        EXPECT(gbc.h(),  0x41);
        EXPECT(gbc.l(),  0x4e);
        EXPECT(gbc.sp(), 0xf5b1);
        EXPECT(gbc.pc(), 0x7b46);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 028B
        gbc.setState(0x49e4, 0x5928, 0xb390, 0x8b61, 0x95c3, 0x22f4, 0x1, 0x0);
        gbc.writeMem(0x49e4, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xb3);
        EXPECT(gbc.b(),  0x8b);
        EXPECT(gbc.c(),  0x61);
        EXPECT(gbc.d(),  0x95);
        EXPECT(gbc.e(),  0xc3);
        EXPECT(gbc.h(),  0x22);
        EXPECT(gbc.l(),  0xf4);
        EXPECT(gbc.sp(), 0x5928);
        EXPECT(gbc.pc(), 0x49e5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 028C
        gbc.setState(0x5a16, 0x7588, 0x8f00, 0x9bcc, 0x6f23, 0x1010, 0x0, 0x1);
        gbc.writeMem(0x5a16, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x8f);
        EXPECT(gbc.b(),  0x9b);
        EXPECT(gbc.c(),  0xcc);
        EXPECT(gbc.d(),  0x6f);
        EXPECT(gbc.e(),  0x23);
        EXPECT(gbc.h(),  0x10);
        EXPECT(gbc.l(),  0x10);
        EXPECT(gbc.sp(), 0x7588);
        EXPECT(gbc.pc(), 0x5a17);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 028D
        gbc.setState(0x6515, 0xf3f8, 0x6f30, 0xb6b4, 0x230, 0x4c02, 0x1, 0x0);
        gbc.writeMem(0x6515, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x6f);
        EXPECT(gbc.b(),  0xb6);
        EXPECT(gbc.c(),  0xb4);
        EXPECT(gbc.d(),  0x2);
        EXPECT(gbc.e(),  0x30);
        EXPECT(gbc.h(),  0x4c);
        EXPECT(gbc.l(),  0x2);
        EXPECT(gbc.sp(), 0xf3f8);
        EXPECT(gbc.pc(), 0x6516);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 028E
        gbc.setState(0x2949, 0x97a5, 0xa000, 0x56ee, 0xfe8d, 0x578, 0x0, 0x0);
        gbc.writeMem(0x2949, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa0);
        EXPECT(gbc.b(),  0x56);
        EXPECT(gbc.c(),  0xee);
        EXPECT(gbc.d(),  0xfe);
        EXPECT(gbc.e(),  0x8d);
        EXPECT(gbc.h(),  0x5);
        EXPECT(gbc.l(),  0x78);
        EXPECT(gbc.sp(), 0x97a5);
        EXPECT(gbc.pc(), 0x294a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 028F
        gbc.setState(0xd469, 0x8601, 0x20a0, 0xec76, 0x2ea9, 0x2e93, 0x0, 0x1);
        gbc.writeMem(0xd469, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0xec);
        EXPECT(gbc.c(),  0x76);
        EXPECT(gbc.d(),  0x2e);
        EXPECT(gbc.e(),  0xa9);
        EXPECT(gbc.h(),  0x2e);
        EXPECT(gbc.l(),  0x93);
        EXPECT(gbc.sp(), 0x8601);
        EXPECT(gbc.pc(), 0xd46a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd469), 0x5b);
        // 5B 0290
        gbc.setState(0x4483, 0x2a6c, 0x4a10, 0x5f10, 0x9e8f, 0x5d53, 0x0, 0x0);
        gbc.writeMem(0x4483, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x4a);
        EXPECT(gbc.b(),  0x5f);
        EXPECT(gbc.c(),  0x10);
        EXPECT(gbc.d(),  0x9e);
        EXPECT(gbc.e(),  0x8f);
        EXPECT(gbc.h(),  0x5d);
        EXPECT(gbc.l(),  0x53);
        EXPECT(gbc.sp(), 0x2a6c);
        EXPECT(gbc.pc(), 0x4484);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 0291
        gbc.setState(0x3a26, 0x2efa, 0x4b80, 0x9b16, 0x950b, 0x36ea, 0x0, 0x1);
        gbc.writeMem(0x3a26, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x4b);
        EXPECT(gbc.b(),  0x9b);
        EXPECT(gbc.c(),  0x16);
        EXPECT(gbc.d(),  0x95);
        EXPECT(gbc.e(),  0xb);
        EXPECT(gbc.h(),  0x36);
        EXPECT(gbc.l(),  0xea);
        EXPECT(gbc.sp(), 0x2efa);
        EXPECT(gbc.pc(), 0x3a27);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0292
        gbc.setState(0xc96d, 0xb70c, 0xcac0, 0x8d9, 0x33f1, 0x371d, 0x0, 0x0);
        gbc.writeMem(0xc96d, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xca);
        EXPECT(gbc.b(),  0x8);
        EXPECT(gbc.c(),  0xd9);
        EXPECT(gbc.d(),  0x33);
        EXPECT(gbc.e(),  0xf1);
        EXPECT(gbc.h(),  0x37);
        EXPECT(gbc.l(),  0x1d);
        EXPECT(gbc.sp(), 0xb70c);
        EXPECT(gbc.pc(), 0xc96e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc96d), 0x5b);
        // 5B 0293
        gbc.setState(0x8607, 0x1748, 0x4bd0, 0xe2d6, 0xbc5b, 0xa681, 0x0, 0x0);
        gbc.writeMem(0x8607, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x4b);
        EXPECT(gbc.b(),  0xe2);
        EXPECT(gbc.c(),  0xd6);
        EXPECT(gbc.d(),  0xbc);
        EXPECT(gbc.e(),  0x5b);
        EXPECT(gbc.h(),  0xa6);
        EXPECT(gbc.l(),  0x81);
        EXPECT(gbc.sp(), 0x1748);
        EXPECT(gbc.pc(), 0x8608);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8607), 0x5b);
        // 5B 0294
        gbc.setState(0xb675, 0x8941, 0x9140, 0xa68f, 0xd3ce, 0x716e, 0x1, 0x1);
        gbc.writeMem(0xb675, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x91);
        EXPECT(gbc.b(),  0xa6);
        EXPECT(gbc.c(),  0x8f);
        EXPECT(gbc.d(),  0xd3);
        EXPECT(gbc.e(),  0xce);
        EXPECT(gbc.h(),  0x71);
        EXPECT(gbc.l(),  0x6e);
        EXPECT(gbc.sp(), 0x8941);
        EXPECT(gbc.pc(), 0xb676);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb675), 0x5b);
        // 5B 0295
        gbc.setState(0xb9d, 0x94f7, 0x8e50, 0xcad1, 0x1d0e, 0x1495, 0x0, 0x0);
        gbc.writeMem(0xb9d, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x8e);
        EXPECT(gbc.b(),  0xca);
        EXPECT(gbc.c(),  0xd1);
        EXPECT(gbc.d(),  0x1d);
        EXPECT(gbc.e(),  0xe);
        EXPECT(gbc.h(),  0x14);
        EXPECT(gbc.l(),  0x95);
        EXPECT(gbc.sp(), 0x94f7);
        EXPECT(gbc.pc(), 0xb9e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 0296
        gbc.setState(0x5452, 0x14ef, 0x8720, 0xa827, 0xbfc1, 0x15b4, 0x0, 0x0);
        gbc.writeMem(0x5452, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x87);
        EXPECT(gbc.b(),  0xa8);
        EXPECT(gbc.c(),  0x27);
        EXPECT(gbc.d(),  0xbf);
        EXPECT(gbc.e(),  0xc1);
        EXPECT(gbc.h(),  0x15);
        EXPECT(gbc.l(),  0xb4);
        EXPECT(gbc.sp(), 0x14ef);
        EXPECT(gbc.pc(), 0x5453);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0297
        gbc.setState(0x3f52, 0x81c, 0x8560, 0xc246, 0x85c3, 0x5bdd, 0x0, 0x1);
        gbc.writeMem(0x3f52, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x85);
        EXPECT(gbc.b(),  0xc2);
        EXPECT(gbc.c(),  0x46);
        EXPECT(gbc.d(),  0x85);
        EXPECT(gbc.e(),  0xc3);
        EXPECT(gbc.h(),  0x5b);
        EXPECT(gbc.l(),  0xdd);
        EXPECT(gbc.sp(), 0x81c);
        EXPECT(gbc.pc(), 0x3f53);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0298
        gbc.setState(0x7921, 0xae6, 0x1040, 0x6402, 0x1f10, 0xbcea, 0x0, 0x1);
        gbc.writeMem(0x7921, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0x64);
        EXPECT(gbc.c(),  0x2);
        EXPECT(gbc.d(),  0x1f);
        EXPECT(gbc.e(),  0x10);
        EXPECT(gbc.h(),  0xbc);
        EXPECT(gbc.l(),  0xea);
        EXPECT(gbc.sp(), 0xae6);
        EXPECT(gbc.pc(), 0x7922);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0299
        gbc.setState(0x832f, 0xe80e, 0xc160, 0xc50, 0x6e1b, 0x7b5f, 0x1, 0x0);
        gbc.writeMem(0x832f, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xc1);
        EXPECT(gbc.b(),  0xc);
        EXPECT(gbc.c(),  0x50);
        EXPECT(gbc.d(),  0x6e);
        EXPECT(gbc.e(),  0x1b);
        EXPECT(gbc.h(),  0x7b);
        EXPECT(gbc.l(),  0x5f);
        EXPECT(gbc.sp(), 0xe80e);
        EXPECT(gbc.pc(), 0x8330);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x832f), 0x5b);
        // 5B 029A
        gbc.setState(0x188a, 0x97a5, 0x8e60, 0x56e9, 0xa97f, 0x855d, 0x0, 0x0);
        gbc.writeMem(0x188a, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x8e);
        EXPECT(gbc.b(),  0x56);
        EXPECT(gbc.c(),  0xe9);
        EXPECT(gbc.d(),  0xa9);
        EXPECT(gbc.e(),  0x7f);
        EXPECT(gbc.h(),  0x85);
        EXPECT(gbc.l(),  0x5d);
        EXPECT(gbc.sp(), 0x97a5);
        EXPECT(gbc.pc(), 0x188b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 029B
        gbc.setState(0xac50, 0xda61, 0xa230, 0xf01b, 0xc1c5, 0x8428, 0x0, 0x0);
        gbc.writeMem(0xac50, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa2);
        EXPECT(gbc.b(),  0xf0);
        EXPECT(gbc.c(),  0x1b);
        EXPECT(gbc.d(),  0xc1);
        EXPECT(gbc.e(),  0xc5);
        EXPECT(gbc.h(),  0x84);
        EXPECT(gbc.l(),  0x28);
        EXPECT(gbc.sp(), 0xda61);
        EXPECT(gbc.pc(), 0xac51);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xac50), 0x5b);
        // 5B 029C
        gbc.setState(0xc4cc, 0x29b4, 0x7f60, 0x74f4, 0x5396, 0xf482, 0x1, 0x1);
        gbc.writeMem(0xc4cc, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x7f);
        EXPECT(gbc.b(),  0x74);
        EXPECT(gbc.c(),  0xf4);
        EXPECT(gbc.d(),  0x53);
        EXPECT(gbc.e(),  0x96);
        EXPECT(gbc.h(),  0xf4);
        EXPECT(gbc.l(),  0x82);
        EXPECT(gbc.sp(), 0x29b4);
        EXPECT(gbc.pc(), 0xc4cd);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc4cc), 0x5b);
        // 5B 029D
        gbc.setState(0x3d69, 0xd007, 0x510, 0xa84e, 0x8c10, 0xa617, 0x1, 0x0);
        gbc.writeMem(0x3d69, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x5);
        EXPECT(gbc.b(),  0xa8);
        EXPECT(gbc.c(),  0x4e);
        EXPECT(gbc.d(),  0x8c);
        EXPECT(gbc.e(),  0x10);
        EXPECT(gbc.h(),  0xa6);
        EXPECT(gbc.l(),  0x17);
        EXPECT(gbc.sp(), 0xd007);
        EXPECT(gbc.pc(), 0x3d6a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 029E
        gbc.setState(0xa130, 0x1631, 0xdde0, 0xd069, 0x4e70, 0xd43a, 0x1, 0x1);
        gbc.writeMem(0xa130, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xdd);
        EXPECT(gbc.b(),  0xd0);
        EXPECT(gbc.c(),  0x69);
        EXPECT(gbc.d(),  0x4e);
        EXPECT(gbc.e(),  0x70);
        EXPECT(gbc.h(),  0xd4);
        EXPECT(gbc.l(),  0x3a);
        EXPECT(gbc.sp(), 0x1631);
        EXPECT(gbc.pc(), 0xa131);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa130), 0x5b);
        // 5B 029F
        gbc.setState(0x52f4, 0xf5e, 0xf840, 0xc275, 0x7c6e, 0x59d6, 0x0, 0x0);
        gbc.writeMem(0x52f4, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf8);
        EXPECT(gbc.b(),  0xc2);
        EXPECT(gbc.c(),  0x75);
        EXPECT(gbc.d(),  0x7c);
        EXPECT(gbc.e(),  0x6e);
        EXPECT(gbc.h(),  0x59);
        EXPECT(gbc.l(),  0xd6);
        EXPECT(gbc.sp(), 0xf5e);
        EXPECT(gbc.pc(), 0x52f5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 02A0
        gbc.setState(0xa152, 0xbe1e, 0xd050, 0xcae6, 0x2874, 0xbeb3, 0x0, 0x1);
        gbc.writeMem(0xa152, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd0);
        EXPECT(gbc.b(),  0xca);
        EXPECT(gbc.c(),  0xe6);
        EXPECT(gbc.d(),  0x28);
        EXPECT(gbc.e(),  0x74);
        EXPECT(gbc.h(),  0xbe);
        EXPECT(gbc.l(),  0xb3);
        EXPECT(gbc.sp(), 0xbe1e);
        EXPECT(gbc.pc(), 0xa153);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa152), 0x5b);
        // 5B 02A1
        gbc.setState(0x2979, 0x233c, 0x1f0, 0x7cc8, 0x312e, 0x5b2, 0x0, 0x0);
        gbc.writeMem(0x2979, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0x7c);
        EXPECT(gbc.c(),  0xc8);
        EXPECT(gbc.d(),  0x31);
        EXPECT(gbc.e(),  0x2e);
        EXPECT(gbc.h(),  0x5);
        EXPECT(gbc.l(),  0xb2);
        EXPECT(gbc.sp(), 0x233c);
        EXPECT(gbc.pc(), 0x297a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 02A2
        gbc.setState(0x82c1, 0xb69c, 0x6ae0, 0xcb86, 0x15dc, 0xe8a7, 0x1, 0x0);
        gbc.writeMem(0x82c1, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x6a);
        EXPECT(gbc.b(),  0xcb);
        EXPECT(gbc.c(),  0x86);
        EXPECT(gbc.d(),  0x15);
        EXPECT(gbc.e(),  0xdc);
        EXPECT(gbc.h(),  0xe8);
        EXPECT(gbc.l(),  0xa7);
        EXPECT(gbc.sp(), 0xb69c);
        EXPECT(gbc.pc(), 0x82c2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x82c1), 0x5b);
        // 5B 02A3
        gbc.setState(0xe5f7, 0x15fc, 0x6690, 0x4cab, 0x1f5f, 0x3939, 0x1, 0x0);
        gbc.writeMem(0xe5f7, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x66);
        EXPECT(gbc.b(),  0x4c);
        EXPECT(gbc.c(),  0xab);
        EXPECT(gbc.d(),  0x1f);
        EXPECT(gbc.e(),  0x5f);
        EXPECT(gbc.h(),  0x39);
        EXPECT(gbc.l(),  0x39);
        EXPECT(gbc.sp(), 0x15fc);
        EXPECT(gbc.pc(), 0xe5f8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe5f7), 0x5b);
        // 5B 02A4
        gbc.setState(0xc7a3, 0x50a9, 0xdc80, 0xd0aa, 0xdc7e, 0xa905, 0x0, 0x1);
        gbc.writeMem(0xc7a3, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xdc);
        EXPECT(gbc.b(),  0xd0);
        EXPECT(gbc.c(),  0xaa);
        EXPECT(gbc.d(),  0xdc);
        EXPECT(gbc.e(),  0x7e);
        EXPECT(gbc.h(),  0xa9);
        EXPECT(gbc.l(),  0x5);
        EXPECT(gbc.sp(), 0x50a9);
        EXPECT(gbc.pc(), 0xc7a4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc7a3), 0x5b);
        // 5B 02A6
        gbc.setState(0xbdc0, 0x416, 0x15a0, 0x724c, 0x41ed, 0xe3c0, 0x1, 0x0);
        gbc.writeMem(0xbdc0, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x15);
        EXPECT(gbc.b(),  0x72);
        EXPECT(gbc.c(),  0x4c);
        EXPECT(gbc.d(),  0x41);
        EXPECT(gbc.e(),  0xed);
        EXPECT(gbc.h(),  0xe3);
        EXPECT(gbc.l(),  0xc0);
        EXPECT(gbc.sp(), 0x416);
        EXPECT(gbc.pc(), 0xbdc1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbdc0), 0x5b);
        // 5B 02A7
        gbc.setState(0x37bd, 0x7f4e, 0x18d0, 0x8252, 0x209a, 0xc529, 0x1, 0x1);
        gbc.writeMem(0x37bd, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x18);
        EXPECT(gbc.b(),  0x82);
        EXPECT(gbc.c(),  0x52);
        EXPECT(gbc.d(),  0x20);
        EXPECT(gbc.e(),  0x9a);
        EXPECT(gbc.h(),  0xc5);
        EXPECT(gbc.l(),  0x29);
        EXPECT(gbc.sp(), 0x7f4e);
        EXPECT(gbc.pc(), 0x37be);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 02A8
        gbc.setState(0x7c3f, 0xa4f, 0x1140, 0xf6a4, 0x6dc, 0xfd14, 0x1, 0x0);
        gbc.writeMem(0x7c3f, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x11);
        EXPECT(gbc.b(),  0xf6);
        EXPECT(gbc.c(),  0xa4);
        EXPECT(gbc.d(),  0x6);
        EXPECT(gbc.e(),  0xdc);
        EXPECT(gbc.h(),  0xfd);
        EXPECT(gbc.l(),  0x14);
        EXPECT(gbc.sp(), 0xa4f);
        EXPECT(gbc.pc(), 0x7c40);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 02A9
        gbc.setState(0x349c, 0xaf79, 0xec20, 0x6976, 0x94cb, 0xdf53, 0x1, 0x1);
        gbc.writeMem(0x349c, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xec);
        EXPECT(gbc.b(),  0x69);
        EXPECT(gbc.c(),  0x76);
        EXPECT(gbc.d(),  0x94);
        EXPECT(gbc.e(),  0xcb);
        EXPECT(gbc.h(),  0xdf);
        EXPECT(gbc.l(),  0x53);
        EXPECT(gbc.sp(), 0xaf79);
        EXPECT(gbc.pc(), 0x349d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 02AB
        gbc.setState(0xe9ff, 0xa25f, 0x3d90, 0x5889, 0x6b8e, 0x8e26, 0x1, 0x1);
        gbc.writeMem(0xe9ff, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x3d);
        EXPECT(gbc.b(),  0x58);
        EXPECT(gbc.c(),  0x89);
        EXPECT(gbc.d(),  0x6b);
        EXPECT(gbc.e(),  0x8e);
        EXPECT(gbc.h(),  0x8e);
        EXPECT(gbc.l(),  0x26);
        EXPECT(gbc.sp(), 0xa25f);
        EXPECT(gbc.pc(), 0xea00);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe9ff), 0x5b);
        // 5B 02AD
        gbc.setState(0xbdf6, 0x44ba, 0xd8f0, 0x33a6, 0xc0f6, 0x7402, 0x1, 0x1);
        gbc.writeMem(0xbdf6, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd8);
        EXPECT(gbc.b(),  0x33);
        EXPECT(gbc.c(),  0xa6);
        EXPECT(gbc.d(),  0xc0);
        EXPECT(gbc.e(),  0xf6);
        EXPECT(gbc.h(),  0x74);
        EXPECT(gbc.l(),  0x2);
        EXPECT(gbc.sp(), 0x44ba);
        EXPECT(gbc.pc(), 0xbdf7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbdf6), 0x5b);
        // 5B 02AE
        gbc.setState(0x668, 0x6e35, 0x6810, 0xb2a3, 0xfdc, 0x250b, 0x0, 0x0);
        gbc.writeMem(0x668, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x68);
        EXPECT(gbc.b(),  0xb2);
        EXPECT(gbc.c(),  0xa3);
        EXPECT(gbc.d(),  0xf);
        EXPECT(gbc.e(),  0xdc);
        EXPECT(gbc.h(),  0x25);
        EXPECT(gbc.l(),  0xb);
        EXPECT(gbc.sp(), 0x6e35);
        EXPECT(gbc.pc(), 0x669);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 02B0
        gbc.setState(0x5871, 0x6683, 0x6620, 0x8265, 0xcf5, 0x8c66, 0x0, 0x0);
        gbc.writeMem(0x5871, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x66);
        EXPECT(gbc.b(),  0x82);
        EXPECT(gbc.c(),  0x65);
        EXPECT(gbc.d(),  0xc);
        EXPECT(gbc.e(),  0xf5);
        EXPECT(gbc.h(),  0x8c);
        EXPECT(gbc.l(),  0x66);
        EXPECT(gbc.sp(), 0x6683);
        EXPECT(gbc.pc(), 0x5872);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 02B1
        gbc.setState(0xaf98, 0x7b48, 0xd560, 0x8eb0, 0x4c1a, 0x3c51, 0x0, 0x1);
        gbc.writeMem(0xaf98, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd5);
        EXPECT(gbc.b(),  0x8e);
        EXPECT(gbc.c(),  0xb0);
        EXPECT(gbc.d(),  0x4c);
        EXPECT(gbc.e(),  0x1a);
        EXPECT(gbc.h(),  0x3c);
        EXPECT(gbc.l(),  0x51);
        EXPECT(gbc.sp(), 0x7b48);
        EXPECT(gbc.pc(), 0xaf99);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xaf98), 0x5b);
        // 5B 02B2
        gbc.setState(0xef73, 0xdda8, 0x2d20, 0x7cac, 0x3844, 0xbd80, 0x1, 0x1);
        gbc.writeMem(0xef73, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x2d);
        EXPECT(gbc.b(),  0x7c);
        EXPECT(gbc.c(),  0xac);
        EXPECT(gbc.d(),  0x38);
        EXPECT(gbc.e(),  0x44);
        EXPECT(gbc.h(),  0xbd);
        EXPECT(gbc.l(),  0x80);
        EXPECT(gbc.sp(), 0xdda8);
        EXPECT(gbc.pc(), 0xef74);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xef73), 0x5b);
        // 5B 02B3
        gbc.setState(0x2f6, 0xb0ae, 0xd2c0, 0xc7e9, 0xb6b, 0xc76d, 0x1, 0x0);
        gbc.writeMem(0x2f6, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd2);
        EXPECT(gbc.b(),  0xc7);
        EXPECT(gbc.c(),  0xe9);
        EXPECT(gbc.d(),  0xb);
        EXPECT(gbc.e(),  0x6b);
        EXPECT(gbc.h(),  0xc7);
        EXPECT(gbc.l(),  0x6d);
        EXPECT(gbc.sp(), 0xb0ae);
        EXPECT(gbc.pc(), 0x2f7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 02B4
        gbc.setState(0x2b93, 0x5c50, 0xee00, 0xb730, 0xee4f, 0x690, 0x0, 0x1);
        gbc.writeMem(0x2b93, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xee);
        EXPECT(gbc.b(),  0xb7);
        EXPECT(gbc.c(),  0x30);
        EXPECT(gbc.d(),  0xee);
        EXPECT(gbc.e(),  0x4f);
        EXPECT(gbc.h(),  0x6);
        EXPECT(gbc.l(),  0x90);
        EXPECT(gbc.sp(), 0x5c50);
        EXPECT(gbc.pc(), 0x2b94);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 02B5
        gbc.setState(0x434e, 0xe466, 0x5f50, 0x7896, 0x965, 0x98a3, 0x1, 0x0);
        gbc.writeMem(0x434e, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x5f);
        EXPECT(gbc.b(),  0x78);
        EXPECT(gbc.c(),  0x96);
        EXPECT(gbc.d(),  0x9);
        EXPECT(gbc.e(),  0x65);
        EXPECT(gbc.h(),  0x98);
        EXPECT(gbc.l(),  0xa3);
        EXPECT(gbc.sp(), 0xe466);
        EXPECT(gbc.pc(), 0x434f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 02B6
        gbc.setState(0x2774, 0xcb, 0xec50, 0x7592, 0x5a13, 0xaa32, 0x0, 0x1);
        gbc.writeMem(0x2774, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xec);
        EXPECT(gbc.b(),  0x75);
        EXPECT(gbc.c(),  0x92);
        EXPECT(gbc.d(),  0x5a);
        EXPECT(gbc.e(),  0x13);
        EXPECT(gbc.h(),  0xaa);
        EXPECT(gbc.l(),  0x32);
        EXPECT(gbc.sp(), 0xcb);
        EXPECT(gbc.pc(), 0x2775);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 02B7
        gbc.setState(0x76c0, 0x4c8f, 0xb710, 0x1b44, 0x2f66, 0x948c, 0x0, 0x1);
        gbc.writeMem(0x76c0, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xb7);
        EXPECT(gbc.b(),  0x1b);
        EXPECT(gbc.c(),  0x44);
        EXPECT(gbc.d(),  0x2f);
        EXPECT(gbc.e(),  0x66);
        EXPECT(gbc.h(),  0x94);
        EXPECT(gbc.l(),  0x8c);
        EXPECT(gbc.sp(), 0x4c8f);
        EXPECT(gbc.pc(), 0x76c1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 02B8
        gbc.setState(0xb014, 0x796, 0xf530, 0x4cb6, 0x2054, 0x1043, 0x0, 0x1);
        gbc.writeMem(0xb014, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf5);
        EXPECT(gbc.b(),  0x4c);
        EXPECT(gbc.c(),  0xb6);
        EXPECT(gbc.d(),  0x20);
        EXPECT(gbc.e(),  0x54);
        EXPECT(gbc.h(),  0x10);
        EXPECT(gbc.l(),  0x43);
        EXPECT(gbc.sp(), 0x796);
        EXPECT(gbc.pc(), 0xb015);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb014), 0x5b);
        // 5B 02B9
        gbc.setState(0x5ef4, 0x9050, 0x9510, 0x7fe1, 0x928e, 0xef3a, 0x0, 0x0);
        gbc.writeMem(0x5ef4, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x95);
        EXPECT(gbc.b(),  0x7f);
        EXPECT(gbc.c(),  0xe1);
        EXPECT(gbc.d(),  0x92);
        EXPECT(gbc.e(),  0x8e);
        EXPECT(gbc.h(),  0xef);
        EXPECT(gbc.l(),  0x3a);
        EXPECT(gbc.sp(), 0x9050);
        EXPECT(gbc.pc(), 0x5ef5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 02BA
        gbc.setState(0xb9f3, 0x287f, 0x6f0, 0xd58f, 0x27a, 0xa178, 0x0, 0x0);
        gbc.writeMem(0xb9f3, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x6);
        EXPECT(gbc.b(),  0xd5);
        EXPECT(gbc.c(),  0x8f);
        EXPECT(gbc.d(),  0x2);
        EXPECT(gbc.e(),  0x7a);
        EXPECT(gbc.h(),  0xa1);
        EXPECT(gbc.l(),  0x78);
        EXPECT(gbc.sp(), 0x287f);
        EXPECT(gbc.pc(), 0xb9f4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb9f3), 0x5b);
        // 5B 02BB
        gbc.setState(0xe987, 0x2e22, 0xf550, 0x4f8b, 0xeeff, 0x97cb, 0x1, 0x1);
        gbc.writeMem(0xe987, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf5);
        EXPECT(gbc.b(),  0x4f);
        EXPECT(gbc.c(),  0x8b);
        EXPECT(gbc.d(),  0xee);
        EXPECT(gbc.e(),  0xff);
        EXPECT(gbc.h(),  0x97);
        EXPECT(gbc.l(),  0xcb);
        EXPECT(gbc.sp(), 0x2e22);
        EXPECT(gbc.pc(), 0xe988);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe987), 0x5b);
        // 5B 02BC
        gbc.setState(0x611a, 0x990c, 0x26d0, 0x2996, 0x3663, 0x6de7, 0x0, 0x1);
        gbc.writeMem(0x611a, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x26);
        EXPECT(gbc.b(),  0x29);
        EXPECT(gbc.c(),  0x96);
        EXPECT(gbc.d(),  0x36);
        EXPECT(gbc.e(),  0x63);
        EXPECT(gbc.h(),  0x6d);
        EXPECT(gbc.l(),  0xe7);
        EXPECT(gbc.sp(), 0x990c);
        EXPECT(gbc.pc(), 0x611b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 02BD
        gbc.setState(0xb5ed, 0x691d, 0x2dc0, 0x97f1, 0x553c, 0x1ab0, 0x0, 0x0);
        gbc.writeMem(0xb5ed, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x2d);
        EXPECT(gbc.b(),  0x97);
        EXPECT(gbc.c(),  0xf1);
        EXPECT(gbc.d(),  0x55);
        EXPECT(gbc.e(),  0x3c);
        EXPECT(gbc.h(),  0x1a);
        EXPECT(gbc.l(),  0xb0);
        EXPECT(gbc.sp(), 0x691d);
        EXPECT(gbc.pc(), 0xb5ee);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb5ed), 0x5b);
        // 5B 02BF
        gbc.setState(0x641e, 0x6428, 0xe770, 0x77ee, 0x9388, 0x5a95, 0x1, 0x0);
        gbc.writeMem(0x641e, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xe7);
        EXPECT(gbc.b(),  0x77);
        EXPECT(gbc.c(),  0xee);
        EXPECT(gbc.d(),  0x93);
        EXPECT(gbc.e(),  0x88);
        EXPECT(gbc.h(),  0x5a);
        EXPECT(gbc.l(),  0x95);
        EXPECT(gbc.sp(), 0x6428);
        EXPECT(gbc.pc(), 0x641f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 02C0
        gbc.setState(0xb672, 0x78b2, 0x2ac0, 0xd44c, 0x7561, 0xafd, 0x1, 0x0);
        gbc.writeMem(0xb672, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x2a);
        EXPECT(gbc.b(),  0xd4);
        EXPECT(gbc.c(),  0x4c);
        EXPECT(gbc.d(),  0x75);
        EXPECT(gbc.e(),  0x61);
        EXPECT(gbc.h(),  0xa);
        EXPECT(gbc.l(),  0xfd);
        EXPECT(gbc.sp(), 0x78b2);
        EXPECT(gbc.pc(), 0xb673);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb672), 0x5b);
        // 5B 02C1
        gbc.setState(0x406, 0x5204, 0xfd10, 0x3e49, 0xf9dc, 0x6c96, 0x1, 0x0);
        gbc.writeMem(0x406, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xfd);
        EXPECT(gbc.b(),  0x3e);
        EXPECT(gbc.c(),  0x49);
        EXPECT(gbc.d(),  0xf9);
        EXPECT(gbc.e(),  0xdc);
        EXPECT(gbc.h(),  0x6c);
        EXPECT(gbc.l(),  0x96);
        EXPECT(gbc.sp(), 0x5204);
        EXPECT(gbc.pc(), 0x407);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 02C2
        gbc.setState(0xd8d3, 0x9712, 0xb1e0, 0x5fa1, 0x905e, 0x8a50, 0x0, 0x0);
        gbc.writeMem(0xd8d3, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xb1);
        EXPECT(gbc.b(),  0x5f);
        EXPECT(gbc.c(),  0xa1);
        EXPECT(gbc.d(),  0x90);
        EXPECT(gbc.e(),  0x5e);
        EXPECT(gbc.h(),  0x8a);
        EXPECT(gbc.l(),  0x50);
        EXPECT(gbc.sp(), 0x9712);
        EXPECT(gbc.pc(), 0xd8d4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd8d3), 0x5b);
        // 5B 02C3
        gbc.setState(0xeff2, 0xb8ac, 0x81f0, 0x5858, 0x5f6a, 0xa5c9, 0x0, 0x0);
        gbc.writeMem(0xeff2, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x81);
        EXPECT(gbc.b(),  0x58);
        EXPECT(gbc.c(),  0x58);
        EXPECT(gbc.d(),  0x5f);
        EXPECT(gbc.e(),  0x6a);
        EXPECT(gbc.h(),  0xa5);
        EXPECT(gbc.l(),  0xc9);
        EXPECT(gbc.sp(), 0xb8ac);
        EXPECT(gbc.pc(), 0xeff3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xeff2), 0x5b);
        // 5B 02C4
        gbc.setState(0x8f80, 0x6bd3, 0x3390, 0x9f42, 0xd835, 0x7213, 0x1, 0x1);
        gbc.writeMem(0x8f80, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x33);
        EXPECT(gbc.b(),  0x9f);
        EXPECT(gbc.c(),  0x42);
        EXPECT(gbc.d(),  0xd8);
        EXPECT(gbc.e(),  0x35);
        EXPECT(gbc.h(),  0x72);
        EXPECT(gbc.l(),  0x13);
        EXPECT(gbc.sp(), 0x6bd3);
        EXPECT(gbc.pc(), 0x8f81);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8f80), 0x5b);
        // 5B 02C5
        gbc.setState(0x9b0a, 0xb27d, 0xcf00, 0xcec1, 0x1a04, 0x174e, 0x1, 0x0);
        gbc.writeMem(0x9b0a, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xcf);
        EXPECT(gbc.b(),  0xce);
        EXPECT(gbc.c(),  0xc1);
        EXPECT(gbc.d(),  0x1a);
        EXPECT(gbc.e(),  0x4);
        EXPECT(gbc.h(),  0x17);
        EXPECT(gbc.l(),  0x4e);
        EXPECT(gbc.sp(), 0xb27d);
        EXPECT(gbc.pc(), 0x9b0b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9b0a), 0x5b);
        // 5B 02C6
        gbc.setState(0x1656, 0x8ac2, 0x6120, 0xe86a, 0x8605, 0xebff, 0x0, 0x0);
        gbc.writeMem(0x1656, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x61);
        EXPECT(gbc.b(),  0xe8);
        EXPECT(gbc.c(),  0x6a);
        EXPECT(gbc.d(),  0x86);
        EXPECT(gbc.e(),  0x5);
        EXPECT(gbc.h(),  0xeb);
        EXPECT(gbc.l(),  0xff);
        EXPECT(gbc.sp(), 0x8ac2);
        EXPECT(gbc.pc(), 0x1657);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 02C8
        gbc.setState(0x340a, 0xf22, 0x9730, 0x7131, 0x6390, 0x2b3c, 0x1, 0x1);
        gbc.writeMem(0x340a, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x97);
        EXPECT(gbc.b(),  0x71);
        EXPECT(gbc.c(),  0x31);
        EXPECT(gbc.d(),  0x63);
        EXPECT(gbc.e(),  0x90);
        EXPECT(gbc.h(),  0x2b);
        EXPECT(gbc.l(),  0x3c);
        EXPECT(gbc.sp(), 0xf22);
        EXPECT(gbc.pc(), 0x340b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 02C9
        gbc.setState(0x96e2, 0x17fe, 0xb4c0, 0x7bf0, 0xabc4, 0x7da0, 0x0, 0x1);
        gbc.writeMem(0x96e2, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xb4);
        EXPECT(gbc.b(),  0x7b);
        EXPECT(gbc.c(),  0xf0);
        EXPECT(gbc.d(),  0xab);
        EXPECT(gbc.e(),  0xc4);
        EXPECT(gbc.h(),  0x7d);
        EXPECT(gbc.l(),  0xa0);
        EXPECT(gbc.sp(), 0x17fe);
        EXPECT(gbc.pc(), 0x96e3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x96e2), 0x5b);
        // 5B 02CA
        gbc.setState(0xede8, 0xbf30, 0x2280, 0xa7f1, 0xcada, 0x5982, 0x1, 0x0);
        gbc.writeMem(0xede8, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x22);
        EXPECT(gbc.b(),  0xa7);
        EXPECT(gbc.c(),  0xf1);
        EXPECT(gbc.d(),  0xca);
        EXPECT(gbc.e(),  0xda);
        EXPECT(gbc.h(),  0x59);
        EXPECT(gbc.l(),  0x82);
        EXPECT(gbc.sp(), 0xbf30);
        EXPECT(gbc.pc(), 0xede9);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xede8), 0x5b);
        // 5B 02CB
        gbc.setState(0xb411, 0x1007, 0xc7b0, 0x1d56, 0xee73, 0x76bc, 0x1, 0x0);
        gbc.writeMem(0xb411, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xc7);
        EXPECT(gbc.b(),  0x1d);
        EXPECT(gbc.c(),  0x56);
        EXPECT(gbc.d(),  0xee);
        EXPECT(gbc.e(),  0x73);
        EXPECT(gbc.h(),  0x76);
        EXPECT(gbc.l(),  0xbc);
        EXPECT(gbc.sp(), 0x1007);
        EXPECT(gbc.pc(), 0xb412);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb411), 0x5b);
        // 5B 02CC
        gbc.setState(0xd325, 0x99a7, 0x51d0, 0x1adc, 0xe5, 0x2f1b, 0x0, 0x0);
        gbc.writeMem(0xd325, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x51);
        EXPECT(gbc.b(),  0x1a);
        EXPECT(gbc.c(),  0xdc);
        EXPECT(gbc.d(),  0x0);
        EXPECT(gbc.e(),  0xe5);
        EXPECT(gbc.h(),  0x2f);
        EXPECT(gbc.l(),  0x1b);
        EXPECT(gbc.sp(), 0x99a7);
        EXPECT(gbc.pc(), 0xd326);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd325), 0x5b);
        // 5B 02CD
        gbc.setState(0xec05, 0x538c, 0xfe60, 0x125, 0xe9b8, 0x5830, 0x0, 0x0);
        gbc.writeMem(0xec05, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xfe);
        EXPECT(gbc.b(),  0x1);
        EXPECT(gbc.c(),  0x25);
        EXPECT(gbc.d(),  0xe9);
        EXPECT(gbc.e(),  0xb8);
        EXPECT(gbc.h(),  0x58);
        EXPECT(gbc.l(),  0x30);
        EXPECT(gbc.sp(), 0x538c);
        EXPECT(gbc.pc(), 0xec06);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xec05), 0x5b);
        // 5B 02CE
        gbc.setState(0x2588, 0xb0ef, 0xb150, 0x2d51, 0xeb35, 0x36, 0x0, 0x1);
        gbc.writeMem(0x2588, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xb1);
        EXPECT(gbc.b(),  0x2d);
        EXPECT(gbc.c(),  0x51);
        EXPECT(gbc.d(),  0xeb);
        EXPECT(gbc.e(),  0x35);
        EXPECT(gbc.h(),  0x0);
        EXPECT(gbc.l(),  0x36);
        EXPECT(gbc.sp(), 0xb0ef);
        EXPECT(gbc.pc(), 0x2589);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 02CF
        gbc.setState(0xed68, 0xdf57, 0x58d0, 0x700, 0x54ed, 0x4b73, 0x0, 0x0);
        gbc.writeMem(0xed68, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x58);
        EXPECT(gbc.b(),  0x7);
        EXPECT(gbc.c(),  0x0);
        EXPECT(gbc.d(),  0x54);
        EXPECT(gbc.e(),  0xed);
        EXPECT(gbc.h(),  0x4b);
        EXPECT(gbc.l(),  0x73);
        EXPECT(gbc.sp(), 0xdf57);
        EXPECT(gbc.pc(), 0xed69);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xed68), 0x5b);
        // 5B 02D0
        gbc.setState(0x1414, 0xb427, 0x3090, 0x9a0b, 0xdd9f, 0xd926, 0x1, 0x1);
        gbc.writeMem(0x1414, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x30);
        EXPECT(gbc.b(),  0x9a);
        EXPECT(gbc.c(),  0xb);
        EXPECT(gbc.d(),  0xdd);
        EXPECT(gbc.e(),  0x9f);
        EXPECT(gbc.h(),  0xd9);
        EXPECT(gbc.l(),  0x26);
        EXPECT(gbc.sp(), 0xb427);
        EXPECT(gbc.pc(), 0x1415);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 02D1
        gbc.setState(0xaafa, 0x9d61, 0xf6f0, 0xd879, 0xee53, 0x9353, 0x0, 0x1);
        gbc.writeMem(0xaafa, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf6);
        EXPECT(gbc.b(),  0xd8);
        EXPECT(gbc.c(),  0x79);
        EXPECT(gbc.d(),  0xee);
        EXPECT(gbc.e(),  0x53);
        EXPECT(gbc.h(),  0x93);
        EXPECT(gbc.l(),  0x53);
        EXPECT(gbc.sp(), 0x9d61);
        EXPECT(gbc.pc(), 0xaafb);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xaafa), 0x5b);
        // 5B 02D2
        gbc.setState(0xdae1, 0x359f, 0xb710, 0x771, 0xbdcb, 0x7c25, 0x0, 0x1);
        gbc.writeMem(0xdae1, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xb7);
        EXPECT(gbc.b(),  0x7);
        EXPECT(gbc.c(),  0x71);
        EXPECT(gbc.d(),  0xbd);
        EXPECT(gbc.e(),  0xcb);
        EXPECT(gbc.h(),  0x7c);
        EXPECT(gbc.l(),  0x25);
        EXPECT(gbc.sp(), 0x359f);
        EXPECT(gbc.pc(), 0xdae2);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xdae1), 0x5b);
        // 5B 02D3
        gbc.setState(0xa85c, 0xa2b2, 0xb330, 0x20ff, 0xa8ea, 0x388b, 0x0, 0x0);
        gbc.writeMem(0xa85c, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xb3);
        EXPECT(gbc.b(),  0x20);
        EXPECT(gbc.c(),  0xff);
        EXPECT(gbc.d(),  0xa8);
        EXPECT(gbc.e(),  0xea);
        EXPECT(gbc.h(),  0x38);
        EXPECT(gbc.l(),  0x8b);
        EXPECT(gbc.sp(), 0xa2b2);
        EXPECT(gbc.pc(), 0xa85d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa85c), 0x5b);
        // 5B 02D4
        gbc.setState(0x4bbe, 0x267c, 0xc220, 0x8b3a, 0xd440, 0xb333, 0x1, 0x0);
        gbc.writeMem(0x4bbe, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xc2);
        EXPECT(gbc.b(),  0x8b);
        EXPECT(gbc.c(),  0x3a);
        EXPECT(gbc.d(),  0xd4);
        EXPECT(gbc.e(),  0x40);
        EXPECT(gbc.h(),  0xb3);
        EXPECT(gbc.l(),  0x33);
        EXPECT(gbc.sp(), 0x267c);
        EXPECT(gbc.pc(), 0x4bbf);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 02D5
        gbc.setState(0x8933, 0x2f3a, 0x4660, 0xd38f, 0x600b, 0x6206, 0x1, 0x0);
        gbc.writeMem(0x8933, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x46);
        EXPECT(gbc.b(),  0xd3);
        EXPECT(gbc.c(),  0x8f);
        EXPECT(gbc.d(),  0x60);
        EXPECT(gbc.e(),  0xb);
        EXPECT(gbc.h(),  0x62);
        EXPECT(gbc.l(),  0x6);
        EXPECT(gbc.sp(), 0x2f3a);
        EXPECT(gbc.pc(), 0x8934);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8933), 0x5b);
        // 5B 02D6
        gbc.setState(0x5ab7, 0xb940, 0x8dc0, 0x1d2c, 0xbe24, 0x602f, 0x1, 0x0);
        gbc.writeMem(0x5ab7, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x8d);
        EXPECT(gbc.b(),  0x1d);
        EXPECT(gbc.c(),  0x2c);
        EXPECT(gbc.d(),  0xbe);
        EXPECT(gbc.e(),  0x24);
        EXPECT(gbc.h(),  0x60);
        EXPECT(gbc.l(),  0x2f);
        EXPECT(gbc.sp(), 0xb940);
        EXPECT(gbc.pc(), 0x5ab8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 02D7
        gbc.setState(0x5df1, 0x640a, 0x3c90, 0xfb28, 0x4a2, 0xd4dd, 0x0, 0x1);
        gbc.writeMem(0x5df1, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x3c);
        EXPECT(gbc.b(),  0xfb);
        EXPECT(gbc.c(),  0x28);
        EXPECT(gbc.d(),  0x4);
        EXPECT(gbc.e(),  0xa2);
        EXPECT(gbc.h(),  0xd4);
        EXPECT(gbc.l(),  0xdd);
        EXPECT(gbc.sp(), 0x640a);
        EXPECT(gbc.pc(), 0x5df2);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 02D8
        gbc.setState(0xd6a4, 0xc16d, 0x27a0, 0x11b3, 0xabc6, 0x56de, 0x1, 0x0);
        gbc.writeMem(0xd6a4, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x27);
        EXPECT(gbc.b(),  0x11);
        EXPECT(gbc.c(),  0xb3);
        EXPECT(gbc.d(),  0xab);
        EXPECT(gbc.e(),  0xc6);
        EXPECT(gbc.h(),  0x56);
        EXPECT(gbc.l(),  0xde);
        EXPECT(gbc.sp(), 0xc16d);
        EXPECT(gbc.pc(), 0xd6a5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd6a4), 0x5b);
        // 5B 02D9
        gbc.setState(0xc5ec, 0x7cbf, 0x5710, 0x4bda, 0xde14, 0x1dbc, 0x1, 0x1);
        gbc.writeMem(0xc5ec, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x57);
        EXPECT(gbc.b(),  0x4b);
        EXPECT(gbc.c(),  0xda);
        EXPECT(gbc.d(),  0xde);
        EXPECT(gbc.e(),  0x14);
        EXPECT(gbc.h(),  0x1d);
        EXPECT(gbc.l(),  0xbc);
        EXPECT(gbc.sp(), 0x7cbf);
        EXPECT(gbc.pc(), 0xc5ed);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc5ec), 0x5b);
        // 5B 02DA
        gbc.setState(0xaa96, 0xfd9f, 0x4c40, 0x5341, 0xfd79, 0xa20a, 0x0, 0x0);
        gbc.writeMem(0xaa96, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x4c);
        EXPECT(gbc.b(),  0x53);
        EXPECT(gbc.c(),  0x41);
        EXPECT(gbc.d(),  0xfd);
        EXPECT(gbc.e(),  0x79);
        EXPECT(gbc.h(),  0xa2);
        EXPECT(gbc.l(),  0xa);
        EXPECT(gbc.sp(), 0xfd9f);
        EXPECT(gbc.pc(), 0xaa97);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xaa96), 0x5b);
        // 5B 02DB
        gbc.setState(0x7b80, 0x1912, 0x9af0, 0x299, 0x231f, 0x7fac, 0x1, 0x1);
        gbc.writeMem(0x7b80, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x9a);
        EXPECT(gbc.b(),  0x2);
        EXPECT(gbc.c(),  0x99);
        EXPECT(gbc.d(),  0x23);
        EXPECT(gbc.e(),  0x1f);
        EXPECT(gbc.h(),  0x7f);
        EXPECT(gbc.l(),  0xac);
        EXPECT(gbc.sp(), 0x1912);
        EXPECT(gbc.pc(), 0x7b81);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 02DC
        gbc.setState(0x865, 0x3dff, 0xc970, 0x525f, 0xae8d, 0x265a, 0x0, 0x1);
        gbc.writeMem(0x865, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xc9);
        EXPECT(gbc.b(),  0x52);
        EXPECT(gbc.c(),  0x5f);
        EXPECT(gbc.d(),  0xae);
        EXPECT(gbc.e(),  0x8d);
        EXPECT(gbc.h(),  0x26);
        EXPECT(gbc.l(),  0x5a);
        EXPECT(gbc.sp(), 0x3dff);
        EXPECT(gbc.pc(), 0x866);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 02DD
        gbc.setState(0x8445, 0xf457, 0x6eb0, 0x8c5e, 0xe948, 0x4239, 0x0, 0x1);
        gbc.writeMem(0x8445, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x6e);
        EXPECT(gbc.b(),  0x8c);
        EXPECT(gbc.c(),  0x5e);
        EXPECT(gbc.d(),  0xe9);
        EXPECT(gbc.e(),  0x48);
        EXPECT(gbc.h(),  0x42);
        EXPECT(gbc.l(),  0x39);
        EXPECT(gbc.sp(), 0xf457);
        EXPECT(gbc.pc(), 0x8446);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8445), 0x5b);
        // 5B 02DE
        gbc.setState(0x7943, 0xfe22, 0x1b90, 0xc3f3, 0xe403, 0x871e, 0x0, 0x1);
        gbc.writeMem(0x7943, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x1b);
        EXPECT(gbc.b(),  0xc3);
        EXPECT(gbc.c(),  0xf3);
        EXPECT(gbc.d(),  0xe4);
        EXPECT(gbc.e(),  0x3);
        EXPECT(gbc.h(),  0x87);
        EXPECT(gbc.l(),  0x1e);
        EXPECT(gbc.sp(), 0xfe22);
        EXPECT(gbc.pc(), 0x7944);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 02DF
        gbc.setState(0x9858, 0x8780, 0xa8b0, 0x74eb, 0x739d, 0x6a4c, 0x0, 0x1);
        gbc.writeMem(0x9858, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa8);
        EXPECT(gbc.b(),  0x74);
        EXPECT(gbc.c(),  0xeb);
        EXPECT(gbc.d(),  0x73);
        EXPECT(gbc.e(),  0x9d);
        EXPECT(gbc.h(),  0x6a);
        EXPECT(gbc.l(),  0x4c);
        EXPECT(gbc.sp(), 0x8780);
        EXPECT(gbc.pc(), 0x9859);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9858), 0x5b);
        // 5B 02E0
        gbc.setState(0xbad, 0x259b, 0x3330, 0x4d28, 0x6094, 0xfa05, 0x1, 0x1);
        gbc.writeMem(0xbad, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x33);
        EXPECT(gbc.b(),  0x4d);
        EXPECT(gbc.c(),  0x28);
        EXPECT(gbc.d(),  0x60);
        EXPECT(gbc.e(),  0x94);
        EXPECT(gbc.h(),  0xfa);
        EXPECT(gbc.l(),  0x5);
        EXPECT(gbc.sp(), 0x259b);
        EXPECT(gbc.pc(), 0xbae);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 02E1
        gbc.setState(0x726d, 0x1c77, 0x3200, 0xaf96, 0x122e, 0x46ab, 0x1, 0x0);
        gbc.writeMem(0x726d, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x32);
        EXPECT(gbc.b(),  0xaf);
        EXPECT(gbc.c(),  0x96);
        EXPECT(gbc.d(),  0x12);
        EXPECT(gbc.e(),  0x2e);
        EXPECT(gbc.h(),  0x46);
        EXPECT(gbc.l(),  0xab);
        EXPECT(gbc.sp(), 0x1c77);
        EXPECT(gbc.pc(), 0x726e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 02E2
        gbc.setState(0x7dab, 0xed59, 0xd0a0, 0xd1f3, 0x6c76, 0x7298, 0x1, 0x1);
        gbc.writeMem(0x7dab, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd0);
        EXPECT(gbc.b(),  0xd1);
        EXPECT(gbc.c(),  0xf3);
        EXPECT(gbc.d(),  0x6c);
        EXPECT(gbc.e(),  0x76);
        EXPECT(gbc.h(),  0x72);
        EXPECT(gbc.l(),  0x98);
        EXPECT(gbc.sp(), 0xed59);
        EXPECT(gbc.pc(), 0x7dac);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 02E3
        gbc.setState(0xea1a, 0x73d9, 0x2190, 0xbc5d, 0xd5d2, 0xf215, 0x0, 0x1);
        gbc.writeMem(0xea1a, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x21);
        EXPECT(gbc.b(),  0xbc);
        EXPECT(gbc.c(),  0x5d);
        EXPECT(gbc.d(),  0xd5);
        EXPECT(gbc.e(),  0xd2);
        EXPECT(gbc.h(),  0xf2);
        EXPECT(gbc.l(),  0x15);
        EXPECT(gbc.sp(), 0x73d9);
        EXPECT(gbc.pc(), 0xea1b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xea1a), 0x5b);
        // 5B 02E4
        gbc.setState(0x274e, 0xeefa, 0x8830, 0x842e, 0xd58a, 0x78be, 0x0, 0x1);
        gbc.writeMem(0x274e, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x88);
        EXPECT(gbc.b(),  0x84);
        EXPECT(gbc.c(),  0x2e);
        EXPECT(gbc.d(),  0xd5);
        EXPECT(gbc.e(),  0x8a);
        EXPECT(gbc.h(),  0x78);
        EXPECT(gbc.l(),  0xbe);
        EXPECT(gbc.sp(), 0xeefa);
        EXPECT(gbc.pc(), 0x274f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 02E5
        gbc.setState(0x411b, 0xbda6, 0xbe60, 0x92ea, 0x70cb, 0xb932, 0x1, 0x1);
        gbc.writeMem(0x411b, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xbe);
        EXPECT(gbc.b(),  0x92);
        EXPECT(gbc.c(),  0xea);
        EXPECT(gbc.d(),  0x70);
        EXPECT(gbc.e(),  0xcb);
        EXPECT(gbc.h(),  0xb9);
        EXPECT(gbc.l(),  0x32);
        EXPECT(gbc.sp(), 0xbda6);
        EXPECT(gbc.pc(), 0x411c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 02E6
        gbc.setState(0xbad3, 0x1bee, 0xc360, 0x8473, 0xaf8c, 0x4694, 0x0, 0x0);
        gbc.writeMem(0xbad3, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xc3);
        EXPECT(gbc.b(),  0x84);
        EXPECT(gbc.c(),  0x73);
        EXPECT(gbc.d(),  0xaf);
        EXPECT(gbc.e(),  0x8c);
        EXPECT(gbc.h(),  0x46);
        EXPECT(gbc.l(),  0x94);
        EXPECT(gbc.sp(), 0x1bee);
        EXPECT(gbc.pc(), 0xbad4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbad3), 0x5b);
        // 5B 02E7
        gbc.setState(0x3c2d, 0xfa, 0x7640, 0xcfe5, 0x949e, 0x4105, 0x1, 0x1);
        gbc.writeMem(0x3c2d, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x76);
        EXPECT(gbc.b(),  0xcf);
        EXPECT(gbc.c(),  0xe5);
        EXPECT(gbc.d(),  0x94);
        EXPECT(gbc.e(),  0x9e);
        EXPECT(gbc.h(),  0x41);
        EXPECT(gbc.l(),  0x5);
        EXPECT(gbc.sp(), 0xfa);
        EXPECT(gbc.pc(), 0x3c2e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 02E8
        gbc.setState(0x8e0c, 0x6dcd, 0x5380, 0x588e, 0x8eee, 0x4469, 0x0, 0x0);
        gbc.writeMem(0x8e0c, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x53);
        EXPECT(gbc.b(),  0x58);
        EXPECT(gbc.c(),  0x8e);
        EXPECT(gbc.d(),  0x8e);
        EXPECT(gbc.e(),  0xee);
        EXPECT(gbc.h(),  0x44);
        EXPECT(gbc.l(),  0x69);
        EXPECT(gbc.sp(), 0x6dcd);
        EXPECT(gbc.pc(), 0x8e0d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8e0c), 0x5b);
        // 5B 02E9
        gbc.setState(0xae9b, 0x48ec, 0x4350, 0xa557, 0x9faa, 0xa443, 0x0, 0x0);
        gbc.writeMem(0xae9b, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x43);
        EXPECT(gbc.b(),  0xa5);
        EXPECT(gbc.c(),  0x57);
        EXPECT(gbc.d(),  0x9f);
        EXPECT(gbc.e(),  0xaa);
        EXPECT(gbc.h(),  0xa4);
        EXPECT(gbc.l(),  0x43);
        EXPECT(gbc.sp(), 0x48ec);
        EXPECT(gbc.pc(), 0xae9c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xae9b), 0x5b);
        // 5B 02EA
        gbc.setState(0xe2b6, 0xdb80, 0x5c50, 0x3533, 0xd83a, 0x64c9, 0x0, 0x1);
        gbc.writeMem(0xe2b6, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x5c);
        EXPECT(gbc.b(),  0x35);
        EXPECT(gbc.c(),  0x33);
        EXPECT(gbc.d(),  0xd8);
        EXPECT(gbc.e(),  0x3a);
        EXPECT(gbc.h(),  0x64);
        EXPECT(gbc.l(),  0xc9);
        EXPECT(gbc.sp(), 0xdb80);
        EXPECT(gbc.pc(), 0xe2b7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe2b6), 0x5b);
        // 5B 02EB
        gbc.setState(0x39e, 0xdcd9, 0x7940, 0xf6aa, 0xe759, 0x6e2a, 0x1, 0x0);
        gbc.writeMem(0x39e, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x79);
        EXPECT(gbc.b(),  0xf6);
        EXPECT(gbc.c(),  0xaa);
        EXPECT(gbc.d(),  0xe7);
        EXPECT(gbc.e(),  0x59);
        EXPECT(gbc.h(),  0x6e);
        EXPECT(gbc.l(),  0x2a);
        EXPECT(gbc.sp(), 0xdcd9);
        EXPECT(gbc.pc(), 0x39f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 02EC
        gbc.setState(0x8410, 0x45ac, 0x5e90, 0x8f84, 0xe0fb, 0xd210, 0x0, 0x1);
        gbc.writeMem(0x8410, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x5e);
        EXPECT(gbc.b(),  0x8f);
        EXPECT(gbc.c(),  0x84);
        EXPECT(gbc.d(),  0xe0);
        EXPECT(gbc.e(),  0xfb);
        EXPECT(gbc.h(),  0xd2);
        EXPECT(gbc.l(),  0x10);
        EXPECT(gbc.sp(), 0x45ac);
        EXPECT(gbc.pc(), 0x8411);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8410), 0x5b);
        // 5B 02ED
        gbc.setState(0x7a20, 0xcc04, 0xabe0, 0x223b, 0x8cd1, 0x90c7, 0x1, 0x1);
        gbc.writeMem(0x7a20, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xab);
        EXPECT(gbc.b(),  0x22);
        EXPECT(gbc.c(),  0x3b);
        EXPECT(gbc.d(),  0x8c);
        EXPECT(gbc.e(),  0xd1);
        EXPECT(gbc.h(),  0x90);
        EXPECT(gbc.l(),  0xc7);
        EXPECT(gbc.sp(), 0xcc04);
        EXPECT(gbc.pc(), 0x7a21);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 02EE
        gbc.setState(0x52a3, 0x17bf, 0x18e0, 0x120a, 0xd5ba, 0xc9ee, 0x0, 0x0);
        gbc.writeMem(0x52a3, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x18);
        EXPECT(gbc.b(),  0x12);
        EXPECT(gbc.c(),  0xa);
        EXPECT(gbc.d(),  0xd5);
        EXPECT(gbc.e(),  0xba);
        EXPECT(gbc.h(),  0xc9);
        EXPECT(gbc.l(),  0xee);
        EXPECT(gbc.sp(), 0x17bf);
        EXPECT(gbc.pc(), 0x52a4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 02EF
        gbc.setState(0xcf19, 0x589f, 0xd670, 0x8d4e, 0x6d47, 0x7fb8, 0x0, 0x0);
        gbc.writeMem(0xcf19, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd6);
        EXPECT(gbc.b(),  0x8d);
        EXPECT(gbc.c(),  0x4e);
        EXPECT(gbc.d(),  0x6d);
        EXPECT(gbc.e(),  0x47);
        EXPECT(gbc.h(),  0x7f);
        EXPECT(gbc.l(),  0xb8);
        EXPECT(gbc.sp(), 0x589f);
        EXPECT(gbc.pc(), 0xcf1a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcf19), 0x5b);
        // 5B 02F0
        gbc.setState(0x4f17, 0x6fb, 0x3600, 0x4812, 0x740e, 0xb02f, 0x1, 0x0);
        gbc.writeMem(0x4f17, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x36);
        EXPECT(gbc.b(),  0x48);
        EXPECT(gbc.c(),  0x12);
        EXPECT(gbc.d(),  0x74);
        EXPECT(gbc.e(),  0xe);
        EXPECT(gbc.h(),  0xb0);
        EXPECT(gbc.l(),  0x2f);
        EXPECT(gbc.sp(), 0x6fb);
        EXPECT(gbc.pc(), 0x4f18);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 02F2
        gbc.setState(0x816c, 0x3350, 0x5210, 0xb208, 0x6988, 0xd2f0, 0x1, 0x0);
        gbc.writeMem(0x816c, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x52);
        EXPECT(gbc.b(),  0xb2);
        EXPECT(gbc.c(),  0x8);
        EXPECT(gbc.d(),  0x69);
        EXPECT(gbc.e(),  0x88);
        EXPECT(gbc.h(),  0xd2);
        EXPECT(gbc.l(),  0xf0);
        EXPECT(gbc.sp(), 0x3350);
        EXPECT(gbc.pc(), 0x816d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x816c), 0x5b);
        // 5B 02F3
        gbc.setState(0xd86b, 0xc84b, 0x5b80, 0x6709, 0xa171, 0xd27f, 0x1, 0x0);
        gbc.writeMem(0xd86b, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x5b);
        EXPECT(gbc.b(),  0x67);
        EXPECT(gbc.c(),  0x9);
        EXPECT(gbc.d(),  0xa1);
        EXPECT(gbc.e(),  0x71);
        EXPECT(gbc.h(),  0xd2);
        EXPECT(gbc.l(),  0x7f);
        EXPECT(gbc.sp(), 0xc84b);
        EXPECT(gbc.pc(), 0xd86c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd86b), 0x5b);
        // 5B 02F4
        gbc.setState(0x76b3, 0xa28d, 0xb690, 0x5127, 0xb1db, 0x88b2, 0x0, 0x1);
        gbc.writeMem(0x76b3, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xb6);
        EXPECT(gbc.b(),  0x51);
        EXPECT(gbc.c(),  0x27);
        EXPECT(gbc.d(),  0xb1);
        EXPECT(gbc.e(),  0xdb);
        EXPECT(gbc.h(),  0x88);
        EXPECT(gbc.l(),  0xb2);
        EXPECT(gbc.sp(), 0xa28d);
        EXPECT(gbc.pc(), 0x76b4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 02F5
        gbc.setState(0x6d7d, 0x812f, 0x67c0, 0xa617, 0xaa68, 0x665d, 0x1, 0x1);
        gbc.writeMem(0x6d7d, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x67);
        EXPECT(gbc.b(),  0xa6);
        EXPECT(gbc.c(),  0x17);
        EXPECT(gbc.d(),  0xaa);
        EXPECT(gbc.e(),  0x68);
        EXPECT(gbc.h(),  0x66);
        EXPECT(gbc.l(),  0x5d);
        EXPECT(gbc.sp(), 0x812f);
        EXPECT(gbc.pc(), 0x6d7e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 02F6
        gbc.setState(0x1e22, 0x300e, 0xe20, 0x3875, 0x272c, 0x4076, 0x0, 0x0);
        gbc.writeMem(0x1e22, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xe);
        EXPECT(gbc.b(),  0x38);
        EXPECT(gbc.c(),  0x75);
        EXPECT(gbc.d(),  0x27);
        EXPECT(gbc.e(),  0x2c);
        EXPECT(gbc.h(),  0x40);
        EXPECT(gbc.l(),  0x76);
        EXPECT(gbc.sp(), 0x300e);
        EXPECT(gbc.pc(), 0x1e23);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 02F7
        gbc.setState(0x5a17, 0x5a81, 0xd0a0, 0x3e02, 0xad69, 0x1614, 0x1, 0x1);
        gbc.writeMem(0x5a17, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd0);
        EXPECT(gbc.b(),  0x3e);
        EXPECT(gbc.c(),  0x2);
        EXPECT(gbc.d(),  0xad);
        EXPECT(gbc.e(),  0x69);
        EXPECT(gbc.h(),  0x16);
        EXPECT(gbc.l(),  0x14);
        EXPECT(gbc.sp(), 0x5a81);
        EXPECT(gbc.pc(), 0x5a18);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 02F8
        gbc.setState(0x6a48, 0xaa54, 0xfe60, 0x5773, 0xfcda, 0x7aa0, 0x1, 0x1);
        gbc.writeMem(0x6a48, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xfe);
        EXPECT(gbc.b(),  0x57);
        EXPECT(gbc.c(),  0x73);
        EXPECT(gbc.d(),  0xfc);
        EXPECT(gbc.e(),  0xda);
        EXPECT(gbc.h(),  0x7a);
        EXPECT(gbc.l(),  0xa0);
        EXPECT(gbc.sp(), 0xaa54);
        EXPECT(gbc.pc(), 0x6a49);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 02F9
        gbc.setState(0x8d80, 0x110, 0x6630, 0xdd6, 0x9c43, 0xbd99, 0x0, 0x1);
        gbc.writeMem(0x8d80, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x66);
        EXPECT(gbc.b(),  0xd);
        EXPECT(gbc.c(),  0xd6);
        EXPECT(gbc.d(),  0x9c);
        EXPECT(gbc.e(),  0x43);
        EXPECT(gbc.h(),  0xbd);
        EXPECT(gbc.l(),  0x99);
        EXPECT(gbc.sp(), 0x110);
        EXPECT(gbc.pc(), 0x8d81);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8d80), 0x5b);
        // 5B 02FB
        gbc.setState(0x547e, 0x70b1, 0xfc20, 0x8da5, 0xae55, 0x10a6, 0x0, 0x1);
        gbc.writeMem(0x547e, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xfc);
        EXPECT(gbc.b(),  0x8d);
        EXPECT(gbc.c(),  0xa5);
        EXPECT(gbc.d(),  0xae);
        EXPECT(gbc.e(),  0x55);
        EXPECT(gbc.h(),  0x10);
        EXPECT(gbc.l(),  0xa6);
        EXPECT(gbc.sp(), 0x70b1);
        EXPECT(gbc.pc(), 0x547f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 02FC
        gbc.setState(0xd280, 0x6165, 0x7030, 0xdc95, 0x80f, 0xc5b2, 0x0, 0x1);
        gbc.writeMem(0xd280, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x70);
        EXPECT(gbc.b(),  0xdc);
        EXPECT(gbc.c(),  0x95);
        EXPECT(gbc.d(),  0x8);
        EXPECT(gbc.e(),  0xf);
        EXPECT(gbc.h(),  0xc5);
        EXPECT(gbc.l(),  0xb2);
        EXPECT(gbc.sp(), 0x6165);
        EXPECT(gbc.pc(), 0xd281);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd280), 0x5b);
        // 5B 02FD
        gbc.setState(0xa872, 0x8c03, 0x7e50, 0xc4b5, 0xfb4d, 0xd3f6, 0x0, 0x1);
        gbc.writeMem(0xa872, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x7e);
        EXPECT(gbc.b(),  0xc4);
        EXPECT(gbc.c(),  0xb5);
        EXPECT(gbc.d(),  0xfb);
        EXPECT(gbc.e(),  0x4d);
        EXPECT(gbc.h(),  0xd3);
        EXPECT(gbc.l(),  0xf6);
        EXPECT(gbc.sp(), 0x8c03);
        EXPECT(gbc.pc(), 0xa873);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa872), 0x5b);
        // 5B 02FE
        gbc.setState(0x904f, 0xf324, 0x8120, 0x4e84, 0xad65, 0x5081, 0x0, 0x1);
        gbc.writeMem(0x904f, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x81);
        EXPECT(gbc.b(),  0x4e);
        EXPECT(gbc.c(),  0x84);
        EXPECT(gbc.d(),  0xad);
        EXPECT(gbc.e(),  0x65);
        EXPECT(gbc.h(),  0x50);
        EXPECT(gbc.l(),  0x81);
        EXPECT(gbc.sp(), 0xf324);
        EXPECT(gbc.pc(), 0x9050);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x904f), 0x5b);
        // 5B 02FF
        gbc.setState(0xef56, 0xc32, 0x4f70, 0xbba4, 0x3290, 0x6461, 0x1, 0x1);
        gbc.writeMem(0xef56, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x4f);
        EXPECT(gbc.b(),  0xbb);
        EXPECT(gbc.c(),  0xa4);
        EXPECT(gbc.d(),  0x32);
        EXPECT(gbc.e(),  0x90);
        EXPECT(gbc.h(),  0x64);
        EXPECT(gbc.l(),  0x61);
        EXPECT(gbc.sp(), 0xc32);
        EXPECT(gbc.pc(), 0xef57);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xef56), 0x5b);
        // 5B 0300
        gbc.setState(0x4acf, 0xbe3, 0x7180, 0x7960, 0x2e0a, 0x5fa8, 0x0, 0x0);
        gbc.writeMem(0x4acf, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x71);
        EXPECT(gbc.b(),  0x79);
        EXPECT(gbc.c(),  0x60);
        EXPECT(gbc.d(),  0x2e);
        EXPECT(gbc.e(),  0xa);
        EXPECT(gbc.h(),  0x5f);
        EXPECT(gbc.l(),  0xa8);
        EXPECT(gbc.sp(), 0xbe3);
        EXPECT(gbc.pc(), 0x4ad0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0301
        gbc.setState(0xa03a, 0x7953, 0xa540, 0xdfd6, 0xbd2, 0x28c5, 0x0, 0x1);
        gbc.writeMem(0xa03a, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa5);
        EXPECT(gbc.b(),  0xdf);
        EXPECT(gbc.c(),  0xd6);
        EXPECT(gbc.d(),  0xb);
        EXPECT(gbc.e(),  0xd2);
        EXPECT(gbc.h(),  0x28);
        EXPECT(gbc.l(),  0xc5);
        EXPECT(gbc.sp(), 0x7953);
        EXPECT(gbc.pc(), 0xa03b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa03a), 0x5b);
        // 5B 0302
        gbc.setState(0xd63d, 0x8b16, 0xb390, 0x6295, 0xdbab, 0x2de7, 0x0, 0x1);
        gbc.writeMem(0xd63d, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xb3);
        EXPECT(gbc.b(),  0x62);
        EXPECT(gbc.c(),  0x95);
        EXPECT(gbc.d(),  0xdb);
        EXPECT(gbc.e(),  0xab);
        EXPECT(gbc.h(),  0x2d);
        EXPECT(gbc.l(),  0xe7);
        EXPECT(gbc.sp(), 0x8b16);
        EXPECT(gbc.pc(), 0xd63e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd63d), 0x5b);
        // 5B 0303
        gbc.setState(0x5610, 0xdff7, 0x4cc0, 0x14a2, 0x772, 0x4476, 0x1, 0x0);
        gbc.writeMem(0x5610, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x4c);
        EXPECT(gbc.b(),  0x14);
        EXPECT(gbc.c(),  0xa2);
        EXPECT(gbc.d(),  0x7);
        EXPECT(gbc.e(),  0x72);
        EXPECT(gbc.h(),  0x44);
        EXPECT(gbc.l(),  0x76);
        EXPECT(gbc.sp(), 0xdff7);
        EXPECT(gbc.pc(), 0x5611);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0304
        gbc.setState(0x7670, 0xece6, 0x83d0, 0x6787, 0xb533, 0xdd10, 0x0, 0x0);
        gbc.writeMem(0x7670, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x83);
        EXPECT(gbc.b(),  0x67);
        EXPECT(gbc.c(),  0x87);
        EXPECT(gbc.d(),  0xb5);
        EXPECT(gbc.e(),  0x33);
        EXPECT(gbc.h(),  0xdd);
        EXPECT(gbc.l(),  0x10);
        EXPECT(gbc.sp(), 0xece6);
        EXPECT(gbc.pc(), 0x7671);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 0305
        gbc.setState(0x82f5, 0x3344, 0x1b40, 0x2c66, 0x5420, 0x75d6, 0x1, 0x1);
        gbc.writeMem(0x82f5, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x1b);
        EXPECT(gbc.b(),  0x2c);
        EXPECT(gbc.c(),  0x66);
        EXPECT(gbc.d(),  0x54);
        EXPECT(gbc.e(),  0x20);
        EXPECT(gbc.h(),  0x75);
        EXPECT(gbc.l(),  0xd6);
        EXPECT(gbc.sp(), 0x3344);
        EXPECT(gbc.pc(), 0x82f6);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x82f5), 0x5b);
        // 5B 0306
        gbc.setState(0x59d, 0x49a8, 0x7d60, 0xc660, 0xc4ee, 0x59d3, 0x0, 0x1);
        gbc.writeMem(0x59d, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x7d);
        EXPECT(gbc.b(),  0xc6);
        EXPECT(gbc.c(),  0x60);
        EXPECT(gbc.d(),  0xc4);
        EXPECT(gbc.e(),  0xee);
        EXPECT(gbc.h(),  0x59);
        EXPECT(gbc.l(),  0xd3);
        EXPECT(gbc.sp(), 0x49a8);
        EXPECT(gbc.pc(), 0x59e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0307
        gbc.setState(0xa4cd, 0x1d51, 0x1a90, 0x213c, 0xba6f, 0x7f59, 0x0, 0x1);
        gbc.writeMem(0xa4cd, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x1a);
        EXPECT(gbc.b(),  0x21);
        EXPECT(gbc.c(),  0x3c);
        EXPECT(gbc.d(),  0xba);
        EXPECT(gbc.e(),  0x6f);
        EXPECT(gbc.h(),  0x7f);
        EXPECT(gbc.l(),  0x59);
        EXPECT(gbc.sp(), 0x1d51);
        EXPECT(gbc.pc(), 0xa4ce);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa4cd), 0x5b);
        // 5B 0308
        gbc.setState(0x1757, 0x39, 0x71b0, 0xd417, 0x9037, 0xc95e, 0x0, 0x0);
        gbc.writeMem(0x1757, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x71);
        EXPECT(gbc.b(),  0xd4);
        EXPECT(gbc.c(),  0x17);
        EXPECT(gbc.d(),  0x90);
        EXPECT(gbc.e(),  0x37);
        EXPECT(gbc.h(),  0xc9);
        EXPECT(gbc.l(),  0x5e);
        EXPECT(gbc.sp(), 0x39);
        EXPECT(gbc.pc(), 0x1758);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0309
        gbc.setState(0x4f42, 0x61f5, 0xf790, 0xbaa9, 0x8a9b, 0xbf27, 0x0, 0x0);
        gbc.writeMem(0x4f42, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf7);
        EXPECT(gbc.b(),  0xba);
        EXPECT(gbc.c(),  0xa9);
        EXPECT(gbc.d(),  0x8a);
        EXPECT(gbc.e(),  0x9b);
        EXPECT(gbc.h(),  0xbf);
        EXPECT(gbc.l(),  0x27);
        EXPECT(gbc.sp(), 0x61f5);
        EXPECT(gbc.pc(), 0x4f43);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 030A
        gbc.setState(0xba8b, 0x7db2, 0xfab0, 0xc691, 0x466d, 0x3383, 0x1, 0x1);
        gbc.writeMem(0xba8b, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xfa);
        EXPECT(gbc.b(),  0xc6);
        EXPECT(gbc.c(),  0x91);
        EXPECT(gbc.d(),  0x46);
        EXPECT(gbc.e(),  0x6d);
        EXPECT(gbc.h(),  0x33);
        EXPECT(gbc.l(),  0x83);
        EXPECT(gbc.sp(), 0x7db2);
        EXPECT(gbc.pc(), 0xba8c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xba8b), 0x5b);
        // 5B 030B
        gbc.setState(0x1934, 0x15bc, 0x9120, 0x5c1d, 0xc9b0, 0x7e72, 0x0, 0x1);
        gbc.writeMem(0x1934, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x91);
        EXPECT(gbc.b(),  0x5c);
        EXPECT(gbc.c(),  0x1d);
        EXPECT(gbc.d(),  0xc9);
        EXPECT(gbc.e(),  0xb0);
        EXPECT(gbc.h(),  0x7e);
        EXPECT(gbc.l(),  0x72);
        EXPECT(gbc.sp(), 0x15bc);
        EXPECT(gbc.pc(), 0x1935);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 030C
        gbc.setState(0x248b, 0x2125, 0x1830, 0x936d, 0x36, 0x1dfa, 0x0, 0x0);
        gbc.writeMem(0x248b, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x18);
        EXPECT(gbc.b(),  0x93);
        EXPECT(gbc.c(),  0x6d);
        EXPECT(gbc.d(),  0x0);
        EXPECT(gbc.e(),  0x36);
        EXPECT(gbc.h(),  0x1d);
        EXPECT(gbc.l(),  0xfa);
        EXPECT(gbc.sp(), 0x2125);
        EXPECT(gbc.pc(), 0x248c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 030E
        gbc.setState(0xcd6a, 0x4421, 0x62e0, 0x569d, 0xcc9e, 0x350b, 0x0, 0x0);
        gbc.writeMem(0xcd6a, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x62);
        EXPECT(gbc.b(),  0x56);
        EXPECT(gbc.c(),  0x9d);
        EXPECT(gbc.d(),  0xcc);
        EXPECT(gbc.e(),  0x9e);
        EXPECT(gbc.h(),  0x35);
        EXPECT(gbc.l(),  0xb);
        EXPECT(gbc.sp(), 0x4421);
        EXPECT(gbc.pc(), 0xcd6b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcd6a), 0x5b);
        // 5B 0310
        gbc.setState(0xb56, 0xc44a, 0x84d0, 0x84cb, 0xf8a, 0x789b, 0x1, 0x0);
        gbc.writeMem(0xb56, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x84);
        EXPECT(gbc.b(),  0x84);
        EXPECT(gbc.c(),  0xcb);
        EXPECT(gbc.d(),  0xf);
        EXPECT(gbc.e(),  0x8a);
        EXPECT(gbc.h(),  0x78);
        EXPECT(gbc.l(),  0x9b);
        EXPECT(gbc.sp(), 0xc44a);
        EXPECT(gbc.pc(), 0xb57);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 0311
        gbc.setState(0x3407, 0x491a, 0x7230, 0x5982, 0x4723, 0x1aaa, 0x0, 0x0);
        gbc.writeMem(0x3407, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x72);
        EXPECT(gbc.b(),  0x59);
        EXPECT(gbc.c(),  0x82);
        EXPECT(gbc.d(),  0x47);
        EXPECT(gbc.e(),  0x23);
        EXPECT(gbc.h(),  0x1a);
        EXPECT(gbc.l(),  0xaa);
        EXPECT(gbc.sp(), 0x491a);
        EXPECT(gbc.pc(), 0x3408);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0312
        gbc.setState(0x212d, 0x5a16, 0xaff0, 0xe263, 0x7bb9, 0x2cd7, 0x1, 0x0);
        gbc.writeMem(0x212d, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xaf);
        EXPECT(gbc.b(),  0xe2);
        EXPECT(gbc.c(),  0x63);
        EXPECT(gbc.d(),  0x7b);
        EXPECT(gbc.e(),  0xb9);
        EXPECT(gbc.h(),  0x2c);
        EXPECT(gbc.l(),  0xd7);
        EXPECT(gbc.sp(), 0x5a16);
        EXPECT(gbc.pc(), 0x212e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0313
        gbc.setState(0x5d58, 0x1e3d, 0x2220, 0x9e83, 0xad0c, 0x4323, 0x0, 0x0);
        gbc.writeMem(0x5d58, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x22);
        EXPECT(gbc.b(),  0x9e);
        EXPECT(gbc.c(),  0x83);
        EXPECT(gbc.d(),  0xad);
        EXPECT(gbc.e(),  0xc);
        EXPECT(gbc.h(),  0x43);
        EXPECT(gbc.l(),  0x23);
        EXPECT(gbc.sp(), 0x1e3d);
        EXPECT(gbc.pc(), 0x5d59);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0314
        gbc.setState(0x6589, 0x8347, 0xb0b0, 0x64bb, 0xd58a, 0x3570, 0x1, 0x0);
        gbc.writeMem(0x6589, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xb0);
        EXPECT(gbc.b(),  0x64);
        EXPECT(gbc.c(),  0xbb);
        EXPECT(gbc.d(),  0xd5);
        EXPECT(gbc.e(),  0x8a);
        EXPECT(gbc.h(),  0x35);
        EXPECT(gbc.l(),  0x70);
        EXPECT(gbc.sp(), 0x8347);
        EXPECT(gbc.pc(), 0x658a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0315
        gbc.setState(0xd908, 0xab03, 0xe6e0, 0x822e, 0x511f, 0xe0ee, 0x0, 0x0);
        gbc.writeMem(0xd908, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xe6);
        EXPECT(gbc.b(),  0x82);
        EXPECT(gbc.c(),  0x2e);
        EXPECT(gbc.d(),  0x51);
        EXPECT(gbc.e(),  0x1f);
        EXPECT(gbc.h(),  0xe0);
        EXPECT(gbc.l(),  0xee);
        EXPECT(gbc.sp(), 0xab03);
        EXPECT(gbc.pc(), 0xd909);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd908), 0x5b);
        // 5B 0316
        gbc.setState(0xe269, 0xecc2, 0xa90, 0x13e5, 0xe50b, 0xf29e, 0x0, 0x0);
        gbc.writeMem(0xe269, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa);
        EXPECT(gbc.b(),  0x13);
        EXPECT(gbc.c(),  0xe5);
        EXPECT(gbc.d(),  0xe5);
        EXPECT(gbc.e(),  0xb);
        EXPECT(gbc.h(),  0xf2);
        EXPECT(gbc.l(),  0x9e);
        EXPECT(gbc.sp(), 0xecc2);
        EXPECT(gbc.pc(), 0xe26a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe269), 0x5b);
        // 5B 0317
        gbc.setState(0xe7fd, 0x4bcd, 0xf6b0, 0xbe8c, 0xcc3, 0xa6ab, 0x0, 0x0);
        gbc.writeMem(0xe7fd, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf6);
        EXPECT(gbc.b(),  0xbe);
        EXPECT(gbc.c(),  0x8c);
        EXPECT(gbc.d(),  0xc);
        EXPECT(gbc.e(),  0xc3);
        EXPECT(gbc.h(),  0xa6);
        EXPECT(gbc.l(),  0xab);
        EXPECT(gbc.sp(), 0x4bcd);
        EXPECT(gbc.pc(), 0xe7fe);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe7fd), 0x5b);
        // 5B 0318
        gbc.setState(0x4c03, 0xbd10, 0x8c0, 0x34f2, 0x4fc5, 0xb496, 0x0, 0x1);
        gbc.writeMem(0x4c03, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0x34);
        EXPECT(gbc.c(),  0xf2);
        EXPECT(gbc.d(),  0x4f);
        EXPECT(gbc.e(),  0xc5);
        EXPECT(gbc.h(),  0xb4);
        EXPECT(gbc.l(),  0x96);
        EXPECT(gbc.sp(), 0xbd10);
        EXPECT(gbc.pc(), 0x4c04);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0319
        gbc.setState(0xd85c, 0x895c, 0x7ff0, 0xfec, 0x1831, 0x9261, 0x1, 0x1);
        gbc.writeMem(0xd85c, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x7f);
        EXPECT(gbc.b(),  0xf);
        EXPECT(gbc.c(),  0xec);
        EXPECT(gbc.d(),  0x18);
        EXPECT(gbc.e(),  0x31);
        EXPECT(gbc.h(),  0x92);
        EXPECT(gbc.l(),  0x61);
        EXPECT(gbc.sp(), 0x895c);
        EXPECT(gbc.pc(), 0xd85d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd85c), 0x5b);
        // 5B 031A
        gbc.setState(0x391e, 0x3787, 0x9240, 0x6189, 0xe578, 0x9272, 0x0, 0x1);
        gbc.writeMem(0x391e, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x92);
        EXPECT(gbc.b(),  0x61);
        EXPECT(gbc.c(),  0x89);
        EXPECT(gbc.d(),  0xe5);
        EXPECT(gbc.e(),  0x78);
        EXPECT(gbc.h(),  0x92);
        EXPECT(gbc.l(),  0x72);
        EXPECT(gbc.sp(), 0x3787);
        EXPECT(gbc.pc(), 0x391f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 031B
        gbc.setState(0x3e15, 0xfbe5, 0xa3a0, 0xb668, 0xa5d6, 0x25c4, 0x0, 0x1);
        gbc.writeMem(0x3e15, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa3);
        EXPECT(gbc.b(),  0xb6);
        EXPECT(gbc.c(),  0x68);
        EXPECT(gbc.d(),  0xa5);
        EXPECT(gbc.e(),  0xd6);
        EXPECT(gbc.h(),  0x25);
        EXPECT(gbc.l(),  0xc4);
        EXPECT(gbc.sp(), 0xfbe5);
        EXPECT(gbc.pc(), 0x3e16);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 031C
        gbc.setState(0x86b7, 0x3c5, 0xe830, 0x72f1, 0xa7ff, 0xa9f9, 0x1, 0x1);
        gbc.writeMem(0x86b7, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xe8);
        EXPECT(gbc.b(),  0x72);
        EXPECT(gbc.c(),  0xf1);
        EXPECT(gbc.d(),  0xa7);
        EXPECT(gbc.e(),  0xff);
        EXPECT(gbc.h(),  0xa9);
        EXPECT(gbc.l(),  0xf9);
        EXPECT(gbc.sp(), 0x3c5);
        EXPECT(gbc.pc(), 0x86b8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x86b7), 0x5b);
        // 5B 031D
        gbc.setState(0xc94a, 0xf454, 0x9cc0, 0x78df, 0x1415, 0xe2f2, 0x1, 0x1);
        gbc.writeMem(0xc94a, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x9c);
        EXPECT(gbc.b(),  0x78);
        EXPECT(gbc.c(),  0xdf);
        EXPECT(gbc.d(),  0x14);
        EXPECT(gbc.e(),  0x15);
        EXPECT(gbc.h(),  0xe2);
        EXPECT(gbc.l(),  0xf2);
        EXPECT(gbc.sp(), 0xf454);
        EXPECT(gbc.pc(), 0xc94b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc94a), 0x5b);
        // 5B 031E
        gbc.setState(0xa752, 0xc849, 0xbdd0, 0x4c5f, 0x641e, 0xd838, 0x1, 0x1);
        gbc.writeMem(0xa752, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xbd);
        EXPECT(gbc.b(),  0x4c);
        EXPECT(gbc.c(),  0x5f);
        EXPECT(gbc.d(),  0x64);
        EXPECT(gbc.e(),  0x1e);
        EXPECT(gbc.h(),  0xd8);
        EXPECT(gbc.l(),  0x38);
        EXPECT(gbc.sp(), 0xc849);
        EXPECT(gbc.pc(), 0xa753);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa752), 0x5b);
        // 5B 031F
        gbc.setState(0x30a2, 0x694d, 0x9140, 0x6c7c, 0x7dad, 0xd78b, 0x0, 0x0);
        gbc.writeMem(0x30a2, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x91);
        EXPECT(gbc.b(),  0x6c);
        EXPECT(gbc.c(),  0x7c);
        EXPECT(gbc.d(),  0x7d);
        EXPECT(gbc.e(),  0xad);
        EXPECT(gbc.h(),  0xd7);
        EXPECT(gbc.l(),  0x8b);
        EXPECT(gbc.sp(), 0x694d);
        EXPECT(gbc.pc(), 0x30a3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0320
        gbc.setState(0x8a2e, 0x529d, 0x580, 0x9abd, 0xea71, 0x88cf, 0x1, 0x1);
        gbc.writeMem(0x8a2e, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x5);
        EXPECT(gbc.b(),  0x9a);
        EXPECT(gbc.c(),  0xbd);
        EXPECT(gbc.d(),  0xea);
        EXPECT(gbc.e(),  0x71);
        EXPECT(gbc.h(),  0x88);
        EXPECT(gbc.l(),  0xcf);
        EXPECT(gbc.sp(), 0x529d);
        EXPECT(gbc.pc(), 0x8a2f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8a2e), 0x5b);
        // 5B 0321
        gbc.setState(0xb59d, 0x1391, 0xd0d0, 0xc26f, 0x9cf7, 0xb1f, 0x1, 0x0);
        gbc.writeMem(0xb59d, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd0);
        EXPECT(gbc.b(),  0xc2);
        EXPECT(gbc.c(),  0x6f);
        EXPECT(gbc.d(),  0x9c);
        EXPECT(gbc.e(),  0xf7);
        EXPECT(gbc.h(),  0xb);
        EXPECT(gbc.l(),  0x1f);
        EXPECT(gbc.sp(), 0x1391);
        EXPECT(gbc.pc(), 0xb59e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb59d), 0x5b);
        // 5B 0322
        gbc.setState(0xd1d3, 0x517d, 0xa80, 0xe697, 0x1185, 0x972, 0x1, 0x1);
        gbc.writeMem(0xd1d3, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa);
        EXPECT(gbc.b(),  0xe6);
        EXPECT(gbc.c(),  0x97);
        EXPECT(gbc.d(),  0x11);
        EXPECT(gbc.e(),  0x85);
        EXPECT(gbc.h(),  0x9);
        EXPECT(gbc.l(),  0x72);
        EXPECT(gbc.sp(), 0x517d);
        EXPECT(gbc.pc(), 0xd1d4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd1d3), 0x5b);
        // 5B 0323
        gbc.setState(0xa88d, 0x32ce, 0x6da0, 0x2cd7, 0x7785, 0xc984, 0x0, 0x0);
        gbc.writeMem(0xa88d, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x6d);
        EXPECT(gbc.b(),  0x2c);
        EXPECT(gbc.c(),  0xd7);
        EXPECT(gbc.d(),  0x77);
        EXPECT(gbc.e(),  0x85);
        EXPECT(gbc.h(),  0xc9);
        EXPECT(gbc.l(),  0x84);
        EXPECT(gbc.sp(), 0x32ce);
        EXPECT(gbc.pc(), 0xa88e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa88d), 0x5b);
        // 5B 0324
        gbc.setState(0x3bbc, 0xf5a5, 0xcd00, 0xb2f8, 0x39c3, 0x3600, 0x1, 0x0);
        gbc.writeMem(0x3bbc, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xcd);
        EXPECT(gbc.b(),  0xb2);
        EXPECT(gbc.c(),  0xf8);
        EXPECT(gbc.d(),  0x39);
        EXPECT(gbc.e(),  0xc3);
        EXPECT(gbc.h(),  0x36);
        EXPECT(gbc.l(),  0x0);
        EXPECT(gbc.sp(), 0xf5a5);
        EXPECT(gbc.pc(), 0x3bbd);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0325
        gbc.setState(0x4fbf, 0x9158, 0x61e0, 0x35cd, 0x7378, 0x8007, 0x1, 0x1);
        gbc.writeMem(0x4fbf, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x61);
        EXPECT(gbc.b(),  0x35);
        EXPECT(gbc.c(),  0xcd);
        EXPECT(gbc.d(),  0x73);
        EXPECT(gbc.e(),  0x78);
        EXPECT(gbc.h(),  0x80);
        EXPECT(gbc.l(),  0x7);
        EXPECT(gbc.sp(), 0x9158);
        EXPECT(gbc.pc(), 0x4fc0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0326
        gbc.setState(0x48d, 0xdab7, 0xac0, 0x655a, 0xb785, 0xbdc, 0x0, 0x0);
        gbc.writeMem(0x48d, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa);
        EXPECT(gbc.b(),  0x65);
        EXPECT(gbc.c(),  0x5a);
        EXPECT(gbc.d(),  0xb7);
        EXPECT(gbc.e(),  0x85);
        EXPECT(gbc.h(),  0xb);
        EXPECT(gbc.l(),  0xdc);
        EXPECT(gbc.sp(), 0xdab7);
        EXPECT(gbc.pc(), 0x48e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0327
        gbc.setState(0xe4fd, 0x48c1, 0x2870, 0x26eb, 0xf614, 0xe646, 0x1, 0x0);
        gbc.writeMem(0xe4fd, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0x26);
        EXPECT(gbc.c(),  0xeb);
        EXPECT(gbc.d(),  0xf6);
        EXPECT(gbc.e(),  0x14);
        EXPECT(gbc.h(),  0xe6);
        EXPECT(gbc.l(),  0x46);
        EXPECT(gbc.sp(), 0x48c1);
        EXPECT(gbc.pc(), 0xe4fe);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe4fd), 0x5b);
        // 5B 0328
        gbc.setState(0x7c09, 0x5018, 0xb580, 0xf18b, 0xfece, 0x3e65, 0x1, 0x1);
        gbc.writeMem(0x7c09, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xb5);
        EXPECT(gbc.b(),  0xf1);
        EXPECT(gbc.c(),  0x8b);
        EXPECT(gbc.d(),  0xfe);
        EXPECT(gbc.e(),  0xce);
        EXPECT(gbc.h(),  0x3e);
        EXPECT(gbc.l(),  0x65);
        EXPECT(gbc.sp(), 0x5018);
        EXPECT(gbc.pc(), 0x7c0a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0329
        gbc.setState(0x2464, 0x19b, 0xf2c0, 0x39a4, 0x332b, 0x53a7, 0x0, 0x1);
        gbc.writeMem(0x2464, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf2);
        EXPECT(gbc.b(),  0x39);
        EXPECT(gbc.c(),  0xa4);
        EXPECT(gbc.d(),  0x33);
        EXPECT(gbc.e(),  0x2b);
        EXPECT(gbc.h(),  0x53);
        EXPECT(gbc.l(),  0xa7);
        EXPECT(gbc.sp(), 0x19b);
        EXPECT(gbc.pc(), 0x2465);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 032A
        gbc.setState(0xc1c4, 0xf209, 0x9f50, 0xc5a2, 0x7176, 0x588f, 0x0, 0x1);
        gbc.writeMem(0xc1c4, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x9f);
        EXPECT(gbc.b(),  0xc5);
        EXPECT(gbc.c(),  0xa2);
        EXPECT(gbc.d(),  0x71);
        EXPECT(gbc.e(),  0x76);
        EXPECT(gbc.h(),  0x58);
        EXPECT(gbc.l(),  0x8f);
        EXPECT(gbc.sp(), 0xf209);
        EXPECT(gbc.pc(), 0xc1c5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc1c4), 0x5b);
        // 5B 032B
        gbc.setState(0x9219, 0xaa37, 0xd2b0, 0x9c65, 0xbf8c, 0xa26f, 0x1, 0x0);
        gbc.writeMem(0x9219, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd2);
        EXPECT(gbc.b(),  0x9c);
        EXPECT(gbc.c(),  0x65);
        EXPECT(gbc.d(),  0xbf);
        EXPECT(gbc.e(),  0x8c);
        EXPECT(gbc.h(),  0xa2);
        EXPECT(gbc.l(),  0x6f);
        EXPECT(gbc.sp(), 0xaa37);
        EXPECT(gbc.pc(), 0x921a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9219), 0x5b);
        // 5B 032C
        gbc.setState(0x86ab, 0x489c, 0x7860, 0xa654, 0xd6e0, 0x4ca3, 0x0, 0x0);
        gbc.writeMem(0x86ab, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x78);
        EXPECT(gbc.b(),  0xa6);
        EXPECT(gbc.c(),  0x54);
        EXPECT(gbc.d(),  0xd6);
        EXPECT(gbc.e(),  0xe0);
        EXPECT(gbc.h(),  0x4c);
        EXPECT(gbc.l(),  0xa3);
        EXPECT(gbc.sp(), 0x489c);
        EXPECT(gbc.pc(), 0x86ac);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x86ab), 0x5b);
        // 5B 032D
        gbc.setState(0xce32, 0x4eaa, 0x2170, 0x26b1, 0x6300, 0x68b5, 0x1, 0x1);
        gbc.writeMem(0xce32, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x21);
        EXPECT(gbc.b(),  0x26);
        EXPECT(gbc.c(),  0xb1);
        EXPECT(gbc.d(),  0x63);
        EXPECT(gbc.e(),  0x0);
        EXPECT(gbc.h(),  0x68);
        EXPECT(gbc.l(),  0xb5);
        EXPECT(gbc.sp(), 0x4eaa);
        EXPECT(gbc.pc(), 0xce33);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xce32), 0x5b);
        // 5B 032E
        gbc.setState(0x80a7, 0xe705, 0x6440, 0xee8c, 0x4b38, 0x5854, 0x0, 0x1);
        gbc.writeMem(0x80a7, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x64);
        EXPECT(gbc.b(),  0xee);
        EXPECT(gbc.c(),  0x8c);
        EXPECT(gbc.d(),  0x4b);
        EXPECT(gbc.e(),  0x38);
        EXPECT(gbc.h(),  0x58);
        EXPECT(gbc.l(),  0x54);
        EXPECT(gbc.sp(), 0xe705);
        EXPECT(gbc.pc(), 0x80a8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x80a7), 0x5b);
        // 5B 032F
        gbc.setState(0x618e, 0xab7c, 0x2b20, 0xf4a9, 0xc15f, 0x5c1d, 0x1, 0x1);
        gbc.writeMem(0x618e, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x2b);
        EXPECT(gbc.b(),  0xf4);
        EXPECT(gbc.c(),  0xa9);
        EXPECT(gbc.d(),  0xc1);
        EXPECT(gbc.e(),  0x5f);
        EXPECT(gbc.h(),  0x5c);
        EXPECT(gbc.l(),  0x1d);
        EXPECT(gbc.sp(), 0xab7c);
        EXPECT(gbc.pc(), 0x618f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0330
        gbc.setState(0x3403, 0x3053, 0x7a30, 0x89b9, 0x9519, 0x60fb, 0x0, 0x0);
        gbc.writeMem(0x3403, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x7a);
        EXPECT(gbc.b(),  0x89);
        EXPECT(gbc.c(),  0xb9);
        EXPECT(gbc.d(),  0x95);
        EXPECT(gbc.e(),  0x19);
        EXPECT(gbc.h(),  0x60);
        EXPECT(gbc.l(),  0xfb);
        EXPECT(gbc.sp(), 0x3053);
        EXPECT(gbc.pc(), 0x3404);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0331
        gbc.setState(0xbb98, 0xb060, 0xf720, 0x1267, 0xb76a, 0xf5e0, 0x0, 0x1);
        gbc.writeMem(0xbb98, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf7);
        EXPECT(gbc.b(),  0x12);
        EXPECT(gbc.c(),  0x67);
        EXPECT(gbc.d(),  0xb7);
        EXPECT(gbc.e(),  0x6a);
        EXPECT(gbc.h(),  0xf5);
        EXPECT(gbc.l(),  0xe0);
        EXPECT(gbc.sp(), 0xb060);
        EXPECT(gbc.pc(), 0xbb99);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbb98), 0x5b);
        // 5B 0332
        gbc.setState(0x253d, 0x8108, 0x420, 0x34e1, 0xb5de, 0x83ef, 0x0, 0x1);
        gbc.writeMem(0x253d, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0x34);
        EXPECT(gbc.c(),  0xe1);
        EXPECT(gbc.d(),  0xb5);
        EXPECT(gbc.e(),  0xde);
        EXPECT(gbc.h(),  0x83);
        EXPECT(gbc.l(),  0xef);
        EXPECT(gbc.sp(), 0x8108);
        EXPECT(gbc.pc(), 0x253e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0333
        gbc.setState(0xd745, 0xe22, 0x38b0, 0x4da7, 0xa76d, 0x178b, 0x1, 0x1);
        gbc.writeMem(0xd745, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x38);
        EXPECT(gbc.b(),  0x4d);
        EXPECT(gbc.c(),  0xa7);
        EXPECT(gbc.d(),  0xa7);
        EXPECT(gbc.e(),  0x6d);
        EXPECT(gbc.h(),  0x17);
        EXPECT(gbc.l(),  0x8b);
        EXPECT(gbc.sp(), 0xe22);
        EXPECT(gbc.pc(), 0xd746);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd745), 0x5b);
        // 5B 0334
        gbc.setState(0xeed2, 0xb106, 0x6920, 0xf3df, 0xce7f, 0x16ad, 0x0, 0x1);
        gbc.writeMem(0xeed2, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x69);
        EXPECT(gbc.b(),  0xf3);
        EXPECT(gbc.c(),  0xdf);
        EXPECT(gbc.d(),  0xce);
        EXPECT(gbc.e(),  0x7f);
        EXPECT(gbc.h(),  0x16);
        EXPECT(gbc.l(),  0xad);
        EXPECT(gbc.sp(), 0xb106);
        EXPECT(gbc.pc(), 0xeed3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xeed2), 0x5b);
        // 5B 0335
        gbc.setState(0xa2d2, 0xb0eb, 0x8690, 0xf0ce, 0xd871, 0x4561, 0x1, 0x0);
        gbc.writeMem(0xa2d2, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x86);
        EXPECT(gbc.b(),  0xf0);
        EXPECT(gbc.c(),  0xce);
        EXPECT(gbc.d(),  0xd8);
        EXPECT(gbc.e(),  0x71);
        EXPECT(gbc.h(),  0x45);
        EXPECT(gbc.l(),  0x61);
        EXPECT(gbc.sp(), 0xb0eb);
        EXPECT(gbc.pc(), 0xa2d3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa2d2), 0x5b);
        // 5B 0336
        gbc.setState(0xd594, 0xc79e, 0xc740, 0x6ab7, 0xe712, 0xa446, 0x1, 0x0);
        gbc.writeMem(0xd594, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xc7);
        EXPECT(gbc.b(),  0x6a);
        EXPECT(gbc.c(),  0xb7);
        EXPECT(gbc.d(),  0xe7);
        EXPECT(gbc.e(),  0x12);
        EXPECT(gbc.h(),  0xa4);
        EXPECT(gbc.l(),  0x46);
        EXPECT(gbc.sp(), 0xc79e);
        EXPECT(gbc.pc(), 0xd595);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd594), 0x5b);
        // 5B 0337
        gbc.setState(0xbb62, 0x6e44, 0x7460, 0x81f6, 0xdc64, 0xab9b, 0x0, 0x0);
        gbc.writeMem(0xbb62, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x74);
        EXPECT(gbc.b(),  0x81);
        EXPECT(gbc.c(),  0xf6);
        EXPECT(gbc.d(),  0xdc);
        EXPECT(gbc.e(),  0x64);
        EXPECT(gbc.h(),  0xab);
        EXPECT(gbc.l(),  0x9b);
        EXPECT(gbc.sp(), 0x6e44);
        EXPECT(gbc.pc(), 0xbb63);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbb62), 0x5b);
        // 5B 0338
        gbc.setState(0xe401, 0xf65f, 0xdc10, 0xd438, 0xfe3b, 0x66f8, 0x0, 0x1);
        gbc.writeMem(0xe401, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xdc);
        EXPECT(gbc.b(),  0xd4);
        EXPECT(gbc.c(),  0x38);
        EXPECT(gbc.d(),  0xfe);
        EXPECT(gbc.e(),  0x3b);
        EXPECT(gbc.h(),  0x66);
        EXPECT(gbc.l(),  0xf8);
        EXPECT(gbc.sp(), 0xf65f);
        EXPECT(gbc.pc(), 0xe402);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe401), 0x5b);
        // 5B 0339
        gbc.setState(0x711a, 0xbc68, 0xaa50, 0x8a52, 0xd9c8, 0x6752, 0x1, 0x1);
        gbc.writeMem(0x711a, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xaa);
        EXPECT(gbc.b(),  0x8a);
        EXPECT(gbc.c(),  0x52);
        EXPECT(gbc.d(),  0xd9);
        EXPECT(gbc.e(),  0xc8);
        EXPECT(gbc.h(),  0x67);
        EXPECT(gbc.l(),  0x52);
        EXPECT(gbc.sp(), 0xbc68);
        EXPECT(gbc.pc(), 0x711b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 033A
        gbc.setState(0xe8b8, 0xfaf, 0xdac0, 0x674, 0x9591, 0x4ef5, 0x0, 0x1);
        gbc.writeMem(0xe8b8, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xda);
        EXPECT(gbc.b(),  0x6);
        EXPECT(gbc.c(),  0x74);
        EXPECT(gbc.d(),  0x95);
        EXPECT(gbc.e(),  0x91);
        EXPECT(gbc.h(),  0x4e);
        EXPECT(gbc.l(),  0xf5);
        EXPECT(gbc.sp(), 0xfaf);
        EXPECT(gbc.pc(), 0xe8b9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe8b8), 0x5b);
        // 5B 033B
        gbc.setState(0xe8f1, 0x5c00, 0x95c0, 0xb37d, 0x24e6, 0x5dc3, 0x1, 0x1);
        gbc.writeMem(0xe8f1, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x95);
        EXPECT(gbc.b(),  0xb3);
        EXPECT(gbc.c(),  0x7d);
        EXPECT(gbc.d(),  0x24);
        EXPECT(gbc.e(),  0xe6);
        EXPECT(gbc.h(),  0x5d);
        EXPECT(gbc.l(),  0xc3);
        EXPECT(gbc.sp(), 0x5c00);
        EXPECT(gbc.pc(), 0xe8f2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe8f1), 0x5b);
        // 5B 033D
        gbc.setState(0xb00a, 0xf564, 0xd1c0, 0x13e0, 0xcc4c, 0xcd1, 0x1, 0x0);
        gbc.writeMem(0xb00a, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd1);
        EXPECT(gbc.b(),  0x13);
        EXPECT(gbc.c(),  0xe0);
        EXPECT(gbc.d(),  0xcc);
        EXPECT(gbc.e(),  0x4c);
        EXPECT(gbc.h(),  0xc);
        EXPECT(gbc.l(),  0xd1);
        EXPECT(gbc.sp(), 0xf564);
        EXPECT(gbc.pc(), 0xb00b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb00a), 0x5b);
        // 5B 033E
        gbc.setState(0x6dca, 0xceed, 0xa970, 0xc349, 0xfb3e, 0xf348, 0x1, 0x0);
        gbc.writeMem(0x6dca, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa9);
        EXPECT(gbc.b(),  0xc3);
        EXPECT(gbc.c(),  0x49);
        EXPECT(gbc.d(),  0xfb);
        EXPECT(gbc.e(),  0x3e);
        EXPECT(gbc.h(),  0xf3);
        EXPECT(gbc.l(),  0x48);
        EXPECT(gbc.sp(), 0xceed);
        EXPECT(gbc.pc(), 0x6dcb);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 033F
        gbc.setState(0x7b02, 0xf59d, 0xbbf0, 0x644d, 0x1840, 0x985e, 0x1, 0x0);
        gbc.writeMem(0x7b02, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xbb);
        EXPECT(gbc.b(),  0x64);
        EXPECT(gbc.c(),  0x4d);
        EXPECT(gbc.d(),  0x18);
        EXPECT(gbc.e(),  0x40);
        EXPECT(gbc.h(),  0x98);
        EXPECT(gbc.l(),  0x5e);
        EXPECT(gbc.sp(), 0xf59d);
        EXPECT(gbc.pc(), 0x7b03);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0340
        gbc.setState(0xd16d, 0xda31, 0x5c10, 0xa9ca, 0x5f91, 0xc5b5, 0x1, 0x0);
        gbc.writeMem(0xd16d, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x5c);
        EXPECT(gbc.b(),  0xa9);
        EXPECT(gbc.c(),  0xca);
        EXPECT(gbc.d(),  0x5f);
        EXPECT(gbc.e(),  0x91);
        EXPECT(gbc.h(),  0xc5);
        EXPECT(gbc.l(),  0xb5);
        EXPECT(gbc.sp(), 0xda31);
        EXPECT(gbc.pc(), 0xd16e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd16d), 0x5b);
        // 5B 0341
        gbc.setState(0x7ad7, 0x5043, 0x9c80, 0xe11b, 0x31da, 0x2b82, 0x1, 0x0);
        gbc.writeMem(0x7ad7, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x9c);
        EXPECT(gbc.b(),  0xe1);
        EXPECT(gbc.c(),  0x1b);
        EXPECT(gbc.d(),  0x31);
        EXPECT(gbc.e(),  0xda);
        EXPECT(gbc.h(),  0x2b);
        EXPECT(gbc.l(),  0x82);
        EXPECT(gbc.sp(), 0x5043);
        EXPECT(gbc.pc(), 0x7ad8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0342
        gbc.setState(0x5770, 0xaf02, 0x5cf0, 0xaa55, 0x1d5b, 0x3248, 0x1, 0x0);
        gbc.writeMem(0x5770, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x5c);
        EXPECT(gbc.b(),  0xaa);
        EXPECT(gbc.c(),  0x55);
        EXPECT(gbc.d(),  0x1d);
        EXPECT(gbc.e(),  0x5b);
        EXPECT(gbc.h(),  0x32);
        EXPECT(gbc.l(),  0x48);
        EXPECT(gbc.sp(), 0xaf02);
        EXPECT(gbc.pc(), 0x5771);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0344
        gbc.setState(0xc6d3, 0x55d3, 0x540, 0x31f1, 0xa125, 0x6a20, 0x1, 0x0);
        gbc.writeMem(0xc6d3, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x5);
        EXPECT(gbc.b(),  0x31);
        EXPECT(gbc.c(),  0xf1);
        EXPECT(gbc.d(),  0xa1);
        EXPECT(gbc.e(),  0x25);
        EXPECT(gbc.h(),  0x6a);
        EXPECT(gbc.l(),  0x20);
        EXPECT(gbc.sp(), 0x55d3);
        EXPECT(gbc.pc(), 0xc6d4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc6d3), 0x5b);
        // 5B 0345
        gbc.setState(0xc914, 0x3bb6, 0x2be0, 0x51f1, 0x5bfd, 0xefe9, 0x1, 0x0);
        gbc.writeMem(0xc914, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x2b);
        EXPECT(gbc.b(),  0x51);
        EXPECT(gbc.c(),  0xf1);
        EXPECT(gbc.d(),  0x5b);
        EXPECT(gbc.e(),  0xfd);
        EXPECT(gbc.h(),  0xef);
        EXPECT(gbc.l(),  0xe9);
        EXPECT(gbc.sp(), 0x3bb6);
        EXPECT(gbc.pc(), 0xc915);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc914), 0x5b);
        // 5B 0346
        gbc.setState(0x76fc, 0xc17f, 0xc0, 0xd0e4, 0x15da, 0x9793, 0x1, 0x1);
        gbc.writeMem(0x76fc, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0xd0);
        EXPECT(gbc.c(),  0xe4);
        EXPECT(gbc.d(),  0x15);
        EXPECT(gbc.e(),  0xda);
        EXPECT(gbc.h(),  0x97);
        EXPECT(gbc.l(),  0x93);
        EXPECT(gbc.sp(), 0xc17f);
        EXPECT(gbc.pc(), 0x76fd);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0347
        gbc.setState(0xa99a, 0x6924, 0xa700, 0x30fe, 0x43ca, 0x95d3, 0x1, 0x1);
        gbc.writeMem(0xa99a, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa7);
        EXPECT(gbc.b(),  0x30);
        EXPECT(gbc.c(),  0xfe);
        EXPECT(gbc.d(),  0x43);
        EXPECT(gbc.e(),  0xca);
        EXPECT(gbc.h(),  0x95);
        EXPECT(gbc.l(),  0xd3);
        EXPECT(gbc.sp(), 0x6924);
        EXPECT(gbc.pc(), 0xa99b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa99a), 0x5b);
        // 5B 0348
        gbc.setState(0x882e, 0xb528, 0xb180, 0xb2f, 0xb750, 0x2a3b, 0x1, 0x0);
        gbc.writeMem(0x882e, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xb1);
        EXPECT(gbc.b(),  0xb);
        EXPECT(gbc.c(),  0x2f);
        EXPECT(gbc.d(),  0xb7);
        EXPECT(gbc.e(),  0x50);
        EXPECT(gbc.h(),  0x2a);
        EXPECT(gbc.l(),  0x3b);
        EXPECT(gbc.sp(), 0xb528);
        EXPECT(gbc.pc(), 0x882f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x882e), 0x5b);
        // 5B 0349
        gbc.setState(0x5da0, 0x58a6, 0x7630, 0x256, 0xeef8, 0x302a, 0x0, 0x1);
        gbc.writeMem(0x5da0, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x76);
        EXPECT(gbc.b(),  0x2);
        EXPECT(gbc.c(),  0x56);
        EXPECT(gbc.d(),  0xee);
        EXPECT(gbc.e(),  0xf8);
        EXPECT(gbc.h(),  0x30);
        EXPECT(gbc.l(),  0x2a);
        EXPECT(gbc.sp(), 0x58a6);
        EXPECT(gbc.pc(), 0x5da1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 034A
        gbc.setState(0x2bf9, 0xfcf4, 0x86c0, 0xf256, 0x3092, 0x13c6, 0x0, 0x0);
        gbc.writeMem(0x2bf9, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x86);
        EXPECT(gbc.b(),  0xf2);
        EXPECT(gbc.c(),  0x56);
        EXPECT(gbc.d(),  0x30);
        EXPECT(gbc.e(),  0x92);
        EXPECT(gbc.h(),  0x13);
        EXPECT(gbc.l(),  0xc6);
        EXPECT(gbc.sp(), 0xfcf4);
        EXPECT(gbc.pc(), 0x2bfa);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 034B
        gbc.setState(0x4945, 0xc989, 0x2ed0, 0x20a4, 0xad52, 0xd600, 0x1, 0x0);
        gbc.writeMem(0x4945, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x2e);
        EXPECT(gbc.b(),  0x20);
        EXPECT(gbc.c(),  0xa4);
        EXPECT(gbc.d(),  0xad);
        EXPECT(gbc.e(),  0x52);
        EXPECT(gbc.h(),  0xd6);
        EXPECT(gbc.l(),  0x0);
        EXPECT(gbc.sp(), 0xc989);
        EXPECT(gbc.pc(), 0x4946);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 034C
        gbc.setState(0x79ec, 0x9c72, 0xbe80, 0xc167, 0xa411, 0x2cdb, 0x0, 0x1);
        gbc.writeMem(0x79ec, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xbe);
        EXPECT(gbc.b(),  0xc1);
        EXPECT(gbc.c(),  0x67);
        EXPECT(gbc.d(),  0xa4);
        EXPECT(gbc.e(),  0x11);
        EXPECT(gbc.h(),  0x2c);
        EXPECT(gbc.l(),  0xdb);
        EXPECT(gbc.sp(), 0x9c72);
        EXPECT(gbc.pc(), 0x79ed);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 034D
        gbc.setState(0xcfff, 0x55f3, 0xd5a0, 0xc5dc, 0xc6e1, 0x76c7, 0x0, 0x1);
        gbc.writeMem(0xcfff, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd5);
        EXPECT(gbc.b(),  0xc5);
        EXPECT(gbc.c(),  0xdc);
        EXPECT(gbc.d(),  0xc6);
        EXPECT(gbc.e(),  0xe1);
        EXPECT(gbc.h(),  0x76);
        EXPECT(gbc.l(),  0xc7);
        EXPECT(gbc.sp(), 0x55f3);
        EXPECT(gbc.pc(), 0xd000);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcfff), 0x5b);
        // 5B 034E
        gbc.setState(0x681e, 0x1e9, 0x73e0, 0x94ad, 0x86ee, 0x2fd7, 0x1, 0x1);
        gbc.writeMem(0x681e, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x73);
        EXPECT(gbc.b(),  0x94);
        EXPECT(gbc.c(),  0xad);
        EXPECT(gbc.d(),  0x86);
        EXPECT(gbc.e(),  0xee);
        EXPECT(gbc.h(),  0x2f);
        EXPECT(gbc.l(),  0xd7);
        EXPECT(gbc.sp(), 0x1e9);
        EXPECT(gbc.pc(), 0x681f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 034F
        gbc.setState(0xe93, 0x4bb, 0x4c00, 0xd899, 0x52f, 0x1c25, 0x1, 0x1);
        gbc.writeMem(0xe93, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x4c);
        EXPECT(gbc.b(),  0xd8);
        EXPECT(gbc.c(),  0x99);
        EXPECT(gbc.d(),  0x5);
        EXPECT(gbc.e(),  0x2f);
        EXPECT(gbc.h(),  0x1c);
        EXPECT(gbc.l(),  0x25);
        EXPECT(gbc.sp(), 0x4bb);
        EXPECT(gbc.pc(), 0xe94);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0350
        gbc.setState(0xc0b5, 0x3644, 0xc810, 0x42c8, 0x5c0c, 0x1bb5, 0x0, 0x1);
        gbc.writeMem(0xc0b5, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xc8);
        EXPECT(gbc.b(),  0x42);
        EXPECT(gbc.c(),  0xc8);
        EXPECT(gbc.d(),  0x5c);
        EXPECT(gbc.e(),  0xc);
        EXPECT(gbc.h(),  0x1b);
        EXPECT(gbc.l(),  0xb5);
        EXPECT(gbc.sp(), 0x3644);
        EXPECT(gbc.pc(), 0xc0b6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc0b5), 0x5b);
        // 5B 0351
        gbc.setState(0x7895, 0x3ed0, 0xacb0, 0x490f, 0xbbfe, 0xc35a, 0x0, 0x1);
        gbc.writeMem(0x7895, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xac);
        EXPECT(gbc.b(),  0x49);
        EXPECT(gbc.c(),  0xf);
        EXPECT(gbc.d(),  0xbb);
        EXPECT(gbc.e(),  0xfe);
        EXPECT(gbc.h(),  0xc3);
        EXPECT(gbc.l(),  0x5a);
        EXPECT(gbc.sp(), 0x3ed0);
        EXPECT(gbc.pc(), 0x7896);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0352
        gbc.setState(0x4c7, 0xe54, 0x6340, 0x9b0c, 0xa017, 0xefc3, 0x1, 0x1);
        gbc.writeMem(0x4c7, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x63);
        EXPECT(gbc.b(),  0x9b);
        EXPECT(gbc.c(),  0xc);
        EXPECT(gbc.d(),  0xa0);
        EXPECT(gbc.e(),  0x17);
        EXPECT(gbc.h(),  0xef);
        EXPECT(gbc.l(),  0xc3);
        EXPECT(gbc.sp(), 0xe54);
        EXPECT(gbc.pc(), 0x4c8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0353
        gbc.setState(0xe986, 0x26c8, 0x8860, 0xee5b, 0xb681, 0x6e30, 0x0, 0x0);
        gbc.writeMem(0xe986, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x88);
        EXPECT(gbc.b(),  0xee);
        EXPECT(gbc.c(),  0x5b);
        EXPECT(gbc.d(),  0xb6);
        EXPECT(gbc.e(),  0x81);
        EXPECT(gbc.h(),  0x6e);
        EXPECT(gbc.l(),  0x30);
        EXPECT(gbc.sp(), 0x26c8);
        EXPECT(gbc.pc(), 0xe987);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe986), 0x5b);
        // 5B 0354
        gbc.setState(0x1c03, 0x9a22, 0x530, 0xadcd, 0xa52a, 0x65b9, 0x1, 0x1);
        gbc.writeMem(0x1c03, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x5);
        EXPECT(gbc.b(),  0xad);
        EXPECT(gbc.c(),  0xcd);
        EXPECT(gbc.d(),  0xa5);
        EXPECT(gbc.e(),  0x2a);
        EXPECT(gbc.h(),  0x65);
        EXPECT(gbc.l(),  0xb9);
        EXPECT(gbc.sp(), 0x9a22);
        EXPECT(gbc.pc(), 0x1c04);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0355
        gbc.setState(0x2063, 0x852e, 0x67d0, 0x9ac2, 0xe79, 0xe82, 0x0, 0x1);
        gbc.writeMem(0x2063, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x67);
        EXPECT(gbc.b(),  0x9a);
        EXPECT(gbc.c(),  0xc2);
        EXPECT(gbc.d(),  0xe);
        EXPECT(gbc.e(),  0x79);
        EXPECT(gbc.h(),  0xe);
        EXPECT(gbc.l(),  0x82);
        EXPECT(gbc.sp(), 0x852e);
        EXPECT(gbc.pc(), 0x2064);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 0356
        gbc.setState(0xddc2, 0x156c, 0xc160, 0x91c6, 0x57c8, 0x6d0f, 0x0, 0x1);
        gbc.writeMem(0xddc2, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xc1);
        EXPECT(gbc.b(),  0x91);
        EXPECT(gbc.c(),  0xc6);
        EXPECT(gbc.d(),  0x57);
        EXPECT(gbc.e(),  0xc8);
        EXPECT(gbc.h(),  0x6d);
        EXPECT(gbc.l(),  0xf);
        EXPECT(gbc.sp(), 0x156c);
        EXPECT(gbc.pc(), 0xddc3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xddc2), 0x5b);
        // 5B 0357
        gbc.setState(0x405b, 0x671e, 0xc90, 0x5d08, 0x380c, 0x7727, 0x1, 0x1);
        gbc.writeMem(0x405b, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xc);
        EXPECT(gbc.b(),  0x5d);
        EXPECT(gbc.c(),  0x8);
        EXPECT(gbc.d(),  0x38);
        EXPECT(gbc.e(),  0xc);
        EXPECT(gbc.h(),  0x77);
        EXPECT(gbc.l(),  0x27);
        EXPECT(gbc.sp(), 0x671e);
        EXPECT(gbc.pc(), 0x405c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 0358
        gbc.setState(0x6f43, 0xa454, 0xf350, 0xc04e, 0x70a, 0x2382, 0x1, 0x0);
        gbc.writeMem(0x6f43, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf3);
        EXPECT(gbc.b(),  0xc0);
        EXPECT(gbc.c(),  0x4e);
        EXPECT(gbc.d(),  0x7);
        EXPECT(gbc.e(),  0xa);
        EXPECT(gbc.h(),  0x23);
        EXPECT(gbc.l(),  0x82);
        EXPECT(gbc.sp(), 0xa454);
        EXPECT(gbc.pc(), 0x6f44);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 0359
        gbc.setState(0x5827, 0xe76e, 0x4fa0, 0xdab2, 0x7ff, 0x1f4e, 0x1, 0x1);
        gbc.writeMem(0x5827, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x4f);
        EXPECT(gbc.b(),  0xda);
        EXPECT(gbc.c(),  0xb2);
        EXPECT(gbc.d(),  0x7);
        EXPECT(gbc.e(),  0xff);
        EXPECT(gbc.h(),  0x1f);
        EXPECT(gbc.l(),  0x4e);
        EXPECT(gbc.sp(), 0xe76e);
        EXPECT(gbc.pc(), 0x5828);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 035A
        gbc.setState(0xba3, 0xbc9e, 0x63a0, 0x39ec, 0xd3, 0x19fb, 0x0, 0x1);
        gbc.writeMem(0xba3, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x63);
        EXPECT(gbc.b(),  0x39);
        EXPECT(gbc.c(),  0xec);
        EXPECT(gbc.d(),  0x0);
        EXPECT(gbc.e(),  0xd3);
        EXPECT(gbc.h(),  0x19);
        EXPECT(gbc.l(),  0xfb);
        EXPECT(gbc.sp(), 0xbc9e);
        EXPECT(gbc.pc(), 0xba4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 035B
        gbc.setState(0xdd53, 0xa07d, 0x7f80, 0xe468, 0x9c6d, 0x541a, 0x0, 0x1);
        gbc.writeMem(0xdd53, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x7f);
        EXPECT(gbc.b(),  0xe4);
        EXPECT(gbc.c(),  0x68);
        EXPECT(gbc.d(),  0x9c);
        EXPECT(gbc.e(),  0x6d);
        EXPECT(gbc.h(),  0x54);
        EXPECT(gbc.l(),  0x1a);
        EXPECT(gbc.sp(), 0xa07d);
        EXPECT(gbc.pc(), 0xdd54);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdd53), 0x5b);
        // 5B 035D
        gbc.setState(0x5201, 0x4558, 0x1610, 0x3497, 0xe17a, 0x5153, 0x0, 0x0);
        gbc.writeMem(0x5201, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x16);
        EXPECT(gbc.b(),  0x34);
        EXPECT(gbc.c(),  0x97);
        EXPECT(gbc.d(),  0xe1);
        EXPECT(gbc.e(),  0x7a);
        EXPECT(gbc.h(),  0x51);
        EXPECT(gbc.l(),  0x53);
        EXPECT(gbc.sp(), 0x4558);
        EXPECT(gbc.pc(), 0x5202);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 035E
        gbc.setState(0xa9f3, 0x6458, 0xa000, 0x5cf2, 0x531d, 0x9a55, 0x0, 0x1);
        gbc.writeMem(0xa9f3, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa0);
        EXPECT(gbc.b(),  0x5c);
        EXPECT(gbc.c(),  0xf2);
        EXPECT(gbc.d(),  0x53);
        EXPECT(gbc.e(),  0x1d);
        EXPECT(gbc.h(),  0x9a);
        EXPECT(gbc.l(),  0x55);
        EXPECT(gbc.sp(), 0x6458);
        EXPECT(gbc.pc(), 0xa9f4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa9f3), 0x5b);
        // 5B 035F
        gbc.setState(0x93c5, 0x435, 0x2e10, 0x24a1, 0x72f7, 0x808d, 0x0, 0x1);
        gbc.writeMem(0x93c5, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x2e);
        EXPECT(gbc.b(),  0x24);
        EXPECT(gbc.c(),  0xa1);
        EXPECT(gbc.d(),  0x72);
        EXPECT(gbc.e(),  0xf7);
        EXPECT(gbc.h(),  0x80);
        EXPECT(gbc.l(),  0x8d);
        EXPECT(gbc.sp(), 0x435);
        EXPECT(gbc.pc(), 0x93c6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x93c5), 0x5b);
        // 5B 0360
        gbc.setState(0x516, 0x1b7f, 0x4bb0, 0xd693, 0xeb66, 0xcb3c, 0x0, 0x0);
        gbc.writeMem(0x516, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x4b);
        EXPECT(gbc.b(),  0xd6);
        EXPECT(gbc.c(),  0x93);
        EXPECT(gbc.d(),  0xeb);
        EXPECT(gbc.e(),  0x66);
        EXPECT(gbc.h(),  0xcb);
        EXPECT(gbc.l(),  0x3c);
        EXPECT(gbc.sp(), 0x1b7f);
        EXPECT(gbc.pc(), 0x517);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0361
        gbc.setState(0x593f, 0xb0f8, 0xffb0, 0xd218, 0x5ed1, 0xe0f1, 0x0, 0x0);
        gbc.writeMem(0x593f, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xff);
        EXPECT(gbc.b(),  0xd2);
        EXPECT(gbc.c(),  0x18);
        EXPECT(gbc.d(),  0x5e);
        EXPECT(gbc.e(),  0xd1);
        EXPECT(gbc.h(),  0xe0);
        EXPECT(gbc.l(),  0xf1);
        EXPECT(gbc.sp(), 0xb0f8);
        EXPECT(gbc.pc(), 0x5940);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0362
        gbc.setState(0x434c, 0xa4b2, 0x4830, 0x89, 0xdad1, 0xcb61, 0x0, 0x0);
        gbc.writeMem(0x434c, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x48);
        EXPECT(gbc.b(),  0x0);
        EXPECT(gbc.c(),  0x89);
        EXPECT(gbc.d(),  0xda);
        EXPECT(gbc.e(),  0xd1);
        EXPECT(gbc.h(),  0xcb);
        EXPECT(gbc.l(),  0x61);
        EXPECT(gbc.sp(), 0xa4b2);
        EXPECT(gbc.pc(), 0x434d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0363
        gbc.setState(0x62a0, 0xdf6a, 0x7fe0, 0x6a79, 0x4aea, 0xa220, 0x0, 0x0);
        gbc.writeMem(0x62a0, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x7f);
        EXPECT(gbc.b(),  0x6a);
        EXPECT(gbc.c(),  0x79);
        EXPECT(gbc.d(),  0x4a);
        EXPECT(gbc.e(),  0xea);
        EXPECT(gbc.h(),  0xa2);
        EXPECT(gbc.l(),  0x20);
        EXPECT(gbc.sp(), 0xdf6a);
        EXPECT(gbc.pc(), 0x62a1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0364
        gbc.setState(0xbdb8, 0x28a7, 0x5010, 0xfd10, 0xb36a, 0xeaf9, 0x0, 0x0);
        gbc.writeMem(0xbdb8, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x50);
        EXPECT(gbc.b(),  0xfd);
        EXPECT(gbc.c(),  0x10);
        EXPECT(gbc.d(),  0xb3);
        EXPECT(gbc.e(),  0x6a);
        EXPECT(gbc.h(),  0xea);
        EXPECT(gbc.l(),  0xf9);
        EXPECT(gbc.sp(), 0x28a7);
        EXPECT(gbc.pc(), 0xbdb9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbdb8), 0x5b);
        // 5B 0365
        gbc.setState(0x2d73, 0x8fc1, 0x1340, 0x3ba6, 0xd407, 0x65ea, 0x1, 0x1);
        gbc.writeMem(0x2d73, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x13);
        EXPECT(gbc.b(),  0x3b);
        EXPECT(gbc.c(),  0xa6);
        EXPECT(gbc.d(),  0xd4);
        EXPECT(gbc.e(),  0x7);
        EXPECT(gbc.h(),  0x65);
        EXPECT(gbc.l(),  0xea);
        EXPECT(gbc.sp(), 0x8fc1);
        EXPECT(gbc.pc(), 0x2d74);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0366
        gbc.setState(0x7f86, 0x2e2b, 0x7d70, 0x44d4, 0x5864, 0x4daa, 0x1, 0x0);
        gbc.writeMem(0x7f86, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x7d);
        EXPECT(gbc.b(),  0x44);
        EXPECT(gbc.c(),  0xd4);
        EXPECT(gbc.d(),  0x58);
        EXPECT(gbc.e(),  0x64);
        EXPECT(gbc.h(),  0x4d);
        EXPECT(gbc.l(),  0xaa);
        EXPECT(gbc.sp(), 0x2e2b);
        EXPECT(gbc.pc(), 0x7f87);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0367
        gbc.setState(0x189f, 0xe53c, 0x4020, 0xc119, 0xd0ef, 0x99f4, 0x1, 0x1);
        gbc.writeMem(0x189f, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0xc1);
        EXPECT(gbc.c(),  0x19);
        EXPECT(gbc.d(),  0xd0);
        EXPECT(gbc.e(),  0xef);
        EXPECT(gbc.h(),  0x99);
        EXPECT(gbc.l(),  0xf4);
        EXPECT(gbc.sp(), 0xe53c);
        EXPECT(gbc.pc(), 0x18a0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0368
        gbc.setState(0x95b, 0x7860, 0x7640, 0xbd8d, 0x8269, 0xb6e2, 0x1, 0x1);
        gbc.writeMem(0x95b, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x76);
        EXPECT(gbc.b(),  0xbd);
        EXPECT(gbc.c(),  0x8d);
        EXPECT(gbc.d(),  0x82);
        EXPECT(gbc.e(),  0x69);
        EXPECT(gbc.h(),  0xb6);
        EXPECT(gbc.l(),  0xe2);
        EXPECT(gbc.sp(), 0x7860);
        EXPECT(gbc.pc(), 0x95c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0369
        gbc.setState(0xa323, 0x2e1f, 0x2f20, 0xf497, 0xc121, 0x35b2, 0x0, 0x0);
        gbc.writeMem(0xa323, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x2f);
        EXPECT(gbc.b(),  0xf4);
        EXPECT(gbc.c(),  0x97);
        EXPECT(gbc.d(),  0xc1);
        EXPECT(gbc.e(),  0x21);
        EXPECT(gbc.h(),  0x35);
        EXPECT(gbc.l(),  0xb2);
        EXPECT(gbc.sp(), 0x2e1f);
        EXPECT(gbc.pc(), 0xa324);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa323), 0x5b);
        // 5B 036A
        gbc.setState(0xabb8, 0xe27, 0x9cf0, 0x5938, 0x8791, 0x8ddd, 0x1, 0x0);
        gbc.writeMem(0xabb8, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x9c);
        EXPECT(gbc.b(),  0x59);
        EXPECT(gbc.c(),  0x38);
        EXPECT(gbc.d(),  0x87);
        EXPECT(gbc.e(),  0x91);
        EXPECT(gbc.h(),  0x8d);
        EXPECT(gbc.l(),  0xdd);
        EXPECT(gbc.sp(), 0xe27);
        EXPECT(gbc.pc(), 0xabb9);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xabb8), 0x5b);
        // 5B 036B
        gbc.setState(0xa4fa, 0x9516, 0x9ba0, 0xe36d, 0xe48f, 0x45ba, 0x0, 0x0);
        gbc.writeMem(0xa4fa, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x9b);
        EXPECT(gbc.b(),  0xe3);
        EXPECT(gbc.c(),  0x6d);
        EXPECT(gbc.d(),  0xe4);
        EXPECT(gbc.e(),  0x8f);
        EXPECT(gbc.h(),  0x45);
        EXPECT(gbc.l(),  0xba);
        EXPECT(gbc.sp(), 0x9516);
        EXPECT(gbc.pc(), 0xa4fb);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa4fa), 0x5b);
        // 5B 036C
        gbc.setState(0x8fa3, 0x18d2, 0xde40, 0x9d4, 0xde5b, 0x7990, 0x1, 0x0);
        gbc.writeMem(0x8fa3, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xde);
        EXPECT(gbc.b(),  0x9);
        EXPECT(gbc.c(),  0xd4);
        EXPECT(gbc.d(),  0xde);
        EXPECT(gbc.e(),  0x5b);
        EXPECT(gbc.h(),  0x79);
        EXPECT(gbc.l(),  0x90);
        EXPECT(gbc.sp(), 0x18d2);
        EXPECT(gbc.pc(), 0x8fa4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8fa3), 0x5b);
        // 5B 036D
        gbc.setState(0xb84e, 0x37e0, 0x39b0, 0x2c7f, 0xd24e, 0x5df7, 0x0, 0x0);
        gbc.writeMem(0xb84e, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x39);
        EXPECT(gbc.b(),  0x2c);
        EXPECT(gbc.c(),  0x7f);
        EXPECT(gbc.d(),  0xd2);
        EXPECT(gbc.e(),  0x4e);
        EXPECT(gbc.h(),  0x5d);
        EXPECT(gbc.l(),  0xf7);
        EXPECT(gbc.sp(), 0x37e0);
        EXPECT(gbc.pc(), 0xb84f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb84e), 0x5b);
        // 5B 036E
        gbc.setState(0xe25e, 0x3121, 0xe0b0, 0x700c, 0x9438, 0xbe84, 0x1, 0x1);
        gbc.writeMem(0xe25e, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xe0);
        EXPECT(gbc.b(),  0x70);
        EXPECT(gbc.c(),  0xc);
        EXPECT(gbc.d(),  0x94);
        EXPECT(gbc.e(),  0x38);
        EXPECT(gbc.h(),  0xbe);
        EXPECT(gbc.l(),  0x84);
        EXPECT(gbc.sp(), 0x3121);
        EXPECT(gbc.pc(), 0xe25f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe25e), 0x5b);
        // 5B 036F
        gbc.setState(0xe53a, 0xff61, 0x9aa0, 0x724, 0x1fd0, 0xe953, 0x0, 0x0);
        gbc.writeMem(0xe53a, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x9a);
        EXPECT(gbc.b(),  0x7);
        EXPECT(gbc.c(),  0x24);
        EXPECT(gbc.d(),  0x1f);
        EXPECT(gbc.e(),  0xd0);
        EXPECT(gbc.h(),  0xe9);
        EXPECT(gbc.l(),  0x53);
        EXPECT(gbc.sp(), 0xff61);
        EXPECT(gbc.pc(), 0xe53b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe53a), 0x5b);
        // 5B 0371
        gbc.setState(0x7dee, 0x4ada, 0x7be0, 0xe436, 0xec6a, 0x5bc1, 0x1, 0x1);
        gbc.writeMem(0x7dee, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x7b);
        EXPECT(gbc.b(),  0xe4);
        EXPECT(gbc.c(),  0x36);
        EXPECT(gbc.d(),  0xec);
        EXPECT(gbc.e(),  0x6a);
        EXPECT(gbc.h(),  0x5b);
        EXPECT(gbc.l(),  0xc1);
        EXPECT(gbc.sp(), 0x4ada);
        EXPECT(gbc.pc(), 0x7def);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0372
        gbc.setState(0x881b, 0x40dd, 0x2eb0, 0xad, 0x3588, 0xfad7, 0x1, 0x0);
        gbc.writeMem(0x881b, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x2e);
        EXPECT(gbc.b(),  0x0);
        EXPECT(gbc.c(),  0xad);
        EXPECT(gbc.d(),  0x35);
        EXPECT(gbc.e(),  0x88);
        EXPECT(gbc.h(),  0xfa);
        EXPECT(gbc.l(),  0xd7);
        EXPECT(gbc.sp(), 0x40dd);
        EXPECT(gbc.pc(), 0x881c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x881b), 0x5b);
        // 5B 0373
        gbc.setState(0xd49d, 0x2995, 0x26e0, 0x25d9, 0x48d6, 0xc7d0, 0x0, 0x1);
        gbc.writeMem(0xd49d, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x26);
        EXPECT(gbc.b(),  0x25);
        EXPECT(gbc.c(),  0xd9);
        EXPECT(gbc.d(),  0x48);
        EXPECT(gbc.e(),  0xd6);
        EXPECT(gbc.h(),  0xc7);
        EXPECT(gbc.l(),  0xd0);
        EXPECT(gbc.sp(), 0x2995);
        EXPECT(gbc.pc(), 0xd49e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd49d), 0x5b);
        // 5B 0374
        gbc.setState(0xe14f, 0xd5ef, 0x6b00, 0xec06, 0xc026, 0xac9d, 0x0, 0x1);
        gbc.writeMem(0xe14f, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x6b);
        EXPECT(gbc.b(),  0xec);
        EXPECT(gbc.c(),  0x6);
        EXPECT(gbc.d(),  0xc0);
        EXPECT(gbc.e(),  0x26);
        EXPECT(gbc.h(),  0xac);
        EXPECT(gbc.l(),  0x9d);
        EXPECT(gbc.sp(), 0xd5ef);
        EXPECT(gbc.pc(), 0xe150);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe14f), 0x5b);
        // 5B 0375
        gbc.setState(0x7cd2, 0xea04, 0x8bc0, 0x2007, 0x9fb8, 0x854c, 0x1, 0x1);
        gbc.writeMem(0x7cd2, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x8b);
        EXPECT(gbc.b(),  0x20);
        EXPECT(gbc.c(),  0x7);
        EXPECT(gbc.d(),  0x9f);
        EXPECT(gbc.e(),  0xb8);
        EXPECT(gbc.h(),  0x85);
        EXPECT(gbc.l(),  0x4c);
        EXPECT(gbc.sp(), 0xea04);
        EXPECT(gbc.pc(), 0x7cd3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0376
        gbc.setState(0xa253, 0xa29, 0x12e0, 0x7e1e, 0x8ac6, 0x5754, 0x1, 0x0);
        gbc.writeMem(0xa253, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x12);
        EXPECT(gbc.b(),  0x7e);
        EXPECT(gbc.c(),  0x1e);
        EXPECT(gbc.d(),  0x8a);
        EXPECT(gbc.e(),  0xc6);
        EXPECT(gbc.h(),  0x57);
        EXPECT(gbc.l(),  0x54);
        EXPECT(gbc.sp(), 0xa29);
        EXPECT(gbc.pc(), 0xa254);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa253), 0x5b);
        // 5B 0377
        gbc.setState(0x31fc, 0x66b3, 0x2bb0, 0xee3a, 0x1a30, 0x7ea, 0x1, 0x0);
        gbc.writeMem(0x31fc, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x2b);
        EXPECT(gbc.b(),  0xee);
        EXPECT(gbc.c(),  0x3a);
        EXPECT(gbc.d(),  0x1a);
        EXPECT(gbc.e(),  0x30);
        EXPECT(gbc.h(),  0x7);
        EXPECT(gbc.l(),  0xea);
        EXPECT(gbc.sp(), 0x66b3);
        EXPECT(gbc.pc(), 0x31fd);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0378
        gbc.setState(0x6cfc, 0x5d5c, 0xa4e0, 0xeed1, 0x269f, 0xac03, 0x0, 0x1);
        gbc.writeMem(0x6cfc, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa4);
        EXPECT(gbc.b(),  0xee);
        EXPECT(gbc.c(),  0xd1);
        EXPECT(gbc.d(),  0x26);
        EXPECT(gbc.e(),  0x9f);
        EXPECT(gbc.h(),  0xac);
        EXPECT(gbc.l(),  0x3);
        EXPECT(gbc.sp(), 0x5d5c);
        EXPECT(gbc.pc(), 0x6cfd);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0379
        gbc.setState(0xe6ad, 0xe506, 0x5f10, 0xb0, 0x43b4, 0xf460, 0x1, 0x1);
        gbc.writeMem(0xe6ad, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x5f);
        EXPECT(gbc.b(),  0x0);
        EXPECT(gbc.c(),  0xb0);
        EXPECT(gbc.d(),  0x43);
        EXPECT(gbc.e(),  0xb4);
        EXPECT(gbc.h(),  0xf4);
        EXPECT(gbc.l(),  0x60);
        EXPECT(gbc.sp(), 0xe506);
        EXPECT(gbc.pc(), 0xe6ae);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe6ad), 0x5b);
        // 5B 037A
        gbc.setState(0xbc9, 0x3324, 0x8060, 0x8065, 0xb3d2, 0xef25, 0x0, 0x1);
        gbc.writeMem(0xbc9, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0x80);
        EXPECT(gbc.c(),  0x65);
        EXPECT(gbc.d(),  0xb3);
        EXPECT(gbc.e(),  0xd2);
        EXPECT(gbc.h(),  0xef);
        EXPECT(gbc.l(),  0x25);
        EXPECT(gbc.sp(), 0x3324);
        EXPECT(gbc.pc(), 0xbca);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 037B
        gbc.setState(0xe30e, 0xff65, 0x21d0, 0x491a, 0x2c1e, 0x7ea, 0x0, 0x1);
        gbc.writeMem(0xe30e, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x21);
        EXPECT(gbc.b(),  0x49);
        EXPECT(gbc.c(),  0x1a);
        EXPECT(gbc.d(),  0x2c);
        EXPECT(gbc.e(),  0x1e);
        EXPECT(gbc.h(),  0x7);
        EXPECT(gbc.l(),  0xea);
        EXPECT(gbc.sp(), 0xff65);
        EXPECT(gbc.pc(), 0xe30f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe30e), 0x5b);
        // 5B 037C
        gbc.setState(0xe44d, 0x9c9, 0x61f0, 0xf250, 0xaec5, 0x27c7, 0x0, 0x0);
        gbc.writeMem(0xe44d, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x61);
        EXPECT(gbc.b(),  0xf2);
        EXPECT(gbc.c(),  0x50);
        EXPECT(gbc.d(),  0xae);
        EXPECT(gbc.e(),  0xc5);
        EXPECT(gbc.h(),  0x27);
        EXPECT(gbc.l(),  0xc7);
        EXPECT(gbc.sp(), 0x9c9);
        EXPECT(gbc.pc(), 0xe44e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe44d), 0x5b);
        // 5B 037D
        gbc.setState(0x701b, 0x9118, 0xf140, 0x8e16, 0x2139, 0x8dd1, 0x1, 0x1);
        gbc.writeMem(0x701b, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf1);
        EXPECT(gbc.b(),  0x8e);
        EXPECT(gbc.c(),  0x16);
        EXPECT(gbc.d(),  0x21);
        EXPECT(gbc.e(),  0x39);
        EXPECT(gbc.h(),  0x8d);
        EXPECT(gbc.l(),  0xd1);
        EXPECT(gbc.sp(), 0x9118);
        EXPECT(gbc.pc(), 0x701c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 037E
        gbc.setState(0x9627, 0xcf34, 0x7b0, 0x1e68, 0x6e8, 0x955c, 0x0, 0x0);
        gbc.writeMem(0x9627, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x7);
        EXPECT(gbc.b(),  0x1e);
        EXPECT(gbc.c(),  0x68);
        EXPECT(gbc.d(),  0x6);
        EXPECT(gbc.e(),  0xe8);
        EXPECT(gbc.h(),  0x95);
        EXPECT(gbc.l(),  0x5c);
        EXPECT(gbc.sp(), 0xcf34);
        EXPECT(gbc.pc(), 0x9628);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9627), 0x5b);
        // 5B 037F
        gbc.setState(0xb137, 0xb4ac, 0xce90, 0xbd6e, 0x9623, 0x8e62, 0x1, 0x1);
        gbc.writeMem(0xb137, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xce);
        EXPECT(gbc.b(),  0xbd);
        EXPECT(gbc.c(),  0x6e);
        EXPECT(gbc.d(),  0x96);
        EXPECT(gbc.e(),  0x23);
        EXPECT(gbc.h(),  0x8e);
        EXPECT(gbc.l(),  0x62);
        EXPECT(gbc.sp(), 0xb4ac);
        EXPECT(gbc.pc(), 0xb138);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb137), 0x5b);
        // 5B 0380
        gbc.setState(0x7b6d, 0x1eeb, 0xf30, 0xb374, 0xe324, 0xbfcc, 0x0, 0x0);
        gbc.writeMem(0x7b6d, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf);
        EXPECT(gbc.b(),  0xb3);
        EXPECT(gbc.c(),  0x74);
        EXPECT(gbc.d(),  0xe3);
        EXPECT(gbc.e(),  0x24);
        EXPECT(gbc.h(),  0xbf);
        EXPECT(gbc.l(),  0xcc);
        EXPECT(gbc.sp(), 0x1eeb);
        EXPECT(gbc.pc(), 0x7b6e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0381
        gbc.setState(0xaa52, 0x4475, 0xc540, 0x9f03, 0x9d1e, 0xb0cd, 0x0, 0x0);
        gbc.writeMem(0xaa52, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xc5);
        EXPECT(gbc.b(),  0x9f);
        EXPECT(gbc.c(),  0x3);
        EXPECT(gbc.d(),  0x9d);
        EXPECT(gbc.e(),  0x1e);
        EXPECT(gbc.h(),  0xb0);
        EXPECT(gbc.l(),  0xcd);
        EXPECT(gbc.sp(), 0x4475);
        EXPECT(gbc.pc(), 0xaa53);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xaa52), 0x5b);
        // 5B 0382
        gbc.setState(0x3123, 0x6bd7, 0x62a0, 0x398c, 0x964a, 0x6e61, 0x1, 0x0);
        gbc.writeMem(0x3123, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x62);
        EXPECT(gbc.b(),  0x39);
        EXPECT(gbc.c(),  0x8c);
        EXPECT(gbc.d(),  0x96);
        EXPECT(gbc.e(),  0x4a);
        EXPECT(gbc.h(),  0x6e);
        EXPECT(gbc.l(),  0x61);
        EXPECT(gbc.sp(), 0x6bd7);
        EXPECT(gbc.pc(), 0x3124);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0383
        gbc.setState(0xb416, 0x88d0, 0x88b0, 0xf699, 0x3bb, 0x20d9, 0x0, 0x1);
        gbc.writeMem(0xb416, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x88);
        EXPECT(gbc.b(),  0xf6);
        EXPECT(gbc.c(),  0x99);
        EXPECT(gbc.d(),  0x3);
        EXPECT(gbc.e(),  0xbb);
        EXPECT(gbc.h(),  0x20);
        EXPECT(gbc.l(),  0xd9);
        EXPECT(gbc.sp(), 0x88d0);
        EXPECT(gbc.pc(), 0xb417);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb416), 0x5b);
        // 5B 0384
        gbc.setState(0x76ec, 0xc8b5, 0x8d60, 0x62fe, 0xabb2, 0x2bc, 0x0, 0x1);
        gbc.writeMem(0x76ec, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x8d);
        EXPECT(gbc.b(),  0x62);
        EXPECT(gbc.c(),  0xfe);
        EXPECT(gbc.d(),  0xab);
        EXPECT(gbc.e(),  0xb2);
        EXPECT(gbc.h(),  0x2);
        EXPECT(gbc.l(),  0xbc);
        EXPECT(gbc.sp(), 0xc8b5);
        EXPECT(gbc.pc(), 0x76ed);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 0385
        gbc.setState(0x3963, 0xb373, 0xcf10, 0x9698, 0x670, 0x83f3, 0x0, 0x1);
        gbc.writeMem(0x3963, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xcf);
        EXPECT(gbc.b(),  0x96);
        EXPECT(gbc.c(),  0x98);
        EXPECT(gbc.d(),  0x6);
        EXPECT(gbc.e(),  0x70);
        EXPECT(gbc.h(),  0x83);
        EXPECT(gbc.l(),  0xf3);
        EXPECT(gbc.sp(), 0xb373);
        EXPECT(gbc.pc(), 0x3964);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 0386
        gbc.setState(0xc260, 0x2302, 0x2660, 0x4899, 0x1527, 0xeb82, 0x0, 0x0);
        gbc.writeMem(0xc260, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x26);
        EXPECT(gbc.b(),  0x48);
        EXPECT(gbc.c(),  0x99);
        EXPECT(gbc.d(),  0x15);
        EXPECT(gbc.e(),  0x27);
        EXPECT(gbc.h(),  0xeb);
        EXPECT(gbc.l(),  0x82);
        EXPECT(gbc.sp(), 0x2302);
        EXPECT(gbc.pc(), 0xc261);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc260), 0x5b);
        // 5B 0387
        gbc.setState(0xe118, 0xd570, 0xcb60, 0xd148, 0x6ce, 0x3aba, 0x0, 0x0);
        gbc.writeMem(0xe118, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xcb);
        EXPECT(gbc.b(),  0xd1);
        EXPECT(gbc.c(),  0x48);
        EXPECT(gbc.d(),  0x6);
        EXPECT(gbc.e(),  0xce);
        EXPECT(gbc.h(),  0x3a);
        EXPECT(gbc.l(),  0xba);
        EXPECT(gbc.sp(), 0xd570);
        EXPECT(gbc.pc(), 0xe119);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe118), 0x5b);
        // 5B 0388
        gbc.setState(0xb29c, 0x3aa, 0xf260, 0x6e26, 0xbab7, 0x8fa0, 0x0, 0x0);
        gbc.writeMem(0xb29c, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf2);
        EXPECT(gbc.b(),  0x6e);
        EXPECT(gbc.c(),  0x26);
        EXPECT(gbc.d(),  0xba);
        EXPECT(gbc.e(),  0xb7);
        EXPECT(gbc.h(),  0x8f);
        EXPECT(gbc.l(),  0xa0);
        EXPECT(gbc.sp(), 0x3aa);
        EXPECT(gbc.pc(), 0xb29d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb29c), 0x5b);
        // 5B 0389
        gbc.setState(0xe3ac, 0x7071, 0x4090, 0x454b, 0x47d5, 0xfed0, 0x1, 0x1);
        gbc.writeMem(0xe3ac, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0x45);
        EXPECT(gbc.c(),  0x4b);
        EXPECT(gbc.d(),  0x47);
        EXPECT(gbc.e(),  0xd5);
        EXPECT(gbc.h(),  0xfe);
        EXPECT(gbc.l(),  0xd0);
        EXPECT(gbc.sp(), 0x7071);
        EXPECT(gbc.pc(), 0xe3ad);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe3ac), 0x5b);
        // 5B 038A
        gbc.setState(0xb646, 0x108f, 0x45b0, 0xa057, 0x7a95, 0xa520, 0x0, 0x1);
        gbc.writeMem(0xb646, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x45);
        EXPECT(gbc.b(),  0xa0);
        EXPECT(gbc.c(),  0x57);
        EXPECT(gbc.d(),  0x7a);
        EXPECT(gbc.e(),  0x95);
        EXPECT(gbc.h(),  0xa5);
        EXPECT(gbc.l(),  0x20);
        EXPECT(gbc.sp(), 0x108f);
        EXPECT(gbc.pc(), 0xb647);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb646), 0x5b);
        // 5B 038B
        gbc.setState(0xb520, 0xde1e, 0x4c50, 0x6468, 0x5c71, 0xfcbe, 0x1, 0x1);
        gbc.writeMem(0xb520, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x4c);
        EXPECT(gbc.b(),  0x64);
        EXPECT(gbc.c(),  0x68);
        EXPECT(gbc.d(),  0x5c);
        EXPECT(gbc.e(),  0x71);
        EXPECT(gbc.h(),  0xfc);
        EXPECT(gbc.l(),  0xbe);
        EXPECT(gbc.sp(), 0xde1e);
        EXPECT(gbc.pc(), 0xb521);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb520), 0x5b);
        // 5B 038C
        gbc.setState(0xa8ee, 0x74ef, 0xa170, 0x33c2, 0x425b, 0xa946, 0x1, 0x1);
        gbc.writeMem(0xa8ee, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa1);
        EXPECT(gbc.b(),  0x33);
        EXPECT(gbc.c(),  0xc2);
        EXPECT(gbc.d(),  0x42);
        EXPECT(gbc.e(),  0x5b);
        EXPECT(gbc.h(),  0xa9);
        EXPECT(gbc.l(),  0x46);
        EXPECT(gbc.sp(), 0x74ef);
        EXPECT(gbc.pc(), 0xa8ef);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa8ee), 0x5b);
        // 5B 038D
        gbc.setState(0xb992, 0x7d7c, 0x47b0, 0xcc9d, 0x96e7, 0x1c11, 0x1, 0x1);
        gbc.writeMem(0xb992, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x47);
        EXPECT(gbc.b(),  0xcc);
        EXPECT(gbc.c(),  0x9d);
        EXPECT(gbc.d(),  0x96);
        EXPECT(gbc.e(),  0xe7);
        EXPECT(gbc.h(),  0x1c);
        EXPECT(gbc.l(),  0x11);
        EXPECT(gbc.sp(), 0x7d7c);
        EXPECT(gbc.pc(), 0xb993);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb992), 0x5b);
        // 5B 038E
        gbc.setState(0x3360, 0x74e, 0x6e40, 0x9ff4, 0x3d21, 0x5332, 0x0, 0x0);
        gbc.writeMem(0x3360, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x6e);
        EXPECT(gbc.b(),  0x9f);
        EXPECT(gbc.c(),  0xf4);
        EXPECT(gbc.d(),  0x3d);
        EXPECT(gbc.e(),  0x21);
        EXPECT(gbc.h(),  0x53);
        EXPECT(gbc.l(),  0x32);
        EXPECT(gbc.sp(), 0x74e);
        EXPECT(gbc.pc(), 0x3361);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 038F
        gbc.setState(0x19b9, 0x4383, 0x2bd0, 0x80e4, 0x9078, 0x8cc7, 0x0, 0x1);
        gbc.writeMem(0x19b9, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x2b);
        EXPECT(gbc.b(),  0x80);
        EXPECT(gbc.c(),  0xe4);
        EXPECT(gbc.d(),  0x90);
        EXPECT(gbc.e(),  0x78);
        EXPECT(gbc.h(),  0x8c);
        EXPECT(gbc.l(),  0xc7);
        EXPECT(gbc.sp(), 0x4383);
        EXPECT(gbc.pc(), 0x19ba);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 0390
        gbc.setState(0x7c6b, 0x27fe, 0x4c00, 0x9471, 0x9307, 0xd471, 0x1, 0x0);
        gbc.writeMem(0x7c6b, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x4c);
        EXPECT(gbc.b(),  0x94);
        EXPECT(gbc.c(),  0x71);
        EXPECT(gbc.d(),  0x93);
        EXPECT(gbc.e(),  0x7);
        EXPECT(gbc.h(),  0xd4);
        EXPECT(gbc.l(),  0x71);
        EXPECT(gbc.sp(), 0x27fe);
        EXPECT(gbc.pc(), 0x7c6c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0391
        gbc.setState(0x991c, 0xe715, 0x7750, 0xe70e, 0x5a01, 0x79f4, 0x1, 0x0);
        gbc.writeMem(0x991c, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x77);
        EXPECT(gbc.b(),  0xe7);
        EXPECT(gbc.c(),  0xe);
        EXPECT(gbc.d(),  0x5a);
        EXPECT(gbc.e(),  0x1);
        EXPECT(gbc.h(),  0x79);
        EXPECT(gbc.l(),  0xf4);
        EXPECT(gbc.sp(), 0xe715);
        EXPECT(gbc.pc(), 0x991d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x991c), 0x5b);
        // 5B 0392
        gbc.setState(0x3483, 0x1c00, 0xc350, 0xf518, 0xd50f, 0x1672, 0x0, 0x0);
        gbc.writeMem(0x3483, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xc3);
        EXPECT(gbc.b(),  0xf5);
        EXPECT(gbc.c(),  0x18);
        EXPECT(gbc.d(),  0xd5);
        EXPECT(gbc.e(),  0xf);
        EXPECT(gbc.h(),  0x16);
        EXPECT(gbc.l(),  0x72);
        EXPECT(gbc.sp(), 0x1c00);
        EXPECT(gbc.pc(), 0x3484);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 0393
        gbc.setState(0xd409, 0x3ce0, 0xb890, 0x9ce7, 0x8b2b, 0x5fc0, 0x0, 0x1);
        gbc.writeMem(0xd409, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xb8);
        EXPECT(gbc.b(),  0x9c);
        EXPECT(gbc.c(),  0xe7);
        EXPECT(gbc.d(),  0x8b);
        EXPECT(gbc.e(),  0x2b);
        EXPECT(gbc.h(),  0x5f);
        EXPECT(gbc.l(),  0xc0);
        EXPECT(gbc.sp(), 0x3ce0);
        EXPECT(gbc.pc(), 0xd40a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd409), 0x5b);
        // 5B 0394
        gbc.setState(0xe674, 0x5391, 0xb360, 0x1f77, 0xc35d, 0xbd24, 0x0, 0x1);
        gbc.writeMem(0xe674, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xb3);
        EXPECT(gbc.b(),  0x1f);
        EXPECT(gbc.c(),  0x77);
        EXPECT(gbc.d(),  0xc3);
        EXPECT(gbc.e(),  0x5d);
        EXPECT(gbc.h(),  0xbd);
        EXPECT(gbc.l(),  0x24);
        EXPECT(gbc.sp(), 0x5391);
        EXPECT(gbc.pc(), 0xe675);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe674), 0x5b);
        // 5B 0395
        gbc.setState(0x6135, 0x3026, 0xe630, 0xec52, 0x39db, 0xed15, 0x1, 0x0);
        gbc.writeMem(0x6135, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xe6);
        EXPECT(gbc.b(),  0xec);
        EXPECT(gbc.c(),  0x52);
        EXPECT(gbc.d(),  0x39);
        EXPECT(gbc.e(),  0xdb);
        EXPECT(gbc.h(),  0xed);
        EXPECT(gbc.l(),  0x15);
        EXPECT(gbc.sp(), 0x3026);
        EXPECT(gbc.pc(), 0x6136);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 0396
        gbc.setState(0x5fbb, 0x3b7d, 0x5580, 0xf825, 0xbc79, 0xf3a9, 0x1, 0x1);
        gbc.writeMem(0x5fbb, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x55);
        EXPECT(gbc.b(),  0xf8);
        EXPECT(gbc.c(),  0x25);
        EXPECT(gbc.d(),  0xbc);
        EXPECT(gbc.e(),  0x79);
        EXPECT(gbc.h(),  0xf3);
        EXPECT(gbc.l(),  0xa9);
        EXPECT(gbc.sp(), 0x3b7d);
        EXPECT(gbc.pc(), 0x5fbc);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0398
        gbc.setState(0x23e4, 0x7ec2, 0xf640, 0xbe50, 0xea0c, 0x1413, 0x0, 0x1);
        gbc.writeMem(0x23e4, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf6);
        EXPECT(gbc.b(),  0xbe);
        EXPECT(gbc.c(),  0x50);
        EXPECT(gbc.d(),  0xea);
        EXPECT(gbc.e(),  0xc);
        EXPECT(gbc.h(),  0x14);
        EXPECT(gbc.l(),  0x13);
        EXPECT(gbc.sp(), 0x7ec2);
        EXPECT(gbc.pc(), 0x23e5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 0399
        gbc.setState(0x1e98, 0x163f, 0xf910, 0x6de1, 0x9422, 0xc1ef, 0x0, 0x1);
        gbc.writeMem(0x1e98, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf9);
        EXPECT(gbc.b(),  0x6d);
        EXPECT(gbc.c(),  0xe1);
        EXPECT(gbc.d(),  0x94);
        EXPECT(gbc.e(),  0x22);
        EXPECT(gbc.h(),  0xc1);
        EXPECT(gbc.l(),  0xef);
        EXPECT(gbc.sp(), 0x163f);
        EXPECT(gbc.pc(), 0x1e99);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 039B
        gbc.setState(0xa3d5, 0x727f, 0x3e20, 0x888e, 0x80e3, 0x33b3, 0x0, 0x0);
        gbc.writeMem(0xa3d5, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x3e);
        EXPECT(gbc.b(),  0x88);
        EXPECT(gbc.c(),  0x8e);
        EXPECT(gbc.d(),  0x80);
        EXPECT(gbc.e(),  0xe3);
        EXPECT(gbc.h(),  0x33);
        EXPECT(gbc.l(),  0xb3);
        EXPECT(gbc.sp(), 0x727f);
        EXPECT(gbc.pc(), 0xa3d6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa3d5), 0x5b);
        // 5B 039C
        gbc.setState(0x1647, 0xc2c9, 0x91c0, 0x2e82, 0x7e4, 0x90b7, 0x0, 0x0);
        gbc.writeMem(0x1647, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x91);
        EXPECT(gbc.b(),  0x2e);
        EXPECT(gbc.c(),  0x82);
        EXPECT(gbc.d(),  0x7);
        EXPECT(gbc.e(),  0xe4);
        EXPECT(gbc.h(),  0x90);
        EXPECT(gbc.l(),  0xb7);
        EXPECT(gbc.sp(), 0xc2c9);
        EXPECT(gbc.pc(), 0x1648);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 039D
        gbc.setState(0x3e90, 0x2843, 0x1020, 0xae9d, 0x74e7, 0x21a7, 0x0, 0x0);
        gbc.writeMem(0x3e90, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0xae);
        EXPECT(gbc.c(),  0x9d);
        EXPECT(gbc.d(),  0x74);
        EXPECT(gbc.e(),  0xe7);
        EXPECT(gbc.h(),  0x21);
        EXPECT(gbc.l(),  0xa7);
        EXPECT(gbc.sp(), 0x2843);
        EXPECT(gbc.pc(), 0x3e91);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 039E
        gbc.setState(0x8060, 0x1cdb, 0x2da0, 0x8f47, 0xaa90, 0xfc0d, 0x0, 0x0);
        gbc.writeMem(0x8060, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x2d);
        EXPECT(gbc.b(),  0x8f);
        EXPECT(gbc.c(),  0x47);
        EXPECT(gbc.d(),  0xaa);
        EXPECT(gbc.e(),  0x90);
        EXPECT(gbc.h(),  0xfc);
        EXPECT(gbc.l(),  0xd);
        EXPECT(gbc.sp(), 0x1cdb);
        EXPECT(gbc.pc(), 0x8061);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8060), 0x5b);
        // 5B 039F
        gbc.setState(0x7b99, 0x1052, 0xfa70, 0x28f, 0x52d4, 0x4c8a, 0x1, 0x1);
        gbc.writeMem(0x7b99, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xfa);
        EXPECT(gbc.b(),  0x2);
        EXPECT(gbc.c(),  0x8f);
        EXPECT(gbc.d(),  0x52);
        EXPECT(gbc.e(),  0xd4);
        EXPECT(gbc.h(),  0x4c);
        EXPECT(gbc.l(),  0x8a);
        EXPECT(gbc.sp(), 0x1052);
        EXPECT(gbc.pc(), 0x7b9a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 03A0
        gbc.setState(0xc9eb, 0xf215, 0xb770, 0xab2f, 0xc12a, 0x538f, 0x0, 0x1);
        gbc.writeMem(0xc9eb, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xb7);
        EXPECT(gbc.b(),  0xab);
        EXPECT(gbc.c(),  0x2f);
        EXPECT(gbc.d(),  0xc1);
        EXPECT(gbc.e(),  0x2a);
        EXPECT(gbc.h(),  0x53);
        EXPECT(gbc.l(),  0x8f);
        EXPECT(gbc.sp(), 0xf215);
        EXPECT(gbc.pc(), 0xc9ec);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc9eb), 0x5b);
        // 5B 03A2
        gbc.setState(0x4740, 0x4734, 0xcd20, 0xc1b6, 0xca48, 0xdf39, 0x0, 0x1);
        gbc.writeMem(0x4740, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xcd);
        EXPECT(gbc.b(),  0xc1);
        EXPECT(gbc.c(),  0xb6);
        EXPECT(gbc.d(),  0xca);
        EXPECT(gbc.e(),  0x48);
        EXPECT(gbc.h(),  0xdf);
        EXPECT(gbc.l(),  0x39);
        EXPECT(gbc.sp(), 0x4734);
        EXPECT(gbc.pc(), 0x4741);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 03A3
        gbc.setState(0xc2d3, 0x377a, 0xd690, 0xf783, 0x3498, 0x3671, 0x1, 0x1);
        gbc.writeMem(0xc2d3, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd6);
        EXPECT(gbc.b(),  0xf7);
        EXPECT(gbc.c(),  0x83);
        EXPECT(gbc.d(),  0x34);
        EXPECT(gbc.e(),  0x98);
        EXPECT(gbc.h(),  0x36);
        EXPECT(gbc.l(),  0x71);
        EXPECT(gbc.sp(), 0x377a);
        EXPECT(gbc.pc(), 0xc2d4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc2d3), 0x5b);
        // 5B 03A4
        gbc.setState(0xc2f7, 0x5332, 0xa110, 0x1650, 0xa788, 0x7e20, 0x1, 0x0);
        gbc.writeMem(0xc2f7, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa1);
        EXPECT(gbc.b(),  0x16);
        EXPECT(gbc.c(),  0x50);
        EXPECT(gbc.d(),  0xa7);
        EXPECT(gbc.e(),  0x88);
        EXPECT(gbc.h(),  0x7e);
        EXPECT(gbc.l(),  0x20);
        EXPECT(gbc.sp(), 0x5332);
        EXPECT(gbc.pc(), 0xc2f8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc2f7), 0x5b);
        // 5B 03A5
        gbc.setState(0x8c6c, 0x88c5, 0xe6c0, 0xcc81, 0x6b50, 0x7953, 0x1, 0x1);
        gbc.writeMem(0x8c6c, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xe6);
        EXPECT(gbc.b(),  0xcc);
        EXPECT(gbc.c(),  0x81);
        EXPECT(gbc.d(),  0x6b);
        EXPECT(gbc.e(),  0x50);
        EXPECT(gbc.h(),  0x79);
        EXPECT(gbc.l(),  0x53);
        EXPECT(gbc.sp(), 0x88c5);
        EXPECT(gbc.pc(), 0x8c6d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8c6c), 0x5b);
        // 5B 03A6
        gbc.setState(0x9180, 0x3b23, 0xa920, 0x4b28, 0x90d7, 0xfef, 0x0, 0x0);
        gbc.writeMem(0x9180, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa9);
        EXPECT(gbc.b(),  0x4b);
        EXPECT(gbc.c(),  0x28);
        EXPECT(gbc.d(),  0x90);
        EXPECT(gbc.e(),  0xd7);
        EXPECT(gbc.h(),  0xf);
        EXPECT(gbc.l(),  0xef);
        EXPECT(gbc.sp(), 0x3b23);
        EXPECT(gbc.pc(), 0x9181);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9180), 0x5b);
        // 5B 03A7
        gbc.setState(0xbfba, 0x87e9, 0x58f0, 0x9b2f, 0x72fe, 0x39f5, 0x1, 0x0);
        gbc.writeMem(0xbfba, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x58);
        EXPECT(gbc.b(),  0x9b);
        EXPECT(gbc.c(),  0x2f);
        EXPECT(gbc.d(),  0x72);
        EXPECT(gbc.e(),  0xfe);
        EXPECT(gbc.h(),  0x39);
        EXPECT(gbc.l(),  0xf5);
        EXPECT(gbc.sp(), 0x87e9);
        EXPECT(gbc.pc(), 0xbfbb);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbfba), 0x5b);
        // 5B 03A8
        gbc.setState(0x5dd5, 0x9c4a, 0xf1a0, 0x391c, 0xf105, 0xbf83, 0x0, 0x1);
        gbc.writeMem(0x5dd5, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xf1);
        EXPECT(gbc.b(),  0x39);
        EXPECT(gbc.c(),  0x1c);
        EXPECT(gbc.d(),  0xf1);
        EXPECT(gbc.e(),  0x5);
        EXPECT(gbc.h(),  0xbf);
        EXPECT(gbc.l(),  0x83);
        EXPECT(gbc.sp(), 0x9c4a);
        EXPECT(gbc.pc(), 0x5dd6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 03A9
        gbc.setState(0xbcc8, 0x4d4, 0x3bf0, 0xff7, 0xada1, 0xd049, 0x0, 0x0);
        gbc.writeMem(0xbcc8, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x3b);
        EXPECT(gbc.b(),  0xf);
        EXPECT(gbc.c(),  0xf7);
        EXPECT(gbc.d(),  0xad);
        EXPECT(gbc.e(),  0xa1);
        EXPECT(gbc.h(),  0xd0);
        EXPECT(gbc.l(),  0x49);
        EXPECT(gbc.sp(), 0x4d4);
        EXPECT(gbc.pc(), 0xbcc9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbcc8), 0x5b);
        // 5B 03AA
        gbc.setState(0xdd4e, 0xe6cc, 0x7e60, 0xc7f8, 0xdc96, 0xa39d, 0x0, 0x1);
        gbc.writeMem(0xdd4e, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x7e);
        EXPECT(gbc.b(),  0xc7);
        EXPECT(gbc.c(),  0xf8);
        EXPECT(gbc.d(),  0xdc);
        EXPECT(gbc.e(),  0x96);
        EXPECT(gbc.h(),  0xa3);
        EXPECT(gbc.l(),  0x9d);
        EXPECT(gbc.sp(), 0xe6cc);
        EXPECT(gbc.pc(), 0xdd4f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdd4e), 0x5b);
        // 5B 03AB
        gbc.setState(0xd2df, 0x63a1, 0x5020, 0x9d5c, 0xcde9, 0xfbe6, 0x1, 0x1);
        gbc.writeMem(0xd2df, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x50);
        EXPECT(gbc.b(),  0x9d);
        EXPECT(gbc.c(),  0x5c);
        EXPECT(gbc.d(),  0xcd);
        EXPECT(gbc.e(),  0xe9);
        EXPECT(gbc.h(),  0xfb);
        EXPECT(gbc.l(),  0xe6);
        EXPECT(gbc.sp(), 0x63a1);
        EXPECT(gbc.pc(), 0xd2e0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd2df), 0x5b);
        // 5B 03AD
        gbc.setState(0xa77, 0xa523, 0x3970, 0x99eb, 0x16ca, 0xc8d, 0x0, 0x1);
        gbc.writeMem(0xa77, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x39);
        EXPECT(gbc.b(),  0x99);
        EXPECT(gbc.c(),  0xeb);
        EXPECT(gbc.d(),  0x16);
        EXPECT(gbc.e(),  0xca);
        EXPECT(gbc.h(),  0xc);
        EXPECT(gbc.l(),  0x8d);
        EXPECT(gbc.sp(), 0xa523);
        EXPECT(gbc.pc(), 0xa78);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 03AE
        gbc.setState(0xde0e, 0x30b0, 0xc680, 0xe0ac, 0xdd41, 0xfd44, 0x0, 0x1);
        gbc.writeMem(0xde0e, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xc6);
        EXPECT(gbc.b(),  0xe0);
        EXPECT(gbc.c(),  0xac);
        EXPECT(gbc.d(),  0xdd);
        EXPECT(gbc.e(),  0x41);
        EXPECT(gbc.h(),  0xfd);
        EXPECT(gbc.l(),  0x44);
        EXPECT(gbc.sp(), 0x30b0);
        EXPECT(gbc.pc(), 0xde0f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xde0e), 0x5b);
        // 5B 03AF
        gbc.setState(0xaf2d, 0xecde, 0x8f70, 0xab4f, 0x76f4, 0x31c3, 0x1, 0x0);
        gbc.writeMem(0xaf2d, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x8f);
        EXPECT(gbc.b(),  0xab);
        EXPECT(gbc.c(),  0x4f);
        EXPECT(gbc.d(),  0x76);
        EXPECT(gbc.e(),  0xf4);
        EXPECT(gbc.h(),  0x31);
        EXPECT(gbc.l(),  0xc3);
        EXPECT(gbc.sp(), 0xecde);
        EXPECT(gbc.pc(), 0xaf2e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xaf2d), 0x5b);
        // 5B 03B0
        gbc.setState(0x305a, 0x5bff, 0xc630, 0xd38d, 0xb046, 0xb99f, 0x1, 0x1);
        gbc.writeMem(0x305a, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xc6);
        EXPECT(gbc.b(),  0xd3);
        EXPECT(gbc.c(),  0x8d);
        EXPECT(gbc.d(),  0xb0);
        EXPECT(gbc.e(),  0x46);
        EXPECT(gbc.h(),  0xb9);
        EXPECT(gbc.l(),  0x9f);
        EXPECT(gbc.sp(), 0x5bff);
        EXPECT(gbc.pc(), 0x305b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 03B2
        gbc.setState(0xd8b, 0xf96b, 0xfd70, 0x4aa9, 0x39d5, 0x6d64, 0x0, 0x0);
        gbc.writeMem(0xd8b, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xfd);
        EXPECT(gbc.b(),  0x4a);
        EXPECT(gbc.c(),  0xa9);
        EXPECT(gbc.d(),  0x39);
        EXPECT(gbc.e(),  0xd5);
        EXPECT(gbc.h(),  0x6d);
        EXPECT(gbc.l(),  0x64);
        EXPECT(gbc.sp(), 0xf96b);
        EXPECT(gbc.pc(), 0xd8c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 03B3
        gbc.setState(0x3b30, 0x998e, 0xe00, 0xa7c7, 0x21dc, 0x7ed9, 0x1, 0x1);
        gbc.writeMem(0x3b30, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xe);
        EXPECT(gbc.b(),  0xa7);
        EXPECT(gbc.c(),  0xc7);
        EXPECT(gbc.d(),  0x21);
        EXPECT(gbc.e(),  0xdc);
        EXPECT(gbc.h(),  0x7e);
        EXPECT(gbc.l(),  0xd9);
        EXPECT(gbc.sp(), 0x998e);
        EXPECT(gbc.pc(), 0x3b31);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 03B4
        gbc.setState(0xc978, 0xc9ff, 0x9f00, 0x49dc, 0x4f17, 0x8920, 0x1, 0x1);
        gbc.writeMem(0xc978, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x9f);
        EXPECT(gbc.b(),  0x49);
        EXPECT(gbc.c(),  0xdc);
        EXPECT(gbc.d(),  0x4f);
        EXPECT(gbc.e(),  0x17);
        EXPECT(gbc.h(),  0x89);
        EXPECT(gbc.l(),  0x20);
        EXPECT(gbc.sp(), 0xc9ff);
        EXPECT(gbc.pc(), 0xc979);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc978), 0x5b);
        // 5B 03B5
        gbc.setState(0x8321, 0x3481, 0xcb70, 0xcf1c, 0x7009, 0x1bd, 0x1, 0x0);
        gbc.writeMem(0x8321, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xcb);
        EXPECT(gbc.b(),  0xcf);
        EXPECT(gbc.c(),  0x1c);
        EXPECT(gbc.d(),  0x70);
        EXPECT(gbc.e(),  0x9);
        EXPECT(gbc.h(),  0x1);
        EXPECT(gbc.l(),  0xbd);
        EXPECT(gbc.sp(), 0x3481);
        EXPECT(gbc.pc(), 0x8322);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8321), 0x5b);
        // 5B 03B6
        gbc.setState(0xa8f6, 0xa0d6, 0x8d00, 0x1e70, 0xfeed, 0xbd37, 0x1, 0x1);
        gbc.writeMem(0xa8f6, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x8d);
        EXPECT(gbc.b(),  0x1e);
        EXPECT(gbc.c(),  0x70);
        EXPECT(gbc.d(),  0xfe);
        EXPECT(gbc.e(),  0xed);
        EXPECT(gbc.h(),  0xbd);
        EXPECT(gbc.l(),  0x37);
        EXPECT(gbc.sp(), 0xa0d6);
        EXPECT(gbc.pc(), 0xa8f7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa8f6), 0x5b);
        // 5B 03B7
        gbc.setState(0xa372, 0x5479, 0xc4c0, 0x54c, 0xd330, 0xf57d, 0x1, 0x0);
        gbc.writeMem(0xa372, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xc4);
        EXPECT(gbc.b(),  0x5);
        EXPECT(gbc.c(),  0x4c);
        EXPECT(gbc.d(),  0xd3);
        EXPECT(gbc.e(),  0x30);
        EXPECT(gbc.h(),  0xf5);
        EXPECT(gbc.l(),  0x7d);
        EXPECT(gbc.sp(), 0x5479);
        EXPECT(gbc.pc(), 0xa373);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa372), 0x5b);
        // 5B 03B8
        gbc.setState(0xba4d, 0xa036, 0xe670, 0x53cb, 0x480f, 0x95c2, 0x0, 0x1);
        gbc.writeMem(0xba4d, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xe6);
        EXPECT(gbc.b(),  0x53);
        EXPECT(gbc.c(),  0xcb);
        EXPECT(gbc.d(),  0x48);
        EXPECT(gbc.e(),  0xf);
        EXPECT(gbc.h(),  0x95);
        EXPECT(gbc.l(),  0xc2);
        EXPECT(gbc.sp(), 0xa036);
        EXPECT(gbc.pc(), 0xba4e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xba4d), 0x5b);
        // 5B 03B9
        gbc.setState(0x272, 0xab6f, 0x460, 0x8388, 0xab2f, 0x92be, 0x0, 0x0);
        gbc.writeMem(0x272, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0x83);
        EXPECT(gbc.c(),  0x88);
        EXPECT(gbc.d(),  0xab);
        EXPECT(gbc.e(),  0x2f);
        EXPECT(gbc.h(),  0x92);
        EXPECT(gbc.l(),  0xbe);
        EXPECT(gbc.sp(), 0xab6f);
        EXPECT(gbc.pc(), 0x273);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 03BA
        gbc.setState(0x43a, 0x1448, 0xcc10, 0xddef, 0x8dc0, 0x271d, 0x0, 0x1);
        gbc.writeMem(0x43a, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xcc);
        EXPECT(gbc.b(),  0xdd);
        EXPECT(gbc.c(),  0xef);
        EXPECT(gbc.d(),  0x8d);
        EXPECT(gbc.e(),  0xc0);
        EXPECT(gbc.h(),  0x27);
        EXPECT(gbc.l(),  0x1d);
        EXPECT(gbc.sp(), 0x1448);
        EXPECT(gbc.pc(), 0x43b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 03BB
        gbc.setState(0xe676, 0x14d6, 0xc020, 0x15a9, 0x3917, 0xb1c2, 0x0, 0x1);
        gbc.writeMem(0xe676, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xc0);
        EXPECT(gbc.b(),  0x15);
        EXPECT(gbc.c(),  0xa9);
        EXPECT(gbc.d(),  0x39);
        EXPECT(gbc.e(),  0x17);
        EXPECT(gbc.h(),  0xb1);
        EXPECT(gbc.l(),  0xc2);
        EXPECT(gbc.sp(), 0x14d6);
        EXPECT(gbc.pc(), 0xe677);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe676), 0x5b);
        // 5B 03BC
        gbc.setState(0x680f, 0x64e1, 0x480, 0x3ad5, 0x2905, 0xf256, 0x1, 0x1);
        gbc.writeMem(0x680f, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0x3a);
        EXPECT(gbc.c(),  0xd5);
        EXPECT(gbc.d(),  0x29);
        EXPECT(gbc.e(),  0x5);
        EXPECT(gbc.h(),  0xf2);
        EXPECT(gbc.l(),  0x56);
        EXPECT(gbc.sp(), 0x64e1);
        EXPECT(gbc.pc(), 0x6810);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 03BD
        gbc.setState(0x3f5f, 0x879a, 0xd3f0, 0x349e, 0xc820, 0xf580, 0x0, 0x1);
        gbc.writeMem(0x3f5f, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd3);
        EXPECT(gbc.b(),  0x34);
        EXPECT(gbc.c(),  0x9e);
        EXPECT(gbc.d(),  0xc8);
        EXPECT(gbc.e(),  0x20);
        EXPECT(gbc.h(),  0xf5);
        EXPECT(gbc.l(),  0x80);
        EXPECT(gbc.sp(), 0x879a);
        EXPECT(gbc.pc(), 0x3f60);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 03BE
        gbc.setState(0x7724, 0xf28f, 0xa460, 0x51f1, 0xf953, 0xa80, 0x0, 0x0);
        gbc.writeMem(0x7724, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa4);
        EXPECT(gbc.b(),  0x51);
        EXPECT(gbc.c(),  0xf1);
        EXPECT(gbc.d(),  0xf9);
        EXPECT(gbc.e(),  0x53);
        EXPECT(gbc.h(),  0xa);
        EXPECT(gbc.l(),  0x80);
        EXPECT(gbc.sp(), 0xf28f);
        EXPECT(gbc.pc(), 0x7725);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 03BF
        gbc.setState(0x6782, 0xf290, 0xa7d0, 0xcce8, 0xa921, 0x5a0b, 0x0, 0x0);
        gbc.writeMem(0x6782, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa7);
        EXPECT(gbc.b(),  0xcc);
        EXPECT(gbc.c(),  0xe8);
        EXPECT(gbc.d(),  0xa9);
        EXPECT(gbc.e(),  0x21);
        EXPECT(gbc.h(),  0x5a);
        EXPECT(gbc.l(),  0xb);
        EXPECT(gbc.sp(), 0xf290);
        EXPECT(gbc.pc(), 0x6783);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 03C1
        gbc.setState(0x832e, 0x295a, 0xc8a0, 0x149a, 0xaaee, 0x767f, 0x0, 0x0);
        gbc.writeMem(0x832e, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xc8);
        EXPECT(gbc.b(),  0x14);
        EXPECT(gbc.c(),  0x9a);
        EXPECT(gbc.d(),  0xaa);
        EXPECT(gbc.e(),  0xee);
        EXPECT(gbc.h(),  0x76);
        EXPECT(gbc.l(),  0x7f);
        EXPECT(gbc.sp(), 0x295a);
        EXPECT(gbc.pc(), 0x832f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x832e), 0x5b);
        // 5B 03C2
        gbc.setState(0x41ea, 0xfd6e, 0x2570, 0xa9ed, 0xdfb9, 0x8e8, 0x0, 0x0);
        gbc.writeMem(0x41ea, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x25);
        EXPECT(gbc.b(),  0xa9);
        EXPECT(gbc.c(),  0xed);
        EXPECT(gbc.d(),  0xdf);
        EXPECT(gbc.e(),  0xb9);
        EXPECT(gbc.h(),  0x8);
        EXPECT(gbc.l(),  0xe8);
        EXPECT(gbc.sp(), 0xfd6e);
        EXPECT(gbc.pc(), 0x41eb);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 03C3
        gbc.setState(0x7335, 0x8c0, 0x94c0, 0x6ce5, 0x62c, 0xf963, 0x0, 0x1);
        gbc.writeMem(0x7335, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x94);
        EXPECT(gbc.b(),  0x6c);
        EXPECT(gbc.c(),  0xe5);
        EXPECT(gbc.d(),  0x6);
        EXPECT(gbc.e(),  0x2c);
        EXPECT(gbc.h(),  0xf9);
        EXPECT(gbc.l(),  0x63);
        EXPECT(gbc.sp(), 0x8c0);
        EXPECT(gbc.pc(), 0x7336);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 03C4
        gbc.setState(0x8881, 0x5c7c, 0x97d0, 0x8533, 0x89b0, 0x7776, 0x1, 0x1);
        gbc.writeMem(0x8881, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x97);
        EXPECT(gbc.b(),  0x85);
        EXPECT(gbc.c(),  0x33);
        EXPECT(gbc.d(),  0x89);
        EXPECT(gbc.e(),  0xb0);
        EXPECT(gbc.h(),  0x77);
        EXPECT(gbc.l(),  0x76);
        EXPECT(gbc.sp(), 0x5c7c);
        EXPECT(gbc.pc(), 0x8882);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8881), 0x5b);
        // 5B 03C5
        gbc.setState(0x7746, 0xefe3, 0x8d60, 0xc328, 0xeaed, 0x42eb, 0x1, 0x1);
        gbc.writeMem(0x7746, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x8d);
        EXPECT(gbc.b(),  0xc3);
        EXPECT(gbc.c(),  0x28);
        EXPECT(gbc.d(),  0xea);
        EXPECT(gbc.e(),  0xed);
        EXPECT(gbc.h(),  0x42);
        EXPECT(gbc.l(),  0xeb);
        EXPECT(gbc.sp(), 0xefe3);
        EXPECT(gbc.pc(), 0x7747);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 03C6
        gbc.setState(0x92f2, 0x30d5, 0xcc00, 0xa98f, 0xb935, 0x4a7d, 0x1, 0x1);
        gbc.writeMem(0x92f2, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xcc);
        EXPECT(gbc.b(),  0xa9);
        EXPECT(gbc.c(),  0x8f);
        EXPECT(gbc.d(),  0xb9);
        EXPECT(gbc.e(),  0x35);
        EXPECT(gbc.h(),  0x4a);
        EXPECT(gbc.l(),  0x7d);
        EXPECT(gbc.sp(), 0x30d5);
        EXPECT(gbc.pc(), 0x92f3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x92f2), 0x5b);
        // 5B 03C7
        gbc.setState(0x527, 0x3a65, 0x2370, 0x6f80, 0xd40b, 0x9742, 0x0, 0x1);
        gbc.writeMem(0x527, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x23);
        EXPECT(gbc.b(),  0x6f);
        EXPECT(gbc.c(),  0x80);
        EXPECT(gbc.d(),  0xd4);
        EXPECT(gbc.e(),  0xb);
        EXPECT(gbc.h(),  0x97);
        EXPECT(gbc.l(),  0x42);
        EXPECT(gbc.sp(), 0x3a65);
        EXPECT(gbc.pc(), 0x528);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 03C8
        gbc.setState(0x2a32, 0x1a12, 0x1e00, 0x2c0b, 0xd0dc, 0x48d0, 0x1, 0x1);
        gbc.writeMem(0x2a32, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x1e);
        EXPECT(gbc.b(),  0x2c);
        EXPECT(gbc.c(),  0xb);
        EXPECT(gbc.d(),  0xd0);
        EXPECT(gbc.e(),  0xdc);
        EXPECT(gbc.h(),  0x48);
        EXPECT(gbc.l(),  0xd0);
        EXPECT(gbc.sp(), 0x1a12);
        EXPECT(gbc.pc(), 0x2a33);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 03C9
        gbc.setState(0x9e9b, 0x8036, 0x7600, 0xd5cb, 0x5d91, 0x98e, 0x1, 0x1);
        gbc.writeMem(0x9e9b, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x76);
        EXPECT(gbc.b(),  0xd5);
        EXPECT(gbc.c(),  0xcb);
        EXPECT(gbc.d(),  0x5d);
        EXPECT(gbc.e(),  0x91);
        EXPECT(gbc.h(),  0x9);
        EXPECT(gbc.l(),  0x8e);
        EXPECT(gbc.sp(), 0x8036);
        EXPECT(gbc.pc(), 0x9e9c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9e9b), 0x5b);
        // 5B 03CA
        gbc.setState(0xcf0a, 0x358e, 0x4940, 0x390c, 0x66ac, 0x3e7f, 0x0, 0x1);
        gbc.writeMem(0xcf0a, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x49);
        EXPECT(gbc.b(),  0x39);
        EXPECT(gbc.c(),  0xc);
        EXPECT(gbc.d(),  0x66);
        EXPECT(gbc.e(),  0xac);
        EXPECT(gbc.h(),  0x3e);
        EXPECT(gbc.l(),  0x7f);
        EXPECT(gbc.sp(), 0x358e);
        EXPECT(gbc.pc(), 0xcf0b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcf0a), 0x5b);
        // 5B 03CB
        gbc.setState(0x2600, 0xd44b, 0xb560, 0xe1a7, 0x4e80, 0x10b5, 0x1, 0x1);
        gbc.writeMem(0x2600, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xb5);
        EXPECT(gbc.b(),  0xe1);
        EXPECT(gbc.c(),  0xa7);
        EXPECT(gbc.d(),  0x4e);
        EXPECT(gbc.e(),  0x80);
        EXPECT(gbc.h(),  0x10);
        EXPECT(gbc.l(),  0xb5);
        EXPECT(gbc.sp(), 0xd44b);
        EXPECT(gbc.pc(), 0x2601);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 03CC
        gbc.setState(0x9322, 0x4ae1, 0x1bd0, 0xa223, 0x1a6b, 0x1262, 0x0, 0x0);
        gbc.writeMem(0x9322, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x1b);
        EXPECT(gbc.b(),  0xa2);
        EXPECT(gbc.c(),  0x23);
        EXPECT(gbc.d(),  0x1a);
        EXPECT(gbc.e(),  0x6b);
        EXPECT(gbc.h(),  0x12);
        EXPECT(gbc.l(),  0x62);
        EXPECT(gbc.sp(), 0x4ae1);
        EXPECT(gbc.pc(), 0x9323);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9322), 0x5b);
        // 5B 03CD
        gbc.setState(0xc02c, 0x28df, 0x5580, 0xb717, 0xc1e9, 0xe596, 0x1, 0x1);
        gbc.writeMem(0xc02c, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x55);
        EXPECT(gbc.b(),  0xb7);
        EXPECT(gbc.c(),  0x17);
        EXPECT(gbc.d(),  0xc1);
        EXPECT(gbc.e(),  0xe9);
        EXPECT(gbc.h(),  0xe5);
        EXPECT(gbc.l(),  0x96);
        EXPECT(gbc.sp(), 0x28df);
        EXPECT(gbc.pc(), 0xc02d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc02c), 0x5b);
        // 5B 03CE
        gbc.setState(0x7368, 0x2d40, 0x2df0, 0xa59, 0x5a98, 0xa2d8, 0x1, 0x1);
        gbc.writeMem(0x7368, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x2d);
        EXPECT(gbc.b(),  0xa);
        EXPECT(gbc.c(),  0x59);
        EXPECT(gbc.d(),  0x5a);
        EXPECT(gbc.e(),  0x98);
        EXPECT(gbc.h(),  0xa2);
        EXPECT(gbc.l(),  0xd8);
        EXPECT(gbc.sp(), 0x2d40);
        EXPECT(gbc.pc(), 0x7369);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 03CF
        gbc.setState(0x9772, 0x87d5, 0xa0f0, 0x85c2, 0x69e6, 0x8dca, 0x1, 0x0);
        gbc.writeMem(0x9772, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa0);
        EXPECT(gbc.b(),  0x85);
        EXPECT(gbc.c(),  0xc2);
        EXPECT(gbc.d(),  0x69);
        EXPECT(gbc.e(),  0xe6);
        EXPECT(gbc.h(),  0x8d);
        EXPECT(gbc.l(),  0xca);
        EXPECT(gbc.sp(), 0x87d5);
        EXPECT(gbc.pc(), 0x9773);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9772), 0x5b);
        // 5B 03D0
        gbc.setState(0x7c9d, 0x8c07, 0x5e80, 0xf878, 0x41ef, 0x4b86, 0x0, 0x0);
        gbc.writeMem(0x7c9d, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x5e);
        EXPECT(gbc.b(),  0xf8);
        EXPECT(gbc.c(),  0x78);
        EXPECT(gbc.d(),  0x41);
        EXPECT(gbc.e(),  0xef);
        EXPECT(gbc.h(),  0x4b);
        EXPECT(gbc.l(),  0x86);
        EXPECT(gbc.sp(), 0x8c07);
        EXPECT(gbc.pc(), 0x7c9e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 03D2
        gbc.setState(0x95d6, 0x5151, 0xa780, 0x2331, 0xe960, 0x7380, 0x1, 0x0);
        gbc.writeMem(0x95d6, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xa7);
        EXPECT(gbc.b(),  0x23);
        EXPECT(gbc.c(),  0x31);
        EXPECT(gbc.d(),  0xe9);
        EXPECT(gbc.e(),  0x60);
        EXPECT(gbc.h(),  0x73);
        EXPECT(gbc.l(),  0x80);
        EXPECT(gbc.sp(), 0x5151);
        EXPECT(gbc.pc(), 0x95d7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x95d6), 0x5b);
        // 5B 03D3
        gbc.setState(0x64b3, 0x1447, 0x46f0, 0x2b2c, 0xe62e, 0x8255, 0x0, 0x1);
        gbc.writeMem(0x64b3, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x46);
        EXPECT(gbc.b(),  0x2b);
        EXPECT(gbc.c(),  0x2c);
        EXPECT(gbc.d(),  0xe6);
        EXPECT(gbc.e(),  0x2e);
        EXPECT(gbc.h(),  0x82);
        EXPECT(gbc.l(),  0x55);
        EXPECT(gbc.sp(), 0x1447);
        EXPECT(gbc.pc(), 0x64b4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 03D4
        gbc.setState(0xe236, 0x240b, 0x4650, 0x1c64, 0x5a20, 0x777f, 0x0, 0x1);
        gbc.writeMem(0xe236, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x46);
        EXPECT(gbc.b(),  0x1c);
        EXPECT(gbc.c(),  0x64);
        EXPECT(gbc.d(),  0x5a);
        EXPECT(gbc.e(),  0x20);
        EXPECT(gbc.h(),  0x77);
        EXPECT(gbc.l(),  0x7f);
        EXPECT(gbc.sp(), 0x240b);
        EXPECT(gbc.pc(), 0xe237);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe236), 0x5b);
        // 5B 03D6
        gbc.setState(0x9493, 0xf4c3, 0xe60, 0xbbe5, 0x7768, 0x7eef, 0x0, 0x0);
        gbc.writeMem(0x9493, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xe);
        EXPECT(gbc.b(),  0xbb);
        EXPECT(gbc.c(),  0xe5);
        EXPECT(gbc.d(),  0x77);
        EXPECT(gbc.e(),  0x68);
        EXPECT(gbc.h(),  0x7e);
        EXPECT(gbc.l(),  0xef);
        EXPECT(gbc.sp(), 0xf4c3);
        EXPECT(gbc.pc(), 0x9494);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9493), 0x5b);
        // 5B 03D7
        gbc.setState(0x1283, 0x5696, 0x2ce0, 0x3fe6, 0x7086, 0xcf98, 0x1, 0x1);
        gbc.writeMem(0x1283, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x2c);
        EXPECT(gbc.b(),  0x3f);
        EXPECT(gbc.c(),  0xe6);
        EXPECT(gbc.d(),  0x70);
        EXPECT(gbc.e(),  0x86);
        EXPECT(gbc.h(),  0xcf);
        EXPECT(gbc.l(),  0x98);
        EXPECT(gbc.sp(), 0x5696);
        EXPECT(gbc.pc(), 0x1284);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 03D8
        gbc.setState(0x6ddf, 0x5394, 0x7020, 0xeeb9, 0x2718, 0xdda9, 0x1, 0x1);
        gbc.writeMem(0x6ddf, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x70);
        EXPECT(gbc.b(),  0xee);
        EXPECT(gbc.c(),  0xb9);
        EXPECT(gbc.d(),  0x27);
        EXPECT(gbc.e(),  0x18);
        EXPECT(gbc.h(),  0xdd);
        EXPECT(gbc.l(),  0xa9);
        EXPECT(gbc.sp(), 0x5394);
        EXPECT(gbc.pc(), 0x6de0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 03D9
        gbc.setState(0x877f, 0x7bd4, 0x9320, 0x5565, 0x4973, 0x3521, 0x1, 0x0);
        gbc.writeMem(0x877f, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x93);
        EXPECT(gbc.b(),  0x55);
        EXPECT(gbc.c(),  0x65);
        EXPECT(gbc.d(),  0x49);
        EXPECT(gbc.e(),  0x73);
        EXPECT(gbc.h(),  0x35);
        EXPECT(gbc.l(),  0x21);
        EXPECT(gbc.sp(), 0x7bd4);
        EXPECT(gbc.pc(), 0x8780);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x877f), 0x5b);
        // 5B 03DA
        gbc.setState(0x37cb, 0x6abf, 0x5b80, 0xa937, 0xa29d, 0x345b, 0x0, 0x1);
        gbc.writeMem(0x37cb, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x5b);
        EXPECT(gbc.b(),  0xa9);
        EXPECT(gbc.c(),  0x37);
        EXPECT(gbc.d(),  0xa2);
        EXPECT(gbc.e(),  0x9d);
        EXPECT(gbc.h(),  0x34);
        EXPECT(gbc.l(),  0x5b);
        EXPECT(gbc.sp(), 0x6abf);
        EXPECT(gbc.pc(), 0x37cc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 03DB
        gbc.setState(0xcd2a, 0xd06e, 0x5830, 0xc68d, 0xa0ff, 0xfcb6, 0x0, 0x0);
        gbc.writeMem(0xcd2a, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x58);
        EXPECT(gbc.b(),  0xc6);
        EXPECT(gbc.c(),  0x8d);
        EXPECT(gbc.d(),  0xa0);
        EXPECT(gbc.e(),  0xff);
        EXPECT(gbc.h(),  0xfc);
        EXPECT(gbc.l(),  0xb6);
        EXPECT(gbc.sp(), 0xd06e);
        EXPECT(gbc.pc(), 0xcd2b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcd2a), 0x5b);
        // 5B 03DC
        gbc.setState(0x1d3f, 0xd4dc, 0xd450, 0x3211, 0xe0fd, 0x37d4, 0x0, 0x0);
        gbc.writeMem(0x1d3f, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd4);
        EXPECT(gbc.b(),  0x32);
        EXPECT(gbc.c(),  0x11);
        EXPECT(gbc.d(),  0xe0);
        EXPECT(gbc.e(),  0xfd);
        EXPECT(gbc.h(),  0x37);
        EXPECT(gbc.l(),  0xd4);
        EXPECT(gbc.sp(), 0xd4dc);
        EXPECT(gbc.pc(), 0x1d40);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 5B 03DD
        gbc.setState(0x7ca9, 0xbd75, 0xed60, 0x3398, 0x1277, 0xef7d, 0x0, 0x0);
        gbc.writeMem(0x7ca9, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xed);
        EXPECT(gbc.b(),  0x33);
        EXPECT(gbc.c(),  0x98);
        EXPECT(gbc.d(),  0x12);
        EXPECT(gbc.e(),  0x77);
        EXPECT(gbc.h(),  0xef);
        EXPECT(gbc.l(),  0x7d);
        EXPECT(gbc.sp(), 0xbd75);
        EXPECT(gbc.pc(), 0x7caa);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 03DE
        gbc.setState(0xafe6, 0x5226, 0x3d0, 0x6f0c, 0xb5bd, 0xc61a, 0x1, 0x0);
        gbc.writeMem(0xafe6, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x3);
        EXPECT(gbc.b(),  0x6f);
        EXPECT(gbc.c(),  0xc);
        EXPECT(gbc.d(),  0xb5);
        EXPECT(gbc.e(),  0xbd);
        EXPECT(gbc.h(),  0xc6);
        EXPECT(gbc.l(),  0x1a);
        EXPECT(gbc.sp(), 0x5226);
        EXPECT(gbc.pc(), 0xafe7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xafe6), 0x5b);
        // 5B 03DF
        gbc.setState(0x676c, 0xc374, 0x35e0, 0xfcff, 0xa5ea, 0xb5b7, 0x0, 0x0);
        gbc.writeMem(0x676c, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x35);
        EXPECT(gbc.b(),  0xfc);
        EXPECT(gbc.c(),  0xff);
        EXPECT(gbc.d(),  0xa5);
        EXPECT(gbc.e(),  0xea);
        EXPECT(gbc.h(),  0xb5);
        EXPECT(gbc.l(),  0xb7);
        EXPECT(gbc.sp(), 0xc374);
        EXPECT(gbc.pc(), 0x676d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 03E1
        gbc.setState(0x1195, 0x13ee, 0xc7e0, 0xec06, 0x210e, 0xcd05, 0x0, 0x0);
        gbc.writeMem(0x1195, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xc7);
        EXPECT(gbc.b(),  0xec);
        EXPECT(gbc.c(),  0x6);
        EXPECT(gbc.d(),  0x21);
        EXPECT(gbc.e(),  0xe);
        EXPECT(gbc.h(),  0xcd);
        EXPECT(gbc.l(),  0x5);
        EXPECT(gbc.sp(), 0x13ee);
        EXPECT(gbc.pc(), 0x1196);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 5B 03E2
        gbc.setState(0x59e0, 0xc23d, 0x6b0, 0x73f4, 0x212b, 0xa034, 0x0, 0x0);
        gbc.writeMem(0x59e0, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x6);
        EXPECT(gbc.b(),  0x73);
        EXPECT(gbc.c(),  0xf4);
        EXPECT(gbc.d(),  0x21);
        EXPECT(gbc.e(),  0x2b);
        EXPECT(gbc.h(),  0xa0);
        EXPECT(gbc.l(),  0x34);
        EXPECT(gbc.sp(), 0xc23d);
        EXPECT(gbc.pc(), 0x59e1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 03E3
        gbc.setState(0x49d5, 0x51c7, 0xef30, 0x1a63, 0x5e19, 0x5ac, 0x0, 0x0);
        gbc.writeMem(0x49d5, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xef);
        EXPECT(gbc.b(),  0x1a);
        EXPECT(gbc.c(),  0x63);
        EXPECT(gbc.d(),  0x5e);
        EXPECT(gbc.e(),  0x19);
        EXPECT(gbc.h(),  0x5);
        EXPECT(gbc.l(),  0xac);
        EXPECT(gbc.sp(), 0x51c7);
        EXPECT(gbc.pc(), 0x49d6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 5B 03E4
        gbc.setState(0x9bb5, 0x77eb, 0x2880, 0xfb2f, 0x8d54, 0xb504, 0x0, 0x0);
        gbc.writeMem(0x9bb5, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0xfb);
        EXPECT(gbc.c(),  0x2f);
        EXPECT(gbc.d(),  0x8d);
        EXPECT(gbc.e(),  0x54);
        EXPECT(gbc.h(),  0xb5);
        EXPECT(gbc.l(),  0x4);
        EXPECT(gbc.sp(), 0x77eb);
        EXPECT(gbc.pc(), 0x9bb6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9bb5), 0x5b);
        // 5B 03E5
        gbc.setState(0xd946, 0xfcb1, 0x5e10, 0x51f4, 0xdfd6, 0xf040, 0x0, 0x0);
        gbc.writeMem(0xd946, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x5e);
        EXPECT(gbc.b(),  0x51);
        EXPECT(gbc.c(),  0xf4);
        EXPECT(gbc.d(),  0xdf);
        EXPECT(gbc.e(),  0xd6);
        EXPECT(gbc.h(),  0xf0);
        EXPECT(gbc.l(),  0x40);
        EXPECT(gbc.sp(), 0xfcb1);
        EXPECT(gbc.pc(), 0xd947);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd946), 0x5b);
        // 5B 03E6
        gbc.setState(0x8a5, 0x54bc, 0x4400, 0x9958, 0xeedc, 0xa619, 0x1, 0x0);
        gbc.writeMem(0x8a5, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x44);
        EXPECT(gbc.b(),  0x99);
        EXPECT(gbc.c(),  0x58);
        EXPECT(gbc.d(),  0xee);
        EXPECT(gbc.e(),  0xdc);
        EXPECT(gbc.h(),  0xa6);
        EXPECT(gbc.l(),  0x19);
        EXPECT(gbc.sp(), 0x54bc);
        EXPECT(gbc.pc(), 0x8a6);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 5B 03E7
        gbc.setState(0xccea, 0xbaab, 0x2300, 0xd66b, 0xf9e3, 0xae57, 0x0, 0x1);
        gbc.writeMem(0xccea, { 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0x23);
        EXPECT(gbc.b(),  0xd6);
        EXPECT(gbc.c(),  0x6b);
        EXPECT(gbc.d(),  0xf9);
        EXPECT(gbc.e(),  0xe3);
        EXPECT(gbc.h(),  0xae);
        EXPECT(gbc.l(),  0x57);
        EXPECT(gbc.sp(), 0xbaab);
        EXPECT(gbc.pc(), 0xcceb);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xccea), 0x5b);
    }
}
#endif
