#include "../gbctests_insns.h"
#if (defined GBCEMU_INSNS_TESTS_ALL) || (defined GBCEMU_INSNS_TESTS_cb_04)
#include "../gbctests.h"

namespace rckid::gbcemu {

    TEST(gbcemu, opcode_cb_04) {
        GBCEmu gbc{};
        uint8_t cartridge[0x8000];
        cartridge[0x149] = 0x02; // 8kb external RAM
        gbc.loadCartridge(new FlashGamePak(cartridge));
        // CB 04 0000
        gbc.setState(0x4df6, 0x3e8b, 0x4800, 0x88e1, 0xdbd1, 0x88ef, 0x0, 0x1);
        gbc.writeMem(0x4df6, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x48);
        EXPECT(gbc.b(),  0x88);
        EXPECT(gbc.c(),  0xe1);
        EXPECT(gbc.d(),  0xdb);
        EXPECT(gbc.e(),  0xd1);
        EXPECT(gbc.h(),  0x11);
        EXPECT(gbc.l(),  0xef);
        EXPECT(gbc.sp(), 0x3e8b);
        EXPECT(gbc.pc(), 0x4df8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0001
        gbc.setState(0x8450, 0xbeda, 0xffc0, 0x57ef, 0x435, 0xe9b1, 0x0, 0x0);
        gbc.writeMem(0x8450, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xff);
        EXPECT(gbc.b(),  0x57);
        EXPECT(gbc.c(),  0xef);
        EXPECT(gbc.d(),  0x4);
        EXPECT(gbc.e(),  0x35);
        EXPECT(gbc.h(),  0xd3);
        EXPECT(gbc.l(),  0xb1);
        EXPECT(gbc.sp(), 0xbeda);
        EXPECT(gbc.pc(), 0x8452);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8450), 0xcb);
        EXPECT(gbc.readMem(0x8451), 0x4);
        // CB 04 0002
        gbc.setState(0xc8fc, 0x4fa9, 0xa1e0, 0x4aff, 0x3755, 0x2d44, 0x1, 0x1);
        gbc.writeMem(0xc8fc, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa1);
        EXPECT(gbc.b(),  0x4a);
        EXPECT(gbc.c(),  0xff);
        EXPECT(gbc.d(),  0x37);
        EXPECT(gbc.e(),  0x55);
        EXPECT(gbc.h(),  0x5a);
        EXPECT(gbc.l(),  0x44);
        EXPECT(gbc.sp(), 0x4fa9);
        EXPECT(gbc.pc(), 0xc8fe);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc8fc), 0xcb);
        EXPECT(gbc.readMem(0xc8fd), 0x4);
        // CB 04 0003
        gbc.setState(0xedf4, 0x4de0, 0xf40, 0xa832, 0x10dc, 0x7651, 0x0, 0x1);
        gbc.writeMem(0xedf4, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf);
        EXPECT(gbc.b(),  0xa8);
        EXPECT(gbc.c(),  0x32);
        EXPECT(gbc.d(),  0x10);
        EXPECT(gbc.e(),  0xdc);
        EXPECT(gbc.h(),  0xec);
        EXPECT(gbc.l(),  0x51);
        EXPECT(gbc.sp(), 0x4de0);
        EXPECT(gbc.pc(), 0xedf6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xedf4), 0xcb);
        EXPECT(gbc.readMem(0xedf5), 0x4);
        // CB 04 0004
        gbc.setState(0xcd21, 0x44fa, 0x19d0, 0xe598, 0xb606, 0xdcc, 0x1, 0x1);
        gbc.writeMem(0xcd21, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x19);
        EXPECT(gbc.b(),  0xe5);
        EXPECT(gbc.c(),  0x98);
        EXPECT(gbc.d(),  0xb6);
        EXPECT(gbc.e(),  0x6);
        EXPECT(gbc.h(),  0x1a);
        EXPECT(gbc.l(),  0xcc);
        EXPECT(gbc.sp(), 0x44fa);
        EXPECT(gbc.pc(), 0xcd23);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcd21), 0xcb);
        EXPECT(gbc.readMem(0xcd22), 0x4);
        // CB 04 0005
        gbc.setState(0x7259, 0x9a5d, 0x6050, 0x58b0, 0x7a4b, 0xcfc2, 0x1, 0x1);
        gbc.writeMem(0x7259, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x60);
        EXPECT(gbc.b(),  0x58);
        EXPECT(gbc.c(),  0xb0);
        EXPECT(gbc.d(),  0x7a);
        EXPECT(gbc.e(),  0x4b);
        EXPECT(gbc.h(),  0x9f);
        EXPECT(gbc.l(),  0xc2);
        EXPECT(gbc.sp(), 0x9a5d);
        EXPECT(gbc.pc(), 0x725b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0006
        gbc.setState(0xa23a, 0xbc8d, 0x7cd0, 0xc981, 0x611d, 0xc590, 0x0, 0x0);
        gbc.writeMem(0xa23a, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x7c);
        EXPECT(gbc.b(),  0xc9);
        EXPECT(gbc.c(),  0x81);
        EXPECT(gbc.d(),  0x61);
        EXPECT(gbc.e(),  0x1d);
        EXPECT(gbc.h(),  0x8b);
        EXPECT(gbc.l(),  0x90);
        EXPECT(gbc.sp(), 0xbc8d);
        EXPECT(gbc.pc(), 0xa23c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa23a), 0xcb);
        EXPECT(gbc.readMem(0xa23b), 0x4);
        // CB 04 0007
        gbc.setState(0x28c1, 0xd95b, 0x9d50, 0xfead, 0x3ca5, 0x76d7, 0x1, 0x0);
        gbc.writeMem(0x28c1, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x9d);
        EXPECT(gbc.b(),  0xfe);
        EXPECT(gbc.c(),  0xad);
        EXPECT(gbc.d(),  0x3c);
        EXPECT(gbc.e(),  0xa5);
        EXPECT(gbc.h(),  0xec);
        EXPECT(gbc.l(),  0xd7);
        EXPECT(gbc.sp(), 0xd95b);
        EXPECT(gbc.pc(), 0x28c3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0008
        gbc.setState(0x6499, 0xcd2a, 0x3d0, 0x413f, 0xb3d7, 0x3a77, 0x1, 0x1);
        gbc.writeMem(0x6499, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3);
        EXPECT(gbc.b(),  0x41);
        EXPECT(gbc.c(),  0x3f);
        EXPECT(gbc.d(),  0xb3);
        EXPECT(gbc.e(),  0xd7);
        EXPECT(gbc.h(),  0x74);
        EXPECT(gbc.l(),  0x77);
        EXPECT(gbc.sp(), 0xcd2a);
        EXPECT(gbc.pc(), 0x649b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0009
        gbc.setState(0xad11, 0x1129, 0x2760, 0x4eed, 0x72fc, 0x2cb0, 0x0, 0x0);
        gbc.writeMem(0xad11, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x27);
        EXPECT(gbc.b(),  0x4e);
        EXPECT(gbc.c(),  0xed);
        EXPECT(gbc.d(),  0x72);
        EXPECT(gbc.e(),  0xfc);
        EXPECT(gbc.h(),  0x58);
        EXPECT(gbc.l(),  0xb0);
        EXPECT(gbc.sp(), 0x1129);
        EXPECT(gbc.pc(), 0xad13);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xad11), 0xcb);
        EXPECT(gbc.readMem(0xad12), 0x4);
        // CB 04 000A
        gbc.setState(0xab8b, 0x3c3c, 0xf750, 0x2218, 0x9931, 0xaeae, 0x1, 0x0);
        gbc.writeMem(0xab8b, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf7);
        EXPECT(gbc.b(),  0x22);
        EXPECT(gbc.c(),  0x18);
        EXPECT(gbc.d(),  0x99);
        EXPECT(gbc.e(),  0x31);
        EXPECT(gbc.h(),  0x5d);
        EXPECT(gbc.l(),  0xae);
        EXPECT(gbc.sp(), 0x3c3c);
        EXPECT(gbc.pc(), 0xab8d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xab8b), 0xcb);
        EXPECT(gbc.readMem(0xab8c), 0x4);
        // CB 04 000B
        gbc.setState(0x9c3c, 0x38ab, 0x7610, 0x4da6, 0x5426, 0x6d0d, 0x1, 0x0);
        gbc.writeMem(0x9c3c, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x76);
        EXPECT(gbc.b(),  0x4d);
        EXPECT(gbc.c(),  0xa6);
        EXPECT(gbc.d(),  0x54);
        EXPECT(gbc.e(),  0x26);
        EXPECT(gbc.h(),  0xda);
        EXPECT(gbc.l(),  0xd);
        EXPECT(gbc.sp(), 0x38ab);
        EXPECT(gbc.pc(), 0x9c3e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9c3c), 0xcb);
        EXPECT(gbc.readMem(0x9c3d), 0x4);
        // CB 04 000C
        gbc.setState(0x1d, 0x6126, 0x4af0, 0xdfe4, 0xce92, 0xc8f8, 0x0, 0x1);
        gbc.writeMem(0x1d, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4a);
        EXPECT(gbc.b(),  0xdf);
        EXPECT(gbc.c(),  0xe4);
        EXPECT(gbc.d(),  0xce);
        EXPECT(gbc.e(),  0x92);
        EXPECT(gbc.h(),  0x91);
        EXPECT(gbc.l(),  0xf8);
        EXPECT(gbc.sp(), 0x6126);
        EXPECT(gbc.pc(), 0x1f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 000D
        gbc.setState(0x87b6, 0x4661, 0xd3f0, 0x4223, 0x70ab, 0xfe9, 0x0, 0x0);
        gbc.writeMem(0x87b6, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd3);
        EXPECT(gbc.b(),  0x42);
        EXPECT(gbc.c(),  0x23);
        EXPECT(gbc.d(),  0x70);
        EXPECT(gbc.e(),  0xab);
        EXPECT(gbc.h(),  0x1e);
        EXPECT(gbc.l(),  0xe9);
        EXPECT(gbc.sp(), 0x4661);
        EXPECT(gbc.pc(), 0x87b8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x87b6), 0xcb);
        EXPECT(gbc.readMem(0x87b7), 0x4);
        // CB 04 000E
        gbc.setState(0x1575, 0xe570, 0xb60, 0x544a, 0x96a7, 0x5da2, 0x0, 0x1);
        gbc.writeMem(0x1575, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb);
        EXPECT(gbc.b(),  0x54);
        EXPECT(gbc.c(),  0x4a);
        EXPECT(gbc.d(),  0x96);
        EXPECT(gbc.e(),  0xa7);
        EXPECT(gbc.h(),  0xba);
        EXPECT(gbc.l(),  0xa2);
        EXPECT(gbc.sp(), 0xe570);
        EXPECT(gbc.pc(), 0x1577);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 000F
        gbc.setState(0x795e, 0x739e, 0xebc0, 0x3c7d, 0x4a3f, 0x911d, 0x1, 0x1);
        gbc.writeMem(0x795e, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xeb);
        EXPECT(gbc.b(),  0x3c);
        EXPECT(gbc.c(),  0x7d);
        EXPECT(gbc.d(),  0x4a);
        EXPECT(gbc.e(),  0x3f);
        EXPECT(gbc.h(),  0x23);
        EXPECT(gbc.l(),  0x1d);
        EXPECT(gbc.sp(), 0x739e);
        EXPECT(gbc.pc(), 0x7960);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0010
        gbc.setState(0xb994, 0x48e6, 0x3ac0, 0x15d3, 0xeb02, 0x5915, 0x0, 0x0);
        gbc.writeMem(0xb994, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3a);
        EXPECT(gbc.b(),  0x15);
        EXPECT(gbc.c(),  0xd3);
        EXPECT(gbc.d(),  0xeb);
        EXPECT(gbc.e(),  0x2);
        EXPECT(gbc.h(),  0xb2);
        EXPECT(gbc.l(),  0x15);
        EXPECT(gbc.sp(), 0x48e6);
        EXPECT(gbc.pc(), 0xb996);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb994), 0xcb);
        EXPECT(gbc.readMem(0xb995), 0x4);
        // CB 04 0011
        gbc.setState(0xac22, 0xe65b, 0xe4a0, 0xcf78, 0xe419, 0xfdca, 0x1, 0x1);
        gbc.writeMem(0xac22, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe4);
        EXPECT(gbc.b(),  0xcf);
        EXPECT(gbc.c(),  0x78);
        EXPECT(gbc.d(),  0xe4);
        EXPECT(gbc.e(),  0x19);
        EXPECT(gbc.h(),  0xfb);
        EXPECT(gbc.l(),  0xca);
        EXPECT(gbc.sp(), 0xe65b);
        EXPECT(gbc.pc(), 0xac24);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xac22), 0xcb);
        EXPECT(gbc.readMem(0xac23), 0x4);
        // CB 04 0012
        gbc.setState(0xbd2f, 0xafba, 0xa50, 0xd7b1, 0xa8cc, 0x15df, 0x0, 0x1);
        gbc.writeMem(0xbd2f, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa);
        EXPECT(gbc.b(),  0xd7);
        EXPECT(gbc.c(),  0xb1);
        EXPECT(gbc.d(),  0xa8);
        EXPECT(gbc.e(),  0xcc);
        EXPECT(gbc.h(),  0x2a);
        EXPECT(gbc.l(),  0xdf);
        EXPECT(gbc.sp(), 0xafba);
        EXPECT(gbc.pc(), 0xbd31);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbd2f), 0xcb);
        EXPECT(gbc.readMem(0xbd30), 0x4);
        // CB 04 0013
        gbc.setState(0xb5d6, 0xeaf, 0xef20, 0x96a0, 0x8e3e, 0xfc38, 0x1, 0x0);
        gbc.writeMem(0xb5d6, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xef);
        EXPECT(gbc.b(),  0x96);
        EXPECT(gbc.c(),  0xa0);
        EXPECT(gbc.d(),  0x8e);
        EXPECT(gbc.e(),  0x3e);
        EXPECT(gbc.h(),  0xf9);
        EXPECT(gbc.l(),  0x38);
        EXPECT(gbc.sp(), 0xeaf);
        EXPECT(gbc.pc(), 0xb5d8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb5d6), 0xcb);
        EXPECT(gbc.readMem(0xb5d7), 0x4);
        // CB 04 0014
        gbc.setState(0x53ba, 0x58c0, 0x5e00, 0x283d, 0x9ced, 0x30dc, 0x0, 0x0);
        gbc.writeMem(0x53ba, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x5e);
        EXPECT(gbc.b(),  0x28);
        EXPECT(gbc.c(),  0x3d);
        EXPECT(gbc.d(),  0x9c);
        EXPECT(gbc.e(),  0xed);
        EXPECT(gbc.h(),  0x60);
        EXPECT(gbc.l(),  0xdc);
        EXPECT(gbc.sp(), 0x58c0);
        EXPECT(gbc.pc(), 0x53bc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0015
        gbc.setState(0x3ce5, 0x83d8, 0xf4a0, 0x42d4, 0x1018, 0x2e23, 0x0, 0x0);
        gbc.writeMem(0x3ce5, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf4);
        EXPECT(gbc.b(),  0x42);
        EXPECT(gbc.c(),  0xd4);
        EXPECT(gbc.d(),  0x10);
        EXPECT(gbc.e(),  0x18);
        EXPECT(gbc.h(),  0x5c);
        EXPECT(gbc.l(),  0x23);
        EXPECT(gbc.sp(), 0x83d8);
        EXPECT(gbc.pc(), 0x3ce7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0016
        gbc.setState(0xce60, 0x35ad, 0x7ba0, 0xa38e, 0x216d, 0x5b3b, 0x1, 0x1);
        gbc.writeMem(0xce60, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x7b);
        EXPECT(gbc.b(),  0xa3);
        EXPECT(gbc.c(),  0x8e);
        EXPECT(gbc.d(),  0x21);
        EXPECT(gbc.e(),  0x6d);
        EXPECT(gbc.h(),  0xb6);
        EXPECT(gbc.l(),  0x3b);
        EXPECT(gbc.sp(), 0x35ad);
        EXPECT(gbc.pc(), 0xce62);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xce60), 0xcb);
        EXPECT(gbc.readMem(0xce61), 0x4);
        // CB 04 0017
        gbc.setState(0x497, 0xfede, 0x8160, 0xcdab, 0x7e52, 0x301b, 0x0, 0x0);
        gbc.writeMem(0x497, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x81);
        EXPECT(gbc.b(),  0xcd);
        EXPECT(gbc.c(),  0xab);
        EXPECT(gbc.d(),  0x7e);
        EXPECT(gbc.e(),  0x52);
        EXPECT(gbc.h(),  0x60);
        EXPECT(gbc.l(),  0x1b);
        EXPECT(gbc.sp(), 0xfede);
        EXPECT(gbc.pc(), 0x499);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0018
        gbc.setState(0x9cf8, 0xb69b, 0xaae0, 0x27ff, 0xd33e, 0xa069, 0x1, 0x0);
        gbc.writeMem(0x9cf8, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xaa);
        EXPECT(gbc.b(),  0x27);
        EXPECT(gbc.c(),  0xff);
        EXPECT(gbc.d(),  0xd3);
        EXPECT(gbc.e(),  0x3e);
        EXPECT(gbc.h(),  0x41);
        EXPECT(gbc.l(),  0x69);
        EXPECT(gbc.sp(), 0xb69b);
        EXPECT(gbc.pc(), 0x9cfa);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9cf8), 0xcb);
        EXPECT(gbc.readMem(0x9cf9), 0x4);
        // CB 04 0019
        gbc.setState(0xd557, 0x73ef, 0x2750, 0xec7d, 0x1485, 0xec53, 0x0, 0x0);
        gbc.writeMem(0xd557, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x27);
        EXPECT(gbc.b(),  0xec);
        EXPECT(gbc.c(),  0x7d);
        EXPECT(gbc.d(),  0x14);
        EXPECT(gbc.e(),  0x85);
        EXPECT(gbc.h(),  0xd9);
        EXPECT(gbc.l(),  0x53);
        EXPECT(gbc.sp(), 0x73ef);
        EXPECT(gbc.pc(), 0xd559);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd557), 0xcb);
        EXPECT(gbc.readMem(0xd558), 0x4);
        // CB 04 001A
        gbc.setState(0xcb6d, 0xce4f, 0xd610, 0x58a2, 0x89cb, 0x8b68, 0x1, 0x1);
        gbc.writeMem(0xcb6d, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd6);
        EXPECT(gbc.b(),  0x58);
        EXPECT(gbc.c(),  0xa2);
        EXPECT(gbc.d(),  0x89);
        EXPECT(gbc.e(),  0xcb);
        EXPECT(gbc.h(),  0x17);
        EXPECT(gbc.l(),  0x68);
        EXPECT(gbc.sp(), 0xce4f);
        EXPECT(gbc.pc(), 0xcb6f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcb6d), 0xcb);
        EXPECT(gbc.readMem(0xcb6e), 0x4);
        // CB 04 001B
        gbc.setState(0x2dd6, 0x7f3a, 0x81c0, 0x430b, 0x4c3b, 0x880, 0x0, 0x0);
        gbc.writeMem(0x2dd6, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x81);
        EXPECT(gbc.b(),  0x43);
        EXPECT(gbc.c(),  0xb);
        EXPECT(gbc.d(),  0x4c);
        EXPECT(gbc.e(),  0x3b);
        EXPECT(gbc.h(),  0x10);
        EXPECT(gbc.l(),  0x80);
        EXPECT(gbc.sp(), 0x7f3a);
        EXPECT(gbc.pc(), 0x2dd8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 001D
        gbc.setState(0x9ef1, 0x92e3, 0xe180, 0xa93d, 0x3c41, 0x36ee, 0x1, 0x1);
        gbc.writeMem(0x9ef1, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe1);
        EXPECT(gbc.b(),  0xa9);
        EXPECT(gbc.c(),  0x3d);
        EXPECT(gbc.d(),  0x3c);
        EXPECT(gbc.e(),  0x41);
        EXPECT(gbc.h(),  0x6c);
        EXPECT(gbc.l(),  0xee);
        EXPECT(gbc.sp(), 0x92e3);
        EXPECT(gbc.pc(), 0x9ef3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9ef1), 0xcb);
        EXPECT(gbc.readMem(0x9ef2), 0x4);
        // CB 04 001E
        gbc.setState(0x65df, 0x8d37, 0x3c70, 0x76bf, 0x18bd, 0xeba9, 0x0, 0x0);
        gbc.writeMem(0x65df, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3c);
        EXPECT(gbc.b(),  0x76);
        EXPECT(gbc.c(),  0xbf);
        EXPECT(gbc.d(),  0x18);
        EXPECT(gbc.e(),  0xbd);
        EXPECT(gbc.h(),  0xd7);
        EXPECT(gbc.l(),  0xa9);
        EXPECT(gbc.sp(), 0x8d37);
        EXPECT(gbc.pc(), 0x65e1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 001F
        gbc.setState(0xe5b, 0xaa84, 0x4ce0, 0x5b07, 0x7e75, 0xf8d0, 0x0, 0x0);
        gbc.writeMem(0xe5b, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4c);
        EXPECT(gbc.b(),  0x5b);
        EXPECT(gbc.c(),  0x7);
        EXPECT(gbc.d(),  0x7e);
        EXPECT(gbc.e(),  0x75);
        EXPECT(gbc.h(),  0xf1);
        EXPECT(gbc.l(),  0xd0);
        EXPECT(gbc.sp(), 0xaa84);
        EXPECT(gbc.pc(), 0xe5d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0020
        gbc.setState(0xc4da, 0x6c8f, 0x2ba0, 0x724, 0x67a3, 0xc223, 0x0, 0x1);
        gbc.writeMem(0xc4da, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2b);
        EXPECT(gbc.b(),  0x7);
        EXPECT(gbc.c(),  0x24);
        EXPECT(gbc.d(),  0x67);
        EXPECT(gbc.e(),  0xa3);
        EXPECT(gbc.h(),  0x85);
        EXPECT(gbc.l(),  0x23);
        EXPECT(gbc.sp(), 0x6c8f);
        EXPECT(gbc.pc(), 0xc4dc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc4da), 0xcb);
        EXPECT(gbc.readMem(0xc4db), 0x4);
        // CB 04 0021
        gbc.setState(0x283d, 0xeca6, 0xd860, 0x36f, 0x86d7, 0xace8, 0x1, 0x0);
        gbc.writeMem(0x283d, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd8);
        EXPECT(gbc.b(),  0x3);
        EXPECT(gbc.c(),  0x6f);
        EXPECT(gbc.d(),  0x86);
        EXPECT(gbc.e(),  0xd7);
        EXPECT(gbc.h(),  0x59);
        EXPECT(gbc.l(),  0xe8);
        EXPECT(gbc.sp(), 0xeca6);
        EXPECT(gbc.pc(), 0x283f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0022
        gbc.setState(0x7408, 0x258c, 0x6680, 0x506d, 0xdb06, 0x265f, 0x1, 0x1);
        gbc.writeMem(0x7408, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x66);
        EXPECT(gbc.b(),  0x50);
        EXPECT(gbc.c(),  0x6d);
        EXPECT(gbc.d(),  0xdb);
        EXPECT(gbc.e(),  0x6);
        EXPECT(gbc.h(),  0x4c);
        EXPECT(gbc.l(),  0x5f);
        EXPECT(gbc.sp(), 0x258c);
        EXPECT(gbc.pc(), 0x740a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0023
        gbc.setState(0xe1c7, 0xed0a, 0x10f0, 0xfe84, 0xe50e, 0x926d, 0x1, 0x1);
        gbc.writeMem(0xe1c7, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0xfe);
        EXPECT(gbc.c(),  0x84);
        EXPECT(gbc.d(),  0xe5);
        EXPECT(gbc.e(),  0xe);
        EXPECT(gbc.h(),  0x25);
        EXPECT(gbc.l(),  0x6d);
        EXPECT(gbc.sp(), 0xed0a);
        EXPECT(gbc.pc(), 0xe1c9);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe1c7), 0xcb);
        EXPECT(gbc.readMem(0xe1c8), 0x4);
        // CB 04 0024
        gbc.setState(0x4b0b, 0xb1c, 0x13a0, 0x66d4, 0x4328, 0x4a42, 0x0, 0x0);
        gbc.writeMem(0x4b0b, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x13);
        EXPECT(gbc.b(),  0x66);
        EXPECT(gbc.c(),  0xd4);
        EXPECT(gbc.d(),  0x43);
        EXPECT(gbc.e(),  0x28);
        EXPECT(gbc.h(),  0x94);
        EXPECT(gbc.l(),  0x42);
        EXPECT(gbc.sp(), 0xb1c);
        EXPECT(gbc.pc(), 0x4b0d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0025
        gbc.setState(0x1a9c, 0x434c, 0x7b80, 0x7ac4, 0xf0d, 0xe9a6, 0x1, 0x0);
        gbc.writeMem(0x1a9c, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x7b);
        EXPECT(gbc.b(),  0x7a);
        EXPECT(gbc.c(),  0xc4);
        EXPECT(gbc.d(),  0xf);
        EXPECT(gbc.e(),  0xd);
        EXPECT(gbc.h(),  0xd3);
        EXPECT(gbc.l(),  0xa6);
        EXPECT(gbc.sp(), 0x434c);
        EXPECT(gbc.pc(), 0x1a9e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0026
        gbc.setState(0x72b2, 0x7e0, 0xd080, 0x97e6, 0x86e0, 0x4103, 0x0, 0x1);
        gbc.writeMem(0x72b2, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd0);
        EXPECT(gbc.b(),  0x97);
        EXPECT(gbc.c(),  0xe6);
        EXPECT(gbc.d(),  0x86);
        EXPECT(gbc.e(),  0xe0);
        EXPECT(gbc.h(),  0x82);
        EXPECT(gbc.l(),  0x3);
        EXPECT(gbc.sp(), 0x7e0);
        EXPECT(gbc.pc(), 0x72b4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0027
        gbc.setState(0x28d5, 0x9554, 0x9040, 0x54e5, 0xa2ec, 0x2bef, 0x1, 0x0);
        gbc.writeMem(0x28d5, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x90);
        EXPECT(gbc.b(),  0x54);
        EXPECT(gbc.c(),  0xe5);
        EXPECT(gbc.d(),  0xa2);
        EXPECT(gbc.e(),  0xec);
        EXPECT(gbc.h(),  0x56);
        EXPECT(gbc.l(),  0xef);
        EXPECT(gbc.sp(), 0x9554);
        EXPECT(gbc.pc(), 0x28d7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0028
        gbc.setState(0xa321, 0x4d72, 0x9ca0, 0x9c0f, 0x1730, 0xcd55, 0x1, 0x0);
        gbc.writeMem(0xa321, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x9c);
        EXPECT(gbc.b(),  0x9c);
        EXPECT(gbc.c(),  0xf);
        EXPECT(gbc.d(),  0x17);
        EXPECT(gbc.e(),  0x30);
        EXPECT(gbc.h(),  0x9b);
        EXPECT(gbc.l(),  0x55);
        EXPECT(gbc.sp(), 0x4d72);
        EXPECT(gbc.pc(), 0xa323);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa321), 0xcb);
        EXPECT(gbc.readMem(0xa322), 0x4);
        // CB 04 0029
        gbc.setState(0xa701, 0xcab0, 0x1920, 0xe2cc, 0x1291, 0x3417, 0x1, 0x1);
        gbc.writeMem(0xa701, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x19);
        EXPECT(gbc.b(),  0xe2);
        EXPECT(gbc.c(),  0xcc);
        EXPECT(gbc.d(),  0x12);
        EXPECT(gbc.e(),  0x91);
        EXPECT(gbc.h(),  0x68);
        EXPECT(gbc.l(),  0x17);
        EXPECT(gbc.sp(), 0xcab0);
        EXPECT(gbc.pc(), 0xa703);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa701), 0xcb);
        EXPECT(gbc.readMem(0xa702), 0x4);
        // CB 04 002A
        gbc.setState(0x570e, 0x62d4, 0xc3d0, 0x3af1, 0x783, 0x9402, 0x1, 0x1);
        gbc.writeMem(0x570e, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc3);
        EXPECT(gbc.b(),  0x3a);
        EXPECT(gbc.c(),  0xf1);
        EXPECT(gbc.d(),  0x7);
        EXPECT(gbc.e(),  0x83);
        EXPECT(gbc.h(),  0x29);
        EXPECT(gbc.l(),  0x2);
        EXPECT(gbc.sp(), 0x62d4);
        EXPECT(gbc.pc(), 0x5710);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 002B
        gbc.setState(0xa571, 0xfca3, 0xb1b0, 0x5d2f, 0xb475, 0x788b, 0x0, 0x1);
        gbc.writeMem(0xa571, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb1);
        EXPECT(gbc.b(),  0x5d);
        EXPECT(gbc.c(),  0x2f);
        EXPECT(gbc.d(),  0xb4);
        EXPECT(gbc.e(),  0x75);
        EXPECT(gbc.h(),  0xf0);
        EXPECT(gbc.l(),  0x8b);
        EXPECT(gbc.sp(), 0xfca3);
        EXPECT(gbc.pc(), 0xa573);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa571), 0xcb);
        EXPECT(gbc.readMem(0xa572), 0x4);
        // CB 04 002C
        gbc.setState(0x6d12, 0x349e, 0xcdc0, 0xa435, 0x2757, 0x983, 0x1, 0x0);
        gbc.writeMem(0x6d12, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xcd);
        EXPECT(gbc.b(),  0xa4);
        EXPECT(gbc.c(),  0x35);
        EXPECT(gbc.d(),  0x27);
        EXPECT(gbc.e(),  0x57);
        EXPECT(gbc.h(),  0x12);
        EXPECT(gbc.l(),  0x83);
        EXPECT(gbc.sp(), 0x349e);
        EXPECT(gbc.pc(), 0x6d14);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 002D
        gbc.setState(0x1d50, 0xe6af, 0x20f0, 0xe536, 0xa7cd, 0x6342, 0x1, 0x1);
        gbc.writeMem(0x1d50, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0xe5);
        EXPECT(gbc.c(),  0x36);
        EXPECT(gbc.d(),  0xa7);
        EXPECT(gbc.e(),  0xcd);
        EXPECT(gbc.h(),  0xc6);
        EXPECT(gbc.l(),  0x42);
        EXPECT(gbc.sp(), 0xe6af);
        EXPECT(gbc.pc(), 0x1d52);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 002E
        gbc.setState(0xe892, 0x2845, 0xbe0, 0x1d13, 0xd97b, 0x632, 0x0, 0x1);
        gbc.writeMem(0xe892, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb);
        EXPECT(gbc.b(),  0x1d);
        EXPECT(gbc.c(),  0x13);
        EXPECT(gbc.d(),  0xd9);
        EXPECT(gbc.e(),  0x7b);
        EXPECT(gbc.h(),  0xc);
        EXPECT(gbc.l(),  0x32);
        EXPECT(gbc.sp(), 0x2845);
        EXPECT(gbc.pc(), 0xe894);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe892), 0xcb);
        EXPECT(gbc.readMem(0xe893), 0x4);
        // CB 04 002F
        gbc.setState(0x1810, 0xc233, 0x8ac0, 0x21a2, 0xfb64, 0xeefc, 0x0, 0x0);
        gbc.writeMem(0x1810, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8a);
        EXPECT(gbc.b(),  0x21);
        EXPECT(gbc.c(),  0xa2);
        EXPECT(gbc.d(),  0xfb);
        EXPECT(gbc.e(),  0x64);
        EXPECT(gbc.h(),  0xdd);
        EXPECT(gbc.l(),  0xfc);
        EXPECT(gbc.sp(), 0xc233);
        EXPECT(gbc.pc(), 0x1812);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0030
        gbc.setState(0x87be, 0x7d07, 0x6140, 0x2ac5, 0xde80, 0xaa08, 0x1, 0x0);
        gbc.writeMem(0x87be, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x61);
        EXPECT(gbc.b(),  0x2a);
        EXPECT(gbc.c(),  0xc5);
        EXPECT(gbc.d(),  0xde);
        EXPECT(gbc.e(),  0x80);
        EXPECT(gbc.h(),  0x55);
        EXPECT(gbc.l(),  0x8);
        EXPECT(gbc.sp(), 0x7d07);
        EXPECT(gbc.pc(), 0x87c0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x87be), 0xcb);
        EXPECT(gbc.readMem(0x87bf), 0x4);
        // CB 04 0031
        gbc.setState(0xefc1, 0x58af, 0x1270, 0x75d1, 0x9821, 0xa140, 0x1, 0x1);
        gbc.writeMem(0xefc1, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x12);
        EXPECT(gbc.b(),  0x75);
        EXPECT(gbc.c(),  0xd1);
        EXPECT(gbc.d(),  0x98);
        EXPECT(gbc.e(),  0x21);
        EXPECT(gbc.h(),  0x43);
        EXPECT(gbc.l(),  0x40);
        EXPECT(gbc.sp(), 0x58af);
        EXPECT(gbc.pc(), 0xefc3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xefc1), 0xcb);
        EXPECT(gbc.readMem(0xefc2), 0x4);
        // CB 04 0032
        gbc.setState(0xc4bb, 0xe596, 0x9020, 0x9432, 0x211b, 0x59ae, 0x1, 0x0);
        gbc.writeMem(0xc4bb, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x90);
        EXPECT(gbc.b(),  0x94);
        EXPECT(gbc.c(),  0x32);
        EXPECT(gbc.d(),  0x21);
        EXPECT(gbc.e(),  0x1b);
        EXPECT(gbc.h(),  0xb2);
        EXPECT(gbc.l(),  0xae);
        EXPECT(gbc.sp(), 0xe596);
        EXPECT(gbc.pc(), 0xc4bd);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc4bb), 0xcb);
        EXPECT(gbc.readMem(0xc4bc), 0x4);
        // CB 04 0033
        gbc.setState(0xbd18, 0x9dcc, 0x4f90, 0x3c4, 0xe8f, 0xbac2, 0x1, 0x1);
        gbc.writeMem(0xbd18, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4f);
        EXPECT(gbc.b(),  0x3);
        EXPECT(gbc.c(),  0xc4);
        EXPECT(gbc.d(),  0xe);
        EXPECT(gbc.e(),  0x8f);
        EXPECT(gbc.h(),  0x75);
        EXPECT(gbc.l(),  0xc2);
        EXPECT(gbc.sp(), 0x9dcc);
        EXPECT(gbc.pc(), 0xbd1a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbd18), 0xcb);
        EXPECT(gbc.readMem(0xbd19), 0x4);
        // CB 04 0034
        gbc.setState(0x1090, 0x2d7a, 0x5930, 0x908a, 0x4fc6, 0xad9d, 0x1, 0x0);
        gbc.writeMem(0x1090, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x59);
        EXPECT(gbc.b(),  0x90);
        EXPECT(gbc.c(),  0x8a);
        EXPECT(gbc.d(),  0x4f);
        EXPECT(gbc.e(),  0xc6);
        EXPECT(gbc.h(),  0x5b);
        EXPECT(gbc.l(),  0x9d);
        EXPECT(gbc.sp(), 0x2d7a);
        EXPECT(gbc.pc(), 0x1092);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0035
        gbc.setState(0x72df, 0x5669, 0x5d90, 0x4fd, 0x1750, 0x4add, 0x0, 0x1);
        gbc.writeMem(0x72df, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x5d);
        EXPECT(gbc.b(),  0x4);
        EXPECT(gbc.c(),  0xfd);
        EXPECT(gbc.d(),  0x17);
        EXPECT(gbc.e(),  0x50);
        EXPECT(gbc.h(),  0x94);
        EXPECT(gbc.l(),  0xdd);
        EXPECT(gbc.sp(), 0x5669);
        EXPECT(gbc.pc(), 0x72e1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0036
        gbc.setState(0x66f9, 0x2f17, 0x8450, 0x111b, 0x27d0, 0xb74b, 0x0, 0x0);
        gbc.writeMem(0x66f9, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x84);
        EXPECT(gbc.b(),  0x11);
        EXPECT(gbc.c(),  0x1b);
        EXPECT(gbc.d(),  0x27);
        EXPECT(gbc.e(),  0xd0);
        EXPECT(gbc.h(),  0x6f);
        EXPECT(gbc.l(),  0x4b);
        EXPECT(gbc.sp(), 0x2f17);
        EXPECT(gbc.pc(), 0x66fb);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0037
        gbc.setState(0x4b05, 0xb157, 0xd450, 0xac29, 0x81cd, 0xf51, 0x1, 0x1);
        gbc.writeMem(0x4b05, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd4);
        EXPECT(gbc.b(),  0xac);
        EXPECT(gbc.c(),  0x29);
        EXPECT(gbc.d(),  0x81);
        EXPECT(gbc.e(),  0xcd);
        EXPECT(gbc.h(),  0x1e);
        EXPECT(gbc.l(),  0x51);
        EXPECT(gbc.sp(), 0xb157);
        EXPECT(gbc.pc(), 0x4b07);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0038
        gbc.setState(0xaf6c, 0xdd13, 0x4dd0, 0x2409, 0x3d1c, 0x9a21, 0x0, 0x1);
        gbc.writeMem(0xaf6c, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4d);
        EXPECT(gbc.b(),  0x24);
        EXPECT(gbc.c(),  0x9);
        EXPECT(gbc.d(),  0x3d);
        EXPECT(gbc.e(),  0x1c);
        EXPECT(gbc.h(),  0x35);
        EXPECT(gbc.l(),  0x21);
        EXPECT(gbc.sp(), 0xdd13);
        EXPECT(gbc.pc(), 0xaf6e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xaf6c), 0xcb);
        EXPECT(gbc.readMem(0xaf6d), 0x4);
        // CB 04 0039
        gbc.setState(0xd71e, 0x643b, 0xa4a0, 0x5790, 0xe065, 0xc5c8, 0x1, 0x1);
        gbc.writeMem(0xd71e, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa4);
        EXPECT(gbc.b(),  0x57);
        EXPECT(gbc.c(),  0x90);
        EXPECT(gbc.d(),  0xe0);
        EXPECT(gbc.e(),  0x65);
        EXPECT(gbc.h(),  0x8b);
        EXPECT(gbc.l(),  0xc8);
        EXPECT(gbc.sp(), 0x643b);
        EXPECT(gbc.pc(), 0xd720);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd71e), 0xcb);
        EXPECT(gbc.readMem(0xd71f), 0x4);
        // CB 04 003A
        gbc.setState(0xb540, 0x34ef, 0x9570, 0x914, 0x4672, 0xbf6c, 0x0, 0x1);
        gbc.writeMem(0xb540, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x95);
        EXPECT(gbc.b(),  0x9);
        EXPECT(gbc.c(),  0x14);
        EXPECT(gbc.d(),  0x46);
        EXPECT(gbc.e(),  0x72);
        EXPECT(gbc.h(),  0x7f);
        EXPECT(gbc.l(),  0x6c);
        EXPECT(gbc.sp(), 0x34ef);
        EXPECT(gbc.pc(), 0xb542);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb540), 0xcb);
        EXPECT(gbc.readMem(0xb541), 0x4);
        // CB 04 003B
        gbc.setState(0xce55, 0xf9be, 0xd700, 0x6eb7, 0xbb41, 0x29ae, 0x1, 0x1);
        gbc.writeMem(0xce55, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd7);
        EXPECT(gbc.b(),  0x6e);
        EXPECT(gbc.c(),  0xb7);
        EXPECT(gbc.d(),  0xbb);
        EXPECT(gbc.e(),  0x41);
        EXPECT(gbc.h(),  0x52);
        EXPECT(gbc.l(),  0xae);
        EXPECT(gbc.sp(), 0xf9be);
        EXPECT(gbc.pc(), 0xce57);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xce55), 0xcb);
        EXPECT(gbc.readMem(0xce56), 0x4);
        // CB 04 003C
        gbc.setState(0x9acf, 0xee8d, 0x8650, 0x9ea9, 0xfbf, 0x5f2f, 0x1, 0x0);
        gbc.writeMem(0x9acf, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x86);
        EXPECT(gbc.b(),  0x9e);
        EXPECT(gbc.c(),  0xa9);
        EXPECT(gbc.d(),  0xf);
        EXPECT(gbc.e(),  0xbf);
        EXPECT(gbc.h(),  0xbe);
        EXPECT(gbc.l(),  0x2f);
        EXPECT(gbc.sp(), 0xee8d);
        EXPECT(gbc.pc(), 0x9ad1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9acf), 0xcb);
        EXPECT(gbc.readMem(0x9ad0), 0x4);
        // CB 04 003D
        gbc.setState(0x43be, 0x5dde, 0x5bb0, 0xed67, 0x6e0e, 0x57d5, 0x0, 0x1);
        gbc.writeMem(0x43be, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x5b);
        EXPECT(gbc.b(),  0xed);
        EXPECT(gbc.c(),  0x67);
        EXPECT(gbc.d(),  0x6e);
        EXPECT(gbc.e(),  0xe);
        EXPECT(gbc.h(),  0xae);
        EXPECT(gbc.l(),  0xd5);
        EXPECT(gbc.sp(), 0x5dde);
        EXPECT(gbc.pc(), 0x43c0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 003E
        gbc.setState(0xd9c, 0x88d1, 0x3930, 0x43af, 0x7f08, 0x23e3, 0x0, 0x1);
        gbc.writeMem(0xd9c, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x39);
        EXPECT(gbc.b(),  0x43);
        EXPECT(gbc.c(),  0xaf);
        EXPECT(gbc.d(),  0x7f);
        EXPECT(gbc.e(),  0x8);
        EXPECT(gbc.h(),  0x46);
        EXPECT(gbc.l(),  0xe3);
        EXPECT(gbc.sp(), 0x88d1);
        EXPECT(gbc.pc(), 0xd9e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 003F
        gbc.setState(0x844c, 0xc04b, 0xc7a0, 0xd0fd, 0xbb4a, 0x975b, 0x1, 0x0);
        gbc.writeMem(0x844c, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc7);
        EXPECT(gbc.b(),  0xd0);
        EXPECT(gbc.c(),  0xfd);
        EXPECT(gbc.d(),  0xbb);
        EXPECT(gbc.e(),  0x4a);
        EXPECT(gbc.h(),  0x2f);
        EXPECT(gbc.l(),  0x5b);
        EXPECT(gbc.sp(), 0xc04b);
        EXPECT(gbc.pc(), 0x844e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x844c), 0xcb);
        EXPECT(gbc.readMem(0x844d), 0x4);
        // CB 04 0040
        gbc.setState(0x11db, 0xf74e, 0x86a0, 0x4214, 0x6015, 0xeb26, 0x0, 0x0);
        gbc.writeMem(0x11db, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x86);
        EXPECT(gbc.b(),  0x42);
        EXPECT(gbc.c(),  0x14);
        EXPECT(gbc.d(),  0x60);
        EXPECT(gbc.e(),  0x15);
        EXPECT(gbc.h(),  0xd7);
        EXPECT(gbc.l(),  0x26);
        EXPECT(gbc.sp(), 0xf74e);
        EXPECT(gbc.pc(), 0x11dd);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0041
        gbc.setState(0x4b73, 0x492e, 0x88f0, 0x22ff, 0xc38, 0x8ca8, 0x1, 0x0);
        gbc.writeMem(0x4b73, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x88);
        EXPECT(gbc.b(),  0x22);
        EXPECT(gbc.c(),  0xff);
        EXPECT(gbc.d(),  0xc);
        EXPECT(gbc.e(),  0x38);
        EXPECT(gbc.h(),  0x19);
        EXPECT(gbc.l(),  0xa8);
        EXPECT(gbc.sp(), 0x492e);
        EXPECT(gbc.pc(), 0x4b75);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0042
        gbc.setState(0x9b60, 0x51db, 0xc050, 0x91ab, 0x837c, 0x8d65, 0x0, 0x1);
        gbc.writeMem(0x9b60, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc0);
        EXPECT(gbc.b(),  0x91);
        EXPECT(gbc.c(),  0xab);
        EXPECT(gbc.d(),  0x83);
        EXPECT(gbc.e(),  0x7c);
        EXPECT(gbc.h(),  0x1b);
        EXPECT(gbc.l(),  0x65);
        EXPECT(gbc.sp(), 0x51db);
        EXPECT(gbc.pc(), 0x9b62);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9b60), 0xcb);
        EXPECT(gbc.readMem(0x9b61), 0x4);
        // CB 04 0044
        gbc.setState(0x2b42, 0x592c, 0xc7c0, 0x742c, 0x9cf3, 0xe2fa, 0x1, 0x0);
        gbc.writeMem(0x2b42, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc7);
        EXPECT(gbc.b(),  0x74);
        EXPECT(gbc.c(),  0x2c);
        EXPECT(gbc.d(),  0x9c);
        EXPECT(gbc.e(),  0xf3);
        EXPECT(gbc.h(),  0xc5);
        EXPECT(gbc.l(),  0xfa);
        EXPECT(gbc.sp(), 0x592c);
        EXPECT(gbc.pc(), 0x2b44);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0046
        gbc.setState(0x6269, 0xae7b, 0xa40, 0xd0da, 0xd244, 0xa1bf, 0x0, 0x1);
        gbc.writeMem(0x6269, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa);
        EXPECT(gbc.b(),  0xd0);
        EXPECT(gbc.c(),  0xda);
        EXPECT(gbc.d(),  0xd2);
        EXPECT(gbc.e(),  0x44);
        EXPECT(gbc.h(),  0x43);
        EXPECT(gbc.l(),  0xbf);
        EXPECT(gbc.sp(), 0xae7b);
        EXPECT(gbc.pc(), 0x626b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0047
        gbc.setState(0xce64, 0xdac9, 0x3e00, 0x7716, 0xce4b, 0x53f3, 0x1, 0x1);
        gbc.writeMem(0xce64, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3e);
        EXPECT(gbc.b(),  0x77);
        EXPECT(gbc.c(),  0x16);
        EXPECT(gbc.d(),  0xce);
        EXPECT(gbc.e(),  0x4b);
        EXPECT(gbc.h(),  0xa6);
        EXPECT(gbc.l(),  0xf3);
        EXPECT(gbc.sp(), 0xdac9);
        EXPECT(gbc.pc(), 0xce66);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xce64), 0xcb);
        EXPECT(gbc.readMem(0xce65), 0x4);
        // CB 04 0048
        gbc.setState(0xd40d, 0xeed2, 0xf2d0, 0xddbc, 0x9039, 0x6719, 0x1, 0x0);
        gbc.writeMem(0xd40d, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf2);
        EXPECT(gbc.b(),  0xdd);
        EXPECT(gbc.c(),  0xbc);
        EXPECT(gbc.d(),  0x90);
        EXPECT(gbc.e(),  0x39);
        EXPECT(gbc.h(),  0xce);
        EXPECT(gbc.l(),  0x19);
        EXPECT(gbc.sp(), 0xeed2);
        EXPECT(gbc.pc(), 0xd40f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd40d), 0xcb);
        EXPECT(gbc.readMem(0xd40e), 0x4);
        // CB 04 0049
        gbc.setState(0x71a8, 0x765f, 0xa0b0, 0xf511, 0xe1b6, 0x1ea5, 0x0, 0x0);
        gbc.writeMem(0x71a8, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa0);
        EXPECT(gbc.b(),  0xf5);
        EXPECT(gbc.c(),  0x11);
        EXPECT(gbc.d(),  0xe1);
        EXPECT(gbc.e(),  0xb6);
        EXPECT(gbc.h(),  0x3c);
        EXPECT(gbc.l(),  0xa5);
        EXPECT(gbc.sp(), 0x765f);
        EXPECT(gbc.pc(), 0x71aa);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 004A
        gbc.setState(0x2810, 0xf68, 0x3110, 0x4d2e, 0x8a5d, 0x9b90, 0x1, 0x1);
        gbc.writeMem(0x2810, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x31);
        EXPECT(gbc.b(),  0x4d);
        EXPECT(gbc.c(),  0x2e);
        EXPECT(gbc.d(),  0x8a);
        EXPECT(gbc.e(),  0x5d);
        EXPECT(gbc.h(),  0x37);
        EXPECT(gbc.l(),  0x90);
        EXPECT(gbc.sp(), 0xf68);
        EXPECT(gbc.pc(), 0x2812);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 004B
        gbc.setState(0x2f8c, 0x858, 0xe320, 0x6653, 0xd2c3, 0xfef3, 0x1, 0x0);
        gbc.writeMem(0x2f8c, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe3);
        EXPECT(gbc.b(),  0x66);
        EXPECT(gbc.c(),  0x53);
        EXPECT(gbc.d(),  0xd2);
        EXPECT(gbc.e(),  0xc3);
        EXPECT(gbc.h(),  0xfd);
        EXPECT(gbc.l(),  0xf3);
        EXPECT(gbc.sp(), 0x858);
        EXPECT(gbc.pc(), 0x2f8e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 004C
        gbc.setState(0x92a2, 0xb4cf, 0x2f80, 0x60d1, 0xbf8c, 0xcf6f, 0x0, 0x0);
        gbc.writeMem(0x92a2, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2f);
        EXPECT(gbc.b(),  0x60);
        EXPECT(gbc.c(),  0xd1);
        EXPECT(gbc.d(),  0xbf);
        EXPECT(gbc.e(),  0x8c);
        EXPECT(gbc.h(),  0x9f);
        EXPECT(gbc.l(),  0x6f);
        EXPECT(gbc.sp(), 0xb4cf);
        EXPECT(gbc.pc(), 0x92a4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x92a2), 0xcb);
        EXPECT(gbc.readMem(0x92a3), 0x4);
        // CB 04 004D
        gbc.setState(0x8ee5, 0x602c, 0x76c0, 0x82fb, 0x3257, 0x96d2, 0x0, 0x1);
        gbc.writeMem(0x8ee5, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x76);
        EXPECT(gbc.b(),  0x82);
        EXPECT(gbc.c(),  0xfb);
        EXPECT(gbc.d(),  0x32);
        EXPECT(gbc.e(),  0x57);
        EXPECT(gbc.h(),  0x2d);
        EXPECT(gbc.l(),  0xd2);
        EXPECT(gbc.sp(), 0x602c);
        EXPECT(gbc.pc(), 0x8ee7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8ee5), 0xcb);
        EXPECT(gbc.readMem(0x8ee6), 0x4);
        // CB 04 004E
        gbc.setState(0x73c4, 0xc0a0, 0xfb50, 0xa8e2, 0xc712, 0x9494, 0x0, 0x1);
        gbc.writeMem(0x73c4, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xfb);
        EXPECT(gbc.b(),  0xa8);
        EXPECT(gbc.c(),  0xe2);
        EXPECT(gbc.d(),  0xc7);
        EXPECT(gbc.e(),  0x12);
        EXPECT(gbc.h(),  0x29);
        EXPECT(gbc.l(),  0x94);
        EXPECT(gbc.sp(), 0xc0a0);
        EXPECT(gbc.pc(), 0x73c6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 004F
        gbc.setState(0x928f, 0xeaa3, 0x8ce0, 0x51ea, 0xcf7e, 0x7860, 0x1, 0x1);
        gbc.writeMem(0x928f, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8c);
        EXPECT(gbc.b(),  0x51);
        EXPECT(gbc.c(),  0xea);
        EXPECT(gbc.d(),  0xcf);
        EXPECT(gbc.e(),  0x7e);
        EXPECT(gbc.h(),  0xf0);
        EXPECT(gbc.l(),  0x60);
        EXPECT(gbc.sp(), 0xeaa3);
        EXPECT(gbc.pc(), 0x9291);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x928f), 0xcb);
        EXPECT(gbc.readMem(0x9290), 0x4);
        // CB 04 0050
        gbc.setState(0x618a, 0x6187, 0x44b0, 0x3e81, 0xfbd8, 0x7b07, 0x1, 0x0);
        gbc.writeMem(0x618a, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x44);
        EXPECT(gbc.b(),  0x3e);
        EXPECT(gbc.c(),  0x81);
        EXPECT(gbc.d(),  0xfb);
        EXPECT(gbc.e(),  0xd8);
        EXPECT(gbc.h(),  0xf6);
        EXPECT(gbc.l(),  0x7);
        EXPECT(gbc.sp(), 0x6187);
        EXPECT(gbc.pc(), 0x618c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0051
        gbc.setState(0x989e, 0x3160, 0x7ef0, 0x1c40, 0xd1d2, 0xd04c, 0x1, 0x1);
        gbc.writeMem(0x989e, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x7e);
        EXPECT(gbc.b(),  0x1c);
        EXPECT(gbc.c(),  0x40);
        EXPECT(gbc.d(),  0xd1);
        EXPECT(gbc.e(),  0xd2);
        EXPECT(gbc.h(),  0xa1);
        EXPECT(gbc.l(),  0x4c);
        EXPECT(gbc.sp(), 0x3160);
        EXPECT(gbc.pc(), 0x98a0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x989e), 0xcb);
        EXPECT(gbc.readMem(0x989f), 0x4);
        // CB 04 0052
        gbc.setState(0x3bb4, 0x9550, 0x55c0, 0xf61, 0x9940, 0x549e, 0x1, 0x0);
        gbc.writeMem(0x3bb4, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x55);
        EXPECT(gbc.b(),  0xf);
        EXPECT(gbc.c(),  0x61);
        EXPECT(gbc.d(),  0x99);
        EXPECT(gbc.e(),  0x40);
        EXPECT(gbc.h(),  0xa8);
        EXPECT(gbc.l(),  0x9e);
        EXPECT(gbc.sp(), 0x9550);
        EXPECT(gbc.pc(), 0x3bb6);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0053
        gbc.setState(0x7eb5, 0x9d0c, 0xde0, 0xd2d8, 0xd06d, 0x3568, 0x0, 0x0);
        gbc.writeMem(0x7eb5, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd);
        EXPECT(gbc.b(),  0xd2);
        EXPECT(gbc.c(),  0xd8);
        EXPECT(gbc.d(),  0xd0);
        EXPECT(gbc.e(),  0x6d);
        EXPECT(gbc.h(),  0x6a);
        EXPECT(gbc.l(),  0x68);
        EXPECT(gbc.sp(), 0x9d0c);
        EXPECT(gbc.pc(), 0x7eb7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0054
        gbc.setState(0x43ea, 0xaae8, 0xc40, 0x2f9b, 0x2da0, 0xb5ba, 0x1, 0x1);
        gbc.writeMem(0x43ea, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc);
        EXPECT(gbc.b(),  0x2f);
        EXPECT(gbc.c(),  0x9b);
        EXPECT(gbc.d(),  0x2d);
        EXPECT(gbc.e(),  0xa0);
        EXPECT(gbc.h(),  0x6b);
        EXPECT(gbc.l(),  0xba);
        EXPECT(gbc.sp(), 0xaae8);
        EXPECT(gbc.pc(), 0x43ec);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0055
        gbc.setState(0x3301, 0xc4c7, 0xe990, 0x87cb, 0xbdcc, 0xf4ce, 0x1, 0x1);
        gbc.writeMem(0x3301, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe9);
        EXPECT(gbc.b(),  0x87);
        EXPECT(gbc.c(),  0xcb);
        EXPECT(gbc.d(),  0xbd);
        EXPECT(gbc.e(),  0xcc);
        EXPECT(gbc.h(),  0xe9);
        EXPECT(gbc.l(),  0xce);
        EXPECT(gbc.sp(), 0xc4c7);
        EXPECT(gbc.pc(), 0x3303);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0056
        gbc.setState(0x909f, 0x6297, 0xb5a0, 0xabc0, 0xd8ec, 0xc4d2, 0x0, 0x1);
        gbc.writeMem(0x909f, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb5);
        EXPECT(gbc.b(),  0xab);
        EXPECT(gbc.c(),  0xc0);
        EXPECT(gbc.d(),  0xd8);
        EXPECT(gbc.e(),  0xec);
        EXPECT(gbc.h(),  0x89);
        EXPECT(gbc.l(),  0xd2);
        EXPECT(gbc.sp(), 0x6297);
        EXPECT(gbc.pc(), 0x90a1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x909f), 0xcb);
        EXPECT(gbc.readMem(0x90a0), 0x4);
        // CB 04 0058
        gbc.setState(0x75f6, 0x72ae, 0xe380, 0x1fd7, 0x2e92, 0xe29c, 0x0, 0x0);
        gbc.writeMem(0x75f6, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe3);
        EXPECT(gbc.b(),  0x1f);
        EXPECT(gbc.c(),  0xd7);
        EXPECT(gbc.d(),  0x2e);
        EXPECT(gbc.e(),  0x92);
        EXPECT(gbc.h(),  0xc5);
        EXPECT(gbc.l(),  0x9c);
        EXPECT(gbc.sp(), 0x72ae);
        EXPECT(gbc.pc(), 0x75f8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0059
        gbc.setState(0xa238, 0x4db2, 0xc990, 0xedba, 0xac6e, 0x3423, 0x0, 0x0);
        gbc.writeMem(0xa238, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc9);
        EXPECT(gbc.b(),  0xed);
        EXPECT(gbc.c(),  0xba);
        EXPECT(gbc.d(),  0xac);
        EXPECT(gbc.e(),  0x6e);
        EXPECT(gbc.h(),  0x68);
        EXPECT(gbc.l(),  0x23);
        EXPECT(gbc.sp(), 0x4db2);
        EXPECT(gbc.pc(), 0xa23a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa238), 0xcb);
        EXPECT(gbc.readMem(0xa239), 0x4);
        // CB 04 005A
        gbc.setState(0xd4f5, 0xa537, 0x37d0, 0xa112, 0xeb2c, 0xf6b5, 0x1, 0x1);
        gbc.writeMem(0xd4f5, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x37);
        EXPECT(gbc.b(),  0xa1);
        EXPECT(gbc.c(),  0x12);
        EXPECT(gbc.d(),  0xeb);
        EXPECT(gbc.e(),  0x2c);
        EXPECT(gbc.h(),  0xed);
        EXPECT(gbc.l(),  0xb5);
        EXPECT(gbc.sp(), 0xa537);
        EXPECT(gbc.pc(), 0xd4f7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd4f5), 0xcb);
        EXPECT(gbc.readMem(0xd4f6), 0x4);
        // CB 04 005B
        gbc.setState(0xc8aa, 0x8698, 0x2fa0, 0x55b7, 0x9ecb, 0x7890, 0x0, 0x0);
        gbc.writeMem(0xc8aa, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2f);
        EXPECT(gbc.b(),  0x55);
        EXPECT(gbc.c(),  0xb7);
        EXPECT(gbc.d(),  0x9e);
        EXPECT(gbc.e(),  0xcb);
        EXPECT(gbc.h(),  0xf0);
        EXPECT(gbc.l(),  0x90);
        EXPECT(gbc.sp(), 0x8698);
        EXPECT(gbc.pc(), 0xc8ac);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc8aa), 0xcb);
        EXPECT(gbc.readMem(0xc8ab), 0x4);
        // CB 04 005C
        gbc.setState(0xcca6, 0x75d5, 0x63a0, 0xf86, 0xce08, 0xad41, 0x0, 0x1);
        gbc.writeMem(0xcca6, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x63);
        EXPECT(gbc.b(),  0xf);
        EXPECT(gbc.c(),  0x86);
        EXPECT(gbc.d(),  0xce);
        EXPECT(gbc.e(),  0x8);
        EXPECT(gbc.h(),  0x5b);
        EXPECT(gbc.l(),  0x41);
        EXPECT(gbc.sp(), 0x75d5);
        EXPECT(gbc.pc(), 0xcca8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcca6), 0xcb);
        EXPECT(gbc.readMem(0xcca7), 0x4);
        // CB 04 005D
        gbc.setState(0xd2ae, 0xddd2, 0xf400, 0x861c, 0xac41, 0xa77c, 0x0, 0x1);
        gbc.writeMem(0xd2ae, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf4);
        EXPECT(gbc.b(),  0x86);
        EXPECT(gbc.c(),  0x1c);
        EXPECT(gbc.d(),  0xac);
        EXPECT(gbc.e(),  0x41);
        EXPECT(gbc.h(),  0x4f);
        EXPECT(gbc.l(),  0x7c);
        EXPECT(gbc.sp(), 0xddd2);
        EXPECT(gbc.pc(), 0xd2b0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd2ae), 0xcb);
        EXPECT(gbc.readMem(0xd2af), 0x4);
        // CB 04 005E
        gbc.setState(0xe01c, 0xe039, 0xc330, 0x2c57, 0x78cb, 0x8b74, 0x0, 0x0);
        gbc.writeMem(0xe01c, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc3);
        EXPECT(gbc.b(),  0x2c);
        EXPECT(gbc.c(),  0x57);
        EXPECT(gbc.d(),  0x78);
        EXPECT(gbc.e(),  0xcb);
        EXPECT(gbc.h(),  0x17);
        EXPECT(gbc.l(),  0x74);
        EXPECT(gbc.sp(), 0xe039);
        EXPECT(gbc.pc(), 0xe01e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe01c), 0xcb);
        EXPECT(gbc.readMem(0xe01d), 0x4);
        // CB 04 005F
        gbc.setState(0xc74e, 0x58da, 0xe110, 0xd265, 0x5d24, 0x4326, 0x1, 0x0);
        gbc.writeMem(0xc74e, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe1);
        EXPECT(gbc.b(),  0xd2);
        EXPECT(gbc.c(),  0x65);
        EXPECT(gbc.d(),  0x5d);
        EXPECT(gbc.e(),  0x24);
        EXPECT(gbc.h(),  0x86);
        EXPECT(gbc.l(),  0x26);
        EXPECT(gbc.sp(), 0x58da);
        EXPECT(gbc.pc(), 0xc750);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc74e), 0xcb);
        EXPECT(gbc.readMem(0xc74f), 0x4);
        // CB 04 0060
        gbc.setState(0x1e9e, 0xb443, 0x100, 0xfa92, 0xaf58, 0xa0a2, 0x1, 0x1);
        gbc.writeMem(0x1e9e, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0xfa);
        EXPECT(gbc.c(),  0x92);
        EXPECT(gbc.d(),  0xaf);
        EXPECT(gbc.e(),  0x58);
        EXPECT(gbc.h(),  0x41);
        EXPECT(gbc.l(),  0xa2);
        EXPECT(gbc.sp(), 0xb443);
        EXPECT(gbc.pc(), 0x1ea0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0062
        gbc.setState(0x88a3, 0x633a, 0xc290, 0x5580, 0xb4d5, 0xcb8, 0x1, 0x1);
        gbc.writeMem(0x88a3, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc2);
        EXPECT(gbc.b(),  0x55);
        EXPECT(gbc.c(),  0x80);
        EXPECT(gbc.d(),  0xb4);
        EXPECT(gbc.e(),  0xd5);
        EXPECT(gbc.h(),  0x18);
        EXPECT(gbc.l(),  0xb8);
        EXPECT(gbc.sp(), 0x633a);
        EXPECT(gbc.pc(), 0x88a5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x88a3), 0xcb);
        EXPECT(gbc.readMem(0x88a4), 0x4);
        // CB 04 0063
        gbc.setState(0x5a18, 0x7492, 0xcb70, 0xfff7, 0x2b6f, 0x7816, 0x0, 0x0);
        gbc.writeMem(0x5a18, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xcb);
        EXPECT(gbc.b(),  0xff);
        EXPECT(gbc.c(),  0xf7);
        EXPECT(gbc.d(),  0x2b);
        EXPECT(gbc.e(),  0x6f);
        EXPECT(gbc.h(),  0xf0);
        EXPECT(gbc.l(),  0x16);
        EXPECT(gbc.sp(), 0x7492);
        EXPECT(gbc.pc(), 0x5a1a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0064
        gbc.setState(0x2765, 0x82d2, 0x2bd0, 0xb21b, 0x4746, 0xa51f, 0x0, 0x1);
        gbc.writeMem(0x2765, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2b);
        EXPECT(gbc.b(),  0xb2);
        EXPECT(gbc.c(),  0x1b);
        EXPECT(gbc.d(),  0x47);
        EXPECT(gbc.e(),  0x46);
        EXPECT(gbc.h(),  0x4b);
        EXPECT(gbc.l(),  0x1f);
        EXPECT(gbc.sp(), 0x82d2);
        EXPECT(gbc.pc(), 0x2767);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0065
        gbc.setState(0x42b7, 0x751c, 0xdf0, 0xb870, 0x8c63, 0x7a09, 0x1, 0x0);
        gbc.writeMem(0x42b7, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd);
        EXPECT(gbc.b(),  0xb8);
        EXPECT(gbc.c(),  0x70);
        EXPECT(gbc.d(),  0x8c);
        EXPECT(gbc.e(),  0x63);
        EXPECT(gbc.h(),  0xf4);
        EXPECT(gbc.l(),  0x9);
        EXPECT(gbc.sp(), 0x751c);
        EXPECT(gbc.pc(), 0x42b9);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0067
        gbc.setState(0x9c80, 0x4bb6, 0x7500, 0xc540, 0x9fde, 0xee6e, 0x1, 0x0);
        gbc.writeMem(0x9c80, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x75);
        EXPECT(gbc.b(),  0xc5);
        EXPECT(gbc.c(),  0x40);
        EXPECT(gbc.d(),  0x9f);
        EXPECT(gbc.e(),  0xde);
        EXPECT(gbc.h(),  0xdd);
        EXPECT(gbc.l(),  0x6e);
        EXPECT(gbc.sp(), 0x4bb6);
        EXPECT(gbc.pc(), 0x9c82);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9c80), 0xcb);
        EXPECT(gbc.readMem(0x9c81), 0x4);
        // CB 04 0069
        gbc.setState(0xc0d2, 0x8568, 0x2280, 0x4c41, 0x4247, 0x962, 0x1, 0x1);
        gbc.writeMem(0xc0d2, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x22);
        EXPECT(gbc.b(),  0x4c);
        EXPECT(gbc.c(),  0x41);
        EXPECT(gbc.d(),  0x42);
        EXPECT(gbc.e(),  0x47);
        EXPECT(gbc.h(),  0x12);
        EXPECT(gbc.l(),  0x62);
        EXPECT(gbc.sp(), 0x8568);
        EXPECT(gbc.pc(), 0xc0d4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc0d2), 0xcb);
        EXPECT(gbc.readMem(0xc0d3), 0x4);
        // CB 04 006A
        gbc.setState(0x342d, 0x6566, 0x2870, 0xa229, 0x91a6, 0x831f, 0x1, 0x0);
        gbc.writeMem(0x342d, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0xa2);
        EXPECT(gbc.c(),  0x29);
        EXPECT(gbc.d(),  0x91);
        EXPECT(gbc.e(),  0xa6);
        EXPECT(gbc.h(),  0x7);
        EXPECT(gbc.l(),  0x1f);
        EXPECT(gbc.sp(), 0x6566);
        EXPECT(gbc.pc(), 0x342f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 006B
        gbc.setState(0xc713, 0x2cdd, 0x1c30, 0x9648, 0x3b3e, 0x65a8, 0x1, 0x1);
        gbc.writeMem(0xc713, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1c);
        EXPECT(gbc.b(),  0x96);
        EXPECT(gbc.c(),  0x48);
        EXPECT(gbc.d(),  0x3b);
        EXPECT(gbc.e(),  0x3e);
        EXPECT(gbc.h(),  0xca);
        EXPECT(gbc.l(),  0xa8);
        EXPECT(gbc.sp(), 0x2cdd);
        EXPECT(gbc.pc(), 0xc715);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc713), 0xcb);
        EXPECT(gbc.readMem(0xc714), 0x4);
        // CB 04 006C
        gbc.setState(0xbee, 0xd52, 0x2a30, 0xe78d, 0x8f2d, 0x716f, 0x0, 0x1);
        gbc.writeMem(0xbee, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2a);
        EXPECT(gbc.b(),  0xe7);
        EXPECT(gbc.c(),  0x8d);
        EXPECT(gbc.d(),  0x8f);
        EXPECT(gbc.e(),  0x2d);
        EXPECT(gbc.h(),  0xe2);
        EXPECT(gbc.l(),  0x6f);
        EXPECT(gbc.sp(), 0xd52);
        EXPECT(gbc.pc(), 0xbf0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 006D
        gbc.setState(0x655d, 0x9bbf, 0x3490, 0x245d, 0xef6, 0x2900, 0x0, 0x0);
        gbc.writeMem(0x655d, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x34);
        EXPECT(gbc.b(),  0x24);
        EXPECT(gbc.c(),  0x5d);
        EXPECT(gbc.d(),  0xe);
        EXPECT(gbc.e(),  0xf6);
        EXPECT(gbc.h(),  0x52);
        EXPECT(gbc.l(),  0x0);
        EXPECT(gbc.sp(), 0x9bbf);
        EXPECT(gbc.pc(), 0x655f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 006E
        gbc.setState(0x6e04, 0x4eb2, 0x78c0, 0x912c, 0xec21, 0xd2f, 0x0, 0x0);
        gbc.writeMem(0x6e04, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x78);
        EXPECT(gbc.b(),  0x91);
        EXPECT(gbc.c(),  0x2c);
        EXPECT(gbc.d(),  0xec);
        EXPECT(gbc.e(),  0x21);
        EXPECT(gbc.h(),  0x1a);
        EXPECT(gbc.l(),  0x2f);
        EXPECT(gbc.sp(), 0x4eb2);
        EXPECT(gbc.pc(), 0x6e06);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 006F
        gbc.setState(0xe688, 0x860a, 0x12f0, 0xad33, 0x18ea, 0x5eba, 0x0, 0x1);
        gbc.writeMem(0xe688, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x12);
        EXPECT(gbc.b(),  0xad);
        EXPECT(gbc.c(),  0x33);
        EXPECT(gbc.d(),  0x18);
        EXPECT(gbc.e(),  0xea);
        EXPECT(gbc.h(),  0xbc);
        EXPECT(gbc.l(),  0xba);
        EXPECT(gbc.sp(), 0x860a);
        EXPECT(gbc.pc(), 0xe68a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe688), 0xcb);
        EXPECT(gbc.readMem(0xe689), 0x4);
        // CB 04 0070
        gbc.setState(0x43c1, 0xf0c3, 0x97d0, 0xc523, 0xec38, 0xfe7c, 0x0, 0x1);
        gbc.writeMem(0x43c1, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x97);
        EXPECT(gbc.b(),  0xc5);
        EXPECT(gbc.c(),  0x23);
        EXPECT(gbc.d(),  0xec);
        EXPECT(gbc.e(),  0x38);
        EXPECT(gbc.h(),  0xfd);
        EXPECT(gbc.l(),  0x7c);
        EXPECT(gbc.sp(), 0xf0c3);
        EXPECT(gbc.pc(), 0x43c3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0071
        gbc.setState(0x9f25, 0xb2e6, 0xe1b0, 0x1c28, 0xadd4, 0x86bf, 0x1, 0x1);
        gbc.writeMem(0x9f25, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe1);
        EXPECT(gbc.b(),  0x1c);
        EXPECT(gbc.c(),  0x28);
        EXPECT(gbc.d(),  0xad);
        EXPECT(gbc.e(),  0xd4);
        EXPECT(gbc.h(),  0xd);
        EXPECT(gbc.l(),  0xbf);
        EXPECT(gbc.sp(), 0xb2e6);
        EXPECT(gbc.pc(), 0x9f27);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9f25), 0xcb);
        EXPECT(gbc.readMem(0x9f26), 0x4);
        // CB 04 0073
        gbc.setState(0xd23e, 0x78ca, 0x3ee0, 0x3829, 0x1958, 0x529d, 0x1, 0x1);
        gbc.writeMem(0xd23e, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3e);
        EXPECT(gbc.b(),  0x38);
        EXPECT(gbc.c(),  0x29);
        EXPECT(gbc.d(),  0x19);
        EXPECT(gbc.e(),  0x58);
        EXPECT(gbc.h(),  0xa4);
        EXPECT(gbc.l(),  0x9d);
        EXPECT(gbc.sp(), 0x78ca);
        EXPECT(gbc.pc(), 0xd240);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd23e), 0xcb);
        EXPECT(gbc.readMem(0xd23f), 0x4);
        // CB 04 0074
        gbc.setState(0xd71c, 0xe0f8, 0x1f10, 0xc8fe, 0xeb5b, 0x3741, 0x0, 0x1);
        gbc.writeMem(0xd71c, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1f);
        EXPECT(gbc.b(),  0xc8);
        EXPECT(gbc.c(),  0xfe);
        EXPECT(gbc.d(),  0xeb);
        EXPECT(gbc.e(),  0x5b);
        EXPECT(gbc.h(),  0x6e);
        EXPECT(gbc.l(),  0x41);
        EXPECT(gbc.sp(), 0xe0f8);
        EXPECT(gbc.pc(), 0xd71e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd71c), 0xcb);
        EXPECT(gbc.readMem(0xd71d), 0x4);
        // CB 04 0075
        gbc.setState(0x42c2, 0x5ec0, 0xeed0, 0x127d, 0x9b4e, 0x43d2, 0x0, 0x0);
        gbc.writeMem(0x42c2, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xee);
        EXPECT(gbc.b(),  0x12);
        EXPECT(gbc.c(),  0x7d);
        EXPECT(gbc.d(),  0x9b);
        EXPECT(gbc.e(),  0x4e);
        EXPECT(gbc.h(),  0x86);
        EXPECT(gbc.l(),  0xd2);
        EXPECT(gbc.sp(), 0x5ec0);
        EXPECT(gbc.pc(), 0x42c4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0077
        gbc.setState(0xc010, 0x375d, 0x7710, 0xdec4, 0xd74, 0xa8b5, 0x0, 0x0);
        gbc.writeMem(0xc010, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x77);
        EXPECT(gbc.b(),  0xde);
        EXPECT(gbc.c(),  0xc4);
        EXPECT(gbc.d(),  0xd);
        EXPECT(gbc.e(),  0x74);
        EXPECT(gbc.h(),  0x51);
        EXPECT(gbc.l(),  0xb5);
        EXPECT(gbc.sp(), 0x375d);
        EXPECT(gbc.pc(), 0xc012);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc010), 0xcb);
        EXPECT(gbc.readMem(0xc011), 0x4);
        // CB 04 0078
        gbc.setState(0x2a08, 0xf524, 0x15b0, 0x2842, 0x7ea6, 0x6ccf, 0x1, 0x0);
        gbc.writeMem(0x2a08, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x15);
        EXPECT(gbc.b(),  0x28);
        EXPECT(gbc.c(),  0x42);
        EXPECT(gbc.d(),  0x7e);
        EXPECT(gbc.e(),  0xa6);
        EXPECT(gbc.h(),  0xd8);
        EXPECT(gbc.l(),  0xcf);
        EXPECT(gbc.sp(), 0xf524);
        EXPECT(gbc.pc(), 0x2a0a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0079
        gbc.setState(0xc677, 0x279a, 0x5640, 0x90c2, 0x9fa1, 0xddf6, 0x1, 0x0);
        gbc.writeMem(0xc677, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x56);
        EXPECT(gbc.b(),  0x90);
        EXPECT(gbc.c(),  0xc2);
        EXPECT(gbc.d(),  0x9f);
        EXPECT(gbc.e(),  0xa1);
        EXPECT(gbc.h(),  0xbb);
        EXPECT(gbc.l(),  0xf6);
        EXPECT(gbc.sp(), 0x279a);
        EXPECT(gbc.pc(), 0xc679);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc677), 0xcb);
        EXPECT(gbc.readMem(0xc678), 0x4);
        // CB 04 007A
        gbc.setState(0x2a03, 0xcd74, 0xe660, 0x66b3, 0xd80a, 0x28e4, 0x1, 0x0);
        gbc.writeMem(0x2a03, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe6);
        EXPECT(gbc.b(),  0x66);
        EXPECT(gbc.c(),  0xb3);
        EXPECT(gbc.d(),  0xd8);
        EXPECT(gbc.e(),  0xa);
        EXPECT(gbc.h(),  0x50);
        EXPECT(gbc.l(),  0xe4);
        EXPECT(gbc.sp(), 0xcd74);
        EXPECT(gbc.pc(), 0x2a05);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 007B
        gbc.setState(0x263b, 0x3725, 0x11c0, 0xd7c2, 0xc387, 0xdcf1, 0x1, 0x1);
        gbc.writeMem(0x263b, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x11);
        EXPECT(gbc.b(),  0xd7);
        EXPECT(gbc.c(),  0xc2);
        EXPECT(gbc.d(),  0xc3);
        EXPECT(gbc.e(),  0x87);
        EXPECT(gbc.h(),  0xb9);
        EXPECT(gbc.l(),  0xf1);
        EXPECT(gbc.sp(), 0x3725);
        EXPECT(gbc.pc(), 0x263d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 007C
        gbc.setState(0x8bdf, 0x2dca, 0x9470, 0x90ae, 0x5b21, 0x72dd, 0x1, 0x0);
        gbc.writeMem(0x8bdf, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x94);
        EXPECT(gbc.b(),  0x90);
        EXPECT(gbc.c(),  0xae);
        EXPECT(gbc.d(),  0x5b);
        EXPECT(gbc.e(),  0x21);
        EXPECT(gbc.h(),  0xe4);
        EXPECT(gbc.l(),  0xdd);
        EXPECT(gbc.sp(), 0x2dca);
        EXPECT(gbc.pc(), 0x8be1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8bdf), 0xcb);
        EXPECT(gbc.readMem(0x8be0), 0x4);
        // CB 04 007D
        gbc.setState(0x7edf, 0xe5c5, 0x8050, 0x97e6, 0x9b2, 0x85cd, 0x0, 0x0);
        gbc.writeMem(0x7edf, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0x97);
        EXPECT(gbc.c(),  0xe6);
        EXPECT(gbc.d(),  0x9);
        EXPECT(gbc.e(),  0xb2);
        EXPECT(gbc.h(),  0xb);
        EXPECT(gbc.l(),  0xcd);
        EXPECT(gbc.sp(), 0xe5c5);
        EXPECT(gbc.pc(), 0x7ee1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 007E
        gbc.setState(0x8262, 0xd7d8, 0x9ec0, 0xfed7, 0x688c, 0xea12, 0x1, 0x1);
        gbc.writeMem(0x8262, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x9e);
        EXPECT(gbc.b(),  0xfe);
        EXPECT(gbc.c(),  0xd7);
        EXPECT(gbc.d(),  0x68);
        EXPECT(gbc.e(),  0x8c);
        EXPECT(gbc.h(),  0xd5);
        EXPECT(gbc.l(),  0x12);
        EXPECT(gbc.sp(), 0xd7d8);
        EXPECT(gbc.pc(), 0x8264);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8262), 0xcb);
        EXPECT(gbc.readMem(0x8263), 0x4);
        // CB 04 007F
        gbc.setState(0xd639, 0x6e0d, 0xab90, 0x3fb2, 0x5e89, 0x7412, 0x0, 0x1);
        gbc.writeMem(0xd639, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xab);
        EXPECT(gbc.b(),  0x3f);
        EXPECT(gbc.c(),  0xb2);
        EXPECT(gbc.d(),  0x5e);
        EXPECT(gbc.e(),  0x89);
        EXPECT(gbc.h(),  0xe8);
        EXPECT(gbc.l(),  0x12);
        EXPECT(gbc.sp(), 0x6e0d);
        EXPECT(gbc.pc(), 0xd63b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd639), 0xcb);
        EXPECT(gbc.readMem(0xd63a), 0x4);
        // CB 04 0080
        gbc.setState(0xc52f, 0x2009, 0x2a60, 0x8a6c, 0xe1bd, 0x4240, 0x1, 0x1);
        gbc.writeMem(0xc52f, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2a);
        EXPECT(gbc.b(),  0x8a);
        EXPECT(gbc.c(),  0x6c);
        EXPECT(gbc.d(),  0xe1);
        EXPECT(gbc.e(),  0xbd);
        EXPECT(gbc.h(),  0x84);
        EXPECT(gbc.l(),  0x40);
        EXPECT(gbc.sp(), 0x2009);
        EXPECT(gbc.pc(), 0xc531);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc52f), 0xcb);
        EXPECT(gbc.readMem(0xc530), 0x4);
        // CB 04 0081
        gbc.setState(0x9e35, 0x1bcc, 0x8dd0, 0xe18a, 0xc332, 0x1b4f, 0x0, 0x1);
        gbc.writeMem(0x9e35, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8d);
        EXPECT(gbc.b(),  0xe1);
        EXPECT(gbc.c(),  0x8a);
        EXPECT(gbc.d(),  0xc3);
        EXPECT(gbc.e(),  0x32);
        EXPECT(gbc.h(),  0x36);
        EXPECT(gbc.l(),  0x4f);
        EXPECT(gbc.sp(), 0x1bcc);
        EXPECT(gbc.pc(), 0x9e37);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9e35), 0xcb);
        EXPECT(gbc.readMem(0x9e36), 0x4);
        // CB 04 0083
        gbc.setState(0xc0ed, 0xe3cf, 0x5030, 0xe483, 0x43a1, 0xa8e3, 0x1, 0x0);
        gbc.writeMem(0xc0ed, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x50);
        EXPECT(gbc.b(),  0xe4);
        EXPECT(gbc.c(),  0x83);
        EXPECT(gbc.d(),  0x43);
        EXPECT(gbc.e(),  0xa1);
        EXPECT(gbc.h(),  0x51);
        EXPECT(gbc.l(),  0xe3);
        EXPECT(gbc.sp(), 0xe3cf);
        EXPECT(gbc.pc(), 0xc0ef);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc0ed), 0xcb);
        EXPECT(gbc.readMem(0xc0ee), 0x4);
        // CB 04 0085
        gbc.setState(0x5b0e, 0x6369, 0x5b80, 0x8241, 0x114f, 0x691, 0x1, 0x1);
        gbc.writeMem(0x5b0e, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x5b);
        EXPECT(gbc.b(),  0x82);
        EXPECT(gbc.c(),  0x41);
        EXPECT(gbc.d(),  0x11);
        EXPECT(gbc.e(),  0x4f);
        EXPECT(gbc.h(),  0xc);
        EXPECT(gbc.l(),  0x91);
        EXPECT(gbc.sp(), 0x6369);
        EXPECT(gbc.pc(), 0x5b10);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0086
        gbc.setState(0x5712, 0x26c6, 0x8770, 0x90bb, 0x779, 0x9bfd, 0x1, 0x0);
        gbc.writeMem(0x5712, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x87);
        EXPECT(gbc.b(),  0x90);
        EXPECT(gbc.c(),  0xbb);
        EXPECT(gbc.d(),  0x7);
        EXPECT(gbc.e(),  0x79);
        EXPECT(gbc.h(),  0x37);
        EXPECT(gbc.l(),  0xfd);
        EXPECT(gbc.sp(), 0x26c6);
        EXPECT(gbc.pc(), 0x5714);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0087
        gbc.setState(0xcc2f, 0x84cd, 0x3f90, 0x1fdf, 0xc5dd, 0xdf1f, 0x1, 0x1);
        gbc.writeMem(0xcc2f, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3f);
        EXPECT(gbc.b(),  0x1f);
        EXPECT(gbc.c(),  0xdf);
        EXPECT(gbc.d(),  0xc5);
        EXPECT(gbc.e(),  0xdd);
        EXPECT(gbc.h(),  0xbf);
        EXPECT(gbc.l(),  0x1f);
        EXPECT(gbc.sp(), 0x84cd);
        EXPECT(gbc.pc(), 0xcc31);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcc2f), 0xcb);
        EXPECT(gbc.readMem(0xcc30), 0x4);
        // CB 04 0088
        gbc.setState(0xd34f, 0x70e6, 0x910, 0xb88e, 0xa13e, 0x1481, 0x0, 0x1);
        gbc.writeMem(0xd34f, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x9);
        EXPECT(gbc.b(),  0xb8);
        EXPECT(gbc.c(),  0x8e);
        EXPECT(gbc.d(),  0xa1);
        EXPECT(gbc.e(),  0x3e);
        EXPECT(gbc.h(),  0x28);
        EXPECT(gbc.l(),  0x81);
        EXPECT(gbc.sp(), 0x70e6);
        EXPECT(gbc.pc(), 0xd351);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd34f), 0xcb);
        EXPECT(gbc.readMem(0xd350), 0x4);
        // CB 04 0089
        gbc.setState(0x9ab5, 0xcd3d, 0x8080, 0x488a, 0x9768, 0x334a, 0x0, 0x1);
        gbc.writeMem(0x9ab5, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0x48);
        EXPECT(gbc.c(),  0x8a);
        EXPECT(gbc.d(),  0x97);
        EXPECT(gbc.e(),  0x68);
        EXPECT(gbc.h(),  0x66);
        EXPECT(gbc.l(),  0x4a);
        EXPECT(gbc.sp(), 0xcd3d);
        EXPECT(gbc.pc(), 0x9ab7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9ab5), 0xcb);
        EXPECT(gbc.readMem(0x9ab6), 0x4);
        // CB 04 008A
        gbc.setState(0xba62, 0x159d, 0xb360, 0x81ea, 0x3500, 0xf982, 0x0, 0x0);
        gbc.writeMem(0xba62, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb3);
        EXPECT(gbc.b(),  0x81);
        EXPECT(gbc.c(),  0xea);
        EXPECT(gbc.d(),  0x35);
        EXPECT(gbc.e(),  0x0);
        EXPECT(gbc.h(),  0xf3);
        EXPECT(gbc.l(),  0x82);
        EXPECT(gbc.sp(), 0x159d);
        EXPECT(gbc.pc(), 0xba64);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xba62), 0xcb);
        EXPECT(gbc.readMem(0xba63), 0x4);
        // CB 04 008B
        gbc.setState(0x5299, 0xdc6f, 0xc620, 0x188d, 0x74fe, 0xd780, 0x0, 0x0);
        gbc.writeMem(0x5299, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc6);
        EXPECT(gbc.b(),  0x18);
        EXPECT(gbc.c(),  0x8d);
        EXPECT(gbc.d(),  0x74);
        EXPECT(gbc.e(),  0xfe);
        EXPECT(gbc.h(),  0xaf);
        EXPECT(gbc.l(),  0x80);
        EXPECT(gbc.sp(), 0xdc6f);
        EXPECT(gbc.pc(), 0x529b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 008C
        gbc.setState(0x6b9a, 0xdc70, 0x8cf0, 0xd8c8, 0x865d, 0xc08b, 0x1, 0x0);
        gbc.writeMem(0x6b9a, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8c);
        EXPECT(gbc.b(),  0xd8);
        EXPECT(gbc.c(),  0xc8);
        EXPECT(gbc.d(),  0x86);
        EXPECT(gbc.e(),  0x5d);
        EXPECT(gbc.h(),  0x81);
        EXPECT(gbc.l(),  0x8b);
        EXPECT(gbc.sp(), 0xdc70);
        EXPECT(gbc.pc(), 0x6b9c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 008D
        gbc.setState(0xc4e1, 0x976e, 0xba50, 0xd41, 0x64a6, 0x48d9, 0x0, 0x1);
        gbc.writeMem(0xc4e1, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xba);
        EXPECT(gbc.b(),  0xd);
        EXPECT(gbc.c(),  0x41);
        EXPECT(gbc.d(),  0x64);
        EXPECT(gbc.e(),  0xa6);
        EXPECT(gbc.h(),  0x90);
        EXPECT(gbc.l(),  0xd9);
        EXPECT(gbc.sp(), 0x976e);
        EXPECT(gbc.pc(), 0xc4e3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc4e1), 0xcb);
        EXPECT(gbc.readMem(0xc4e2), 0x4);
        // CB 04 008E
        gbc.setState(0xe2bb, 0x3901, 0x7b20, 0x8336, 0x5392, 0x1031, 0x1, 0x0);
        gbc.writeMem(0xe2bb, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x7b);
        EXPECT(gbc.b(),  0x83);
        EXPECT(gbc.c(),  0x36);
        EXPECT(gbc.d(),  0x53);
        EXPECT(gbc.e(),  0x92);
        EXPECT(gbc.h(),  0x20);
        EXPECT(gbc.l(),  0x31);
        EXPECT(gbc.sp(), 0x3901);
        EXPECT(gbc.pc(), 0xe2bd);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe2bb), 0xcb);
        EXPECT(gbc.readMem(0xe2bc), 0x4);
        // CB 04 008F
        gbc.setState(0xb4fa, 0xef38, 0xc7a0, 0xc3b5, 0xdda, 0x71b8, 0x0, 0x1);
        gbc.writeMem(0xb4fa, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc7);
        EXPECT(gbc.b(),  0xc3);
        EXPECT(gbc.c(),  0xb5);
        EXPECT(gbc.d(),  0xd);
        EXPECT(gbc.e(),  0xda);
        EXPECT(gbc.h(),  0xe2);
        EXPECT(gbc.l(),  0xb8);
        EXPECT(gbc.sp(), 0xef38);
        EXPECT(gbc.pc(), 0xb4fc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb4fa), 0xcb);
        EXPECT(gbc.readMem(0xb4fb), 0x4);
        // CB 04 0090
        gbc.setState(0x75ff, 0xaf88, 0x21a0, 0x530b, 0x3bc1, 0x5ac7, 0x1, 0x1);
        gbc.writeMem(0x75ff, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x21);
        EXPECT(gbc.b(),  0x53);
        EXPECT(gbc.c(),  0xb);
        EXPECT(gbc.d(),  0x3b);
        EXPECT(gbc.e(),  0xc1);
        EXPECT(gbc.h(),  0xb4);
        EXPECT(gbc.l(),  0xc7);
        EXPECT(gbc.sp(), 0xaf88);
        EXPECT(gbc.pc(), 0x7601);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0091
        gbc.setState(0x7bf9, 0xb54a, 0x2640, 0x77b2, 0x666c, 0x6a80, 0x0, 0x1);
        gbc.writeMem(0x7bf9, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x26);
        EXPECT(gbc.b(),  0x77);
        EXPECT(gbc.c(),  0xb2);
        EXPECT(gbc.d(),  0x66);
        EXPECT(gbc.e(),  0x6c);
        EXPECT(gbc.h(),  0xd4);
        EXPECT(gbc.l(),  0x80);
        EXPECT(gbc.sp(), 0xb54a);
        EXPECT(gbc.pc(), 0x7bfb);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0092
        gbc.setState(0x9e33, 0x3440, 0xba10, 0xdbfe, 0xb9d2, 0x9c06, 0x1, 0x1);
        gbc.writeMem(0x9e33, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xba);
        EXPECT(gbc.b(),  0xdb);
        EXPECT(gbc.c(),  0xfe);
        EXPECT(gbc.d(),  0xb9);
        EXPECT(gbc.e(),  0xd2);
        EXPECT(gbc.h(),  0x39);
        EXPECT(gbc.l(),  0x6);
        EXPECT(gbc.sp(), 0x3440);
        EXPECT(gbc.pc(), 0x9e35);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9e33), 0xcb);
        EXPECT(gbc.readMem(0x9e34), 0x4);
        // CB 04 0093
        gbc.setState(0x1e92, 0x21a4, 0x850, 0xc663, 0xdf0b, 0xf13c, 0x0, 0x0);
        gbc.writeMem(0x1e92, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0xc6);
        EXPECT(gbc.c(),  0x63);
        EXPECT(gbc.d(),  0xdf);
        EXPECT(gbc.e(),  0xb);
        EXPECT(gbc.h(),  0xe3);
        EXPECT(gbc.l(),  0x3c);
        EXPECT(gbc.sp(), 0x21a4);
        EXPECT(gbc.pc(), 0x1e94);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0094
        gbc.setState(0x23e1, 0x7ca6, 0x6a70, 0xa180, 0x6053, 0x2372, 0x1, 0x1);
        gbc.writeMem(0x23e1, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x6a);
        EXPECT(gbc.b(),  0xa1);
        EXPECT(gbc.c(),  0x80);
        EXPECT(gbc.d(),  0x60);
        EXPECT(gbc.e(),  0x53);
        EXPECT(gbc.h(),  0x46);
        EXPECT(gbc.l(),  0x72);
        EXPECT(gbc.sp(), 0x7ca6);
        EXPECT(gbc.pc(), 0x23e3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0095
        gbc.setState(0xa3cc, 0x88f1, 0x8b90, 0x8dc7, 0x73be, 0x3a91, 0x0, 0x1);
        gbc.writeMem(0xa3cc, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8b);
        EXPECT(gbc.b(),  0x8d);
        EXPECT(gbc.c(),  0xc7);
        EXPECT(gbc.d(),  0x73);
        EXPECT(gbc.e(),  0xbe);
        EXPECT(gbc.h(),  0x74);
        EXPECT(gbc.l(),  0x91);
        EXPECT(gbc.sp(), 0x88f1);
        EXPECT(gbc.pc(), 0xa3ce);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa3cc), 0xcb);
        EXPECT(gbc.readMem(0xa3cd), 0x4);
        // CB 04 0096
        gbc.setState(0x21bb, 0x35be, 0xd2c0, 0x3ee2, 0x7f6e, 0xda6c, 0x0, 0x1);
        gbc.writeMem(0x21bb, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd2);
        EXPECT(gbc.b(),  0x3e);
        EXPECT(gbc.c(),  0xe2);
        EXPECT(gbc.d(),  0x7f);
        EXPECT(gbc.e(),  0x6e);
        EXPECT(gbc.h(),  0xb5);
        EXPECT(gbc.l(),  0x6c);
        EXPECT(gbc.sp(), 0x35be);
        EXPECT(gbc.pc(), 0x21bd);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0099
        gbc.setState(0x8e68, 0xda74, 0x7aa0, 0xdc97, 0xa2c3, 0x2798, 0x0, 0x1);
        gbc.writeMem(0x8e68, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x7a);
        EXPECT(gbc.b(),  0xdc);
        EXPECT(gbc.c(),  0x97);
        EXPECT(gbc.d(),  0xa2);
        EXPECT(gbc.e(),  0xc3);
        EXPECT(gbc.h(),  0x4e);
        EXPECT(gbc.l(),  0x98);
        EXPECT(gbc.sp(), 0xda74);
        EXPECT(gbc.pc(), 0x8e6a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8e68), 0xcb);
        EXPECT(gbc.readMem(0x8e69), 0x4);
        // CB 04 009A
        gbc.setState(0x953b, 0x6767, 0x8ce0, 0x7580, 0x5052, 0x5fab, 0x0, 0x0);
        gbc.writeMem(0x953b, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8c);
        EXPECT(gbc.b(),  0x75);
        EXPECT(gbc.c(),  0x80);
        EXPECT(gbc.d(),  0x50);
        EXPECT(gbc.e(),  0x52);
        EXPECT(gbc.h(),  0xbe);
        EXPECT(gbc.l(),  0xab);
        EXPECT(gbc.sp(), 0x6767);
        EXPECT(gbc.pc(), 0x953d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x953b), 0xcb);
        EXPECT(gbc.readMem(0x953c), 0x4);
        // CB 04 009B
        gbc.setState(0xc56e, 0x16de, 0x5670, 0x5c74, 0xf7e6, 0x7646, 0x1, 0x1);
        gbc.writeMem(0xc56e, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x56);
        EXPECT(gbc.b(),  0x5c);
        EXPECT(gbc.c(),  0x74);
        EXPECT(gbc.d(),  0xf7);
        EXPECT(gbc.e(),  0xe6);
        EXPECT(gbc.h(),  0xec);
        EXPECT(gbc.l(),  0x46);
        EXPECT(gbc.sp(), 0x16de);
        EXPECT(gbc.pc(), 0xc570);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc56e), 0xcb);
        EXPECT(gbc.readMem(0xc56f), 0x4);
        // CB 04 009C
        gbc.setState(0x34a8, 0x423, 0xa5c0, 0xae13, 0x776a, 0x8717, 0x0, 0x0);
        gbc.writeMem(0x34a8, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa5);
        EXPECT(gbc.b(),  0xae);
        EXPECT(gbc.c(),  0x13);
        EXPECT(gbc.d(),  0x77);
        EXPECT(gbc.e(),  0x6a);
        EXPECT(gbc.h(),  0xf);
        EXPECT(gbc.l(),  0x17);
        EXPECT(gbc.sp(), 0x423);
        EXPECT(gbc.pc(), 0x34aa);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 009D
        gbc.setState(0x3447, 0x577f, 0xd170, 0x106a, 0x2b9c, 0xc848, 0x1, 0x1);
        gbc.writeMem(0x3447, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd1);
        EXPECT(gbc.b(),  0x10);
        EXPECT(gbc.c(),  0x6a);
        EXPECT(gbc.d(),  0x2b);
        EXPECT(gbc.e(),  0x9c);
        EXPECT(gbc.h(),  0x91);
        EXPECT(gbc.l(),  0x48);
        EXPECT(gbc.sp(), 0x577f);
        EXPECT(gbc.pc(), 0x3449);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 009E
        gbc.setState(0x6d4e, 0x8678, 0x1310, 0x4b19, 0xb7f7, 0x3e6b, 0x1, 0x1);
        gbc.writeMem(0x6d4e, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x13);
        EXPECT(gbc.b(),  0x4b);
        EXPECT(gbc.c(),  0x19);
        EXPECT(gbc.d(),  0xb7);
        EXPECT(gbc.e(),  0xf7);
        EXPECT(gbc.h(),  0x7c);
        EXPECT(gbc.l(),  0x6b);
        EXPECT(gbc.sp(), 0x8678);
        EXPECT(gbc.pc(), 0x6d50);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 009F
        gbc.setState(0xc420, 0x32ba, 0x4ad0, 0x841e, 0x4bb1, 0xdce, 0x1, 0x0);
        gbc.writeMem(0xc420, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4a);
        EXPECT(gbc.b(),  0x84);
        EXPECT(gbc.c(),  0x1e);
        EXPECT(gbc.d(),  0x4b);
        EXPECT(gbc.e(),  0xb1);
        EXPECT(gbc.h(),  0x1a);
        EXPECT(gbc.l(),  0xce);
        EXPECT(gbc.sp(), 0x32ba);
        EXPECT(gbc.pc(), 0xc422);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc420), 0xcb);
        EXPECT(gbc.readMem(0xc421), 0x4);
        // CB 04 00A0
        gbc.setState(0x5952, 0x2ac9, 0xd4b0, 0xd08a, 0xfc33, 0xa719, 0x1, 0x0);
        gbc.writeMem(0x5952, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd4);
        EXPECT(gbc.b(),  0xd0);
        EXPECT(gbc.c(),  0x8a);
        EXPECT(gbc.d(),  0xfc);
        EXPECT(gbc.e(),  0x33);
        EXPECT(gbc.h(),  0x4f);
        EXPECT(gbc.l(),  0x19);
        EXPECT(gbc.sp(), 0x2ac9);
        EXPECT(gbc.pc(), 0x5954);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 00A1
        gbc.setState(0xbd62, 0xf77a, 0xa660, 0xb8b, 0x9cfa, 0x59fa, 0x1, 0x0);
        gbc.writeMem(0xbd62, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa6);
        EXPECT(gbc.b(),  0xb);
        EXPECT(gbc.c(),  0x8b);
        EXPECT(gbc.d(),  0x9c);
        EXPECT(gbc.e(),  0xfa);
        EXPECT(gbc.h(),  0xb2);
        EXPECT(gbc.l(),  0xfa);
        EXPECT(gbc.sp(), 0xf77a);
        EXPECT(gbc.pc(), 0xbd64);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbd62), 0xcb);
        EXPECT(gbc.readMem(0xbd63), 0x4);
        // CB 04 00A2
        gbc.setState(0x6cf9, 0x120, 0xc750, 0xed40, 0x8db0, 0x4f5, 0x1, 0x0);
        gbc.writeMem(0x6cf9, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc7);
        EXPECT(gbc.b(),  0xed);
        EXPECT(gbc.c(),  0x40);
        EXPECT(gbc.d(),  0x8d);
        EXPECT(gbc.e(),  0xb0);
        EXPECT(gbc.h(),  0x8);
        EXPECT(gbc.l(),  0xf5);
        EXPECT(gbc.sp(), 0x120);
        EXPECT(gbc.pc(), 0x6cfb);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 00A3
        gbc.setState(0x5516, 0xfca9, 0x4810, 0xe6d2, 0x44cb, 0xdccd, 0x1, 0x0);
        gbc.writeMem(0x5516, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x48);
        EXPECT(gbc.b(),  0xe6);
        EXPECT(gbc.c(),  0xd2);
        EXPECT(gbc.d(),  0x44);
        EXPECT(gbc.e(),  0xcb);
        EXPECT(gbc.h(),  0xb9);
        EXPECT(gbc.l(),  0xcd);
        EXPECT(gbc.sp(), 0xfca9);
        EXPECT(gbc.pc(), 0x5518);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 00A4
        gbc.setState(0x7daf, 0x1b5e, 0x2d40, 0x4e75, 0x1d0c, 0x7542, 0x1, 0x0);
        gbc.writeMem(0x7daf, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2d);
        EXPECT(gbc.b(),  0x4e);
        EXPECT(gbc.c(),  0x75);
        EXPECT(gbc.d(),  0x1d);
        EXPECT(gbc.e(),  0xc);
        EXPECT(gbc.h(),  0xea);
        EXPECT(gbc.l(),  0x42);
        EXPECT(gbc.sp(), 0x1b5e);
        EXPECT(gbc.pc(), 0x7db1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 00A5
        gbc.setState(0x1001, 0x9530, 0x90e0, 0x2956, 0x6cd0, 0x4576, 0x1, 0x0);
        gbc.writeMem(0x1001, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x90);
        EXPECT(gbc.b(),  0x29);
        EXPECT(gbc.c(),  0x56);
        EXPECT(gbc.d(),  0x6c);
        EXPECT(gbc.e(),  0xd0);
        EXPECT(gbc.h(),  0x8a);
        EXPECT(gbc.l(),  0x76);
        EXPECT(gbc.sp(), 0x9530);
        EXPECT(gbc.pc(), 0x1003);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 00A6
        gbc.setState(0xb3fc, 0x2b0b, 0x2b60, 0xf6e8, 0x781d, 0x6aa3, 0x1, 0x0);
        gbc.writeMem(0xb3fc, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2b);
        EXPECT(gbc.b(),  0xf6);
        EXPECT(gbc.c(),  0xe8);
        EXPECT(gbc.d(),  0x78);
        EXPECT(gbc.e(),  0x1d);
        EXPECT(gbc.h(),  0xd4);
        EXPECT(gbc.l(),  0xa3);
        EXPECT(gbc.sp(), 0x2b0b);
        EXPECT(gbc.pc(), 0xb3fe);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb3fc), 0xcb);
        EXPECT(gbc.readMem(0xb3fd), 0x4);
        // CB 04 00A7
        gbc.setState(0x84c1, 0xdc6e, 0x5e50, 0x4810, 0x7e6d, 0xbf20, 0x1, 0x0);
        gbc.writeMem(0x84c1, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x5e);
        EXPECT(gbc.b(),  0x48);
        EXPECT(gbc.c(),  0x10);
        EXPECT(gbc.d(),  0x7e);
        EXPECT(gbc.e(),  0x6d);
        EXPECT(gbc.h(),  0x7f);
        EXPECT(gbc.l(),  0x20);
        EXPECT(gbc.sp(), 0xdc6e);
        EXPECT(gbc.pc(), 0x84c3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x84c1), 0xcb);
        EXPECT(gbc.readMem(0x84c2), 0x4);
        // CB 04 00A8
        gbc.setState(0x7f1c, 0x867a, 0xd5a0, 0xaa11, 0xdcaa, 0xdf89, 0x1, 0x0);
        gbc.writeMem(0x7f1c, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd5);
        EXPECT(gbc.b(),  0xaa);
        EXPECT(gbc.c(),  0x11);
        EXPECT(gbc.d(),  0xdc);
        EXPECT(gbc.e(),  0xaa);
        EXPECT(gbc.h(),  0xbf);
        EXPECT(gbc.l(),  0x89);
        EXPECT(gbc.sp(), 0x867a);
        EXPECT(gbc.pc(), 0x7f1e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 00A9
        gbc.setState(0x3b82, 0x1b51, 0x1530, 0xfd93, 0xd2c0, 0xb5d1, 0x0, 0x0);
        gbc.writeMem(0x3b82, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x15);
        EXPECT(gbc.b(),  0xfd);
        EXPECT(gbc.c(),  0x93);
        EXPECT(gbc.d(),  0xd2);
        EXPECT(gbc.e(),  0xc0);
        EXPECT(gbc.h(),  0x6b);
        EXPECT(gbc.l(),  0xd1);
        EXPECT(gbc.sp(), 0x1b51);
        EXPECT(gbc.pc(), 0x3b84);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 00AA
        gbc.setState(0x8af1, 0x7643, 0xa5d0, 0x70c5, 0x6c5e, 0x8467, 0x0, 0x1);
        gbc.writeMem(0x8af1, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa5);
        EXPECT(gbc.b(),  0x70);
        EXPECT(gbc.c(),  0xc5);
        EXPECT(gbc.d(),  0x6c);
        EXPECT(gbc.e(),  0x5e);
        EXPECT(gbc.h(),  0x9);
        EXPECT(gbc.l(),  0x67);
        EXPECT(gbc.sp(), 0x7643);
        EXPECT(gbc.pc(), 0x8af3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8af1), 0xcb);
        EXPECT(gbc.readMem(0x8af2), 0x4);
        // CB 04 00AB
        gbc.setState(0x551c, 0x2cf6, 0x4c50, 0xe65f, 0x253f, 0xa57e, 0x0, 0x0);
        gbc.writeMem(0x551c, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4c);
        EXPECT(gbc.b(),  0xe6);
        EXPECT(gbc.c(),  0x5f);
        EXPECT(gbc.d(),  0x25);
        EXPECT(gbc.e(),  0x3f);
        EXPECT(gbc.h(),  0x4b);
        EXPECT(gbc.l(),  0x7e);
        EXPECT(gbc.sp(), 0x2cf6);
        EXPECT(gbc.pc(), 0x551e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 00AC
        gbc.setState(0x8d4a, 0x1a66, 0x3170, 0xb57c, 0x5489, 0x320f, 0x0, 0x1);
        gbc.writeMem(0x8d4a, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x31);
        EXPECT(gbc.b(),  0xb5);
        EXPECT(gbc.c(),  0x7c);
        EXPECT(gbc.d(),  0x54);
        EXPECT(gbc.e(),  0x89);
        EXPECT(gbc.h(),  0x64);
        EXPECT(gbc.l(),  0xf);
        EXPECT(gbc.sp(), 0x1a66);
        EXPECT(gbc.pc(), 0x8d4c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8d4a), 0xcb);
        EXPECT(gbc.readMem(0x8d4b), 0x4);
        // CB 04 00AD
        gbc.setState(0x101e, 0xa589, 0xdce0, 0xe5fa, 0x642a, 0xd6dc, 0x1, 0x1);
        gbc.writeMem(0x101e, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xdc);
        EXPECT(gbc.b(),  0xe5);
        EXPECT(gbc.c(),  0xfa);
        EXPECT(gbc.d(),  0x64);
        EXPECT(gbc.e(),  0x2a);
        EXPECT(gbc.h(),  0xad);
        EXPECT(gbc.l(),  0xdc);
        EXPECT(gbc.sp(), 0xa589);
        EXPECT(gbc.pc(), 0x1020);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 00AE
        gbc.setState(0x9766, 0xfeff, 0xcd0, 0xd156, 0xf26f, 0xb3ca, 0x0, 0x1);
        gbc.writeMem(0x9766, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc);
        EXPECT(gbc.b(),  0xd1);
        EXPECT(gbc.c(),  0x56);
        EXPECT(gbc.d(),  0xf2);
        EXPECT(gbc.e(),  0x6f);
        EXPECT(gbc.h(),  0x67);
        EXPECT(gbc.l(),  0xca);
        EXPECT(gbc.sp(), 0xfeff);
        EXPECT(gbc.pc(), 0x9768);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9766), 0xcb);
        EXPECT(gbc.readMem(0x9767), 0x4);
        // CB 04 00AF
        gbc.setState(0x5a57, 0xc565, 0xac30, 0x7bc9, 0xf90c, 0xf296, 0x1, 0x0);
        gbc.writeMem(0x5a57, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xac);
        EXPECT(gbc.b(),  0x7b);
        EXPECT(gbc.c(),  0xc9);
        EXPECT(gbc.d(),  0xf9);
        EXPECT(gbc.e(),  0xc);
        EXPECT(gbc.h(),  0xe5);
        EXPECT(gbc.l(),  0x96);
        EXPECT(gbc.sp(), 0xc565);
        EXPECT(gbc.pc(), 0x5a59);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 00B0
        gbc.setState(0xa718, 0x1cf, 0xaf70, 0x1070, 0x87e, 0xbaf4, 0x1, 0x0);
        gbc.writeMem(0xa718, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xaf);
        EXPECT(gbc.b(),  0x10);
        EXPECT(gbc.c(),  0x70);
        EXPECT(gbc.d(),  0x8);
        EXPECT(gbc.e(),  0x7e);
        EXPECT(gbc.h(),  0x75);
        EXPECT(gbc.l(),  0xf4);
        EXPECT(gbc.sp(), 0x1cf);
        EXPECT(gbc.pc(), 0xa71a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa718), 0xcb);
        EXPECT(gbc.readMem(0xa719), 0x4);
        // CB 04 00B1
        gbc.setState(0xd31e, 0x2409, 0xf370, 0xb466, 0xa730, 0xafb5, 0x1, 0x1);
        gbc.writeMem(0xd31e, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf3);
        EXPECT(gbc.b(),  0xb4);
        EXPECT(gbc.c(),  0x66);
        EXPECT(gbc.d(),  0xa7);
        EXPECT(gbc.e(),  0x30);
        EXPECT(gbc.h(),  0x5f);
        EXPECT(gbc.l(),  0xb5);
        EXPECT(gbc.sp(), 0x2409);
        EXPECT(gbc.pc(), 0xd320);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd31e), 0xcb);
        EXPECT(gbc.readMem(0xd31f), 0x4);
        // CB 04 00B2
        gbc.setState(0x437c, 0x9921, 0x9730, 0xde4a, 0x1615, 0xfec8, 0x0, 0x0);
        gbc.writeMem(0x437c, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x97);
        EXPECT(gbc.b(),  0xde);
        EXPECT(gbc.c(),  0x4a);
        EXPECT(gbc.d(),  0x16);
        EXPECT(gbc.e(),  0x15);
        EXPECT(gbc.h(),  0xfd);
        EXPECT(gbc.l(),  0xc8);
        EXPECT(gbc.sp(), 0x9921);
        EXPECT(gbc.pc(), 0x437e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 00B3
        gbc.setState(0x6fe9, 0x69c0, 0xf2b0, 0x477d, 0x345d, 0x20c4, 0x1, 0x0);
        gbc.writeMem(0x6fe9, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf2);
        EXPECT(gbc.b(),  0x47);
        EXPECT(gbc.c(),  0x7d);
        EXPECT(gbc.d(),  0x34);
        EXPECT(gbc.e(),  0x5d);
        EXPECT(gbc.h(),  0x40);
        EXPECT(gbc.l(),  0xc4);
        EXPECT(gbc.sp(), 0x69c0);
        EXPECT(gbc.pc(), 0x6feb);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 00B4
        gbc.setState(0x9505, 0x9284, 0xda80, 0xb7b1, 0x22bf, 0xf90d, 0x1, 0x1);
        gbc.writeMem(0x9505, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xda);
        EXPECT(gbc.b(),  0xb7);
        EXPECT(gbc.c(),  0xb1);
        EXPECT(gbc.d(),  0x22);
        EXPECT(gbc.e(),  0xbf);
        EXPECT(gbc.h(),  0xf3);
        EXPECT(gbc.l(),  0xd);
        EXPECT(gbc.sp(), 0x9284);
        EXPECT(gbc.pc(), 0x9507);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9505), 0xcb);
        EXPECT(gbc.readMem(0x9506), 0x4);
        // CB 04 00B5
        gbc.setState(0x7db9, 0xd45d, 0x93a0, 0x380b, 0x40a1, 0x8c6, 0x1, 0x1);
        gbc.writeMem(0x7db9, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x93);
        EXPECT(gbc.b(),  0x38);
        EXPECT(gbc.c(),  0xb);
        EXPECT(gbc.d(),  0x40);
        EXPECT(gbc.e(),  0xa1);
        EXPECT(gbc.h(),  0x10);
        EXPECT(gbc.l(),  0xc6);
        EXPECT(gbc.sp(), 0xd45d);
        EXPECT(gbc.pc(), 0x7dbb);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 00B6
        gbc.setState(0x7723, 0x7d68, 0x4e40, 0x626c, 0xcbc9, 0x86eb, 0x1, 0x1);
        gbc.writeMem(0x7723, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4e);
        EXPECT(gbc.b(),  0x62);
        EXPECT(gbc.c(),  0x6c);
        EXPECT(gbc.d(),  0xcb);
        EXPECT(gbc.e(),  0xc9);
        EXPECT(gbc.h(),  0xd);
        EXPECT(gbc.l(),  0xeb);
        EXPECT(gbc.sp(), 0x7d68);
        EXPECT(gbc.pc(), 0x7725);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 00B7
        gbc.setState(0x903b, 0xe6ae, 0x83d0, 0x4ace, 0x7a1a, 0x8a3, 0x0, 0x0);
        gbc.writeMem(0x903b, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x83);
        EXPECT(gbc.b(),  0x4a);
        EXPECT(gbc.c(),  0xce);
        EXPECT(gbc.d(),  0x7a);
        EXPECT(gbc.e(),  0x1a);
        EXPECT(gbc.h(),  0x10);
        EXPECT(gbc.l(),  0xa3);
        EXPECT(gbc.sp(), 0xe6ae);
        EXPECT(gbc.pc(), 0x903d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x903b), 0xcb);
        EXPECT(gbc.readMem(0x903c), 0x4);
        // CB 04 00B8
        gbc.setState(0x91ff, 0xc59e, 0xe850, 0x96ee, 0xffbd, 0xd0f8, 0x1, 0x1);
        gbc.writeMem(0x91ff, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe8);
        EXPECT(gbc.b(),  0x96);
        EXPECT(gbc.c(),  0xee);
        EXPECT(gbc.d(),  0xff);
        EXPECT(gbc.e(),  0xbd);
        EXPECT(gbc.h(),  0xa1);
        EXPECT(gbc.l(),  0xf8);
        EXPECT(gbc.sp(), 0xc59e);
        EXPECT(gbc.pc(), 0x9201);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x91ff), 0xcb);
        EXPECT(gbc.readMem(0x9200), 0x4);
        // CB 04 00B9
        gbc.setState(0x8df6, 0x36e6, 0x7130, 0x6cd6, 0xcfb0, 0xd41a, 0x0, 0x0);
        gbc.writeMem(0x8df6, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x71);
        EXPECT(gbc.b(),  0x6c);
        EXPECT(gbc.c(),  0xd6);
        EXPECT(gbc.d(),  0xcf);
        EXPECT(gbc.e(),  0xb0);
        EXPECT(gbc.h(),  0xa9);
        EXPECT(gbc.l(),  0x1a);
        EXPECT(gbc.sp(), 0x36e6);
        EXPECT(gbc.pc(), 0x8df8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8df6), 0xcb);
        EXPECT(gbc.readMem(0x8df7), 0x4);
        // CB 04 00BA
        gbc.setState(0xe09b, 0x4712, 0x7070, 0xb21e, 0x5ece, 0xeca4, 0x1, 0x0);
        gbc.writeMem(0xe09b, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x70);
        EXPECT(gbc.b(),  0xb2);
        EXPECT(gbc.c(),  0x1e);
        EXPECT(gbc.d(),  0x5e);
        EXPECT(gbc.e(),  0xce);
        EXPECT(gbc.h(),  0xd9);
        EXPECT(gbc.l(),  0xa4);
        EXPECT(gbc.sp(), 0x4712);
        EXPECT(gbc.pc(), 0xe09d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe09b), 0xcb);
        EXPECT(gbc.readMem(0xe09c), 0x4);
        // CB 04 00BB
        gbc.setState(0xa5c3, 0xb252, 0x20d0, 0x270a, 0x586f, 0xce1, 0x0, 0x0);
        gbc.writeMem(0xa5c3, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0x27);
        EXPECT(gbc.c(),  0xa);
        EXPECT(gbc.d(),  0x58);
        EXPECT(gbc.e(),  0x6f);
        EXPECT(gbc.h(),  0x18);
        EXPECT(gbc.l(),  0xe1);
        EXPECT(gbc.sp(), 0xb252);
        EXPECT(gbc.pc(), 0xa5c5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa5c3), 0xcb);
        EXPECT(gbc.readMem(0xa5c4), 0x4);
        // CB 04 00BC
        gbc.setState(0x71be, 0xac6c, 0xb8d0, 0xe6f9, 0x1be8, 0x3832, 0x0, 0x1);
        gbc.writeMem(0x71be, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb8);
        EXPECT(gbc.b(),  0xe6);
        EXPECT(gbc.c(),  0xf9);
        EXPECT(gbc.d(),  0x1b);
        EXPECT(gbc.e(),  0xe8);
        EXPECT(gbc.h(),  0x70);
        EXPECT(gbc.l(),  0x32);
        EXPECT(gbc.sp(), 0xac6c);
        EXPECT(gbc.pc(), 0x71c0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 00BD
        gbc.setState(0x9546, 0xd1e8, 0x9f90, 0x1366, 0x3f0, 0x50c1, 0x1, 0x0);
        gbc.writeMem(0x9546, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x9f);
        EXPECT(gbc.b(),  0x13);
        EXPECT(gbc.c(),  0x66);
        EXPECT(gbc.d(),  0x3);
        EXPECT(gbc.e(),  0xf0);
        EXPECT(gbc.h(),  0xa0);
        EXPECT(gbc.l(),  0xc1);
        EXPECT(gbc.sp(), 0xd1e8);
        EXPECT(gbc.pc(), 0x9548);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9546), 0xcb);
        EXPECT(gbc.readMem(0x9547), 0x4);
        // CB 04 00BE
        gbc.setState(0x7e5a, 0x9336, 0xc90, 0x5b9c, 0x9940, 0x30d7, 0x0, 0x0);
        gbc.writeMem(0x7e5a, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc);
        EXPECT(gbc.b(),  0x5b);
        EXPECT(gbc.c(),  0x9c);
        EXPECT(gbc.d(),  0x99);
        EXPECT(gbc.e(),  0x40);
        EXPECT(gbc.h(),  0x60);
        EXPECT(gbc.l(),  0xd7);
        EXPECT(gbc.sp(), 0x9336);
        EXPECT(gbc.pc(), 0x7e5c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 00BF
        gbc.setState(0x286e, 0x33e3, 0xb70, 0xe090, 0xf6f, 0x5387, 0x1, 0x0);
        gbc.writeMem(0x286e, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb);
        EXPECT(gbc.b(),  0xe0);
        EXPECT(gbc.c(),  0x90);
        EXPECT(gbc.d(),  0xf);
        EXPECT(gbc.e(),  0x6f);
        EXPECT(gbc.h(),  0xa6);
        EXPECT(gbc.l(),  0x87);
        EXPECT(gbc.sp(), 0x33e3);
        EXPECT(gbc.pc(), 0x2870);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 00C0
        gbc.setState(0x96ee, 0xc55a, 0xf5d0, 0x1c4e, 0xe69c, 0x57ec, 0x0, 0x1);
        gbc.writeMem(0x96ee, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf5);
        EXPECT(gbc.b(),  0x1c);
        EXPECT(gbc.c(),  0x4e);
        EXPECT(gbc.d(),  0xe6);
        EXPECT(gbc.e(),  0x9c);
        EXPECT(gbc.h(),  0xae);
        EXPECT(gbc.l(),  0xec);
        EXPECT(gbc.sp(), 0xc55a);
        EXPECT(gbc.pc(), 0x96f0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x96ee), 0xcb);
        EXPECT(gbc.readMem(0x96ef), 0x4);
        // CB 04 00C1
        gbc.setState(0x363e, 0x4018, 0xd340, 0x76a7, 0x680b, 0x3c55, 0x0, 0x1);
        gbc.writeMem(0x363e, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd3);
        EXPECT(gbc.b(),  0x76);
        EXPECT(gbc.c(),  0xa7);
        EXPECT(gbc.d(),  0x68);
        EXPECT(gbc.e(),  0xb);
        EXPECT(gbc.h(),  0x78);
        EXPECT(gbc.l(),  0x55);
        EXPECT(gbc.sp(), 0x4018);
        EXPECT(gbc.pc(), 0x3640);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 00C2
        gbc.setState(0xbb18, 0x3752, 0xb520, 0x5e09, 0x52cb, 0xcf38, 0x0, 0x1);
        gbc.writeMem(0xbb18, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb5);
        EXPECT(gbc.b(),  0x5e);
        EXPECT(gbc.c(),  0x9);
        EXPECT(gbc.d(),  0x52);
        EXPECT(gbc.e(),  0xcb);
        EXPECT(gbc.h(),  0x9f);
        EXPECT(gbc.l(),  0x38);
        EXPECT(gbc.sp(), 0x3752);
        EXPECT(gbc.pc(), 0xbb1a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbb18), 0xcb);
        EXPECT(gbc.readMem(0xbb19), 0x4);
        // CB 04 00C3
        gbc.setState(0x1c63, 0x3b1c, 0x3670, 0x551f, 0x6a9a, 0xf39b, 0x0, 0x1);
        gbc.writeMem(0x1c63, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x36);
        EXPECT(gbc.b(),  0x55);
        EXPECT(gbc.c(),  0x1f);
        EXPECT(gbc.d(),  0x6a);
        EXPECT(gbc.e(),  0x9a);
        EXPECT(gbc.h(),  0xe7);
        EXPECT(gbc.l(),  0x9b);
        EXPECT(gbc.sp(), 0x3b1c);
        EXPECT(gbc.pc(), 0x1c65);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 00C4
        gbc.setState(0xd260, 0x882b, 0x2a0, 0x4c00, 0x40ce, 0xcc1a, 0x0, 0x1);
        gbc.writeMem(0xd260, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0x4c);
        EXPECT(gbc.c(),  0x0);
        EXPECT(gbc.d(),  0x40);
        EXPECT(gbc.e(),  0xce);
        EXPECT(gbc.h(),  0x99);
        EXPECT(gbc.l(),  0x1a);
        EXPECT(gbc.sp(), 0x882b);
        EXPECT(gbc.pc(), 0xd262);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd260), 0xcb);
        EXPECT(gbc.readMem(0xd261), 0x4);
        // CB 04 00C5
        gbc.setState(0x2f0f, 0x3828, 0xa2a0, 0xccd4, 0xa1ba, 0xea2a, 0x1, 0x1);
        gbc.writeMem(0x2f0f, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa2);
        EXPECT(gbc.b(),  0xcc);
        EXPECT(gbc.c(),  0xd4);
        EXPECT(gbc.d(),  0xa1);
        EXPECT(gbc.e(),  0xba);
        EXPECT(gbc.h(),  0xd5);
        EXPECT(gbc.l(),  0x2a);
        EXPECT(gbc.sp(), 0x3828);
        EXPECT(gbc.pc(), 0x2f11);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 00C6
        gbc.setState(0x5a66, 0x9acc, 0x5a20, 0x5e7f, 0xda53, 0xc8a2, 0x0, 0x1);
        gbc.writeMem(0x5a66, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x5a);
        EXPECT(gbc.b(),  0x5e);
        EXPECT(gbc.c(),  0x7f);
        EXPECT(gbc.d(),  0xda);
        EXPECT(gbc.e(),  0x53);
        EXPECT(gbc.h(),  0x91);
        EXPECT(gbc.l(),  0xa2);
        EXPECT(gbc.sp(), 0x9acc);
        EXPECT(gbc.pc(), 0x5a68);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 00C7
        gbc.setState(0xc057, 0xa526, 0x4ea0, 0x11d, 0xb8bb, 0x8a9d, 0x1, 0x0);
        gbc.writeMem(0xc057, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4e);
        EXPECT(gbc.b(),  0x1);
        EXPECT(gbc.c(),  0x1d);
        EXPECT(gbc.d(),  0xb8);
        EXPECT(gbc.e(),  0xbb);
        EXPECT(gbc.h(),  0x15);
        EXPECT(gbc.l(),  0x9d);
        EXPECT(gbc.sp(), 0xa526);
        EXPECT(gbc.pc(), 0xc059);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc057), 0xcb);
        EXPECT(gbc.readMem(0xc058), 0x4);
        // CB 04 00C8
        gbc.setState(0x2673, 0x6894, 0x12e0, 0x1846, 0x4e7f, 0xc158, 0x0, 0x0);
        gbc.writeMem(0x2673, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x12);
        EXPECT(gbc.b(),  0x18);
        EXPECT(gbc.c(),  0x46);
        EXPECT(gbc.d(),  0x4e);
        EXPECT(gbc.e(),  0x7f);
        EXPECT(gbc.h(),  0x83);
        EXPECT(gbc.l(),  0x58);
        EXPECT(gbc.sp(), 0x6894);
        EXPECT(gbc.pc(), 0x2675);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 00C9
        gbc.setState(0xd3c0, 0xe049, 0xd590, 0x732a, 0xf685, 0xd396, 0x1, 0x1);
        gbc.writeMem(0xd3c0, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd5);
        EXPECT(gbc.b(),  0x73);
        EXPECT(gbc.c(),  0x2a);
        EXPECT(gbc.d(),  0xf6);
        EXPECT(gbc.e(),  0x85);
        EXPECT(gbc.h(),  0xa7);
        EXPECT(gbc.l(),  0x96);
        EXPECT(gbc.sp(), 0xe049);
        EXPECT(gbc.pc(), 0xd3c2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd3c0), 0xcb);
        EXPECT(gbc.readMem(0xd3c1), 0x4);
        // CB 04 00CA
        gbc.setState(0x1d12, 0x5553, 0x5290, 0x6119, 0x7ad0, 0xc938, 0x1, 0x0);
        gbc.writeMem(0x1d12, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x52);
        EXPECT(gbc.b(),  0x61);
        EXPECT(gbc.c(),  0x19);
        EXPECT(gbc.d(),  0x7a);
        EXPECT(gbc.e(),  0xd0);
        EXPECT(gbc.h(),  0x93);
        EXPECT(gbc.l(),  0x38);
        EXPECT(gbc.sp(), 0x5553);
        EXPECT(gbc.pc(), 0x1d14);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 00CB
        gbc.setState(0xeac4, 0x1afc, 0x5aa0, 0x71d5, 0xbe4e, 0xc713, 0x0, 0x0);
        gbc.writeMem(0xeac4, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x5a);
        EXPECT(gbc.b(),  0x71);
        EXPECT(gbc.c(),  0xd5);
        EXPECT(gbc.d(),  0xbe);
        EXPECT(gbc.e(),  0x4e);
        EXPECT(gbc.h(),  0x8f);
        EXPECT(gbc.l(),  0x13);
        EXPECT(gbc.sp(), 0x1afc);
        EXPECT(gbc.pc(), 0xeac6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xeac4), 0xcb);
        EXPECT(gbc.readMem(0xeac5), 0x4);
        // CB 04 00CC
        gbc.setState(0x54a1, 0x2993, 0x250, 0x94b8, 0x7a1d, 0x60c1, 0x0, 0x1);
        gbc.writeMem(0x54a1, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0x94);
        EXPECT(gbc.c(),  0xb8);
        EXPECT(gbc.d(),  0x7a);
        EXPECT(gbc.e(),  0x1d);
        EXPECT(gbc.h(),  0xc0);
        EXPECT(gbc.l(),  0xc1);
        EXPECT(gbc.sp(), 0x2993);
        EXPECT(gbc.pc(), 0x54a3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 00CD
        gbc.setState(0x4ae7, 0x99f8, 0x77b0, 0x4a80, 0xe92a, 0x92b6, 0x0, 0x0);
        gbc.writeMem(0x4ae7, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x77);
        EXPECT(gbc.b(),  0x4a);
        EXPECT(gbc.c(),  0x80);
        EXPECT(gbc.d(),  0xe9);
        EXPECT(gbc.e(),  0x2a);
        EXPECT(gbc.h(),  0x25);
        EXPECT(gbc.l(),  0xb6);
        EXPECT(gbc.sp(), 0x99f8);
        EXPECT(gbc.pc(), 0x4ae9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 00CF
        gbc.setState(0x3ef2, 0x40c8, 0xec0, 0x39fd, 0xdb32, 0x772a, 0x0, 0x0);
        gbc.writeMem(0x3ef2, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe);
        EXPECT(gbc.b(),  0x39);
        EXPECT(gbc.c(),  0xfd);
        EXPECT(gbc.d(),  0xdb);
        EXPECT(gbc.e(),  0x32);
        EXPECT(gbc.h(),  0xee);
        EXPECT(gbc.l(),  0x2a);
        EXPECT(gbc.sp(), 0x40c8);
        EXPECT(gbc.pc(), 0x3ef4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 00D0
        gbc.setState(0x7fc8, 0x9f02, 0x26b0, 0x2a3e, 0x6681, 0xdfd7, 0x0, 0x1);
        gbc.writeMem(0x7fc8, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x26);
        EXPECT(gbc.b(),  0x2a);
        EXPECT(gbc.c(),  0x3e);
        EXPECT(gbc.d(),  0x66);
        EXPECT(gbc.e(),  0x81);
        EXPECT(gbc.h(),  0xbf);
        EXPECT(gbc.l(),  0xd7);
        EXPECT(gbc.sp(), 0x9f02);
        EXPECT(gbc.pc(), 0x7fca);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 00D1
        gbc.setState(0x2079, 0x9953, 0x9b40, 0xef6f, 0x161f, 0xf775, 0x1, 0x0);
        gbc.writeMem(0x2079, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x9b);
        EXPECT(gbc.b(),  0xef);
        EXPECT(gbc.c(),  0x6f);
        EXPECT(gbc.d(),  0x16);
        EXPECT(gbc.e(),  0x1f);
        EXPECT(gbc.h(),  0xef);
        EXPECT(gbc.l(),  0x75);
        EXPECT(gbc.sp(), 0x9953);
        EXPECT(gbc.pc(), 0x207b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 00D3
        gbc.setState(0x34fa, 0xc6b4, 0x3d50, 0x8d5a, 0x2e5, 0xcb5d, 0x1, 0x0);
        gbc.writeMem(0x34fa, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3d);
        EXPECT(gbc.b(),  0x8d);
        EXPECT(gbc.c(),  0x5a);
        EXPECT(gbc.d(),  0x2);
        EXPECT(gbc.e(),  0xe5);
        EXPECT(gbc.h(),  0x97);
        EXPECT(gbc.l(),  0x5d);
        EXPECT(gbc.sp(), 0xc6b4);
        EXPECT(gbc.pc(), 0x34fc);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 00D4
        gbc.setState(0xe3df, 0x771d, 0x6e70, 0x4ccd, 0x44b9, 0xccec, 0x1, 0x0);
        gbc.writeMem(0xe3df, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x6e);
        EXPECT(gbc.b(),  0x4c);
        EXPECT(gbc.c(),  0xcd);
        EXPECT(gbc.d(),  0x44);
        EXPECT(gbc.e(),  0xb9);
        EXPECT(gbc.h(),  0x99);
        EXPECT(gbc.l(),  0xec);
        EXPECT(gbc.sp(), 0x771d);
        EXPECT(gbc.pc(), 0xe3e1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe3df), 0xcb);
        EXPECT(gbc.readMem(0xe3e0), 0x4);
        // CB 04 00D5
        gbc.setState(0xe233, 0xdb01, 0xf4b0, 0xeedd, 0xdf7, 0xc7b7, 0x1, 0x1);
        gbc.writeMem(0xe233, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf4);
        EXPECT(gbc.b(),  0xee);
        EXPECT(gbc.c(),  0xdd);
        EXPECT(gbc.d(),  0xd);
        EXPECT(gbc.e(),  0xf7);
        EXPECT(gbc.h(),  0x8f);
        EXPECT(gbc.l(),  0xb7);
        EXPECT(gbc.sp(), 0xdb01);
        EXPECT(gbc.pc(), 0xe235);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe233), 0xcb);
        EXPECT(gbc.readMem(0xe234), 0x4);
        // CB 04 00D6
        gbc.setState(0x558d, 0xe11d, 0x7070, 0x9ab7, 0x902c, 0xc361, 0x0, 0x1);
        gbc.writeMem(0x558d, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x70);
        EXPECT(gbc.b(),  0x9a);
        EXPECT(gbc.c(),  0xb7);
        EXPECT(gbc.d(),  0x90);
        EXPECT(gbc.e(),  0x2c);
        EXPECT(gbc.h(),  0x87);
        EXPECT(gbc.l(),  0x61);
        EXPECT(gbc.sp(), 0xe11d);
        EXPECT(gbc.pc(), 0x558f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 00D7
        gbc.setState(0xe0d3, 0xad51, 0x4460, 0x33b0, 0x69b2, 0xc0b1, 0x0, 0x1);
        gbc.writeMem(0xe0d3, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x44);
        EXPECT(gbc.b(),  0x33);
        EXPECT(gbc.c(),  0xb0);
        EXPECT(gbc.d(),  0x69);
        EXPECT(gbc.e(),  0xb2);
        EXPECT(gbc.h(),  0x81);
        EXPECT(gbc.l(),  0xb1);
        EXPECT(gbc.sp(), 0xad51);
        EXPECT(gbc.pc(), 0xe0d5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe0d3), 0xcb);
        EXPECT(gbc.readMem(0xe0d4), 0x4);
        // CB 04 00D8
        gbc.setState(0x3a3, 0x3d74, 0xd520, 0xb3b0, 0x2f08, 0x19c3, 0x1, 0x0);
        gbc.writeMem(0x3a3, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd5);
        EXPECT(gbc.b(),  0xb3);
        EXPECT(gbc.c(),  0xb0);
        EXPECT(gbc.d(),  0x2f);
        EXPECT(gbc.e(),  0x8);
        EXPECT(gbc.h(),  0x32);
        EXPECT(gbc.l(),  0xc3);
        EXPECT(gbc.sp(), 0x3d74);
        EXPECT(gbc.pc(), 0x3a5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 00D9
        gbc.setState(0x2204, 0xf058, 0x3920, 0xc84, 0xde55, 0x8823, 0x1, 0x0);
        gbc.writeMem(0x2204, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x39);
        EXPECT(gbc.b(),  0xc);
        EXPECT(gbc.c(),  0x84);
        EXPECT(gbc.d(),  0xde);
        EXPECT(gbc.e(),  0x55);
        EXPECT(gbc.h(),  0x11);
        EXPECT(gbc.l(),  0x23);
        EXPECT(gbc.sp(), 0xf058);
        EXPECT(gbc.pc(), 0x2206);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 00DA
        gbc.setState(0x8171, 0xf4db, 0xe960, 0x832c, 0x9ddf, 0xfaa0, 0x1, 0x1);
        gbc.writeMem(0x8171, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe9);
        EXPECT(gbc.b(),  0x83);
        EXPECT(gbc.c(),  0x2c);
        EXPECT(gbc.d(),  0x9d);
        EXPECT(gbc.e(),  0xdf);
        EXPECT(gbc.h(),  0xf5);
        EXPECT(gbc.l(),  0xa0);
        EXPECT(gbc.sp(), 0xf4db);
        EXPECT(gbc.pc(), 0x8173);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8171), 0xcb);
        EXPECT(gbc.readMem(0x8172), 0x4);
        // CB 04 00DB
        gbc.setState(0x6f38, 0x40d7, 0xbf40, 0x58f1, 0xb2c, 0xd16b, 0x0, 0x0);
        gbc.writeMem(0x6f38, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xbf);
        EXPECT(gbc.b(),  0x58);
        EXPECT(gbc.c(),  0xf1);
        EXPECT(gbc.d(),  0xb);
        EXPECT(gbc.e(),  0x2c);
        EXPECT(gbc.h(),  0xa3);
        EXPECT(gbc.l(),  0x6b);
        EXPECT(gbc.sp(), 0x40d7);
        EXPECT(gbc.pc(), 0x6f3a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 00DC
        gbc.setState(0x62e9, 0xf854, 0x9200, 0xf877, 0xa21e, 0x194b, 0x1, 0x1);
        gbc.writeMem(0x62e9, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x92);
        EXPECT(gbc.b(),  0xf8);
        EXPECT(gbc.c(),  0x77);
        EXPECT(gbc.d(),  0xa2);
        EXPECT(gbc.e(),  0x1e);
        EXPECT(gbc.h(),  0x32);
        EXPECT(gbc.l(),  0x4b);
        EXPECT(gbc.sp(), 0xf854);
        EXPECT(gbc.pc(), 0x62eb);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 00DD
        gbc.setState(0xcef2, 0x6433, 0x1a80, 0x44e, 0x4106, 0x5db, 0x1, 0x0);
        gbc.writeMem(0xcef2, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1a);
        EXPECT(gbc.b(),  0x4);
        EXPECT(gbc.c(),  0x4e);
        EXPECT(gbc.d(),  0x41);
        EXPECT(gbc.e(),  0x6);
        EXPECT(gbc.h(),  0xa);
        EXPECT(gbc.l(),  0xdb);
        EXPECT(gbc.sp(), 0x6433);
        EXPECT(gbc.pc(), 0xcef4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcef2), 0xcb);
        EXPECT(gbc.readMem(0xcef3), 0x4);
        // CB 04 00DE
        gbc.setState(0xb390, 0xe107, 0xeba0, 0xef2e, 0x332b, 0xf377, 0x1, 0x1);
        gbc.writeMem(0xb390, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xeb);
        EXPECT(gbc.b(),  0xef);
        EXPECT(gbc.c(),  0x2e);
        EXPECT(gbc.d(),  0x33);
        EXPECT(gbc.e(),  0x2b);
        EXPECT(gbc.h(),  0xe7);
        EXPECT(gbc.l(),  0x77);
        EXPECT(gbc.sp(), 0xe107);
        EXPECT(gbc.pc(), 0xb392);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb390), 0xcb);
        EXPECT(gbc.readMem(0xb391), 0x4);
        // CB 04 00DF
        gbc.setState(0x347, 0xad81, 0xffc0, 0x18e5, 0xf13a, 0x6216, 0x0, 0x1);
        gbc.writeMem(0x347, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xff);
        EXPECT(gbc.b(),  0x18);
        EXPECT(gbc.c(),  0xe5);
        EXPECT(gbc.d(),  0xf1);
        EXPECT(gbc.e(),  0x3a);
        EXPECT(gbc.h(),  0xc4);
        EXPECT(gbc.l(),  0x16);
        EXPECT(gbc.sp(), 0xad81);
        EXPECT(gbc.pc(), 0x349);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 00E1
        gbc.setState(0xb763, 0xaded, 0xd090, 0x116c, 0x8ba6, 0x4121, 0x1, 0x0);
        gbc.writeMem(0xb763, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd0);
        EXPECT(gbc.b(),  0x11);
        EXPECT(gbc.c(),  0x6c);
        EXPECT(gbc.d(),  0x8b);
        EXPECT(gbc.e(),  0xa6);
        EXPECT(gbc.h(),  0x82);
        EXPECT(gbc.l(),  0x21);
        EXPECT(gbc.sp(), 0xaded);
        EXPECT(gbc.pc(), 0xb765);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb763), 0xcb);
        EXPECT(gbc.readMem(0xb764), 0x4);
        // CB 04 00E2
        gbc.setState(0xfa3, 0x6d9a, 0x600, 0xeaff, 0x4961, 0x8e8a, 0x1, 0x0);
        gbc.writeMem(0xfa3, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x6);
        EXPECT(gbc.b(),  0xea);
        EXPECT(gbc.c(),  0xff);
        EXPECT(gbc.d(),  0x49);
        EXPECT(gbc.e(),  0x61);
        EXPECT(gbc.h(),  0x1d);
        EXPECT(gbc.l(),  0x8a);
        EXPECT(gbc.sp(), 0x6d9a);
        EXPECT(gbc.pc(), 0xfa5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 00E3
        gbc.setState(0xdc4b, 0xe181, 0xf250, 0xb47b, 0x3e2e, 0x6509, 0x1, 0x1);
        gbc.writeMem(0xdc4b, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf2);
        EXPECT(gbc.b(),  0xb4);
        EXPECT(gbc.c(),  0x7b);
        EXPECT(gbc.d(),  0x3e);
        EXPECT(gbc.e(),  0x2e);
        EXPECT(gbc.h(),  0xca);
        EXPECT(gbc.l(),  0x9);
        EXPECT(gbc.sp(), 0xe181);
        EXPECT(gbc.pc(), 0xdc4d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdc4b), 0xcb);
        EXPECT(gbc.readMem(0xdc4c), 0x4);
        // CB 04 00E4
        gbc.setState(0x2d8c, 0xdf81, 0xeba0, 0x776a, 0x11bd, 0x1427, 0x1, 0x1);
        gbc.writeMem(0x2d8c, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xeb);
        EXPECT(gbc.b(),  0x77);
        EXPECT(gbc.c(),  0x6a);
        EXPECT(gbc.d(),  0x11);
        EXPECT(gbc.e(),  0xbd);
        EXPECT(gbc.h(),  0x28);
        EXPECT(gbc.l(),  0x27);
        EXPECT(gbc.sp(), 0xdf81);
        EXPECT(gbc.pc(), 0x2d8e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 00E5
        gbc.setState(0x11ff, 0xd3dc, 0xeac0, 0x7f71, 0xe785, 0x5a8, 0x1, 0x0);
        gbc.writeMem(0x11ff, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xea);
        EXPECT(gbc.b(),  0x7f);
        EXPECT(gbc.c(),  0x71);
        EXPECT(gbc.d(),  0xe7);
        EXPECT(gbc.e(),  0x85);
        EXPECT(gbc.h(),  0xa);
        EXPECT(gbc.l(),  0xa8);
        EXPECT(gbc.sp(), 0xd3dc);
        EXPECT(gbc.pc(), 0x1201);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 00E6
        gbc.setState(0x3145, 0x1476, 0xec30, 0x38f6, 0x52d0, 0x80dd, 0x0, 0x1);
        gbc.writeMem(0x3145, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xec);
        EXPECT(gbc.b(),  0x38);
        EXPECT(gbc.c(),  0xf6);
        EXPECT(gbc.d(),  0x52);
        EXPECT(gbc.e(),  0xd0);
        EXPECT(gbc.h(),  0x1);
        EXPECT(gbc.l(),  0xdd);
        EXPECT(gbc.sp(), 0x1476);
        EXPECT(gbc.pc(), 0x3147);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 00E9
        gbc.setState(0x45e7, 0x68e6, 0xa130, 0xa229, 0xbc9b, 0x7fb1, 0x1, 0x1);
        gbc.writeMem(0x45e7, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa1);
        EXPECT(gbc.b(),  0xa2);
        EXPECT(gbc.c(),  0x29);
        EXPECT(gbc.d(),  0xbc);
        EXPECT(gbc.e(),  0x9b);
        EXPECT(gbc.h(),  0xfe);
        EXPECT(gbc.l(),  0xb1);
        EXPECT(gbc.sp(), 0x68e6);
        EXPECT(gbc.pc(), 0x45e9);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 00EB
        gbc.setState(0x7334, 0x100e, 0xfdf0, 0xe56d, 0x9ea0, 0xd96b, 0x1, 0x1);
        gbc.writeMem(0x7334, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xfd);
        EXPECT(gbc.b(),  0xe5);
        EXPECT(gbc.c(),  0x6d);
        EXPECT(gbc.d(),  0x9e);
        EXPECT(gbc.e(),  0xa0);
        EXPECT(gbc.h(),  0xb3);
        EXPECT(gbc.l(),  0x6b);
        EXPECT(gbc.sp(), 0x100e);
        EXPECT(gbc.pc(), 0x7336);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 00EC
        gbc.setState(0x3ac5, 0xf1e0, 0xd320, 0x8ad4, 0x1887, 0x860f, 0x1, 0x0);
        gbc.writeMem(0x3ac5, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd3);
        EXPECT(gbc.b(),  0x8a);
        EXPECT(gbc.c(),  0xd4);
        EXPECT(gbc.d(),  0x18);
        EXPECT(gbc.e(),  0x87);
        EXPECT(gbc.h(),  0xd);
        EXPECT(gbc.l(),  0xf);
        EXPECT(gbc.sp(), 0xf1e0);
        EXPECT(gbc.pc(), 0x3ac7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 00ED
        gbc.setState(0xea3d, 0x9c03, 0xc80, 0xda7e, 0x7477, 0x6319, 0x0, 0x0);
        gbc.writeMem(0xea3d, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc);
        EXPECT(gbc.b(),  0xda);
        EXPECT(gbc.c(),  0x7e);
        EXPECT(gbc.d(),  0x74);
        EXPECT(gbc.e(),  0x77);
        EXPECT(gbc.h(),  0xc6);
        EXPECT(gbc.l(),  0x19);
        EXPECT(gbc.sp(), 0x9c03);
        EXPECT(gbc.pc(), 0xea3f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xea3d), 0xcb);
        EXPECT(gbc.readMem(0xea3e), 0x4);
        // CB 04 00EE
        gbc.setState(0x2756, 0x5f69, 0xfec0, 0x78cc, 0x3028, 0xbe3c, 0x1, 0x1);
        gbc.writeMem(0x2756, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xfe);
        EXPECT(gbc.b(),  0x78);
        EXPECT(gbc.c(),  0xcc);
        EXPECT(gbc.d(),  0x30);
        EXPECT(gbc.e(),  0x28);
        EXPECT(gbc.h(),  0x7d);
        EXPECT(gbc.l(),  0x3c);
        EXPECT(gbc.sp(), 0x5f69);
        EXPECT(gbc.pc(), 0x2758);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 00EF
        gbc.setState(0xacde, 0xb15b, 0x26d0, 0x4773, 0xbab5, 0x597f, 0x0, 0x0);
        gbc.writeMem(0xacde, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x26);
        EXPECT(gbc.b(),  0x47);
        EXPECT(gbc.c(),  0x73);
        EXPECT(gbc.d(),  0xba);
        EXPECT(gbc.e(),  0xb5);
        EXPECT(gbc.h(),  0xb2);
        EXPECT(gbc.l(),  0x7f);
        EXPECT(gbc.sp(), 0xb15b);
        EXPECT(gbc.pc(), 0xace0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xacde), 0xcb);
        EXPECT(gbc.readMem(0xacdf), 0x4);
        // CB 04 00F0
        gbc.setState(0x57cd, 0xc5dc, 0x4330, 0x8608, 0xb8f2, 0xa73b, 0x0, 0x1);
        gbc.writeMem(0x57cd, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x43);
        EXPECT(gbc.b(),  0x86);
        EXPECT(gbc.c(),  0x8);
        EXPECT(gbc.d(),  0xb8);
        EXPECT(gbc.e(),  0xf2);
        EXPECT(gbc.h(),  0x4f);
        EXPECT(gbc.l(),  0x3b);
        EXPECT(gbc.sp(), 0xc5dc);
        EXPECT(gbc.pc(), 0x57cf);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 00F1
        gbc.setState(0x107a, 0x2fd, 0x540, 0xb198, 0xeb56, 0x9a95, 0x1, 0x1);
        gbc.writeMem(0x107a, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x5);
        EXPECT(gbc.b(),  0xb1);
        EXPECT(gbc.c(),  0x98);
        EXPECT(gbc.d(),  0xeb);
        EXPECT(gbc.e(),  0x56);
        EXPECT(gbc.h(),  0x35);
        EXPECT(gbc.l(),  0x95);
        EXPECT(gbc.sp(), 0x2fd);
        EXPECT(gbc.pc(), 0x107c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 00F3
        gbc.setState(0xa673, 0x5c50, 0x58c0, 0xea56, 0x9bb9, 0xc330, 0x0, 0x0);
        gbc.writeMem(0xa673, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x58);
        EXPECT(gbc.b(),  0xea);
        EXPECT(gbc.c(),  0x56);
        EXPECT(gbc.d(),  0x9b);
        EXPECT(gbc.e(),  0xb9);
        EXPECT(gbc.h(),  0x87);
        EXPECT(gbc.l(),  0x30);
        EXPECT(gbc.sp(), 0x5c50);
        EXPECT(gbc.pc(), 0xa675);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa673), 0xcb);
        EXPECT(gbc.readMem(0xa674), 0x4);
        // CB 04 00F4
        gbc.setState(0x4414, 0x13e9, 0xad10, 0x4608, 0xa243, 0xaa6b, 0x0, 0x1);
        gbc.writeMem(0x4414, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xad);
        EXPECT(gbc.b(),  0x46);
        EXPECT(gbc.c(),  0x8);
        EXPECT(gbc.d(),  0xa2);
        EXPECT(gbc.e(),  0x43);
        EXPECT(gbc.h(),  0x55);
        EXPECT(gbc.l(),  0x6b);
        EXPECT(gbc.sp(), 0x13e9);
        EXPECT(gbc.pc(), 0x4416);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 00F5
        gbc.setState(0xa4c2, 0x84af, 0x2d00, 0xc1e, 0x3742, 0x6f49, 0x1, 0x1);
        gbc.writeMem(0xa4c2, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2d);
        EXPECT(gbc.b(),  0xc);
        EXPECT(gbc.c(),  0x1e);
        EXPECT(gbc.d(),  0x37);
        EXPECT(gbc.e(),  0x42);
        EXPECT(gbc.h(),  0xde);
        EXPECT(gbc.l(),  0x49);
        EXPECT(gbc.sp(), 0x84af);
        EXPECT(gbc.pc(), 0xa4c4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa4c2), 0xcb);
        EXPECT(gbc.readMem(0xa4c3), 0x4);
        // CB 04 00F6
        gbc.setState(0x1cee, 0xecda, 0xd750, 0xedb6, 0xc3f5, 0xa52f, 0x1, 0x1);
        gbc.writeMem(0x1cee, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd7);
        EXPECT(gbc.b(),  0xed);
        EXPECT(gbc.c(),  0xb6);
        EXPECT(gbc.d(),  0xc3);
        EXPECT(gbc.e(),  0xf5);
        EXPECT(gbc.h(),  0x4b);
        EXPECT(gbc.l(),  0x2f);
        EXPECT(gbc.sp(), 0xecda);
        EXPECT(gbc.pc(), 0x1cf0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 00F7
        gbc.setState(0x301f, 0xfc36, 0x3fe0, 0x566e, 0x3a10, 0xc18f, 0x1, 0x1);
        gbc.writeMem(0x301f, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3f);
        EXPECT(gbc.b(),  0x56);
        EXPECT(gbc.c(),  0x6e);
        EXPECT(gbc.d(),  0x3a);
        EXPECT(gbc.e(),  0x10);
        EXPECT(gbc.h(),  0x83);
        EXPECT(gbc.l(),  0x8f);
        EXPECT(gbc.sp(), 0xfc36);
        EXPECT(gbc.pc(), 0x3021);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 00F8
        gbc.setState(0x1bfd, 0xea4c, 0x92f0, 0xe31, 0x78bb, 0x7b47, 0x1, 0x0);
        gbc.writeMem(0x1bfd, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x92);
        EXPECT(gbc.b(),  0xe);
        EXPECT(gbc.c(),  0x31);
        EXPECT(gbc.d(),  0x78);
        EXPECT(gbc.e(),  0xbb);
        EXPECT(gbc.h(),  0xf6);
        EXPECT(gbc.l(),  0x47);
        EXPECT(gbc.sp(), 0xea4c);
        EXPECT(gbc.pc(), 0x1bff);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 00F9
        gbc.setState(0xa3f8, 0x91b5, 0xc140, 0x24c2, 0x5734, 0x6073, 0x0, 0x0);
        gbc.writeMem(0xa3f8, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc1);
        EXPECT(gbc.b(),  0x24);
        EXPECT(gbc.c(),  0xc2);
        EXPECT(gbc.d(),  0x57);
        EXPECT(gbc.e(),  0x34);
        EXPECT(gbc.h(),  0xc0);
        EXPECT(gbc.l(),  0x73);
        EXPECT(gbc.sp(), 0x91b5);
        EXPECT(gbc.pc(), 0xa3fa);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa3f8), 0xcb);
        EXPECT(gbc.readMem(0xa3f9), 0x4);
        // CB 04 00FA
        gbc.setState(0x2886, 0xca3a, 0x71b0, 0x2053, 0x2bb9, 0x981f, 0x0, 0x0);
        gbc.writeMem(0x2886, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x71);
        EXPECT(gbc.b(),  0x20);
        EXPECT(gbc.c(),  0x53);
        EXPECT(gbc.d(),  0x2b);
        EXPECT(gbc.e(),  0xb9);
        EXPECT(gbc.h(),  0x31);
        EXPECT(gbc.l(),  0x1f);
        EXPECT(gbc.sp(), 0xca3a);
        EXPECT(gbc.pc(), 0x2888);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 00FB
        gbc.setState(0x6456, 0x26b7, 0x80e0, 0xda60, 0xa1eb, 0x525b, 0x1, 0x1);
        gbc.writeMem(0x6456, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0xda);
        EXPECT(gbc.c(),  0x60);
        EXPECT(gbc.d(),  0xa1);
        EXPECT(gbc.e(),  0xeb);
        EXPECT(gbc.h(),  0xa4);
        EXPECT(gbc.l(),  0x5b);
        EXPECT(gbc.sp(), 0x26b7);
        EXPECT(gbc.pc(), 0x6458);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 00FC
        gbc.setState(0x233e, 0x920d, 0x5250, 0xd2be, 0xc97b, 0x15a6, 0x0, 0x0);
        gbc.writeMem(0x233e, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x52);
        EXPECT(gbc.b(),  0xd2);
        EXPECT(gbc.c(),  0xbe);
        EXPECT(gbc.d(),  0xc9);
        EXPECT(gbc.e(),  0x7b);
        EXPECT(gbc.h(),  0x2a);
        EXPECT(gbc.l(),  0xa6);
        EXPECT(gbc.sp(), 0x920d);
        EXPECT(gbc.pc(), 0x2340);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 00FD
        gbc.setState(0x67ec, 0x995a, 0x9600, 0xef74, 0x9ef0, 0xbfbf, 0x0, 0x0);
        gbc.writeMem(0x67ec, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x96);
        EXPECT(gbc.b(),  0xef);
        EXPECT(gbc.c(),  0x74);
        EXPECT(gbc.d(),  0x9e);
        EXPECT(gbc.e(),  0xf0);
        EXPECT(gbc.h(),  0x7f);
        EXPECT(gbc.l(),  0xbf);
        EXPECT(gbc.sp(), 0x995a);
        EXPECT(gbc.pc(), 0x67ee);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 00FE
        gbc.setState(0x2e85, 0x2d27, 0x3960, 0x71c2, 0xe65, 0x7d62, 0x1, 0x0);
        gbc.writeMem(0x2e85, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x39);
        EXPECT(gbc.b(),  0x71);
        EXPECT(gbc.c(),  0xc2);
        EXPECT(gbc.d(),  0xe);
        EXPECT(gbc.e(),  0x65);
        EXPECT(gbc.h(),  0xfa);
        EXPECT(gbc.l(),  0x62);
        EXPECT(gbc.sp(), 0x2d27);
        EXPECT(gbc.pc(), 0x2e87);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 00FF
        gbc.setState(0x86ae, 0xee49, 0xb0c0, 0xb684, 0xee93, 0x8034, 0x0, 0x1);
        gbc.writeMem(0x86ae, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb0);
        EXPECT(gbc.b(),  0xb6);
        EXPECT(gbc.c(),  0x84);
        EXPECT(gbc.d(),  0xee);
        EXPECT(gbc.e(),  0x93);
        EXPECT(gbc.h(),  0x1);
        EXPECT(gbc.l(),  0x34);
        EXPECT(gbc.sp(), 0xee49);
        EXPECT(gbc.pc(), 0x86b0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x86ae), 0xcb);
        EXPECT(gbc.readMem(0x86af), 0x4);
        // CB 04 0100
        gbc.setState(0x86fb, 0xcbc2, 0x1870, 0x86bf, 0x9deb, 0x8e82, 0x0, 0x1);
        gbc.writeMem(0x86fb, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x18);
        EXPECT(gbc.b(),  0x86);
        EXPECT(gbc.c(),  0xbf);
        EXPECT(gbc.d(),  0x9d);
        EXPECT(gbc.e(),  0xeb);
        EXPECT(gbc.h(),  0x1d);
        EXPECT(gbc.l(),  0x82);
        EXPECT(gbc.sp(), 0xcbc2);
        EXPECT(gbc.pc(), 0x86fd);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x86fb), 0xcb);
        EXPECT(gbc.readMem(0x86fc), 0x4);
        // CB 04 0101
        gbc.setState(0x1bff, 0xd424, 0x3db0, 0x8985, 0x8d8, 0x798c, 0x1, 0x1);
        gbc.writeMem(0x1bff, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3d);
        EXPECT(gbc.b(),  0x89);
        EXPECT(gbc.c(),  0x85);
        EXPECT(gbc.d(),  0x8);
        EXPECT(gbc.e(),  0xd8);
        EXPECT(gbc.h(),  0xf2);
        EXPECT(gbc.l(),  0x8c);
        EXPECT(gbc.sp(), 0xd424);
        EXPECT(gbc.pc(), 0x1c01);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0102
        gbc.setState(0xa7bb, 0xad3a, 0x3570, 0xfe8c, 0xf4f8, 0x5e57, 0x1, 0x1);
        gbc.writeMem(0xa7bb, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x35);
        EXPECT(gbc.b(),  0xfe);
        EXPECT(gbc.c(),  0x8c);
        EXPECT(gbc.d(),  0xf4);
        EXPECT(gbc.e(),  0xf8);
        EXPECT(gbc.h(),  0xbc);
        EXPECT(gbc.l(),  0x57);
        EXPECT(gbc.sp(), 0xad3a);
        EXPECT(gbc.pc(), 0xa7bd);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa7bb), 0xcb);
        EXPECT(gbc.readMem(0xa7bc), 0x4);
        // CB 04 0103
        gbc.setState(0x6224, 0xd4f, 0x4ca0, 0x7f6, 0x9717, 0xdd13, 0x1, 0x0);
        gbc.writeMem(0x6224, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4c);
        EXPECT(gbc.b(),  0x7);
        EXPECT(gbc.c(),  0xf6);
        EXPECT(gbc.d(),  0x97);
        EXPECT(gbc.e(),  0x17);
        EXPECT(gbc.h(),  0xbb);
        EXPECT(gbc.l(),  0x13);
        EXPECT(gbc.sp(), 0xd4f);
        EXPECT(gbc.pc(), 0x6226);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0104
        gbc.setState(0x422d, 0x1dff, 0x8650, 0x48b7, 0x47a1, 0xfaa9, 0x0, 0x0);
        gbc.writeMem(0x422d, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x86);
        EXPECT(gbc.b(),  0x48);
        EXPECT(gbc.c(),  0xb7);
        EXPECT(gbc.d(),  0x47);
        EXPECT(gbc.e(),  0xa1);
        EXPECT(gbc.h(),  0xf5);
        EXPECT(gbc.l(),  0xa9);
        EXPECT(gbc.sp(), 0x1dff);
        EXPECT(gbc.pc(), 0x422f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0105
        gbc.setState(0xefd, 0xff73, 0x6850, 0x89e1, 0x9572, 0x6541, 0x1, 0x1);
        gbc.writeMem(0xefd, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x68);
        EXPECT(gbc.b(),  0x89);
        EXPECT(gbc.c(),  0xe1);
        EXPECT(gbc.d(),  0x95);
        EXPECT(gbc.e(),  0x72);
        EXPECT(gbc.h(),  0xca);
        EXPECT(gbc.l(),  0x41);
        EXPECT(gbc.sp(), 0xff73);
        EXPECT(gbc.pc(), 0xeff);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0107
        gbc.setState(0x3854, 0xe8f3, 0x4be0, 0xcc75, 0xbb8a, 0x999a, 0x1, 0x0);
        gbc.writeMem(0x3854, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4b);
        EXPECT(gbc.b(),  0xcc);
        EXPECT(gbc.c(),  0x75);
        EXPECT(gbc.d(),  0xbb);
        EXPECT(gbc.e(),  0x8a);
        EXPECT(gbc.h(),  0x33);
        EXPECT(gbc.l(),  0x9a);
        EXPECT(gbc.sp(), 0xe8f3);
        EXPECT(gbc.pc(), 0x3856);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0108
        gbc.setState(0x373f, 0x8f35, 0x9ba0, 0x7570, 0x27fd, 0x9d24, 0x1, 0x0);
        gbc.writeMem(0x373f, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x9b);
        EXPECT(gbc.b(),  0x75);
        EXPECT(gbc.c(),  0x70);
        EXPECT(gbc.d(),  0x27);
        EXPECT(gbc.e(),  0xfd);
        EXPECT(gbc.h(),  0x3b);
        EXPECT(gbc.l(),  0x24);
        EXPECT(gbc.sp(), 0x8f35);
        EXPECT(gbc.pc(), 0x3741);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0109
        gbc.setState(0x407f, 0x454a, 0xba70, 0x7479, 0x4616, 0xcaad, 0x0, 0x1);
        gbc.writeMem(0x407f, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xba);
        EXPECT(gbc.b(),  0x74);
        EXPECT(gbc.c(),  0x79);
        EXPECT(gbc.d(),  0x46);
        EXPECT(gbc.e(),  0x16);
        EXPECT(gbc.h(),  0x95);
        EXPECT(gbc.l(),  0xad);
        EXPECT(gbc.sp(), 0x454a);
        EXPECT(gbc.pc(), 0x4081);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 010A
        gbc.setState(0xa528, 0xfff3, 0x3cb0, 0xfa40, 0xc126, 0xe079, 0x0, 0x1);
        gbc.writeMem(0xa528, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3c);
        EXPECT(gbc.b(),  0xfa);
        EXPECT(gbc.c(),  0x40);
        EXPECT(gbc.d(),  0xc1);
        EXPECT(gbc.e(),  0x26);
        EXPECT(gbc.h(),  0xc1);
        EXPECT(gbc.l(),  0x79);
        EXPECT(gbc.sp(), 0xfff3);
        EXPECT(gbc.pc(), 0xa52a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa528), 0xcb);
        EXPECT(gbc.readMem(0xa529), 0x4);
        // CB 04 010B
        gbc.setState(0x50c8, 0xa97f, 0x43e0, 0xfe15, 0x745a, 0x6857, 0x0, 0x0);
        gbc.writeMem(0x50c8, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x43);
        EXPECT(gbc.b(),  0xfe);
        EXPECT(gbc.c(),  0x15);
        EXPECT(gbc.d(),  0x74);
        EXPECT(gbc.e(),  0x5a);
        EXPECT(gbc.h(),  0xd0);
        EXPECT(gbc.l(),  0x57);
        EXPECT(gbc.sp(), 0xa97f);
        EXPECT(gbc.pc(), 0x50ca);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 010D
        gbc.setState(0x4675, 0xbffe, 0x54f0, 0x9425, 0xda33, 0x2e1e, 0x1, 0x0);
        gbc.writeMem(0x4675, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x54);
        EXPECT(gbc.b(),  0x94);
        EXPECT(gbc.c(),  0x25);
        EXPECT(gbc.d(),  0xda);
        EXPECT(gbc.e(),  0x33);
        EXPECT(gbc.h(),  0x5c);
        EXPECT(gbc.l(),  0x1e);
        EXPECT(gbc.sp(), 0xbffe);
        EXPECT(gbc.pc(), 0x4677);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 010E
        gbc.setState(0xd19b, 0xbe5, 0xd230, 0xd53d, 0xbad7, 0x2772, 0x1, 0x1);
        gbc.writeMem(0xd19b, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd2);
        EXPECT(gbc.b(),  0xd5);
        EXPECT(gbc.c(),  0x3d);
        EXPECT(gbc.d(),  0xba);
        EXPECT(gbc.e(),  0xd7);
        EXPECT(gbc.h(),  0x4e);
        EXPECT(gbc.l(),  0x72);
        EXPECT(gbc.sp(), 0xbe5);
        EXPECT(gbc.pc(), 0xd19d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd19b), 0xcb);
        EXPECT(gbc.readMem(0xd19c), 0x4);
        // CB 04 010F
        gbc.setState(0x485a, 0xe9f3, 0x88b0, 0x3678, 0x1eed, 0xc1e0, 0x0, 0x1);
        gbc.writeMem(0x485a, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x88);
        EXPECT(gbc.b(),  0x36);
        EXPECT(gbc.c(),  0x78);
        EXPECT(gbc.d(),  0x1e);
        EXPECT(gbc.e(),  0xed);
        EXPECT(gbc.h(),  0x83);
        EXPECT(gbc.l(),  0xe0);
        EXPECT(gbc.sp(), 0xe9f3);
        EXPECT(gbc.pc(), 0x485c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0110
        gbc.setState(0x45b3, 0x4c83, 0x3cd0, 0xc9b4, 0x4c11, 0xf888, 0x0, 0x1);
        gbc.writeMem(0x45b3, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3c);
        EXPECT(gbc.b(),  0xc9);
        EXPECT(gbc.c(),  0xb4);
        EXPECT(gbc.d(),  0x4c);
        EXPECT(gbc.e(),  0x11);
        EXPECT(gbc.h(),  0xf1);
        EXPECT(gbc.l(),  0x88);
        EXPECT(gbc.sp(), 0x4c83);
        EXPECT(gbc.pc(), 0x45b5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0111
        gbc.setState(0x88a5, 0xf204, 0x68d0, 0xbdeb, 0x75e9, 0xb1d6, 0x1, 0x1);
        gbc.writeMem(0x88a5, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x68);
        EXPECT(gbc.b(),  0xbd);
        EXPECT(gbc.c(),  0xeb);
        EXPECT(gbc.d(),  0x75);
        EXPECT(gbc.e(),  0xe9);
        EXPECT(gbc.h(),  0x63);
        EXPECT(gbc.l(),  0xd6);
        EXPECT(gbc.sp(), 0xf204);
        EXPECT(gbc.pc(), 0x88a7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x88a5), 0xcb);
        EXPECT(gbc.readMem(0x88a6), 0x4);
        // CB 04 0112
        gbc.setState(0x2534, 0xe686, 0x23d0, 0x22f5, 0x4f70, 0xf59a, 0x1, 0x0);
        gbc.writeMem(0x2534, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x23);
        EXPECT(gbc.b(),  0x22);
        EXPECT(gbc.c(),  0xf5);
        EXPECT(gbc.d(),  0x4f);
        EXPECT(gbc.e(),  0x70);
        EXPECT(gbc.h(),  0xeb);
        EXPECT(gbc.l(),  0x9a);
        EXPECT(gbc.sp(), 0xe686);
        EXPECT(gbc.pc(), 0x2536);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0113
        gbc.setState(0x35ad, 0x514b, 0xd450, 0xa6a1, 0x8665, 0xcb53, 0x1, 0x1);
        gbc.writeMem(0x35ad, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd4);
        EXPECT(gbc.b(),  0xa6);
        EXPECT(gbc.c(),  0xa1);
        EXPECT(gbc.d(),  0x86);
        EXPECT(gbc.e(),  0x65);
        EXPECT(gbc.h(),  0x97);
        EXPECT(gbc.l(),  0x53);
        EXPECT(gbc.sp(), 0x514b);
        EXPECT(gbc.pc(), 0x35af);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0114
        gbc.setState(0xa571, 0x2b75, 0x1f00, 0xbc08, 0x9a51, 0x5d84, 0x0, 0x0);
        gbc.writeMem(0xa571, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1f);
        EXPECT(gbc.b(),  0xbc);
        EXPECT(gbc.c(),  0x8);
        EXPECT(gbc.d(),  0x9a);
        EXPECT(gbc.e(),  0x51);
        EXPECT(gbc.h(),  0xba);
        EXPECT(gbc.l(),  0x84);
        EXPECT(gbc.sp(), 0x2b75);
        EXPECT(gbc.pc(), 0xa573);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa571), 0xcb);
        EXPECT(gbc.readMem(0xa572), 0x4);
        // CB 04 0116
        gbc.setState(0x2f04, 0x6110, 0xe8b0, 0x12e0, 0xcca3, 0x12e, 0x1, 0x0);
        gbc.writeMem(0x2f04, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe8);
        EXPECT(gbc.b(),  0x12);
        EXPECT(gbc.c(),  0xe0);
        EXPECT(gbc.d(),  0xcc);
        EXPECT(gbc.e(),  0xa3);
        EXPECT(gbc.h(),  0x2);
        EXPECT(gbc.l(),  0x2e);
        EXPECT(gbc.sp(), 0x6110);
        EXPECT(gbc.pc(), 0x2f06);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0117
        gbc.setState(0xa1fd, 0xf1cf, 0x2990, 0x8b37, 0xce3b, 0xc0ef, 0x0, 0x1);
        gbc.writeMem(0xa1fd, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x29);
        EXPECT(gbc.b(),  0x8b);
        EXPECT(gbc.c(),  0x37);
        EXPECT(gbc.d(),  0xce);
        EXPECT(gbc.e(),  0x3b);
        EXPECT(gbc.h(),  0x81);
        EXPECT(gbc.l(),  0xef);
        EXPECT(gbc.sp(), 0xf1cf);
        EXPECT(gbc.pc(), 0xa1ff);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa1fd), 0xcb);
        EXPECT(gbc.readMem(0xa1fe), 0x4);
        // CB 04 0118
        gbc.setState(0x30ce, 0x63e1, 0xacd0, 0x3c35, 0x66f7, 0xda21, 0x0, 0x1);
        gbc.writeMem(0x30ce, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xac);
        EXPECT(gbc.b(),  0x3c);
        EXPECT(gbc.c(),  0x35);
        EXPECT(gbc.d(),  0x66);
        EXPECT(gbc.e(),  0xf7);
        EXPECT(gbc.h(),  0xb5);
        EXPECT(gbc.l(),  0x21);
        EXPECT(gbc.sp(), 0x63e1);
        EXPECT(gbc.pc(), 0x30d0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 011A
        gbc.setState(0xc2cc, 0xccd8, 0xbc10, 0x4bf, 0xbe95, 0x6580, 0x1, 0x1);
        gbc.writeMem(0xc2cc, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xbc);
        EXPECT(gbc.b(),  0x4);
        EXPECT(gbc.c(),  0xbf);
        EXPECT(gbc.d(),  0xbe);
        EXPECT(gbc.e(),  0x95);
        EXPECT(gbc.h(),  0xca);
        EXPECT(gbc.l(),  0x80);
        EXPECT(gbc.sp(), 0xccd8);
        EXPECT(gbc.pc(), 0xc2ce);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc2cc), 0xcb);
        EXPECT(gbc.readMem(0xc2cd), 0x4);
        // CB 04 011B
        gbc.setState(0xb46b, 0xa7f1, 0xb1a0, 0x4d84, 0xa36d, 0x9838, 0x1, 0x1);
        gbc.writeMem(0xb46b, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb1);
        EXPECT(gbc.b(),  0x4d);
        EXPECT(gbc.c(),  0x84);
        EXPECT(gbc.d(),  0xa3);
        EXPECT(gbc.e(),  0x6d);
        EXPECT(gbc.h(),  0x31);
        EXPECT(gbc.l(),  0x38);
        EXPECT(gbc.sp(), 0xa7f1);
        EXPECT(gbc.pc(), 0xb46d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb46b), 0xcb);
        EXPECT(gbc.readMem(0xb46c), 0x4);
        // CB 04 011C
        gbc.setState(0xba7a, 0x9846, 0x1290, 0x39d4, 0x1d6e, 0xe8d0, 0x1, 0x1);
        gbc.writeMem(0xba7a, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x12);
        EXPECT(gbc.b(),  0x39);
        EXPECT(gbc.c(),  0xd4);
        EXPECT(gbc.d(),  0x1d);
        EXPECT(gbc.e(),  0x6e);
        EXPECT(gbc.h(),  0xd1);
        EXPECT(gbc.l(),  0xd0);
        EXPECT(gbc.sp(), 0x9846);
        EXPECT(gbc.pc(), 0xba7c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xba7a), 0xcb);
        EXPECT(gbc.readMem(0xba7b), 0x4);
        // CB 04 011D
        gbc.setState(0x2b9e, 0xceeb, 0x79f0, 0xb63, 0xb0b0, 0xc055, 0x0, 0x0);
        gbc.writeMem(0x2b9e, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x79);
        EXPECT(gbc.b(),  0xb);
        EXPECT(gbc.c(),  0x63);
        EXPECT(gbc.d(),  0xb0);
        EXPECT(gbc.e(),  0xb0);
        EXPECT(gbc.h(),  0x81);
        EXPECT(gbc.l(),  0x55);
        EXPECT(gbc.sp(), 0xceeb);
        EXPECT(gbc.pc(), 0x2ba0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 011E
        gbc.setState(0x479a, 0x6668, 0xf2f0, 0x4a57, 0xc9ff, 0x885, 0x1, 0x1);
        gbc.writeMem(0x479a, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf2);
        EXPECT(gbc.b(),  0x4a);
        EXPECT(gbc.c(),  0x57);
        EXPECT(gbc.d(),  0xc9);
        EXPECT(gbc.e(),  0xff);
        EXPECT(gbc.h(),  0x10);
        EXPECT(gbc.l(),  0x85);
        EXPECT(gbc.sp(), 0x6668);
        EXPECT(gbc.pc(), 0x479c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 011F
        gbc.setState(0x638b, 0x8512, 0x5540, 0xe29d, 0x47fb, 0x49cf, 0x1, 0x0);
        gbc.writeMem(0x638b, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x55);
        EXPECT(gbc.b(),  0xe2);
        EXPECT(gbc.c(),  0x9d);
        EXPECT(gbc.d(),  0x47);
        EXPECT(gbc.e(),  0xfb);
        EXPECT(gbc.h(),  0x92);
        EXPECT(gbc.l(),  0xcf);
        EXPECT(gbc.sp(), 0x8512);
        EXPECT(gbc.pc(), 0x638d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0120
        gbc.setState(0x5c9f, 0x9f71, 0xc370, 0xa19, 0xc866, 0x67f9, 0x0, 0x1);
        gbc.writeMem(0x5c9f, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc3);
        EXPECT(gbc.b(),  0xa);
        EXPECT(gbc.c(),  0x19);
        EXPECT(gbc.d(),  0xc8);
        EXPECT(gbc.e(),  0x66);
        EXPECT(gbc.h(),  0xce);
        EXPECT(gbc.l(),  0xf9);
        EXPECT(gbc.sp(), 0x9f71);
        EXPECT(gbc.pc(), 0x5ca1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0121
        gbc.setState(0x2feb, 0x39af, 0xebb0, 0x2dd9, 0x62d0, 0x83c0, 0x1, 0x1);
        gbc.writeMem(0x2feb, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xeb);
        EXPECT(gbc.b(),  0x2d);
        EXPECT(gbc.c(),  0xd9);
        EXPECT(gbc.d(),  0x62);
        EXPECT(gbc.e(),  0xd0);
        EXPECT(gbc.h(),  0x7);
        EXPECT(gbc.l(),  0xc0);
        EXPECT(gbc.sp(), 0x39af);
        EXPECT(gbc.pc(), 0x2fed);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0122
        gbc.setState(0x52ab, 0x1037, 0x63f0, 0xd05, 0x3893, 0xc72c, 0x0, 0x1);
        gbc.writeMem(0x52ab, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x63);
        EXPECT(gbc.b(),  0xd);
        EXPECT(gbc.c(),  0x5);
        EXPECT(gbc.d(),  0x38);
        EXPECT(gbc.e(),  0x93);
        EXPECT(gbc.h(),  0x8f);
        EXPECT(gbc.l(),  0x2c);
        EXPECT(gbc.sp(), 0x1037);
        EXPECT(gbc.pc(), 0x52ad);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0123
        gbc.setState(0x8775, 0xe450, 0xb050, 0xf7c0, 0xaf29, 0x782, 0x0, 0x0);
        gbc.writeMem(0x8775, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb0);
        EXPECT(gbc.b(),  0xf7);
        EXPECT(gbc.c(),  0xc0);
        EXPECT(gbc.d(),  0xaf);
        EXPECT(gbc.e(),  0x29);
        EXPECT(gbc.h(),  0xe);
        EXPECT(gbc.l(),  0x82);
        EXPECT(gbc.sp(), 0xe450);
        EXPECT(gbc.pc(), 0x8777);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8775), 0xcb);
        EXPECT(gbc.readMem(0x8776), 0x4);
        // CB 04 0124
        gbc.setState(0xe1d6, 0x26ed, 0x2b40, 0x8fe8, 0xed80, 0xf71d, 0x0, 0x1);
        gbc.writeMem(0xe1d6, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2b);
        EXPECT(gbc.b(),  0x8f);
        EXPECT(gbc.c(),  0xe8);
        EXPECT(gbc.d(),  0xed);
        EXPECT(gbc.e(),  0x80);
        EXPECT(gbc.h(),  0xef);
        EXPECT(gbc.l(),  0x1d);
        EXPECT(gbc.sp(), 0x26ed);
        EXPECT(gbc.pc(), 0xe1d8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe1d6), 0xcb);
        EXPECT(gbc.readMem(0xe1d7), 0x4);
        // CB 04 0125
        gbc.setState(0x3457, 0x868c, 0xc5f0, 0xe8d7, 0x30d2, 0xc04a, 0x1, 0x0);
        gbc.writeMem(0x3457, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc5);
        EXPECT(gbc.b(),  0xe8);
        EXPECT(gbc.c(),  0xd7);
        EXPECT(gbc.d(),  0x30);
        EXPECT(gbc.e(),  0xd2);
        EXPECT(gbc.h(),  0x81);
        EXPECT(gbc.l(),  0x4a);
        EXPECT(gbc.sp(), 0x868c);
        EXPECT(gbc.pc(), 0x3459);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0126
        gbc.setState(0x8ebf, 0x4742, 0xe4a0, 0x77a5, 0xf9dd, 0x3be3, 0x1, 0x0);
        gbc.writeMem(0x8ebf, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe4);
        EXPECT(gbc.b(),  0x77);
        EXPECT(gbc.c(),  0xa5);
        EXPECT(gbc.d(),  0xf9);
        EXPECT(gbc.e(),  0xdd);
        EXPECT(gbc.h(),  0x76);
        EXPECT(gbc.l(),  0xe3);
        EXPECT(gbc.sp(), 0x4742);
        EXPECT(gbc.pc(), 0x8ec1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8ebf), 0xcb);
        EXPECT(gbc.readMem(0x8ec0), 0x4);
        // CB 04 0127
        gbc.setState(0x8142, 0x23dc, 0x6e30, 0xa160, 0xe537, 0x9433, 0x1, 0x1);
        gbc.writeMem(0x8142, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x6e);
        EXPECT(gbc.b(),  0xa1);
        EXPECT(gbc.c(),  0x60);
        EXPECT(gbc.d(),  0xe5);
        EXPECT(gbc.e(),  0x37);
        EXPECT(gbc.h(),  0x29);
        EXPECT(gbc.l(),  0x33);
        EXPECT(gbc.sp(), 0x23dc);
        EXPECT(gbc.pc(), 0x8144);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8142), 0xcb);
        EXPECT(gbc.readMem(0x8143), 0x4);
        // CB 04 0128
        gbc.setState(0x37e7, 0x43be, 0xf490, 0x7fc4, 0x243f, 0x97a0, 0x0, 0x0);
        gbc.writeMem(0x37e7, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf4);
        EXPECT(gbc.b(),  0x7f);
        EXPECT(gbc.c(),  0xc4);
        EXPECT(gbc.d(),  0x24);
        EXPECT(gbc.e(),  0x3f);
        EXPECT(gbc.h(),  0x2f);
        EXPECT(gbc.l(),  0xa0);
        EXPECT(gbc.sp(), 0x43be);
        EXPECT(gbc.pc(), 0x37e9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0129
        gbc.setState(0x7b20, 0xcd0e, 0x7a30, 0x5423, 0x60e4, 0x404f, 0x0, 0x1);
        gbc.writeMem(0x7b20, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x7a);
        EXPECT(gbc.b(),  0x54);
        EXPECT(gbc.c(),  0x23);
        EXPECT(gbc.d(),  0x60);
        EXPECT(gbc.e(),  0xe4);
        EXPECT(gbc.h(),  0x80);
        EXPECT(gbc.l(),  0x4f);
        EXPECT(gbc.sp(), 0xcd0e);
        EXPECT(gbc.pc(), 0x7b22);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 012A
        gbc.setState(0xae4a, 0xbde7, 0xfb80, 0x3975, 0xf581, 0x65c5, 0x0, 0x1);
        gbc.writeMem(0xae4a, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xfb);
        EXPECT(gbc.b(),  0x39);
        EXPECT(gbc.c(),  0x75);
        EXPECT(gbc.d(),  0xf5);
        EXPECT(gbc.e(),  0x81);
        EXPECT(gbc.h(),  0xca);
        EXPECT(gbc.l(),  0xc5);
        EXPECT(gbc.sp(), 0xbde7);
        EXPECT(gbc.pc(), 0xae4c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xae4a), 0xcb);
        EXPECT(gbc.readMem(0xae4b), 0x4);
        // CB 04 012B
        gbc.setState(0xcec, 0x3260, 0x8960, 0xba32, 0x41ae, 0xecce, 0x1, 0x1);
        gbc.writeMem(0xcec, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x89);
        EXPECT(gbc.b(),  0xba);
        EXPECT(gbc.c(),  0x32);
        EXPECT(gbc.d(),  0x41);
        EXPECT(gbc.e(),  0xae);
        EXPECT(gbc.h(),  0xd9);
        EXPECT(gbc.l(),  0xce);
        EXPECT(gbc.sp(), 0x3260);
        EXPECT(gbc.pc(), 0xcee);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 012C
        gbc.setState(0x68f2, 0x90a6, 0x1d20, 0x1166, 0x6608, 0x6750, 0x1, 0x1);
        gbc.writeMem(0x68f2, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1d);
        EXPECT(gbc.b(),  0x11);
        EXPECT(gbc.c(),  0x66);
        EXPECT(gbc.d(),  0x66);
        EXPECT(gbc.e(),  0x8);
        EXPECT(gbc.h(),  0xce);
        EXPECT(gbc.l(),  0x50);
        EXPECT(gbc.sp(), 0x90a6);
        EXPECT(gbc.pc(), 0x68f4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 012D
        gbc.setState(0x6f2, 0x3ac9, 0x19d0, 0xadd6, 0xd003, 0x9e61, 0x1, 0x0);
        gbc.writeMem(0x6f2, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x19);
        EXPECT(gbc.b(),  0xad);
        EXPECT(gbc.c(),  0xd6);
        EXPECT(gbc.d(),  0xd0);
        EXPECT(gbc.e(),  0x3);
        EXPECT(gbc.h(),  0x3d);
        EXPECT(gbc.l(),  0x61);
        EXPECT(gbc.sp(), 0x3ac9);
        EXPECT(gbc.pc(), 0x6f4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 012E
        gbc.setState(0x4ba7, 0x2a0b, 0xdae0, 0xa8d7, 0x150f, 0x28d1, 0x0, 0x0);
        gbc.writeMem(0x4ba7, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xda);
        EXPECT(gbc.b(),  0xa8);
        EXPECT(gbc.c(),  0xd7);
        EXPECT(gbc.d(),  0x15);
        EXPECT(gbc.e(),  0xf);
        EXPECT(gbc.h(),  0x50);
        EXPECT(gbc.l(),  0xd1);
        EXPECT(gbc.sp(), 0x2a0b);
        EXPECT(gbc.pc(), 0x4ba9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 012F
        gbc.setState(0x889, 0xa647, 0xb720, 0x4e49, 0xa070, 0x5cbe, 0x1, 0x0);
        gbc.writeMem(0x889, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb7);
        EXPECT(gbc.b(),  0x4e);
        EXPECT(gbc.c(),  0x49);
        EXPECT(gbc.d(),  0xa0);
        EXPECT(gbc.e(),  0x70);
        EXPECT(gbc.h(),  0xb8);
        EXPECT(gbc.l(),  0xbe);
        EXPECT(gbc.sp(), 0xa647);
        EXPECT(gbc.pc(), 0x88b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0130
        gbc.setState(0xad, 0x5f60, 0x3500, 0x9782, 0xde4b, 0xe3c8, 0x0, 0x0);
        gbc.writeMem(0xad, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x35);
        EXPECT(gbc.b(),  0x97);
        EXPECT(gbc.c(),  0x82);
        EXPECT(gbc.d(),  0xde);
        EXPECT(gbc.e(),  0x4b);
        EXPECT(gbc.h(),  0xc7);
        EXPECT(gbc.l(),  0xc8);
        EXPECT(gbc.sp(), 0x5f60);
        EXPECT(gbc.pc(), 0xaf);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0131
        gbc.setState(0xcc1, 0x13de, 0x8570, 0xc773, 0x18b9, 0x846b, 0x0, 0x1);
        gbc.writeMem(0xcc1, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x85);
        EXPECT(gbc.b(),  0xc7);
        EXPECT(gbc.c(),  0x73);
        EXPECT(gbc.d(),  0x18);
        EXPECT(gbc.e(),  0xb9);
        EXPECT(gbc.h(),  0x9);
        EXPECT(gbc.l(),  0x6b);
        EXPECT(gbc.sp(), 0x13de);
        EXPECT(gbc.pc(), 0xcc3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0132
        gbc.setState(0x93c4, 0x1c33, 0xb700, 0x863, 0x34a3, 0x17fc, 0x1, 0x1);
        gbc.writeMem(0x93c4, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb7);
        EXPECT(gbc.b(),  0x8);
        EXPECT(gbc.c(),  0x63);
        EXPECT(gbc.d(),  0x34);
        EXPECT(gbc.e(),  0xa3);
        EXPECT(gbc.h(),  0x2e);
        EXPECT(gbc.l(),  0xfc);
        EXPECT(gbc.sp(), 0x1c33);
        EXPECT(gbc.pc(), 0x93c6);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x93c4), 0xcb);
        EXPECT(gbc.readMem(0x93c5), 0x4);
        // CB 04 0133
        gbc.setState(0x5938, 0xe15b, 0xd460, 0xa118, 0xdc33, 0x6d66, 0x1, 0x1);
        gbc.writeMem(0x5938, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd4);
        EXPECT(gbc.b(),  0xa1);
        EXPECT(gbc.c(),  0x18);
        EXPECT(gbc.d(),  0xdc);
        EXPECT(gbc.e(),  0x33);
        EXPECT(gbc.h(),  0xda);
        EXPECT(gbc.l(),  0x66);
        EXPECT(gbc.sp(), 0xe15b);
        EXPECT(gbc.pc(), 0x593a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0135
        gbc.setState(0xe334, 0x8ee3, 0x2f0, 0x5809, 0xa1d1, 0x52e8, 0x1, 0x0);
        gbc.writeMem(0xe334, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0x58);
        EXPECT(gbc.c(),  0x9);
        EXPECT(gbc.d(),  0xa1);
        EXPECT(gbc.e(),  0xd1);
        EXPECT(gbc.h(),  0xa4);
        EXPECT(gbc.l(),  0xe8);
        EXPECT(gbc.sp(), 0x8ee3);
        EXPECT(gbc.pc(), 0xe336);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe334), 0xcb);
        EXPECT(gbc.readMem(0xe335), 0x4);
        // CB 04 0136
        gbc.setState(0x99c9, 0x8b22, 0xae90, 0xf1f6, 0x5d9, 0x3f20, 0x0, 0x0);
        gbc.writeMem(0x99c9, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xae);
        EXPECT(gbc.b(),  0xf1);
        EXPECT(gbc.c(),  0xf6);
        EXPECT(gbc.d(),  0x5);
        EXPECT(gbc.e(),  0xd9);
        EXPECT(gbc.h(),  0x7e);
        EXPECT(gbc.l(),  0x20);
        EXPECT(gbc.sp(), 0x8b22);
        EXPECT(gbc.pc(), 0x99cb);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x99c9), 0xcb);
        EXPECT(gbc.readMem(0x99ca), 0x4);
        // CB 04 0137
        gbc.setState(0x9853, 0xb0eb, 0xcc20, 0x47be, 0xf1f2, 0xd19e, 0x1, 0x1);
        gbc.writeMem(0x9853, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xcc);
        EXPECT(gbc.b(),  0x47);
        EXPECT(gbc.c(),  0xbe);
        EXPECT(gbc.d(),  0xf1);
        EXPECT(gbc.e(),  0xf2);
        EXPECT(gbc.h(),  0xa3);
        EXPECT(gbc.l(),  0x9e);
        EXPECT(gbc.sp(), 0xb0eb);
        EXPECT(gbc.pc(), 0x9855);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9853), 0xcb);
        EXPECT(gbc.readMem(0x9854), 0x4);
        // CB 04 0138
        gbc.setState(0xd835, 0x45b8, 0x3360, 0xc3a4, 0xde2e, 0x3411, 0x0, 0x0);
        gbc.writeMem(0xd835, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x33);
        EXPECT(gbc.b(),  0xc3);
        EXPECT(gbc.c(),  0xa4);
        EXPECT(gbc.d(),  0xde);
        EXPECT(gbc.e(),  0x2e);
        EXPECT(gbc.h(),  0x68);
        EXPECT(gbc.l(),  0x11);
        EXPECT(gbc.sp(), 0x45b8);
        EXPECT(gbc.pc(), 0xd837);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd835), 0xcb);
        EXPECT(gbc.readMem(0xd836), 0x4);
        // CB 04 0139
        gbc.setState(0x324e, 0xc143, 0xfe40, 0x5dc1, 0x9a75, 0xb748, 0x1, 0x1);
        gbc.writeMem(0x324e, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xfe);
        EXPECT(gbc.b(),  0x5d);
        EXPECT(gbc.c(),  0xc1);
        EXPECT(gbc.d(),  0x9a);
        EXPECT(gbc.e(),  0x75);
        EXPECT(gbc.h(),  0x6f);
        EXPECT(gbc.l(),  0x48);
        EXPECT(gbc.sp(), 0xc143);
        EXPECT(gbc.pc(), 0x3250);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 013A
        gbc.setState(0x521e, 0x4306, 0x7b0, 0x183e, 0x68f9, 0xbbe9, 0x0, 0x0);
        gbc.writeMem(0x521e, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x7);
        EXPECT(gbc.b(),  0x18);
        EXPECT(gbc.c(),  0x3e);
        EXPECT(gbc.d(),  0x68);
        EXPECT(gbc.e(),  0xf9);
        EXPECT(gbc.h(),  0x77);
        EXPECT(gbc.l(),  0xe9);
        EXPECT(gbc.sp(), 0x4306);
        EXPECT(gbc.pc(), 0x5220);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 013B
        gbc.setState(0xb272, 0xd0da, 0xf5c0, 0x8233, 0x3171, 0x13ec, 0x1, 0x0);
        gbc.writeMem(0xb272, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf5);
        EXPECT(gbc.b(),  0x82);
        EXPECT(gbc.c(),  0x33);
        EXPECT(gbc.d(),  0x31);
        EXPECT(gbc.e(),  0x71);
        EXPECT(gbc.h(),  0x26);
        EXPECT(gbc.l(),  0xec);
        EXPECT(gbc.sp(), 0xd0da);
        EXPECT(gbc.pc(), 0xb274);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb272), 0xcb);
        EXPECT(gbc.readMem(0xb273), 0x4);
        // CB 04 013C
        gbc.setState(0x73fe, 0xcabc, 0x830, 0x2cb0, 0x2a9c, 0x7e70, 0x1, 0x1);
        gbc.writeMem(0x73fe, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0x2c);
        EXPECT(gbc.c(),  0xb0);
        EXPECT(gbc.d(),  0x2a);
        EXPECT(gbc.e(),  0x9c);
        EXPECT(gbc.h(),  0xfc);
        EXPECT(gbc.l(),  0x70);
        EXPECT(gbc.sp(), 0xcabc);
        EXPECT(gbc.pc(), 0x7400);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 013D
        gbc.setState(0x449b, 0x12ac, 0xfbf0, 0xf48e, 0xf59d, 0x9b, 0x1, 0x0);
        gbc.writeMem(0x449b, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xfb);
        EXPECT(gbc.b(),  0xf4);
        EXPECT(gbc.c(),  0x8e);
        EXPECT(gbc.d(),  0xf5);
        EXPECT(gbc.e(),  0x9d);
        EXPECT(gbc.h(),  0x0);
        EXPECT(gbc.l(),  0x9b);
        EXPECT(gbc.sp(), 0x12ac);
        EXPECT(gbc.pc(), 0x449d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 013E
        gbc.setState(0x597b, 0xcb0f, 0xc2b0, 0xfe29, 0x9649, 0x81ca, 0x0, 0x0);
        gbc.writeMem(0x597b, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc2);
        EXPECT(gbc.b(),  0xfe);
        EXPECT(gbc.c(),  0x29);
        EXPECT(gbc.d(),  0x96);
        EXPECT(gbc.e(),  0x49);
        EXPECT(gbc.h(),  0x3);
        EXPECT(gbc.l(),  0xca);
        EXPECT(gbc.sp(), 0xcb0f);
        EXPECT(gbc.pc(), 0x597d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 013F
        gbc.setState(0x5d4d, 0xec74, 0x7260, 0xba18, 0x91c1, 0xd425, 0x1, 0x1);
        gbc.writeMem(0x5d4d, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x72);
        EXPECT(gbc.b(),  0xba);
        EXPECT(gbc.c(),  0x18);
        EXPECT(gbc.d(),  0x91);
        EXPECT(gbc.e(),  0xc1);
        EXPECT(gbc.h(),  0xa9);
        EXPECT(gbc.l(),  0x25);
        EXPECT(gbc.sp(), 0xec74);
        EXPECT(gbc.pc(), 0x5d4f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0140
        gbc.setState(0x62d0, 0x57c6, 0x1050, 0x90ae, 0xd4f7, 0x69fd, 0x1, 0x0);
        gbc.writeMem(0x62d0, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0x90);
        EXPECT(gbc.c(),  0xae);
        EXPECT(gbc.d(),  0xd4);
        EXPECT(gbc.e(),  0xf7);
        EXPECT(gbc.h(),  0xd2);
        EXPECT(gbc.l(),  0xfd);
        EXPECT(gbc.sp(), 0x57c6);
        EXPECT(gbc.pc(), 0x62d2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0141
        gbc.setState(0x443c, 0x6a27, 0x1d00, 0xd587, 0x5d57, 0xc020, 0x0, 0x1);
        gbc.writeMem(0x443c, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1d);
        EXPECT(gbc.b(),  0xd5);
        EXPECT(gbc.c(),  0x87);
        EXPECT(gbc.d(),  0x5d);
        EXPECT(gbc.e(),  0x57);
        EXPECT(gbc.h(),  0x81);
        EXPECT(gbc.l(),  0x20);
        EXPECT(gbc.sp(), 0x6a27);
        EXPECT(gbc.pc(), 0x443e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0142
        gbc.setState(0xef53, 0x4500, 0x41e0, 0xba5f, 0xf78b, 0x7e32, 0x1, 0x1);
        gbc.writeMem(0xef53, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x41);
        EXPECT(gbc.b(),  0xba);
        EXPECT(gbc.c(),  0x5f);
        EXPECT(gbc.d(),  0xf7);
        EXPECT(gbc.e(),  0x8b);
        EXPECT(gbc.h(),  0xfc);
        EXPECT(gbc.l(),  0x32);
        EXPECT(gbc.sp(), 0x4500);
        EXPECT(gbc.pc(), 0xef55);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xef53), 0xcb);
        EXPECT(gbc.readMem(0xef54), 0x4);
        // CB 04 0143
        gbc.setState(0x378a, 0xf157, 0x89c0, 0xc123, 0xebf3, 0x9b07, 0x1, 0x0);
        gbc.writeMem(0x378a, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x89);
        EXPECT(gbc.b(),  0xc1);
        EXPECT(gbc.c(),  0x23);
        EXPECT(gbc.d(),  0xeb);
        EXPECT(gbc.e(),  0xf3);
        EXPECT(gbc.h(),  0x37);
        EXPECT(gbc.l(),  0x7);
        EXPECT(gbc.sp(), 0xf157);
        EXPECT(gbc.pc(), 0x378c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0144
        gbc.setState(0xbac9, 0xd9b4, 0x87f0, 0x8434, 0x983f, 0x7dc6, 0x0, 0x0);
        gbc.writeMem(0xbac9, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x87);
        EXPECT(gbc.b(),  0x84);
        EXPECT(gbc.c(),  0x34);
        EXPECT(gbc.d(),  0x98);
        EXPECT(gbc.e(),  0x3f);
        EXPECT(gbc.h(),  0xfa);
        EXPECT(gbc.l(),  0xc6);
        EXPECT(gbc.sp(), 0xd9b4);
        EXPECT(gbc.pc(), 0xbacb);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbac9), 0xcb);
        EXPECT(gbc.readMem(0xbaca), 0x4);
        // CB 04 0145
        gbc.setState(0x5153, 0x8b4, 0xe040, 0x3e05, 0x6f1, 0x3341, 0x1, 0x0);
        gbc.writeMem(0x5153, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe0);
        EXPECT(gbc.b(),  0x3e);
        EXPECT(gbc.c(),  0x5);
        EXPECT(gbc.d(),  0x6);
        EXPECT(gbc.e(),  0xf1);
        EXPECT(gbc.h(),  0x66);
        EXPECT(gbc.l(),  0x41);
        EXPECT(gbc.sp(), 0x8b4);
        EXPECT(gbc.pc(), 0x5155);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0146
        gbc.setState(0x1f05, 0xd603, 0x63b0, 0x7280, 0x2cc1, 0xa1f9, 0x1, 0x1);
        gbc.writeMem(0x1f05, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x63);
        EXPECT(gbc.b(),  0x72);
        EXPECT(gbc.c(),  0x80);
        EXPECT(gbc.d(),  0x2c);
        EXPECT(gbc.e(),  0xc1);
        EXPECT(gbc.h(),  0x43);
        EXPECT(gbc.l(),  0xf9);
        EXPECT(gbc.sp(), 0xd603);
        EXPECT(gbc.pc(), 0x1f07);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0147
        gbc.setState(0x4de3, 0x902c, 0xb600, 0x5047, 0x6538, 0xff35, 0x1, 0x1);
        gbc.writeMem(0x4de3, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb6);
        EXPECT(gbc.b(),  0x50);
        EXPECT(gbc.c(),  0x47);
        EXPECT(gbc.d(),  0x65);
        EXPECT(gbc.e(),  0x38);
        EXPECT(gbc.h(),  0xff);
        EXPECT(gbc.l(),  0x35);
        EXPECT(gbc.sp(), 0x902c);
        EXPECT(gbc.pc(), 0x4de5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0149
        gbc.setState(0xdeb8, 0xd5c2, 0x75e0, 0xdc12, 0x402a, 0x821f, 0x1, 0x0);
        gbc.writeMem(0xdeb8, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x75);
        EXPECT(gbc.b(),  0xdc);
        EXPECT(gbc.c(),  0x12);
        EXPECT(gbc.d(),  0x40);
        EXPECT(gbc.e(),  0x2a);
        EXPECT(gbc.h(),  0x5);
        EXPECT(gbc.l(),  0x1f);
        EXPECT(gbc.sp(), 0xd5c2);
        EXPECT(gbc.pc(), 0xdeba);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xdeb8), 0xcb);
        EXPECT(gbc.readMem(0xdeb9), 0x4);
        // CB 04 014A
        gbc.setState(0xe6d1, 0x256c, 0x9390, 0xd48c, 0x20a, 0xd406, 0x1, 0x0);
        gbc.writeMem(0xe6d1, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x93);
        EXPECT(gbc.b(),  0xd4);
        EXPECT(gbc.c(),  0x8c);
        EXPECT(gbc.d(),  0x2);
        EXPECT(gbc.e(),  0xa);
        EXPECT(gbc.h(),  0xa9);
        EXPECT(gbc.l(),  0x6);
        EXPECT(gbc.sp(), 0x256c);
        EXPECT(gbc.pc(), 0xe6d3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe6d1), 0xcb);
        EXPECT(gbc.readMem(0xe6d2), 0x4);
        // CB 04 014B
        gbc.setState(0xd518, 0x714, 0x3390, 0xdf01, 0xe300, 0xb7d, 0x1, 0x1);
        gbc.writeMem(0xd518, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x33);
        EXPECT(gbc.b(),  0xdf);
        EXPECT(gbc.c(),  0x1);
        EXPECT(gbc.d(),  0xe3);
        EXPECT(gbc.e(),  0x0);
        EXPECT(gbc.h(),  0x16);
        EXPECT(gbc.l(),  0x7d);
        EXPECT(gbc.sp(), 0x714);
        EXPECT(gbc.pc(), 0xd51a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd518), 0xcb);
        EXPECT(gbc.readMem(0xd519), 0x4);
        // CB 04 014C
        gbc.setState(0x4896, 0x7b53, 0x28f0, 0x6064, 0x3cba, 0x1352, 0x0, 0x0);
        gbc.writeMem(0x4896, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0x60);
        EXPECT(gbc.c(),  0x64);
        EXPECT(gbc.d(),  0x3c);
        EXPECT(gbc.e(),  0xba);
        EXPECT(gbc.h(),  0x26);
        EXPECT(gbc.l(),  0x52);
        EXPECT(gbc.sp(), 0x7b53);
        EXPECT(gbc.pc(), 0x4898);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 014D
        gbc.setState(0x5f6c, 0x64f, 0x9d10, 0xff10, 0xd295, 0xd5c5, 0x1, 0x0);
        gbc.writeMem(0x5f6c, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x9d);
        EXPECT(gbc.b(),  0xff);
        EXPECT(gbc.c(),  0x10);
        EXPECT(gbc.d(),  0xd2);
        EXPECT(gbc.e(),  0x95);
        EXPECT(gbc.h(),  0xab);
        EXPECT(gbc.l(),  0xc5);
        EXPECT(gbc.sp(), 0x64f);
        EXPECT(gbc.pc(), 0x5f6e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 014E
        gbc.setState(0x4cf2, 0x437c, 0x3290, 0x81e1, 0x62a6, 0xf32e, 0x0, 0x0);
        gbc.writeMem(0x4cf2, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x32);
        EXPECT(gbc.b(),  0x81);
        EXPECT(gbc.c(),  0xe1);
        EXPECT(gbc.d(),  0x62);
        EXPECT(gbc.e(),  0xa6);
        EXPECT(gbc.h(),  0xe7);
        EXPECT(gbc.l(),  0x2e);
        EXPECT(gbc.sp(), 0x437c);
        EXPECT(gbc.pc(), 0x4cf4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 014F
        gbc.setState(0x1469, 0x74e7, 0x1820, 0xbc0, 0xe7d4, 0xbcfc, 0x0, 0x0);
        gbc.writeMem(0x1469, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x18);
        EXPECT(gbc.b(),  0xb);
        EXPECT(gbc.c(),  0xc0);
        EXPECT(gbc.d(),  0xe7);
        EXPECT(gbc.e(),  0xd4);
        EXPECT(gbc.h(),  0x79);
        EXPECT(gbc.l(),  0xfc);
        EXPECT(gbc.sp(), 0x74e7);
        EXPECT(gbc.pc(), 0x146b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0150
        gbc.setState(0xdb5, 0x309c, 0x3d40, 0x363, 0x8db7, 0x8698, 0x1, 0x1);
        gbc.writeMem(0xdb5, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3d);
        EXPECT(gbc.b(),  0x3);
        EXPECT(gbc.c(),  0x63);
        EXPECT(gbc.d(),  0x8d);
        EXPECT(gbc.e(),  0xb7);
        EXPECT(gbc.h(),  0xd);
        EXPECT(gbc.l(),  0x98);
        EXPECT(gbc.sp(), 0x309c);
        EXPECT(gbc.pc(), 0xdb7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0151
        gbc.setState(0xa524, 0x3025, 0x94c0, 0x43f3, 0xc696, 0x1be8, 0x0, 0x0);
        gbc.writeMem(0xa524, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x94);
        EXPECT(gbc.b(),  0x43);
        EXPECT(gbc.c(),  0xf3);
        EXPECT(gbc.d(),  0xc6);
        EXPECT(gbc.e(),  0x96);
        EXPECT(gbc.h(),  0x36);
        EXPECT(gbc.l(),  0xe8);
        EXPECT(gbc.sp(), 0x3025);
        EXPECT(gbc.pc(), 0xa526);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa524), 0xcb);
        EXPECT(gbc.readMem(0xa525), 0x4);
        // CB 04 0152
        gbc.setState(0x7305, 0x9773, 0x1460, 0xb4f, 0x5ad2, 0x4b9, 0x0, 0x0);
        gbc.writeMem(0x7305, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x14);
        EXPECT(gbc.b(),  0xb);
        EXPECT(gbc.c(),  0x4f);
        EXPECT(gbc.d(),  0x5a);
        EXPECT(gbc.e(),  0xd2);
        EXPECT(gbc.h(),  0x8);
        EXPECT(gbc.l(),  0xb9);
        EXPECT(gbc.sp(), 0x9773);
        EXPECT(gbc.pc(), 0x7307);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0153
        gbc.setState(0x37de, 0xde1a, 0x8960, 0xa1a7, 0x7d36, 0xfe15, 0x1, 0x0);
        gbc.writeMem(0x37de, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x89);
        EXPECT(gbc.b(),  0xa1);
        EXPECT(gbc.c(),  0xa7);
        EXPECT(gbc.d(),  0x7d);
        EXPECT(gbc.e(),  0x36);
        EXPECT(gbc.h(),  0xfd);
        EXPECT(gbc.l(),  0x15);
        EXPECT(gbc.sp(), 0xde1a);
        EXPECT(gbc.pc(), 0x37e0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0154
        gbc.setState(0xc2a9, 0x2c31, 0xa360, 0x1fb3, 0xa601, 0x345d, 0x0, 0x0);
        gbc.writeMem(0xc2a9, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa3);
        EXPECT(gbc.b(),  0x1f);
        EXPECT(gbc.c(),  0xb3);
        EXPECT(gbc.d(),  0xa6);
        EXPECT(gbc.e(),  0x1);
        EXPECT(gbc.h(),  0x68);
        EXPECT(gbc.l(),  0x5d);
        EXPECT(gbc.sp(), 0x2c31);
        EXPECT(gbc.pc(), 0xc2ab);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc2a9), 0xcb);
        EXPECT(gbc.readMem(0xc2aa), 0x4);
        // CB 04 0155
        gbc.setState(0x4cb8, 0x5818, 0xdc10, 0x79b8, 0xad9d, 0xdb15, 0x0, 0x1);
        gbc.writeMem(0x4cb8, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xdc);
        EXPECT(gbc.b(),  0x79);
        EXPECT(gbc.c(),  0xb8);
        EXPECT(gbc.d(),  0xad);
        EXPECT(gbc.e(),  0x9d);
        EXPECT(gbc.h(),  0xb7);
        EXPECT(gbc.l(),  0x15);
        EXPECT(gbc.sp(), 0x5818);
        EXPECT(gbc.pc(), 0x4cba);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0156
        gbc.setState(0x7d78, 0x2e08, 0x4690, 0x846c, 0xebac, 0x31b5, 0x0, 0x0);
        gbc.writeMem(0x7d78, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x46);
        EXPECT(gbc.b(),  0x84);
        EXPECT(gbc.c(),  0x6c);
        EXPECT(gbc.d(),  0xeb);
        EXPECT(gbc.e(),  0xac);
        EXPECT(gbc.h(),  0x62);
        EXPECT(gbc.l(),  0xb5);
        EXPECT(gbc.sp(), 0x2e08);
        EXPECT(gbc.pc(), 0x7d7a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0157
        gbc.setState(0x925b, 0x536, 0x690, 0xf48b, 0x620d, 0x6010, 0x0, 0x1);
        gbc.writeMem(0x925b, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x6);
        EXPECT(gbc.b(),  0xf4);
        EXPECT(gbc.c(),  0x8b);
        EXPECT(gbc.d(),  0x62);
        EXPECT(gbc.e(),  0xd);
        EXPECT(gbc.h(),  0xc0);
        EXPECT(gbc.l(),  0x10);
        EXPECT(gbc.sp(), 0x536);
        EXPECT(gbc.pc(), 0x925d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x925b), 0xcb);
        EXPECT(gbc.readMem(0x925c), 0x4);
        // CB 04 0158
        gbc.setState(0x5623, 0x2b30, 0x4f90, 0x4478, 0xe4e2, 0xa1f5, 0x1, 0x0);
        gbc.writeMem(0x5623, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4f);
        EXPECT(gbc.b(),  0x44);
        EXPECT(gbc.c(),  0x78);
        EXPECT(gbc.d(),  0xe4);
        EXPECT(gbc.e(),  0xe2);
        EXPECT(gbc.h(),  0x43);
        EXPECT(gbc.l(),  0xf5);
        EXPECT(gbc.sp(), 0x2b30);
        EXPECT(gbc.pc(), 0x5625);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0159
        gbc.setState(0x405d, 0x44f3, 0xd560, 0xf224, 0x6aab, 0x30d, 0x1, 0x1);
        gbc.writeMem(0x405d, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd5);
        EXPECT(gbc.b(),  0xf2);
        EXPECT(gbc.c(),  0x24);
        EXPECT(gbc.d(),  0x6a);
        EXPECT(gbc.e(),  0xab);
        EXPECT(gbc.h(),  0x6);
        EXPECT(gbc.l(),  0xd);
        EXPECT(gbc.sp(), 0x44f3);
        EXPECT(gbc.pc(), 0x405f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 015A
        gbc.setState(0xdd4e, 0x431d, 0x2820, 0xe60f, 0xf7dd, 0x1de, 0x0, 0x1);
        gbc.writeMem(0xdd4e, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0xe6);
        EXPECT(gbc.c(),  0xf);
        EXPECT(gbc.d(),  0xf7);
        EXPECT(gbc.e(),  0xdd);
        EXPECT(gbc.h(),  0x2);
        EXPECT(gbc.l(),  0xde);
        EXPECT(gbc.sp(), 0x431d);
        EXPECT(gbc.pc(), 0xdd50);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdd4e), 0xcb);
        EXPECT(gbc.readMem(0xdd4f), 0x4);
        // CB 04 015B
        gbc.setState(0xbe41, 0xff3e, 0x9f30, 0xc02a, 0x293a, 0x7809, 0x1, 0x1);
        gbc.writeMem(0xbe41, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x9f);
        EXPECT(gbc.b(),  0xc0);
        EXPECT(gbc.c(),  0x2a);
        EXPECT(gbc.d(),  0x29);
        EXPECT(gbc.e(),  0x3a);
        EXPECT(gbc.h(),  0xf0);
        EXPECT(gbc.l(),  0x9);
        EXPECT(gbc.sp(), 0xff3e);
        EXPECT(gbc.pc(), 0xbe43);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbe41), 0xcb);
        EXPECT(gbc.readMem(0xbe42), 0x4);
        // CB 04 015D
        gbc.setState(0x1a96, 0xb29e, 0x4f20, 0xccf4, 0xfa6c, 0x36fb, 0x1, 0x1);
        gbc.writeMem(0x1a96, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4f);
        EXPECT(gbc.b(),  0xcc);
        EXPECT(gbc.c(),  0xf4);
        EXPECT(gbc.d(),  0xfa);
        EXPECT(gbc.e(),  0x6c);
        EXPECT(gbc.h(),  0x6c);
        EXPECT(gbc.l(),  0xfb);
        EXPECT(gbc.sp(), 0xb29e);
        EXPECT(gbc.pc(), 0x1a98);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 015E
        gbc.setState(0xe4f8, 0xf70f, 0x9c90, 0x9d50, 0xc6e8, 0x547e, 0x1, 0x0);
        gbc.writeMem(0xe4f8, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x9c);
        EXPECT(gbc.b(),  0x9d);
        EXPECT(gbc.c(),  0x50);
        EXPECT(gbc.d(),  0xc6);
        EXPECT(gbc.e(),  0xe8);
        EXPECT(gbc.h(),  0xa8);
        EXPECT(gbc.l(),  0x7e);
        EXPECT(gbc.sp(), 0xf70f);
        EXPECT(gbc.pc(), 0xe4fa);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe4f8), 0xcb);
        EXPECT(gbc.readMem(0xe4f9), 0x4);
        // CB 04 015F
        gbc.setState(0xacf, 0x7afc, 0x98e0, 0x4fed, 0x4da2, 0x9394, 0x1, 0x1);
        gbc.writeMem(0xacf, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x98);
        EXPECT(gbc.b(),  0x4f);
        EXPECT(gbc.c(),  0xed);
        EXPECT(gbc.d(),  0x4d);
        EXPECT(gbc.e(),  0xa2);
        EXPECT(gbc.h(),  0x27);
        EXPECT(gbc.l(),  0x94);
        EXPECT(gbc.sp(), 0x7afc);
        EXPECT(gbc.pc(), 0xad1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0160
        gbc.setState(0x9f2f, 0x4519, 0xdda0, 0x898e, 0x443f, 0x6e15, 0x1, 0x1);
        gbc.writeMem(0x9f2f, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xdd);
        EXPECT(gbc.b(),  0x89);
        EXPECT(gbc.c(),  0x8e);
        EXPECT(gbc.d(),  0x44);
        EXPECT(gbc.e(),  0x3f);
        EXPECT(gbc.h(),  0xdc);
        EXPECT(gbc.l(),  0x15);
        EXPECT(gbc.sp(), 0x4519);
        EXPECT(gbc.pc(), 0x9f31);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9f2f), 0xcb);
        EXPECT(gbc.readMem(0x9f30), 0x4);
        // CB 04 0161
        gbc.setState(0xe954, 0xa979, 0xd270, 0x555a, 0xfd6b, 0x30ad, 0x1, 0x1);
        gbc.writeMem(0xe954, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd2);
        EXPECT(gbc.b(),  0x55);
        EXPECT(gbc.c(),  0x5a);
        EXPECT(gbc.d(),  0xfd);
        EXPECT(gbc.e(),  0x6b);
        EXPECT(gbc.h(),  0x60);
        EXPECT(gbc.l(),  0xad);
        EXPECT(gbc.sp(), 0xa979);
        EXPECT(gbc.pc(), 0xe956);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe954), 0xcb);
        EXPECT(gbc.readMem(0xe955), 0x4);
        // CB 04 0162
        gbc.setState(0xe501, 0xbce7, 0x3e0, 0x2b1e, 0xe737, 0x2c00, 0x1, 0x0);
        gbc.writeMem(0xe501, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3);
        EXPECT(gbc.b(),  0x2b);
        EXPECT(gbc.c(),  0x1e);
        EXPECT(gbc.d(),  0xe7);
        EXPECT(gbc.e(),  0x37);
        EXPECT(gbc.h(),  0x58);
        EXPECT(gbc.l(),  0x0);
        EXPECT(gbc.sp(), 0xbce7);
        EXPECT(gbc.pc(), 0xe503);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe501), 0xcb);
        EXPECT(gbc.readMem(0xe502), 0x4);
        // CB 04 0163
        gbc.setState(0x89f9, 0x5910, 0xe930, 0xe4f2, 0x74ee, 0xd469, 0x1, 0x0);
        gbc.writeMem(0x89f9, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe9);
        EXPECT(gbc.b(),  0xe4);
        EXPECT(gbc.c(),  0xf2);
        EXPECT(gbc.d(),  0x74);
        EXPECT(gbc.e(),  0xee);
        EXPECT(gbc.h(),  0xa9);
        EXPECT(gbc.l(),  0x69);
        EXPECT(gbc.sp(), 0x5910);
        EXPECT(gbc.pc(), 0x89fb);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x89f9), 0xcb);
        EXPECT(gbc.readMem(0x89fa), 0x4);
        // CB 04 0164
        gbc.setState(0xc044, 0xa2fd, 0xb210, 0x74f, 0xc177, 0xdb1c, 0x1, 0x0);
        gbc.writeMem(0xc044, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb2);
        EXPECT(gbc.b(),  0x7);
        EXPECT(gbc.c(),  0x4f);
        EXPECT(gbc.d(),  0xc1);
        EXPECT(gbc.e(),  0x77);
        EXPECT(gbc.h(),  0xb7);
        EXPECT(gbc.l(),  0x1c);
        EXPECT(gbc.sp(), 0xa2fd);
        EXPECT(gbc.pc(), 0xc046);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc044), 0xcb);
        EXPECT(gbc.readMem(0xc045), 0x4);
        // CB 04 0165
        gbc.setState(0x21ea, 0x7345, 0xa0d0, 0x6391, 0x4ca0, 0xea25, 0x0, 0x0);
        gbc.writeMem(0x21ea, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa0);
        EXPECT(gbc.b(),  0x63);
        EXPECT(gbc.c(),  0x91);
        EXPECT(gbc.d(),  0x4c);
        EXPECT(gbc.e(),  0xa0);
        EXPECT(gbc.h(),  0xd5);
        EXPECT(gbc.l(),  0x25);
        EXPECT(gbc.sp(), 0x7345);
        EXPECT(gbc.pc(), 0x21ec);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0166
        gbc.setState(0x80db, 0x830e, 0x93e0, 0x2542, 0xaf40, 0x2072, 0x1, 0x1);
        gbc.writeMem(0x80db, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x93);
        EXPECT(gbc.b(),  0x25);
        EXPECT(gbc.c(),  0x42);
        EXPECT(gbc.d(),  0xaf);
        EXPECT(gbc.e(),  0x40);
        EXPECT(gbc.h(),  0x40);
        EXPECT(gbc.l(),  0x72);
        EXPECT(gbc.sp(), 0x830e);
        EXPECT(gbc.pc(), 0x80dd);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x80db), 0xcb);
        EXPECT(gbc.readMem(0x80dc), 0x4);
        // CB 04 0167
        gbc.setState(0x7f89, 0xfda4, 0x2ea0, 0xee03, 0x4e25, 0xd611, 0x1, 0x0);
        gbc.writeMem(0x7f89, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2e);
        EXPECT(gbc.b(),  0xee);
        EXPECT(gbc.c(),  0x3);
        EXPECT(gbc.d(),  0x4e);
        EXPECT(gbc.e(),  0x25);
        EXPECT(gbc.h(),  0xad);
        EXPECT(gbc.l(),  0x11);
        EXPECT(gbc.sp(), 0xfda4);
        EXPECT(gbc.pc(), 0x7f8b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0168
        gbc.setState(0x2036, 0xb7c8, 0x6cc0, 0xd5fd, 0x1662, 0x7787, 0x1, 0x1);
        gbc.writeMem(0x2036, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x6c);
        EXPECT(gbc.b(),  0xd5);
        EXPECT(gbc.c(),  0xfd);
        EXPECT(gbc.d(),  0x16);
        EXPECT(gbc.e(),  0x62);
        EXPECT(gbc.h(),  0xee);
        EXPECT(gbc.l(),  0x87);
        EXPECT(gbc.sp(), 0xb7c8);
        EXPECT(gbc.pc(), 0x2038);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0169
        gbc.setState(0x802, 0x7390, 0x2630, 0x2212, 0x666f, 0x135f, 0x0, 0x1);
        gbc.writeMem(0x802, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x26);
        EXPECT(gbc.b(),  0x22);
        EXPECT(gbc.c(),  0x12);
        EXPECT(gbc.d(),  0x66);
        EXPECT(gbc.e(),  0x6f);
        EXPECT(gbc.h(),  0x26);
        EXPECT(gbc.l(),  0x5f);
        EXPECT(gbc.sp(), 0x7390);
        EXPECT(gbc.pc(), 0x804);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 016A
        gbc.setState(0x1249, 0x5239, 0xffb0, 0x1c65, 0x80da, 0x474c, 0x0, 0x0);
        gbc.writeMem(0x1249, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xff);
        EXPECT(gbc.b(),  0x1c);
        EXPECT(gbc.c(),  0x65);
        EXPECT(gbc.d(),  0x80);
        EXPECT(gbc.e(),  0xda);
        EXPECT(gbc.h(),  0x8e);
        EXPECT(gbc.l(),  0x4c);
        EXPECT(gbc.sp(), 0x5239);
        EXPECT(gbc.pc(), 0x124b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 016B
        gbc.setState(0x4408, 0xeb06, 0x69d0, 0xe6ec, 0x671, 0x2572, 0x1, 0x0);
        gbc.writeMem(0x4408, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x69);
        EXPECT(gbc.b(),  0xe6);
        EXPECT(gbc.c(),  0xec);
        EXPECT(gbc.d(),  0x6);
        EXPECT(gbc.e(),  0x71);
        EXPECT(gbc.h(),  0x4a);
        EXPECT(gbc.l(),  0x72);
        EXPECT(gbc.sp(), 0xeb06);
        EXPECT(gbc.pc(), 0x440a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 016C
        gbc.setState(0x1861, 0x15e9, 0xf8a0, 0x21b6, 0x8b63, 0xd9a1, 0x1, 0x0);
        gbc.writeMem(0x1861, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf8);
        EXPECT(gbc.b(),  0x21);
        EXPECT(gbc.c(),  0xb6);
        EXPECT(gbc.d(),  0x8b);
        EXPECT(gbc.e(),  0x63);
        EXPECT(gbc.h(),  0xb3);
        EXPECT(gbc.l(),  0xa1);
        EXPECT(gbc.sp(), 0x15e9);
        EXPECT(gbc.pc(), 0x1863);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 016D
        gbc.setState(0x3253, 0x480f, 0xb260, 0xa1d4, 0x40be, 0xf319, 0x1, 0x1);
        gbc.writeMem(0x3253, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb2);
        EXPECT(gbc.b(),  0xa1);
        EXPECT(gbc.c(),  0xd4);
        EXPECT(gbc.d(),  0x40);
        EXPECT(gbc.e(),  0xbe);
        EXPECT(gbc.h(),  0xe7);
        EXPECT(gbc.l(),  0x19);
        EXPECT(gbc.sp(), 0x480f);
        EXPECT(gbc.pc(), 0x3255);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 016E
        gbc.setState(0x79aa, 0x41bb, 0x8200, 0xed89, 0x73a8, 0xc5b4, 0x1, 0x1);
        gbc.writeMem(0x79aa, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x82);
        EXPECT(gbc.b(),  0xed);
        EXPECT(gbc.c(),  0x89);
        EXPECT(gbc.d(),  0x73);
        EXPECT(gbc.e(),  0xa8);
        EXPECT(gbc.h(),  0x8b);
        EXPECT(gbc.l(),  0xb4);
        EXPECT(gbc.sp(), 0x41bb);
        EXPECT(gbc.pc(), 0x79ac);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 016F
        gbc.setState(0x5ea5, 0x4327, 0x2da0, 0x3604, 0x204e, 0x6aea, 0x1, 0x0);
        gbc.writeMem(0x5ea5, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2d);
        EXPECT(gbc.b(),  0x36);
        EXPECT(gbc.c(),  0x4);
        EXPECT(gbc.d(),  0x20);
        EXPECT(gbc.e(),  0x4e);
        EXPECT(gbc.h(),  0xd4);
        EXPECT(gbc.l(),  0xea);
        EXPECT(gbc.sp(), 0x4327);
        EXPECT(gbc.pc(), 0x5ea7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0170
        gbc.setState(0xe867, 0x2ee6, 0xd400, 0xa696, 0xa50b, 0x3abd, 0x0, 0x0);
        gbc.writeMem(0xe867, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd4);
        EXPECT(gbc.b(),  0xa6);
        EXPECT(gbc.c(),  0x96);
        EXPECT(gbc.d(),  0xa5);
        EXPECT(gbc.e(),  0xb);
        EXPECT(gbc.h(),  0x74);
        EXPECT(gbc.l(),  0xbd);
        EXPECT(gbc.sp(), 0x2ee6);
        EXPECT(gbc.pc(), 0xe869);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe867), 0xcb);
        EXPECT(gbc.readMem(0xe868), 0x4);
        // CB 04 0171
        gbc.setState(0x6ab2, 0xcc5c, 0xb1a0, 0x39fd, 0x825d, 0xf7fd, 0x1, 0x1);
        gbc.writeMem(0x6ab2, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb1);
        EXPECT(gbc.b(),  0x39);
        EXPECT(gbc.c(),  0xfd);
        EXPECT(gbc.d(),  0x82);
        EXPECT(gbc.e(),  0x5d);
        EXPECT(gbc.h(),  0xef);
        EXPECT(gbc.l(),  0xfd);
        EXPECT(gbc.sp(), 0xcc5c);
        EXPECT(gbc.pc(), 0x6ab4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0172
        gbc.setState(0xd864, 0x3a4, 0xa460, 0x1fc8, 0x6bd2, 0x76d9, 0x1, 0x0);
        gbc.writeMem(0xd864, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa4);
        EXPECT(gbc.b(),  0x1f);
        EXPECT(gbc.c(),  0xc8);
        EXPECT(gbc.d(),  0x6b);
        EXPECT(gbc.e(),  0xd2);
        EXPECT(gbc.h(),  0xec);
        EXPECT(gbc.l(),  0xd9);
        EXPECT(gbc.sp(), 0x3a4);
        EXPECT(gbc.pc(), 0xd866);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd864), 0xcb);
        EXPECT(gbc.readMem(0xd865), 0x4);
        // CB 04 0173
        gbc.setState(0x98ba, 0x4462, 0xc490, 0xd3c0, 0x783f, 0xba6b, 0x0, 0x1);
        gbc.writeMem(0x98ba, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc4);
        EXPECT(gbc.b(),  0xd3);
        EXPECT(gbc.c(),  0xc0);
        EXPECT(gbc.d(),  0x78);
        EXPECT(gbc.e(),  0x3f);
        EXPECT(gbc.h(),  0x75);
        EXPECT(gbc.l(),  0x6b);
        EXPECT(gbc.sp(), 0x4462);
        EXPECT(gbc.pc(), 0x98bc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x98ba), 0xcb);
        EXPECT(gbc.readMem(0x98bb), 0x4);
        // CB 04 0174
        gbc.setState(0x974, 0xd980, 0xf600, 0x5a0e, 0xf25f, 0x202f, 0x0, 0x1);
        gbc.writeMem(0x974, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf6);
        EXPECT(gbc.b(),  0x5a);
        EXPECT(gbc.c(),  0xe);
        EXPECT(gbc.d(),  0xf2);
        EXPECT(gbc.e(),  0x5f);
        EXPECT(gbc.h(),  0x40);
        EXPECT(gbc.l(),  0x2f);
        EXPECT(gbc.sp(), 0xd980);
        EXPECT(gbc.pc(), 0x976);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0175
        gbc.setState(0x64f9, 0x54d4, 0xcc20, 0x7187, 0x4df4, 0x5899, 0x0, 0x0);
        gbc.writeMem(0x64f9, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xcc);
        EXPECT(gbc.b(),  0x71);
        EXPECT(gbc.c(),  0x87);
        EXPECT(gbc.d(),  0x4d);
        EXPECT(gbc.e(),  0xf4);
        EXPECT(gbc.h(),  0xb0);
        EXPECT(gbc.l(),  0x99);
        EXPECT(gbc.sp(), 0x54d4);
        EXPECT(gbc.pc(), 0x64fb);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0176
        gbc.setState(0x3678, 0x6f0a, 0xe070, 0xfa61, 0x4fa4, 0x391a, 0x1, 0x0);
        gbc.writeMem(0x3678, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe0);
        EXPECT(gbc.b(),  0xfa);
        EXPECT(gbc.c(),  0x61);
        EXPECT(gbc.d(),  0x4f);
        EXPECT(gbc.e(),  0xa4);
        EXPECT(gbc.h(),  0x72);
        EXPECT(gbc.l(),  0x1a);
        EXPECT(gbc.sp(), 0x6f0a);
        EXPECT(gbc.pc(), 0x367a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0177
        gbc.setState(0x885, 0xf3d6, 0xfd10, 0x1bef, 0x3ca2, 0x8009, 0x1, 0x0);
        gbc.writeMem(0x885, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xfd);
        EXPECT(gbc.b(),  0x1b);
        EXPECT(gbc.c(),  0xef);
        EXPECT(gbc.d(),  0x3c);
        EXPECT(gbc.e(),  0xa2);
        EXPECT(gbc.h(),  0x1);
        EXPECT(gbc.l(),  0x9);
        EXPECT(gbc.sp(), 0xf3d6);
        EXPECT(gbc.pc(), 0x887);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0178
        gbc.setState(0xdb2c, 0xda13, 0xc740, 0x7459, 0x1477, 0xa53a, 0x1, 0x0);
        gbc.writeMem(0xdb2c, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc7);
        EXPECT(gbc.b(),  0x74);
        EXPECT(gbc.c(),  0x59);
        EXPECT(gbc.d(),  0x14);
        EXPECT(gbc.e(),  0x77);
        EXPECT(gbc.h(),  0x4b);
        EXPECT(gbc.l(),  0x3a);
        EXPECT(gbc.sp(), 0xda13);
        EXPECT(gbc.pc(), 0xdb2e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xdb2c), 0xcb);
        EXPECT(gbc.readMem(0xdb2d), 0x4);
        // CB 04 0179
        gbc.setState(0x89a7, 0xef4d, 0x1ef0, 0x42d5, 0x524e, 0x4cfc, 0x1, 0x0);
        gbc.writeMem(0x89a7, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1e);
        EXPECT(gbc.b(),  0x42);
        EXPECT(gbc.c(),  0xd5);
        EXPECT(gbc.d(),  0x52);
        EXPECT(gbc.e(),  0x4e);
        EXPECT(gbc.h(),  0x98);
        EXPECT(gbc.l(),  0xfc);
        EXPECT(gbc.sp(), 0xef4d);
        EXPECT(gbc.pc(), 0x89a9);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x89a7), 0xcb);
        EXPECT(gbc.readMem(0x89a8), 0x4);
        // CB 04 017A
        gbc.setState(0x940f, 0xb34, 0xb190, 0xfaf0, 0x151b, 0xa90d, 0x1, 0x1);
        gbc.writeMem(0x940f, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb1);
        EXPECT(gbc.b(),  0xfa);
        EXPECT(gbc.c(),  0xf0);
        EXPECT(gbc.d(),  0x15);
        EXPECT(gbc.e(),  0x1b);
        EXPECT(gbc.h(),  0x53);
        EXPECT(gbc.l(),  0xd);
        EXPECT(gbc.sp(), 0xb34);
        EXPECT(gbc.pc(), 0x9411);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x940f), 0xcb);
        EXPECT(gbc.readMem(0x9410), 0x4);
        // CB 04 017B
        gbc.setState(0x9ff2, 0xecdf, 0xaf00, 0xd925, 0x7f87, 0x4c23, 0x1, 0x0);
        gbc.writeMem(0x9ff2, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xaf);
        EXPECT(gbc.b(),  0xd9);
        EXPECT(gbc.c(),  0x25);
        EXPECT(gbc.d(),  0x7f);
        EXPECT(gbc.e(),  0x87);
        EXPECT(gbc.h(),  0x98);
        EXPECT(gbc.l(),  0x23);
        EXPECT(gbc.sp(), 0xecdf);
        EXPECT(gbc.pc(), 0x9ff4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9ff2), 0xcb);
        EXPECT(gbc.readMem(0x9ff3), 0x4);
        // CB 04 017C
        gbc.setState(0x833b, 0x533d, 0x45d0, 0xb6ff, 0x92b6, 0x8c9d, 0x1, 0x0);
        gbc.writeMem(0x833b, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x45);
        EXPECT(gbc.b(),  0xb6);
        EXPECT(gbc.c(),  0xff);
        EXPECT(gbc.d(),  0x92);
        EXPECT(gbc.e(),  0xb6);
        EXPECT(gbc.h(),  0x19);
        EXPECT(gbc.l(),  0x9d);
        EXPECT(gbc.sp(), 0x533d);
        EXPECT(gbc.pc(), 0x833d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x833b), 0xcb);
        EXPECT(gbc.readMem(0x833c), 0x4);
        // CB 04 017D
        gbc.setState(0x4d43, 0x7f79, 0x20c0, 0x2cba, 0xaf61, 0x8845, 0x1, 0x1);
        gbc.writeMem(0x4d43, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0x2c);
        EXPECT(gbc.c(),  0xba);
        EXPECT(gbc.d(),  0xaf);
        EXPECT(gbc.e(),  0x61);
        EXPECT(gbc.h(),  0x11);
        EXPECT(gbc.l(),  0x45);
        EXPECT(gbc.sp(), 0x7f79);
        EXPECT(gbc.pc(), 0x4d45);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 017E
        gbc.setState(0x4cc3, 0xede3, 0xfc00, 0xb611, 0x9097, 0xf97a, 0x0, 0x0);
        gbc.writeMem(0x4cc3, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xfc);
        EXPECT(gbc.b(),  0xb6);
        EXPECT(gbc.c(),  0x11);
        EXPECT(gbc.d(),  0x90);
        EXPECT(gbc.e(),  0x97);
        EXPECT(gbc.h(),  0xf3);
        EXPECT(gbc.l(),  0x7a);
        EXPECT(gbc.sp(), 0xede3);
        EXPECT(gbc.pc(), 0x4cc5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 017F
        gbc.setState(0x4672, 0x649, 0xd6e0, 0x84e7, 0xf5c, 0x7552, 0x1, 0x0);
        gbc.writeMem(0x4672, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd6);
        EXPECT(gbc.b(),  0x84);
        EXPECT(gbc.c(),  0xe7);
        EXPECT(gbc.d(),  0xf);
        EXPECT(gbc.e(),  0x5c);
        EXPECT(gbc.h(),  0xea);
        EXPECT(gbc.l(),  0x52);
        EXPECT(gbc.sp(), 0x649);
        EXPECT(gbc.pc(), 0x4674);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0180
        gbc.setState(0x87a3, 0x330e, 0xbe00, 0x8bb1, 0x5138, 0x683, 0x1, 0x1);
        gbc.writeMem(0x87a3, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xbe);
        EXPECT(gbc.b(),  0x8b);
        EXPECT(gbc.c(),  0xb1);
        EXPECT(gbc.d(),  0x51);
        EXPECT(gbc.e(),  0x38);
        EXPECT(gbc.h(),  0xc);
        EXPECT(gbc.l(),  0x83);
        EXPECT(gbc.sp(), 0x330e);
        EXPECT(gbc.pc(), 0x87a5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x87a3), 0xcb);
        EXPECT(gbc.readMem(0x87a4), 0x4);
        // CB 04 0181
        gbc.setState(0x67d2, 0x352, 0x2a0, 0xbb15, 0x53f5, 0x6b35, 0x0, 0x0);
        gbc.writeMem(0x67d2, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0xbb);
        EXPECT(gbc.c(),  0x15);
        EXPECT(gbc.d(),  0x53);
        EXPECT(gbc.e(),  0xf5);
        EXPECT(gbc.h(),  0xd6);
        EXPECT(gbc.l(),  0x35);
        EXPECT(gbc.sp(), 0x352);
        EXPECT(gbc.pc(), 0x67d4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0182
        gbc.setState(0x32ca, 0x6ee1, 0x1550, 0x7b0e, 0xfa65, 0xfd21, 0x1, 0x1);
        gbc.writeMem(0x32ca, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x15);
        EXPECT(gbc.b(),  0x7b);
        EXPECT(gbc.c(),  0xe);
        EXPECT(gbc.d(),  0xfa);
        EXPECT(gbc.e(),  0x65);
        EXPECT(gbc.h(),  0xfb);
        EXPECT(gbc.l(),  0x21);
        EXPECT(gbc.sp(), 0x6ee1);
        EXPECT(gbc.pc(), 0x32cc);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0183
        gbc.setState(0x4838, 0x31e1, 0x26d0, 0x829f, 0x69b7, 0xfe7a, 0x0, 0x0);
        gbc.writeMem(0x4838, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x26);
        EXPECT(gbc.b(),  0x82);
        EXPECT(gbc.c(),  0x9f);
        EXPECT(gbc.d(),  0x69);
        EXPECT(gbc.e(),  0xb7);
        EXPECT(gbc.h(),  0xfd);
        EXPECT(gbc.l(),  0x7a);
        EXPECT(gbc.sp(), 0x31e1);
        EXPECT(gbc.pc(), 0x483a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0184
        gbc.setState(0xaa26, 0xd2c7, 0x34d0, 0x3bd9, 0x2845, 0x8134, 0x0, 0x1);
        gbc.writeMem(0xaa26, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x34);
        EXPECT(gbc.b(),  0x3b);
        EXPECT(gbc.c(),  0xd9);
        EXPECT(gbc.d(),  0x28);
        EXPECT(gbc.e(),  0x45);
        EXPECT(gbc.h(),  0x3);
        EXPECT(gbc.l(),  0x34);
        EXPECT(gbc.sp(), 0xd2c7);
        EXPECT(gbc.pc(), 0xaa28);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xaa26), 0xcb);
        EXPECT(gbc.readMem(0xaa27), 0x4);
        // CB 04 0185
        gbc.setState(0xb7c0, 0xbf79, 0x5c50, 0xaca2, 0x9ff2, 0x8131, 0x1, 0x1);
        gbc.writeMem(0xb7c0, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x5c);
        EXPECT(gbc.b(),  0xac);
        EXPECT(gbc.c(),  0xa2);
        EXPECT(gbc.d(),  0x9f);
        EXPECT(gbc.e(),  0xf2);
        EXPECT(gbc.h(),  0x3);
        EXPECT(gbc.l(),  0x31);
        EXPECT(gbc.sp(), 0xbf79);
        EXPECT(gbc.pc(), 0xb7c2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb7c0), 0xcb);
        EXPECT(gbc.readMem(0xb7c1), 0x4);
        // CB 04 0186
        gbc.setState(0x8276, 0xf0ed, 0x8e30, 0xa29a, 0x6624, 0xea02, 0x0, 0x0);
        gbc.writeMem(0x8276, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8e);
        EXPECT(gbc.b(),  0xa2);
        EXPECT(gbc.c(),  0x9a);
        EXPECT(gbc.d(),  0x66);
        EXPECT(gbc.e(),  0x24);
        EXPECT(gbc.h(),  0xd5);
        EXPECT(gbc.l(),  0x2);
        EXPECT(gbc.sp(), 0xf0ed);
        EXPECT(gbc.pc(), 0x8278);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8276), 0xcb);
        EXPECT(gbc.readMem(0x8277), 0x4);
        // CB 04 0187
        gbc.setState(0x82d8, 0xf4c9, 0xe020, 0xe925, 0xa830, 0x44c0, 0x0, 0x1);
        gbc.writeMem(0x82d8, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe0);
        EXPECT(gbc.b(),  0xe9);
        EXPECT(gbc.c(),  0x25);
        EXPECT(gbc.d(),  0xa8);
        EXPECT(gbc.e(),  0x30);
        EXPECT(gbc.h(),  0x88);
        EXPECT(gbc.l(),  0xc0);
        EXPECT(gbc.sp(), 0xf4c9);
        EXPECT(gbc.pc(), 0x82da);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x82d8), 0xcb);
        EXPECT(gbc.readMem(0x82d9), 0x4);
        // CB 04 0189
        gbc.setState(0x6733, 0x2120, 0x2c30, 0xb9f8, 0x756c, 0xbe2b, 0x0, 0x0);
        gbc.writeMem(0x6733, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2c);
        EXPECT(gbc.b(),  0xb9);
        EXPECT(gbc.c(),  0xf8);
        EXPECT(gbc.d(),  0x75);
        EXPECT(gbc.e(),  0x6c);
        EXPECT(gbc.h(),  0x7d);
        EXPECT(gbc.l(),  0x2b);
        EXPECT(gbc.sp(), 0x2120);
        EXPECT(gbc.pc(), 0x6735);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 018A
        gbc.setState(0x260, 0x7b3f, 0x8920, 0xfd66, 0x7d07, 0x53e0, 0x1, 0x0);
        gbc.writeMem(0x260, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x89);
        EXPECT(gbc.b(),  0xfd);
        EXPECT(gbc.c(),  0x66);
        EXPECT(gbc.d(),  0x7d);
        EXPECT(gbc.e(),  0x7);
        EXPECT(gbc.h(),  0xa6);
        EXPECT(gbc.l(),  0xe0);
        EXPECT(gbc.sp(), 0x7b3f);
        EXPECT(gbc.pc(), 0x262);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 018B
        gbc.setState(0xc1f4, 0x6414, 0xbfb0, 0xae59, 0x7f04, 0xfaa1, 0x0, 0x0);
        gbc.writeMem(0xc1f4, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xbf);
        EXPECT(gbc.b(),  0xae);
        EXPECT(gbc.c(),  0x59);
        EXPECT(gbc.d(),  0x7f);
        EXPECT(gbc.e(),  0x4);
        EXPECT(gbc.h(),  0xf5);
        EXPECT(gbc.l(),  0xa1);
        EXPECT(gbc.sp(), 0x6414);
        EXPECT(gbc.pc(), 0xc1f6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc1f4), 0xcb);
        EXPECT(gbc.readMem(0xc1f5), 0x4);
        // CB 04 018C
        gbc.setState(0xdb26, 0xb0e8, 0x1010, 0x35d8, 0xa8a9, 0xbab5, 0x1, 0x0);
        gbc.writeMem(0xdb26, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0x35);
        EXPECT(gbc.c(),  0xd8);
        EXPECT(gbc.d(),  0xa8);
        EXPECT(gbc.e(),  0xa9);
        EXPECT(gbc.h(),  0x75);
        EXPECT(gbc.l(),  0xb5);
        EXPECT(gbc.sp(), 0xb0e8);
        EXPECT(gbc.pc(), 0xdb28);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xdb26), 0xcb);
        EXPECT(gbc.readMem(0xdb27), 0x4);
        // CB 04 018D
        gbc.setState(0x7f32, 0x8b5c, 0x7220, 0x34da, 0xb49a, 0x5235, 0x1, 0x1);
        gbc.writeMem(0x7f32, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x72);
        EXPECT(gbc.b(),  0x34);
        EXPECT(gbc.c(),  0xda);
        EXPECT(gbc.d(),  0xb4);
        EXPECT(gbc.e(),  0x9a);
        EXPECT(gbc.h(),  0xa4);
        EXPECT(gbc.l(),  0x35);
        EXPECT(gbc.sp(), 0x8b5c);
        EXPECT(gbc.pc(), 0x7f34);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 018E
        gbc.setState(0x5626, 0xb2c, 0xcd50, 0xb7c2, 0x521e, 0xcda1, 0x0, 0x1);
        gbc.writeMem(0x5626, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xcd);
        EXPECT(gbc.b(),  0xb7);
        EXPECT(gbc.c(),  0xc2);
        EXPECT(gbc.d(),  0x52);
        EXPECT(gbc.e(),  0x1e);
        EXPECT(gbc.h(),  0x9b);
        EXPECT(gbc.l(),  0xa1);
        EXPECT(gbc.sp(), 0xb2c);
        EXPECT(gbc.pc(), 0x5628);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 018F
        gbc.setState(0xee42, 0xa552, 0xeba0, 0xff6, 0xb4d, 0x46ef, 0x1, 0x0);
        gbc.writeMem(0xee42, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xeb);
        EXPECT(gbc.b(),  0xf);
        EXPECT(gbc.c(),  0xf6);
        EXPECT(gbc.d(),  0xb);
        EXPECT(gbc.e(),  0x4d);
        EXPECT(gbc.h(),  0x8c);
        EXPECT(gbc.l(),  0xef);
        EXPECT(gbc.sp(), 0xa552);
        EXPECT(gbc.pc(), 0xee44);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xee42), 0xcb);
        EXPECT(gbc.readMem(0xee43), 0x4);
        // CB 04 0190
        gbc.setState(0xdad1, 0x7126, 0x6590, 0x5387, 0x4f11, 0x5130, 0x1, 0x1);
        gbc.writeMem(0xdad1, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x65);
        EXPECT(gbc.b(),  0x53);
        EXPECT(gbc.c(),  0x87);
        EXPECT(gbc.d(),  0x4f);
        EXPECT(gbc.e(),  0x11);
        EXPECT(gbc.h(),  0xa2);
        EXPECT(gbc.l(),  0x30);
        EXPECT(gbc.sp(), 0x7126);
        EXPECT(gbc.pc(), 0xdad3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdad1), 0xcb);
        EXPECT(gbc.readMem(0xdad2), 0x4);
        // CB 04 0191
        gbc.setState(0xcd8f, 0x59cb, 0x5eb0, 0xafcd, 0x6fe9, 0xb476, 0x0, 0x0);
        gbc.writeMem(0xcd8f, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x5e);
        EXPECT(gbc.b(),  0xaf);
        EXPECT(gbc.c(),  0xcd);
        EXPECT(gbc.d(),  0x6f);
        EXPECT(gbc.e(),  0xe9);
        EXPECT(gbc.h(),  0x69);
        EXPECT(gbc.l(),  0x76);
        EXPECT(gbc.sp(), 0x59cb);
        EXPECT(gbc.pc(), 0xcd91);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcd8f), 0xcb);
        EXPECT(gbc.readMem(0xcd90), 0x4);
        // CB 04 0192
        gbc.setState(0xd268, 0xcac1, 0xd050, 0x7fed, 0x72bf, 0x8693, 0x1, 0x0);
        gbc.writeMem(0xd268, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd0);
        EXPECT(gbc.b(),  0x7f);
        EXPECT(gbc.c(),  0xed);
        EXPECT(gbc.d(),  0x72);
        EXPECT(gbc.e(),  0xbf);
        EXPECT(gbc.h(),  0xd);
        EXPECT(gbc.l(),  0x93);
        EXPECT(gbc.sp(), 0xcac1);
        EXPECT(gbc.pc(), 0xd26a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd268), 0xcb);
        EXPECT(gbc.readMem(0xd269), 0x4);
        // CB 04 0193
        gbc.setState(0x56b, 0xcef4, 0xb70, 0xcaa4, 0xe9f8, 0x56ab, 0x1, 0x0);
        gbc.writeMem(0x56b, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb);
        EXPECT(gbc.b(),  0xca);
        EXPECT(gbc.c(),  0xa4);
        EXPECT(gbc.d(),  0xe9);
        EXPECT(gbc.e(),  0xf8);
        EXPECT(gbc.h(),  0xac);
        EXPECT(gbc.l(),  0xab);
        EXPECT(gbc.sp(), 0xcef4);
        EXPECT(gbc.pc(), 0x56d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0194
        gbc.setState(0x52d5, 0x984, 0x7d10, 0x492f, 0xf3e0, 0xc011, 0x1, 0x0);
        gbc.writeMem(0x52d5, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x7d);
        EXPECT(gbc.b(),  0x49);
        EXPECT(gbc.c(),  0x2f);
        EXPECT(gbc.d(),  0xf3);
        EXPECT(gbc.e(),  0xe0);
        EXPECT(gbc.h(),  0x81);
        EXPECT(gbc.l(),  0x11);
        EXPECT(gbc.sp(), 0x984);
        EXPECT(gbc.pc(), 0x52d7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0195
        gbc.setState(0x3aff, 0x927b, 0xc250, 0xd6ec, 0x8e8d, 0x6137, 0x1, 0x1);
        gbc.writeMem(0x3aff, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc2);
        EXPECT(gbc.b(),  0xd6);
        EXPECT(gbc.c(),  0xec);
        EXPECT(gbc.d(),  0x8e);
        EXPECT(gbc.e(),  0x8d);
        EXPECT(gbc.h(),  0xc2);
        EXPECT(gbc.l(),  0x37);
        EXPECT(gbc.sp(), 0x927b);
        EXPECT(gbc.pc(), 0x3b01);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0196
        gbc.setState(0x793e, 0xa6f6, 0xc720, 0x4ca8, 0xd750, 0x4d73, 0x1, 0x1);
        gbc.writeMem(0x793e, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc7);
        EXPECT(gbc.b(),  0x4c);
        EXPECT(gbc.c(),  0xa8);
        EXPECT(gbc.d(),  0xd7);
        EXPECT(gbc.e(),  0x50);
        EXPECT(gbc.h(),  0x9a);
        EXPECT(gbc.l(),  0x73);
        EXPECT(gbc.sp(), 0xa6f6);
        EXPECT(gbc.pc(), 0x7940);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0197
        gbc.setState(0x5b7d, 0x8319, 0x2210, 0xc6d9, 0x3fe, 0xce06, 0x1, 0x0);
        gbc.writeMem(0x5b7d, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x22);
        EXPECT(gbc.b(),  0xc6);
        EXPECT(gbc.c(),  0xd9);
        EXPECT(gbc.d(),  0x3);
        EXPECT(gbc.e(),  0xfe);
        EXPECT(gbc.h(),  0x9d);
        EXPECT(gbc.l(),  0x6);
        EXPECT(gbc.sp(), 0x8319);
        EXPECT(gbc.pc(), 0x5b7f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0199
        gbc.setState(0xc3f2, 0x3f5c, 0x2940, 0xbcd2, 0x7272, 0xc92, 0x1, 0x0);
        gbc.writeMem(0xc3f2, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x29);
        EXPECT(gbc.b(),  0xbc);
        EXPECT(gbc.c(),  0xd2);
        EXPECT(gbc.d(),  0x72);
        EXPECT(gbc.e(),  0x72);
        EXPECT(gbc.h(),  0x18);
        EXPECT(gbc.l(),  0x92);
        EXPECT(gbc.sp(), 0x3f5c);
        EXPECT(gbc.pc(), 0xc3f4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc3f2), 0xcb);
        EXPECT(gbc.readMem(0xc3f3), 0x4);
        // CB 04 019A
        gbc.setState(0x2241, 0x5bb5, 0xe70, 0x56b5, 0x4501, 0x15e, 0x1, 0x1);
        gbc.writeMem(0x2241, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe);
        EXPECT(gbc.b(),  0x56);
        EXPECT(gbc.c(),  0xb5);
        EXPECT(gbc.d(),  0x45);
        EXPECT(gbc.e(),  0x1);
        EXPECT(gbc.h(),  0x2);
        EXPECT(gbc.l(),  0x5e);
        EXPECT(gbc.sp(), 0x5bb5);
        EXPECT(gbc.pc(), 0x2243);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 019B
        gbc.setState(0x4afa, 0x443d, 0xafd0, 0xfd8e, 0x713c, 0xb056, 0x0, 0x1);
        gbc.writeMem(0x4afa, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xaf);
        EXPECT(gbc.b(),  0xfd);
        EXPECT(gbc.c(),  0x8e);
        EXPECT(gbc.d(),  0x71);
        EXPECT(gbc.e(),  0x3c);
        EXPECT(gbc.h(),  0x61);
        EXPECT(gbc.l(),  0x56);
        EXPECT(gbc.sp(), 0x443d);
        EXPECT(gbc.pc(), 0x4afc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 019C
        gbc.setState(0xa40f, 0x6d4e, 0xcad0, 0x9319, 0xffc1, 0x5660, 0x0, 0x1);
        gbc.writeMem(0xa40f, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xca);
        EXPECT(gbc.b(),  0x93);
        EXPECT(gbc.c(),  0x19);
        EXPECT(gbc.d(),  0xff);
        EXPECT(gbc.e(),  0xc1);
        EXPECT(gbc.h(),  0xac);
        EXPECT(gbc.l(),  0x60);
        EXPECT(gbc.sp(), 0x6d4e);
        EXPECT(gbc.pc(), 0xa411);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa40f), 0xcb);
        EXPECT(gbc.readMem(0xa410), 0x4);
        // CB 04 019D
        gbc.setState(0xefac, 0x2aef, 0xdff0, 0xed87, 0xaa96, 0x6253, 0x0, 0x0);
        gbc.writeMem(0xefac, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xdf);
        EXPECT(gbc.b(),  0xed);
        EXPECT(gbc.c(),  0x87);
        EXPECT(gbc.d(),  0xaa);
        EXPECT(gbc.e(),  0x96);
        EXPECT(gbc.h(),  0xc4);
        EXPECT(gbc.l(),  0x53);
        EXPECT(gbc.sp(), 0x2aef);
        EXPECT(gbc.pc(), 0xefae);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xefac), 0xcb);
        EXPECT(gbc.readMem(0xefad), 0x4);
        // CB 04 019E
        gbc.setState(0xb584, 0x2e23, 0x35b0, 0x5bed, 0xefbc, 0xc849, 0x1, 0x1);
        gbc.writeMem(0xb584, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x35);
        EXPECT(gbc.b(),  0x5b);
        EXPECT(gbc.c(),  0xed);
        EXPECT(gbc.d(),  0xef);
        EXPECT(gbc.e(),  0xbc);
        EXPECT(gbc.h(),  0x91);
        EXPECT(gbc.l(),  0x49);
        EXPECT(gbc.sp(), 0x2e23);
        EXPECT(gbc.pc(), 0xb586);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb584), 0xcb);
        EXPECT(gbc.readMem(0xb585), 0x4);
        // CB 04 019F
        gbc.setState(0x56f4, 0x456c, 0x6920, 0xeb38, 0xd7c5, 0x3a85, 0x1, 0x1);
        gbc.writeMem(0x56f4, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x69);
        EXPECT(gbc.b(),  0xeb);
        EXPECT(gbc.c(),  0x38);
        EXPECT(gbc.d(),  0xd7);
        EXPECT(gbc.e(),  0xc5);
        EXPECT(gbc.h(),  0x74);
        EXPECT(gbc.l(),  0x85);
        EXPECT(gbc.sp(), 0x456c);
        EXPECT(gbc.pc(), 0x56f6);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 01A0
        gbc.setState(0x670b, 0x8360, 0x430, 0xc1b6, 0x1909, 0x8381, 0x0, 0x0);
        gbc.writeMem(0x670b, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0xc1);
        EXPECT(gbc.c(),  0xb6);
        EXPECT(gbc.d(),  0x19);
        EXPECT(gbc.e(),  0x9);
        EXPECT(gbc.h(),  0x7);
        EXPECT(gbc.l(),  0x81);
        EXPECT(gbc.sp(), 0x8360);
        EXPECT(gbc.pc(), 0x670d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 01A1
        gbc.setState(0x47d3, 0x4546, 0x31b0, 0x4f1b, 0xdf00, 0xdee1, 0x1, 0x0);
        gbc.writeMem(0x47d3, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x31);
        EXPECT(gbc.b(),  0x4f);
        EXPECT(gbc.c(),  0x1b);
        EXPECT(gbc.d(),  0xdf);
        EXPECT(gbc.e(),  0x0);
        EXPECT(gbc.h(),  0xbd);
        EXPECT(gbc.l(),  0xe1);
        EXPECT(gbc.sp(), 0x4546);
        EXPECT(gbc.pc(), 0x47d5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 01A2
        gbc.setState(0xe841, 0x4011, 0xc00, 0x35eb, 0x4a96, 0xcbb1, 0x0, 0x1);
        gbc.writeMem(0xe841, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc);
        EXPECT(gbc.b(),  0x35);
        EXPECT(gbc.c(),  0xeb);
        EXPECT(gbc.d(),  0x4a);
        EXPECT(gbc.e(),  0x96);
        EXPECT(gbc.h(),  0x97);
        EXPECT(gbc.l(),  0xb1);
        EXPECT(gbc.sp(), 0x4011);
        EXPECT(gbc.pc(), 0xe843);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe841), 0xcb);
        EXPECT(gbc.readMem(0xe842), 0x4);
        // CB 04 01A3
        gbc.setState(0x3166, 0xe2d1, 0xd140, 0x824a, 0xedaf, 0xb4f8, 0x0, 0x0);
        gbc.writeMem(0x3166, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd1);
        EXPECT(gbc.b(),  0x82);
        EXPECT(gbc.c(),  0x4a);
        EXPECT(gbc.d(),  0xed);
        EXPECT(gbc.e(),  0xaf);
        EXPECT(gbc.h(),  0x69);
        EXPECT(gbc.l(),  0xf8);
        EXPECT(gbc.sp(), 0xe2d1);
        EXPECT(gbc.pc(), 0x3168);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 01A4
        gbc.setState(0x4d8a, 0xd20, 0x8300, 0x787, 0x6ccc, 0xd051, 0x1, 0x1);
        gbc.writeMem(0x4d8a, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x83);
        EXPECT(gbc.b(),  0x7);
        EXPECT(gbc.c(),  0x87);
        EXPECT(gbc.d(),  0x6c);
        EXPECT(gbc.e(),  0xcc);
        EXPECT(gbc.h(),  0xa1);
        EXPECT(gbc.l(),  0x51);
        EXPECT(gbc.sp(), 0xd20);
        EXPECT(gbc.pc(), 0x4d8c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 01A5
        gbc.setState(0xe87d, 0x122, 0x8d00, 0x9bcb, 0xef95, 0xb123, 0x0, 0x0);
        gbc.writeMem(0xe87d, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8d);
        EXPECT(gbc.b(),  0x9b);
        EXPECT(gbc.c(),  0xcb);
        EXPECT(gbc.d(),  0xef);
        EXPECT(gbc.e(),  0x95);
        EXPECT(gbc.h(),  0x63);
        EXPECT(gbc.l(),  0x23);
        EXPECT(gbc.sp(), 0x122);
        EXPECT(gbc.pc(), 0xe87f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe87d), 0xcb);
        EXPECT(gbc.readMem(0xe87e), 0x4);
        // CB 04 01A6
        gbc.setState(0x856e, 0xa495, 0xb640, 0xc063, 0xc66e, 0x6cb, 0x0, 0x0);
        gbc.writeMem(0x856e, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb6);
        EXPECT(gbc.b(),  0xc0);
        EXPECT(gbc.c(),  0x63);
        EXPECT(gbc.d(),  0xc6);
        EXPECT(gbc.e(),  0x6e);
        EXPECT(gbc.h(),  0xc);
        EXPECT(gbc.l(),  0xcb);
        EXPECT(gbc.sp(), 0xa495);
        EXPECT(gbc.pc(), 0x8570);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x856e), 0xcb);
        EXPECT(gbc.readMem(0x856f), 0x4);
        // CB 04 01A7
        gbc.setState(0xbb39, 0x8328, 0xf5e0, 0xb7d4, 0x7e90, 0x2cfb, 0x1, 0x1);
        gbc.writeMem(0xbb39, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf5);
        EXPECT(gbc.b(),  0xb7);
        EXPECT(gbc.c(),  0xd4);
        EXPECT(gbc.d(),  0x7e);
        EXPECT(gbc.e(),  0x90);
        EXPECT(gbc.h(),  0x58);
        EXPECT(gbc.l(),  0xfb);
        EXPECT(gbc.sp(), 0x8328);
        EXPECT(gbc.pc(), 0xbb3b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbb39), 0xcb);
        EXPECT(gbc.readMem(0xbb3a), 0x4);
        // CB 04 01A8
        gbc.setState(0x6ada, 0x824e, 0xd090, 0xb504, 0x88ba, 0x8573, 0x0, 0x1);
        gbc.writeMem(0x6ada, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd0);
        EXPECT(gbc.b(),  0xb5);
        EXPECT(gbc.c(),  0x4);
        EXPECT(gbc.d(),  0x88);
        EXPECT(gbc.e(),  0xba);
        EXPECT(gbc.h(),  0xb);
        EXPECT(gbc.l(),  0x73);
        EXPECT(gbc.sp(), 0x824e);
        EXPECT(gbc.pc(), 0x6adc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 01A9
        gbc.setState(0x2356, 0x69f9, 0xc7f0, 0xff84, 0x9004, 0x1695, 0x1, 0x1);
        gbc.writeMem(0x2356, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc7);
        EXPECT(gbc.b(),  0xff);
        EXPECT(gbc.c(),  0x84);
        EXPECT(gbc.d(),  0x90);
        EXPECT(gbc.e(),  0x4);
        EXPECT(gbc.h(),  0x2c);
        EXPECT(gbc.l(),  0x95);
        EXPECT(gbc.sp(), 0x69f9);
        EXPECT(gbc.pc(), 0x2358);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 01AA
        gbc.setState(0x7f2f, 0xa56c, 0xfb20, 0x11ab, 0xcaaa, 0xa75f, 0x0, 0x1);
        gbc.writeMem(0x7f2f, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xfb);
        EXPECT(gbc.b(),  0x11);
        EXPECT(gbc.c(),  0xab);
        EXPECT(gbc.d(),  0xca);
        EXPECT(gbc.e(),  0xaa);
        EXPECT(gbc.h(),  0x4f);
        EXPECT(gbc.l(),  0x5f);
        EXPECT(gbc.sp(), 0xa56c);
        EXPECT(gbc.pc(), 0x7f31);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 01AB
        gbc.setState(0x24ce, 0xfe19, 0xf9f0, 0x66db, 0x7226, 0x9a73, 0x1, 0x1);
        gbc.writeMem(0x24ce, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf9);
        EXPECT(gbc.b(),  0x66);
        EXPECT(gbc.c(),  0xdb);
        EXPECT(gbc.d(),  0x72);
        EXPECT(gbc.e(),  0x26);
        EXPECT(gbc.h(),  0x35);
        EXPECT(gbc.l(),  0x73);
        EXPECT(gbc.sp(), 0xfe19);
        EXPECT(gbc.pc(), 0x24d0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 01AC
        gbc.setState(0x2d2c, 0x7391, 0xf740, 0xb5a2, 0xce30, 0x9f53, 0x0, 0x1);
        gbc.writeMem(0x2d2c, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf7);
        EXPECT(gbc.b(),  0xb5);
        EXPECT(gbc.c(),  0xa2);
        EXPECT(gbc.d(),  0xce);
        EXPECT(gbc.e(),  0x30);
        EXPECT(gbc.h(),  0x3f);
        EXPECT(gbc.l(),  0x53);
        EXPECT(gbc.sp(), 0x7391);
        EXPECT(gbc.pc(), 0x2d2e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 01AD
        gbc.setState(0x7117, 0x44f1, 0x3eb0, 0x5d17, 0x8b7c, 0x69ce, 0x1, 0x1);
        gbc.writeMem(0x7117, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3e);
        EXPECT(gbc.b(),  0x5d);
        EXPECT(gbc.c(),  0x17);
        EXPECT(gbc.d(),  0x8b);
        EXPECT(gbc.e(),  0x7c);
        EXPECT(gbc.h(),  0xd2);
        EXPECT(gbc.l(),  0xce);
        EXPECT(gbc.sp(), 0x44f1);
        EXPECT(gbc.pc(), 0x7119);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 01AE
        gbc.setState(0x7f6f, 0xa2a, 0xf90, 0x3389, 0xc61d, 0x2880, 0x1, 0x0);
        gbc.writeMem(0x7f6f, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf);
        EXPECT(gbc.b(),  0x33);
        EXPECT(gbc.c(),  0x89);
        EXPECT(gbc.d(),  0xc6);
        EXPECT(gbc.e(),  0x1d);
        EXPECT(gbc.h(),  0x50);
        EXPECT(gbc.l(),  0x80);
        EXPECT(gbc.sp(), 0xa2a);
        EXPECT(gbc.pc(), 0x7f71);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 01B0
        gbc.setState(0xb3f3, 0x8d8, 0x8ac0, 0x9c1c, 0x5f20, 0x2a12, 0x0, 0x0);
        gbc.writeMem(0xb3f3, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8a);
        EXPECT(gbc.b(),  0x9c);
        EXPECT(gbc.c(),  0x1c);
        EXPECT(gbc.d(),  0x5f);
        EXPECT(gbc.e(),  0x20);
        EXPECT(gbc.h(),  0x54);
        EXPECT(gbc.l(),  0x12);
        EXPECT(gbc.sp(), 0x8d8);
        EXPECT(gbc.pc(), 0xb3f5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb3f3), 0xcb);
        EXPECT(gbc.readMem(0xb3f4), 0x4);
        // CB 04 01B2
        gbc.setState(0x6696, 0x62c3, 0x18c0, 0x742d, 0x1c8d, 0x95d1, 0x0, 0x0);
        gbc.writeMem(0x6696, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x18);
        EXPECT(gbc.b(),  0x74);
        EXPECT(gbc.c(),  0x2d);
        EXPECT(gbc.d(),  0x1c);
        EXPECT(gbc.e(),  0x8d);
        EXPECT(gbc.h(),  0x2b);
        EXPECT(gbc.l(),  0xd1);
        EXPECT(gbc.sp(), 0x62c3);
        EXPECT(gbc.pc(), 0x6698);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 01B3
        gbc.setState(0xdb36, 0x76a2, 0x42f0, 0xe66b, 0x2b53, 0xb6f9, 0x0, 0x1);
        gbc.writeMem(0xdb36, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x42);
        EXPECT(gbc.b(),  0xe6);
        EXPECT(gbc.c(),  0x6b);
        EXPECT(gbc.d(),  0x2b);
        EXPECT(gbc.e(),  0x53);
        EXPECT(gbc.h(),  0x6d);
        EXPECT(gbc.l(),  0xf9);
        EXPECT(gbc.sp(), 0x76a2);
        EXPECT(gbc.pc(), 0xdb38);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xdb36), 0xcb);
        EXPECT(gbc.readMem(0xdb37), 0x4);
        // CB 04 01B4
        gbc.setState(0x81a8, 0xf450, 0x9eb0, 0xe373, 0x78a2, 0x9474, 0x0, 0x0);
        gbc.writeMem(0x81a8, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x9e);
        EXPECT(gbc.b(),  0xe3);
        EXPECT(gbc.c(),  0x73);
        EXPECT(gbc.d(),  0x78);
        EXPECT(gbc.e(),  0xa2);
        EXPECT(gbc.h(),  0x29);
        EXPECT(gbc.l(),  0x74);
        EXPECT(gbc.sp(), 0xf450);
        EXPECT(gbc.pc(), 0x81aa);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x81a8), 0xcb);
        EXPECT(gbc.readMem(0x81a9), 0x4);
        // CB 04 01B5
        gbc.setState(0xce37, 0x95e2, 0x5920, 0x7462, 0xafcb, 0xe734, 0x1, 0x1);
        gbc.writeMem(0xce37, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x59);
        EXPECT(gbc.b(),  0x74);
        EXPECT(gbc.c(),  0x62);
        EXPECT(gbc.d(),  0xaf);
        EXPECT(gbc.e(),  0xcb);
        EXPECT(gbc.h(),  0xcf);
        EXPECT(gbc.l(),  0x34);
        EXPECT(gbc.sp(), 0x95e2);
        EXPECT(gbc.pc(), 0xce39);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xce37), 0xcb);
        EXPECT(gbc.readMem(0xce38), 0x4);
        // CB 04 01B6
        gbc.setState(0x4ff8, 0xe71b, 0x5780, 0x5d5b, 0x5a61, 0x9475, 0x1, 0x0);
        gbc.writeMem(0x4ff8, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x57);
        EXPECT(gbc.b(),  0x5d);
        EXPECT(gbc.c(),  0x5b);
        EXPECT(gbc.d(),  0x5a);
        EXPECT(gbc.e(),  0x61);
        EXPECT(gbc.h(),  0x29);
        EXPECT(gbc.l(),  0x75);
        EXPECT(gbc.sp(), 0xe71b);
        EXPECT(gbc.pc(), 0x4ffa);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 01B7
        gbc.setState(0x284, 0x8efb, 0xc580, 0xea5a, 0xc046, 0x10e4, 0x0, 0x1);
        gbc.writeMem(0x284, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc5);
        EXPECT(gbc.b(),  0xea);
        EXPECT(gbc.c(),  0x5a);
        EXPECT(gbc.d(),  0xc0);
        EXPECT(gbc.e(),  0x46);
        EXPECT(gbc.h(),  0x20);
        EXPECT(gbc.l(),  0xe4);
        EXPECT(gbc.sp(), 0x8efb);
        EXPECT(gbc.pc(), 0x286);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 01B8
        gbc.setState(0x9a63, 0xb06e, 0x11c0, 0xb3d8, 0x93dd, 0xb8aa, 0x1, 0x1);
        gbc.writeMem(0x9a63, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x11);
        EXPECT(gbc.b(),  0xb3);
        EXPECT(gbc.c(),  0xd8);
        EXPECT(gbc.d(),  0x93);
        EXPECT(gbc.e(),  0xdd);
        EXPECT(gbc.h(),  0x71);
        EXPECT(gbc.l(),  0xaa);
        EXPECT(gbc.sp(), 0xb06e);
        EXPECT(gbc.pc(), 0x9a65);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9a63), 0xcb);
        EXPECT(gbc.readMem(0x9a64), 0x4);
        // CB 04 01BA
        gbc.setState(0x1a29, 0xe96, 0xcf40, 0x2cfd, 0x8035, 0x5abc, 0x1, 0x1);
        gbc.writeMem(0x1a29, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xcf);
        EXPECT(gbc.b(),  0x2c);
        EXPECT(gbc.c(),  0xfd);
        EXPECT(gbc.d(),  0x80);
        EXPECT(gbc.e(),  0x35);
        EXPECT(gbc.h(),  0xb4);
        EXPECT(gbc.l(),  0xbc);
        EXPECT(gbc.sp(), 0xe96);
        EXPECT(gbc.pc(), 0x1a2b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 01BB
        gbc.setState(0x2cf8, 0xf4a9, 0xe750, 0xdae4, 0x902, 0xd9a7, 0x0, 0x1);
        gbc.writeMem(0x2cf8, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe7);
        EXPECT(gbc.b(),  0xda);
        EXPECT(gbc.c(),  0xe4);
        EXPECT(gbc.d(),  0x9);
        EXPECT(gbc.e(),  0x2);
        EXPECT(gbc.h(),  0xb3);
        EXPECT(gbc.l(),  0xa7);
        EXPECT(gbc.sp(), 0xf4a9);
        EXPECT(gbc.pc(), 0x2cfa);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 01BC
        gbc.setState(0x97c6, 0xc613, 0xf8a0, 0x8377, 0xa083, 0xb9d6, 0x0, 0x1);
        gbc.writeMem(0x97c6, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf8);
        EXPECT(gbc.b(),  0x83);
        EXPECT(gbc.c(),  0x77);
        EXPECT(gbc.d(),  0xa0);
        EXPECT(gbc.e(),  0x83);
        EXPECT(gbc.h(),  0x73);
        EXPECT(gbc.l(),  0xd6);
        EXPECT(gbc.sp(), 0xc613);
        EXPECT(gbc.pc(), 0x97c8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x97c6), 0xcb);
        EXPECT(gbc.readMem(0x97c7), 0x4);
        // CB 04 01BD
        gbc.setState(0x8525, 0x4a04, 0xdff0, 0x6afe, 0xb27e, 0x17a0, 0x1, 0x1);
        gbc.writeMem(0x8525, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xdf);
        EXPECT(gbc.b(),  0x6a);
        EXPECT(gbc.c(),  0xfe);
        EXPECT(gbc.d(),  0xb2);
        EXPECT(gbc.e(),  0x7e);
        EXPECT(gbc.h(),  0x2e);
        EXPECT(gbc.l(),  0xa0);
        EXPECT(gbc.sp(), 0x4a04);
        EXPECT(gbc.pc(), 0x8527);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8525), 0xcb);
        EXPECT(gbc.readMem(0x8526), 0x4);
        // CB 04 01BE
        gbc.setState(0x7ad9, 0x9a7b, 0xd410, 0x6247, 0x8f3c, 0xf812, 0x0, 0x0);
        gbc.writeMem(0x7ad9, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd4);
        EXPECT(gbc.b(),  0x62);
        EXPECT(gbc.c(),  0x47);
        EXPECT(gbc.d(),  0x8f);
        EXPECT(gbc.e(),  0x3c);
        EXPECT(gbc.h(),  0xf1);
        EXPECT(gbc.l(),  0x12);
        EXPECT(gbc.sp(), 0x9a7b);
        EXPECT(gbc.pc(), 0x7adb);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 01BF
        gbc.setState(0xe690, 0x84cd, 0x8380, 0x85b, 0xbbac, 0x90c2, 0x0, 0x0);
        gbc.writeMem(0xe690, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x83);
        EXPECT(gbc.b(),  0x8);
        EXPECT(gbc.c(),  0x5b);
        EXPECT(gbc.d(),  0xbb);
        EXPECT(gbc.e(),  0xac);
        EXPECT(gbc.h(),  0x21);
        EXPECT(gbc.l(),  0xc2);
        EXPECT(gbc.sp(), 0x84cd);
        EXPECT(gbc.pc(), 0xe692);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe690), 0xcb);
        EXPECT(gbc.readMem(0xe691), 0x4);
        // CB 04 01C0
        gbc.setState(0xc3b6, 0x99c0, 0x9d50, 0x69ba, 0xea2c, 0xf519, 0x1, 0x1);
        gbc.writeMem(0xc3b6, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x9d);
        EXPECT(gbc.b(),  0x69);
        EXPECT(gbc.c(),  0xba);
        EXPECT(gbc.d(),  0xea);
        EXPECT(gbc.e(),  0x2c);
        EXPECT(gbc.h(),  0xeb);
        EXPECT(gbc.l(),  0x19);
        EXPECT(gbc.sp(), 0x99c0);
        EXPECT(gbc.pc(), 0xc3b8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc3b6), 0xcb);
        EXPECT(gbc.readMem(0xc3b7), 0x4);
        // CB 04 01C1
        gbc.setState(0xda7b, 0xc94d, 0x8a00, 0x81e3, 0xf461, 0x9860, 0x1, 0x1);
        gbc.writeMem(0xda7b, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8a);
        EXPECT(gbc.b(),  0x81);
        EXPECT(gbc.c(),  0xe3);
        EXPECT(gbc.d(),  0xf4);
        EXPECT(gbc.e(),  0x61);
        EXPECT(gbc.h(),  0x31);
        EXPECT(gbc.l(),  0x60);
        EXPECT(gbc.sp(), 0xc94d);
        EXPECT(gbc.pc(), 0xda7d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xda7b), 0xcb);
        EXPECT(gbc.readMem(0xda7c), 0x4);
        // CB 04 01C2
        gbc.setState(0xd538, 0xe557, 0xd310, 0xbd94, 0xf9e6, 0x6d15, 0x0, 0x1);
        gbc.writeMem(0xd538, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd3);
        EXPECT(gbc.b(),  0xbd);
        EXPECT(gbc.c(),  0x94);
        EXPECT(gbc.d(),  0xf9);
        EXPECT(gbc.e(),  0xe6);
        EXPECT(gbc.h(),  0xda);
        EXPECT(gbc.l(),  0x15);
        EXPECT(gbc.sp(), 0xe557);
        EXPECT(gbc.pc(), 0xd53a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd538), 0xcb);
        EXPECT(gbc.readMem(0xd539), 0x4);
        // CB 04 01C3
        gbc.setState(0x5673, 0x433f, 0xaae0, 0xf089, 0x8ea5, 0x7221, 0x1, 0x1);
        gbc.writeMem(0x5673, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xaa);
        EXPECT(gbc.b(),  0xf0);
        EXPECT(gbc.c(),  0x89);
        EXPECT(gbc.d(),  0x8e);
        EXPECT(gbc.e(),  0xa5);
        EXPECT(gbc.h(),  0xe4);
        EXPECT(gbc.l(),  0x21);
        EXPECT(gbc.sp(), 0x433f);
        EXPECT(gbc.pc(), 0x5675);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 01C4
        gbc.setState(0xe4f2, 0x8926, 0xfe40, 0x5438, 0x1082, 0x6f6a, 0x0, 0x0);
        gbc.writeMem(0xe4f2, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xfe);
        EXPECT(gbc.b(),  0x54);
        EXPECT(gbc.c(),  0x38);
        EXPECT(gbc.d(),  0x10);
        EXPECT(gbc.e(),  0x82);
        EXPECT(gbc.h(),  0xde);
        EXPECT(gbc.l(),  0x6a);
        EXPECT(gbc.sp(), 0x8926);
        EXPECT(gbc.pc(), 0xe4f4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe4f2), 0xcb);
        EXPECT(gbc.readMem(0xe4f3), 0x4);
        // CB 04 01C6
        gbc.setState(0x9f9, 0x478e, 0x5df0, 0x24c1, 0x51d4, 0x436b, 0x0, 0x1);
        gbc.writeMem(0x9f9, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x5d);
        EXPECT(gbc.b(),  0x24);
        EXPECT(gbc.c(),  0xc1);
        EXPECT(gbc.d(),  0x51);
        EXPECT(gbc.e(),  0xd4);
        EXPECT(gbc.h(),  0x86);
        EXPECT(gbc.l(),  0x6b);
        EXPECT(gbc.sp(), 0x478e);
        EXPECT(gbc.pc(), 0x9fb);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 01C7
        gbc.setState(0x7ff6, 0x770f, 0xf110, 0xc044, 0xa566, 0x7fe9, 0x0, 0x0);
        gbc.writeMem(0x7ff6, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf1);
        EXPECT(gbc.b(),  0xc0);
        EXPECT(gbc.c(),  0x44);
        EXPECT(gbc.d(),  0xa5);
        EXPECT(gbc.e(),  0x66);
        EXPECT(gbc.h(),  0xfe);
        EXPECT(gbc.l(),  0xe9);
        EXPECT(gbc.sp(), 0x770f);
        EXPECT(gbc.pc(), 0x7ff8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 01C9
        gbc.setState(0xbbc3, 0x94aa, 0x3d0, 0x72b1, 0xcfd1, 0xf6db, 0x1, 0x1);
        gbc.writeMem(0xbbc3, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3);
        EXPECT(gbc.b(),  0x72);
        EXPECT(gbc.c(),  0xb1);
        EXPECT(gbc.d(),  0xcf);
        EXPECT(gbc.e(),  0xd1);
        EXPECT(gbc.h(),  0xed);
        EXPECT(gbc.l(),  0xdb);
        EXPECT(gbc.sp(), 0x94aa);
        EXPECT(gbc.pc(), 0xbbc5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbbc3), 0xcb);
        EXPECT(gbc.readMem(0xbbc4), 0x4);
        // CB 04 01CA
        gbc.setState(0xc006, 0x5a6b, 0xb710, 0x964f, 0xe4ce, 0xb504, 0x0, 0x1);
        gbc.writeMem(0xc006, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb7);
        EXPECT(gbc.b(),  0x96);
        EXPECT(gbc.c(),  0x4f);
        EXPECT(gbc.d(),  0xe4);
        EXPECT(gbc.e(),  0xce);
        EXPECT(gbc.h(),  0x6b);
        EXPECT(gbc.l(),  0x4);
        EXPECT(gbc.sp(), 0x5a6b);
        EXPECT(gbc.pc(), 0xc008);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc006), 0xcb);
        EXPECT(gbc.readMem(0xc007), 0x4);
        // CB 04 01CB
        gbc.setState(0x8b62, 0x907e, 0x5840, 0xfafb, 0xaff, 0xe1ea, 0x0, 0x0);
        gbc.writeMem(0x8b62, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x58);
        EXPECT(gbc.b(),  0xfa);
        EXPECT(gbc.c(),  0xfb);
        EXPECT(gbc.d(),  0xa);
        EXPECT(gbc.e(),  0xff);
        EXPECT(gbc.h(),  0xc3);
        EXPECT(gbc.l(),  0xea);
        EXPECT(gbc.sp(), 0x907e);
        EXPECT(gbc.pc(), 0x8b64);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8b62), 0xcb);
        EXPECT(gbc.readMem(0x8b63), 0x4);
        // CB 04 01CC
        gbc.setState(0x98b0, 0xd229, 0xaa10, 0xcf40, 0xc40d, 0xa6f7, 0x1, 0x0);
        gbc.writeMem(0x98b0, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xaa);
        EXPECT(gbc.b(),  0xcf);
        EXPECT(gbc.c(),  0x40);
        EXPECT(gbc.d(),  0xc4);
        EXPECT(gbc.e(),  0xd);
        EXPECT(gbc.h(),  0x4d);
        EXPECT(gbc.l(),  0xf7);
        EXPECT(gbc.sp(), 0xd229);
        EXPECT(gbc.pc(), 0x98b2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x98b0), 0xcb);
        EXPECT(gbc.readMem(0x98b1), 0x4);
        // CB 04 01CD
        gbc.setState(0x5fcd, 0x4765, 0x5ab0, 0xda9f, 0x4ee7, 0x7d9a, 0x0, 0x0);
        gbc.writeMem(0x5fcd, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x5a);
        EXPECT(gbc.b(),  0xda);
        EXPECT(gbc.c(),  0x9f);
        EXPECT(gbc.d(),  0x4e);
        EXPECT(gbc.e(),  0xe7);
        EXPECT(gbc.h(),  0xfa);
        EXPECT(gbc.l(),  0x9a);
        EXPECT(gbc.sp(), 0x4765);
        EXPECT(gbc.pc(), 0x5fcf);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 01CE
        gbc.setState(0xc2d, 0x1d06, 0xd4f0, 0xdaee, 0xcf33, 0xa5e1, 0x1, 0x1);
        gbc.writeMem(0xc2d, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd4);
        EXPECT(gbc.b(),  0xda);
        EXPECT(gbc.c(),  0xee);
        EXPECT(gbc.d(),  0xcf);
        EXPECT(gbc.e(),  0x33);
        EXPECT(gbc.h(),  0x4b);
        EXPECT(gbc.l(),  0xe1);
        EXPECT(gbc.sp(), 0x1d06);
        EXPECT(gbc.pc(), 0xc2f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 01CF
        gbc.setState(0x2ec4, 0xe7ca, 0x59b0, 0x1787, 0xdd40, 0x9950, 0x0, 0x0);
        gbc.writeMem(0x2ec4, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x59);
        EXPECT(gbc.b(),  0x17);
        EXPECT(gbc.c(),  0x87);
        EXPECT(gbc.d(),  0xdd);
        EXPECT(gbc.e(),  0x40);
        EXPECT(gbc.h(),  0x33);
        EXPECT(gbc.l(),  0x50);
        EXPECT(gbc.sp(), 0xe7ca);
        EXPECT(gbc.pc(), 0x2ec6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 01D0
        gbc.setState(0x3f85, 0xf451, 0xed20, 0x652c, 0x2ea8, 0x9a38, 0x0, 0x0);
        gbc.writeMem(0x3f85, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xed);
        EXPECT(gbc.b(),  0x65);
        EXPECT(gbc.c(),  0x2c);
        EXPECT(gbc.d(),  0x2e);
        EXPECT(gbc.e(),  0xa8);
        EXPECT(gbc.h(),  0x35);
        EXPECT(gbc.l(),  0x38);
        EXPECT(gbc.sp(), 0xf451);
        EXPECT(gbc.pc(), 0x3f87);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 01D1
        gbc.setState(0x3942, 0x7fc4, 0x2390, 0xef70, 0x2f98, 0x5099, 0x1, 0x0);
        gbc.writeMem(0x3942, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x23);
        EXPECT(gbc.b(),  0xef);
        EXPECT(gbc.c(),  0x70);
        EXPECT(gbc.d(),  0x2f);
        EXPECT(gbc.e(),  0x98);
        EXPECT(gbc.h(),  0xa0);
        EXPECT(gbc.l(),  0x99);
        EXPECT(gbc.sp(), 0x7fc4);
        EXPECT(gbc.pc(), 0x3944);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 01D2
        gbc.setState(0x2ae5, 0x14fb, 0xd220, 0x1163, 0xc085, 0xf6b4, 0x0, 0x1);
        gbc.writeMem(0x2ae5, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd2);
        EXPECT(gbc.b(),  0x11);
        EXPECT(gbc.c(),  0x63);
        EXPECT(gbc.d(),  0xc0);
        EXPECT(gbc.e(),  0x85);
        EXPECT(gbc.h(),  0xed);
        EXPECT(gbc.l(),  0xb4);
        EXPECT(gbc.sp(), 0x14fb);
        EXPECT(gbc.pc(), 0x2ae7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 01D3
        gbc.setState(0x144b, 0xbcce, 0xa570, 0x9cf2, 0xad24, 0xca0c, 0x1, 0x0);
        gbc.writeMem(0x144b, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa5);
        EXPECT(gbc.b(),  0x9c);
        EXPECT(gbc.c(),  0xf2);
        EXPECT(gbc.d(),  0xad);
        EXPECT(gbc.e(),  0x24);
        EXPECT(gbc.h(),  0x95);
        EXPECT(gbc.l(),  0xc);
        EXPECT(gbc.sp(), 0xbcce);
        EXPECT(gbc.pc(), 0x144d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 01D4
        gbc.setState(0xc3c, 0xed46, 0x25a0, 0xb403, 0x7235, 0x3965, 0x0, 0x0);
        gbc.writeMem(0xc3c, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x25);
        EXPECT(gbc.b(),  0xb4);
        EXPECT(gbc.c(),  0x3);
        EXPECT(gbc.d(),  0x72);
        EXPECT(gbc.e(),  0x35);
        EXPECT(gbc.h(),  0x72);
        EXPECT(gbc.l(),  0x65);
        EXPECT(gbc.sp(), 0xed46);
        EXPECT(gbc.pc(), 0xc3e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 01D5
        gbc.setState(0x279f, 0x466, 0x99b0, 0x1b88, 0x50fe, 0x1dc1, 0x0, 0x0);
        gbc.writeMem(0x279f, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x99);
        EXPECT(gbc.b(),  0x1b);
        EXPECT(gbc.c(),  0x88);
        EXPECT(gbc.d(),  0x50);
        EXPECT(gbc.e(),  0xfe);
        EXPECT(gbc.h(),  0x3a);
        EXPECT(gbc.l(),  0xc1);
        EXPECT(gbc.sp(), 0x466);
        EXPECT(gbc.pc(), 0x27a1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 01D6
        gbc.setState(0x1df, 0xdbb4, 0xab70, 0x420d, 0xbb9a, 0x7d6a, 0x1, 0x1);
        gbc.writeMem(0x1df, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xab);
        EXPECT(gbc.b(),  0x42);
        EXPECT(gbc.c(),  0xd);
        EXPECT(gbc.d(),  0xbb);
        EXPECT(gbc.e(),  0x9a);
        EXPECT(gbc.h(),  0xfa);
        EXPECT(gbc.l(),  0x6a);
        EXPECT(gbc.sp(), 0xdbb4);
        EXPECT(gbc.pc(), 0x1e1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 01D7
        gbc.setState(0xbdd, 0xca4d, 0x3080, 0x5ef8, 0xd975, 0x8ebe, 0x1, 0x0);
        gbc.writeMem(0xbdd, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x30);
        EXPECT(gbc.b(),  0x5e);
        EXPECT(gbc.c(),  0xf8);
        EXPECT(gbc.d(),  0xd9);
        EXPECT(gbc.e(),  0x75);
        EXPECT(gbc.h(),  0x1d);
        EXPECT(gbc.l(),  0xbe);
        EXPECT(gbc.sp(), 0xca4d);
        EXPECT(gbc.pc(), 0xbdf);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 01D8
        gbc.setState(0x4f5d, 0xcea9, 0xcfc0, 0xc016, 0x3744, 0xd8fc, 0x1, 0x1);
        gbc.writeMem(0x4f5d, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xcf);
        EXPECT(gbc.b(),  0xc0);
        EXPECT(gbc.c(),  0x16);
        EXPECT(gbc.d(),  0x37);
        EXPECT(gbc.e(),  0x44);
        EXPECT(gbc.h(),  0xb1);
        EXPECT(gbc.l(),  0xfc);
        EXPECT(gbc.sp(), 0xcea9);
        EXPECT(gbc.pc(), 0x4f5f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 01D9
        gbc.setState(0x5c4e, 0x205a, 0xf050, 0x495f, 0x47a, 0xceb5, 0x1, 0x0);
        gbc.writeMem(0x5c4e, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf0);
        EXPECT(gbc.b(),  0x49);
        EXPECT(gbc.c(),  0x5f);
        EXPECT(gbc.d(),  0x4);
        EXPECT(gbc.e(),  0x7a);
        EXPECT(gbc.h(),  0x9d);
        EXPECT(gbc.l(),  0xb5);
        EXPECT(gbc.sp(), 0x205a);
        EXPECT(gbc.pc(), 0x5c50);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 01DA
        gbc.setState(0x24b3, 0xea14, 0x14a0, 0x9bc4, 0x8bb3, 0x60da, 0x0, 0x1);
        gbc.writeMem(0x24b3, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x14);
        EXPECT(gbc.b(),  0x9b);
        EXPECT(gbc.c(),  0xc4);
        EXPECT(gbc.d(),  0x8b);
        EXPECT(gbc.e(),  0xb3);
        EXPECT(gbc.h(),  0xc0);
        EXPECT(gbc.l(),  0xda);
        EXPECT(gbc.sp(), 0xea14);
        EXPECT(gbc.pc(), 0x24b5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 01DB
        gbc.setState(0x9446, 0x98ae, 0x5120, 0x4843, 0x12d, 0xdfb4, 0x1, 0x0);
        gbc.writeMem(0x9446, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x51);
        EXPECT(gbc.b(),  0x48);
        EXPECT(gbc.c(),  0x43);
        EXPECT(gbc.d(),  0x1);
        EXPECT(gbc.e(),  0x2d);
        EXPECT(gbc.h(),  0xbf);
        EXPECT(gbc.l(),  0xb4);
        EXPECT(gbc.sp(), 0x98ae);
        EXPECT(gbc.pc(), 0x9448);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9446), 0xcb);
        EXPECT(gbc.readMem(0x9447), 0x4);
        // CB 04 01DC
        gbc.setState(0x8d2a, 0xaeb1, 0x76d0, 0x8048, 0xafe7, 0x5c4e, 0x1, 0x1);
        gbc.writeMem(0x8d2a, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x76);
        EXPECT(gbc.b(),  0x80);
        EXPECT(gbc.c(),  0x48);
        EXPECT(gbc.d(),  0xaf);
        EXPECT(gbc.e(),  0xe7);
        EXPECT(gbc.h(),  0xb8);
        EXPECT(gbc.l(),  0x4e);
        EXPECT(gbc.sp(), 0xaeb1);
        EXPECT(gbc.pc(), 0x8d2c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8d2a), 0xcb);
        EXPECT(gbc.readMem(0x8d2b), 0x4);
        // CB 04 01DD
        gbc.setState(0xdddf, 0xba89, 0xcf90, 0x57df, 0xaeca, 0x8e7f, 0x1, 0x1);
        gbc.writeMem(0xdddf, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xcf);
        EXPECT(gbc.b(),  0x57);
        EXPECT(gbc.c(),  0xdf);
        EXPECT(gbc.d(),  0xae);
        EXPECT(gbc.e(),  0xca);
        EXPECT(gbc.h(),  0x1d);
        EXPECT(gbc.l(),  0x7f);
        EXPECT(gbc.sp(), 0xba89);
        EXPECT(gbc.pc(), 0xdde1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xdddf), 0xcb);
        EXPECT(gbc.readMem(0xdde0), 0x4);
        // CB 04 01DE
        gbc.setState(0x46ad, 0x8e14, 0xd5b0, 0x79b2, 0x483b, 0xa9a9, 0x1, 0x1);
        gbc.writeMem(0x46ad, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd5);
        EXPECT(gbc.b(),  0x79);
        EXPECT(gbc.c(),  0xb2);
        EXPECT(gbc.d(),  0x48);
        EXPECT(gbc.e(),  0x3b);
        EXPECT(gbc.h(),  0x53);
        EXPECT(gbc.l(),  0xa9);
        EXPECT(gbc.sp(), 0x8e14);
        EXPECT(gbc.pc(), 0x46af);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 01DF
        gbc.setState(0x3a62, 0xe48a, 0xb440, 0x502b, 0x84ee, 0xcd6c, 0x1, 0x0);
        gbc.writeMem(0x3a62, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb4);
        EXPECT(gbc.b(),  0x50);
        EXPECT(gbc.c(),  0x2b);
        EXPECT(gbc.d(),  0x84);
        EXPECT(gbc.e(),  0xee);
        EXPECT(gbc.h(),  0x9b);
        EXPECT(gbc.l(),  0x6c);
        EXPECT(gbc.sp(), 0xe48a);
        EXPECT(gbc.pc(), 0x3a64);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 01E0
        gbc.setState(0xe029, 0x5ff5, 0x220, 0x5924, 0x20e6, 0x32ed, 0x1, 0x0);
        gbc.writeMem(0xe029, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0x59);
        EXPECT(gbc.c(),  0x24);
        EXPECT(gbc.d(),  0x20);
        EXPECT(gbc.e(),  0xe6);
        EXPECT(gbc.h(),  0x64);
        EXPECT(gbc.l(),  0xed);
        EXPECT(gbc.sp(), 0x5ff5);
        EXPECT(gbc.pc(), 0xe02b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe029), 0xcb);
        EXPECT(gbc.readMem(0xe02a), 0x4);
        // CB 04 01E1
        gbc.setState(0x59f7, 0x30cb, 0x8990, 0xf473, 0xbcff, 0x95b0, 0x0, 0x0);
        gbc.writeMem(0x59f7, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x89);
        EXPECT(gbc.b(),  0xf4);
        EXPECT(gbc.c(),  0x73);
        EXPECT(gbc.d(),  0xbc);
        EXPECT(gbc.e(),  0xff);
        EXPECT(gbc.h(),  0x2b);
        EXPECT(gbc.l(),  0xb0);
        EXPECT(gbc.sp(), 0x30cb);
        EXPECT(gbc.pc(), 0x59f9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 01E2
        gbc.setState(0x4b6c, 0xe009, 0x8ce0, 0xe5dd, 0x2235, 0x9cff, 0x1, 0x0);
        gbc.writeMem(0x4b6c, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8c);
        EXPECT(gbc.b(),  0xe5);
        EXPECT(gbc.c(),  0xdd);
        EXPECT(gbc.d(),  0x22);
        EXPECT(gbc.e(),  0x35);
        EXPECT(gbc.h(),  0x39);
        EXPECT(gbc.l(),  0xff);
        EXPECT(gbc.sp(), 0xe009);
        EXPECT(gbc.pc(), 0x4b6e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 01E3
        gbc.setState(0x8e24, 0xf003, 0xfab0, 0xb13, 0x607e, 0x3047, 0x0, 0x1);
        gbc.writeMem(0x8e24, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xfa);
        EXPECT(gbc.b(),  0xb);
        EXPECT(gbc.c(),  0x13);
        EXPECT(gbc.d(),  0x60);
        EXPECT(gbc.e(),  0x7e);
        EXPECT(gbc.h(),  0x60);
        EXPECT(gbc.l(),  0x47);
        EXPECT(gbc.sp(), 0xf003);
        EXPECT(gbc.pc(), 0x8e26);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8e24), 0xcb);
        EXPECT(gbc.readMem(0x8e25), 0x4);
        // CB 04 01E4
        gbc.setState(0x5dbf, 0x8df8, 0x64a0, 0x7f90, 0xd60a, 0xd026, 0x1, 0x1);
        gbc.writeMem(0x5dbf, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x64);
        EXPECT(gbc.b(),  0x7f);
        EXPECT(gbc.c(),  0x90);
        EXPECT(gbc.d(),  0xd6);
        EXPECT(gbc.e(),  0xa);
        EXPECT(gbc.h(),  0xa1);
        EXPECT(gbc.l(),  0x26);
        EXPECT(gbc.sp(), 0x8df8);
        EXPECT(gbc.pc(), 0x5dc1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 01E5
        gbc.setState(0x2adc, 0x55be, 0xc120, 0xd345, 0xdac0, 0xfb22, 0x1, 0x1);
        gbc.writeMem(0x2adc, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc1);
        EXPECT(gbc.b(),  0xd3);
        EXPECT(gbc.c(),  0x45);
        EXPECT(gbc.d(),  0xda);
        EXPECT(gbc.e(),  0xc0);
        EXPECT(gbc.h(),  0xf7);
        EXPECT(gbc.l(),  0x22);
        EXPECT(gbc.sp(), 0x55be);
        EXPECT(gbc.pc(), 0x2ade);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 01E6
        gbc.setState(0x65d0, 0xd9c2, 0x9700, 0x6a40, 0xeddf, 0x445c, 0x1, 0x0);
        gbc.writeMem(0x65d0, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x97);
        EXPECT(gbc.b(),  0x6a);
        EXPECT(gbc.c(),  0x40);
        EXPECT(gbc.d(),  0xed);
        EXPECT(gbc.e(),  0xdf);
        EXPECT(gbc.h(),  0x88);
        EXPECT(gbc.l(),  0x5c);
        EXPECT(gbc.sp(), 0xd9c2);
        EXPECT(gbc.pc(), 0x65d2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 01E7
        gbc.setState(0x16fa, 0x5c1c, 0xaa40, 0xcd91, 0xb151, 0x7ea0, 0x1, 0x0);
        gbc.writeMem(0x16fa, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xaa);
        EXPECT(gbc.b(),  0xcd);
        EXPECT(gbc.c(),  0x91);
        EXPECT(gbc.d(),  0xb1);
        EXPECT(gbc.e(),  0x51);
        EXPECT(gbc.h(),  0xfc);
        EXPECT(gbc.l(),  0xa0);
        EXPECT(gbc.sp(), 0x5c1c);
        EXPECT(gbc.pc(), 0x16fc);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 01E8
        gbc.setState(0x5f1f, 0x2e8b, 0xc2e0, 0x6960, 0xbf60, 0xf8f8, 0x0, 0x1);
        gbc.writeMem(0x5f1f, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc2);
        EXPECT(gbc.b(),  0x69);
        EXPECT(gbc.c(),  0x60);
        EXPECT(gbc.d(),  0xbf);
        EXPECT(gbc.e(),  0x60);
        EXPECT(gbc.h(),  0xf1);
        EXPECT(gbc.l(),  0xf8);
        EXPECT(gbc.sp(), 0x2e8b);
        EXPECT(gbc.pc(), 0x5f21);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 01E9
        gbc.setState(0xe144, 0x7f02, 0x87d0, 0xe20, 0x29bb, 0x2598, 0x0, 0x1);
        gbc.writeMem(0xe144, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x87);
        EXPECT(gbc.b(),  0xe);
        EXPECT(gbc.c(),  0x20);
        EXPECT(gbc.d(),  0x29);
        EXPECT(gbc.e(),  0xbb);
        EXPECT(gbc.h(),  0x4a);
        EXPECT(gbc.l(),  0x98);
        EXPECT(gbc.sp(), 0x7f02);
        EXPECT(gbc.pc(), 0xe146);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe144), 0xcb);
        EXPECT(gbc.readMem(0xe145), 0x4);
        // CB 04 01EA
        gbc.setState(0xe19c, 0x75c7, 0xc410, 0x6ee1, 0x8eaf, 0xfc81, 0x1, 0x0);
        gbc.writeMem(0xe19c, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc4);
        EXPECT(gbc.b(),  0x6e);
        EXPECT(gbc.c(),  0xe1);
        EXPECT(gbc.d(),  0x8e);
        EXPECT(gbc.e(),  0xaf);
        EXPECT(gbc.h(),  0xf9);
        EXPECT(gbc.l(),  0x81);
        EXPECT(gbc.sp(), 0x75c7);
        EXPECT(gbc.pc(), 0xe19e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe19c), 0xcb);
        EXPECT(gbc.readMem(0xe19d), 0x4);
        // CB 04 01EC
        gbc.setState(0xba8f, 0x1627, 0x8c40, 0xdfd6, 0x290c, 0x9835, 0x1, 0x1);
        gbc.writeMem(0xba8f, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8c);
        EXPECT(gbc.b(),  0xdf);
        EXPECT(gbc.c(),  0xd6);
        EXPECT(gbc.d(),  0x29);
        EXPECT(gbc.e(),  0xc);
        EXPECT(gbc.h(),  0x31);
        EXPECT(gbc.l(),  0x35);
        EXPECT(gbc.sp(), 0x1627);
        EXPECT(gbc.pc(), 0xba91);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xba8f), 0xcb);
        EXPECT(gbc.readMem(0xba90), 0x4);
        // CB 04 01ED
        gbc.setState(0xae55, 0x21de, 0x6930, 0xe471, 0xe53, 0x4ee5, 0x0, 0x1);
        gbc.writeMem(0xae55, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x69);
        EXPECT(gbc.b(),  0xe4);
        EXPECT(gbc.c(),  0x71);
        EXPECT(gbc.d(),  0xe);
        EXPECT(gbc.e(),  0x53);
        EXPECT(gbc.h(),  0x9c);
        EXPECT(gbc.l(),  0xe5);
        EXPECT(gbc.sp(), 0x21de);
        EXPECT(gbc.pc(), 0xae57);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xae55), 0xcb);
        EXPECT(gbc.readMem(0xae56), 0x4);
        // CB 04 01EF
        gbc.setState(0xc36a, 0xd299, 0x7a10, 0x77b5, 0xa360, 0x9cf4, 0x0, 0x1);
        gbc.writeMem(0xc36a, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x7a);
        EXPECT(gbc.b(),  0x77);
        EXPECT(gbc.c(),  0xb5);
        EXPECT(gbc.d(),  0xa3);
        EXPECT(gbc.e(),  0x60);
        EXPECT(gbc.h(),  0x39);
        EXPECT(gbc.l(),  0xf4);
        EXPECT(gbc.sp(), 0xd299);
        EXPECT(gbc.pc(), 0xc36c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc36a), 0xcb);
        EXPECT(gbc.readMem(0xc36b), 0x4);
        // CB 04 01F0
        gbc.setState(0xeccb, 0x9949, 0x26d0, 0xea61, 0x9536, 0x9b19, 0x1, 0x1);
        gbc.writeMem(0xeccb, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x26);
        EXPECT(gbc.b(),  0xea);
        EXPECT(gbc.c(),  0x61);
        EXPECT(gbc.d(),  0x95);
        EXPECT(gbc.e(),  0x36);
        EXPECT(gbc.h(),  0x37);
        EXPECT(gbc.l(),  0x19);
        EXPECT(gbc.sp(), 0x9949);
        EXPECT(gbc.pc(), 0xeccd);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xeccb), 0xcb);
        EXPECT(gbc.readMem(0xeccc), 0x4);
        // CB 04 01F1
        gbc.setState(0x5e98, 0xd4c1, 0x1e10, 0xa68c, 0x1d21, 0xd0b2, 0x1, 0x0);
        gbc.writeMem(0x5e98, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1e);
        EXPECT(gbc.b(),  0xa6);
        EXPECT(gbc.c(),  0x8c);
        EXPECT(gbc.d(),  0x1d);
        EXPECT(gbc.e(),  0x21);
        EXPECT(gbc.h(),  0xa1);
        EXPECT(gbc.l(),  0xb2);
        EXPECT(gbc.sp(), 0xd4c1);
        EXPECT(gbc.pc(), 0x5e9a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 01F2
        gbc.setState(0x1e7, 0xd420, 0xada0, 0x5d94, 0xb8f6, 0x68a5, 0x1, 0x0);
        gbc.writeMem(0x1e7, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xad);
        EXPECT(gbc.b(),  0x5d);
        EXPECT(gbc.c(),  0x94);
        EXPECT(gbc.d(),  0xb8);
        EXPECT(gbc.e(),  0xf6);
        EXPECT(gbc.h(),  0xd0);
        EXPECT(gbc.l(),  0xa5);
        EXPECT(gbc.sp(), 0xd420);
        EXPECT(gbc.pc(), 0x1e9);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 01F3
        gbc.setState(0xe85c, 0xb29a, 0xa920, 0x70b4, 0x2a6b, 0x8600, 0x0, 0x0);
        gbc.writeMem(0xe85c, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa9);
        EXPECT(gbc.b(),  0x70);
        EXPECT(gbc.c(),  0xb4);
        EXPECT(gbc.d(),  0x2a);
        EXPECT(gbc.e(),  0x6b);
        EXPECT(gbc.h(),  0xd);
        EXPECT(gbc.l(),  0x0);
        EXPECT(gbc.sp(), 0xb29a);
        EXPECT(gbc.pc(), 0xe85e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe85c), 0xcb);
        EXPECT(gbc.readMem(0xe85d), 0x4);
        // CB 04 01F4
        gbc.setState(0xc9fa, 0xaecd, 0x80f0, 0x5bdd, 0x9473, 0xb5dc, 0x1, 0x1);
        gbc.writeMem(0xc9fa, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0x5b);
        EXPECT(gbc.c(),  0xdd);
        EXPECT(gbc.d(),  0x94);
        EXPECT(gbc.e(),  0x73);
        EXPECT(gbc.h(),  0x6b);
        EXPECT(gbc.l(),  0xdc);
        EXPECT(gbc.sp(), 0xaecd);
        EXPECT(gbc.pc(), 0xc9fc);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc9fa), 0xcb);
        EXPECT(gbc.readMem(0xc9fb), 0x4);
        // CB 04 01F5
        gbc.setState(0xa789, 0xc8f9, 0x96d0, 0x6474, 0xc4af, 0x5657, 0x0, 0x0);
        gbc.writeMem(0xa789, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x96);
        EXPECT(gbc.b(),  0x64);
        EXPECT(gbc.c(),  0x74);
        EXPECT(gbc.d(),  0xc4);
        EXPECT(gbc.e(),  0xaf);
        EXPECT(gbc.h(),  0xac);
        EXPECT(gbc.l(),  0x57);
        EXPECT(gbc.sp(), 0xc8f9);
        EXPECT(gbc.pc(), 0xa78b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa789), 0xcb);
        EXPECT(gbc.readMem(0xa78a), 0x4);
        // CB 04 01F6
        gbc.setState(0x5cc2, 0x9dec, 0x2780, 0xa3de, 0x9c8b, 0x8dc3, 0x0, 0x0);
        gbc.writeMem(0x5cc2, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x27);
        EXPECT(gbc.b(),  0xa3);
        EXPECT(gbc.c(),  0xde);
        EXPECT(gbc.d(),  0x9c);
        EXPECT(gbc.e(),  0x8b);
        EXPECT(gbc.h(),  0x1b);
        EXPECT(gbc.l(),  0xc3);
        EXPECT(gbc.sp(), 0x9dec);
        EXPECT(gbc.pc(), 0x5cc4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 01F7
        gbc.setState(0x1208, 0x1078, 0xd730, 0x1c78, 0x4a23, 0x613e, 0x1, 0x0);
        gbc.writeMem(0x1208, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd7);
        EXPECT(gbc.b(),  0x1c);
        EXPECT(gbc.c(),  0x78);
        EXPECT(gbc.d(),  0x4a);
        EXPECT(gbc.e(),  0x23);
        EXPECT(gbc.h(),  0xc2);
        EXPECT(gbc.l(),  0x3e);
        EXPECT(gbc.sp(), 0x1078);
        EXPECT(gbc.pc(), 0x120a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 01F8
        gbc.setState(0xc9f0, 0xa77b, 0x3850, 0x5325, 0x9c83, 0xba68, 0x1, 0x0);
        gbc.writeMem(0xc9f0, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x38);
        EXPECT(gbc.b(),  0x53);
        EXPECT(gbc.c(),  0x25);
        EXPECT(gbc.d(),  0x9c);
        EXPECT(gbc.e(),  0x83);
        EXPECT(gbc.h(),  0x75);
        EXPECT(gbc.l(),  0x68);
        EXPECT(gbc.sp(), 0xa77b);
        EXPECT(gbc.pc(), 0xc9f2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc9f0), 0xcb);
        EXPECT(gbc.readMem(0xc9f1), 0x4);
        // CB 04 01F9
        gbc.setState(0xafea, 0xf39, 0x6c30, 0xeb8a, 0x3705, 0x4d1c, 0x1, 0x1);
        gbc.writeMem(0xafea, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x6c);
        EXPECT(gbc.b(),  0xeb);
        EXPECT(gbc.c(),  0x8a);
        EXPECT(gbc.d(),  0x37);
        EXPECT(gbc.e(),  0x5);
        EXPECT(gbc.h(),  0x9a);
        EXPECT(gbc.l(),  0x1c);
        EXPECT(gbc.sp(), 0xf39);
        EXPECT(gbc.pc(), 0xafec);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xafea), 0xcb);
        EXPECT(gbc.readMem(0xafeb), 0x4);
        // CB 04 01FA
        gbc.setState(0x3020, 0x104e, 0x8030, 0x2204, 0xd8f3, 0xdd8, 0x1, 0x0);
        gbc.writeMem(0x3020, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0x22);
        EXPECT(gbc.c(),  0x4);
        EXPECT(gbc.d(),  0xd8);
        EXPECT(gbc.e(),  0xf3);
        EXPECT(gbc.h(),  0x1a);
        EXPECT(gbc.l(),  0xd8);
        EXPECT(gbc.sp(), 0x104e);
        EXPECT(gbc.pc(), 0x3022);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 01FB
        gbc.setState(0x91f6, 0x9a8, 0xeb70, 0xf4d7, 0xf603, 0x36f7, 0x0, 0x1);
        gbc.writeMem(0x91f6, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xeb);
        EXPECT(gbc.b(),  0xf4);
        EXPECT(gbc.c(),  0xd7);
        EXPECT(gbc.d(),  0xf6);
        EXPECT(gbc.e(),  0x3);
        EXPECT(gbc.h(),  0x6c);
        EXPECT(gbc.l(),  0xf7);
        EXPECT(gbc.sp(), 0x9a8);
        EXPECT(gbc.pc(), 0x91f8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x91f6), 0xcb);
        EXPECT(gbc.readMem(0x91f7), 0x4);
        // CB 04 01FC
        gbc.setState(0x4e51, 0xbb08, 0x56c0, 0xf866, 0x6ec9, 0x4763, 0x1, 0x0);
        gbc.writeMem(0x4e51, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x56);
        EXPECT(gbc.b(),  0xf8);
        EXPECT(gbc.c(),  0x66);
        EXPECT(gbc.d(),  0x6e);
        EXPECT(gbc.e(),  0xc9);
        EXPECT(gbc.h(),  0x8e);
        EXPECT(gbc.l(),  0x63);
        EXPECT(gbc.sp(), 0xbb08);
        EXPECT(gbc.pc(), 0x4e53);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 01FD
        gbc.setState(0xb5ad, 0x9c26, 0x4fe0, 0xa459, 0xea36, 0x6f92, 0x0, 0x1);
        gbc.writeMem(0xb5ad, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4f);
        EXPECT(gbc.b(),  0xa4);
        EXPECT(gbc.c(),  0x59);
        EXPECT(gbc.d(),  0xea);
        EXPECT(gbc.e(),  0x36);
        EXPECT(gbc.h(),  0xde);
        EXPECT(gbc.l(),  0x92);
        EXPECT(gbc.sp(), 0x9c26);
        EXPECT(gbc.pc(), 0xb5af);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb5ad), 0xcb);
        EXPECT(gbc.readMem(0xb5ae), 0x4);
        // CB 04 01FE
        gbc.setState(0x6f86, 0xf15e, 0x1e10, 0x9c92, 0x87fb, 0xac8e, 0x0, 0x1);
        gbc.writeMem(0x6f86, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1e);
        EXPECT(gbc.b(),  0x9c);
        EXPECT(gbc.c(),  0x92);
        EXPECT(gbc.d(),  0x87);
        EXPECT(gbc.e(),  0xfb);
        EXPECT(gbc.h(),  0x59);
        EXPECT(gbc.l(),  0x8e);
        EXPECT(gbc.sp(), 0xf15e);
        EXPECT(gbc.pc(), 0x6f88);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 01FF
        gbc.setState(0x73b1, 0x8776, 0xe1c0, 0x1c55, 0x2e83, 0xa245, 0x0, 0x0);
        gbc.writeMem(0x73b1, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe1);
        EXPECT(gbc.b(),  0x1c);
        EXPECT(gbc.c(),  0x55);
        EXPECT(gbc.d(),  0x2e);
        EXPECT(gbc.e(),  0x83);
        EXPECT(gbc.h(),  0x45);
        EXPECT(gbc.l(),  0x45);
        EXPECT(gbc.sp(), 0x8776);
        EXPECT(gbc.pc(), 0x73b3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0200
        gbc.setState(0x2915, 0x9aa2, 0x34c0, 0xd55c, 0xca14, 0x27c, 0x1, 0x1);
        gbc.writeMem(0x2915, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x34);
        EXPECT(gbc.b(),  0xd5);
        EXPECT(gbc.c(),  0x5c);
        EXPECT(gbc.d(),  0xca);
        EXPECT(gbc.e(),  0x14);
        EXPECT(gbc.h(),  0x4);
        EXPECT(gbc.l(),  0x7c);
        EXPECT(gbc.sp(), 0x9aa2);
        EXPECT(gbc.pc(), 0x2917);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0201
        gbc.setState(0x3e31, 0x73d5, 0x1ad0, 0x2acf, 0x161b, 0x6d3a, 0x0, 0x1);
        gbc.writeMem(0x3e31, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1a);
        EXPECT(gbc.b(),  0x2a);
        EXPECT(gbc.c(),  0xcf);
        EXPECT(gbc.d(),  0x16);
        EXPECT(gbc.e(),  0x1b);
        EXPECT(gbc.h(),  0xda);
        EXPECT(gbc.l(),  0x3a);
        EXPECT(gbc.sp(), 0x73d5);
        EXPECT(gbc.pc(), 0x3e33);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0202
        gbc.setState(0xc180, 0x3e27, 0x4210, 0x63cf, 0x3108, 0x9a88, 0x0, 0x1);
        gbc.writeMem(0xc180, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x42);
        EXPECT(gbc.b(),  0x63);
        EXPECT(gbc.c(),  0xcf);
        EXPECT(gbc.d(),  0x31);
        EXPECT(gbc.e(),  0x8);
        EXPECT(gbc.h(),  0x35);
        EXPECT(gbc.l(),  0x88);
        EXPECT(gbc.sp(), 0x3e27);
        EXPECT(gbc.pc(), 0xc182);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc180), 0xcb);
        EXPECT(gbc.readMem(0xc181), 0x4);
        // CB 04 0203
        gbc.setState(0x9aeb, 0x81fb, 0xdb20, 0x8319, 0xc234, 0x2699, 0x1, 0x0);
        gbc.writeMem(0x9aeb, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xdb);
        EXPECT(gbc.b(),  0x83);
        EXPECT(gbc.c(),  0x19);
        EXPECT(gbc.d(),  0xc2);
        EXPECT(gbc.e(),  0x34);
        EXPECT(gbc.h(),  0x4c);
        EXPECT(gbc.l(),  0x99);
        EXPECT(gbc.sp(), 0x81fb);
        EXPECT(gbc.pc(), 0x9aed);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9aeb), 0xcb);
        EXPECT(gbc.readMem(0x9aec), 0x4);
        // CB 04 0204
        gbc.setState(0xce56, 0x258b, 0x8530, 0xe6ee, 0xcee2, 0xe362, 0x1, 0x0);
        gbc.writeMem(0xce56, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x85);
        EXPECT(gbc.b(),  0xe6);
        EXPECT(gbc.c(),  0xee);
        EXPECT(gbc.d(),  0xce);
        EXPECT(gbc.e(),  0xe2);
        EXPECT(gbc.h(),  0xc7);
        EXPECT(gbc.l(),  0x62);
        EXPECT(gbc.sp(), 0x258b);
        EXPECT(gbc.pc(), 0xce58);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xce56), 0xcb);
        EXPECT(gbc.readMem(0xce57), 0x4);
        // CB 04 0205
        gbc.setState(0x5c61, 0xeed6, 0x5f30, 0x19f9, 0xe777, 0x6867, 0x0, 0x1);
        gbc.writeMem(0x5c61, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x5f);
        EXPECT(gbc.b(),  0x19);
        EXPECT(gbc.c(),  0xf9);
        EXPECT(gbc.d(),  0xe7);
        EXPECT(gbc.e(),  0x77);
        EXPECT(gbc.h(),  0xd0);
        EXPECT(gbc.l(),  0x67);
        EXPECT(gbc.sp(), 0xeed6);
        EXPECT(gbc.pc(), 0x5c63);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0206
        gbc.setState(0x6c0b, 0x67dc, 0xb890, 0x2aff, 0xbc26, 0xbed1, 0x1, 0x1);
        gbc.writeMem(0x6c0b, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb8);
        EXPECT(gbc.b(),  0x2a);
        EXPECT(gbc.c(),  0xff);
        EXPECT(gbc.d(),  0xbc);
        EXPECT(gbc.e(),  0x26);
        EXPECT(gbc.h(),  0x7d);
        EXPECT(gbc.l(),  0xd1);
        EXPECT(gbc.sp(), 0x67dc);
        EXPECT(gbc.pc(), 0x6c0d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0208
        gbc.setState(0x70f8, 0x9a5e, 0xf6d0, 0x1a15, 0x3ce, 0x28eb, 0x0, 0x1);
        gbc.writeMem(0x70f8, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf6);
        EXPECT(gbc.b(),  0x1a);
        EXPECT(gbc.c(),  0x15);
        EXPECT(gbc.d(),  0x3);
        EXPECT(gbc.e(),  0xce);
        EXPECT(gbc.h(),  0x50);
        EXPECT(gbc.l(),  0xeb);
        EXPECT(gbc.sp(), 0x9a5e);
        EXPECT(gbc.pc(), 0x70fa);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0209
        gbc.setState(0xb06a, 0x7e04, 0x2d70, 0x99f5, 0x4091, 0xd0d6, 0x1, 0x1);
        gbc.writeMem(0xb06a, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2d);
        EXPECT(gbc.b(),  0x99);
        EXPECT(gbc.c(),  0xf5);
        EXPECT(gbc.d(),  0x40);
        EXPECT(gbc.e(),  0x91);
        EXPECT(gbc.h(),  0xa1);
        EXPECT(gbc.l(),  0xd6);
        EXPECT(gbc.sp(), 0x7e04);
        EXPECT(gbc.pc(), 0xb06c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb06a), 0xcb);
        EXPECT(gbc.readMem(0xb06b), 0x4);
        // CB 04 020A
        gbc.setState(0xb23, 0x9bae, 0xe8d0, 0xd4ac, 0x3808, 0xd453, 0x0, 0x0);
        gbc.writeMem(0xb23, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe8);
        EXPECT(gbc.b(),  0xd4);
        EXPECT(gbc.c(),  0xac);
        EXPECT(gbc.d(),  0x38);
        EXPECT(gbc.e(),  0x8);
        EXPECT(gbc.h(),  0xa9);
        EXPECT(gbc.l(),  0x53);
        EXPECT(gbc.sp(), 0x9bae);
        EXPECT(gbc.pc(), 0xb25);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 020B
        gbc.setState(0x3d8a, 0x3ca4, 0xc690, 0xda25, 0x7f07, 0xbc5b, 0x1, 0x1);
        gbc.writeMem(0x3d8a, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc6);
        EXPECT(gbc.b(),  0xda);
        EXPECT(gbc.c(),  0x25);
        EXPECT(gbc.d(),  0x7f);
        EXPECT(gbc.e(),  0x7);
        EXPECT(gbc.h(),  0x79);
        EXPECT(gbc.l(),  0x5b);
        EXPECT(gbc.sp(), 0x3ca4);
        EXPECT(gbc.pc(), 0x3d8c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 020C
        gbc.setState(0xb76f, 0x286f, 0x1d10, 0x9aeb, 0xacd2, 0x7a42, 0x1, 0x0);
        gbc.writeMem(0xb76f, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1d);
        EXPECT(gbc.b(),  0x9a);
        EXPECT(gbc.c(),  0xeb);
        EXPECT(gbc.d(),  0xac);
        EXPECT(gbc.e(),  0xd2);
        EXPECT(gbc.h(),  0xf4);
        EXPECT(gbc.l(),  0x42);
        EXPECT(gbc.sp(), 0x286f);
        EXPECT(gbc.pc(), 0xb771);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb76f), 0xcb);
        EXPECT(gbc.readMem(0xb770), 0x4);
        // CB 04 020D
        gbc.setState(0x49d7, 0xc66c, 0x77e0, 0x647f, 0xfe46, 0x8260, 0x1, 0x0);
        gbc.writeMem(0x49d7, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x77);
        EXPECT(gbc.b(),  0x64);
        EXPECT(gbc.c(),  0x7f);
        EXPECT(gbc.d(),  0xfe);
        EXPECT(gbc.e(),  0x46);
        EXPECT(gbc.h(),  0x5);
        EXPECT(gbc.l(),  0x60);
        EXPECT(gbc.sp(), 0xc66c);
        EXPECT(gbc.pc(), 0x49d9);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 020E
        gbc.setState(0x26b7, 0x13cc, 0xda80, 0x7d70, 0x20a1, 0xdb7c, 0x1, 0x1);
        gbc.writeMem(0x26b7, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xda);
        EXPECT(gbc.b(),  0x7d);
        EXPECT(gbc.c(),  0x70);
        EXPECT(gbc.d(),  0x20);
        EXPECT(gbc.e(),  0xa1);
        EXPECT(gbc.h(),  0xb7);
        EXPECT(gbc.l(),  0x7c);
        EXPECT(gbc.sp(), 0x13cc);
        EXPECT(gbc.pc(), 0x26b9);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 020F
        gbc.setState(0xdcea, 0x934d, 0xf190, 0xfb81, 0x9fd2, 0xd4a2, 0x0, 0x0);
        gbc.writeMem(0xdcea, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf1);
        EXPECT(gbc.b(),  0xfb);
        EXPECT(gbc.c(),  0x81);
        EXPECT(gbc.d(),  0x9f);
        EXPECT(gbc.e(),  0xd2);
        EXPECT(gbc.h(),  0xa9);
        EXPECT(gbc.l(),  0xa2);
        EXPECT(gbc.sp(), 0x934d);
        EXPECT(gbc.pc(), 0xdcec);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xdcea), 0xcb);
        EXPECT(gbc.readMem(0xdceb), 0x4);
        // CB 04 0210
        gbc.setState(0xdd6b, 0x95e7, 0x9bd0, 0xec86, 0x5958, 0x5697, 0x0, 0x0);
        gbc.writeMem(0xdd6b, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x9b);
        EXPECT(gbc.b(),  0xec);
        EXPECT(gbc.c(),  0x86);
        EXPECT(gbc.d(),  0x59);
        EXPECT(gbc.e(),  0x58);
        EXPECT(gbc.h(),  0xac);
        EXPECT(gbc.l(),  0x97);
        EXPECT(gbc.sp(), 0x95e7);
        EXPECT(gbc.pc(), 0xdd6d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdd6b), 0xcb);
        EXPECT(gbc.readMem(0xdd6c), 0x4);
        // CB 04 0211
        gbc.setState(0x91d6, 0x8f4f, 0x3a40, 0xa637, 0xd790, 0x715b, 0x1, 0x1);
        gbc.writeMem(0x91d6, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3a);
        EXPECT(gbc.b(),  0xa6);
        EXPECT(gbc.c(),  0x37);
        EXPECT(gbc.d(),  0xd7);
        EXPECT(gbc.e(),  0x90);
        EXPECT(gbc.h(),  0xe2);
        EXPECT(gbc.l(),  0x5b);
        EXPECT(gbc.sp(), 0x8f4f);
        EXPECT(gbc.pc(), 0x91d8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x91d6), 0xcb);
        EXPECT(gbc.readMem(0x91d7), 0x4);
        // CB 04 0212
        gbc.setState(0x36c5, 0xd868, 0xe70, 0xf13c, 0x385b, 0x1c15, 0x1, 0x1);
        gbc.writeMem(0x36c5, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe);
        EXPECT(gbc.b(),  0xf1);
        EXPECT(gbc.c(),  0x3c);
        EXPECT(gbc.d(),  0x38);
        EXPECT(gbc.e(),  0x5b);
        EXPECT(gbc.h(),  0x38);
        EXPECT(gbc.l(),  0x15);
        EXPECT(gbc.sp(), 0xd868);
        EXPECT(gbc.pc(), 0x36c7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0213
        gbc.setState(0x9906, 0x8e11, 0xc9e0, 0xb5f, 0x75f3, 0xc486, 0x0, 0x0);
        gbc.writeMem(0x9906, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc9);
        EXPECT(gbc.b(),  0xb);
        EXPECT(gbc.c(),  0x5f);
        EXPECT(gbc.d(),  0x75);
        EXPECT(gbc.e(),  0xf3);
        EXPECT(gbc.h(),  0x89);
        EXPECT(gbc.l(),  0x86);
        EXPECT(gbc.sp(), 0x8e11);
        EXPECT(gbc.pc(), 0x9908);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9906), 0xcb);
        EXPECT(gbc.readMem(0x9907), 0x4);
        // CB 04 0214
        gbc.setState(0x4bbc, 0x9c64, 0xd210, 0x54f8, 0x88e3, 0x1a5c, 0x0, 0x0);
        gbc.writeMem(0x4bbc, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd2);
        EXPECT(gbc.b(),  0x54);
        EXPECT(gbc.c(),  0xf8);
        EXPECT(gbc.d(),  0x88);
        EXPECT(gbc.e(),  0xe3);
        EXPECT(gbc.h(),  0x34);
        EXPECT(gbc.l(),  0x5c);
        EXPECT(gbc.sp(), 0x9c64);
        EXPECT(gbc.pc(), 0x4bbe);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0215
        gbc.setState(0x4cac, 0x6657, 0x3ae0, 0xbc67, 0xd489, 0x96d7, 0x0, 0x0);
        gbc.writeMem(0x4cac, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3a);
        EXPECT(gbc.b(),  0xbc);
        EXPECT(gbc.c(),  0x67);
        EXPECT(gbc.d(),  0xd4);
        EXPECT(gbc.e(),  0x89);
        EXPECT(gbc.h(),  0x2d);
        EXPECT(gbc.l(),  0xd7);
        EXPECT(gbc.sp(), 0x6657);
        EXPECT(gbc.pc(), 0x4cae);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0216
        gbc.setState(0xe662, 0x72fa, 0x3bc0, 0xe0ef, 0xfd82, 0x1613, 0x0, 0x1);
        gbc.writeMem(0xe662, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3b);
        EXPECT(gbc.b(),  0xe0);
        EXPECT(gbc.c(),  0xef);
        EXPECT(gbc.d(),  0xfd);
        EXPECT(gbc.e(),  0x82);
        EXPECT(gbc.h(),  0x2c);
        EXPECT(gbc.l(),  0x13);
        EXPECT(gbc.sp(), 0x72fa);
        EXPECT(gbc.pc(), 0xe664);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe662), 0xcb);
        EXPECT(gbc.readMem(0xe663), 0x4);
        // CB 04 0217
        gbc.setState(0xc65b, 0xe8ee, 0xd5c0, 0x2131, 0xb96f, 0xc2f7, 0x1, 0x1);
        gbc.writeMem(0xc65b, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd5);
        EXPECT(gbc.b(),  0x21);
        EXPECT(gbc.c(),  0x31);
        EXPECT(gbc.d(),  0xb9);
        EXPECT(gbc.e(),  0x6f);
        EXPECT(gbc.h(),  0x85);
        EXPECT(gbc.l(),  0xf7);
        EXPECT(gbc.sp(), 0xe8ee);
        EXPECT(gbc.pc(), 0xc65d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc65b), 0xcb);
        EXPECT(gbc.readMem(0xc65c), 0x4);
        // CB 04 0218
        gbc.setState(0xed81, 0x78a0, 0xb7f0, 0xc374, 0x28e4, 0x445b, 0x1, 0x1);
        gbc.writeMem(0xed81, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb7);
        EXPECT(gbc.b(),  0xc3);
        EXPECT(gbc.c(),  0x74);
        EXPECT(gbc.d(),  0x28);
        EXPECT(gbc.e(),  0xe4);
        EXPECT(gbc.h(),  0x88);
        EXPECT(gbc.l(),  0x5b);
        EXPECT(gbc.sp(), 0x78a0);
        EXPECT(gbc.pc(), 0xed83);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xed81), 0xcb);
        EXPECT(gbc.readMem(0xed82), 0x4);
        // CB 04 0219
        gbc.setState(0xa5ec, 0x2e7d, 0x2b40, 0xc077, 0xe639, 0x90d5, 0x0, 0x0);
        gbc.writeMem(0xa5ec, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2b);
        EXPECT(gbc.b(),  0xc0);
        EXPECT(gbc.c(),  0x77);
        EXPECT(gbc.d(),  0xe6);
        EXPECT(gbc.e(),  0x39);
        EXPECT(gbc.h(),  0x21);
        EXPECT(gbc.l(),  0xd5);
        EXPECT(gbc.sp(), 0x2e7d);
        EXPECT(gbc.pc(), 0xa5ee);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa5ec), 0xcb);
        EXPECT(gbc.readMem(0xa5ed), 0x4);
        // CB 04 021A
        gbc.setState(0x7789, 0x9820, 0x1470, 0x3b96, 0x711b, 0xbf6a, 0x0, 0x0);
        gbc.writeMem(0x7789, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x14);
        EXPECT(gbc.b(),  0x3b);
        EXPECT(gbc.c(),  0x96);
        EXPECT(gbc.d(),  0x71);
        EXPECT(gbc.e(),  0x1b);
        EXPECT(gbc.h(),  0x7f);
        EXPECT(gbc.l(),  0x6a);
        EXPECT(gbc.sp(), 0x9820);
        EXPECT(gbc.pc(), 0x778b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 021B
        gbc.setState(0xdf88, 0xc6af, 0x6f90, 0x64cd, 0xdfb4, 0x1dcc, 0x0, 0x0);
        gbc.writeMem(0xdf88, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x6f);
        EXPECT(gbc.b(),  0x64);
        EXPECT(gbc.c(),  0xcd);
        EXPECT(gbc.d(),  0xdf);
        EXPECT(gbc.e(),  0xb4);
        EXPECT(gbc.h(),  0x3a);
        EXPECT(gbc.l(),  0xcc);
        EXPECT(gbc.sp(), 0xc6af);
        EXPECT(gbc.pc(), 0xdf8a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdf88), 0xcb);
        EXPECT(gbc.readMem(0xdf89), 0x4);
        // CB 04 021C
        gbc.setState(0x5bd, 0xbd45, 0x86f0, 0xe526, 0x8474, 0xb543, 0x1, 0x1);
        gbc.writeMem(0x5bd, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x86);
        EXPECT(gbc.b(),  0xe5);
        EXPECT(gbc.c(),  0x26);
        EXPECT(gbc.d(),  0x84);
        EXPECT(gbc.e(),  0x74);
        EXPECT(gbc.h(),  0x6b);
        EXPECT(gbc.l(),  0x43);
        EXPECT(gbc.sp(), 0xbd45);
        EXPECT(gbc.pc(), 0x5bf);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 021D
        gbc.setState(0x7a59, 0xcdad, 0x75c0, 0xabd9, 0xcefb, 0xb67, 0x0, 0x0);
        gbc.writeMem(0x7a59, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x75);
        EXPECT(gbc.b(),  0xab);
        EXPECT(gbc.c(),  0xd9);
        EXPECT(gbc.d(),  0xce);
        EXPECT(gbc.e(),  0xfb);
        EXPECT(gbc.h(),  0x16);
        EXPECT(gbc.l(),  0x67);
        EXPECT(gbc.sp(), 0xcdad);
        EXPECT(gbc.pc(), 0x7a5b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 021E
        gbc.setState(0x5410, 0x6cfc, 0x22a0, 0xa466, 0x6fc4, 0xecd2, 0x1, 0x1);
        gbc.writeMem(0x5410, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x22);
        EXPECT(gbc.b(),  0xa4);
        EXPECT(gbc.c(),  0x66);
        EXPECT(gbc.d(),  0x6f);
        EXPECT(gbc.e(),  0xc4);
        EXPECT(gbc.h(),  0xd9);
        EXPECT(gbc.l(),  0xd2);
        EXPECT(gbc.sp(), 0x6cfc);
        EXPECT(gbc.pc(), 0x5412);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 021F
        gbc.setState(0x2715, 0xe59c, 0x9f90, 0x6569, 0x673f, 0x6b4a, 0x0, 0x0);
        gbc.writeMem(0x2715, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x9f);
        EXPECT(gbc.b(),  0x65);
        EXPECT(gbc.c(),  0x69);
        EXPECT(gbc.d(),  0x67);
        EXPECT(gbc.e(),  0x3f);
        EXPECT(gbc.h(),  0xd6);
        EXPECT(gbc.l(),  0x4a);
        EXPECT(gbc.sp(), 0xe59c);
        EXPECT(gbc.pc(), 0x2717);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0220
        gbc.setState(0x4459, 0x4ff2, 0x1350, 0x2302, 0xd13d, 0x23b, 0x1, 0x1);
        gbc.writeMem(0x4459, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x13);
        EXPECT(gbc.b(),  0x23);
        EXPECT(gbc.c(),  0x2);
        EXPECT(gbc.d(),  0xd1);
        EXPECT(gbc.e(),  0x3d);
        EXPECT(gbc.h(),  0x4);
        EXPECT(gbc.l(),  0x3b);
        EXPECT(gbc.sp(), 0x4ff2);
        EXPECT(gbc.pc(), 0x445b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0221
        gbc.setState(0xc6d2, 0x31c3, 0xe3e0, 0xe85a, 0xc084, 0x858e, 0x0, 0x1);
        gbc.writeMem(0xc6d2, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe3);
        EXPECT(gbc.b(),  0xe8);
        EXPECT(gbc.c(),  0x5a);
        EXPECT(gbc.d(),  0xc0);
        EXPECT(gbc.e(),  0x84);
        EXPECT(gbc.h(),  0xb);
        EXPECT(gbc.l(),  0x8e);
        EXPECT(gbc.sp(), 0x31c3);
        EXPECT(gbc.pc(), 0xc6d4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc6d2), 0xcb);
        EXPECT(gbc.readMem(0xc6d3), 0x4);
        // CB 04 0222
        gbc.setState(0xc541, 0xa499, 0x7090, 0xa75b, 0x7233, 0xe589, 0x1, 0x1);
        gbc.writeMem(0xc541, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x70);
        EXPECT(gbc.b(),  0xa7);
        EXPECT(gbc.c(),  0x5b);
        EXPECT(gbc.d(),  0x72);
        EXPECT(gbc.e(),  0x33);
        EXPECT(gbc.h(),  0xcb);
        EXPECT(gbc.l(),  0x89);
        EXPECT(gbc.sp(), 0xa499);
        EXPECT(gbc.pc(), 0xc543);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc541), 0xcb);
        EXPECT(gbc.readMem(0xc542), 0x4);
        // CB 04 0223
        gbc.setState(0x71b8, 0xa036, 0xdc10, 0xe6b, 0x61e2, 0xc51b, 0x0, 0x0);
        gbc.writeMem(0x71b8, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xdc);
        EXPECT(gbc.b(),  0xe);
        EXPECT(gbc.c(),  0x6b);
        EXPECT(gbc.d(),  0x61);
        EXPECT(gbc.e(),  0xe2);
        EXPECT(gbc.h(),  0x8b);
        EXPECT(gbc.l(),  0x1b);
        EXPECT(gbc.sp(), 0xa036);
        EXPECT(gbc.pc(), 0x71ba);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0224
        gbc.setState(0xd9f7, 0x7dd9, 0x9ff0, 0xa3f3, 0xb662, 0x81eb, 0x1, 0x1);
        gbc.writeMem(0xd9f7, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x9f);
        EXPECT(gbc.b(),  0xa3);
        EXPECT(gbc.c(),  0xf3);
        EXPECT(gbc.d(),  0xb6);
        EXPECT(gbc.e(),  0x62);
        EXPECT(gbc.h(),  0x3);
        EXPECT(gbc.l(),  0xeb);
        EXPECT(gbc.sp(), 0x7dd9);
        EXPECT(gbc.pc(), 0xd9f9);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd9f7), 0xcb);
        EXPECT(gbc.readMem(0xd9f8), 0x4);
        // CB 04 0225
        gbc.setState(0xc2de, 0xdba3, 0xfba0, 0x4acd, 0x5019, 0x5011, 0x1, 0x1);
        gbc.writeMem(0xc2de, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xfb);
        EXPECT(gbc.b(),  0x4a);
        EXPECT(gbc.c(),  0xcd);
        EXPECT(gbc.d(),  0x50);
        EXPECT(gbc.e(),  0x19);
        EXPECT(gbc.h(),  0xa0);
        EXPECT(gbc.l(),  0x11);
        EXPECT(gbc.sp(), 0xdba3);
        EXPECT(gbc.pc(), 0xc2e0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc2de), 0xcb);
        EXPECT(gbc.readMem(0xc2df), 0x4);
        // CB 04 0226
        gbc.setState(0xd0aa, 0x5fca, 0x6810, 0xab89, 0xf9a5, 0xfc2a, 0x0, 0x0);
        gbc.writeMem(0xd0aa, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x68);
        EXPECT(gbc.b(),  0xab);
        EXPECT(gbc.c(),  0x89);
        EXPECT(gbc.d(),  0xf9);
        EXPECT(gbc.e(),  0xa5);
        EXPECT(gbc.h(),  0xf9);
        EXPECT(gbc.l(),  0x2a);
        EXPECT(gbc.sp(), 0x5fca);
        EXPECT(gbc.pc(), 0xd0ac);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd0aa), 0xcb);
        EXPECT(gbc.readMem(0xd0ab), 0x4);
        // CB 04 0227
        gbc.setState(0x962e, 0x32ac, 0x74a0, 0x6689, 0x4ed4, 0x839d, 0x1, 0x0);
        gbc.writeMem(0x962e, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x74);
        EXPECT(gbc.b(),  0x66);
        EXPECT(gbc.c(),  0x89);
        EXPECT(gbc.d(),  0x4e);
        EXPECT(gbc.e(),  0xd4);
        EXPECT(gbc.h(),  0x7);
        EXPECT(gbc.l(),  0x9d);
        EXPECT(gbc.sp(), 0x32ac);
        EXPECT(gbc.pc(), 0x9630);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x962e), 0xcb);
        EXPECT(gbc.readMem(0x962f), 0x4);
        // CB 04 0228
        gbc.setState(0xa4d6, 0x3835, 0x510, 0xbf87, 0xfabd, 0x5ae, 0x1, 0x0);
        gbc.writeMem(0xa4d6, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x5);
        EXPECT(gbc.b(),  0xbf);
        EXPECT(gbc.c(),  0x87);
        EXPECT(gbc.d(),  0xfa);
        EXPECT(gbc.e(),  0xbd);
        EXPECT(gbc.h(),  0xa);
        EXPECT(gbc.l(),  0xae);
        EXPECT(gbc.sp(), 0x3835);
        EXPECT(gbc.pc(), 0xa4d8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa4d6), 0xcb);
        EXPECT(gbc.readMem(0xa4d7), 0x4);
        // CB 04 0229
        gbc.setState(0x4a14, 0xa5b2, 0x6050, 0xeda2, 0xd21e, 0x1ce1, 0x1, 0x1);
        gbc.writeMem(0x4a14, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x60);
        EXPECT(gbc.b(),  0xed);
        EXPECT(gbc.c(),  0xa2);
        EXPECT(gbc.d(),  0xd2);
        EXPECT(gbc.e(),  0x1e);
        EXPECT(gbc.h(),  0x38);
        EXPECT(gbc.l(),  0xe1);
        EXPECT(gbc.sp(), 0xa5b2);
        EXPECT(gbc.pc(), 0x4a16);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 022A
        gbc.setState(0xdd0e, 0xce20, 0x4350, 0x5aa1, 0x66e1, 0xa81, 0x1, 0x0);
        gbc.writeMem(0xdd0e, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x43);
        EXPECT(gbc.b(),  0x5a);
        EXPECT(gbc.c(),  0xa1);
        EXPECT(gbc.d(),  0x66);
        EXPECT(gbc.e(),  0xe1);
        EXPECT(gbc.h(),  0x14);
        EXPECT(gbc.l(),  0x81);
        EXPECT(gbc.sp(), 0xce20);
        EXPECT(gbc.pc(), 0xdd10);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdd0e), 0xcb);
        EXPECT(gbc.readMem(0xdd0f), 0x4);
        // CB 04 022B
        gbc.setState(0x3022, 0xdae0, 0xe40, 0x8030, 0x8ab0, 0x47b6, 0x0, 0x1);
        gbc.writeMem(0x3022, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe);
        EXPECT(gbc.b(),  0x80);
        EXPECT(gbc.c(),  0x30);
        EXPECT(gbc.d(),  0x8a);
        EXPECT(gbc.e(),  0xb0);
        EXPECT(gbc.h(),  0x8e);
        EXPECT(gbc.l(),  0xb6);
        EXPECT(gbc.sp(), 0xdae0);
        EXPECT(gbc.pc(), 0x3024);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 022C
        gbc.setState(0x7db6, 0x433f, 0xa9a0, 0x388c, 0x23ba, 0xa5ff, 0x1, 0x0);
        gbc.writeMem(0x7db6, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa9);
        EXPECT(gbc.b(),  0x38);
        EXPECT(gbc.c(),  0x8c);
        EXPECT(gbc.d(),  0x23);
        EXPECT(gbc.e(),  0xba);
        EXPECT(gbc.h(),  0x4b);
        EXPECT(gbc.l(),  0xff);
        EXPECT(gbc.sp(), 0x433f);
        EXPECT(gbc.pc(), 0x7db8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 022D
        gbc.setState(0x458a, 0xe5b1, 0xc380, 0x248e, 0xff67, 0xa344, 0x1, 0x0);
        gbc.writeMem(0x458a, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc3);
        EXPECT(gbc.b(),  0x24);
        EXPECT(gbc.c(),  0x8e);
        EXPECT(gbc.d(),  0xff);
        EXPECT(gbc.e(),  0x67);
        EXPECT(gbc.h(),  0x47);
        EXPECT(gbc.l(),  0x44);
        EXPECT(gbc.sp(), 0xe5b1);
        EXPECT(gbc.pc(), 0x458c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 022E
        gbc.setState(0x6335, 0x6533, 0x64b0, 0xb216, 0x7010, 0xfc33, 0x1, 0x1);
        gbc.writeMem(0x6335, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x64);
        EXPECT(gbc.b(),  0xb2);
        EXPECT(gbc.c(),  0x16);
        EXPECT(gbc.d(),  0x70);
        EXPECT(gbc.e(),  0x10);
        EXPECT(gbc.h(),  0xf9);
        EXPECT(gbc.l(),  0x33);
        EXPECT(gbc.sp(), 0x6533);
        EXPECT(gbc.pc(), 0x6337);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 022F
        gbc.setState(0x9be9, 0x6580, 0x9b40, 0x5589, 0xbda2, 0xbe5, 0x1, 0x0);
        gbc.writeMem(0x9be9, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x9b);
        EXPECT(gbc.b(),  0x55);
        EXPECT(gbc.c(),  0x89);
        EXPECT(gbc.d(),  0xbd);
        EXPECT(gbc.e(),  0xa2);
        EXPECT(gbc.h(),  0x16);
        EXPECT(gbc.l(),  0xe5);
        EXPECT(gbc.sp(), 0x6580);
        EXPECT(gbc.pc(), 0x9beb);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9be9), 0xcb);
        EXPECT(gbc.readMem(0x9bea), 0x4);
        // CB 04 0230
        gbc.setState(0x4c17, 0xcf9, 0x5a10, 0xd3f6, 0x501e, 0x936, 0x1, 0x1);
        gbc.writeMem(0x4c17, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x5a);
        EXPECT(gbc.b(),  0xd3);
        EXPECT(gbc.c(),  0xf6);
        EXPECT(gbc.d(),  0x50);
        EXPECT(gbc.e(),  0x1e);
        EXPECT(gbc.h(),  0x12);
        EXPECT(gbc.l(),  0x36);
        EXPECT(gbc.sp(), 0xcf9);
        EXPECT(gbc.pc(), 0x4c19);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0231
        gbc.setState(0x95cd, 0x2894, 0x5840, 0x4f5f, 0x3558, 0x761c, 0x1, 0x1);
        gbc.writeMem(0x95cd, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x58);
        EXPECT(gbc.b(),  0x4f);
        EXPECT(gbc.c(),  0x5f);
        EXPECT(gbc.d(),  0x35);
        EXPECT(gbc.e(),  0x58);
        EXPECT(gbc.h(),  0xec);
        EXPECT(gbc.l(),  0x1c);
        EXPECT(gbc.sp(), 0x2894);
        EXPECT(gbc.pc(), 0x95cf);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x95cd), 0xcb);
        EXPECT(gbc.readMem(0x95ce), 0x4);
        // CB 04 0232
        gbc.setState(0x9201, 0x6966, 0x1af0, 0x7773, 0xb26, 0xd116, 0x1, 0x1);
        gbc.writeMem(0x9201, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1a);
        EXPECT(gbc.b(),  0x77);
        EXPECT(gbc.c(),  0x73);
        EXPECT(gbc.d(),  0xb);
        EXPECT(gbc.e(),  0x26);
        EXPECT(gbc.h(),  0xa3);
        EXPECT(gbc.l(),  0x16);
        EXPECT(gbc.sp(), 0x6966);
        EXPECT(gbc.pc(), 0x9203);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9201), 0xcb);
        EXPECT(gbc.readMem(0x9202), 0x4);
        // CB 04 0233
        gbc.setState(0x55ff, 0x3ff9, 0x6e40, 0xcec1, 0x71f0, 0x1b0a, 0x0, 0x1);
        gbc.writeMem(0x55ff, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x6e);
        EXPECT(gbc.b(),  0xce);
        EXPECT(gbc.c(),  0xc1);
        EXPECT(gbc.d(),  0x71);
        EXPECT(gbc.e(),  0xf0);
        EXPECT(gbc.h(),  0x36);
        EXPECT(gbc.l(),  0xa);
        EXPECT(gbc.sp(), 0x3ff9);
        EXPECT(gbc.pc(), 0x5601);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0235
        gbc.setState(0x41e3, 0xe285, 0x6e00, 0xe33, 0x765a, 0xbf5e, 0x1, 0x0);
        gbc.writeMem(0x41e3, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x6e);
        EXPECT(gbc.b(),  0xe);
        EXPECT(gbc.c(),  0x33);
        EXPECT(gbc.d(),  0x76);
        EXPECT(gbc.e(),  0x5a);
        EXPECT(gbc.h(),  0x7f);
        EXPECT(gbc.l(),  0x5e);
        EXPECT(gbc.sp(), 0xe285);
        EXPECT(gbc.pc(), 0x41e5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0237
        gbc.setState(0xbe27, 0x2633, 0x92f0, 0x641d, 0xdfe9, 0x4a4, 0x1, 0x1);
        gbc.writeMem(0xbe27, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x92);
        EXPECT(gbc.b(),  0x64);
        EXPECT(gbc.c(),  0x1d);
        EXPECT(gbc.d(),  0xdf);
        EXPECT(gbc.e(),  0xe9);
        EXPECT(gbc.h(),  0x8);
        EXPECT(gbc.l(),  0xa4);
        EXPECT(gbc.sp(), 0x2633);
        EXPECT(gbc.pc(), 0xbe29);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbe27), 0xcb);
        EXPECT(gbc.readMem(0xbe28), 0x4);
        // CB 04 0238
        gbc.setState(0x4fde, 0xed76, 0x2850, 0x5e67, 0xf56d, 0xcd43, 0x0, 0x1);
        gbc.writeMem(0x4fde, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0x5e);
        EXPECT(gbc.c(),  0x67);
        EXPECT(gbc.d(),  0xf5);
        EXPECT(gbc.e(),  0x6d);
        EXPECT(gbc.h(),  0x9b);
        EXPECT(gbc.l(),  0x43);
        EXPECT(gbc.sp(), 0xed76);
        EXPECT(gbc.pc(), 0x4fe0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0239
        gbc.setState(0xaf3f, 0x225e, 0x6e40, 0x34e8, 0xd773, 0xcf59, 0x1, 0x1);
        gbc.writeMem(0xaf3f, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x6e);
        EXPECT(gbc.b(),  0x34);
        EXPECT(gbc.c(),  0xe8);
        EXPECT(gbc.d(),  0xd7);
        EXPECT(gbc.e(),  0x73);
        EXPECT(gbc.h(),  0x9f);
        EXPECT(gbc.l(),  0x59);
        EXPECT(gbc.sp(), 0x225e);
        EXPECT(gbc.pc(), 0xaf41);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xaf3f), 0xcb);
        EXPECT(gbc.readMem(0xaf40), 0x4);
        // CB 04 023B
        gbc.setState(0x25f2, 0x9c72, 0xeda0, 0x48e8, 0xfeb2, 0x36af, 0x1, 0x1);
        gbc.writeMem(0x25f2, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xed);
        EXPECT(gbc.b(),  0x48);
        EXPECT(gbc.c(),  0xe8);
        EXPECT(gbc.d(),  0xfe);
        EXPECT(gbc.e(),  0xb2);
        EXPECT(gbc.h(),  0x6c);
        EXPECT(gbc.l(),  0xaf);
        EXPECT(gbc.sp(), 0x9c72);
        EXPECT(gbc.pc(), 0x25f4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 023C
        gbc.setState(0x7861, 0x83a3, 0x3f70, 0x4911, 0xd40a, 0x9c7f, 0x0, 0x1);
        gbc.writeMem(0x7861, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3f);
        EXPECT(gbc.b(),  0x49);
        EXPECT(gbc.c(),  0x11);
        EXPECT(gbc.d(),  0xd4);
        EXPECT(gbc.e(),  0xa);
        EXPECT(gbc.h(),  0x39);
        EXPECT(gbc.l(),  0x7f);
        EXPECT(gbc.sp(), 0x83a3);
        EXPECT(gbc.pc(), 0x7863);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 023D
        gbc.setState(0xc0be, 0xa24f, 0xec10, 0x4094, 0x4cf1, 0x4234, 0x0, 0x0);
        gbc.writeMem(0xc0be, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xec);
        EXPECT(gbc.b(),  0x40);
        EXPECT(gbc.c(),  0x94);
        EXPECT(gbc.d(),  0x4c);
        EXPECT(gbc.e(),  0xf1);
        EXPECT(gbc.h(),  0x84);
        EXPECT(gbc.l(),  0x34);
        EXPECT(gbc.sp(), 0xa24f);
        EXPECT(gbc.pc(), 0xc0c0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc0be), 0xcb);
        EXPECT(gbc.readMem(0xc0bf), 0x4);
        // CB 04 023E
        gbc.setState(0xc135, 0x369a, 0x2580, 0xc8e4, 0x9303, 0x198e, 0x1, 0x0);
        gbc.writeMem(0xc135, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x25);
        EXPECT(gbc.b(),  0xc8);
        EXPECT(gbc.c(),  0xe4);
        EXPECT(gbc.d(),  0x93);
        EXPECT(gbc.e(),  0x3);
        EXPECT(gbc.h(),  0x32);
        EXPECT(gbc.l(),  0x8e);
        EXPECT(gbc.sp(), 0x369a);
        EXPECT(gbc.pc(), 0xc137);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc135), 0xcb);
        EXPECT(gbc.readMem(0xc136), 0x4);
        // CB 04 023F
        gbc.setState(0x5def, 0x2b9a, 0x45d0, 0x84d6, 0xb813, 0x790b, 0x0, 0x0);
        gbc.writeMem(0x5def, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x45);
        EXPECT(gbc.b(),  0x84);
        EXPECT(gbc.c(),  0xd6);
        EXPECT(gbc.d(),  0xb8);
        EXPECT(gbc.e(),  0x13);
        EXPECT(gbc.h(),  0xf2);
        EXPECT(gbc.l(),  0xb);
        EXPECT(gbc.sp(), 0x2b9a);
        EXPECT(gbc.pc(), 0x5df1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0240
        gbc.setState(0xbe6f, 0x20ec, 0x3860, 0xe2bd, 0x2e6, 0x3cdb, 0x0, 0x0);
        gbc.writeMem(0xbe6f, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x38);
        EXPECT(gbc.b(),  0xe2);
        EXPECT(gbc.c(),  0xbd);
        EXPECT(gbc.d(),  0x2);
        EXPECT(gbc.e(),  0xe6);
        EXPECT(gbc.h(),  0x78);
        EXPECT(gbc.l(),  0xdb);
        EXPECT(gbc.sp(), 0x20ec);
        EXPECT(gbc.pc(), 0xbe71);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbe6f), 0xcb);
        EXPECT(gbc.readMem(0xbe70), 0x4);
        // CB 04 0241
        gbc.setState(0x93ff, 0xd2bd, 0xe170, 0x853c, 0xba4f, 0x4406, 0x0, 0x1);
        gbc.writeMem(0x93ff, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe1);
        EXPECT(gbc.b(),  0x85);
        EXPECT(gbc.c(),  0x3c);
        EXPECT(gbc.d(),  0xba);
        EXPECT(gbc.e(),  0x4f);
        EXPECT(gbc.h(),  0x88);
        EXPECT(gbc.l(),  0x6);
        EXPECT(gbc.sp(), 0xd2bd);
        EXPECT(gbc.pc(), 0x9401);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x93ff), 0xcb);
        EXPECT(gbc.readMem(0x9400), 0x4);
        // CB 04 0242
        gbc.setState(0x177a, 0xa2a1, 0x6c20, 0x2b0a, 0x3d66, 0x6ea4, 0x1, 0x1);
        gbc.writeMem(0x177a, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x6c);
        EXPECT(gbc.b(),  0x2b);
        EXPECT(gbc.c(),  0xa);
        EXPECT(gbc.d(),  0x3d);
        EXPECT(gbc.e(),  0x66);
        EXPECT(gbc.h(),  0xdc);
        EXPECT(gbc.l(),  0xa4);
        EXPECT(gbc.sp(), 0xa2a1);
        EXPECT(gbc.pc(), 0x177c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0243
        gbc.setState(0xdbf4, 0x45b4, 0xf4e0, 0x2f9, 0x5bfa, 0x6881, 0x0, 0x0);
        gbc.writeMem(0xdbf4, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf4);
        EXPECT(gbc.b(),  0x2);
        EXPECT(gbc.c(),  0xf9);
        EXPECT(gbc.d(),  0x5b);
        EXPECT(gbc.e(),  0xfa);
        EXPECT(gbc.h(),  0xd0);
        EXPECT(gbc.l(),  0x81);
        EXPECT(gbc.sp(), 0x45b4);
        EXPECT(gbc.pc(), 0xdbf6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdbf4), 0xcb);
        EXPECT(gbc.readMem(0xdbf5), 0x4);
        // CB 04 0244
        gbc.setState(0x7ea1, 0x2a54, 0xae70, 0x9880, 0x3739, 0x4111, 0x0, 0x1);
        gbc.writeMem(0x7ea1, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xae);
        EXPECT(gbc.b(),  0x98);
        EXPECT(gbc.c(),  0x80);
        EXPECT(gbc.d(),  0x37);
        EXPECT(gbc.e(),  0x39);
        EXPECT(gbc.h(),  0x82);
        EXPECT(gbc.l(),  0x11);
        EXPECT(gbc.sp(), 0x2a54);
        EXPECT(gbc.pc(), 0x7ea3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0245
        gbc.setState(0x700c, 0xa2c9, 0xa170, 0xf48f, 0x78c9, 0x387b, 0x0, 0x1);
        gbc.writeMem(0x700c, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa1);
        EXPECT(gbc.b(),  0xf4);
        EXPECT(gbc.c(),  0x8f);
        EXPECT(gbc.d(),  0x78);
        EXPECT(gbc.e(),  0xc9);
        EXPECT(gbc.h(),  0x70);
        EXPECT(gbc.l(),  0x7b);
        EXPECT(gbc.sp(), 0xa2c9);
        EXPECT(gbc.pc(), 0x700e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0246
        gbc.setState(0x5f11, 0xd48d, 0xce90, 0xb282, 0xc939, 0xee01, 0x1, 0x1);
        gbc.writeMem(0x5f11, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xce);
        EXPECT(gbc.b(),  0xb2);
        EXPECT(gbc.c(),  0x82);
        EXPECT(gbc.d(),  0xc9);
        EXPECT(gbc.e(),  0x39);
        EXPECT(gbc.h(),  0xdd);
        EXPECT(gbc.l(),  0x1);
        EXPECT(gbc.sp(), 0xd48d);
        EXPECT(gbc.pc(), 0x5f13);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0247
        gbc.setState(0xb0cf, 0x898e, 0x2690, 0xae44, 0xe9ed, 0xc40c, 0x1, 0x1);
        gbc.writeMem(0xb0cf, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x26);
        EXPECT(gbc.b(),  0xae);
        EXPECT(gbc.c(),  0x44);
        EXPECT(gbc.d(),  0xe9);
        EXPECT(gbc.e(),  0xed);
        EXPECT(gbc.h(),  0x89);
        EXPECT(gbc.l(),  0xc);
        EXPECT(gbc.sp(), 0x898e);
        EXPECT(gbc.pc(), 0xb0d1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb0cf), 0xcb);
        EXPECT(gbc.readMem(0xb0d0), 0x4);
        // CB 04 0248
        gbc.setState(0x6a12, 0xe40f, 0xbe60, 0xd378, 0xfee4, 0xaaad, 0x1, 0x0);
        gbc.writeMem(0x6a12, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xbe);
        EXPECT(gbc.b(),  0xd3);
        EXPECT(gbc.c(),  0x78);
        EXPECT(gbc.d(),  0xfe);
        EXPECT(gbc.e(),  0xe4);
        EXPECT(gbc.h(),  0x55);
        EXPECT(gbc.l(),  0xad);
        EXPECT(gbc.sp(), 0xe40f);
        EXPECT(gbc.pc(), 0x6a14);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0249
        gbc.setState(0x83d4, 0xbd3b, 0x5a40, 0x446c, 0x937b, 0xcd30, 0x0, 0x1);
        gbc.writeMem(0x83d4, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x5a);
        EXPECT(gbc.b(),  0x44);
        EXPECT(gbc.c(),  0x6c);
        EXPECT(gbc.d(),  0x93);
        EXPECT(gbc.e(),  0x7b);
        EXPECT(gbc.h(),  0x9b);
        EXPECT(gbc.l(),  0x30);
        EXPECT(gbc.sp(), 0xbd3b);
        EXPECT(gbc.pc(), 0x83d6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x83d4), 0xcb);
        EXPECT(gbc.readMem(0x83d5), 0x4);
        // CB 04 024A
        gbc.setState(0x2a9, 0x1136, 0xc4d0, 0x617, 0x7839, 0xb017, 0x0, 0x0);
        gbc.writeMem(0x2a9, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc4);
        EXPECT(gbc.b(),  0x6);
        EXPECT(gbc.c(),  0x17);
        EXPECT(gbc.d(),  0x78);
        EXPECT(gbc.e(),  0x39);
        EXPECT(gbc.h(),  0x61);
        EXPECT(gbc.l(),  0x17);
        EXPECT(gbc.sp(), 0x1136);
        EXPECT(gbc.pc(), 0x2ab);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 024C
        gbc.setState(0xce99, 0xdde3, 0x9000, 0xa2ca, 0xc996, 0x2104, 0x1, 0x1);
        gbc.writeMem(0xce99, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x90);
        EXPECT(gbc.b(),  0xa2);
        EXPECT(gbc.c(),  0xca);
        EXPECT(gbc.d(),  0xc9);
        EXPECT(gbc.e(),  0x96);
        EXPECT(gbc.h(),  0x42);
        EXPECT(gbc.l(),  0x4);
        EXPECT(gbc.sp(), 0xdde3);
        EXPECT(gbc.pc(), 0xce9b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xce99), 0xcb);
        EXPECT(gbc.readMem(0xce9a), 0x4);
        // CB 04 024F
        gbc.setState(0xc9aa, 0x60aa, 0x7c70, 0xcbb1, 0x64cf, 0x70c1, 0x0, 0x1);
        gbc.writeMem(0xc9aa, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x7c);
        EXPECT(gbc.b(),  0xcb);
        EXPECT(gbc.c(),  0xb1);
        EXPECT(gbc.d(),  0x64);
        EXPECT(gbc.e(),  0xcf);
        EXPECT(gbc.h(),  0xe0);
        EXPECT(gbc.l(),  0xc1);
        EXPECT(gbc.sp(), 0x60aa);
        EXPECT(gbc.pc(), 0xc9ac);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc9aa), 0xcb);
        EXPECT(gbc.readMem(0xc9ab), 0x4);
        // CB 04 0250
        gbc.setState(0x1865, 0x6966, 0x9190, 0x7c88, 0x5848, 0xa318, 0x0, 0x0);
        gbc.writeMem(0x1865, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x91);
        EXPECT(gbc.b(),  0x7c);
        EXPECT(gbc.c(),  0x88);
        EXPECT(gbc.d(),  0x58);
        EXPECT(gbc.e(),  0x48);
        EXPECT(gbc.h(),  0x47);
        EXPECT(gbc.l(),  0x18);
        EXPECT(gbc.sp(), 0x6966);
        EXPECT(gbc.pc(), 0x1867);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0251
        gbc.setState(0xe416, 0xa38d, 0x7060, 0x2bf8, 0xcc1e, 0x7c1f, 0x1, 0x0);
        gbc.writeMem(0xe416, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x70);
        EXPECT(gbc.b(),  0x2b);
        EXPECT(gbc.c(),  0xf8);
        EXPECT(gbc.d(),  0xcc);
        EXPECT(gbc.e(),  0x1e);
        EXPECT(gbc.h(),  0xf8);
        EXPECT(gbc.l(),  0x1f);
        EXPECT(gbc.sp(), 0xa38d);
        EXPECT(gbc.pc(), 0xe418);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe416), 0xcb);
        EXPECT(gbc.readMem(0xe417), 0x4);
        // CB 04 0252
        gbc.setState(0xc112, 0xfefd, 0xeaf0, 0x9fa7, 0xff34, 0x9f75, 0x0, 0x0);
        gbc.writeMem(0xc112, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xea);
        EXPECT(gbc.b(),  0x9f);
        EXPECT(gbc.c(),  0xa7);
        EXPECT(gbc.d(),  0xff);
        EXPECT(gbc.e(),  0x34);
        EXPECT(gbc.h(),  0x3f);
        EXPECT(gbc.l(),  0x75);
        EXPECT(gbc.sp(), 0xfefd);
        EXPECT(gbc.pc(), 0xc114);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc112), 0xcb);
        EXPECT(gbc.readMem(0xc113), 0x4);
        // CB 04 0253
        gbc.setState(0x83a9, 0xda6, 0xa970, 0x8750, 0xb061, 0x4dd9, 0x0, 0x0);
        gbc.writeMem(0x83a9, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa9);
        EXPECT(gbc.b(),  0x87);
        EXPECT(gbc.c(),  0x50);
        EXPECT(gbc.d(),  0xb0);
        EXPECT(gbc.e(),  0x61);
        EXPECT(gbc.h(),  0x9a);
        EXPECT(gbc.l(),  0xd9);
        EXPECT(gbc.sp(), 0xda6);
        EXPECT(gbc.pc(), 0x83ab);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x83a9), 0xcb);
        EXPECT(gbc.readMem(0x83aa), 0x4);
        // CB 04 0254
        gbc.setState(0x19c4, 0xd4e0, 0xb70, 0xf319, 0xd3ae, 0x91d3, 0x1, 0x1);
        gbc.writeMem(0x19c4, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb);
        EXPECT(gbc.b(),  0xf3);
        EXPECT(gbc.c(),  0x19);
        EXPECT(gbc.d(),  0xd3);
        EXPECT(gbc.e(),  0xae);
        EXPECT(gbc.h(),  0x23);
        EXPECT(gbc.l(),  0xd3);
        EXPECT(gbc.sp(), 0xd4e0);
        EXPECT(gbc.pc(), 0x19c6);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0255
        gbc.setState(0x5761, 0xb21, 0xad50, 0x693, 0xba7f, 0xe7fc, 0x1, 0x1);
        gbc.writeMem(0x5761, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xad);
        EXPECT(gbc.b(),  0x6);
        EXPECT(gbc.c(),  0x93);
        EXPECT(gbc.d(),  0xba);
        EXPECT(gbc.e(),  0x7f);
        EXPECT(gbc.h(),  0xcf);
        EXPECT(gbc.l(),  0xfc);
        EXPECT(gbc.sp(), 0xb21);
        EXPECT(gbc.pc(), 0x5763);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0256
        gbc.setState(0x6f10, 0xb4b9, 0x8750, 0xb7e1, 0xc045, 0xa57b, 0x1, 0x0);
        gbc.writeMem(0x6f10, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x87);
        EXPECT(gbc.b(),  0xb7);
        EXPECT(gbc.c(),  0xe1);
        EXPECT(gbc.d(),  0xc0);
        EXPECT(gbc.e(),  0x45);
        EXPECT(gbc.h(),  0x4b);
        EXPECT(gbc.l(),  0x7b);
        EXPECT(gbc.sp(), 0xb4b9);
        EXPECT(gbc.pc(), 0x6f12);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0257
        gbc.setState(0x3b7a, 0xfb96, 0xab70, 0x4d2d, 0xe118, 0x455b, 0x0, 0x0);
        gbc.writeMem(0x3b7a, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xab);
        EXPECT(gbc.b(),  0x4d);
        EXPECT(gbc.c(),  0x2d);
        EXPECT(gbc.d(),  0xe1);
        EXPECT(gbc.e(),  0x18);
        EXPECT(gbc.h(),  0x8a);
        EXPECT(gbc.l(),  0x5b);
        EXPECT(gbc.sp(), 0xfb96);
        EXPECT(gbc.pc(), 0x3b7c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0258
        gbc.setState(0x380f, 0x8533, 0x1f00, 0x12b6, 0x22ce, 0x87b2, 0x0, 0x1);
        gbc.writeMem(0x380f, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1f);
        EXPECT(gbc.b(),  0x12);
        EXPECT(gbc.c(),  0xb6);
        EXPECT(gbc.d(),  0x22);
        EXPECT(gbc.e(),  0xce);
        EXPECT(gbc.h(),  0xf);
        EXPECT(gbc.l(),  0xb2);
        EXPECT(gbc.sp(), 0x8533);
        EXPECT(gbc.pc(), 0x3811);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0259
        gbc.setState(0x5e4, 0x7dbb, 0x67f0, 0x481b, 0x9f40, 0x5c5b, 0x1, 0x1);
        gbc.writeMem(0x5e4, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x67);
        EXPECT(gbc.b(),  0x48);
        EXPECT(gbc.c(),  0x1b);
        EXPECT(gbc.d(),  0x9f);
        EXPECT(gbc.e(),  0x40);
        EXPECT(gbc.h(),  0xb8);
        EXPECT(gbc.l(),  0x5b);
        EXPECT(gbc.sp(), 0x7dbb);
        EXPECT(gbc.pc(), 0x5e6);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 025A
        gbc.setState(0xe3e, 0x723, 0x33b0, 0xb9c2, 0xfa0, 0x1eb2, 0x1, 0x1);
        gbc.writeMem(0xe3e, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x33);
        EXPECT(gbc.b(),  0xb9);
        EXPECT(gbc.c(),  0xc2);
        EXPECT(gbc.d(),  0xf);
        EXPECT(gbc.e(),  0xa0);
        EXPECT(gbc.h(),  0x3c);
        EXPECT(gbc.l(),  0xb2);
        EXPECT(gbc.sp(), 0x723);
        EXPECT(gbc.pc(), 0xe40);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 025B
        gbc.setState(0x94c1, 0xf382, 0x53c0, 0xf32c, 0x1312, 0xdbb5, 0x1, 0x0);
        gbc.writeMem(0x94c1, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x53);
        EXPECT(gbc.b(),  0xf3);
        EXPECT(gbc.c(),  0x2c);
        EXPECT(gbc.d(),  0x13);
        EXPECT(gbc.e(),  0x12);
        EXPECT(gbc.h(),  0xb7);
        EXPECT(gbc.l(),  0xb5);
        EXPECT(gbc.sp(), 0xf382);
        EXPECT(gbc.pc(), 0x94c3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x94c1), 0xcb);
        EXPECT(gbc.readMem(0x94c2), 0x4);
        // CB 04 025C
        gbc.setState(0x8d0d, 0xa65c, 0xdba0, 0xf175, 0xc744, 0xd125, 0x1, 0x1);
        gbc.writeMem(0x8d0d, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xdb);
        EXPECT(gbc.b(),  0xf1);
        EXPECT(gbc.c(),  0x75);
        EXPECT(gbc.d(),  0xc7);
        EXPECT(gbc.e(),  0x44);
        EXPECT(gbc.h(),  0xa3);
        EXPECT(gbc.l(),  0x25);
        EXPECT(gbc.sp(), 0xa65c);
        EXPECT(gbc.pc(), 0x8d0f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8d0d), 0xcb);
        EXPECT(gbc.readMem(0x8d0e), 0x4);
        // CB 04 025D
        gbc.setState(0x3307, 0x7ee3, 0x3a30, 0x35fb, 0x68e0, 0xd6a6, 0x1, 0x1);
        gbc.writeMem(0x3307, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3a);
        EXPECT(gbc.b(),  0x35);
        EXPECT(gbc.c(),  0xfb);
        EXPECT(gbc.d(),  0x68);
        EXPECT(gbc.e(),  0xe0);
        EXPECT(gbc.h(),  0xad);
        EXPECT(gbc.l(),  0xa6);
        EXPECT(gbc.sp(), 0x7ee3);
        EXPECT(gbc.pc(), 0x3309);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 025E
        gbc.setState(0x6589, 0xc0ea, 0x2c50, 0x6ce2, 0xd9d7, 0xf7d7, 0x1, 0x0);
        gbc.writeMem(0x6589, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2c);
        EXPECT(gbc.b(),  0x6c);
        EXPECT(gbc.c(),  0xe2);
        EXPECT(gbc.d(),  0xd9);
        EXPECT(gbc.e(),  0xd7);
        EXPECT(gbc.h(),  0xef);
        EXPECT(gbc.l(),  0xd7);
        EXPECT(gbc.sp(), 0xc0ea);
        EXPECT(gbc.pc(), 0x658b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 025F
        gbc.setState(0x225c, 0xdc9b, 0xe540, 0x5761, 0xbb2d, 0x2618, 0x1, 0x1);
        gbc.writeMem(0x225c, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe5);
        EXPECT(gbc.b(),  0x57);
        EXPECT(gbc.c(),  0x61);
        EXPECT(gbc.d(),  0xbb);
        EXPECT(gbc.e(),  0x2d);
        EXPECT(gbc.h(),  0x4c);
        EXPECT(gbc.l(),  0x18);
        EXPECT(gbc.sp(), 0xdc9b);
        EXPECT(gbc.pc(), 0x225e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0260
        gbc.setState(0x823f, 0x856d, 0x64f0, 0x2e62, 0xb2ae, 0x7987, 0x0, 0x1);
        gbc.writeMem(0x823f, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x64);
        EXPECT(gbc.b(),  0x2e);
        EXPECT(gbc.c(),  0x62);
        EXPECT(gbc.d(),  0xb2);
        EXPECT(gbc.e(),  0xae);
        EXPECT(gbc.h(),  0xf2);
        EXPECT(gbc.l(),  0x87);
        EXPECT(gbc.sp(), 0x856d);
        EXPECT(gbc.pc(), 0x8241);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x823f), 0xcb);
        EXPECT(gbc.readMem(0x8240), 0x4);
        // CB 04 0261
        gbc.setState(0x31c2, 0x7273, 0xd7c0, 0xb6f2, 0xe25a, 0xfe3c, 0x1, 0x0);
        gbc.writeMem(0x31c2, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd7);
        EXPECT(gbc.b(),  0xb6);
        EXPECT(gbc.c(),  0xf2);
        EXPECT(gbc.d(),  0xe2);
        EXPECT(gbc.e(),  0x5a);
        EXPECT(gbc.h(),  0xfd);
        EXPECT(gbc.l(),  0x3c);
        EXPECT(gbc.sp(), 0x7273);
        EXPECT(gbc.pc(), 0x31c4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0262
        gbc.setState(0x27c4, 0x3494, 0xd40, 0x2c8d, 0x3b70, 0x2dcd, 0x0, 0x1);
        gbc.writeMem(0x27c4, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd);
        EXPECT(gbc.b(),  0x2c);
        EXPECT(gbc.c(),  0x8d);
        EXPECT(gbc.d(),  0x3b);
        EXPECT(gbc.e(),  0x70);
        EXPECT(gbc.h(),  0x5a);
        EXPECT(gbc.l(),  0xcd);
        EXPECT(gbc.sp(), 0x3494);
        EXPECT(gbc.pc(), 0x27c6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0263
        gbc.setState(0x7a9c, 0xaa79, 0x6a0, 0xb1e, 0xbbdd, 0x1e3a, 0x0, 0x0);
        gbc.writeMem(0x7a9c, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x6);
        EXPECT(gbc.b(),  0xb);
        EXPECT(gbc.c(),  0x1e);
        EXPECT(gbc.d(),  0xbb);
        EXPECT(gbc.e(),  0xdd);
        EXPECT(gbc.h(),  0x3c);
        EXPECT(gbc.l(),  0x3a);
        EXPECT(gbc.sp(), 0xaa79);
        EXPECT(gbc.pc(), 0x7a9e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0264
        gbc.setState(0xd354, 0x743, 0xb3f0, 0x17e3, 0x2a35, 0xf2aa, 0x1, 0x0);
        gbc.writeMem(0xd354, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb3);
        EXPECT(gbc.b(),  0x17);
        EXPECT(gbc.c(),  0xe3);
        EXPECT(gbc.d(),  0x2a);
        EXPECT(gbc.e(),  0x35);
        EXPECT(gbc.h(),  0xe5);
        EXPECT(gbc.l(),  0xaa);
        EXPECT(gbc.sp(), 0x743);
        EXPECT(gbc.pc(), 0xd356);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd354), 0xcb);
        EXPECT(gbc.readMem(0xd355), 0x4);
        // CB 04 0265
        gbc.setState(0x2ac6, 0x6cdd, 0x13b0, 0x6a65, 0xf965, 0xef6e, 0x0, 0x0);
        gbc.writeMem(0x2ac6, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x13);
        EXPECT(gbc.b(),  0x6a);
        EXPECT(gbc.c(),  0x65);
        EXPECT(gbc.d(),  0xf9);
        EXPECT(gbc.e(),  0x65);
        EXPECT(gbc.h(),  0xdf);
        EXPECT(gbc.l(),  0x6e);
        EXPECT(gbc.sp(), 0x6cdd);
        EXPECT(gbc.pc(), 0x2ac8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0266
        gbc.setState(0x1290, 0x1a1, 0x73b0, 0xd8c4, 0x75c0, 0x467d, 0x1, 0x0);
        gbc.writeMem(0x1290, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x73);
        EXPECT(gbc.b(),  0xd8);
        EXPECT(gbc.c(),  0xc4);
        EXPECT(gbc.d(),  0x75);
        EXPECT(gbc.e(),  0xc0);
        EXPECT(gbc.h(),  0x8c);
        EXPECT(gbc.l(),  0x7d);
        EXPECT(gbc.sp(), 0x1a1);
        EXPECT(gbc.pc(), 0x1292);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0267
        gbc.setState(0x8e9d, 0xd8ff, 0xecf0, 0x8fef, 0x26f, 0x6dde, 0x1, 0x0);
        gbc.writeMem(0x8e9d, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xec);
        EXPECT(gbc.b(),  0x8f);
        EXPECT(gbc.c(),  0xef);
        EXPECT(gbc.d(),  0x2);
        EXPECT(gbc.e(),  0x6f);
        EXPECT(gbc.h(),  0xda);
        EXPECT(gbc.l(),  0xde);
        EXPECT(gbc.sp(), 0xd8ff);
        EXPECT(gbc.pc(), 0x8e9f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8e9d), 0xcb);
        EXPECT(gbc.readMem(0x8e9e), 0x4);
        // CB 04 0268
        gbc.setState(0x2de6, 0xe920, 0x3a70, 0x9c77, 0x8a74, 0x883a, 0x0, 0x1);
        gbc.writeMem(0x2de6, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3a);
        EXPECT(gbc.b(),  0x9c);
        EXPECT(gbc.c(),  0x77);
        EXPECT(gbc.d(),  0x8a);
        EXPECT(gbc.e(),  0x74);
        EXPECT(gbc.h(),  0x11);
        EXPECT(gbc.l(),  0x3a);
        EXPECT(gbc.sp(), 0xe920);
        EXPECT(gbc.pc(), 0x2de8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0269
        gbc.setState(0xc72b, 0xe0f8, 0x4520, 0xccc1, 0xa129, 0xeca9, 0x0, 0x0);
        gbc.writeMem(0xc72b, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x45);
        EXPECT(gbc.b(),  0xcc);
        EXPECT(gbc.c(),  0xc1);
        EXPECT(gbc.d(),  0xa1);
        EXPECT(gbc.e(),  0x29);
        EXPECT(gbc.h(),  0xd9);
        EXPECT(gbc.l(),  0xa9);
        EXPECT(gbc.sp(), 0xe0f8);
        EXPECT(gbc.pc(), 0xc72d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc72b), 0xcb);
        EXPECT(gbc.readMem(0xc72c), 0x4);
        // CB 04 026A
        gbc.setState(0xcfc0, 0x26ed, 0x4130, 0x49c4, 0xf2bd, 0x8a13, 0x0, 0x1);
        gbc.writeMem(0xcfc0, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x41);
        EXPECT(gbc.b(),  0x49);
        EXPECT(gbc.c(),  0xc4);
        EXPECT(gbc.d(),  0xf2);
        EXPECT(gbc.e(),  0xbd);
        EXPECT(gbc.h(),  0x15);
        EXPECT(gbc.l(),  0x13);
        EXPECT(gbc.sp(), 0x26ed);
        EXPECT(gbc.pc(), 0xcfc2);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcfc0), 0xcb);
        EXPECT(gbc.readMem(0xcfc1), 0x4);
        // CB 04 026B
        gbc.setState(0x145b, 0xff26, 0x1950, 0xd3c1, 0x7909, 0x31c7, 0x1, 0x1);
        gbc.writeMem(0x145b, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x19);
        EXPECT(gbc.b(),  0xd3);
        EXPECT(gbc.c(),  0xc1);
        EXPECT(gbc.d(),  0x79);
        EXPECT(gbc.e(),  0x9);
        EXPECT(gbc.h(),  0x62);
        EXPECT(gbc.l(),  0xc7);
        EXPECT(gbc.sp(), 0xff26);
        EXPECT(gbc.pc(), 0x145d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 026D
        gbc.setState(0xda19, 0x654, 0x1860, 0xfdec, 0x3c01, 0x5133, 0x0, 0x1);
        gbc.writeMem(0xda19, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x18);
        EXPECT(gbc.b(),  0xfd);
        EXPECT(gbc.c(),  0xec);
        EXPECT(gbc.d(),  0x3c);
        EXPECT(gbc.e(),  0x1);
        EXPECT(gbc.h(),  0xa2);
        EXPECT(gbc.l(),  0x33);
        EXPECT(gbc.sp(), 0x654);
        EXPECT(gbc.pc(), 0xda1b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xda19), 0xcb);
        EXPECT(gbc.readMem(0xda1a), 0x4);
        // CB 04 026E
        gbc.setState(0xd70a, 0x8d3c, 0xc360, 0x8f88, 0xf692, 0xe76e, 0x1, 0x1);
        gbc.writeMem(0xd70a, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc3);
        EXPECT(gbc.b(),  0x8f);
        EXPECT(gbc.c(),  0x88);
        EXPECT(gbc.d(),  0xf6);
        EXPECT(gbc.e(),  0x92);
        EXPECT(gbc.h(),  0xcf);
        EXPECT(gbc.l(),  0x6e);
        EXPECT(gbc.sp(), 0x8d3c);
        EXPECT(gbc.pc(), 0xd70c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd70a), 0xcb);
        EXPECT(gbc.readMem(0xd70b), 0x4);
        // CB 04 026F
        gbc.setState(0x6926, 0x2e7e, 0x4b40, 0xf7c1, 0x93c5, 0x8615, 0x0, 0x1);
        gbc.writeMem(0x6926, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4b);
        EXPECT(gbc.b(),  0xf7);
        EXPECT(gbc.c(),  0xc1);
        EXPECT(gbc.d(),  0x93);
        EXPECT(gbc.e(),  0xc5);
        EXPECT(gbc.h(),  0xd);
        EXPECT(gbc.l(),  0x15);
        EXPECT(gbc.sp(), 0x2e7e);
        EXPECT(gbc.pc(), 0x6928);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0270
        gbc.setState(0x828c, 0xce01, 0x2e20, 0x69df, 0x3b8a, 0x73d8, 0x0, 0x1);
        gbc.writeMem(0x828c, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2e);
        EXPECT(gbc.b(),  0x69);
        EXPECT(gbc.c(),  0xdf);
        EXPECT(gbc.d(),  0x3b);
        EXPECT(gbc.e(),  0x8a);
        EXPECT(gbc.h(),  0xe6);
        EXPECT(gbc.l(),  0xd8);
        EXPECT(gbc.sp(), 0xce01);
        EXPECT(gbc.pc(), 0x828e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x828c), 0xcb);
        EXPECT(gbc.readMem(0x828d), 0x4);
        // CB 04 0271
        gbc.setState(0xea86, 0xcfce, 0xee70, 0x7125, 0x683d, 0xc05c, 0x0, 0x0);
        gbc.writeMem(0xea86, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xee);
        EXPECT(gbc.b(),  0x71);
        EXPECT(gbc.c(),  0x25);
        EXPECT(gbc.d(),  0x68);
        EXPECT(gbc.e(),  0x3d);
        EXPECT(gbc.h(),  0x81);
        EXPECT(gbc.l(),  0x5c);
        EXPECT(gbc.sp(), 0xcfce);
        EXPECT(gbc.pc(), 0xea88);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xea86), 0xcb);
        EXPECT(gbc.readMem(0xea87), 0x4);
        // CB 04 0272
        gbc.setState(0x1d19, 0xd7ed, 0xae40, 0x117f, 0x61a0, 0xc98d, 0x0, 0x1);
        gbc.writeMem(0x1d19, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xae);
        EXPECT(gbc.b(),  0x11);
        EXPECT(gbc.c(),  0x7f);
        EXPECT(gbc.d(),  0x61);
        EXPECT(gbc.e(),  0xa0);
        EXPECT(gbc.h(),  0x93);
        EXPECT(gbc.l(),  0x8d);
        EXPECT(gbc.sp(), 0xd7ed);
        EXPECT(gbc.pc(), 0x1d1b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0273
        gbc.setState(0xcddf, 0x67dc, 0xbb50, 0x3b44, 0x794c, 0x70a3, 0x1, 0x1);
        gbc.writeMem(0xcddf, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xbb);
        EXPECT(gbc.b(),  0x3b);
        EXPECT(gbc.c(),  0x44);
        EXPECT(gbc.d(),  0x79);
        EXPECT(gbc.e(),  0x4c);
        EXPECT(gbc.h(),  0xe0);
        EXPECT(gbc.l(),  0xa3);
        EXPECT(gbc.sp(), 0x67dc);
        EXPECT(gbc.pc(), 0xcde1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcddf), 0xcb);
        EXPECT(gbc.readMem(0xcde0), 0x4);
        // CB 04 0274
        gbc.setState(0x2f30, 0x2d20, 0x520, 0x7f58, 0x2083, 0xab5a, 0x1, 0x0);
        gbc.writeMem(0x2f30, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x5);
        EXPECT(gbc.b(),  0x7f);
        EXPECT(gbc.c(),  0x58);
        EXPECT(gbc.d(),  0x20);
        EXPECT(gbc.e(),  0x83);
        EXPECT(gbc.h(),  0x57);
        EXPECT(gbc.l(),  0x5a);
        EXPECT(gbc.sp(), 0x2d20);
        EXPECT(gbc.pc(), 0x2f32);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0275
        gbc.setState(0x77fa, 0x63de, 0xf8d0, 0xa35b, 0x6ab0, 0xa7b, 0x1, 0x1);
        gbc.writeMem(0x77fa, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf8);
        EXPECT(gbc.b(),  0xa3);
        EXPECT(gbc.c(),  0x5b);
        EXPECT(gbc.d(),  0x6a);
        EXPECT(gbc.e(),  0xb0);
        EXPECT(gbc.h(),  0x14);
        EXPECT(gbc.l(),  0x7b);
        EXPECT(gbc.sp(), 0x63de);
        EXPECT(gbc.pc(), 0x77fc);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0276
        gbc.setState(0x9f57, 0xe79b, 0xc860, 0xe146, 0xcd9, 0xabd2, 0x0, 0x1);
        gbc.writeMem(0x9f57, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc8);
        EXPECT(gbc.b(),  0xe1);
        EXPECT(gbc.c(),  0x46);
        EXPECT(gbc.d(),  0xc);
        EXPECT(gbc.e(),  0xd9);
        EXPECT(gbc.h(),  0x57);
        EXPECT(gbc.l(),  0xd2);
        EXPECT(gbc.sp(), 0xe79b);
        EXPECT(gbc.pc(), 0x9f59);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9f57), 0xcb);
        EXPECT(gbc.readMem(0x9f58), 0x4);
        // CB 04 0277
        gbc.setState(0xd209, 0x19db, 0x1c20, 0x49a3, 0x5ba4, 0xd403, 0x1, 0x0);
        gbc.writeMem(0xd209, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1c);
        EXPECT(gbc.b(),  0x49);
        EXPECT(gbc.c(),  0xa3);
        EXPECT(gbc.d(),  0x5b);
        EXPECT(gbc.e(),  0xa4);
        EXPECT(gbc.h(),  0xa9);
        EXPECT(gbc.l(),  0x3);
        EXPECT(gbc.sp(), 0x19db);
        EXPECT(gbc.pc(), 0xd20b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd209), 0xcb);
        EXPECT(gbc.readMem(0xd20a), 0x4);
        // CB 04 0278
        gbc.setState(0x5a71, 0x6dcd, 0xb0d0, 0x6179, 0x392b, 0xec3d, 0x0, 0x1);
        gbc.writeMem(0x5a71, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb0);
        EXPECT(gbc.b(),  0x61);
        EXPECT(gbc.c(),  0x79);
        EXPECT(gbc.d(),  0x39);
        EXPECT(gbc.e(),  0x2b);
        EXPECT(gbc.h(),  0xd9);
        EXPECT(gbc.l(),  0x3d);
        EXPECT(gbc.sp(), 0x6dcd);
        EXPECT(gbc.pc(), 0x5a73);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0279
        gbc.setState(0xded1, 0x5a8f, 0xadb0, 0x992, 0x7b12, 0x309d, 0x1, 0x1);
        gbc.writeMem(0xded1, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xad);
        EXPECT(gbc.b(),  0x9);
        EXPECT(gbc.c(),  0x92);
        EXPECT(gbc.d(),  0x7b);
        EXPECT(gbc.e(),  0x12);
        EXPECT(gbc.h(),  0x60);
        EXPECT(gbc.l(),  0x9d);
        EXPECT(gbc.sp(), 0x5a8f);
        EXPECT(gbc.pc(), 0xded3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xded1), 0xcb);
        EXPECT(gbc.readMem(0xded2), 0x4);
        // CB 04 027A
        gbc.setState(0xd53c, 0xc0c6, 0xb5c0, 0x10d9, 0x8933, 0x8d22, 0x0, 0x0);
        gbc.writeMem(0xd53c, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb5);
        EXPECT(gbc.b(),  0x10);
        EXPECT(gbc.c(),  0xd9);
        EXPECT(gbc.d(),  0x89);
        EXPECT(gbc.e(),  0x33);
        EXPECT(gbc.h(),  0x1b);
        EXPECT(gbc.l(),  0x22);
        EXPECT(gbc.sp(), 0xc0c6);
        EXPECT(gbc.pc(), 0xd53e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd53c), 0xcb);
        EXPECT(gbc.readMem(0xd53d), 0x4);
        // CB 04 027B
        gbc.setState(0x214, 0x7785, 0x6370, 0xb591, 0xcd68, 0xa0db, 0x1, 0x1);
        gbc.writeMem(0x214, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x63);
        EXPECT(gbc.b(),  0xb5);
        EXPECT(gbc.c(),  0x91);
        EXPECT(gbc.d(),  0xcd);
        EXPECT(gbc.e(),  0x68);
        EXPECT(gbc.h(),  0x41);
        EXPECT(gbc.l(),  0xdb);
        EXPECT(gbc.sp(), 0x7785);
        EXPECT(gbc.pc(), 0x216);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 027C
        gbc.setState(0xa80d, 0x4ca7, 0x20e0, 0xacf7, 0x1842, 0xbd98, 0x0, 0x0);
        gbc.writeMem(0xa80d, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0xac);
        EXPECT(gbc.c(),  0xf7);
        EXPECT(gbc.d(),  0x18);
        EXPECT(gbc.e(),  0x42);
        EXPECT(gbc.h(),  0x7b);
        EXPECT(gbc.l(),  0x98);
        EXPECT(gbc.sp(), 0x4ca7);
        EXPECT(gbc.pc(), 0xa80f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa80d), 0xcb);
        EXPECT(gbc.readMem(0xa80e), 0x4);
        // CB 04 027D
        gbc.setState(0x30b1, 0x4114, 0x55f0, 0x190d, 0xfbbd, 0xda0a, 0x1, 0x1);
        gbc.writeMem(0x30b1, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x55);
        EXPECT(gbc.b(),  0x19);
        EXPECT(gbc.c(),  0xd);
        EXPECT(gbc.d(),  0xfb);
        EXPECT(gbc.e(),  0xbd);
        EXPECT(gbc.h(),  0xb5);
        EXPECT(gbc.l(),  0xa);
        EXPECT(gbc.sp(), 0x4114);
        EXPECT(gbc.pc(), 0x30b3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 027E
        gbc.setState(0x78f2, 0xbe59, 0x5c80, 0x4aa8, 0x4477, 0x3c05, 0x1, 0x0);
        gbc.writeMem(0x78f2, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x5c);
        EXPECT(gbc.b(),  0x4a);
        EXPECT(gbc.c(),  0xa8);
        EXPECT(gbc.d(),  0x44);
        EXPECT(gbc.e(),  0x77);
        EXPECT(gbc.h(),  0x78);
        EXPECT(gbc.l(),  0x5);
        EXPECT(gbc.sp(), 0xbe59);
        EXPECT(gbc.pc(), 0x78f4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 027F
        gbc.setState(0x6629, 0x28be, 0xb450, 0x961, 0x49a5, 0x44dd, 0x1, 0x1);
        gbc.writeMem(0x6629, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb4);
        EXPECT(gbc.b(),  0x9);
        EXPECT(gbc.c(),  0x61);
        EXPECT(gbc.d(),  0x49);
        EXPECT(gbc.e(),  0xa5);
        EXPECT(gbc.h(),  0x88);
        EXPECT(gbc.l(),  0xdd);
        EXPECT(gbc.sp(), 0x28be);
        EXPECT(gbc.pc(), 0x662b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0280
        gbc.setState(0x457, 0x62ee, 0x8700, 0x1821, 0xc3c9, 0x2ee8, 0x1, 0x1);
        gbc.writeMem(0x457, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x87);
        EXPECT(gbc.b(),  0x18);
        EXPECT(gbc.c(),  0x21);
        EXPECT(gbc.d(),  0xc3);
        EXPECT(gbc.e(),  0xc9);
        EXPECT(gbc.h(),  0x5c);
        EXPECT(gbc.l(),  0xe8);
        EXPECT(gbc.sp(), 0x62ee);
        EXPECT(gbc.pc(), 0x459);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0281
        gbc.setState(0xda85, 0x6c22, 0x6890, 0x657a, 0x9d12, 0x33a0, 0x0, 0x1);
        gbc.writeMem(0xda85, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x68);
        EXPECT(gbc.b(),  0x65);
        EXPECT(gbc.c(),  0x7a);
        EXPECT(gbc.d(),  0x9d);
        EXPECT(gbc.e(),  0x12);
        EXPECT(gbc.h(),  0x66);
        EXPECT(gbc.l(),  0xa0);
        EXPECT(gbc.sp(), 0x6c22);
        EXPECT(gbc.pc(), 0xda87);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xda85), 0xcb);
        EXPECT(gbc.readMem(0xda86), 0x4);
        // CB 04 0282
        gbc.setState(0x38a8, 0xc5be, 0x3890, 0x4230, 0x4608, 0xd89f, 0x1, 0x1);
        gbc.writeMem(0x38a8, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x38);
        EXPECT(gbc.b(),  0x42);
        EXPECT(gbc.c(),  0x30);
        EXPECT(gbc.d(),  0x46);
        EXPECT(gbc.e(),  0x8);
        EXPECT(gbc.h(),  0xb1);
        EXPECT(gbc.l(),  0x9f);
        EXPECT(gbc.sp(), 0xc5be);
        EXPECT(gbc.pc(), 0x38aa);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0284
        gbc.setState(0xacc3, 0xb4a1, 0x7360, 0x731c, 0xceac, 0xfb8e, 0x1, 0x0);
        gbc.writeMem(0xacc3, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x73);
        EXPECT(gbc.b(),  0x73);
        EXPECT(gbc.c(),  0x1c);
        EXPECT(gbc.d(),  0xce);
        EXPECT(gbc.e(),  0xac);
        EXPECT(gbc.h(),  0xf7);
        EXPECT(gbc.l(),  0x8e);
        EXPECT(gbc.sp(), 0xb4a1);
        EXPECT(gbc.pc(), 0xacc5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xacc3), 0xcb);
        EXPECT(gbc.readMem(0xacc4), 0x4);
        // CB 04 0285
        gbc.setState(0xa8f9, 0xad3a, 0x6a40, 0x9dd, 0x111b, 0x35b5, 0x1, 0x0);
        gbc.writeMem(0xa8f9, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x6a);
        EXPECT(gbc.b(),  0x9);
        EXPECT(gbc.c(),  0xdd);
        EXPECT(gbc.d(),  0x11);
        EXPECT(gbc.e(),  0x1b);
        EXPECT(gbc.h(),  0x6a);
        EXPECT(gbc.l(),  0xb5);
        EXPECT(gbc.sp(), 0xad3a);
        EXPECT(gbc.pc(), 0xa8fb);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa8f9), 0xcb);
        EXPECT(gbc.readMem(0xa8fa), 0x4);
        // CB 04 0286
        gbc.setState(0xe24b, 0x2f91, 0x84c0, 0x24b6, 0x5cf1, 0x7300, 0x0, 0x0);
        gbc.writeMem(0xe24b, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x84);
        EXPECT(gbc.b(),  0x24);
        EXPECT(gbc.c(),  0xb6);
        EXPECT(gbc.d(),  0x5c);
        EXPECT(gbc.e(),  0xf1);
        EXPECT(gbc.h(),  0xe6);
        EXPECT(gbc.l(),  0x0);
        EXPECT(gbc.sp(), 0x2f91);
        EXPECT(gbc.pc(), 0xe24d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe24b), 0xcb);
        EXPECT(gbc.readMem(0xe24c), 0x4);
        // CB 04 0288
        gbc.setState(0xd621, 0xf7b3, 0xa7c0, 0x3c28, 0x44ba, 0x938b, 0x0, 0x0);
        gbc.writeMem(0xd621, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa7);
        EXPECT(gbc.b(),  0x3c);
        EXPECT(gbc.c(),  0x28);
        EXPECT(gbc.d(),  0x44);
        EXPECT(gbc.e(),  0xba);
        EXPECT(gbc.h(),  0x27);
        EXPECT(gbc.l(),  0x8b);
        EXPECT(gbc.sp(), 0xf7b3);
        EXPECT(gbc.pc(), 0xd623);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd621), 0xcb);
        EXPECT(gbc.readMem(0xd622), 0x4);
        // CB 04 0289
        gbc.setState(0xd8c1, 0x3629, 0xeec0, 0x9164, 0x4535, 0xe73e, 0x1, 0x1);
        gbc.writeMem(0xd8c1, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xee);
        EXPECT(gbc.b(),  0x91);
        EXPECT(gbc.c(),  0x64);
        EXPECT(gbc.d(),  0x45);
        EXPECT(gbc.e(),  0x35);
        EXPECT(gbc.h(),  0xcf);
        EXPECT(gbc.l(),  0x3e);
        EXPECT(gbc.sp(), 0x3629);
        EXPECT(gbc.pc(), 0xd8c3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd8c1), 0xcb);
        EXPECT(gbc.readMem(0xd8c2), 0x4);
        // CB 04 028A
        gbc.setState(0x2901, 0xe23e, 0xc140, 0x4ee3, 0xbf1f, 0x7168, 0x1, 0x1);
        gbc.writeMem(0x2901, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc1);
        EXPECT(gbc.b(),  0x4e);
        EXPECT(gbc.c(),  0xe3);
        EXPECT(gbc.d(),  0xbf);
        EXPECT(gbc.e(),  0x1f);
        EXPECT(gbc.h(),  0xe2);
        EXPECT(gbc.l(),  0x68);
        EXPECT(gbc.sp(), 0xe23e);
        EXPECT(gbc.pc(), 0x2903);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 028B
        gbc.setState(0x3625, 0xb0c3, 0x8c00, 0x5923, 0xdfd7, 0x549d, 0x0, 0x0);
        gbc.writeMem(0x3625, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8c);
        EXPECT(gbc.b(),  0x59);
        EXPECT(gbc.c(),  0x23);
        EXPECT(gbc.d(),  0xdf);
        EXPECT(gbc.e(),  0xd7);
        EXPECT(gbc.h(),  0xa8);
        EXPECT(gbc.l(),  0x9d);
        EXPECT(gbc.sp(), 0xb0c3);
        EXPECT(gbc.pc(), 0x3627);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 028C
        gbc.setState(0x9405, 0xdd91, 0x6f60, 0xc991, 0x1f98, 0xe659, 0x0, 0x0);
        gbc.writeMem(0x9405, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x6f);
        EXPECT(gbc.b(),  0xc9);
        EXPECT(gbc.c(),  0x91);
        EXPECT(gbc.d(),  0x1f);
        EXPECT(gbc.e(),  0x98);
        EXPECT(gbc.h(),  0xcd);
        EXPECT(gbc.l(),  0x59);
        EXPECT(gbc.sp(), 0xdd91);
        EXPECT(gbc.pc(), 0x9407);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9405), 0xcb);
        EXPECT(gbc.readMem(0x9406), 0x4);
        // CB 04 028D
        gbc.setState(0x11dd, 0x6338, 0x2660, 0x8f6, 0xf6ec, 0x7dc3, 0x1, 0x0);
        gbc.writeMem(0x11dd, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x26);
        EXPECT(gbc.b(),  0x8);
        EXPECT(gbc.c(),  0xf6);
        EXPECT(gbc.d(),  0xf6);
        EXPECT(gbc.e(),  0xec);
        EXPECT(gbc.h(),  0xfa);
        EXPECT(gbc.l(),  0xc3);
        EXPECT(gbc.sp(), 0x6338);
        EXPECT(gbc.pc(), 0x11df);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 028E
        gbc.setState(0xe59e, 0xcb1d, 0xb580, 0x523, 0x8838, 0xad76, 0x0, 0x1);
        gbc.writeMem(0xe59e, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb5);
        EXPECT(gbc.b(),  0x5);
        EXPECT(gbc.c(),  0x23);
        EXPECT(gbc.d(),  0x88);
        EXPECT(gbc.e(),  0x38);
        EXPECT(gbc.h(),  0x5b);
        EXPECT(gbc.l(),  0x76);
        EXPECT(gbc.sp(), 0xcb1d);
        EXPECT(gbc.pc(), 0xe5a0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe59e), 0xcb);
        EXPECT(gbc.readMem(0xe59f), 0x4);
        // CB 04 028F
        gbc.setState(0x7941, 0xd120, 0xd8b0, 0xbf55, 0xe5a8, 0xee91, 0x1, 0x0);
        gbc.writeMem(0x7941, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd8);
        EXPECT(gbc.b(),  0xbf);
        EXPECT(gbc.c(),  0x55);
        EXPECT(gbc.d(),  0xe5);
        EXPECT(gbc.e(),  0xa8);
        EXPECT(gbc.h(),  0xdd);
        EXPECT(gbc.l(),  0x91);
        EXPECT(gbc.sp(), 0xd120);
        EXPECT(gbc.pc(), 0x7943);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0290
        gbc.setState(0x62ca, 0x1d81, 0x2f00, 0x11bb, 0xc137, 0xc85d, 0x0, 0x0);
        gbc.writeMem(0x62ca, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2f);
        EXPECT(gbc.b(),  0x11);
        EXPECT(gbc.c(),  0xbb);
        EXPECT(gbc.d(),  0xc1);
        EXPECT(gbc.e(),  0x37);
        EXPECT(gbc.h(),  0x91);
        EXPECT(gbc.l(),  0x5d);
        EXPECT(gbc.sp(), 0x1d81);
        EXPECT(gbc.pc(), 0x62cc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0291
        gbc.setState(0xeae7, 0x96f5, 0xe4e0, 0xcf0, 0x862a, 0x68ec, 0x1, 0x1);
        gbc.writeMem(0xeae7, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe4);
        EXPECT(gbc.b(),  0xc);
        EXPECT(gbc.c(),  0xf0);
        EXPECT(gbc.d(),  0x86);
        EXPECT(gbc.e(),  0x2a);
        EXPECT(gbc.h(),  0xd0);
        EXPECT(gbc.l(),  0xec);
        EXPECT(gbc.sp(), 0x96f5);
        EXPECT(gbc.pc(), 0xeae9);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xeae7), 0xcb);
        EXPECT(gbc.readMem(0xeae8), 0x4);
        // CB 04 0292
        gbc.setState(0x13b6, 0xa006, 0x2560, 0xea2d, 0x56d6, 0xec9b, 0x1, 0x1);
        gbc.writeMem(0x13b6, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x25);
        EXPECT(gbc.b(),  0xea);
        EXPECT(gbc.c(),  0x2d);
        EXPECT(gbc.d(),  0x56);
        EXPECT(gbc.e(),  0xd6);
        EXPECT(gbc.h(),  0xd9);
        EXPECT(gbc.l(),  0x9b);
        EXPECT(gbc.sp(), 0xa006);
        EXPECT(gbc.pc(), 0x13b8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0293
        gbc.setState(0x1cc5, 0xf264, 0x3320, 0x5666, 0xde5e, 0x4b67, 0x1, 0x0);
        gbc.writeMem(0x1cc5, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x33);
        EXPECT(gbc.b(),  0x56);
        EXPECT(gbc.c(),  0x66);
        EXPECT(gbc.d(),  0xde);
        EXPECT(gbc.e(),  0x5e);
        EXPECT(gbc.h(),  0x96);
        EXPECT(gbc.l(),  0x67);
        EXPECT(gbc.sp(), 0xf264);
        EXPECT(gbc.pc(), 0x1cc7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0294
        gbc.setState(0x701b, 0x3437, 0xc450, 0x15d4, 0x1759, 0x65d1, 0x1, 0x1);
        gbc.writeMem(0x701b, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc4);
        EXPECT(gbc.b(),  0x15);
        EXPECT(gbc.c(),  0xd4);
        EXPECT(gbc.d(),  0x17);
        EXPECT(gbc.e(),  0x59);
        EXPECT(gbc.h(),  0xca);
        EXPECT(gbc.l(),  0xd1);
        EXPECT(gbc.sp(), 0x3437);
        EXPECT(gbc.pc(), 0x701d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0295
        gbc.setState(0xabe2, 0xc52, 0x1120, 0x43c1, 0x4309, 0x1cf, 0x1, 0x0);
        gbc.writeMem(0xabe2, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x11);
        EXPECT(gbc.b(),  0x43);
        EXPECT(gbc.c(),  0xc1);
        EXPECT(gbc.d(),  0x43);
        EXPECT(gbc.e(),  0x9);
        EXPECT(gbc.h(),  0x2);
        EXPECT(gbc.l(),  0xcf);
        EXPECT(gbc.sp(), 0xc52);
        EXPECT(gbc.pc(), 0xabe4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xabe2), 0xcb);
        EXPECT(gbc.readMem(0xabe3), 0x4);
        // CB 04 0296
        gbc.setState(0xa775, 0xf979, 0x3df0, 0xecff, 0x726c, 0x6759, 0x1, 0x0);
        gbc.writeMem(0xa775, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3d);
        EXPECT(gbc.b(),  0xec);
        EXPECT(gbc.c(),  0xff);
        EXPECT(gbc.d(),  0x72);
        EXPECT(gbc.e(),  0x6c);
        EXPECT(gbc.h(),  0xce);
        EXPECT(gbc.l(),  0x59);
        EXPECT(gbc.sp(), 0xf979);
        EXPECT(gbc.pc(), 0xa777);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa775), 0xcb);
        EXPECT(gbc.readMem(0xa776), 0x4);
        // CB 04 0297
        gbc.setState(0x67e7, 0x5677, 0x8d0, 0x55f9, 0x40de, 0x5fe, 0x0, 0x1);
        gbc.writeMem(0x67e7, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0x55);
        EXPECT(gbc.c(),  0xf9);
        EXPECT(gbc.d(),  0x40);
        EXPECT(gbc.e(),  0xde);
        EXPECT(gbc.h(),  0xa);
        EXPECT(gbc.l(),  0xfe);
        EXPECT(gbc.sp(), 0x5677);
        EXPECT(gbc.pc(), 0x67e9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0298
        gbc.setState(0x733b, 0x51d3, 0x7c0, 0xe28e, 0xeef3, 0xbd22, 0x1, 0x0);
        gbc.writeMem(0x733b, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x7);
        EXPECT(gbc.b(),  0xe2);
        EXPECT(gbc.c(),  0x8e);
        EXPECT(gbc.d(),  0xee);
        EXPECT(gbc.e(),  0xf3);
        EXPECT(gbc.h(),  0x7b);
        EXPECT(gbc.l(),  0x22);
        EXPECT(gbc.sp(), 0x51d3);
        EXPECT(gbc.pc(), 0x733d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0299
        gbc.setState(0x11ae, 0x4853, 0x2c40, 0xa63a, 0x74b0, 0x4e22, 0x1, 0x0);
        gbc.writeMem(0x11ae, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2c);
        EXPECT(gbc.b(),  0xa6);
        EXPECT(gbc.c(),  0x3a);
        EXPECT(gbc.d(),  0x74);
        EXPECT(gbc.e(),  0xb0);
        EXPECT(gbc.h(),  0x9c);
        EXPECT(gbc.l(),  0x22);
        EXPECT(gbc.sp(), 0x4853);
        EXPECT(gbc.pc(), 0x11b0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 029A
        gbc.setState(0xcc91, 0xebaf, 0x9e40, 0x516c, 0x8fb9, 0xf429, 0x0, 0x1);
        gbc.writeMem(0xcc91, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x9e);
        EXPECT(gbc.b(),  0x51);
        EXPECT(gbc.c(),  0x6c);
        EXPECT(gbc.d(),  0x8f);
        EXPECT(gbc.e(),  0xb9);
        EXPECT(gbc.h(),  0xe9);
        EXPECT(gbc.l(),  0x29);
        EXPECT(gbc.sp(), 0xebaf);
        EXPECT(gbc.pc(), 0xcc93);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcc91), 0xcb);
        EXPECT(gbc.readMem(0xcc92), 0x4);
        // CB 04 029B
        gbc.setState(0x19f6, 0x80f1, 0x9e0, 0x2e74, 0xd3d7, 0x7048, 0x1, 0x1);
        gbc.writeMem(0x19f6, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x9);
        EXPECT(gbc.b(),  0x2e);
        EXPECT(gbc.c(),  0x74);
        EXPECT(gbc.d(),  0xd3);
        EXPECT(gbc.e(),  0xd7);
        EXPECT(gbc.h(),  0xe0);
        EXPECT(gbc.l(),  0x48);
        EXPECT(gbc.sp(), 0x80f1);
        EXPECT(gbc.pc(), 0x19f8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 029D
        gbc.setState(0x49c8, 0x6a8a, 0x6480, 0xe451, 0x9636, 0xf97f, 0x1, 0x1);
        gbc.writeMem(0x49c8, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x64);
        EXPECT(gbc.b(),  0xe4);
        EXPECT(gbc.c(),  0x51);
        EXPECT(gbc.d(),  0x96);
        EXPECT(gbc.e(),  0x36);
        EXPECT(gbc.h(),  0xf3);
        EXPECT(gbc.l(),  0x7f);
        EXPECT(gbc.sp(), 0x6a8a);
        EXPECT(gbc.pc(), 0x49ca);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 029E
        gbc.setState(0x1e3c, 0xd34e, 0x3410, 0x894e, 0xc427, 0x1d03, 0x0, 0x0);
        gbc.writeMem(0x1e3c, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x34);
        EXPECT(gbc.b(),  0x89);
        EXPECT(gbc.c(),  0x4e);
        EXPECT(gbc.d(),  0xc4);
        EXPECT(gbc.e(),  0x27);
        EXPECT(gbc.h(),  0x3a);
        EXPECT(gbc.l(),  0x3);
        EXPECT(gbc.sp(), 0xd34e);
        EXPECT(gbc.pc(), 0x1e3e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 029F
        gbc.setState(0xafe6, 0x2a2a, 0x94a0, 0xbe5d, 0x76f4, 0x64fd, 0x1, 0x1);
        gbc.writeMem(0xafe6, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x94);
        EXPECT(gbc.b(),  0xbe);
        EXPECT(gbc.c(),  0x5d);
        EXPECT(gbc.d(),  0x76);
        EXPECT(gbc.e(),  0xf4);
        EXPECT(gbc.h(),  0xc8);
        EXPECT(gbc.l(),  0xfd);
        EXPECT(gbc.sp(), 0x2a2a);
        EXPECT(gbc.pc(), 0xafe8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xafe6), 0xcb);
        EXPECT(gbc.readMem(0xafe7), 0x4);
        // CB 04 02A0
        gbc.setState(0x803c, 0xfb5b, 0xa590, 0xa585, 0x2c0, 0x3bc5, 0x1, 0x0);
        gbc.writeMem(0x803c, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa5);
        EXPECT(gbc.b(),  0xa5);
        EXPECT(gbc.c(),  0x85);
        EXPECT(gbc.d(),  0x2);
        EXPECT(gbc.e(),  0xc0);
        EXPECT(gbc.h(),  0x76);
        EXPECT(gbc.l(),  0xc5);
        EXPECT(gbc.sp(), 0xfb5b);
        EXPECT(gbc.pc(), 0x803e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x803c), 0xcb);
        EXPECT(gbc.readMem(0x803d), 0x4);
        // CB 04 02A1
        gbc.setState(0xcd08, 0x1731, 0x9140, 0x1536, 0x29e, 0xd9df, 0x0, 0x0);
        gbc.writeMem(0xcd08, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x91);
        EXPECT(gbc.b(),  0x15);
        EXPECT(gbc.c(),  0x36);
        EXPECT(gbc.d(),  0x2);
        EXPECT(gbc.e(),  0x9e);
        EXPECT(gbc.h(),  0xb3);
        EXPECT(gbc.l(),  0xdf);
        EXPECT(gbc.sp(), 0x1731);
        EXPECT(gbc.pc(), 0xcd0a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcd08), 0xcb);
        EXPECT(gbc.readMem(0xcd09), 0x4);
        // CB 04 02A2
        gbc.setState(0xadf7, 0x3539, 0x5380, 0x5310, 0x6208, 0xa2e0, 0x1, 0x1);
        gbc.writeMem(0xadf7, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x53);
        EXPECT(gbc.b(),  0x53);
        EXPECT(gbc.c(),  0x10);
        EXPECT(gbc.d(),  0x62);
        EXPECT(gbc.e(),  0x8);
        EXPECT(gbc.h(),  0x45);
        EXPECT(gbc.l(),  0xe0);
        EXPECT(gbc.sp(), 0x3539);
        EXPECT(gbc.pc(), 0xadf9);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xadf7), 0xcb);
        EXPECT(gbc.readMem(0xadf8), 0x4);
        // CB 04 02A3
        gbc.setState(0x270e, 0x3374, 0x9b70, 0x8ca9, 0x5dfa, 0xa378, 0x0, 0x0);
        gbc.writeMem(0x270e, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x9b);
        EXPECT(gbc.b(),  0x8c);
        EXPECT(gbc.c(),  0xa9);
        EXPECT(gbc.d(),  0x5d);
        EXPECT(gbc.e(),  0xfa);
        EXPECT(gbc.h(),  0x47);
        EXPECT(gbc.l(),  0x78);
        EXPECT(gbc.sp(), 0x3374);
        EXPECT(gbc.pc(), 0x2710);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 02A4
        gbc.setState(0xec5d, 0x3f85, 0xf910, 0x9a77, 0x21dd, 0x51be, 0x1, 0x0);
        gbc.writeMem(0xec5d, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf9);
        EXPECT(gbc.b(),  0x9a);
        EXPECT(gbc.c(),  0x77);
        EXPECT(gbc.d(),  0x21);
        EXPECT(gbc.e(),  0xdd);
        EXPECT(gbc.h(),  0xa2);
        EXPECT(gbc.l(),  0xbe);
        EXPECT(gbc.sp(), 0x3f85);
        EXPECT(gbc.pc(), 0xec5f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xec5d), 0xcb);
        EXPECT(gbc.readMem(0xec5e), 0x4);
        // CB 04 02A5
        gbc.setState(0x2f7, 0x5739, 0x20c0, 0x42f, 0xe83, 0xb9fa, 0x1, 0x0);
        gbc.writeMem(0x2f7, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0x4);
        EXPECT(gbc.c(),  0x2f);
        EXPECT(gbc.d(),  0xe);
        EXPECT(gbc.e(),  0x83);
        EXPECT(gbc.h(),  0x73);
        EXPECT(gbc.l(),  0xfa);
        EXPECT(gbc.sp(), 0x5739);
        EXPECT(gbc.pc(), 0x2f9);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 02A7
        gbc.setState(0x40a3, 0x9bb9, 0xb7a0, 0xa35d, 0x7881, 0xf5c7, 0x0, 0x1);
        gbc.writeMem(0x40a3, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb7);
        EXPECT(gbc.b(),  0xa3);
        EXPECT(gbc.c(),  0x5d);
        EXPECT(gbc.d(),  0x78);
        EXPECT(gbc.e(),  0x81);
        EXPECT(gbc.h(),  0xeb);
        EXPECT(gbc.l(),  0xc7);
        EXPECT(gbc.sp(), 0x9bb9);
        EXPECT(gbc.pc(), 0x40a5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 02A8
        gbc.setState(0xa094, 0x43f, 0xac70, 0xb252, 0xb362, 0x93e6, 0x0, 0x1);
        gbc.writeMem(0xa094, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xac);
        EXPECT(gbc.b(),  0xb2);
        EXPECT(gbc.c(),  0x52);
        EXPECT(gbc.d(),  0xb3);
        EXPECT(gbc.e(),  0x62);
        EXPECT(gbc.h(),  0x27);
        EXPECT(gbc.l(),  0xe6);
        EXPECT(gbc.sp(), 0x43f);
        EXPECT(gbc.pc(), 0xa096);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa094), 0xcb);
        EXPECT(gbc.readMem(0xa095), 0x4);
        // CB 04 02A9
        gbc.setState(0x7688, 0x9c8a, 0xff70, 0x7b2, 0x67f5, 0x124f, 0x1, 0x0);
        gbc.writeMem(0x7688, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xff);
        EXPECT(gbc.b(),  0x7);
        EXPECT(gbc.c(),  0xb2);
        EXPECT(gbc.d(),  0x67);
        EXPECT(gbc.e(),  0xf5);
        EXPECT(gbc.h(),  0x24);
        EXPECT(gbc.l(),  0x4f);
        EXPECT(gbc.sp(), 0x9c8a);
        EXPECT(gbc.pc(), 0x768a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 02AA
        gbc.setState(0x93e3, 0x7c56, 0x2d0, 0x7168, 0x84ed, 0x73f0, 0x1, 0x0);
        gbc.writeMem(0x93e3, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0x71);
        EXPECT(gbc.c(),  0x68);
        EXPECT(gbc.d(),  0x84);
        EXPECT(gbc.e(),  0xed);
        EXPECT(gbc.h(),  0xe6);
        EXPECT(gbc.l(),  0xf0);
        EXPECT(gbc.sp(), 0x7c56);
        EXPECT(gbc.pc(), 0x93e5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x93e3), 0xcb);
        EXPECT(gbc.readMem(0x93e4), 0x4);
        // CB 04 02AB
        gbc.setState(0x45fb, 0x1ea9, 0xd3b0, 0x2802, 0x445, 0xe754, 0x0, 0x0);
        gbc.writeMem(0x45fb, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd3);
        EXPECT(gbc.b(),  0x28);
        EXPECT(gbc.c(),  0x2);
        EXPECT(gbc.d(),  0x4);
        EXPECT(gbc.e(),  0x45);
        EXPECT(gbc.h(),  0xcf);
        EXPECT(gbc.l(),  0x54);
        EXPECT(gbc.sp(), 0x1ea9);
        EXPECT(gbc.pc(), 0x45fd);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 02AC
        gbc.setState(0x564e, 0x87f1, 0x23d0, 0x1c1, 0x6d67, 0xcbce, 0x1, 0x0);
        gbc.writeMem(0x564e, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x23);
        EXPECT(gbc.b(),  0x1);
        EXPECT(gbc.c(),  0xc1);
        EXPECT(gbc.d(),  0x6d);
        EXPECT(gbc.e(),  0x67);
        EXPECT(gbc.h(),  0x97);
        EXPECT(gbc.l(),  0xce);
        EXPECT(gbc.sp(), 0x87f1);
        EXPECT(gbc.pc(), 0x5650);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 02AD
        gbc.setState(0x23f4, 0x41c0, 0xac70, 0xb3f8, 0xee9b, 0x9d15, 0x1, 0x0);
        gbc.writeMem(0x23f4, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xac);
        EXPECT(gbc.b(),  0xb3);
        EXPECT(gbc.c(),  0xf8);
        EXPECT(gbc.d(),  0xee);
        EXPECT(gbc.e(),  0x9b);
        EXPECT(gbc.h(),  0x3b);
        EXPECT(gbc.l(),  0x15);
        EXPECT(gbc.sp(), 0x41c0);
        EXPECT(gbc.pc(), 0x23f6);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 02AE
        gbc.setState(0xbb4c, 0xf09, 0xd8c0, 0x1dc2, 0x6699, 0x27a7, 0x1, 0x0);
        gbc.writeMem(0xbb4c, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd8);
        EXPECT(gbc.b(),  0x1d);
        EXPECT(gbc.c(),  0xc2);
        EXPECT(gbc.d(),  0x66);
        EXPECT(gbc.e(),  0x99);
        EXPECT(gbc.h(),  0x4e);
        EXPECT(gbc.l(),  0xa7);
        EXPECT(gbc.sp(), 0xf09);
        EXPECT(gbc.pc(), 0xbb4e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbb4c), 0xcb);
        EXPECT(gbc.readMem(0xbb4d), 0x4);
        // CB 04 02B0
        gbc.setState(0x184f, 0x5b67, 0xdc70, 0xe925, 0xedf4, 0xddb6, 0x0, 0x1);
        gbc.writeMem(0x184f, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xdc);
        EXPECT(gbc.b(),  0xe9);
        EXPECT(gbc.c(),  0x25);
        EXPECT(gbc.d(),  0xed);
        EXPECT(gbc.e(),  0xf4);
        EXPECT(gbc.h(),  0xbb);
        EXPECT(gbc.l(),  0xb6);
        EXPECT(gbc.sp(), 0x5b67);
        EXPECT(gbc.pc(), 0x1851);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 02B1
        gbc.setState(0x7d1, 0xc63e, 0xc540, 0x107d, 0x397, 0x13e6, 0x0, 0x1);
        gbc.writeMem(0x7d1, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc5);
        EXPECT(gbc.b(),  0x10);
        EXPECT(gbc.c(),  0x7d);
        EXPECT(gbc.d(),  0x3);
        EXPECT(gbc.e(),  0x97);
        EXPECT(gbc.h(),  0x26);
        EXPECT(gbc.l(),  0xe6);
        EXPECT(gbc.sp(), 0xc63e);
        EXPECT(gbc.pc(), 0x7d3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 02B2
        gbc.setState(0xb361, 0x5316, 0x220, 0x3830, 0xf2dd, 0x6c1c, 0x1, 0x1);
        gbc.writeMem(0xb361, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0x38);
        EXPECT(gbc.c(),  0x30);
        EXPECT(gbc.d(),  0xf2);
        EXPECT(gbc.e(),  0xdd);
        EXPECT(gbc.h(),  0xd8);
        EXPECT(gbc.l(),  0x1c);
        EXPECT(gbc.sp(), 0x5316);
        EXPECT(gbc.pc(), 0xb363);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb361), 0xcb);
        EXPECT(gbc.readMem(0xb362), 0x4);
        // CB 04 02B3
        gbc.setState(0xe20f, 0xd3e1, 0x5760, 0xf33f, 0x1637, 0xb725, 0x1, 0x1);
        gbc.writeMem(0xe20f, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x57);
        EXPECT(gbc.b(),  0xf3);
        EXPECT(gbc.c(),  0x3f);
        EXPECT(gbc.d(),  0x16);
        EXPECT(gbc.e(),  0x37);
        EXPECT(gbc.h(),  0x6f);
        EXPECT(gbc.l(),  0x25);
        EXPECT(gbc.sp(), 0xd3e1);
        EXPECT(gbc.pc(), 0xe211);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe20f), 0xcb);
        EXPECT(gbc.readMem(0xe210), 0x4);
        // CB 04 02B4
        gbc.setState(0x83f5, 0xda75, 0xbf50, 0x2941, 0xb8d4, 0x9f39, 0x0, 0x0);
        gbc.writeMem(0x83f5, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xbf);
        EXPECT(gbc.b(),  0x29);
        EXPECT(gbc.c(),  0x41);
        EXPECT(gbc.d(),  0xb8);
        EXPECT(gbc.e(),  0xd4);
        EXPECT(gbc.h(),  0x3f);
        EXPECT(gbc.l(),  0x39);
        EXPECT(gbc.sp(), 0xda75);
        EXPECT(gbc.pc(), 0x83f7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x83f5), 0xcb);
        EXPECT(gbc.readMem(0x83f6), 0x4);
        // CB 04 02B5
        gbc.setState(0xbcda, 0x11d6, 0x4a50, 0x7f7b, 0x621f, 0x3b2, 0x1, 0x0);
        gbc.writeMem(0xbcda, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4a);
        EXPECT(gbc.b(),  0x7f);
        EXPECT(gbc.c(),  0x7b);
        EXPECT(gbc.d(),  0x62);
        EXPECT(gbc.e(),  0x1f);
        EXPECT(gbc.h(),  0x6);
        EXPECT(gbc.l(),  0xb2);
        EXPECT(gbc.sp(), 0x11d6);
        EXPECT(gbc.pc(), 0xbcdc);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbcda), 0xcb);
        EXPECT(gbc.readMem(0xbcdb), 0x4);
        // CB 04 02B6
        gbc.setState(0x9263, 0xa08f, 0x2480, 0x553f, 0xe390, 0xeea, 0x1, 0x1);
        gbc.writeMem(0x9263, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x24);
        EXPECT(gbc.b(),  0x55);
        EXPECT(gbc.c(),  0x3f);
        EXPECT(gbc.d(),  0xe3);
        EXPECT(gbc.e(),  0x90);
        EXPECT(gbc.h(),  0x1c);
        EXPECT(gbc.l(),  0xea);
        EXPECT(gbc.sp(), 0xa08f);
        EXPECT(gbc.pc(), 0x9265);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9263), 0xcb);
        EXPECT(gbc.readMem(0x9264), 0x4);
        // CB 04 02B7
        gbc.setState(0x64e8, 0xa376, 0xfa50, 0x93d4, 0x84e8, 0x7906, 0x1, 0x0);
        gbc.writeMem(0x64e8, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xfa);
        EXPECT(gbc.b(),  0x93);
        EXPECT(gbc.c(),  0xd4);
        EXPECT(gbc.d(),  0x84);
        EXPECT(gbc.e(),  0xe8);
        EXPECT(gbc.h(),  0xf2);
        EXPECT(gbc.l(),  0x6);
        EXPECT(gbc.sp(), 0xa376);
        EXPECT(gbc.pc(), 0x64ea);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 02B8
        gbc.setState(0x519d, 0x9cad, 0xac50, 0xd110, 0x364c, 0xce51, 0x1, 0x1);
        gbc.writeMem(0x519d, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xac);
        EXPECT(gbc.b(),  0xd1);
        EXPECT(gbc.c(),  0x10);
        EXPECT(gbc.d(),  0x36);
        EXPECT(gbc.e(),  0x4c);
        EXPECT(gbc.h(),  0x9d);
        EXPECT(gbc.l(),  0x51);
        EXPECT(gbc.sp(), 0x9cad);
        EXPECT(gbc.pc(), 0x519f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 02B9
        gbc.setState(0xb0e7, 0x5363, 0xecf0, 0xcf76, 0x27b0, 0xa511, 0x1, 0x1);
        gbc.writeMem(0xb0e7, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xec);
        EXPECT(gbc.b(),  0xcf);
        EXPECT(gbc.c(),  0x76);
        EXPECT(gbc.d(),  0x27);
        EXPECT(gbc.e(),  0xb0);
        EXPECT(gbc.h(),  0x4b);
        EXPECT(gbc.l(),  0x11);
        EXPECT(gbc.sp(), 0x5363);
        EXPECT(gbc.pc(), 0xb0e9);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb0e7), 0xcb);
        EXPECT(gbc.readMem(0xb0e8), 0x4);
        // CB 04 02BA
        gbc.setState(0xb82b, 0xe8ee, 0x2100, 0xf21c, 0x56d0, 0x2b89, 0x0, 0x1);
        gbc.writeMem(0xb82b, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x21);
        EXPECT(gbc.b(),  0xf2);
        EXPECT(gbc.c(),  0x1c);
        EXPECT(gbc.d(),  0x56);
        EXPECT(gbc.e(),  0xd0);
        EXPECT(gbc.h(),  0x56);
        EXPECT(gbc.l(),  0x89);
        EXPECT(gbc.sp(), 0xe8ee);
        EXPECT(gbc.pc(), 0xb82d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb82b), 0xcb);
        EXPECT(gbc.readMem(0xb82c), 0x4);
        // CB 04 02BC
        gbc.setState(0x953, 0xe0ef, 0xdd20, 0xcdd5, 0xa1af, 0x19e9, 0x1, 0x0);
        gbc.writeMem(0x953, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xdd);
        EXPECT(gbc.b(),  0xcd);
        EXPECT(gbc.c(),  0xd5);
        EXPECT(gbc.d(),  0xa1);
        EXPECT(gbc.e(),  0xaf);
        EXPECT(gbc.h(),  0x32);
        EXPECT(gbc.l(),  0xe9);
        EXPECT(gbc.sp(), 0xe0ef);
        EXPECT(gbc.pc(), 0x955);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 02BD
        gbc.setState(0xa3f5, 0x3a9f, 0x2380, 0x66ff, 0x2a44, 0x5a6d, 0x0, 0x1);
        gbc.writeMem(0xa3f5, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x23);
        EXPECT(gbc.b(),  0x66);
        EXPECT(gbc.c(),  0xff);
        EXPECT(gbc.d(),  0x2a);
        EXPECT(gbc.e(),  0x44);
        EXPECT(gbc.h(),  0xb4);
        EXPECT(gbc.l(),  0x6d);
        EXPECT(gbc.sp(), 0x3a9f);
        EXPECT(gbc.pc(), 0xa3f7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa3f5), 0xcb);
        EXPECT(gbc.readMem(0xa3f6), 0x4);
        // CB 04 02BE
        gbc.setState(0x2be3, 0xa26a, 0xdc0, 0xc95d, 0x50a0, 0x239d, 0x1, 0x1);
        gbc.writeMem(0x2be3, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd);
        EXPECT(gbc.b(),  0xc9);
        EXPECT(gbc.c(),  0x5d);
        EXPECT(gbc.d(),  0x50);
        EXPECT(gbc.e(),  0xa0);
        EXPECT(gbc.h(),  0x46);
        EXPECT(gbc.l(),  0x9d);
        EXPECT(gbc.sp(), 0xa26a);
        EXPECT(gbc.pc(), 0x2be5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 02BF
        gbc.setState(0xaaa1, 0x8076, 0xde30, 0x434c, 0xf5f0, 0x6b8b, 0x1, 0x0);
        gbc.writeMem(0xaaa1, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xde);
        EXPECT(gbc.b(),  0x43);
        EXPECT(gbc.c(),  0x4c);
        EXPECT(gbc.d(),  0xf5);
        EXPECT(gbc.e(),  0xf0);
        EXPECT(gbc.h(),  0xd6);
        EXPECT(gbc.l(),  0x8b);
        EXPECT(gbc.sp(), 0x8076);
        EXPECT(gbc.pc(), 0xaaa3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xaaa1), 0xcb);
        EXPECT(gbc.readMem(0xaaa2), 0x4);
        // CB 04 02C0
        gbc.setState(0x7812, 0xd2a2, 0xd940, 0x31, 0xd65e, 0x574b, 0x1, 0x0);
        gbc.writeMem(0x7812, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd9);
        EXPECT(gbc.b(),  0x0);
        EXPECT(gbc.c(),  0x31);
        EXPECT(gbc.d(),  0xd6);
        EXPECT(gbc.e(),  0x5e);
        EXPECT(gbc.h(),  0xae);
        EXPECT(gbc.l(),  0x4b);
        EXPECT(gbc.sp(), 0xd2a2);
        EXPECT(gbc.pc(), 0x7814);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 02C1
        gbc.setState(0x812a, 0x124c, 0xa8a0, 0x2ea3, 0x7844, 0xc0e5, 0x1, 0x1);
        gbc.writeMem(0x812a, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa8);
        EXPECT(gbc.b(),  0x2e);
        EXPECT(gbc.c(),  0xa3);
        EXPECT(gbc.d(),  0x78);
        EXPECT(gbc.e(),  0x44);
        EXPECT(gbc.h(),  0x81);
        EXPECT(gbc.l(),  0xe5);
        EXPECT(gbc.sp(), 0x124c);
        EXPECT(gbc.pc(), 0x812c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x812a), 0xcb);
        EXPECT(gbc.readMem(0x812b), 0x4);
        // CB 04 02C2
        gbc.setState(0x9c30, 0xa60b, 0xe260, 0x6a5, 0xb4c2, 0x4c1f, 0x0, 0x1);
        gbc.writeMem(0x9c30, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe2);
        EXPECT(gbc.b(),  0x6);
        EXPECT(gbc.c(),  0xa5);
        EXPECT(gbc.d(),  0xb4);
        EXPECT(gbc.e(),  0xc2);
        EXPECT(gbc.h(),  0x98);
        EXPECT(gbc.l(),  0x1f);
        EXPECT(gbc.sp(), 0xa60b);
        EXPECT(gbc.pc(), 0x9c32);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9c30), 0xcb);
        EXPECT(gbc.readMem(0x9c31), 0x4);
        // CB 04 02C3
        gbc.setState(0x4737, 0x5416, 0x8d60, 0x1c9b, 0xf5bd, 0xd56a, 0x0, 0x0);
        gbc.writeMem(0x4737, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8d);
        EXPECT(gbc.b(),  0x1c);
        EXPECT(gbc.c(),  0x9b);
        EXPECT(gbc.d(),  0xf5);
        EXPECT(gbc.e(),  0xbd);
        EXPECT(gbc.h(),  0xab);
        EXPECT(gbc.l(),  0x6a);
        EXPECT(gbc.sp(), 0x5416);
        EXPECT(gbc.pc(), 0x4739);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 02C4
        gbc.setState(0x818f, 0xea79, 0x2f70, 0x6ab4, 0x337f, 0x597c, 0x1, 0x1);
        gbc.writeMem(0x818f, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2f);
        EXPECT(gbc.b(),  0x6a);
        EXPECT(gbc.c(),  0xb4);
        EXPECT(gbc.d(),  0x33);
        EXPECT(gbc.e(),  0x7f);
        EXPECT(gbc.h(),  0xb2);
        EXPECT(gbc.l(),  0x7c);
        EXPECT(gbc.sp(), 0xea79);
        EXPECT(gbc.pc(), 0x8191);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x818f), 0xcb);
        EXPECT(gbc.readMem(0x8190), 0x4);
        // CB 04 02C5
        gbc.setState(0x7d8, 0x23b0, 0xd970, 0x904c, 0x561f, 0x7dc4, 0x0, 0x0);
        gbc.writeMem(0x7d8, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd9);
        EXPECT(gbc.b(),  0x90);
        EXPECT(gbc.c(),  0x4c);
        EXPECT(gbc.d(),  0x56);
        EXPECT(gbc.e(),  0x1f);
        EXPECT(gbc.h(),  0xfa);
        EXPECT(gbc.l(),  0xc4);
        EXPECT(gbc.sp(), 0x23b0);
        EXPECT(gbc.pc(), 0x7da);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 02C6
        gbc.setState(0xb821, 0x96e3, 0x79e0, 0x9e34, 0xa6b, 0xf57, 0x1, 0x0);
        gbc.writeMem(0xb821, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x79);
        EXPECT(gbc.b(),  0x9e);
        EXPECT(gbc.c(),  0x34);
        EXPECT(gbc.d(),  0xa);
        EXPECT(gbc.e(),  0x6b);
        EXPECT(gbc.h(),  0x1e);
        EXPECT(gbc.l(),  0x57);
        EXPECT(gbc.sp(), 0x96e3);
        EXPECT(gbc.pc(), 0xb823);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb821), 0xcb);
        EXPECT(gbc.readMem(0xb822), 0x4);
        // CB 04 02C8
        gbc.setState(0x1174, 0xb34, 0xf3f0, 0xbd72, 0x6030, 0x818d, 0x0, 0x0);
        gbc.writeMem(0x1174, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf3);
        EXPECT(gbc.b(),  0xbd);
        EXPECT(gbc.c(),  0x72);
        EXPECT(gbc.d(),  0x60);
        EXPECT(gbc.e(),  0x30);
        EXPECT(gbc.h(),  0x3);
        EXPECT(gbc.l(),  0x8d);
        EXPECT(gbc.sp(), 0xb34);
        EXPECT(gbc.pc(), 0x1176);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 02C9
        gbc.setState(0x78d, 0x2312, 0xf670, 0xa199, 0x421f, 0xefee, 0x1, 0x0);
        gbc.writeMem(0x78d, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf6);
        EXPECT(gbc.b(),  0xa1);
        EXPECT(gbc.c(),  0x99);
        EXPECT(gbc.d(),  0x42);
        EXPECT(gbc.e(),  0x1f);
        EXPECT(gbc.h(),  0xdf);
        EXPECT(gbc.l(),  0xee);
        EXPECT(gbc.sp(), 0x2312);
        EXPECT(gbc.pc(), 0x78f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 02CA
        gbc.setState(0x87c8, 0xcd7d, 0x8e10, 0xebbf, 0x4e65, 0x884e, 0x0, 0x0);
        gbc.writeMem(0x87c8, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8e);
        EXPECT(gbc.b(),  0xeb);
        EXPECT(gbc.c(),  0xbf);
        EXPECT(gbc.d(),  0x4e);
        EXPECT(gbc.e(),  0x65);
        EXPECT(gbc.h(),  0x11);
        EXPECT(gbc.l(),  0x4e);
        EXPECT(gbc.sp(), 0xcd7d);
        EXPECT(gbc.pc(), 0x87ca);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x87c8), 0xcb);
        EXPECT(gbc.readMem(0x87c9), 0x4);
        // CB 04 02CB
        gbc.setState(0x8250, 0x45f, 0x7fd0, 0xcff8, 0xcda9, 0x1ad9, 0x0, 0x0);
        gbc.writeMem(0x8250, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x7f);
        EXPECT(gbc.b(),  0xcf);
        EXPECT(gbc.c(),  0xf8);
        EXPECT(gbc.d(),  0xcd);
        EXPECT(gbc.e(),  0xa9);
        EXPECT(gbc.h(),  0x34);
        EXPECT(gbc.l(),  0xd9);
        EXPECT(gbc.sp(), 0x45f);
        EXPECT(gbc.pc(), 0x8252);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8250), 0xcb);
        EXPECT(gbc.readMem(0x8251), 0x4);
        // CB 04 02CC
        gbc.setState(0xe719, 0x8f94, 0xaf40, 0xf61c, 0x49c5, 0x5f7a, 0x1, 0x1);
        gbc.writeMem(0xe719, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xaf);
        EXPECT(gbc.b(),  0xf6);
        EXPECT(gbc.c(),  0x1c);
        EXPECT(gbc.d(),  0x49);
        EXPECT(gbc.e(),  0xc5);
        EXPECT(gbc.h(),  0xbe);
        EXPECT(gbc.l(),  0x7a);
        EXPECT(gbc.sp(), 0x8f94);
        EXPECT(gbc.pc(), 0xe71b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe719), 0xcb);
        EXPECT(gbc.readMem(0xe71a), 0x4);
        // CB 04 02CD
        gbc.setState(0x40ec, 0x5f60, 0xc3d0, 0x44e0, 0xa92e, 0xda91, 0x1, 0x0);
        gbc.writeMem(0x40ec, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc3);
        EXPECT(gbc.b(),  0x44);
        EXPECT(gbc.c(),  0xe0);
        EXPECT(gbc.d(),  0xa9);
        EXPECT(gbc.e(),  0x2e);
        EXPECT(gbc.h(),  0xb5);
        EXPECT(gbc.l(),  0x91);
        EXPECT(gbc.sp(), 0x5f60);
        EXPECT(gbc.pc(), 0x40ee);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 02CE
        gbc.setState(0x7f98, 0x2676, 0xf3e0, 0x4cef, 0xbb56, 0x7628, 0x0, 0x1);
        gbc.writeMem(0x7f98, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf3);
        EXPECT(gbc.b(),  0x4c);
        EXPECT(gbc.c(),  0xef);
        EXPECT(gbc.d(),  0xbb);
        EXPECT(gbc.e(),  0x56);
        EXPECT(gbc.h(),  0xec);
        EXPECT(gbc.l(),  0x28);
        EXPECT(gbc.sp(), 0x2676);
        EXPECT(gbc.pc(), 0x7f9a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 02CF
        gbc.setState(0xc9ff, 0x6778, 0x65e0, 0x76bd, 0x47cd, 0x3700, 0x1, 0x0);
        gbc.writeMem(0xc9ff, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x65);
        EXPECT(gbc.b(),  0x76);
        EXPECT(gbc.c(),  0xbd);
        EXPECT(gbc.d(),  0x47);
        EXPECT(gbc.e(),  0xcd);
        EXPECT(gbc.h(),  0x6e);
        EXPECT(gbc.l(),  0x0);
        EXPECT(gbc.sp(), 0x6778);
        EXPECT(gbc.pc(), 0xca01);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc9ff), 0xcb);
        EXPECT(gbc.readMem(0xca00), 0x4);
        // CB 04 02D0
        gbc.setState(0xde7d, 0xbca2, 0x6c90, 0x499d, 0x4160, 0x1929, 0x0, 0x0);
        gbc.writeMem(0xde7d, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x6c);
        EXPECT(gbc.b(),  0x49);
        EXPECT(gbc.c(),  0x9d);
        EXPECT(gbc.d(),  0x41);
        EXPECT(gbc.e(),  0x60);
        EXPECT(gbc.h(),  0x32);
        EXPECT(gbc.l(),  0x29);
        EXPECT(gbc.sp(), 0xbca2);
        EXPECT(gbc.pc(), 0xde7f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xde7d), 0xcb);
        EXPECT(gbc.readMem(0xde7e), 0x4);
        // CB 04 02D1
        gbc.setState(0x49fa, 0xdc0d, 0x81f0, 0x70b6, 0xbdc0, 0xf3b3, 0x0, 0x0);
        gbc.writeMem(0x49fa, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x81);
        EXPECT(gbc.b(),  0x70);
        EXPECT(gbc.c(),  0xb6);
        EXPECT(gbc.d(),  0xbd);
        EXPECT(gbc.e(),  0xc0);
        EXPECT(gbc.h(),  0xe7);
        EXPECT(gbc.l(),  0xb3);
        EXPECT(gbc.sp(), 0xdc0d);
        EXPECT(gbc.pc(), 0x49fc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 02D2
        gbc.setState(0xe05, 0x991f, 0xb3c0, 0x63c9, 0x9e2c, 0xc657, 0x1, 0x0);
        gbc.writeMem(0xe05, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb3);
        EXPECT(gbc.b(),  0x63);
        EXPECT(gbc.c(),  0xc9);
        EXPECT(gbc.d(),  0x9e);
        EXPECT(gbc.e(),  0x2c);
        EXPECT(gbc.h(),  0x8d);
        EXPECT(gbc.l(),  0x57);
        EXPECT(gbc.sp(), 0x991f);
        EXPECT(gbc.pc(), 0xe07);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 02D3
        gbc.setState(0x3da5, 0x78f9, 0xf340, 0x3cd0, 0x7ba, 0xacfc, 0x1, 0x1);
        gbc.writeMem(0x3da5, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf3);
        EXPECT(gbc.b(),  0x3c);
        EXPECT(gbc.c(),  0xd0);
        EXPECT(gbc.d(),  0x7);
        EXPECT(gbc.e(),  0xba);
        EXPECT(gbc.h(),  0x59);
        EXPECT(gbc.l(),  0xfc);
        EXPECT(gbc.sp(), 0x78f9);
        EXPECT(gbc.pc(), 0x3da7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 02D4
        gbc.setState(0x365d, 0x4e75, 0xd940, 0xf3bb, 0xcadf, 0x8e11, 0x1, 0x0);
        gbc.writeMem(0x365d, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd9);
        EXPECT(gbc.b(),  0xf3);
        EXPECT(gbc.c(),  0xbb);
        EXPECT(gbc.d(),  0xca);
        EXPECT(gbc.e(),  0xdf);
        EXPECT(gbc.h(),  0x1d);
        EXPECT(gbc.l(),  0x11);
        EXPECT(gbc.sp(), 0x4e75);
        EXPECT(gbc.pc(), 0x365f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 02D5
        gbc.setState(0x3af4, 0xfc8f, 0x1a50, 0x18e6, 0x657c, 0x345a, 0x1, 0x0);
        gbc.writeMem(0x3af4, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1a);
        EXPECT(gbc.b(),  0x18);
        EXPECT(gbc.c(),  0xe6);
        EXPECT(gbc.d(),  0x65);
        EXPECT(gbc.e(),  0x7c);
        EXPECT(gbc.h(),  0x68);
        EXPECT(gbc.l(),  0x5a);
        EXPECT(gbc.sp(), 0xfc8f);
        EXPECT(gbc.pc(), 0x3af6);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 02D6
        gbc.setState(0xcbf1, 0x4378, 0x23f0, 0xb06, 0x67c2, 0x4a36, 0x1, 0x0);
        gbc.writeMem(0xcbf1, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x23);
        EXPECT(gbc.b(),  0xb);
        EXPECT(gbc.c(),  0x6);
        EXPECT(gbc.d(),  0x67);
        EXPECT(gbc.e(),  0xc2);
        EXPECT(gbc.h(),  0x94);
        EXPECT(gbc.l(),  0x36);
        EXPECT(gbc.sp(), 0x4378);
        EXPECT(gbc.pc(), 0xcbf3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcbf1), 0xcb);
        EXPECT(gbc.readMem(0xcbf2), 0x4);
        // CB 04 02D7
        gbc.setState(0xe23, 0x2d1a, 0x60a0, 0xdac2, 0x8230, 0xb516, 0x0, 0x0);
        gbc.writeMem(0xe23, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x60);
        EXPECT(gbc.b(),  0xda);
        EXPECT(gbc.c(),  0xc2);
        EXPECT(gbc.d(),  0x82);
        EXPECT(gbc.e(),  0x30);
        EXPECT(gbc.h(),  0x6b);
        EXPECT(gbc.l(),  0x16);
        EXPECT(gbc.sp(), 0x2d1a);
        EXPECT(gbc.pc(), 0xe25);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 02D8
        gbc.setState(0xbebe, 0xe5a3, 0x22a0, 0x91a5, 0x3d25, 0xb30, 0x0, 0x0);
        gbc.writeMem(0xbebe, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x22);
        EXPECT(gbc.b(),  0x91);
        EXPECT(gbc.c(),  0xa5);
        EXPECT(gbc.d(),  0x3d);
        EXPECT(gbc.e(),  0x25);
        EXPECT(gbc.h(),  0x16);
        EXPECT(gbc.l(),  0x30);
        EXPECT(gbc.sp(), 0xe5a3);
        EXPECT(gbc.pc(), 0xbec0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbebe), 0xcb);
        EXPECT(gbc.readMem(0xbebf), 0x4);
        // CB 04 02D9
        gbc.setState(0x9cb7, 0x5846, 0x10b0, 0x529, 0xd3f4, 0xeff4, 0x0, 0x0);
        gbc.writeMem(0x9cb7, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0x5);
        EXPECT(gbc.c(),  0x29);
        EXPECT(gbc.d(),  0xd3);
        EXPECT(gbc.e(),  0xf4);
        EXPECT(gbc.h(),  0xdf);
        EXPECT(gbc.l(),  0xf4);
        EXPECT(gbc.sp(), 0x5846);
        EXPECT(gbc.pc(), 0x9cb9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9cb7), 0xcb);
        EXPECT(gbc.readMem(0x9cb8), 0x4);
        // CB 04 02DB
        gbc.setState(0x5c6c, 0x703e, 0xfa60, 0xf788, 0xac85, 0xb654, 0x1, 0x0);
        gbc.writeMem(0x5c6c, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xfa);
        EXPECT(gbc.b(),  0xf7);
        EXPECT(gbc.c(),  0x88);
        EXPECT(gbc.d(),  0xac);
        EXPECT(gbc.e(),  0x85);
        EXPECT(gbc.h(),  0x6d);
        EXPECT(gbc.l(),  0x54);
        EXPECT(gbc.sp(), 0x703e);
        EXPECT(gbc.pc(), 0x5c6e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 02DC
        gbc.setState(0x1cc9, 0xa0ac, 0xbe60, 0x2572, 0x5250, 0x4a3c, 0x0, 0x0);
        gbc.writeMem(0x1cc9, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xbe);
        EXPECT(gbc.b(),  0x25);
        EXPECT(gbc.c(),  0x72);
        EXPECT(gbc.d(),  0x52);
        EXPECT(gbc.e(),  0x50);
        EXPECT(gbc.h(),  0x94);
        EXPECT(gbc.l(),  0x3c);
        EXPECT(gbc.sp(), 0xa0ac);
        EXPECT(gbc.pc(), 0x1ccb);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 02DD
        gbc.setState(0x61a1, 0xd010, 0xc390, 0xa2c1, 0x8aa6, 0x2f91, 0x1, 0x0);
        gbc.writeMem(0x61a1, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc3);
        EXPECT(gbc.b(),  0xa2);
        EXPECT(gbc.c(),  0xc1);
        EXPECT(gbc.d(),  0x8a);
        EXPECT(gbc.e(),  0xa6);
        EXPECT(gbc.h(),  0x5e);
        EXPECT(gbc.l(),  0x91);
        EXPECT(gbc.sp(), 0xd010);
        EXPECT(gbc.pc(), 0x61a3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 02DE
        gbc.setState(0x9963, 0x640d, 0x7450, 0x8788, 0x13f1, 0xe79f, 0x0, 0x0);
        gbc.writeMem(0x9963, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x74);
        EXPECT(gbc.b(),  0x87);
        EXPECT(gbc.c(),  0x88);
        EXPECT(gbc.d(),  0x13);
        EXPECT(gbc.e(),  0xf1);
        EXPECT(gbc.h(),  0xcf);
        EXPECT(gbc.l(),  0x9f);
        EXPECT(gbc.sp(), 0x640d);
        EXPECT(gbc.pc(), 0x9965);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9963), 0xcb);
        EXPECT(gbc.readMem(0x9964), 0x4);
        // CB 04 02DF
        gbc.setState(0xa9c3, 0xaaf8, 0x6520, 0x7d92, 0xca7d, 0x8158, 0x0, 0x1);
        gbc.writeMem(0xa9c3, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x65);
        EXPECT(gbc.b(),  0x7d);
        EXPECT(gbc.c(),  0x92);
        EXPECT(gbc.d(),  0xca);
        EXPECT(gbc.e(),  0x7d);
        EXPECT(gbc.h(),  0x3);
        EXPECT(gbc.l(),  0x58);
        EXPECT(gbc.sp(), 0xaaf8);
        EXPECT(gbc.pc(), 0xa9c5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa9c3), 0xcb);
        EXPECT(gbc.readMem(0xa9c4), 0x4);
        // CB 04 02E0
        gbc.setState(0xdea3, 0xe982, 0x1f60, 0x72e0, 0x868b, 0x3796, 0x1, 0x0);
        gbc.writeMem(0xdea3, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1f);
        EXPECT(gbc.b(),  0x72);
        EXPECT(gbc.c(),  0xe0);
        EXPECT(gbc.d(),  0x86);
        EXPECT(gbc.e(),  0x8b);
        EXPECT(gbc.h(),  0x6e);
        EXPECT(gbc.l(),  0x96);
        EXPECT(gbc.sp(), 0xe982);
        EXPECT(gbc.pc(), 0xdea5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdea3), 0xcb);
        EXPECT(gbc.readMem(0xdea4), 0x4);
        // CB 04 02E1
        gbc.setState(0x67de, 0xfd5d, 0xe20, 0x5938, 0xe6d6, 0x9437, 0x0, 0x0);
        gbc.writeMem(0x67de, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe);
        EXPECT(gbc.b(),  0x59);
        EXPECT(gbc.c(),  0x38);
        EXPECT(gbc.d(),  0xe6);
        EXPECT(gbc.e(),  0xd6);
        EXPECT(gbc.h(),  0x29);
        EXPECT(gbc.l(),  0x37);
        EXPECT(gbc.sp(), 0xfd5d);
        EXPECT(gbc.pc(), 0x67e0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 02E2
        gbc.setState(0x15f1, 0x776a, 0x73d0, 0x6bfe, 0x8f0c, 0xd780, 0x0, 0x1);
        gbc.writeMem(0x15f1, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x73);
        EXPECT(gbc.b(),  0x6b);
        EXPECT(gbc.c(),  0xfe);
        EXPECT(gbc.d(),  0x8f);
        EXPECT(gbc.e(),  0xc);
        EXPECT(gbc.h(),  0xaf);
        EXPECT(gbc.l(),  0x80);
        EXPECT(gbc.sp(), 0x776a);
        EXPECT(gbc.pc(), 0x15f3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 02E3
        gbc.setState(0x27d3, 0x1ce3, 0xcc30, 0x5d3a, 0x3baf, 0x245a, 0x1, 0x1);
        gbc.writeMem(0x27d3, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xcc);
        EXPECT(gbc.b(),  0x5d);
        EXPECT(gbc.c(),  0x3a);
        EXPECT(gbc.d(),  0x3b);
        EXPECT(gbc.e(),  0xaf);
        EXPECT(gbc.h(),  0x48);
        EXPECT(gbc.l(),  0x5a);
        EXPECT(gbc.sp(), 0x1ce3);
        EXPECT(gbc.pc(), 0x27d5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 02E4
        gbc.setState(0x24e1, 0xb399, 0x55a0, 0xf52c, 0x59e1, 0xd30d, 0x0, 0x1);
        gbc.writeMem(0x24e1, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x55);
        EXPECT(gbc.b(),  0xf5);
        EXPECT(gbc.c(),  0x2c);
        EXPECT(gbc.d(),  0x59);
        EXPECT(gbc.e(),  0xe1);
        EXPECT(gbc.h(),  0xa7);
        EXPECT(gbc.l(),  0xd);
        EXPECT(gbc.sp(), 0xb399);
        EXPECT(gbc.pc(), 0x24e3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 02E6
        gbc.setState(0x9f93, 0x66e8, 0x92c0, 0x4a44, 0x1d, 0xf31a, 0x0, 0x0);
        gbc.writeMem(0x9f93, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x92);
        EXPECT(gbc.b(),  0x4a);
        EXPECT(gbc.c(),  0x44);
        EXPECT(gbc.d(),  0x0);
        EXPECT(gbc.e(),  0x1d);
        EXPECT(gbc.h(),  0xe7);
        EXPECT(gbc.l(),  0x1a);
        EXPECT(gbc.sp(), 0x66e8);
        EXPECT(gbc.pc(), 0x9f95);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9f93), 0xcb);
        EXPECT(gbc.readMem(0x9f94), 0x4);
        // CB 04 02E7
        gbc.setState(0xaf5c, 0xce45, 0x3d80, 0x530b, 0x8eed, 0x3a15, 0x1, 0x1);
        gbc.writeMem(0xaf5c, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3d);
        EXPECT(gbc.b(),  0x53);
        EXPECT(gbc.c(),  0xb);
        EXPECT(gbc.d(),  0x8e);
        EXPECT(gbc.e(),  0xed);
        EXPECT(gbc.h(),  0x74);
        EXPECT(gbc.l(),  0x15);
        EXPECT(gbc.sp(), 0xce45);
        EXPECT(gbc.pc(), 0xaf5e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xaf5c), 0xcb);
        EXPECT(gbc.readMem(0xaf5d), 0x4);
        // CB 04 02E8
        gbc.setState(0x8e9c, 0xf6ac, 0xb4f0, 0x548b, 0x3593, 0xcda4, 0x0, 0x0);
        gbc.writeMem(0x8e9c, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb4);
        EXPECT(gbc.b(),  0x54);
        EXPECT(gbc.c(),  0x8b);
        EXPECT(gbc.d(),  0x35);
        EXPECT(gbc.e(),  0x93);
        EXPECT(gbc.h(),  0x9b);
        EXPECT(gbc.l(),  0xa4);
        EXPECT(gbc.sp(), 0xf6ac);
        EXPECT(gbc.pc(), 0x8e9e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8e9c), 0xcb);
        EXPECT(gbc.readMem(0x8e9d), 0x4);
        // CB 04 02E9
        gbc.setState(0xb8df, 0xa5b0, 0x1ec0, 0xbe47, 0x89f1, 0xc02f, 0x1, 0x1);
        gbc.writeMem(0xb8df, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1e);
        EXPECT(gbc.b(),  0xbe);
        EXPECT(gbc.c(),  0x47);
        EXPECT(gbc.d(),  0x89);
        EXPECT(gbc.e(),  0xf1);
        EXPECT(gbc.h(),  0x81);
        EXPECT(gbc.l(),  0x2f);
        EXPECT(gbc.sp(), 0xa5b0);
        EXPECT(gbc.pc(), 0xb8e1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb8df), 0xcb);
        EXPECT(gbc.readMem(0xb8e0), 0x4);
        // CB 04 02EA
        gbc.setState(0xc33a, 0x2b8b, 0x3ce0, 0x997f, 0xfb1, 0xc520, 0x0, 0x1);
        gbc.writeMem(0xc33a, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3c);
        EXPECT(gbc.b(),  0x99);
        EXPECT(gbc.c(),  0x7f);
        EXPECT(gbc.d(),  0xf);
        EXPECT(gbc.e(),  0xb1);
        EXPECT(gbc.h(),  0x8b);
        EXPECT(gbc.l(),  0x20);
        EXPECT(gbc.sp(), 0x2b8b);
        EXPECT(gbc.pc(), 0xc33c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc33a), 0xcb);
        EXPECT(gbc.readMem(0xc33b), 0x4);
        // CB 04 02EB
        gbc.setState(0x6dd6, 0x94c0, 0xee50, 0x21a8, 0xcbb, 0xa012, 0x0, 0x1);
        gbc.writeMem(0x6dd6, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xee);
        EXPECT(gbc.b(),  0x21);
        EXPECT(gbc.c(),  0xa8);
        EXPECT(gbc.d(),  0xc);
        EXPECT(gbc.e(),  0xbb);
        EXPECT(gbc.h(),  0x41);
        EXPECT(gbc.l(),  0x12);
        EXPECT(gbc.sp(), 0x94c0);
        EXPECT(gbc.pc(), 0x6dd8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 02EC
        gbc.setState(0x3d74, 0xc302, 0xa210, 0x76a, 0x5469, 0xf4b0, 0x0, 0x1);
        gbc.writeMem(0x3d74, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa2);
        EXPECT(gbc.b(),  0x7);
        EXPECT(gbc.c(),  0x6a);
        EXPECT(gbc.d(),  0x54);
        EXPECT(gbc.e(),  0x69);
        EXPECT(gbc.h(),  0xe9);
        EXPECT(gbc.l(),  0xb0);
        EXPECT(gbc.sp(), 0xc302);
        EXPECT(gbc.pc(), 0x3d76);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 02ED
        gbc.setState(0xa3a9, 0x1e3b, 0x3d0, 0x3520, 0xbcb1, 0x5876, 0x0, 0x0);
        gbc.writeMem(0xa3a9, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3);
        EXPECT(gbc.b(),  0x35);
        EXPECT(gbc.c(),  0x20);
        EXPECT(gbc.d(),  0xbc);
        EXPECT(gbc.e(),  0xb1);
        EXPECT(gbc.h(),  0xb0);
        EXPECT(gbc.l(),  0x76);
        EXPECT(gbc.sp(), 0x1e3b);
        EXPECT(gbc.pc(), 0xa3ab);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa3a9), 0xcb);
        EXPECT(gbc.readMem(0xa3aa), 0x4);
        // CB 04 02EE
        gbc.setState(0xa9e6, 0x205f, 0x6ac0, 0xa295, 0xf476, 0x3eb, 0x0, 0x0);
        gbc.writeMem(0xa9e6, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x6a);
        EXPECT(gbc.b(),  0xa2);
        EXPECT(gbc.c(),  0x95);
        EXPECT(gbc.d(),  0xf4);
        EXPECT(gbc.e(),  0x76);
        EXPECT(gbc.h(),  0x6);
        EXPECT(gbc.l(),  0xeb);
        EXPECT(gbc.sp(), 0x205f);
        EXPECT(gbc.pc(), 0xa9e8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa9e6), 0xcb);
        EXPECT(gbc.readMem(0xa9e7), 0x4);
        // CB 04 02EF
        gbc.setState(0xdeee, 0xca16, 0xaf20, 0xd4ea, 0x7a97, 0x85e7, 0x0, 0x0);
        gbc.writeMem(0xdeee, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xaf);
        EXPECT(gbc.b(),  0xd4);
        EXPECT(gbc.c(),  0xea);
        EXPECT(gbc.d(),  0x7a);
        EXPECT(gbc.e(),  0x97);
        EXPECT(gbc.h(),  0xb);
        EXPECT(gbc.l(),  0xe7);
        EXPECT(gbc.sp(), 0xca16);
        EXPECT(gbc.pc(), 0xdef0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xdeee), 0xcb);
        EXPECT(gbc.readMem(0xdeef), 0x4);
        // CB 04 02F0
        gbc.setState(0x9b48, 0xc8b, 0x1410, 0xbc9e, 0xd18c, 0x2a7c, 0x0, 0x0);
        gbc.writeMem(0x9b48, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x14);
        EXPECT(gbc.b(),  0xbc);
        EXPECT(gbc.c(),  0x9e);
        EXPECT(gbc.d(),  0xd1);
        EXPECT(gbc.e(),  0x8c);
        EXPECT(gbc.h(),  0x54);
        EXPECT(gbc.l(),  0x7c);
        EXPECT(gbc.sp(), 0xc8b);
        EXPECT(gbc.pc(), 0x9b4a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9b48), 0xcb);
        EXPECT(gbc.readMem(0x9b49), 0x4);
        // CB 04 02F1
        gbc.setState(0x3438, 0xee37, 0x3a20, 0x74a7, 0x8a0a, 0xa07, 0x0, 0x0);
        gbc.writeMem(0x3438, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3a);
        EXPECT(gbc.b(),  0x74);
        EXPECT(gbc.c(),  0xa7);
        EXPECT(gbc.d(),  0x8a);
        EXPECT(gbc.e(),  0xa);
        EXPECT(gbc.h(),  0x14);
        EXPECT(gbc.l(),  0x7);
        EXPECT(gbc.sp(), 0xee37);
        EXPECT(gbc.pc(), 0x343a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 02F2
        gbc.setState(0x2339, 0x1138, 0xc5f0, 0x4c49, 0xa01c, 0xa1b2, 0x0, 0x1);
        gbc.writeMem(0x2339, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc5);
        EXPECT(gbc.b(),  0x4c);
        EXPECT(gbc.c(),  0x49);
        EXPECT(gbc.d(),  0xa0);
        EXPECT(gbc.e(),  0x1c);
        EXPECT(gbc.h(),  0x43);
        EXPECT(gbc.l(),  0xb2);
        EXPECT(gbc.sp(), 0x1138);
        EXPECT(gbc.pc(), 0x233b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 02F3
        gbc.setState(0x2752, 0x7398, 0xc810, 0xecb9, 0xe15, 0x2d5d, 0x0, 0x0);
        gbc.writeMem(0x2752, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc8);
        EXPECT(gbc.b(),  0xec);
        EXPECT(gbc.c(),  0xb9);
        EXPECT(gbc.d(),  0xe);
        EXPECT(gbc.e(),  0x15);
        EXPECT(gbc.h(),  0x5a);
        EXPECT(gbc.l(),  0x5d);
        EXPECT(gbc.sp(), 0x7398);
        EXPECT(gbc.pc(), 0x2754);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 02F4
        gbc.setState(0xcc2a, 0x9739, 0x1f30, 0x460a, 0x1d6e, 0x32d9, 0x1, 0x0);
        gbc.writeMem(0xcc2a, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1f);
        EXPECT(gbc.b(),  0x46);
        EXPECT(gbc.c(),  0xa);
        EXPECT(gbc.d(),  0x1d);
        EXPECT(gbc.e(),  0x6e);
        EXPECT(gbc.h(),  0x64);
        EXPECT(gbc.l(),  0xd9);
        EXPECT(gbc.sp(), 0x9739);
        EXPECT(gbc.pc(), 0xcc2c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcc2a), 0xcb);
        EXPECT(gbc.readMem(0xcc2b), 0x4);
        // CB 04 02F5
        gbc.setState(0xd504, 0x557c, 0x3880, 0x4ec5, 0xfd7f, 0xa007, 0x1, 0x1);
        gbc.writeMem(0xd504, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x38);
        EXPECT(gbc.b(),  0x4e);
        EXPECT(gbc.c(),  0xc5);
        EXPECT(gbc.d(),  0xfd);
        EXPECT(gbc.e(),  0x7f);
        EXPECT(gbc.h(),  0x41);
        EXPECT(gbc.l(),  0x7);
        EXPECT(gbc.sp(), 0x557c);
        EXPECT(gbc.pc(), 0xd506);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd504), 0xcb);
        EXPECT(gbc.readMem(0xd505), 0x4);
        // CB 04 02F6
        gbc.setState(0x46e8, 0x437d, 0x65e0, 0xb2f6, 0xe716, 0xaa40, 0x1, 0x1);
        gbc.writeMem(0x46e8, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x65);
        EXPECT(gbc.b(),  0xb2);
        EXPECT(gbc.c(),  0xf6);
        EXPECT(gbc.d(),  0xe7);
        EXPECT(gbc.e(),  0x16);
        EXPECT(gbc.h(),  0x55);
        EXPECT(gbc.l(),  0x40);
        EXPECT(gbc.sp(), 0x437d);
        EXPECT(gbc.pc(), 0x46ea);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 02F7
        gbc.setState(0xbeef, 0x18ba, 0x8a00, 0x9432, 0x1a9a, 0x1a3b, 0x0, 0x1);
        gbc.writeMem(0xbeef, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8a);
        EXPECT(gbc.b(),  0x94);
        EXPECT(gbc.c(),  0x32);
        EXPECT(gbc.d(),  0x1a);
        EXPECT(gbc.e(),  0x9a);
        EXPECT(gbc.h(),  0x34);
        EXPECT(gbc.l(),  0x3b);
        EXPECT(gbc.sp(), 0x18ba);
        EXPECT(gbc.pc(), 0xbef1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbeef), 0xcb);
        EXPECT(gbc.readMem(0xbef0), 0x4);
        // CB 04 02F8
        gbc.setState(0x931, 0x93a2, 0x3a70, 0x98e2, 0x369e, 0xd8d1, 0x0, 0x1);
        gbc.writeMem(0x931, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3a);
        EXPECT(gbc.b(),  0x98);
        EXPECT(gbc.c(),  0xe2);
        EXPECT(gbc.d(),  0x36);
        EXPECT(gbc.e(),  0x9e);
        EXPECT(gbc.h(),  0xb1);
        EXPECT(gbc.l(),  0xd1);
        EXPECT(gbc.sp(), 0x93a2);
        EXPECT(gbc.pc(), 0x933);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 02F9
        gbc.setState(0xb587, 0x5c89, 0x6860, 0x9585, 0x15b6, 0x154b, 0x0, 0x1);
        gbc.writeMem(0xb587, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x68);
        EXPECT(gbc.b(),  0x95);
        EXPECT(gbc.c(),  0x85);
        EXPECT(gbc.d(),  0x15);
        EXPECT(gbc.e(),  0xb6);
        EXPECT(gbc.h(),  0x2a);
        EXPECT(gbc.l(),  0x4b);
        EXPECT(gbc.sp(), 0x5c89);
        EXPECT(gbc.pc(), 0xb589);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb587), 0xcb);
        EXPECT(gbc.readMem(0xb588), 0x4);
        // CB 04 02FA
        gbc.setState(0x2b90, 0xdcb8, 0xd560, 0x9cd4, 0xedd3, 0xbc58, 0x1, 0x1);
        gbc.writeMem(0x2b90, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd5);
        EXPECT(gbc.b(),  0x9c);
        EXPECT(gbc.c(),  0xd4);
        EXPECT(gbc.d(),  0xed);
        EXPECT(gbc.e(),  0xd3);
        EXPECT(gbc.h(),  0x79);
        EXPECT(gbc.l(),  0x58);
        EXPECT(gbc.sp(), 0xdcb8);
        EXPECT(gbc.pc(), 0x2b92);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 02FB
        gbc.setState(0xaa6a, 0xf5f6, 0x5270, 0x9351, 0xd819, 0xabc0, 0x1, 0x0);
        gbc.writeMem(0xaa6a, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x52);
        EXPECT(gbc.b(),  0x93);
        EXPECT(gbc.c(),  0x51);
        EXPECT(gbc.d(),  0xd8);
        EXPECT(gbc.e(),  0x19);
        EXPECT(gbc.h(),  0x57);
        EXPECT(gbc.l(),  0xc0);
        EXPECT(gbc.sp(), 0xf5f6);
        EXPECT(gbc.pc(), 0xaa6c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xaa6a), 0xcb);
        EXPECT(gbc.readMem(0xaa6b), 0x4);
        // CB 04 02FC
        gbc.setState(0x8818, 0xcffa, 0xfb0, 0xeab8, 0x54a1, 0x63ee, 0x0, 0x1);
        gbc.writeMem(0x8818, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf);
        EXPECT(gbc.b(),  0xea);
        EXPECT(gbc.c(),  0xb8);
        EXPECT(gbc.d(),  0x54);
        EXPECT(gbc.e(),  0xa1);
        EXPECT(gbc.h(),  0xc6);
        EXPECT(gbc.l(),  0xee);
        EXPECT(gbc.sp(), 0xcffa);
        EXPECT(gbc.pc(), 0x881a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8818), 0xcb);
        EXPECT(gbc.readMem(0x8819), 0x4);
        // CB 04 02FD
        gbc.setState(0xc310, 0x6cc0, 0xe740, 0x7737, 0xac24, 0xde68, 0x1, 0x1);
        gbc.writeMem(0xc310, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe7);
        EXPECT(gbc.b(),  0x77);
        EXPECT(gbc.c(),  0x37);
        EXPECT(gbc.d(),  0xac);
        EXPECT(gbc.e(),  0x24);
        EXPECT(gbc.h(),  0xbd);
        EXPECT(gbc.l(),  0x68);
        EXPECT(gbc.sp(), 0x6cc0);
        EXPECT(gbc.pc(), 0xc312);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc310), 0xcb);
        EXPECT(gbc.readMem(0xc311), 0x4);
        // CB 04 02FE
        gbc.setState(0x6c48, 0x2ea0, 0x5040, 0x1661, 0xdab8, 0x559f, 0x1, 0x1);
        gbc.writeMem(0x6c48, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x50);
        EXPECT(gbc.b(),  0x16);
        EXPECT(gbc.c(),  0x61);
        EXPECT(gbc.d(),  0xda);
        EXPECT(gbc.e(),  0xb8);
        EXPECT(gbc.h(),  0xaa);
        EXPECT(gbc.l(),  0x9f);
        EXPECT(gbc.sp(), 0x2ea0);
        EXPECT(gbc.pc(), 0x6c4a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 02FF
        gbc.setState(0x932f, 0x773e, 0xaf30, 0x6e6e, 0xb439, 0x1955, 0x0, 0x1);
        gbc.writeMem(0x932f, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xaf);
        EXPECT(gbc.b(),  0x6e);
        EXPECT(gbc.c(),  0x6e);
        EXPECT(gbc.d(),  0xb4);
        EXPECT(gbc.e(),  0x39);
        EXPECT(gbc.h(),  0x32);
        EXPECT(gbc.l(),  0x55);
        EXPECT(gbc.sp(), 0x773e);
        EXPECT(gbc.pc(), 0x9331);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x932f), 0xcb);
        EXPECT(gbc.readMem(0x9330), 0x4);
        // CB 04 0300
        gbc.setState(0xc03e, 0x838c, 0x2120, 0x8750, 0x9f80, 0x2253, 0x1, 0x1);
        gbc.writeMem(0xc03e, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x21);
        EXPECT(gbc.b(),  0x87);
        EXPECT(gbc.c(),  0x50);
        EXPECT(gbc.d(),  0x9f);
        EXPECT(gbc.e(),  0x80);
        EXPECT(gbc.h(),  0x44);
        EXPECT(gbc.l(),  0x53);
        EXPECT(gbc.sp(), 0x838c);
        EXPECT(gbc.pc(), 0xc040);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc03e), 0xcb);
        EXPECT(gbc.readMem(0xc03f), 0x4);
        // CB 04 0301
        gbc.setState(0xe9c4, 0x9ed9, 0xa5b0, 0xc0b7, 0x17e6, 0x4e0, 0x1, 0x1);
        gbc.writeMem(0xe9c4, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa5);
        EXPECT(gbc.b(),  0xc0);
        EXPECT(gbc.c(),  0xb7);
        EXPECT(gbc.d(),  0x17);
        EXPECT(gbc.e(),  0xe6);
        EXPECT(gbc.h(),  0x8);
        EXPECT(gbc.l(),  0xe0);
        EXPECT(gbc.sp(), 0x9ed9);
        EXPECT(gbc.pc(), 0xe9c6);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe9c4), 0xcb);
        EXPECT(gbc.readMem(0xe9c5), 0x4);
        // CB 04 0302
        gbc.setState(0xa248, 0xcfbb, 0xd60, 0xe8bf, 0x1975, 0xc63a, 0x1, 0x0);
        gbc.writeMem(0xa248, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd);
        EXPECT(gbc.b(),  0xe8);
        EXPECT(gbc.c(),  0xbf);
        EXPECT(gbc.d(),  0x19);
        EXPECT(gbc.e(),  0x75);
        EXPECT(gbc.h(),  0x8d);
        EXPECT(gbc.l(),  0x3a);
        EXPECT(gbc.sp(), 0xcfbb);
        EXPECT(gbc.pc(), 0xa24a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa248), 0xcb);
        EXPECT(gbc.readMem(0xa249), 0x4);
        // CB 04 0303
        gbc.setState(0x3d0, 0xdaf0, 0x4890, 0x3d86, 0xb2f6, 0xf966, 0x1, 0x0);
        gbc.writeMem(0x3d0, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x48);
        EXPECT(gbc.b(),  0x3d);
        EXPECT(gbc.c(),  0x86);
        EXPECT(gbc.d(),  0xb2);
        EXPECT(gbc.e(),  0xf6);
        EXPECT(gbc.h(),  0xf3);
        EXPECT(gbc.l(),  0x66);
        EXPECT(gbc.sp(), 0xdaf0);
        EXPECT(gbc.pc(), 0x3d2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0304
        gbc.setState(0x1a07, 0x73fd, 0x9c00, 0x70ff, 0xa104, 0x2199, 0x0, 0x1);
        gbc.writeMem(0x1a07, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x9c);
        EXPECT(gbc.b(),  0x70);
        EXPECT(gbc.c(),  0xff);
        EXPECT(gbc.d(),  0xa1);
        EXPECT(gbc.e(),  0x4);
        EXPECT(gbc.h(),  0x42);
        EXPECT(gbc.l(),  0x99);
        EXPECT(gbc.sp(), 0x73fd);
        EXPECT(gbc.pc(), 0x1a09);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0306
        gbc.setState(0x32f7, 0x9de2, 0x3be0, 0xff0c, 0xff5, 0xfe97, 0x1, 0x1);
        gbc.writeMem(0x32f7, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3b);
        EXPECT(gbc.b(),  0xff);
        EXPECT(gbc.c(),  0xc);
        EXPECT(gbc.d(),  0xf);
        EXPECT(gbc.e(),  0xf5);
        EXPECT(gbc.h(),  0xfd);
        EXPECT(gbc.l(),  0x97);
        EXPECT(gbc.sp(), 0x9de2);
        EXPECT(gbc.pc(), 0x32f9);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0307
        gbc.setState(0x29ee, 0xa73e, 0xf310, 0xcaf7, 0x678a, 0xaf19, 0x1, 0x1);
        gbc.writeMem(0x29ee, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf3);
        EXPECT(gbc.b(),  0xca);
        EXPECT(gbc.c(),  0xf7);
        EXPECT(gbc.d(),  0x67);
        EXPECT(gbc.e(),  0x8a);
        EXPECT(gbc.h(),  0x5f);
        EXPECT(gbc.l(),  0x19);
        EXPECT(gbc.sp(), 0xa73e);
        EXPECT(gbc.pc(), 0x29f0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0308
        gbc.setState(0xb19f, 0xd82, 0xa710, 0xde6, 0xc1af, 0x56ff, 0x1, 0x1);
        gbc.writeMem(0xb19f, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa7);
        EXPECT(gbc.b(),  0xd);
        EXPECT(gbc.c(),  0xe6);
        EXPECT(gbc.d(),  0xc1);
        EXPECT(gbc.e(),  0xaf);
        EXPECT(gbc.h(),  0xac);
        EXPECT(gbc.l(),  0xff);
        EXPECT(gbc.sp(), 0xd82);
        EXPECT(gbc.pc(), 0xb1a1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb19f), 0xcb);
        EXPECT(gbc.readMem(0xb1a0), 0x4);
        // CB 04 0309
        gbc.setState(0x4ad7, 0x6dba, 0xa600, 0x7c50, 0xf83f, 0xf0e7, 0x0, 0x0);
        gbc.writeMem(0x4ad7, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa6);
        EXPECT(gbc.b(),  0x7c);
        EXPECT(gbc.c(),  0x50);
        EXPECT(gbc.d(),  0xf8);
        EXPECT(gbc.e(),  0x3f);
        EXPECT(gbc.h(),  0xe1);
        EXPECT(gbc.l(),  0xe7);
        EXPECT(gbc.sp(), 0x6dba);
        EXPECT(gbc.pc(), 0x4ad9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 030A
        gbc.setState(0x343b, 0x682f, 0x5900, 0x12db, 0x1cef, 0xb7d4, 0x1, 0x0);
        gbc.writeMem(0x343b, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x59);
        EXPECT(gbc.b(),  0x12);
        EXPECT(gbc.c(),  0xdb);
        EXPECT(gbc.d(),  0x1c);
        EXPECT(gbc.e(),  0xef);
        EXPECT(gbc.h(),  0x6f);
        EXPECT(gbc.l(),  0xd4);
        EXPECT(gbc.sp(), 0x682f);
        EXPECT(gbc.pc(), 0x343d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 030B
        gbc.setState(0x9232, 0xf2c7, 0x2800, 0xd22d, 0x93a3, 0xb226, 0x1, 0x1);
        gbc.writeMem(0x9232, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0xd2);
        EXPECT(gbc.c(),  0x2d);
        EXPECT(gbc.d(),  0x93);
        EXPECT(gbc.e(),  0xa3);
        EXPECT(gbc.h(),  0x65);
        EXPECT(gbc.l(),  0x26);
        EXPECT(gbc.sp(), 0xf2c7);
        EXPECT(gbc.pc(), 0x9234);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9232), 0xcb);
        EXPECT(gbc.readMem(0x9233), 0x4);
        // CB 04 030C
        gbc.setState(0xdbd3, 0x451a, 0x7ed0, 0xc3b5, 0xf3c5, 0x2a62, 0x1, 0x1);
        gbc.writeMem(0xdbd3, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x7e);
        EXPECT(gbc.b(),  0xc3);
        EXPECT(gbc.c(),  0xb5);
        EXPECT(gbc.d(),  0xf3);
        EXPECT(gbc.e(),  0xc5);
        EXPECT(gbc.h(),  0x54);
        EXPECT(gbc.l(),  0x62);
        EXPECT(gbc.sp(), 0x451a);
        EXPECT(gbc.pc(), 0xdbd5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdbd3), 0xcb);
        EXPECT(gbc.readMem(0xdbd4), 0x4);
        // CB 04 030D
        gbc.setState(0xc48e, 0xa7f6, 0x6480, 0x4fb6, 0x5537, 0xb890, 0x0, 0x0);
        gbc.writeMem(0xc48e, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x64);
        EXPECT(gbc.b(),  0x4f);
        EXPECT(gbc.c(),  0xb6);
        EXPECT(gbc.d(),  0x55);
        EXPECT(gbc.e(),  0x37);
        EXPECT(gbc.h(),  0x71);
        EXPECT(gbc.l(),  0x90);
        EXPECT(gbc.sp(), 0xa7f6);
        EXPECT(gbc.pc(), 0xc490);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc48e), 0xcb);
        EXPECT(gbc.readMem(0xc48f), 0x4);
        // CB 04 030E
        gbc.setState(0xdbd, 0x225e, 0x54d0, 0xef78, 0x77d5, 0xf7f3, 0x0, 0x1);
        gbc.writeMem(0xdbd, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x54);
        EXPECT(gbc.b(),  0xef);
        EXPECT(gbc.c(),  0x78);
        EXPECT(gbc.d(),  0x77);
        EXPECT(gbc.e(),  0xd5);
        EXPECT(gbc.h(),  0xef);
        EXPECT(gbc.l(),  0xf3);
        EXPECT(gbc.sp(), 0x225e);
        EXPECT(gbc.pc(), 0xdbf);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 030F
        gbc.setState(0x1f0, 0x8172, 0x5a30, 0xe302, 0x69f4, 0xec1b, 0x1, 0x1);
        gbc.writeMem(0x1f0, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x5a);
        EXPECT(gbc.b(),  0xe3);
        EXPECT(gbc.c(),  0x2);
        EXPECT(gbc.d(),  0x69);
        EXPECT(gbc.e(),  0xf4);
        EXPECT(gbc.h(),  0xd9);
        EXPECT(gbc.l(),  0x1b);
        EXPECT(gbc.sp(), 0x8172);
        EXPECT(gbc.pc(), 0x1f2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0310
        gbc.setState(0xd536, 0x2843, 0xc5a0, 0x64ef, 0x1fb9, 0xa687, 0x1, 0x1);
        gbc.writeMem(0xd536, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc5);
        EXPECT(gbc.b(),  0x64);
        EXPECT(gbc.c(),  0xef);
        EXPECT(gbc.d(),  0x1f);
        EXPECT(gbc.e(),  0xb9);
        EXPECT(gbc.h(),  0x4d);
        EXPECT(gbc.l(),  0x87);
        EXPECT(gbc.sp(), 0x2843);
        EXPECT(gbc.pc(), 0xd538);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd536), 0xcb);
        EXPECT(gbc.readMem(0xd537), 0x4);
        // CB 04 0311
        gbc.setState(0xca7a, 0xedf5, 0x2ae0, 0x4048, 0x324, 0xa8a4, 0x0, 0x0);
        gbc.writeMem(0xca7a, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2a);
        EXPECT(gbc.b(),  0x40);
        EXPECT(gbc.c(),  0x48);
        EXPECT(gbc.d(),  0x3);
        EXPECT(gbc.e(),  0x24);
        EXPECT(gbc.h(),  0x51);
        EXPECT(gbc.l(),  0xa4);
        EXPECT(gbc.sp(), 0xedf5);
        EXPECT(gbc.pc(), 0xca7c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xca7a), 0xcb);
        EXPECT(gbc.readMem(0xca7b), 0x4);
        // CB 04 0312
        gbc.setState(0x845e, 0xc9d8, 0x9710, 0xd2f5, 0xa9cf, 0x6466, 0x1, 0x1);
        gbc.writeMem(0x845e, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x97);
        EXPECT(gbc.b(),  0xd2);
        EXPECT(gbc.c(),  0xf5);
        EXPECT(gbc.d(),  0xa9);
        EXPECT(gbc.e(),  0xcf);
        EXPECT(gbc.h(),  0xc8);
        EXPECT(gbc.l(),  0x66);
        EXPECT(gbc.sp(), 0xc9d8);
        EXPECT(gbc.pc(), 0x8460);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x845e), 0xcb);
        EXPECT(gbc.readMem(0x845f), 0x4);
        // CB 04 0313
        gbc.setState(0xdf0c, 0xe4db, 0xeb50, 0x5212, 0x6ab4, 0x3533, 0x1, 0x1);
        gbc.writeMem(0xdf0c, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xeb);
        EXPECT(gbc.b(),  0x52);
        EXPECT(gbc.c(),  0x12);
        EXPECT(gbc.d(),  0x6a);
        EXPECT(gbc.e(),  0xb4);
        EXPECT(gbc.h(),  0x6a);
        EXPECT(gbc.l(),  0x33);
        EXPECT(gbc.sp(), 0xe4db);
        EXPECT(gbc.pc(), 0xdf0e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdf0c), 0xcb);
        EXPECT(gbc.readMem(0xdf0d), 0x4);
        // CB 04 0314
        gbc.setState(0x5226, 0x3b16, 0xc550, 0xc4ee, 0x6467, 0xf75f, 0x0, 0x1);
        gbc.writeMem(0x5226, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc5);
        EXPECT(gbc.b(),  0xc4);
        EXPECT(gbc.c(),  0xee);
        EXPECT(gbc.d(),  0x64);
        EXPECT(gbc.e(),  0x67);
        EXPECT(gbc.h(),  0xef);
        EXPECT(gbc.l(),  0x5f);
        EXPECT(gbc.sp(), 0x3b16);
        EXPECT(gbc.pc(), 0x5228);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0315
        gbc.setState(0x9fbb, 0x8932, 0xbef0, 0xe0fa, 0x46a3, 0xc474, 0x0, 0x1);
        gbc.writeMem(0x9fbb, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xbe);
        EXPECT(gbc.b(),  0xe0);
        EXPECT(gbc.c(),  0xfa);
        EXPECT(gbc.d(),  0x46);
        EXPECT(gbc.e(),  0xa3);
        EXPECT(gbc.h(),  0x89);
        EXPECT(gbc.l(),  0x74);
        EXPECT(gbc.sp(), 0x8932);
        EXPECT(gbc.pc(), 0x9fbd);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9fbb), 0xcb);
        EXPECT(gbc.readMem(0x9fbc), 0x4);
        // CB 04 0316
        gbc.setState(0x3d62, 0x40d6, 0x44e0, 0x4966, 0x84fc, 0x1cac, 0x1, 0x0);
        gbc.writeMem(0x3d62, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x44);
        EXPECT(gbc.b(),  0x49);
        EXPECT(gbc.c(),  0x66);
        EXPECT(gbc.d(),  0x84);
        EXPECT(gbc.e(),  0xfc);
        EXPECT(gbc.h(),  0x38);
        EXPECT(gbc.l(),  0xac);
        EXPECT(gbc.sp(), 0x40d6);
        EXPECT(gbc.pc(), 0x3d64);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0317
        gbc.setState(0xc84, 0xa297, 0xaf80, 0x761, 0x31b2, 0x929a, 0x0, 0x0);
        gbc.writeMem(0xc84, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xaf);
        EXPECT(gbc.b(),  0x7);
        EXPECT(gbc.c(),  0x61);
        EXPECT(gbc.d(),  0x31);
        EXPECT(gbc.e(),  0xb2);
        EXPECT(gbc.h(),  0x25);
        EXPECT(gbc.l(),  0x9a);
        EXPECT(gbc.sp(), 0xa297);
        EXPECT(gbc.pc(), 0xc86);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0318
        gbc.setState(0x994b, 0x66cd, 0x27b0, 0xbdbd, 0x4cc5, 0x9c93, 0x0, 0x0);
        gbc.writeMem(0x994b, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x27);
        EXPECT(gbc.b(),  0xbd);
        EXPECT(gbc.c(),  0xbd);
        EXPECT(gbc.d(),  0x4c);
        EXPECT(gbc.e(),  0xc5);
        EXPECT(gbc.h(),  0x39);
        EXPECT(gbc.l(),  0x93);
        EXPECT(gbc.sp(), 0x66cd);
        EXPECT(gbc.pc(), 0x994d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x994b), 0xcb);
        EXPECT(gbc.readMem(0x994c), 0x4);
        // CB 04 0319
        gbc.setState(0x6b7c, 0x1840, 0xe340, 0x56fb, 0x8e7a, 0x5ba, 0x0, 0x1);
        gbc.writeMem(0x6b7c, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe3);
        EXPECT(gbc.b(),  0x56);
        EXPECT(gbc.c(),  0xfb);
        EXPECT(gbc.d(),  0x8e);
        EXPECT(gbc.e(),  0x7a);
        EXPECT(gbc.h(),  0xa);
        EXPECT(gbc.l(),  0xba);
        EXPECT(gbc.sp(), 0x1840);
        EXPECT(gbc.pc(), 0x6b7e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 031A
        gbc.setState(0x1829, 0x6ae1, 0x2760, 0xb05f, 0x419a, 0x728e, 0x0, 0x1);
        gbc.writeMem(0x1829, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x27);
        EXPECT(gbc.b(),  0xb0);
        EXPECT(gbc.c(),  0x5f);
        EXPECT(gbc.d(),  0x41);
        EXPECT(gbc.e(),  0x9a);
        EXPECT(gbc.h(),  0xe4);
        EXPECT(gbc.l(),  0x8e);
        EXPECT(gbc.sp(), 0x6ae1);
        EXPECT(gbc.pc(), 0x182b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 031B
        gbc.setState(0xb5b9, 0x4276, 0xce80, 0x6690, 0xe7ce, 0x519c, 0x1, 0x1);
        gbc.writeMem(0xb5b9, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xce);
        EXPECT(gbc.b(),  0x66);
        EXPECT(gbc.c(),  0x90);
        EXPECT(gbc.d(),  0xe7);
        EXPECT(gbc.e(),  0xce);
        EXPECT(gbc.h(),  0xa2);
        EXPECT(gbc.l(),  0x9c);
        EXPECT(gbc.sp(), 0x4276);
        EXPECT(gbc.pc(), 0xb5bb);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb5b9), 0xcb);
        EXPECT(gbc.readMem(0xb5ba), 0x4);
        // CB 04 031C
        gbc.setState(0xd07c, 0xdfa0, 0x6680, 0x43a7, 0xea7d, 0x4170, 0x0, 0x0);
        gbc.writeMem(0xd07c, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x66);
        EXPECT(gbc.b(),  0x43);
        EXPECT(gbc.c(),  0xa7);
        EXPECT(gbc.d(),  0xea);
        EXPECT(gbc.e(),  0x7d);
        EXPECT(gbc.h(),  0x82);
        EXPECT(gbc.l(),  0x70);
        EXPECT(gbc.sp(), 0xdfa0);
        EXPECT(gbc.pc(), 0xd07e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd07c), 0xcb);
        EXPECT(gbc.readMem(0xd07d), 0x4);
        // CB 04 031D
        gbc.setState(0x2ee, 0xf11c, 0x840, 0xa303, 0xfb29, 0x681e, 0x1, 0x0);
        gbc.writeMem(0x2ee, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0xa3);
        EXPECT(gbc.c(),  0x3);
        EXPECT(gbc.d(),  0xfb);
        EXPECT(gbc.e(),  0x29);
        EXPECT(gbc.h(),  0xd0);
        EXPECT(gbc.l(),  0x1e);
        EXPECT(gbc.sp(), 0xf11c);
        EXPECT(gbc.pc(), 0x2f0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 031E
        gbc.setState(0x613a, 0x12c0, 0x3c20, 0x4131, 0x156e, 0xf32c, 0x0, 0x0);
        gbc.writeMem(0x613a, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3c);
        EXPECT(gbc.b(),  0x41);
        EXPECT(gbc.c(),  0x31);
        EXPECT(gbc.d(),  0x15);
        EXPECT(gbc.e(),  0x6e);
        EXPECT(gbc.h(),  0xe7);
        EXPECT(gbc.l(),  0x2c);
        EXPECT(gbc.sp(), 0x12c0);
        EXPECT(gbc.pc(), 0x613c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 031F
        gbc.setState(0x4c0, 0xa882, 0xb510, 0xe2a9, 0x611f, 0x6058, 0x0, 0x0);
        gbc.writeMem(0x4c0, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb5);
        EXPECT(gbc.b(),  0xe2);
        EXPECT(gbc.c(),  0xa9);
        EXPECT(gbc.d(),  0x61);
        EXPECT(gbc.e(),  0x1f);
        EXPECT(gbc.h(),  0xc0);
        EXPECT(gbc.l(),  0x58);
        EXPECT(gbc.sp(), 0xa882);
        EXPECT(gbc.pc(), 0x4c2);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0320
        gbc.setState(0x24f2, 0x4b6f, 0xe980, 0x8bf1, 0xc62, 0xaa19, 0x0, 0x0);
        gbc.writeMem(0x24f2, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe9);
        EXPECT(gbc.b(),  0x8b);
        EXPECT(gbc.c(),  0xf1);
        EXPECT(gbc.d(),  0xc);
        EXPECT(gbc.e(),  0x62);
        EXPECT(gbc.h(),  0x55);
        EXPECT(gbc.l(),  0x19);
        EXPECT(gbc.sp(), 0x4b6f);
        EXPECT(gbc.pc(), 0x24f4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0321
        gbc.setState(0xa5ee, 0x4eb0, 0xc320, 0xab0, 0xbaf4, 0x5a9d, 0x1, 0x1);
        gbc.writeMem(0xa5ee, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc3);
        EXPECT(gbc.b(),  0xa);
        EXPECT(gbc.c(),  0xb0);
        EXPECT(gbc.d(),  0xba);
        EXPECT(gbc.e(),  0xf4);
        EXPECT(gbc.h(),  0xb4);
        EXPECT(gbc.l(),  0x9d);
        EXPECT(gbc.sp(), 0x4eb0);
        EXPECT(gbc.pc(), 0xa5f0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa5ee), 0xcb);
        EXPECT(gbc.readMem(0xa5ef), 0x4);
        // CB 04 0322
        gbc.setState(0x8e6, 0xd0a6, 0x2d10, 0xc38, 0x2df4, 0x1fdf, 0x0, 0x1);
        gbc.writeMem(0x8e6, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2d);
        EXPECT(gbc.b(),  0xc);
        EXPECT(gbc.c(),  0x38);
        EXPECT(gbc.d(),  0x2d);
        EXPECT(gbc.e(),  0xf4);
        EXPECT(gbc.h(),  0x3e);
        EXPECT(gbc.l(),  0xdf);
        EXPECT(gbc.sp(), 0xd0a6);
        EXPECT(gbc.pc(), 0x8e8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0323
        gbc.setState(0x6143, 0x3e7e, 0xfc60, 0xb486, 0x426b, 0x8a93, 0x1, 0x1);
        gbc.writeMem(0x6143, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xfc);
        EXPECT(gbc.b(),  0xb4);
        EXPECT(gbc.c(),  0x86);
        EXPECT(gbc.d(),  0x42);
        EXPECT(gbc.e(),  0x6b);
        EXPECT(gbc.h(),  0x15);
        EXPECT(gbc.l(),  0x93);
        EXPECT(gbc.sp(), 0x3e7e);
        EXPECT(gbc.pc(), 0x6145);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0324
        gbc.setState(0xdfae, 0x8776, 0x5340, 0x48c2, 0x7433, 0xa7b5, 0x1, 0x1);
        gbc.writeMem(0xdfae, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x53);
        EXPECT(gbc.b(),  0x48);
        EXPECT(gbc.c(),  0xc2);
        EXPECT(gbc.d(),  0x74);
        EXPECT(gbc.e(),  0x33);
        EXPECT(gbc.h(),  0x4f);
        EXPECT(gbc.l(),  0xb5);
        EXPECT(gbc.sp(), 0x8776);
        EXPECT(gbc.pc(), 0xdfb0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xdfae), 0xcb);
        EXPECT(gbc.readMem(0xdfaf), 0x4);
        // CB 04 0325
        gbc.setState(0xb8b9, 0x7d07, 0xc660, 0x6dab, 0xbcf6, 0x9132, 0x1, 0x1);
        gbc.writeMem(0xb8b9, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc6);
        EXPECT(gbc.b(),  0x6d);
        EXPECT(gbc.c(),  0xab);
        EXPECT(gbc.d(),  0xbc);
        EXPECT(gbc.e(),  0xf6);
        EXPECT(gbc.h(),  0x23);
        EXPECT(gbc.l(),  0x32);
        EXPECT(gbc.sp(), 0x7d07);
        EXPECT(gbc.pc(), 0xb8bb);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb8b9), 0xcb);
        EXPECT(gbc.readMem(0xb8ba), 0x4);
        // CB 04 0326
        gbc.setState(0x48d4, 0x1006, 0xcb20, 0x6be0, 0x25c1, 0x63ec, 0x1, 0x0);
        gbc.writeMem(0x48d4, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xcb);
        EXPECT(gbc.b(),  0x6b);
        EXPECT(gbc.c(),  0xe0);
        EXPECT(gbc.d(),  0x25);
        EXPECT(gbc.e(),  0xc1);
        EXPECT(gbc.h(),  0xc6);
        EXPECT(gbc.l(),  0xec);
        EXPECT(gbc.sp(), 0x1006);
        EXPECT(gbc.pc(), 0x48d6);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0327
        gbc.setState(0xee9f, 0x1b10, 0x5e10, 0x75ab, 0xb69d, 0x8345, 0x0, 0x1);
        gbc.writeMem(0xee9f, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x5e);
        EXPECT(gbc.b(),  0x75);
        EXPECT(gbc.c(),  0xab);
        EXPECT(gbc.d(),  0xb6);
        EXPECT(gbc.e(),  0x9d);
        EXPECT(gbc.h(),  0x7);
        EXPECT(gbc.l(),  0x45);
        EXPECT(gbc.sp(), 0x1b10);
        EXPECT(gbc.pc(), 0xeea1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xee9f), 0xcb);
        EXPECT(gbc.readMem(0xeea0), 0x4);
        // CB 04 0328
        gbc.setState(0x19d8, 0x8c46, 0x3bd0, 0xcc19, 0x65ef, 0xe231, 0x0, 0x1);
        gbc.writeMem(0x19d8, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3b);
        EXPECT(gbc.b(),  0xcc);
        EXPECT(gbc.c(),  0x19);
        EXPECT(gbc.d(),  0x65);
        EXPECT(gbc.e(),  0xef);
        EXPECT(gbc.h(),  0xc5);
        EXPECT(gbc.l(),  0x31);
        EXPECT(gbc.sp(), 0x8c46);
        EXPECT(gbc.pc(), 0x19da);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0329
        gbc.setState(0x147d, 0x33b8, 0x2430, 0x6a87, 0xe3cb, 0x998b, 0x0, 0x1);
        gbc.writeMem(0x147d, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x24);
        EXPECT(gbc.b(),  0x6a);
        EXPECT(gbc.c(),  0x87);
        EXPECT(gbc.d(),  0xe3);
        EXPECT(gbc.e(),  0xcb);
        EXPECT(gbc.h(),  0x33);
        EXPECT(gbc.l(),  0x8b);
        EXPECT(gbc.sp(), 0x33b8);
        EXPECT(gbc.pc(), 0x147f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 032A
        gbc.setState(0xec99, 0x7ac3, 0xa2a0, 0x4443, 0xc9c0, 0x8689, 0x1, 0x0);
        gbc.writeMem(0xec99, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa2);
        EXPECT(gbc.b(),  0x44);
        EXPECT(gbc.c(),  0x43);
        EXPECT(gbc.d(),  0xc9);
        EXPECT(gbc.e(),  0xc0);
        EXPECT(gbc.h(),  0xd);
        EXPECT(gbc.l(),  0x89);
        EXPECT(gbc.sp(), 0x7ac3);
        EXPECT(gbc.pc(), 0xec9b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xec99), 0xcb);
        EXPECT(gbc.readMem(0xec9a), 0x4);
        // CB 04 032B
        gbc.setState(0x7794, 0x300b, 0xc320, 0xd2bb, 0xacd2, 0x1d6d, 0x1, 0x1);
        gbc.writeMem(0x7794, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc3);
        EXPECT(gbc.b(),  0xd2);
        EXPECT(gbc.c(),  0xbb);
        EXPECT(gbc.d(),  0xac);
        EXPECT(gbc.e(),  0xd2);
        EXPECT(gbc.h(),  0x3a);
        EXPECT(gbc.l(),  0x6d);
        EXPECT(gbc.sp(), 0x300b);
        EXPECT(gbc.pc(), 0x7796);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 032C
        gbc.setState(0x5814, 0xc4a, 0xb460, 0x9d02, 0x7374, 0x9b83, 0x1, 0x1);
        gbc.writeMem(0x5814, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb4);
        EXPECT(gbc.b(),  0x9d);
        EXPECT(gbc.c(),  0x2);
        EXPECT(gbc.d(),  0x73);
        EXPECT(gbc.e(),  0x74);
        EXPECT(gbc.h(),  0x37);
        EXPECT(gbc.l(),  0x83);
        EXPECT(gbc.sp(), 0xc4a);
        EXPECT(gbc.pc(), 0x5816);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 032D
        gbc.setState(0x1724, 0x3801, 0xfbb0, 0x8597, 0x33d9, 0x21ea, 0x0, 0x1);
        gbc.writeMem(0x1724, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xfb);
        EXPECT(gbc.b(),  0x85);
        EXPECT(gbc.c(),  0x97);
        EXPECT(gbc.d(),  0x33);
        EXPECT(gbc.e(),  0xd9);
        EXPECT(gbc.h(),  0x42);
        EXPECT(gbc.l(),  0xea);
        EXPECT(gbc.sp(), 0x3801);
        EXPECT(gbc.pc(), 0x1726);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 032E
        gbc.setState(0xac50, 0xe15a, 0x2110, 0xd3d9, 0xa6b3, 0x2505, 0x1, 0x0);
        gbc.writeMem(0xac50, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x21);
        EXPECT(gbc.b(),  0xd3);
        EXPECT(gbc.c(),  0xd9);
        EXPECT(gbc.d(),  0xa6);
        EXPECT(gbc.e(),  0xb3);
        EXPECT(gbc.h(),  0x4a);
        EXPECT(gbc.l(),  0x5);
        EXPECT(gbc.sp(), 0xe15a);
        EXPECT(gbc.pc(), 0xac52);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xac50), 0xcb);
        EXPECT(gbc.readMem(0xac51), 0x4);
        // CB 04 032F
        gbc.setState(0x5077, 0x29c6, 0x71d0, 0x126b, 0xeafa, 0xc14b, 0x0, 0x0);
        gbc.writeMem(0x5077, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x71);
        EXPECT(gbc.b(),  0x12);
        EXPECT(gbc.c(),  0x6b);
        EXPECT(gbc.d(),  0xea);
        EXPECT(gbc.e(),  0xfa);
        EXPECT(gbc.h(),  0x83);
        EXPECT(gbc.l(),  0x4b);
        EXPECT(gbc.sp(), 0x29c6);
        EXPECT(gbc.pc(), 0x5079);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0330
        gbc.setState(0xc25, 0x823a, 0xf6c0, 0x8bb2, 0x28e8, 0x57b2, 0x0, 0x0);
        gbc.writeMem(0xc25, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf6);
        EXPECT(gbc.b(),  0x8b);
        EXPECT(gbc.c(),  0xb2);
        EXPECT(gbc.d(),  0x28);
        EXPECT(gbc.e(),  0xe8);
        EXPECT(gbc.h(),  0xae);
        EXPECT(gbc.l(),  0xb2);
        EXPECT(gbc.sp(), 0x823a);
        EXPECT(gbc.pc(), 0xc27);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0332
        gbc.setState(0x4ad0, 0x1664, 0xe400, 0xf70e, 0x73f6, 0xf6e1, 0x1, 0x1);
        gbc.writeMem(0x4ad0, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe4);
        EXPECT(gbc.b(),  0xf7);
        EXPECT(gbc.c(),  0xe);
        EXPECT(gbc.d(),  0x73);
        EXPECT(gbc.e(),  0xf6);
        EXPECT(gbc.h(),  0xed);
        EXPECT(gbc.l(),  0xe1);
        EXPECT(gbc.sp(), 0x1664);
        EXPECT(gbc.pc(), 0x4ad2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0333
        gbc.setState(0xd996, 0x6bdf, 0xe50, 0x2e4, 0xe177, 0xb491, 0x0, 0x0);
        gbc.writeMem(0xd996, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe);
        EXPECT(gbc.b(),  0x2);
        EXPECT(gbc.c(),  0xe4);
        EXPECT(gbc.d(),  0xe1);
        EXPECT(gbc.e(),  0x77);
        EXPECT(gbc.h(),  0x69);
        EXPECT(gbc.l(),  0x91);
        EXPECT(gbc.sp(), 0x6bdf);
        EXPECT(gbc.pc(), 0xd998);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd996), 0xcb);
        EXPECT(gbc.readMem(0xd997), 0x4);
        // CB 04 0334
        gbc.setState(0xc55c, 0x4b0c, 0xd20, 0xd196, 0x5f2d, 0x7bd5, 0x0, 0x1);
        gbc.writeMem(0xc55c, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd);
        EXPECT(gbc.b(),  0xd1);
        EXPECT(gbc.c(),  0x96);
        EXPECT(gbc.d(),  0x5f);
        EXPECT(gbc.e(),  0x2d);
        EXPECT(gbc.h(),  0xf6);
        EXPECT(gbc.l(),  0xd5);
        EXPECT(gbc.sp(), 0x4b0c);
        EXPECT(gbc.pc(), 0xc55e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc55c), 0xcb);
        EXPECT(gbc.readMem(0xc55d), 0x4);
        // CB 04 0335
        gbc.setState(0x448f, 0xfb30, 0xa550, 0x9924, 0xca58, 0x23ca, 0x1, 0x0);
        gbc.writeMem(0x448f, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa5);
        EXPECT(gbc.b(),  0x99);
        EXPECT(gbc.c(),  0x24);
        EXPECT(gbc.d(),  0xca);
        EXPECT(gbc.e(),  0x58);
        EXPECT(gbc.h(),  0x46);
        EXPECT(gbc.l(),  0xca);
        EXPECT(gbc.sp(), 0xfb30);
        EXPECT(gbc.pc(), 0x4491);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0336
        gbc.setState(0xc589, 0xa6ac, 0x7c10, 0x5bba, 0x728e, 0xf1ca, 0x1, 0x1);
        gbc.writeMem(0xc589, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x7c);
        EXPECT(gbc.b(),  0x5b);
        EXPECT(gbc.c(),  0xba);
        EXPECT(gbc.d(),  0x72);
        EXPECT(gbc.e(),  0x8e);
        EXPECT(gbc.h(),  0xe3);
        EXPECT(gbc.l(),  0xca);
        EXPECT(gbc.sp(), 0xa6ac);
        EXPECT(gbc.pc(), 0xc58b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc589), 0xcb);
        EXPECT(gbc.readMem(0xc58a), 0x4);
        // CB 04 0337
        gbc.setState(0xc1bd, 0xbb0b, 0xa930, 0xb66b, 0xeabf, 0x4961, 0x0, 0x0);
        gbc.writeMem(0xc1bd, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa9);
        EXPECT(gbc.b(),  0xb6);
        EXPECT(gbc.c(),  0x6b);
        EXPECT(gbc.d(),  0xea);
        EXPECT(gbc.e(),  0xbf);
        EXPECT(gbc.h(),  0x92);
        EXPECT(gbc.l(),  0x61);
        EXPECT(gbc.sp(), 0xbb0b);
        EXPECT(gbc.pc(), 0xc1bf);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc1bd), 0xcb);
        EXPECT(gbc.readMem(0xc1be), 0x4);
        // CB 04 0338
        gbc.setState(0xc2b7, 0x854e, 0x6500, 0xf678, 0xe0c9, 0xd9bd, 0x1, 0x0);
        gbc.writeMem(0xc2b7, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x65);
        EXPECT(gbc.b(),  0xf6);
        EXPECT(gbc.c(),  0x78);
        EXPECT(gbc.d(),  0xe0);
        EXPECT(gbc.e(),  0xc9);
        EXPECT(gbc.h(),  0xb3);
        EXPECT(gbc.l(),  0xbd);
        EXPECT(gbc.sp(), 0x854e);
        EXPECT(gbc.pc(), 0xc2b9);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc2b7), 0xcb);
        EXPECT(gbc.readMem(0xc2b8), 0x4);
        // CB 04 0339
        gbc.setState(0x99e0, 0x1f51, 0x28d0, 0xbd14, 0x46a3, 0x4220, 0x0, 0x1);
        gbc.writeMem(0x99e0, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0xbd);
        EXPECT(gbc.c(),  0x14);
        EXPECT(gbc.d(),  0x46);
        EXPECT(gbc.e(),  0xa3);
        EXPECT(gbc.h(),  0x84);
        EXPECT(gbc.l(),  0x20);
        EXPECT(gbc.sp(), 0x1f51);
        EXPECT(gbc.pc(), 0x99e2);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x99e0), 0xcb);
        EXPECT(gbc.readMem(0x99e1), 0x4);
        // CB 04 033A
        gbc.setState(0x7fc1, 0x7b52, 0x9680, 0x8d3a, 0x61f9, 0x3a02, 0x0, 0x1);
        gbc.writeMem(0x7fc1, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x96);
        EXPECT(gbc.b(),  0x8d);
        EXPECT(gbc.c(),  0x3a);
        EXPECT(gbc.d(),  0x61);
        EXPECT(gbc.e(),  0xf9);
        EXPECT(gbc.h(),  0x74);
        EXPECT(gbc.l(),  0x2);
        EXPECT(gbc.sp(), 0x7b52);
        EXPECT(gbc.pc(), 0x7fc3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 033B
        gbc.setState(0x3623, 0x95b6, 0x43a0, 0x42d0, 0x1c8d, 0x7d75, 0x0, 0x0);
        gbc.writeMem(0x3623, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x43);
        EXPECT(gbc.b(),  0x42);
        EXPECT(gbc.c(),  0xd0);
        EXPECT(gbc.d(),  0x1c);
        EXPECT(gbc.e(),  0x8d);
        EXPECT(gbc.h(),  0xfa);
        EXPECT(gbc.l(),  0x75);
        EXPECT(gbc.sp(), 0x95b6);
        EXPECT(gbc.pc(), 0x3625);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 033C
        gbc.setState(0xe408, 0xe8f4, 0xcf60, 0x1810, 0xf906, 0x75c9, 0x0, 0x1);
        gbc.writeMem(0xe408, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xcf);
        EXPECT(gbc.b(),  0x18);
        EXPECT(gbc.c(),  0x10);
        EXPECT(gbc.d(),  0xf9);
        EXPECT(gbc.e(),  0x6);
        EXPECT(gbc.h(),  0xea);
        EXPECT(gbc.l(),  0xc9);
        EXPECT(gbc.sp(), 0xe8f4);
        EXPECT(gbc.pc(), 0xe40a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe408), 0xcb);
        EXPECT(gbc.readMem(0xe409), 0x4);
        // CB 04 033D
        gbc.setState(0xebe5, 0x1717, 0x6490, 0xbbe7, 0xd2a5, 0x4a71, 0x1, 0x1);
        gbc.writeMem(0xebe5, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x64);
        EXPECT(gbc.b(),  0xbb);
        EXPECT(gbc.c(),  0xe7);
        EXPECT(gbc.d(),  0xd2);
        EXPECT(gbc.e(),  0xa5);
        EXPECT(gbc.h(),  0x94);
        EXPECT(gbc.l(),  0x71);
        EXPECT(gbc.sp(), 0x1717);
        EXPECT(gbc.pc(), 0xebe7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xebe5), 0xcb);
        EXPECT(gbc.readMem(0xebe6), 0x4);
        // CB 04 033E
        gbc.setState(0x8057, 0x9465, 0xb870, 0x2825, 0x28e1, 0xd038, 0x1, 0x1);
        gbc.writeMem(0x8057, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb8);
        EXPECT(gbc.b(),  0x28);
        EXPECT(gbc.c(),  0x25);
        EXPECT(gbc.d(),  0x28);
        EXPECT(gbc.e(),  0xe1);
        EXPECT(gbc.h(),  0xa1);
        EXPECT(gbc.l(),  0x38);
        EXPECT(gbc.sp(), 0x9465);
        EXPECT(gbc.pc(), 0x8059);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8057), 0xcb);
        EXPECT(gbc.readMem(0x8058), 0x4);
        // CB 04 033F
        gbc.setState(0xa0c5, 0x4475, 0x1360, 0x44e2, 0x7bd0, 0x7bd0, 0x0, 0x0);
        gbc.writeMem(0xa0c5, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x13);
        EXPECT(gbc.b(),  0x44);
        EXPECT(gbc.c(),  0xe2);
        EXPECT(gbc.d(),  0x7b);
        EXPECT(gbc.e(),  0xd0);
        EXPECT(gbc.h(),  0xf6);
        EXPECT(gbc.l(),  0xd0);
        EXPECT(gbc.sp(), 0x4475);
        EXPECT(gbc.pc(), 0xa0c7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa0c5), 0xcb);
        EXPECT(gbc.readMem(0xa0c6), 0x4);
        // CB 04 0340
        gbc.setState(0x1844, 0x4ee4, 0x9790, 0xc1a9, 0x4ea6, 0xbbd5, 0x1, 0x0);
        gbc.writeMem(0x1844, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x97);
        EXPECT(gbc.b(),  0xc1);
        EXPECT(gbc.c(),  0xa9);
        EXPECT(gbc.d(),  0x4e);
        EXPECT(gbc.e(),  0xa6);
        EXPECT(gbc.h(),  0x77);
        EXPECT(gbc.l(),  0xd5);
        EXPECT(gbc.sp(), 0x4ee4);
        EXPECT(gbc.pc(), 0x1846);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0341
        gbc.setState(0xefb9, 0xe969, 0x35d0, 0x99fc, 0xab5f, 0x858e, 0x1, 0x1);
        gbc.writeMem(0xefb9, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x35);
        EXPECT(gbc.b(),  0x99);
        EXPECT(gbc.c(),  0xfc);
        EXPECT(gbc.d(),  0xab);
        EXPECT(gbc.e(),  0x5f);
        EXPECT(gbc.h(),  0xb);
        EXPECT(gbc.l(),  0x8e);
        EXPECT(gbc.sp(), 0xe969);
        EXPECT(gbc.pc(), 0xefbb);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xefb9), 0xcb);
        EXPECT(gbc.readMem(0xefba), 0x4);
        // CB 04 0342
        gbc.setState(0x1591, 0xc403, 0x2c60, 0xc08b, 0xa221, 0x8144, 0x1, 0x1);
        gbc.writeMem(0x1591, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2c);
        EXPECT(gbc.b(),  0xc0);
        EXPECT(gbc.c(),  0x8b);
        EXPECT(gbc.d(),  0xa2);
        EXPECT(gbc.e(),  0x21);
        EXPECT(gbc.h(),  0x3);
        EXPECT(gbc.l(),  0x44);
        EXPECT(gbc.sp(), 0xc403);
        EXPECT(gbc.pc(), 0x1593);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0343
        gbc.setState(0xd475, 0x8b33, 0x5740, 0xf18f, 0xdf68, 0x925, 0x0, 0x0);
        gbc.writeMem(0xd475, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x57);
        EXPECT(gbc.b(),  0xf1);
        EXPECT(gbc.c(),  0x8f);
        EXPECT(gbc.d(),  0xdf);
        EXPECT(gbc.e(),  0x68);
        EXPECT(gbc.h(),  0x12);
        EXPECT(gbc.l(),  0x25);
        EXPECT(gbc.sp(), 0x8b33);
        EXPECT(gbc.pc(), 0xd477);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd475), 0xcb);
        EXPECT(gbc.readMem(0xd476), 0x4);
        // CB 04 0344
        gbc.setState(0xc721, 0xab2e, 0xf860, 0xfa, 0x10b, 0x85ac, 0x1, 0x0);
        gbc.writeMem(0xc721, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf8);
        EXPECT(gbc.b(),  0x0);
        EXPECT(gbc.c(),  0xfa);
        EXPECT(gbc.d(),  0x1);
        EXPECT(gbc.e(),  0xb);
        EXPECT(gbc.h(),  0xb);
        EXPECT(gbc.l(),  0xac);
        EXPECT(gbc.sp(), 0xab2e);
        EXPECT(gbc.pc(), 0xc723);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc721), 0xcb);
        EXPECT(gbc.readMem(0xc722), 0x4);
        // CB 04 0345
        gbc.setState(0x17d6, 0x48e7, 0x4860, 0x6672, 0x9c6d, 0x629c, 0x0, 0x1);
        gbc.writeMem(0x17d6, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x48);
        EXPECT(gbc.b(),  0x66);
        EXPECT(gbc.c(),  0x72);
        EXPECT(gbc.d(),  0x9c);
        EXPECT(gbc.e(),  0x6d);
        EXPECT(gbc.h(),  0xc4);
        EXPECT(gbc.l(),  0x9c);
        EXPECT(gbc.sp(), 0x48e7);
        EXPECT(gbc.pc(), 0x17d8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0346
        gbc.setState(0xdd55, 0xef02, 0x4950, 0xe6f1, 0x366a, 0xabb4, 0x1, 0x1);
        gbc.writeMem(0xdd55, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x49);
        EXPECT(gbc.b(),  0xe6);
        EXPECT(gbc.c(),  0xf1);
        EXPECT(gbc.d(),  0x36);
        EXPECT(gbc.e(),  0x6a);
        EXPECT(gbc.h(),  0x57);
        EXPECT(gbc.l(),  0xb4);
        EXPECT(gbc.sp(), 0xef02);
        EXPECT(gbc.pc(), 0xdd57);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xdd55), 0xcb);
        EXPECT(gbc.readMem(0xdd56), 0x4);
        // CB 04 0347
        gbc.setState(0x9d79, 0x19e5, 0xc00, 0x3b0c, 0xac9f, 0x5380, 0x0, 0x0);
        gbc.writeMem(0x9d79, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc);
        EXPECT(gbc.b(),  0x3b);
        EXPECT(gbc.c(),  0xc);
        EXPECT(gbc.d(),  0xac);
        EXPECT(gbc.e(),  0x9f);
        EXPECT(gbc.h(),  0xa6);
        EXPECT(gbc.l(),  0x80);
        EXPECT(gbc.sp(), 0x19e5);
        EXPECT(gbc.pc(), 0x9d7b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9d79), 0xcb);
        EXPECT(gbc.readMem(0x9d7a), 0x4);
        // CB 04 0348
        gbc.setState(0xcfc2, 0x7d8b, 0x7cb0, 0xbd7f, 0xd20a, 0xc4d1, 0x1, 0x0);
        gbc.writeMem(0xcfc2, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x7c);
        EXPECT(gbc.b(),  0xbd);
        EXPECT(gbc.c(),  0x7f);
        EXPECT(gbc.d(),  0xd2);
        EXPECT(gbc.e(),  0xa);
        EXPECT(gbc.h(),  0x89);
        EXPECT(gbc.l(),  0xd1);
        EXPECT(gbc.sp(), 0x7d8b);
        EXPECT(gbc.pc(), 0xcfc4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcfc2), 0xcb);
        EXPECT(gbc.readMem(0xcfc3), 0x4);
        // CB 04 0349
        gbc.setState(0x297, 0x2100, 0x8b00, 0x2fd7, 0x8d5e, 0xdead, 0x1, 0x1);
        gbc.writeMem(0x297, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8b);
        EXPECT(gbc.b(),  0x2f);
        EXPECT(gbc.c(),  0xd7);
        EXPECT(gbc.d(),  0x8d);
        EXPECT(gbc.e(),  0x5e);
        EXPECT(gbc.h(),  0xbd);
        EXPECT(gbc.l(),  0xad);
        EXPECT(gbc.sp(), 0x2100);
        EXPECT(gbc.pc(), 0x299);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 034A
        gbc.setState(0x6482, 0x8e5f, 0xde70, 0x7caa, 0xd1cb, 0x248b, 0x0, 0x1);
        gbc.writeMem(0x6482, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xde);
        EXPECT(gbc.b(),  0x7c);
        EXPECT(gbc.c(),  0xaa);
        EXPECT(gbc.d(),  0xd1);
        EXPECT(gbc.e(),  0xcb);
        EXPECT(gbc.h(),  0x48);
        EXPECT(gbc.l(),  0x8b);
        EXPECT(gbc.sp(), 0x8e5f);
        EXPECT(gbc.pc(), 0x6484);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 034B
        gbc.setState(0xe664, 0xe868, 0x8890, 0x92a4, 0x6079, 0x4cb9, 0x1, 0x0);
        gbc.writeMem(0xe664, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x88);
        EXPECT(gbc.b(),  0x92);
        EXPECT(gbc.c(),  0xa4);
        EXPECT(gbc.d(),  0x60);
        EXPECT(gbc.e(),  0x79);
        EXPECT(gbc.h(),  0x98);
        EXPECT(gbc.l(),  0xb9);
        EXPECT(gbc.sp(), 0xe868);
        EXPECT(gbc.pc(), 0xe666);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe664), 0xcb);
        EXPECT(gbc.readMem(0xe665), 0x4);
        // CB 04 034C
        gbc.setState(0x2730, 0x4ebd, 0xf2e0, 0xb9c0, 0xf2f6, 0x30b1, 0x1, 0x0);
        gbc.writeMem(0x2730, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf2);
        EXPECT(gbc.b(),  0xb9);
        EXPECT(gbc.c(),  0xc0);
        EXPECT(gbc.d(),  0xf2);
        EXPECT(gbc.e(),  0xf6);
        EXPECT(gbc.h(),  0x60);
        EXPECT(gbc.l(),  0xb1);
        EXPECT(gbc.sp(), 0x4ebd);
        EXPECT(gbc.pc(), 0x2732);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 034D
        gbc.setState(0x435e, 0x4d65, 0x7940, 0x790b, 0x8d77, 0xa551, 0x0, 0x0);
        gbc.writeMem(0x435e, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x79);
        EXPECT(gbc.b(),  0x79);
        EXPECT(gbc.c(),  0xb);
        EXPECT(gbc.d(),  0x8d);
        EXPECT(gbc.e(),  0x77);
        EXPECT(gbc.h(),  0x4b);
        EXPECT(gbc.l(),  0x51);
        EXPECT(gbc.sp(), 0x4d65);
        EXPECT(gbc.pc(), 0x4360);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 034E
        gbc.setState(0x3f2c, 0x9bd0, 0x6350, 0x9569, 0x63a2, 0x9af5, 0x0, 0x0);
        gbc.writeMem(0x3f2c, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x63);
        EXPECT(gbc.b(),  0x95);
        EXPECT(gbc.c(),  0x69);
        EXPECT(gbc.d(),  0x63);
        EXPECT(gbc.e(),  0xa2);
        EXPECT(gbc.h(),  0x35);
        EXPECT(gbc.l(),  0xf5);
        EXPECT(gbc.sp(), 0x9bd0);
        EXPECT(gbc.pc(), 0x3f2e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 034F
        gbc.setState(0x5d67, 0x2d92, 0x7450, 0xde04, 0xb9a7, 0xe10c, 0x1, 0x1);
        gbc.writeMem(0x5d67, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x74);
        EXPECT(gbc.b(),  0xde);
        EXPECT(gbc.c(),  0x4);
        EXPECT(gbc.d(),  0xb9);
        EXPECT(gbc.e(),  0xa7);
        EXPECT(gbc.h(),  0xc3);
        EXPECT(gbc.l(),  0xc);
        EXPECT(gbc.sp(), 0x2d92);
        EXPECT(gbc.pc(), 0x5d69);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0350
        gbc.setState(0xc53b, 0x2a05, 0x18c0, 0xba56, 0xfb91, 0x706c, 0x0, 0x1);
        gbc.writeMem(0xc53b, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x18);
        EXPECT(gbc.b(),  0xba);
        EXPECT(gbc.c(),  0x56);
        EXPECT(gbc.d(),  0xfb);
        EXPECT(gbc.e(),  0x91);
        EXPECT(gbc.h(),  0xe0);
        EXPECT(gbc.l(),  0x6c);
        EXPECT(gbc.sp(), 0x2a05);
        EXPECT(gbc.pc(), 0xc53d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc53b), 0xcb);
        EXPECT(gbc.readMem(0xc53c), 0x4);
        // CB 04 0351
        gbc.setState(0xed21, 0x8598, 0xc0f0, 0xfd34, 0x8082, 0xdc92, 0x1, 0x1);
        gbc.writeMem(0xed21, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc0);
        EXPECT(gbc.b(),  0xfd);
        EXPECT(gbc.c(),  0x34);
        EXPECT(gbc.d(),  0x80);
        EXPECT(gbc.e(),  0x82);
        EXPECT(gbc.h(),  0xb9);
        EXPECT(gbc.l(),  0x92);
        EXPECT(gbc.sp(), 0x8598);
        EXPECT(gbc.pc(), 0xed23);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xed21), 0xcb);
        EXPECT(gbc.readMem(0xed22), 0x4);
        // CB 04 0352
        gbc.setState(0x754e, 0xc3dc, 0x5790, 0xa5f2, 0x979f, 0xbd64, 0x0, 0x1);
        gbc.writeMem(0x754e, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x57);
        EXPECT(gbc.b(),  0xa5);
        EXPECT(gbc.c(),  0xf2);
        EXPECT(gbc.d(),  0x97);
        EXPECT(gbc.e(),  0x9f);
        EXPECT(gbc.h(),  0x7b);
        EXPECT(gbc.l(),  0x64);
        EXPECT(gbc.sp(), 0xc3dc);
        EXPECT(gbc.pc(), 0x7550);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0353
        gbc.setState(0x41be, 0xc686, 0x2670, 0xfe80, 0xf660, 0xe3c5, 0x0, 0x1);
        gbc.writeMem(0x41be, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x26);
        EXPECT(gbc.b(),  0xfe);
        EXPECT(gbc.c(),  0x80);
        EXPECT(gbc.d(),  0xf6);
        EXPECT(gbc.e(),  0x60);
        EXPECT(gbc.h(),  0xc7);
        EXPECT(gbc.l(),  0xc5);
        EXPECT(gbc.sp(), 0xc686);
        EXPECT(gbc.pc(), 0x41c0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0354
        gbc.setState(0xad5b, 0xaf1a, 0x2ff0, 0xbdc7, 0xd48f, 0x6ab4, 0x0, 0x0);
        gbc.writeMem(0xad5b, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2f);
        EXPECT(gbc.b(),  0xbd);
        EXPECT(gbc.c(),  0xc7);
        EXPECT(gbc.d(),  0xd4);
        EXPECT(gbc.e(),  0x8f);
        EXPECT(gbc.h(),  0xd4);
        EXPECT(gbc.l(),  0xb4);
        EXPECT(gbc.sp(), 0xaf1a);
        EXPECT(gbc.pc(), 0xad5d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xad5b), 0xcb);
        EXPECT(gbc.readMem(0xad5c), 0x4);
        // CB 04 0355
        gbc.setState(0xb593, 0x1681, 0xeb70, 0x7279, 0xf432, 0xfbd, 0x0, 0x1);
        gbc.writeMem(0xb593, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xeb);
        EXPECT(gbc.b(),  0x72);
        EXPECT(gbc.c(),  0x79);
        EXPECT(gbc.d(),  0xf4);
        EXPECT(gbc.e(),  0x32);
        EXPECT(gbc.h(),  0x1e);
        EXPECT(gbc.l(),  0xbd);
        EXPECT(gbc.sp(), 0x1681);
        EXPECT(gbc.pc(), 0xb595);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb593), 0xcb);
        EXPECT(gbc.readMem(0xb594), 0x4);
        // CB 04 0356
        gbc.setState(0xcfb9, 0x73ea, 0xc340, 0xca53, 0xf2f7, 0xc561, 0x0, 0x0);
        gbc.writeMem(0xcfb9, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc3);
        EXPECT(gbc.b(),  0xca);
        EXPECT(gbc.c(),  0x53);
        EXPECT(gbc.d(),  0xf2);
        EXPECT(gbc.e(),  0xf7);
        EXPECT(gbc.h(),  0x8b);
        EXPECT(gbc.l(),  0x61);
        EXPECT(gbc.sp(), 0x73ea);
        EXPECT(gbc.pc(), 0xcfbb);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcfb9), 0xcb);
        EXPECT(gbc.readMem(0xcfba), 0x4);
        // CB 04 0357
        gbc.setState(0xa6fb, 0xa5f7, 0x5c50, 0x2dd4, 0x1cf2, 0x7a62, 0x0, 0x1);
        gbc.writeMem(0xa6fb, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x5c);
        EXPECT(gbc.b(),  0x2d);
        EXPECT(gbc.c(),  0xd4);
        EXPECT(gbc.d(),  0x1c);
        EXPECT(gbc.e(),  0xf2);
        EXPECT(gbc.h(),  0xf4);
        EXPECT(gbc.l(),  0x62);
        EXPECT(gbc.sp(), 0xa5f7);
        EXPECT(gbc.pc(), 0xa6fd);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa6fb), 0xcb);
        EXPECT(gbc.readMem(0xa6fc), 0x4);
        // CB 04 0358
        gbc.setState(0x5af7, 0x3f27, 0x9220, 0x1d3d, 0x3435, 0x301c, 0x0, 0x1);
        gbc.writeMem(0x5af7, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x92);
        EXPECT(gbc.b(),  0x1d);
        EXPECT(gbc.c(),  0x3d);
        EXPECT(gbc.d(),  0x34);
        EXPECT(gbc.e(),  0x35);
        EXPECT(gbc.h(),  0x60);
        EXPECT(gbc.l(),  0x1c);
        EXPECT(gbc.sp(), 0x3f27);
        EXPECT(gbc.pc(), 0x5af9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0359
        gbc.setState(0x9ee5, 0xc531, 0x6bd0, 0xb68a, 0x9bf, 0x1491, 0x0, 0x1);
        gbc.writeMem(0x9ee5, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x6b);
        EXPECT(gbc.b(),  0xb6);
        EXPECT(gbc.c(),  0x8a);
        EXPECT(gbc.d(),  0x9);
        EXPECT(gbc.e(),  0xbf);
        EXPECT(gbc.h(),  0x28);
        EXPECT(gbc.l(),  0x91);
        EXPECT(gbc.sp(), 0xc531);
        EXPECT(gbc.pc(), 0x9ee7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9ee5), 0xcb);
        EXPECT(gbc.readMem(0x9ee6), 0x4);
        // CB 04 035A
        gbc.setState(0x5047, 0xa602, 0x9430, 0x87e3, 0x724e, 0xb18d, 0x0, 0x1);
        gbc.writeMem(0x5047, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x94);
        EXPECT(gbc.b(),  0x87);
        EXPECT(gbc.c(),  0xe3);
        EXPECT(gbc.d(),  0x72);
        EXPECT(gbc.e(),  0x4e);
        EXPECT(gbc.h(),  0x63);
        EXPECT(gbc.l(),  0x8d);
        EXPECT(gbc.sp(), 0xa602);
        EXPECT(gbc.pc(), 0x5049);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 035B
        gbc.setState(0xeabb, 0xa99a, 0x4650, 0xfc9c, 0xa58, 0xbf2a, 0x1, 0x0);
        gbc.writeMem(0xeabb, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x46);
        EXPECT(gbc.b(),  0xfc);
        EXPECT(gbc.c(),  0x9c);
        EXPECT(gbc.d(),  0xa);
        EXPECT(gbc.e(),  0x58);
        EXPECT(gbc.h(),  0x7f);
        EXPECT(gbc.l(),  0x2a);
        EXPECT(gbc.sp(), 0xa99a);
        EXPECT(gbc.pc(), 0xeabd);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xeabb), 0xcb);
        EXPECT(gbc.readMem(0xeabc), 0x4);
        // CB 04 035C
        gbc.setState(0x4a5c, 0x4f31, 0x3150, 0x520f, 0xa8ef, 0xbd24, 0x0, 0x1);
        gbc.writeMem(0x4a5c, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x31);
        EXPECT(gbc.b(),  0x52);
        EXPECT(gbc.c(),  0xf);
        EXPECT(gbc.d(),  0xa8);
        EXPECT(gbc.e(),  0xef);
        EXPECT(gbc.h(),  0x7b);
        EXPECT(gbc.l(),  0x24);
        EXPECT(gbc.sp(), 0x4f31);
        EXPECT(gbc.pc(), 0x4a5e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 035D
        gbc.setState(0x45fe, 0x9f0a, 0xa350, 0x81dc, 0x6dc6, 0x5727, 0x1, 0x0);
        gbc.writeMem(0x45fe, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa3);
        EXPECT(gbc.b(),  0x81);
        EXPECT(gbc.c(),  0xdc);
        EXPECT(gbc.d(),  0x6d);
        EXPECT(gbc.e(),  0xc6);
        EXPECT(gbc.h(),  0xae);
        EXPECT(gbc.l(),  0x27);
        EXPECT(gbc.sp(), 0x9f0a);
        EXPECT(gbc.pc(), 0x4600);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 035E
        gbc.setState(0x8a1b, 0xea69, 0x7d0, 0xcdc6, 0x2022, 0x1487, 0x1, 0x1);
        gbc.writeMem(0x8a1b, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x7);
        EXPECT(gbc.b(),  0xcd);
        EXPECT(gbc.c(),  0xc6);
        EXPECT(gbc.d(),  0x20);
        EXPECT(gbc.e(),  0x22);
        EXPECT(gbc.h(),  0x28);
        EXPECT(gbc.l(),  0x87);
        EXPECT(gbc.sp(), 0xea69);
        EXPECT(gbc.pc(), 0x8a1d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8a1b), 0xcb);
        EXPECT(gbc.readMem(0x8a1c), 0x4);
        // CB 04 035F
        gbc.setState(0xa3e, 0x5013, 0x6de0, 0x6e00, 0xeddb, 0x3dcb, 0x0, 0x1);
        gbc.writeMem(0xa3e, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x6d);
        EXPECT(gbc.b(),  0x6e);
        EXPECT(gbc.c(),  0x0);
        EXPECT(gbc.d(),  0xed);
        EXPECT(gbc.e(),  0xdb);
        EXPECT(gbc.h(),  0x7a);
        EXPECT(gbc.l(),  0xcb);
        EXPECT(gbc.sp(), 0x5013);
        EXPECT(gbc.pc(), 0xa40);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0360
        gbc.setState(0x7bcc, 0x1415, 0xf420, 0xd2c2, 0xafd9, 0xef63, 0x0, 0x0);
        gbc.writeMem(0x7bcc, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf4);
        EXPECT(gbc.b(),  0xd2);
        EXPECT(gbc.c(),  0xc2);
        EXPECT(gbc.d(),  0xaf);
        EXPECT(gbc.e(),  0xd9);
        EXPECT(gbc.h(),  0xdf);
        EXPECT(gbc.l(),  0x63);
        EXPECT(gbc.sp(), 0x1415);
        EXPECT(gbc.pc(), 0x7bce);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0361
        gbc.setState(0x116b, 0x127, 0x7e00, 0x62ff, 0x7d93, 0x1070, 0x0, 0x1);
        gbc.writeMem(0x116b, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x7e);
        EXPECT(gbc.b(),  0x62);
        EXPECT(gbc.c(),  0xff);
        EXPECT(gbc.d(),  0x7d);
        EXPECT(gbc.e(),  0x93);
        EXPECT(gbc.h(),  0x20);
        EXPECT(gbc.l(),  0x70);
        EXPECT(gbc.sp(), 0x127);
        EXPECT(gbc.pc(), 0x116d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0362
        gbc.setState(0x9e64, 0x7821, 0x7890, 0x148, 0x6f9c, 0x48a3, 0x1, 0x0);
        gbc.writeMem(0x9e64, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x78);
        EXPECT(gbc.b(),  0x1);
        EXPECT(gbc.c(),  0x48);
        EXPECT(gbc.d(),  0x6f);
        EXPECT(gbc.e(),  0x9c);
        EXPECT(gbc.h(),  0x90);
        EXPECT(gbc.l(),  0xa3);
        EXPECT(gbc.sp(), 0x7821);
        EXPECT(gbc.pc(), 0x9e66);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9e64), 0xcb);
        EXPECT(gbc.readMem(0x9e65), 0x4);
        // CB 04 0363
        gbc.setState(0x7d24, 0xb633, 0xf380, 0x23ad, 0x317e, 0xfa4f, 0x1, 0x1);
        gbc.writeMem(0x7d24, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf3);
        EXPECT(gbc.b(),  0x23);
        EXPECT(gbc.c(),  0xad);
        EXPECT(gbc.d(),  0x31);
        EXPECT(gbc.e(),  0x7e);
        EXPECT(gbc.h(),  0xf5);
        EXPECT(gbc.l(),  0x4f);
        EXPECT(gbc.sp(), 0xb633);
        EXPECT(gbc.pc(), 0x7d26);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0364
        gbc.setState(0x34ac, 0x5af7, 0x2320, 0x7a66, 0x9d27, 0xb7e8, 0x1, 0x1);
        gbc.writeMem(0x34ac, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x23);
        EXPECT(gbc.b(),  0x7a);
        EXPECT(gbc.c(),  0x66);
        EXPECT(gbc.d(),  0x9d);
        EXPECT(gbc.e(),  0x27);
        EXPECT(gbc.h(),  0x6f);
        EXPECT(gbc.l(),  0xe8);
        EXPECT(gbc.sp(), 0x5af7);
        EXPECT(gbc.pc(), 0x34ae);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0365
        gbc.setState(0x3988, 0x8365, 0x45b0, 0xd3e1, 0xd2ed, 0x4a09, 0x0, 0x0);
        gbc.writeMem(0x3988, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x45);
        EXPECT(gbc.b(),  0xd3);
        EXPECT(gbc.c(),  0xe1);
        EXPECT(gbc.d(),  0xd2);
        EXPECT(gbc.e(),  0xed);
        EXPECT(gbc.h(),  0x94);
        EXPECT(gbc.l(),  0x9);
        EXPECT(gbc.sp(), 0x8365);
        EXPECT(gbc.pc(), 0x398a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0366
        gbc.setState(0x30b3, 0xaf81, 0x36b0, 0xd2a6, 0x3e2f, 0x2f03, 0x0, 0x1);
        gbc.writeMem(0x30b3, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x36);
        EXPECT(gbc.b(),  0xd2);
        EXPECT(gbc.c(),  0xa6);
        EXPECT(gbc.d(),  0x3e);
        EXPECT(gbc.e(),  0x2f);
        EXPECT(gbc.h(),  0x5e);
        EXPECT(gbc.l(),  0x3);
        EXPECT(gbc.sp(), 0xaf81);
        EXPECT(gbc.pc(), 0x30b5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0367
        gbc.setState(0xdb78, 0xce81, 0x5ec0, 0x2d97, 0xebd1, 0xd4a1, 0x1, 0x1);
        gbc.writeMem(0xdb78, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x5e);
        EXPECT(gbc.b(),  0x2d);
        EXPECT(gbc.c(),  0x97);
        EXPECT(gbc.d(),  0xeb);
        EXPECT(gbc.e(),  0xd1);
        EXPECT(gbc.h(),  0xa9);
        EXPECT(gbc.l(),  0xa1);
        EXPECT(gbc.sp(), 0xce81);
        EXPECT(gbc.pc(), 0xdb7a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xdb78), 0xcb);
        EXPECT(gbc.readMem(0xdb79), 0x4);
        // CB 04 0368
        gbc.setState(0x4989, 0x12d2, 0x6ec0, 0xc483, 0x72a, 0xf952, 0x0, 0x1);
        gbc.writeMem(0x4989, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x6e);
        EXPECT(gbc.b(),  0xc4);
        EXPECT(gbc.c(),  0x83);
        EXPECT(gbc.d(),  0x7);
        EXPECT(gbc.e(),  0x2a);
        EXPECT(gbc.h(),  0xf3);
        EXPECT(gbc.l(),  0x52);
        EXPECT(gbc.sp(), 0x12d2);
        EXPECT(gbc.pc(), 0x498b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0369
        gbc.setState(0x15, 0x93e8, 0xbb80, 0xd84a, 0x3ed, 0x6450, 0x0, 0x1);
        gbc.writeMem(0x15, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xbb);
        EXPECT(gbc.b(),  0xd8);
        EXPECT(gbc.c(),  0x4a);
        EXPECT(gbc.d(),  0x3);
        EXPECT(gbc.e(),  0xed);
        EXPECT(gbc.h(),  0xc8);
        EXPECT(gbc.l(),  0x50);
        EXPECT(gbc.sp(), 0x93e8);
        EXPECT(gbc.pc(), 0x17);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 036B
        gbc.setState(0xd39d, 0x5060, 0xa990, 0xcd5e, 0x68c0, 0xad5d, 0x0, 0x1);
        gbc.writeMem(0xd39d, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa9);
        EXPECT(gbc.b(),  0xcd);
        EXPECT(gbc.c(),  0x5e);
        EXPECT(gbc.d(),  0x68);
        EXPECT(gbc.e(),  0xc0);
        EXPECT(gbc.h(),  0x5b);
        EXPECT(gbc.l(),  0x5d);
        EXPECT(gbc.sp(), 0x5060);
        EXPECT(gbc.pc(), 0xd39f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd39d), 0xcb);
        EXPECT(gbc.readMem(0xd39e), 0x4);
        // CB 04 036C
        gbc.setState(0x84b8, 0x418d, 0x4510, 0x3304, 0x9880, 0x746e, 0x0, 0x0);
        gbc.writeMem(0x84b8, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x45);
        EXPECT(gbc.b(),  0x33);
        EXPECT(gbc.c(),  0x4);
        EXPECT(gbc.d(),  0x98);
        EXPECT(gbc.e(),  0x80);
        EXPECT(gbc.h(),  0xe8);
        EXPECT(gbc.l(),  0x6e);
        EXPECT(gbc.sp(), 0x418d);
        EXPECT(gbc.pc(), 0x84ba);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x84b8), 0xcb);
        EXPECT(gbc.readMem(0x84b9), 0x4);
        // CB 04 036D
        gbc.setState(0xd12b, 0x4a63, 0xf0f0, 0xfddd, 0x61cc, 0xd881, 0x1, 0x1);
        gbc.writeMem(0xd12b, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf0);
        EXPECT(gbc.b(),  0xfd);
        EXPECT(gbc.c(),  0xdd);
        EXPECT(gbc.d(),  0x61);
        EXPECT(gbc.e(),  0xcc);
        EXPECT(gbc.h(),  0xb1);
        EXPECT(gbc.l(),  0x81);
        EXPECT(gbc.sp(), 0x4a63);
        EXPECT(gbc.pc(), 0xd12d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd12b), 0xcb);
        EXPECT(gbc.readMem(0xd12c), 0x4);
        // CB 04 036E
        gbc.setState(0xcc2, 0xd7a7, 0x920, 0xf77b, 0xb774, 0x5063, 0x0, 0x1);
        gbc.writeMem(0xcc2, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x9);
        EXPECT(gbc.b(),  0xf7);
        EXPECT(gbc.c(),  0x7b);
        EXPECT(gbc.d(),  0xb7);
        EXPECT(gbc.e(),  0x74);
        EXPECT(gbc.h(),  0xa0);
        EXPECT(gbc.l(),  0x63);
        EXPECT(gbc.sp(), 0xd7a7);
        EXPECT(gbc.pc(), 0xcc4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0370
        gbc.setState(0x5ede, 0x97c9, 0x8d70, 0x324b, 0x9f85, 0x38b6, 0x0, 0x0);
        gbc.writeMem(0x5ede, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8d);
        EXPECT(gbc.b(),  0x32);
        EXPECT(gbc.c(),  0x4b);
        EXPECT(gbc.d(),  0x9f);
        EXPECT(gbc.e(),  0x85);
        EXPECT(gbc.h(),  0x70);
        EXPECT(gbc.l(),  0xb6);
        EXPECT(gbc.sp(), 0x97c9);
        EXPECT(gbc.pc(), 0x5ee0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0371
        gbc.setState(0x126c, 0xc9f7, 0x2a60, 0x7302, 0x432f, 0x9a62, 0x1, 0x0);
        gbc.writeMem(0x126c, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2a);
        EXPECT(gbc.b(),  0x73);
        EXPECT(gbc.c(),  0x2);
        EXPECT(gbc.d(),  0x43);
        EXPECT(gbc.e(),  0x2f);
        EXPECT(gbc.h(),  0x35);
        EXPECT(gbc.l(),  0x62);
        EXPECT(gbc.sp(), 0xc9f7);
        EXPECT(gbc.pc(), 0x126e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0372
        gbc.setState(0x13ab, 0xf2f2, 0x290, 0xe4c1, 0x4372, 0x2dbe, 0x1, 0x1);
        gbc.writeMem(0x13ab, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0xe4);
        EXPECT(gbc.c(),  0xc1);
        EXPECT(gbc.d(),  0x43);
        EXPECT(gbc.e(),  0x72);
        EXPECT(gbc.h(),  0x5a);
        EXPECT(gbc.l(),  0xbe);
        EXPECT(gbc.sp(), 0xf2f2);
        EXPECT(gbc.pc(), 0x13ad);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0373
        gbc.setState(0x992b, 0x3372, 0xeb30, 0x3395, 0xb881, 0x6b5a, 0x1, 0x0);
        gbc.writeMem(0x992b, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xeb);
        EXPECT(gbc.b(),  0x33);
        EXPECT(gbc.c(),  0x95);
        EXPECT(gbc.d(),  0xb8);
        EXPECT(gbc.e(),  0x81);
        EXPECT(gbc.h(),  0xd6);
        EXPECT(gbc.l(),  0x5a);
        EXPECT(gbc.sp(), 0x3372);
        EXPECT(gbc.pc(), 0x992d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x992b), 0xcb);
        EXPECT(gbc.readMem(0x992c), 0x4);
        // CB 04 0374
        gbc.setState(0xe186, 0x88cf, 0x6a80, 0x73fc, 0xb27b, 0x7372, 0x1, 0x1);
        gbc.writeMem(0xe186, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x6a);
        EXPECT(gbc.b(),  0x73);
        EXPECT(gbc.c(),  0xfc);
        EXPECT(gbc.d(),  0xb2);
        EXPECT(gbc.e(),  0x7b);
        EXPECT(gbc.h(),  0xe6);
        EXPECT(gbc.l(),  0x72);
        EXPECT(gbc.sp(), 0x88cf);
        EXPECT(gbc.pc(), 0xe188);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe186), 0xcb);
        EXPECT(gbc.readMem(0xe187), 0x4);
        // CB 04 0375
        gbc.setState(0x3aea, 0xbf08, 0x26d0, 0xc347, 0x36ad, 0x229, 0x1, 0x1);
        gbc.writeMem(0x3aea, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x26);
        EXPECT(gbc.b(),  0xc3);
        EXPECT(gbc.c(),  0x47);
        EXPECT(gbc.d(),  0x36);
        EXPECT(gbc.e(),  0xad);
        EXPECT(gbc.h(),  0x4);
        EXPECT(gbc.l(),  0x29);
        EXPECT(gbc.sp(), 0xbf08);
        EXPECT(gbc.pc(), 0x3aec);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0376
        gbc.setState(0x3a2b, 0x1bb2, 0x4d00, 0xab5f, 0x84bf, 0xd5e9, 0x1, 0x0);
        gbc.writeMem(0x3a2b, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4d);
        EXPECT(gbc.b(),  0xab);
        EXPECT(gbc.c(),  0x5f);
        EXPECT(gbc.d(),  0x84);
        EXPECT(gbc.e(),  0xbf);
        EXPECT(gbc.h(),  0xab);
        EXPECT(gbc.l(),  0xe9);
        EXPECT(gbc.sp(), 0x1bb2);
        EXPECT(gbc.pc(), 0x3a2d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0377
        gbc.setState(0x62fd, 0x9016, 0x4fb0, 0x8af2, 0x4868, 0x2019, 0x1, 0x0);
        gbc.writeMem(0x62fd, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4f);
        EXPECT(gbc.b(),  0x8a);
        EXPECT(gbc.c(),  0xf2);
        EXPECT(gbc.d(),  0x48);
        EXPECT(gbc.e(),  0x68);
        EXPECT(gbc.h(),  0x40);
        EXPECT(gbc.l(),  0x19);
        EXPECT(gbc.sp(), 0x9016);
        EXPECT(gbc.pc(), 0x62ff);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0378
        gbc.setState(0x3c6d, 0x7cd, 0x62d0, 0x20fb, 0x7e43, 0x9181, 0x1, 0x1);
        gbc.writeMem(0x3c6d, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x62);
        EXPECT(gbc.b(),  0x20);
        EXPECT(gbc.c(),  0xfb);
        EXPECT(gbc.d(),  0x7e);
        EXPECT(gbc.e(),  0x43);
        EXPECT(gbc.h(),  0x23);
        EXPECT(gbc.l(),  0x81);
        EXPECT(gbc.sp(), 0x7cd);
        EXPECT(gbc.pc(), 0x3c6f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0379
        gbc.setState(0x92ac, 0x9acb, 0x3fe0, 0x6ba6, 0x1528, 0xc3b0, 0x0, 0x0);
        gbc.writeMem(0x92ac, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3f);
        EXPECT(gbc.b(),  0x6b);
        EXPECT(gbc.c(),  0xa6);
        EXPECT(gbc.d(),  0x15);
        EXPECT(gbc.e(),  0x28);
        EXPECT(gbc.h(),  0x87);
        EXPECT(gbc.l(),  0xb0);
        EXPECT(gbc.sp(), 0x9acb);
        EXPECT(gbc.pc(), 0x92ae);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x92ac), 0xcb);
        EXPECT(gbc.readMem(0x92ad), 0x4);
        // CB 04 037A
        gbc.setState(0xe801, 0x826f, 0x2f80, 0x8d2d, 0x64b0, 0x1a1f, 0x1, 0x1);
        gbc.writeMem(0xe801, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2f);
        EXPECT(gbc.b(),  0x8d);
        EXPECT(gbc.c(),  0x2d);
        EXPECT(gbc.d(),  0x64);
        EXPECT(gbc.e(),  0xb0);
        EXPECT(gbc.h(),  0x34);
        EXPECT(gbc.l(),  0x1f);
        EXPECT(gbc.sp(), 0x826f);
        EXPECT(gbc.pc(), 0xe803);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe801), 0xcb);
        EXPECT(gbc.readMem(0xe802), 0x4);
        // CB 04 037B
        gbc.setState(0x2ff9, 0x6c57, 0x1e60, 0xd722, 0x3700, 0x22de, 0x0, 0x0);
        gbc.writeMem(0x2ff9, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1e);
        EXPECT(gbc.b(),  0xd7);
        EXPECT(gbc.c(),  0x22);
        EXPECT(gbc.d(),  0x37);
        EXPECT(gbc.e(),  0x0);
        EXPECT(gbc.h(),  0x44);
        EXPECT(gbc.l(),  0xde);
        EXPECT(gbc.sp(), 0x6c57);
        EXPECT(gbc.pc(), 0x2ffb);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 037C
        gbc.setState(0x4632, 0xf942, 0xe3f0, 0xfdca, 0x2805, 0xa798, 0x1, 0x1);
        gbc.writeMem(0x4632, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe3);
        EXPECT(gbc.b(),  0xfd);
        EXPECT(gbc.c(),  0xca);
        EXPECT(gbc.d(),  0x28);
        EXPECT(gbc.e(),  0x5);
        EXPECT(gbc.h(),  0x4f);
        EXPECT(gbc.l(),  0x98);
        EXPECT(gbc.sp(), 0xf942);
        EXPECT(gbc.pc(), 0x4634);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 037D
        gbc.setState(0xd341, 0x3172, 0xcc30, 0x9136, 0xef07, 0xa80f, 0x0, 0x0);
        gbc.writeMem(0xd341, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xcc);
        EXPECT(gbc.b(),  0x91);
        EXPECT(gbc.c(),  0x36);
        EXPECT(gbc.d(),  0xef);
        EXPECT(gbc.e(),  0x7);
        EXPECT(gbc.h(),  0x51);
        EXPECT(gbc.l(),  0xf);
        EXPECT(gbc.sp(), 0x3172);
        EXPECT(gbc.pc(), 0xd343);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd341), 0xcb);
        EXPECT(gbc.readMem(0xd342), 0x4);
        // CB 04 037E
        gbc.setState(0xb9f0, 0xf97, 0x200, 0xed2c, 0x39f2, 0xacaa, 0x1, 0x1);
        gbc.writeMem(0xb9f0, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0xed);
        EXPECT(gbc.c(),  0x2c);
        EXPECT(gbc.d(),  0x39);
        EXPECT(gbc.e(),  0xf2);
        EXPECT(gbc.h(),  0x59);
        EXPECT(gbc.l(),  0xaa);
        EXPECT(gbc.sp(), 0xf97);
        EXPECT(gbc.pc(), 0xb9f2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb9f0), 0xcb);
        EXPECT(gbc.readMem(0xb9f1), 0x4);
        // CB 04 037F
        gbc.setState(0x30b, 0xc581, 0x3060, 0x2afe, 0x97, 0x526f, 0x0, 0x0);
        gbc.writeMem(0x30b, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x30);
        EXPECT(gbc.b(),  0x2a);
        EXPECT(gbc.c(),  0xfe);
        EXPECT(gbc.d(),  0x0);
        EXPECT(gbc.e(),  0x97);
        EXPECT(gbc.h(),  0xa4);
        EXPECT(gbc.l(),  0x6f);
        EXPECT(gbc.sp(), 0xc581);
        EXPECT(gbc.pc(), 0x30d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0380
        gbc.setState(0x45ae, 0xd11c, 0xcf30, 0x57ba, 0xf546, 0xb425, 0x1, 0x0);
        gbc.writeMem(0x45ae, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xcf);
        EXPECT(gbc.b(),  0x57);
        EXPECT(gbc.c(),  0xba);
        EXPECT(gbc.d(),  0xf5);
        EXPECT(gbc.e(),  0x46);
        EXPECT(gbc.h(),  0x69);
        EXPECT(gbc.l(),  0x25);
        EXPECT(gbc.sp(), 0xd11c);
        EXPECT(gbc.pc(), 0x45b0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0381
        gbc.setState(0x7ae2, 0x9537, 0x7b60, 0xfa03, 0x95d2, 0xb2af, 0x0, 0x1);
        gbc.writeMem(0x7ae2, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x7b);
        EXPECT(gbc.b(),  0xfa);
        EXPECT(gbc.c(),  0x3);
        EXPECT(gbc.d(),  0x95);
        EXPECT(gbc.e(),  0xd2);
        EXPECT(gbc.h(),  0x65);
        EXPECT(gbc.l(),  0xaf);
        EXPECT(gbc.sp(), 0x9537);
        EXPECT(gbc.pc(), 0x7ae4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0382
        gbc.setState(0x7844, 0xa7f9, 0xf9c0, 0x3d2d, 0x8e58, 0x21b2, 0x0, 0x1);
        gbc.writeMem(0x7844, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf9);
        EXPECT(gbc.b(),  0x3d);
        EXPECT(gbc.c(),  0x2d);
        EXPECT(gbc.d(),  0x8e);
        EXPECT(gbc.e(),  0x58);
        EXPECT(gbc.h(),  0x42);
        EXPECT(gbc.l(),  0xb2);
        EXPECT(gbc.sp(), 0xa7f9);
        EXPECT(gbc.pc(), 0x7846);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0383
        gbc.setState(0x4af8, 0xccff, 0xa4e0, 0xdc9, 0x63fe, 0xb52b, 0x0, 0x1);
        gbc.writeMem(0x4af8, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xa4);
        EXPECT(gbc.b(),  0xd);
        EXPECT(gbc.c(),  0xc9);
        EXPECT(gbc.d(),  0x63);
        EXPECT(gbc.e(),  0xfe);
        EXPECT(gbc.h(),  0x6b);
        EXPECT(gbc.l(),  0x2b);
        EXPECT(gbc.sp(), 0xccff);
        EXPECT(gbc.pc(), 0x4afa);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0384
        gbc.setState(0x3d4f, 0x35b, 0xdea0, 0x1e1a, 0xe92a, 0xa19f, 0x1, 0x1);
        gbc.writeMem(0x3d4f, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xde);
        EXPECT(gbc.b(),  0x1e);
        EXPECT(gbc.c(),  0x1a);
        EXPECT(gbc.d(),  0xe9);
        EXPECT(gbc.e(),  0x2a);
        EXPECT(gbc.h(),  0x43);
        EXPECT(gbc.l(),  0x9f);
        EXPECT(gbc.sp(), 0x35b);
        EXPECT(gbc.pc(), 0x3d51);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0385
        gbc.setState(0x97cb, 0x6fb9, 0x5720, 0x7657, 0xff32, 0xc24, 0x1, 0x0);
        gbc.writeMem(0x97cb, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x57);
        EXPECT(gbc.b(),  0x76);
        EXPECT(gbc.c(),  0x57);
        EXPECT(gbc.d(),  0xff);
        EXPECT(gbc.e(),  0x32);
        EXPECT(gbc.h(),  0x18);
        EXPECT(gbc.l(),  0x24);
        EXPECT(gbc.sp(), 0x6fb9);
        EXPECT(gbc.pc(), 0x97cd);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x97cb), 0xcb);
        EXPECT(gbc.readMem(0x97cc), 0x4);
        // CB 04 0386
        gbc.setState(0xdf29, 0x93bc, 0xaf70, 0xc7e5, 0x4d9c, 0x32ce, 0x1, 0x0);
        gbc.writeMem(0xdf29, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xaf);
        EXPECT(gbc.b(),  0xc7);
        EXPECT(gbc.c(),  0xe5);
        EXPECT(gbc.d(),  0x4d);
        EXPECT(gbc.e(),  0x9c);
        EXPECT(gbc.h(),  0x64);
        EXPECT(gbc.l(),  0xce);
        EXPECT(gbc.sp(), 0x93bc);
        EXPECT(gbc.pc(), 0xdf2b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdf29), 0xcb);
        EXPECT(gbc.readMem(0xdf2a), 0x4);
        // CB 04 0388
        gbc.setState(0x2757, 0x3564, 0xd2f0, 0x73ab, 0x8859, 0x79d1, 0x0, 0x0);
        gbc.writeMem(0x2757, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd2);
        EXPECT(gbc.b(),  0x73);
        EXPECT(gbc.c(),  0xab);
        EXPECT(gbc.d(),  0x88);
        EXPECT(gbc.e(),  0x59);
        EXPECT(gbc.h(),  0xf2);
        EXPECT(gbc.l(),  0xd1);
        EXPECT(gbc.sp(), 0x3564);
        EXPECT(gbc.pc(), 0x2759);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0389
        gbc.setState(0x97bf, 0x1ccb, 0xcc20, 0x9f8a, 0xaa6, 0x4337, 0x0, 0x0);
        gbc.writeMem(0x97bf, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xcc);
        EXPECT(gbc.b(),  0x9f);
        EXPECT(gbc.c(),  0x8a);
        EXPECT(gbc.d(),  0xa);
        EXPECT(gbc.e(),  0xa6);
        EXPECT(gbc.h(),  0x86);
        EXPECT(gbc.l(),  0x37);
        EXPECT(gbc.sp(), 0x1ccb);
        EXPECT(gbc.pc(), 0x97c1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x97bf), 0xcb);
        EXPECT(gbc.readMem(0x97c0), 0x4);
        // CB 04 038A
        gbc.setState(0x618a, 0x209b, 0x6120, 0xc3ff, 0x74e1, 0xc0a8, 0x1, 0x1);
        gbc.writeMem(0x618a, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x61);
        EXPECT(gbc.b(),  0xc3);
        EXPECT(gbc.c(),  0xff);
        EXPECT(gbc.d(),  0x74);
        EXPECT(gbc.e(),  0xe1);
        EXPECT(gbc.h(),  0x81);
        EXPECT(gbc.l(),  0xa8);
        EXPECT(gbc.sp(), 0x209b);
        EXPECT(gbc.pc(), 0x618c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 038B
        gbc.setState(0x8aec, 0x42de, 0x7090, 0x5210, 0xbbe8, 0xae61, 0x1, 0x0);
        gbc.writeMem(0x8aec, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x70);
        EXPECT(gbc.b(),  0x52);
        EXPECT(gbc.c(),  0x10);
        EXPECT(gbc.d(),  0xbb);
        EXPECT(gbc.e(),  0xe8);
        EXPECT(gbc.h(),  0x5d);
        EXPECT(gbc.l(),  0x61);
        EXPECT(gbc.sp(), 0x42de);
        EXPECT(gbc.pc(), 0x8aee);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8aec), 0xcb);
        EXPECT(gbc.readMem(0x8aed), 0x4);
        // CB 04 038D
        gbc.setState(0x74d5, 0x7a36, 0x9e90, 0x114d, 0xd4ab, 0xed11, 0x0, 0x0);
        gbc.writeMem(0x74d5, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x9e);
        EXPECT(gbc.b(),  0x11);
        EXPECT(gbc.c(),  0x4d);
        EXPECT(gbc.d(),  0xd4);
        EXPECT(gbc.e(),  0xab);
        EXPECT(gbc.h(),  0xdb);
        EXPECT(gbc.l(),  0x11);
        EXPECT(gbc.sp(), 0x7a36);
        EXPECT(gbc.pc(), 0x74d7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 038E
        gbc.setState(0xd04, 0xae2b, 0xc940, 0x616, 0x59da, 0x4597, 0x0, 0x1);
        gbc.writeMem(0xd04, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc9);
        EXPECT(gbc.b(),  0x6);
        EXPECT(gbc.c(),  0x16);
        EXPECT(gbc.d(),  0x59);
        EXPECT(gbc.e(),  0xda);
        EXPECT(gbc.h(),  0x8a);
        EXPECT(gbc.l(),  0x97);
        EXPECT(gbc.sp(), 0xae2b);
        EXPECT(gbc.pc(), 0xd06);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 038F
        gbc.setState(0xf93, 0x53b1, 0xb980, 0x2da1, 0xa121, 0xc545, 0x0, 0x0);
        gbc.writeMem(0xf93, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb9);
        EXPECT(gbc.b(),  0x2d);
        EXPECT(gbc.c(),  0xa1);
        EXPECT(gbc.d(),  0xa1);
        EXPECT(gbc.e(),  0x21);
        EXPECT(gbc.h(),  0x8b);
        EXPECT(gbc.l(),  0x45);
        EXPECT(gbc.sp(), 0x53b1);
        EXPECT(gbc.pc(), 0xf95);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0390
        gbc.setState(0x9ed1, 0x568f, 0xd20, 0x2162, 0x3701, 0x241e, 0x1, 0x1);
        gbc.writeMem(0x9ed1, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd);
        EXPECT(gbc.b(),  0x21);
        EXPECT(gbc.c(),  0x62);
        EXPECT(gbc.d(),  0x37);
        EXPECT(gbc.e(),  0x1);
        EXPECT(gbc.h(),  0x48);
        EXPECT(gbc.l(),  0x1e);
        EXPECT(gbc.sp(), 0x568f);
        EXPECT(gbc.pc(), 0x9ed3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9ed1), 0xcb);
        EXPECT(gbc.readMem(0x9ed2), 0x4);
        // CB 04 0392
        gbc.setState(0x9aa, 0x1b90, 0xf210, 0x86eb, 0x14d0, 0xafe9, 0x0, 0x0);
        gbc.writeMem(0x9aa, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf2);
        EXPECT(gbc.b(),  0x86);
        EXPECT(gbc.c(),  0xeb);
        EXPECT(gbc.d(),  0x14);
        EXPECT(gbc.e(),  0xd0);
        EXPECT(gbc.h(),  0x5f);
        EXPECT(gbc.l(),  0xe9);
        EXPECT(gbc.sp(), 0x1b90);
        EXPECT(gbc.pc(), 0x9ac);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 0393
        gbc.setState(0xcb23, 0x16a1, 0xab30, 0xc22d, 0xb882, 0x9bfe, 0x0, 0x0);
        gbc.writeMem(0xcb23, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xab);
        EXPECT(gbc.b(),  0xc2);
        EXPECT(gbc.c(),  0x2d);
        EXPECT(gbc.d(),  0xb8);
        EXPECT(gbc.e(),  0x82);
        EXPECT(gbc.h(),  0x37);
        EXPECT(gbc.l(),  0xfe);
        EXPECT(gbc.sp(), 0x16a1);
        EXPECT(gbc.pc(), 0xcb25);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcb23), 0xcb);
        EXPECT(gbc.readMem(0xcb24), 0x4);
        // CB 04 0394
        gbc.setState(0x8bab, 0x3e00, 0x4f40, 0xabe2, 0x339f, 0x2e8f, 0x0, 0x0);
        gbc.writeMem(0x8bab, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4f);
        EXPECT(gbc.b(),  0xab);
        EXPECT(gbc.c(),  0xe2);
        EXPECT(gbc.d(),  0x33);
        EXPECT(gbc.e(),  0x9f);
        EXPECT(gbc.h(),  0x5c);
        EXPECT(gbc.l(),  0x8f);
        EXPECT(gbc.sp(), 0x3e00);
        EXPECT(gbc.pc(), 0x8bad);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8bab), 0xcb);
        EXPECT(gbc.readMem(0x8bac), 0x4);
        // CB 04 0395
        gbc.setState(0x2807, 0x92ad, 0x1c10, 0xa835, 0xa962, 0x20a2, 0x1, 0x1);
        gbc.writeMem(0x2807, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1c);
        EXPECT(gbc.b(),  0xa8);
        EXPECT(gbc.c(),  0x35);
        EXPECT(gbc.d(),  0xa9);
        EXPECT(gbc.e(),  0x62);
        EXPECT(gbc.h(),  0x40);
        EXPECT(gbc.l(),  0xa2);
        EXPECT(gbc.sp(), 0x92ad);
        EXPECT(gbc.pc(), 0x2809);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0396
        gbc.setState(0xcc33, 0xfa9c, 0x7900, 0x1f84, 0xef1, 0xbe2a, 0x0, 0x0);
        gbc.writeMem(0xcc33, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x79);
        EXPECT(gbc.b(),  0x1f);
        EXPECT(gbc.c(),  0x84);
        EXPECT(gbc.d(),  0xe);
        EXPECT(gbc.e(),  0xf1);
        EXPECT(gbc.h(),  0x7d);
        EXPECT(gbc.l(),  0x2a);
        EXPECT(gbc.sp(), 0xfa9c);
        EXPECT(gbc.pc(), 0xcc35);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcc33), 0xcb);
        EXPECT(gbc.readMem(0xcc34), 0x4);
        // CB 04 0397
        gbc.setState(0x7d36, 0x685a, 0x96e0, 0x67ba, 0xd30b, 0x3b9d, 0x1, 0x0);
        gbc.writeMem(0x7d36, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x96);
        EXPECT(gbc.b(),  0x67);
        EXPECT(gbc.c(),  0xba);
        EXPECT(gbc.d(),  0xd3);
        EXPECT(gbc.e(),  0xb);
        EXPECT(gbc.h(),  0x76);
        EXPECT(gbc.l(),  0x9d);
        EXPECT(gbc.sp(), 0x685a);
        EXPECT(gbc.pc(), 0x7d38);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0398
        gbc.setState(0x2edb, 0xf617, 0x7fe0, 0x940d, 0xdd24, 0x2a6f, 0x0, 0x0);
        gbc.writeMem(0x2edb, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x7f);
        EXPECT(gbc.b(),  0x94);
        EXPECT(gbc.c(),  0xd);
        EXPECT(gbc.d(),  0xdd);
        EXPECT(gbc.e(),  0x24);
        EXPECT(gbc.h(),  0x54);
        EXPECT(gbc.l(),  0x6f);
        EXPECT(gbc.sp(), 0xf617);
        EXPECT(gbc.pc(), 0x2edd);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 0399
        gbc.setState(0xde6b, 0xc405, 0xd4f0, 0x3ecd, 0x3676, 0xf3b1, 0x1, 0x0);
        gbc.writeMem(0xde6b, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd4);
        EXPECT(gbc.b(),  0x3e);
        EXPECT(gbc.c(),  0xcd);
        EXPECT(gbc.d(),  0x36);
        EXPECT(gbc.e(),  0x76);
        EXPECT(gbc.h(),  0xe7);
        EXPECT(gbc.l(),  0xb1);
        EXPECT(gbc.sp(), 0xc405);
        EXPECT(gbc.pc(), 0xde6d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xde6b), 0xcb);
        EXPECT(gbc.readMem(0xde6c), 0x4);
        // CB 04 039A
        gbc.setState(0x3553, 0x4c4, 0xce60, 0x3693, 0x5461, 0x57e1, 0x1, 0x1);
        gbc.writeMem(0x3553, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xce);
        EXPECT(gbc.b(),  0x36);
        EXPECT(gbc.c(),  0x93);
        EXPECT(gbc.d(),  0x54);
        EXPECT(gbc.e(),  0x61);
        EXPECT(gbc.h(),  0xae);
        EXPECT(gbc.l(),  0xe1);
        EXPECT(gbc.sp(), 0x4c4);
        EXPECT(gbc.pc(), 0x3555);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 039B
        gbc.setState(0xe8f8, 0xdf43, 0xf7d0, 0xc91c, 0xc0a, 0x4caa, 0x0, 0x1);
        gbc.writeMem(0xe8f8, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xf7);
        EXPECT(gbc.b(),  0xc9);
        EXPECT(gbc.c(),  0x1c);
        EXPECT(gbc.d(),  0xc);
        EXPECT(gbc.e(),  0xa);
        EXPECT(gbc.h(),  0x98);
        EXPECT(gbc.l(),  0xaa);
        EXPECT(gbc.sp(), 0xdf43);
        EXPECT(gbc.pc(), 0xe8fa);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe8f8), 0xcb);
        EXPECT(gbc.readMem(0xe8f9), 0x4);
        // CB 04 039C
        gbc.setState(0x60d3, 0x2ef1, 0xeae0, 0xbe68, 0x7a4, 0x3786, 0x0, 0x0);
        gbc.writeMem(0x60d3, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xea);
        EXPECT(gbc.b(),  0xbe);
        EXPECT(gbc.c(),  0x68);
        EXPECT(gbc.d(),  0x7);
        EXPECT(gbc.e(),  0xa4);
        EXPECT(gbc.h(),  0x6e);
        EXPECT(gbc.l(),  0x86);
        EXPECT(gbc.sp(), 0x2ef1);
        EXPECT(gbc.pc(), 0x60d5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 039D
        gbc.setState(0x8a78, 0x3d37, 0x3390, 0x2aa9, 0x22f1, 0xcc47, 0x0, 0x0);
        gbc.writeMem(0x8a78, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x33);
        EXPECT(gbc.b(),  0x2a);
        EXPECT(gbc.c(),  0xa9);
        EXPECT(gbc.d(),  0x22);
        EXPECT(gbc.e(),  0xf1);
        EXPECT(gbc.h(),  0x99);
        EXPECT(gbc.l(),  0x47);
        EXPECT(gbc.sp(), 0x3d37);
        EXPECT(gbc.pc(), 0x8a7a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8a78), 0xcb);
        EXPECT(gbc.readMem(0x8a79), 0x4);
        // CB 04 039E
        gbc.setState(0x5d78, 0xe393, 0x7c90, 0xe799, 0x3e12, 0x5662, 0x1, 0x0);
        gbc.writeMem(0x5d78, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x7c);
        EXPECT(gbc.b(),  0xe7);
        EXPECT(gbc.c(),  0x99);
        EXPECT(gbc.d(),  0x3e);
        EXPECT(gbc.e(),  0x12);
        EXPECT(gbc.h(),  0xac);
        EXPECT(gbc.l(),  0x62);
        EXPECT(gbc.sp(), 0xe393);
        EXPECT(gbc.pc(), 0x5d7a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 039F
        gbc.setState(0x85cf, 0x89c3, 0x31e0, 0xdd68, 0x42a0, 0xbe15, 0x0, 0x1);
        gbc.writeMem(0x85cf, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x31);
        EXPECT(gbc.b(),  0xdd);
        EXPECT(gbc.c(),  0x68);
        EXPECT(gbc.d(),  0x42);
        EXPECT(gbc.e(),  0xa0);
        EXPECT(gbc.h(),  0x7d);
        EXPECT(gbc.l(),  0x15);
        EXPECT(gbc.sp(), 0x89c3);
        EXPECT(gbc.pc(), 0x85d1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x85cf), 0xcb);
        EXPECT(gbc.readMem(0x85d0), 0x4);
        // CB 04 03A0
        gbc.setState(0x7686, 0x1917, 0x9970, 0x240e, 0xc606, 0xd4e9, 0x1, 0x1);
        gbc.writeMem(0x7686, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x99);
        EXPECT(gbc.b(),  0x24);
        EXPECT(gbc.c(),  0xe);
        EXPECT(gbc.d(),  0xc6);
        EXPECT(gbc.e(),  0x6);
        EXPECT(gbc.h(),  0xa9);
        EXPECT(gbc.l(),  0xe9);
        EXPECT(gbc.sp(), 0x1917);
        EXPECT(gbc.pc(), 0x7688);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 03A1
        gbc.setState(0xa2fa, 0xa72, 0x4ae0, 0x2753, 0xc5a5, 0xef05, 0x0, 0x1);
        gbc.writeMem(0xa2fa, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4a);
        EXPECT(gbc.b(),  0x27);
        EXPECT(gbc.c(),  0x53);
        EXPECT(gbc.d(),  0xc5);
        EXPECT(gbc.e(),  0xa5);
        EXPECT(gbc.h(),  0xdf);
        EXPECT(gbc.l(),  0x5);
        EXPECT(gbc.sp(), 0xa72);
        EXPECT(gbc.pc(), 0xa2fc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa2fa), 0xcb);
        EXPECT(gbc.readMem(0xa2fb), 0x4);
        // CB 04 03A2
        gbc.setState(0x390d, 0xaa47, 0x6a0, 0xa0bb, 0xad89, 0x3be7, 0x1, 0x1);
        gbc.writeMem(0x390d, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x6);
        EXPECT(gbc.b(),  0xa0);
        EXPECT(gbc.c(),  0xbb);
        EXPECT(gbc.d(),  0xad);
        EXPECT(gbc.e(),  0x89);
        EXPECT(gbc.h(),  0x76);
        EXPECT(gbc.l(),  0xe7);
        EXPECT(gbc.sp(), 0xaa47);
        EXPECT(gbc.pc(), 0x390f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 03A3
        gbc.setState(0x3703, 0x4988, 0x28d0, 0x1bd1, 0xa5a8, 0x533b, 0x0, 0x0);
        gbc.writeMem(0x3703, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0x1b);
        EXPECT(gbc.c(),  0xd1);
        EXPECT(gbc.d(),  0xa5);
        EXPECT(gbc.e(),  0xa8);
        EXPECT(gbc.h(),  0xa6);
        EXPECT(gbc.l(),  0x3b);
        EXPECT(gbc.sp(), 0x4988);
        EXPECT(gbc.pc(), 0x3705);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 03A4
        gbc.setState(0x61b9, 0xc3de, 0x1810, 0x1aec, 0xecf9, 0xcae7, 0x1, 0x1);
        gbc.writeMem(0x61b9, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x18);
        EXPECT(gbc.b(),  0x1a);
        EXPECT(gbc.c(),  0xec);
        EXPECT(gbc.d(),  0xec);
        EXPECT(gbc.e(),  0xf9);
        EXPECT(gbc.h(),  0x95);
        EXPECT(gbc.l(),  0xe7);
        EXPECT(gbc.sp(), 0xc3de);
        EXPECT(gbc.pc(), 0x61bb);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 03A5
        gbc.setState(0x803, 0xf7dd, 0x9440, 0x5120, 0xef40, 0xc07d, 0x1, 0x0);
        gbc.writeMem(0x803, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x94);
        EXPECT(gbc.b(),  0x51);
        EXPECT(gbc.c(),  0x20);
        EXPECT(gbc.d(),  0xef);
        EXPECT(gbc.e(),  0x40);
        EXPECT(gbc.h(),  0x81);
        EXPECT(gbc.l(),  0x7d);
        EXPECT(gbc.sp(), 0xf7dd);
        EXPECT(gbc.pc(), 0x805);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 03A6
        gbc.setState(0x3c84, 0x83d4, 0xca10, 0x8d26, 0xd075, 0xbb61, 0x1, 0x1);
        gbc.writeMem(0x3c84, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xca);
        EXPECT(gbc.b(),  0x8d);
        EXPECT(gbc.c(),  0x26);
        EXPECT(gbc.d(),  0xd0);
        EXPECT(gbc.e(),  0x75);
        EXPECT(gbc.h(),  0x77);
        EXPECT(gbc.l(),  0x61);
        EXPECT(gbc.sp(), 0x83d4);
        EXPECT(gbc.pc(), 0x3c86);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 03A7
        gbc.setState(0x2b46, 0xaca1, 0x4110, 0x39c6, 0xd845, 0x55c3, 0x0, 0x1);
        gbc.writeMem(0x2b46, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x41);
        EXPECT(gbc.b(),  0x39);
        EXPECT(gbc.c(),  0xc6);
        EXPECT(gbc.d(),  0xd8);
        EXPECT(gbc.e(),  0x45);
        EXPECT(gbc.h(),  0xaa);
        EXPECT(gbc.l(),  0xc3);
        EXPECT(gbc.sp(), 0xaca1);
        EXPECT(gbc.pc(), 0x2b48);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 03A8
        gbc.setState(0x1eb2, 0x6a72, 0x940, 0x1011, 0xf026, 0x2dc0, 0x0, 0x1);
        gbc.writeMem(0x1eb2, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x9);
        EXPECT(gbc.b(),  0x10);
        EXPECT(gbc.c(),  0x11);
        EXPECT(gbc.d(),  0xf0);
        EXPECT(gbc.e(),  0x26);
        EXPECT(gbc.h(),  0x5a);
        EXPECT(gbc.l(),  0xc0);
        EXPECT(gbc.sp(), 0x6a72);
        EXPECT(gbc.pc(), 0x1eb4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 03A9
        gbc.setState(0xc78b, 0xe819, 0xe390, 0x6223, 0x7c60, 0xfb28, 0x1, 0x1);
        gbc.writeMem(0xc78b, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe3);
        EXPECT(gbc.b(),  0x62);
        EXPECT(gbc.c(),  0x23);
        EXPECT(gbc.d(),  0x7c);
        EXPECT(gbc.e(),  0x60);
        EXPECT(gbc.h(),  0xf7);
        EXPECT(gbc.l(),  0x28);
        EXPECT(gbc.sp(), 0xe819);
        EXPECT(gbc.pc(), 0xc78d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc78b), 0xcb);
        EXPECT(gbc.readMem(0xc78c), 0x4);
        // CB 04 03AA
        gbc.setState(0x3ae3, 0xb2ed, 0xebd0, 0xfeac, 0xb58f, 0x4ed9, 0x0, 0x0);
        gbc.writeMem(0x3ae3, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xeb);
        EXPECT(gbc.b(),  0xfe);
        EXPECT(gbc.c(),  0xac);
        EXPECT(gbc.d(),  0xb5);
        EXPECT(gbc.e(),  0x8f);
        EXPECT(gbc.h(),  0x9c);
        EXPECT(gbc.l(),  0xd9);
        EXPECT(gbc.sp(), 0xb2ed);
        EXPECT(gbc.pc(), 0x3ae5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 03AB
        gbc.setState(0xd9f8, 0xc2a7, 0xe0f0, 0x59fe, 0xb0ff, 0x16bd, 0x0, 0x0);
        gbc.writeMem(0xd9f8, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe0);
        EXPECT(gbc.b(),  0x59);
        EXPECT(gbc.c(),  0xfe);
        EXPECT(gbc.d(),  0xb0);
        EXPECT(gbc.e(),  0xff);
        EXPECT(gbc.h(),  0x2c);
        EXPECT(gbc.l(),  0xbd);
        EXPECT(gbc.sp(), 0xc2a7);
        EXPECT(gbc.pc(), 0xd9fa);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd9f8), 0xcb);
        EXPECT(gbc.readMem(0xd9f9), 0x4);
        // CB 04 03AC
        gbc.setState(0xb0a7, 0x5525, 0x8fd0, 0xb217, 0xc85a, 0x20c, 0x0, 0x0);
        gbc.writeMem(0xb0a7, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8f);
        EXPECT(gbc.b(),  0xb2);
        EXPECT(gbc.c(),  0x17);
        EXPECT(gbc.d(),  0xc8);
        EXPECT(gbc.e(),  0x5a);
        EXPECT(gbc.h(),  0x4);
        EXPECT(gbc.l(),  0xc);
        EXPECT(gbc.sp(), 0x5525);
        EXPECT(gbc.pc(), 0xb0a9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb0a7), 0xcb);
        EXPECT(gbc.readMem(0xb0a8), 0x4);
        // CB 04 03AD
        gbc.setState(0x9405, 0x2b3d, 0xd1b0, 0xb016, 0x97d1, 0xce88, 0x0, 0x0);
        gbc.writeMem(0x9405, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd1);
        EXPECT(gbc.b(),  0xb0);
        EXPECT(gbc.c(),  0x16);
        EXPECT(gbc.d(),  0x97);
        EXPECT(gbc.e(),  0xd1);
        EXPECT(gbc.h(),  0x9d);
        EXPECT(gbc.l(),  0x88);
        EXPECT(gbc.sp(), 0x2b3d);
        EXPECT(gbc.pc(), 0x9407);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9405), 0xcb);
        EXPECT(gbc.readMem(0x9406), 0x4);
        // CB 04 03AE
        gbc.setState(0x4eff, 0x8d89, 0xc230, 0xcca9, 0x2b67, 0x55ad, 0x1, 0x0);
        gbc.writeMem(0x4eff, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc2);
        EXPECT(gbc.b(),  0xcc);
        EXPECT(gbc.c(),  0xa9);
        EXPECT(gbc.d(),  0x2b);
        EXPECT(gbc.e(),  0x67);
        EXPECT(gbc.h(),  0xaa);
        EXPECT(gbc.l(),  0xad);
        EXPECT(gbc.sp(), 0x8d89);
        EXPECT(gbc.pc(), 0x4f01);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 03AF
        gbc.setState(0x9051, 0x530e, 0x4190, 0xe605, 0x7f1c, 0xf35e, 0x0, 0x0);
        gbc.writeMem(0x9051, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x41);
        EXPECT(gbc.b(),  0xe6);
        EXPECT(gbc.c(),  0x5);
        EXPECT(gbc.d(),  0x7f);
        EXPECT(gbc.e(),  0x1c);
        EXPECT(gbc.h(),  0xe7);
        EXPECT(gbc.l(),  0x5e);
        EXPECT(gbc.sp(), 0x530e);
        EXPECT(gbc.pc(), 0x9053);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9051), 0xcb);
        EXPECT(gbc.readMem(0x9052), 0x4);
        // CB 04 03B0
        gbc.setState(0x88e3, 0xf65b, 0x5820, 0x7a9c, 0x3185, 0x17ac, 0x1, 0x1);
        gbc.writeMem(0x88e3, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x58);
        EXPECT(gbc.b(),  0x7a);
        EXPECT(gbc.c(),  0x9c);
        EXPECT(gbc.d(),  0x31);
        EXPECT(gbc.e(),  0x85);
        EXPECT(gbc.h(),  0x2e);
        EXPECT(gbc.l(),  0xac);
        EXPECT(gbc.sp(), 0xf65b);
        EXPECT(gbc.pc(), 0x88e5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x88e3), 0xcb);
        EXPECT(gbc.readMem(0x88e4), 0x4);
        // CB 04 03B1
        gbc.setState(0x114, 0x4226, 0x4400, 0x8051, 0xd4da, 0xe871, 0x1, 0x1);
        gbc.writeMem(0x114, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x44);
        EXPECT(gbc.b(),  0x80);
        EXPECT(gbc.c(),  0x51);
        EXPECT(gbc.d(),  0xd4);
        EXPECT(gbc.e(),  0xda);
        EXPECT(gbc.h(),  0xd1);
        EXPECT(gbc.l(),  0x71);
        EXPECT(gbc.sp(), 0x4226);
        EXPECT(gbc.pc(), 0x116);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 03B3
        gbc.setState(0x4963, 0x7d50, 0xd5c0, 0xdeee, 0x6847, 0x349d, 0x0, 0x1);
        gbc.writeMem(0x4963, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd5);
        EXPECT(gbc.b(),  0xde);
        EXPECT(gbc.c(),  0xee);
        EXPECT(gbc.d(),  0x68);
        EXPECT(gbc.e(),  0x47);
        EXPECT(gbc.h(),  0x68);
        EXPECT(gbc.l(),  0x9d);
        EXPECT(gbc.sp(), 0x7d50);
        EXPECT(gbc.pc(), 0x4965);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 03B4
        gbc.setState(0x87a9, 0xd6b4, 0xc9c0, 0x429c, 0xb4bb, 0x2a6d, 0x1, 0x0);
        gbc.writeMem(0x87a9, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc9);
        EXPECT(gbc.b(),  0x42);
        EXPECT(gbc.c(),  0x9c);
        EXPECT(gbc.d(),  0xb4);
        EXPECT(gbc.e(),  0xbb);
        EXPECT(gbc.h(),  0x54);
        EXPECT(gbc.l(),  0x6d);
        EXPECT(gbc.sp(), 0xd6b4);
        EXPECT(gbc.pc(), 0x87ab);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x87a9), 0xcb);
        EXPECT(gbc.readMem(0x87aa), 0x4);
        // CB 04 03B5
        gbc.setState(0x46a6, 0x1ad7, 0x6390, 0xa256, 0x2e6f, 0xbfae, 0x0, 0x1);
        gbc.writeMem(0x46a6, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x63);
        EXPECT(gbc.b(),  0xa2);
        EXPECT(gbc.c(),  0x56);
        EXPECT(gbc.d(),  0x2e);
        EXPECT(gbc.e(),  0x6f);
        EXPECT(gbc.h(),  0x7f);
        EXPECT(gbc.l(),  0xae);
        EXPECT(gbc.sp(), 0x1ad7);
        EXPECT(gbc.pc(), 0x46a8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 03B6
        gbc.setState(0x2a7a, 0xbe1, 0x3bc0, 0xa2c5, 0x73e8, 0xcf1, 0x1, 0x1);
        gbc.writeMem(0x2a7a, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3b);
        EXPECT(gbc.b(),  0xa2);
        EXPECT(gbc.c(),  0xc5);
        EXPECT(gbc.d(),  0x73);
        EXPECT(gbc.e(),  0xe8);
        EXPECT(gbc.h(),  0x18);
        EXPECT(gbc.l(),  0xf1);
        EXPECT(gbc.sp(), 0xbe1);
        EXPECT(gbc.pc(), 0x2a7c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 03B7
        gbc.setState(0x25ea, 0xe8bf, 0xb670, 0xadf9, 0xf432, 0xfdd9, 0x0, 0x1);
        gbc.writeMem(0x25ea, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb6);
        EXPECT(gbc.b(),  0xad);
        EXPECT(gbc.c(),  0xf9);
        EXPECT(gbc.d(),  0xf4);
        EXPECT(gbc.e(),  0x32);
        EXPECT(gbc.h(),  0xfb);
        EXPECT(gbc.l(),  0xd9);
        EXPECT(gbc.sp(), 0xe8bf);
        EXPECT(gbc.pc(), 0x25ec);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 03B8
        gbc.setState(0x3979, 0xbbcf, 0x6ca0, 0x42d, 0xf1d8, 0xa07d, 0x1, 0x1);
        gbc.writeMem(0x3979, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x6c);
        EXPECT(gbc.b(),  0x4);
        EXPECT(gbc.c(),  0x2d);
        EXPECT(gbc.d(),  0xf1);
        EXPECT(gbc.e(),  0xd8);
        EXPECT(gbc.h(),  0x41);
        EXPECT(gbc.l(),  0x7d);
        EXPECT(gbc.sp(), 0xbbcf);
        EXPECT(gbc.pc(), 0x397b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 03B9
        gbc.setState(0xed6, 0xa560, 0xe2e0, 0xdef9, 0xb0e9, 0x2d3e, 0x0, 0x1);
        gbc.writeMem(0xed6, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe2);
        EXPECT(gbc.b(),  0xde);
        EXPECT(gbc.c(),  0xf9);
        EXPECT(gbc.d(),  0xb0);
        EXPECT(gbc.e(),  0xe9);
        EXPECT(gbc.h(),  0x5a);
        EXPECT(gbc.l(),  0x3e);
        EXPECT(gbc.sp(), 0xa560);
        EXPECT(gbc.pc(), 0xed8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 03BA
        gbc.setState(0xcfa5, 0xbba4, 0xea80, 0x98f8, 0xdda4, 0x1a73, 0x1, 0x1);
        gbc.writeMem(0xcfa5, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xea);
        EXPECT(gbc.b(),  0x98);
        EXPECT(gbc.c(),  0xf8);
        EXPECT(gbc.d(),  0xdd);
        EXPECT(gbc.e(),  0xa4);
        EXPECT(gbc.h(),  0x34);
        EXPECT(gbc.l(),  0x73);
        EXPECT(gbc.sp(), 0xbba4);
        EXPECT(gbc.pc(), 0xcfa7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcfa5), 0xcb);
        EXPECT(gbc.readMem(0xcfa6), 0x4);
        // CB 04 03BB
        gbc.setState(0x6c49, 0xd955, 0x3260, 0xbd28, 0xf64d, 0x2ced, 0x0, 0x1);
        gbc.writeMem(0x6c49, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x32);
        EXPECT(gbc.b(),  0xbd);
        EXPECT(gbc.c(),  0x28);
        EXPECT(gbc.d(),  0xf6);
        EXPECT(gbc.e(),  0x4d);
        EXPECT(gbc.h(),  0x58);
        EXPECT(gbc.l(),  0xed);
        EXPECT(gbc.sp(), 0xd955);
        EXPECT(gbc.pc(), 0x6c4b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 03BC
        gbc.setState(0x348f, 0xd060, 0x1800, 0xed95, 0xb090, 0xde64, 0x0, 0x0);
        gbc.writeMem(0x348f, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x18);
        EXPECT(gbc.b(),  0xed);
        EXPECT(gbc.c(),  0x95);
        EXPECT(gbc.d(),  0xb0);
        EXPECT(gbc.e(),  0x90);
        EXPECT(gbc.h(),  0xbd);
        EXPECT(gbc.l(),  0x64);
        EXPECT(gbc.sp(), 0xd060);
        EXPECT(gbc.pc(), 0x3491);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 03BD
        gbc.setState(0x820, 0x1fd6, 0xe000, 0xeabe, 0xce1, 0xf34, 0x0, 0x1);
        gbc.writeMem(0x820, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe0);
        EXPECT(gbc.b(),  0xea);
        EXPECT(gbc.c(),  0xbe);
        EXPECT(gbc.d(),  0xc);
        EXPECT(gbc.e(),  0xe1);
        EXPECT(gbc.h(),  0x1e);
        EXPECT(gbc.l(),  0x34);
        EXPECT(gbc.sp(), 0x1fd6);
        EXPECT(gbc.pc(), 0x822);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 03BE
        gbc.setState(0x8cc7, 0x1092, 0xdf80, 0x4873, 0x45ac, 0x2316, 0x0, 0x1);
        gbc.writeMem(0x8cc7, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xdf);
        EXPECT(gbc.b(),  0x48);
        EXPECT(gbc.c(),  0x73);
        EXPECT(gbc.d(),  0x45);
        EXPECT(gbc.e(),  0xac);
        EXPECT(gbc.h(),  0x46);
        EXPECT(gbc.l(),  0x16);
        EXPECT(gbc.sp(), 0x1092);
        EXPECT(gbc.pc(), 0x8cc9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8cc7), 0xcb);
        EXPECT(gbc.readMem(0x8cc8), 0x4);
        // CB 04 03BF
        gbc.setState(0x21cc, 0xf328, 0xb0d0, 0xb7bf, 0xc08, 0xe717, 0x0, 0x0);
        gbc.writeMem(0x21cc, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb0);
        EXPECT(gbc.b(),  0xb7);
        EXPECT(gbc.c(),  0xbf);
        EXPECT(gbc.d(),  0xc);
        EXPECT(gbc.e(),  0x8);
        EXPECT(gbc.h(),  0xcf);
        EXPECT(gbc.l(),  0x17);
        EXPECT(gbc.sp(), 0xf328);
        EXPECT(gbc.pc(), 0x21ce);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 03C0
        gbc.setState(0xd68c, 0xa641, 0x3430, 0x5f61, 0xd4d5, 0xc240, 0x0, 0x1);
        gbc.writeMem(0xd68c, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x34);
        EXPECT(gbc.b(),  0x5f);
        EXPECT(gbc.c(),  0x61);
        EXPECT(gbc.d(),  0xd4);
        EXPECT(gbc.e(),  0xd5);
        EXPECT(gbc.h(),  0x85);
        EXPECT(gbc.l(),  0x40);
        EXPECT(gbc.sp(), 0xa641);
        EXPECT(gbc.pc(), 0xd68e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd68c), 0xcb);
        EXPECT(gbc.readMem(0xd68d), 0x4);
        // CB 04 03C1
        gbc.setState(0x76cb, 0x63e0, 0x2800, 0xc9cc, 0xe16, 0x328, 0x1, 0x1);
        gbc.writeMem(0x76cb, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0xc9);
        EXPECT(gbc.c(),  0xcc);
        EXPECT(gbc.d(),  0xe);
        EXPECT(gbc.e(),  0x16);
        EXPECT(gbc.h(),  0x6);
        EXPECT(gbc.l(),  0x28);
        EXPECT(gbc.sp(), 0x63e0);
        EXPECT(gbc.pc(), 0x76cd);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 03C2
        gbc.setState(0xe450, 0x5cae, 0xfbe0, 0x7b26, 0x24df, 0x5dec, 0x1, 0x0);
        gbc.writeMem(0xe450, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xfb);
        EXPECT(gbc.b(),  0x7b);
        EXPECT(gbc.c(),  0x26);
        EXPECT(gbc.d(),  0x24);
        EXPECT(gbc.e(),  0xdf);
        EXPECT(gbc.h(),  0xba);
        EXPECT(gbc.l(),  0xec);
        EXPECT(gbc.sp(), 0x5cae);
        EXPECT(gbc.pc(), 0xe452);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe450), 0xcb);
        EXPECT(gbc.readMem(0xe451), 0x4);
        // CB 04 03C3
        gbc.setState(0xaa8b, 0xe450, 0xb2a0, 0x190f, 0x6494, 0xb78f, 0x0, 0x1);
        gbc.writeMem(0xaa8b, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xb2);
        EXPECT(gbc.b(),  0x19);
        EXPECT(gbc.c(),  0xf);
        EXPECT(gbc.d(),  0x64);
        EXPECT(gbc.e(),  0x94);
        EXPECT(gbc.h(),  0x6f);
        EXPECT(gbc.l(),  0x8f);
        EXPECT(gbc.sp(), 0xe450);
        EXPECT(gbc.pc(), 0xaa8d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xaa8b), 0xcb);
        EXPECT(gbc.readMem(0xaa8c), 0x4);
        // CB 04 03C4
        gbc.setState(0x1e4d, 0x494f, 0x1c50, 0x3ffc, 0x468, 0xd592, 0x1, 0x1);
        gbc.writeMem(0x1e4d, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1c);
        EXPECT(gbc.b(),  0x3f);
        EXPECT(gbc.c(),  0xfc);
        EXPECT(gbc.d(),  0x4);
        EXPECT(gbc.e(),  0x68);
        EXPECT(gbc.h(),  0xab);
        EXPECT(gbc.l(),  0x92);
        EXPECT(gbc.sp(), 0x494f);
        EXPECT(gbc.pc(), 0x1e4f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 03C5
        gbc.setState(0x8389, 0x6e4e, 0x9d20, 0x5944, 0xe985, 0x8ba0, 0x1, 0x0);
        gbc.writeMem(0x8389, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x9d);
        EXPECT(gbc.b(),  0x59);
        EXPECT(gbc.c(),  0x44);
        EXPECT(gbc.d(),  0xe9);
        EXPECT(gbc.e(),  0x85);
        EXPECT(gbc.h(),  0x17);
        EXPECT(gbc.l(),  0xa0);
        EXPECT(gbc.sp(), 0x6e4e);
        EXPECT(gbc.pc(), 0x838b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8389), 0xcb);
        EXPECT(gbc.readMem(0x838a), 0x4);
        // CB 04 03C6
        gbc.setState(0x90bc, 0xe809, 0x3490, 0x2a55, 0x104d, 0x2b23, 0x1, 0x0);
        gbc.writeMem(0x90bc, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x34);
        EXPECT(gbc.b(),  0x2a);
        EXPECT(gbc.c(),  0x55);
        EXPECT(gbc.d(),  0x10);
        EXPECT(gbc.e(),  0x4d);
        EXPECT(gbc.h(),  0x56);
        EXPECT(gbc.l(),  0x23);
        EXPECT(gbc.sp(), 0xe809);
        EXPECT(gbc.pc(), 0x90be);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x90bc), 0xcb);
        EXPECT(gbc.readMem(0x90bd), 0x4);
        // CB 04 03C7
        gbc.setState(0x468b, 0x5797, 0xaee0, 0xb4d4, 0x7cdc, 0xa6ae, 0x0, 0x0);
        gbc.writeMem(0x468b, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xae);
        EXPECT(gbc.b(),  0xb4);
        EXPECT(gbc.c(),  0xd4);
        EXPECT(gbc.d(),  0x7c);
        EXPECT(gbc.e(),  0xdc);
        EXPECT(gbc.h(),  0x4d);
        EXPECT(gbc.l(),  0xae);
        EXPECT(gbc.sp(), 0x5797);
        EXPECT(gbc.pc(), 0x468d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 03C8
        gbc.setState(0xec3c, 0xb4dd, 0xefd0, 0x2fee, 0x68e9, 0x2ef9, 0x1, 0x0);
        gbc.writeMem(0xec3c, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xef);
        EXPECT(gbc.b(),  0x2f);
        EXPECT(gbc.c(),  0xee);
        EXPECT(gbc.d(),  0x68);
        EXPECT(gbc.e(),  0xe9);
        EXPECT(gbc.h(),  0x5c);
        EXPECT(gbc.l(),  0xf9);
        EXPECT(gbc.sp(), 0xb4dd);
        EXPECT(gbc.pc(), 0xec3e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xec3c), 0xcb);
        EXPECT(gbc.readMem(0xec3d), 0x4);
        // CB 04 03CA
        gbc.setState(0x42f4, 0xd2c7, 0x4060, 0xe3fc, 0x1ec3, 0x1140, 0x0, 0x1);
        gbc.writeMem(0x42f4, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0xe3);
        EXPECT(gbc.c(),  0xfc);
        EXPECT(gbc.d(),  0x1e);
        EXPECT(gbc.e(),  0xc3);
        EXPECT(gbc.h(),  0x22);
        EXPECT(gbc.l(),  0x40);
        EXPECT(gbc.sp(), 0xd2c7);
        EXPECT(gbc.pc(), 0x42f6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 03CB
        gbc.setState(0x8729, 0x8d0a, 0xcc40, 0x2454, 0xf50b, 0x40dc, 0x1, 0x1);
        gbc.writeMem(0x8729, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xcc);
        EXPECT(gbc.b(),  0x24);
        EXPECT(gbc.c(),  0x54);
        EXPECT(gbc.d(),  0xf5);
        EXPECT(gbc.e(),  0xb);
        EXPECT(gbc.h(),  0x80);
        EXPECT(gbc.l(),  0xdc);
        EXPECT(gbc.sp(), 0x8d0a);
        EXPECT(gbc.pc(), 0x872b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8729), 0xcb);
        EXPECT(gbc.readMem(0x872a), 0x4);
        // CB 04 03CC
        gbc.setState(0x6941, 0x4cfe, 0x9b30, 0x1d57, 0xb314, 0x4cc1, 0x1, 0x0);
        gbc.writeMem(0x6941, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x9b);
        EXPECT(gbc.b(),  0x1d);
        EXPECT(gbc.c(),  0x57);
        EXPECT(gbc.d(),  0xb3);
        EXPECT(gbc.e(),  0x14);
        EXPECT(gbc.h(),  0x98);
        EXPECT(gbc.l(),  0xc1);
        EXPECT(gbc.sp(), 0x4cfe);
        EXPECT(gbc.pc(), 0x6943);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 03CE
        gbc.setState(0xd853, 0x1514, 0xe540, 0x9e80, 0x1fee, 0x2f68, 0x1, 0x1);
        gbc.writeMem(0xd853, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe5);
        EXPECT(gbc.b(),  0x9e);
        EXPECT(gbc.c(),  0x80);
        EXPECT(gbc.d(),  0x1f);
        EXPECT(gbc.e(),  0xee);
        EXPECT(gbc.h(),  0x5e);
        EXPECT(gbc.l(),  0x68);
        EXPECT(gbc.sp(), 0x1514);
        EXPECT(gbc.pc(), 0xd855);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd853), 0xcb);
        EXPECT(gbc.readMem(0xd854), 0x4);
        // CB 04 03CF
        gbc.setState(0x70a, 0xb6e9, 0x2760, 0xc210, 0x1f33, 0x3a95, 0x1, 0x1);
        gbc.writeMem(0x70a, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x27);
        EXPECT(gbc.b(),  0xc2);
        EXPECT(gbc.c(),  0x10);
        EXPECT(gbc.d(),  0x1f);
        EXPECT(gbc.e(),  0x33);
        EXPECT(gbc.h(),  0x74);
        EXPECT(gbc.l(),  0x95);
        EXPECT(gbc.sp(), 0xb6e9);
        EXPECT(gbc.pc(), 0x70c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 03D0
        gbc.setState(0x40a4, 0xcaee, 0x8e00, 0xc583, 0x3151, 0x8abb, 0x0, 0x0);
        gbc.writeMem(0x40a4, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x8e);
        EXPECT(gbc.b(),  0xc5);
        EXPECT(gbc.c(),  0x83);
        EXPECT(gbc.d(),  0x31);
        EXPECT(gbc.e(),  0x51);
        EXPECT(gbc.h(),  0x15);
        EXPECT(gbc.l(),  0xbb);
        EXPECT(gbc.sp(), 0xcaee);
        EXPECT(gbc.pc(), 0x40a6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 03D1
        gbc.setState(0xdc70, 0xb511, 0x45c0, 0x367e, 0x65bc, 0x67c8, 0x0, 0x1);
        gbc.writeMem(0xdc70, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x45);
        EXPECT(gbc.b(),  0x36);
        EXPECT(gbc.c(),  0x7e);
        EXPECT(gbc.d(),  0x65);
        EXPECT(gbc.e(),  0xbc);
        EXPECT(gbc.h(),  0xce);
        EXPECT(gbc.l(),  0xc8);
        EXPECT(gbc.sp(), 0xb511);
        EXPECT(gbc.pc(), 0xdc72);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdc70), 0xcb);
        EXPECT(gbc.readMem(0xdc71), 0x4);
        // CB 04 03D2
        gbc.setState(0x394, 0x3e, 0xdd20, 0xf15b, 0xabb3, 0xbd46, 0x0, 0x0);
        gbc.writeMem(0x394, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xdd);
        EXPECT(gbc.b(),  0xf1);
        EXPECT(gbc.c(),  0x5b);
        EXPECT(gbc.d(),  0xab);
        EXPECT(gbc.e(),  0xb3);
        EXPECT(gbc.h(),  0x7b);
        EXPECT(gbc.l(),  0x46);
        EXPECT(gbc.sp(), 0x3e);
        EXPECT(gbc.pc(), 0x396);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 03D3
        gbc.setState(0xb33f, 0x67ac, 0xcc70, 0xdd09, 0x2919, 0x1b9a, 0x1, 0x0);
        gbc.writeMem(0xb33f, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xcc);
        EXPECT(gbc.b(),  0xdd);
        EXPECT(gbc.c(),  0x9);
        EXPECT(gbc.d(),  0x29);
        EXPECT(gbc.e(),  0x19);
        EXPECT(gbc.h(),  0x36);
        EXPECT(gbc.l(),  0x9a);
        EXPECT(gbc.sp(), 0x67ac);
        EXPECT(gbc.pc(), 0xb341);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb33f), 0xcb);
        EXPECT(gbc.readMem(0xb340), 0x4);
        // CB 04 03D4
        gbc.setState(0xb51f, 0xb688, 0x41c0, 0xa99a, 0x51c2, 0x1a56, 0x1, 0x1);
        gbc.writeMem(0xb51f, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x41);
        EXPECT(gbc.b(),  0xa9);
        EXPECT(gbc.c(),  0x9a);
        EXPECT(gbc.d(),  0x51);
        EXPECT(gbc.e(),  0xc2);
        EXPECT(gbc.h(),  0x34);
        EXPECT(gbc.l(),  0x56);
        EXPECT(gbc.sp(), 0xb688);
        EXPECT(gbc.pc(), 0xb521);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb51f), 0xcb);
        EXPECT(gbc.readMem(0xb520), 0x4);
        // CB 04 03D5
        gbc.setState(0x90a4, 0x2da, 0x2990, 0x9f74, 0xf8b9, 0x2182, 0x1, 0x1);
        gbc.writeMem(0x90a4, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x29);
        EXPECT(gbc.b(),  0x9f);
        EXPECT(gbc.c(),  0x74);
        EXPECT(gbc.d(),  0xf8);
        EXPECT(gbc.e(),  0xb9);
        EXPECT(gbc.h(),  0x42);
        EXPECT(gbc.l(),  0x82);
        EXPECT(gbc.sp(), 0x2da);
        EXPECT(gbc.pc(), 0x90a6);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x90a4), 0xcb);
        EXPECT(gbc.readMem(0x90a5), 0x4);
        // CB 04 03D7
        gbc.setState(0x6ebc, 0xc8b5, 0x1960, 0x262d, 0x6501, 0x718f, 0x0, 0x0);
        gbc.writeMem(0x6ebc, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x19);
        EXPECT(gbc.b(),  0x26);
        EXPECT(gbc.c(),  0x2d);
        EXPECT(gbc.d(),  0x65);
        EXPECT(gbc.e(),  0x1);
        EXPECT(gbc.h(),  0xe2);
        EXPECT(gbc.l(),  0x8f);
        EXPECT(gbc.sp(), 0xc8b5);
        EXPECT(gbc.pc(), 0x6ebe);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 03D9
        gbc.setState(0xc4cb, 0x9fa7, 0xcf60, 0x76d, 0xb955, 0x6a52, 0x1, 0x1);
        gbc.writeMem(0xc4cb, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xcf);
        EXPECT(gbc.b(),  0x7);
        EXPECT(gbc.c(),  0x6d);
        EXPECT(gbc.d(),  0xb9);
        EXPECT(gbc.e(),  0x55);
        EXPECT(gbc.h(),  0xd4);
        EXPECT(gbc.l(),  0x52);
        EXPECT(gbc.sp(), 0x9fa7);
        EXPECT(gbc.pc(), 0xc4cd);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc4cb), 0xcb);
        EXPECT(gbc.readMem(0xc4cc), 0x4);
        // CB 04 03DA
        gbc.setState(0x760, 0x2596, 0x7420, 0x4a53, 0xe872, 0x2923, 0x1, 0x0);
        gbc.writeMem(0x760, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x74);
        EXPECT(gbc.b(),  0x4a);
        EXPECT(gbc.c(),  0x53);
        EXPECT(gbc.d(),  0xe8);
        EXPECT(gbc.e(),  0x72);
        EXPECT(gbc.h(),  0x52);
        EXPECT(gbc.l(),  0x23);
        EXPECT(gbc.sp(), 0x2596);
        EXPECT(gbc.pc(), 0x762);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 03DB
        gbc.setState(0x9532, 0x1524, 0x1340, 0xbb74, 0xbb9c, 0x2803, 0x0, 0x0);
        gbc.writeMem(0x9532, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x13);
        EXPECT(gbc.b(),  0xbb);
        EXPECT(gbc.c(),  0x74);
        EXPECT(gbc.d(),  0xbb);
        EXPECT(gbc.e(),  0x9c);
        EXPECT(gbc.h(),  0x50);
        EXPECT(gbc.l(),  0x3);
        EXPECT(gbc.sp(), 0x1524);
        EXPECT(gbc.pc(), 0x9534);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9532), 0xcb);
        EXPECT(gbc.readMem(0x9533), 0x4);
        // CB 04 03DC
        gbc.setState(0x4896, 0x19f, 0x5f00, 0x6e72, 0x9ebb, 0x8b0e, 0x1, 0x0);
        gbc.writeMem(0x4896, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x5f);
        EXPECT(gbc.b(),  0x6e);
        EXPECT(gbc.c(),  0x72);
        EXPECT(gbc.d(),  0x9e);
        EXPECT(gbc.e(),  0xbb);
        EXPECT(gbc.h(),  0x17);
        EXPECT(gbc.l(),  0xe);
        EXPECT(gbc.sp(), 0x19f);
        EXPECT(gbc.pc(), 0x4898);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 03DF
        gbc.setState(0x13dd, 0xc8cd, 0x580, 0x7fe6, 0xf36, 0x5774, 0x1, 0x0);
        gbc.writeMem(0x13dd, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x5);
        EXPECT(gbc.b(),  0x7f);
        EXPECT(gbc.c(),  0xe6);
        EXPECT(gbc.d(),  0xf);
        EXPECT(gbc.e(),  0x36);
        EXPECT(gbc.h(),  0xae);
        EXPECT(gbc.l(),  0x74);
        EXPECT(gbc.sp(), 0xc8cd);
        EXPECT(gbc.pc(), 0x13df);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 03E0
        gbc.setState(0xaf2e, 0x213b, 0x360, 0xa9ae, 0xc32e, 0x3bb8, 0x0, 0x1);
        gbc.writeMem(0xaf2e, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x3);
        EXPECT(gbc.b(),  0xa9);
        EXPECT(gbc.c(),  0xae);
        EXPECT(gbc.d(),  0xc3);
        EXPECT(gbc.e(),  0x2e);
        EXPECT(gbc.h(),  0x76);
        EXPECT(gbc.l(),  0xb8);
        EXPECT(gbc.sp(), 0x213b);
        EXPECT(gbc.pc(), 0xaf30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xaf2e), 0xcb);
        EXPECT(gbc.readMem(0xaf2f), 0x4);
        // CB 04 03E1
        gbc.setState(0x146c, 0x7406, 0xe200, 0x1f49, 0xe72b, 0x62f7, 0x1, 0x0);
        gbc.writeMem(0x146c, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xe2);
        EXPECT(gbc.b(),  0x1f);
        EXPECT(gbc.c(),  0x49);
        EXPECT(gbc.d(),  0xe7);
        EXPECT(gbc.e(),  0x2b);
        EXPECT(gbc.h(),  0xc4);
        EXPECT(gbc.l(),  0xf7);
        EXPECT(gbc.sp(), 0x7406);
        EXPECT(gbc.pc(), 0x146e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 03E3
        gbc.setState(0x5e7c, 0x137c, 0x4f00, 0x8241, 0xe5a7, 0x198e, 0x1, 0x1);
        gbc.writeMem(0x5e7c, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x4f);
        EXPECT(gbc.b(),  0x82);
        EXPECT(gbc.c(),  0x41);
        EXPECT(gbc.d(),  0xe5);
        EXPECT(gbc.e(),  0xa7);
        EXPECT(gbc.h(),  0x32);
        EXPECT(gbc.l(),  0x8e);
        EXPECT(gbc.sp(), 0x137c);
        EXPECT(gbc.pc(), 0x5e7e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 03E4
        gbc.setState(0x15fe, 0x76d0, 0x4870, 0xf6cd, 0x2408, 0x531e, 0x1, 0x0);
        gbc.writeMem(0x15fe, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x48);
        EXPECT(gbc.b(),  0xf6);
        EXPECT(gbc.c(),  0xcd);
        EXPECT(gbc.d(),  0x24);
        EXPECT(gbc.e(),  0x8);
        EXPECT(gbc.h(),  0xa6);
        EXPECT(gbc.l(),  0x1e);
        EXPECT(gbc.sp(), 0x76d0);
        EXPECT(gbc.pc(), 0x1600);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // CB 04 03E6
        gbc.setState(0x376a, 0xcc28, 0x9110, 0xe773, 0xa6c9, 0xb3cb, 0x1, 0x1);
        gbc.writeMem(0x376a, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0x91);
        EXPECT(gbc.b(),  0xe7);
        EXPECT(gbc.c(),  0x73);
        EXPECT(gbc.d(),  0xa6);
        EXPECT(gbc.e(),  0xc9);
        EXPECT(gbc.h(),  0x67);
        EXPECT(gbc.l(),  0xcb);
        EXPECT(gbc.sp(), 0xcc28);
        EXPECT(gbc.pc(), 0x376c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // CB 04 03E7
        gbc.setState(0x6d7e, 0x138f, 0xd710, 0x9d3e, 0xa795, 0x4641, 0x1, 0x0);
        gbc.writeMem(0x6d7e, { 0xcb, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xd7);
        EXPECT(gbc.b(),  0x9d);
        EXPECT(gbc.c(),  0x3e);
        EXPECT(gbc.d(),  0xa7);
        EXPECT(gbc.e(),  0x95);
        EXPECT(gbc.h(),  0x8c);
        EXPECT(gbc.l(),  0x41);
        EXPECT(gbc.sp(), 0x138f);
        EXPECT(gbc.pc(), 0x6d80);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
    }
}
#endif
