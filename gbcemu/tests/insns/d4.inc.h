    TEST(gbcemu, opcode_d4) {
        GBCEmu gbc{};
        uint8_t cartridge[0x8000];
        cartridge[0x149] = 0x02; // 8kb external RAM
        gbc.loadCartridge(new FlashGamePak(cartridge));
        // D4 0001
        gbc.setState(0xef3c, 0x8d6a, 0xab30, 0xb0ee, 0x830, 0xf10c, 0x1, 0x0);
        gbc.writeMem(0xef3c, { 0xd4, 0xa5, 0x60 });
        gbc.step();
        EXPECT(gbc.a(),  0xab);
        EXPECT(gbc.b(),  0xb0);
        EXPECT(gbc.c(),  0xee);
        EXPECT(gbc.d(),  0x8);
        EXPECT(gbc.e(),  0x30);
        EXPECT(gbc.h(),  0xf1);
        EXPECT(gbc.l(),  0xc);
        EXPECT(gbc.sp(), 0x8d6a);
        EXPECT(gbc.pc(), 0xef3f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xef3c), 0xd4);
        EXPECT(gbc.readMem(0xef3d), 0xa5);
        EXPECT(gbc.readMem(0xef3e), 0x60);
        // D4 0002
        gbc.setState(0x26ee, 0xb693, 0xb5b0, 0x7006, 0x1708, 0xf58c, 0x1, 0x0);
        gbc.writeMem(0x26ee, { 0xd4, 0x19, 0x3a });
        gbc.step();
        EXPECT(gbc.a(),  0xb5);
        EXPECT(gbc.b(),  0x70);
        EXPECT(gbc.c(),  0x6);
        EXPECT(gbc.d(),  0x17);
        EXPECT(gbc.e(),  0x8);
        EXPECT(gbc.h(),  0xf5);
        EXPECT(gbc.l(),  0x8c);
        EXPECT(gbc.sp(), 0xb693);
        EXPECT(gbc.pc(), 0x26f1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0003
        gbc.setState(0xba6, 0xafd6, 0x20a0, 0x830e, 0xa5c8, 0xde98, 0x1, 0x1);
        gbc.writeMem(0xba6, { 0xd4, 0xe5, 0xd3 });
        gbc.writeMem(0xafd4, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0x83);
        EXPECT(gbc.c(),  0xe);
        EXPECT(gbc.d(),  0xa5);
        EXPECT(gbc.e(),  0xc8);
        EXPECT(gbc.h(),  0xde);
        EXPECT(gbc.l(),  0x98);
        EXPECT(gbc.sp(), 0xafd4);
        EXPECT(gbc.pc(), 0xd3e5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xafd4), 0xa9);
        EXPECT(gbc.readMem(0xafd5), 0xb);
        // D4 0004
        gbc.setState(0x9cca, 0xbd05, 0xd8f0, 0xe83d, 0x965, 0xf2b, 0x0, 0x1);
        gbc.writeMem(0x9cca, { 0xd4, 0x2b, 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xd8);
        EXPECT(gbc.b(),  0xe8);
        EXPECT(gbc.c(),  0x3d);
        EXPECT(gbc.d(),  0x9);
        EXPECT(gbc.e(),  0x65);
        EXPECT(gbc.h(),  0xf);
        EXPECT(gbc.l(),  0x2b);
        EXPECT(gbc.sp(), 0xbd05);
        EXPECT(gbc.pc(), 0x9ccd);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9cca), 0xd4);
        EXPECT(gbc.readMem(0x9ccb), 0x2b);
        EXPECT(gbc.readMem(0x9ccc), 0xf7);
        // D4 0005
        gbc.setState(0xc84d, 0xfb16, 0xbdd0, 0x158a, 0xbb89, 0x73f8, 0x0, 0x1);
        gbc.writeMem(0xc84d, { 0xd4, 0x72, 0x31 });
        gbc.step();
        EXPECT(gbc.a(),  0xbd);
        EXPECT(gbc.b(),  0x15);
        EXPECT(gbc.c(),  0x8a);
        EXPECT(gbc.d(),  0xbb);
        EXPECT(gbc.e(),  0x89);
        EXPECT(gbc.h(),  0x73);
        EXPECT(gbc.l(),  0xf8);
        EXPECT(gbc.sp(), 0xfb16);
        EXPECT(gbc.pc(), 0xc850);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc84d), 0xd4);
        EXPECT(gbc.readMem(0xc84e), 0x72);
        EXPECT(gbc.readMem(0xc84f), 0x31);
        // D4 0008
        gbc.setState(0x9df0, 0xc6f9, 0x7e00, 0x818d, 0x9470, 0x61d4, 0x1, 0x0);
        gbc.writeMem(0x9df0, { 0xd4, 0xaa, 0x8a });
        gbc.writeMem(0xc6f7, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x7e);
        EXPECT(gbc.b(),  0x81);
        EXPECT(gbc.c(),  0x8d);
        EXPECT(gbc.d(),  0x94);
        EXPECT(gbc.e(),  0x70);
        EXPECT(gbc.h(),  0x61);
        EXPECT(gbc.l(),  0xd4);
        EXPECT(gbc.sp(), 0xc6f7);
        EXPECT(gbc.pc(), 0x8aaa);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9df0), 0xd4);
        EXPECT(gbc.readMem(0x9df1), 0xaa);
        EXPECT(gbc.readMem(0x9df2), 0x8a);
        EXPECT(gbc.readMem(0xc6f7), 0xf3);
        EXPECT(gbc.readMem(0xc6f8), 0x9d);
        // D4 0009
        gbc.setState(0x1ecb, 0xd434, 0x54b0, 0x852b, 0x4e45, 0x5a20, 0x1, 0x1);
        gbc.writeMem(0x1ecb, { 0xd4, 0xe9, 0xd });
        gbc.step();
        EXPECT(gbc.a(),  0x54);
        EXPECT(gbc.b(),  0x85);
        EXPECT(gbc.c(),  0x2b);
        EXPECT(gbc.d(),  0x4e);
        EXPECT(gbc.e(),  0x45);
        EXPECT(gbc.h(),  0x5a);
        EXPECT(gbc.l(),  0x20);
        EXPECT(gbc.sp(), 0xd434);
        EXPECT(gbc.pc(), 0x1ece);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 000A
        gbc.setState(0x4376, 0xd263, 0x6860, 0x9473, 0xd1ab, 0x4155, 0x1, 0x0);
        gbc.writeMem(0x4376, { 0xd4, 0x75, 0x6 });
        gbc.writeMem(0xd261, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x68);
        EXPECT(gbc.b(),  0x94);
        EXPECT(gbc.c(),  0x73);
        EXPECT(gbc.d(),  0xd1);
        EXPECT(gbc.e(),  0xab);
        EXPECT(gbc.h(),  0x41);
        EXPECT(gbc.l(),  0x55);
        EXPECT(gbc.sp(), 0xd261);
        EXPECT(gbc.pc(), 0x675);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd261), 0x79);
        EXPECT(gbc.readMem(0xd262), 0x43);
        // D4 000D
        gbc.setState(0x78f4, 0x6cb8, 0x5f50, 0xc73e, 0x90dd, 0x4964, 0x1, 0x0);
        gbc.writeMem(0x78f4, { 0xd4, 0x5, 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x5f);
        EXPECT(gbc.b(),  0xc7);
        EXPECT(gbc.c(),  0x3e);
        EXPECT(gbc.d(),  0x90);
        EXPECT(gbc.e(),  0xdd);
        EXPECT(gbc.h(),  0x49);
        EXPECT(gbc.l(),  0x64);
        EXPECT(gbc.sp(), 0x6cb8);
        EXPECT(gbc.pc(), 0x78f7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 000E
        gbc.setState(0x7614, 0xe411, 0xe6f0, 0xa25f, 0x5042, 0x80bc, 0x0, 0x0);
        gbc.writeMem(0x7614, { 0xd4, 0xd, 0x5a });
        gbc.step();
        EXPECT(gbc.a(),  0xe6);
        EXPECT(gbc.b(),  0xa2);
        EXPECT(gbc.c(),  0x5f);
        EXPECT(gbc.d(),  0x50);
        EXPECT(gbc.e(),  0x42);
        EXPECT(gbc.h(),  0x80);
        EXPECT(gbc.l(),  0xbc);
        EXPECT(gbc.sp(), 0xe411);
        EXPECT(gbc.pc(), 0x7617);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 000F
        gbc.setState(0x4cc8, 0xe4c5, 0xba70, 0x7711, 0x901e, 0x79e4, 0x0, 0x1);
        gbc.writeMem(0x4cc8, { 0xd4, 0x9, 0x29 });
        gbc.step();
        EXPECT(gbc.a(),  0xba);
        EXPECT(gbc.b(),  0x77);
        EXPECT(gbc.c(),  0x11);
        EXPECT(gbc.d(),  0x90);
        EXPECT(gbc.e(),  0x1e);
        EXPECT(gbc.h(),  0x79);
        EXPECT(gbc.l(),  0xe4);
        EXPECT(gbc.sp(), 0xe4c5);
        EXPECT(gbc.pc(), 0x4ccb);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0010
        gbc.setState(0x5d90, 0x2886, 0x9190, 0xc357, 0x9233, 0xedd1, 0x0, 0x1);
        gbc.writeMem(0x5d90, { 0xd4, 0xd0, 0x5c });
        gbc.step();
        EXPECT(gbc.a(),  0x91);
        EXPECT(gbc.b(),  0xc3);
        EXPECT(gbc.c(),  0x57);
        EXPECT(gbc.d(),  0x92);
        EXPECT(gbc.e(),  0x33);
        EXPECT(gbc.h(),  0xed);
        EXPECT(gbc.l(),  0xd1);
        EXPECT(gbc.sp(), 0x2886);
        EXPECT(gbc.pc(), 0x5d93);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0011
        gbc.setState(0xc215, 0x83f2, 0xc560, 0x395d, 0x9564, 0x5490, 0x0, 0x0);
        gbc.writeMem(0x83f0, { 0x0, 0x0 });
        gbc.writeMem(0xc215, { 0xd4, 0x77, 0x8b });
        gbc.step();
        EXPECT(gbc.a(),  0xc5);
        EXPECT(gbc.b(),  0x39);
        EXPECT(gbc.c(),  0x5d);
        EXPECT(gbc.d(),  0x95);
        EXPECT(gbc.e(),  0x64);
        EXPECT(gbc.h(),  0x54);
        EXPECT(gbc.l(),  0x90);
        EXPECT(gbc.sp(), 0x83f0);
        EXPECT(gbc.pc(), 0x8b77);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x83f0), 0x18);
        EXPECT(gbc.readMem(0x83f1), 0xc2);
        EXPECT(gbc.readMem(0xc215), 0xd4);
        EXPECT(gbc.readMem(0xc216), 0x77);
        EXPECT(gbc.readMem(0xc217), 0x8b);
        // D4 0012
        gbc.setState(0x8296, 0x2cd6, 0xa410, 0xefda, 0x55a0, 0xc744, 0x1, 0x1);
        gbc.writeMem(0x8296, { 0xd4, 0x9c, 0x45 });
        gbc.step();
        EXPECT(gbc.a(),  0xa4);
        EXPECT(gbc.b(),  0xef);
        EXPECT(gbc.c(),  0xda);
        EXPECT(gbc.d(),  0x55);
        EXPECT(gbc.e(),  0xa0);
        EXPECT(gbc.h(),  0xc7);
        EXPECT(gbc.l(),  0x44);
        EXPECT(gbc.sp(), 0x2cd6);
        EXPECT(gbc.pc(), 0x8299);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8296), 0xd4);
        EXPECT(gbc.readMem(0x8297), 0x9c);
        EXPECT(gbc.readMem(0x8298), 0x45);
        // D4 0014
        gbc.setState(0x34c1, 0x709, 0xf8b0, 0xdcc0, 0xcdc9, 0xe2cc, 0x0, 0x0);
        gbc.writeMem(0x34c1, { 0xd4, 0x39, 0x3e });
        gbc.step();
        EXPECT(gbc.a(),  0xf8);
        EXPECT(gbc.b(),  0xdc);
        EXPECT(gbc.c(),  0xc0);
        EXPECT(gbc.d(),  0xcd);
        EXPECT(gbc.e(),  0xc9);
        EXPECT(gbc.h(),  0xe2);
        EXPECT(gbc.l(),  0xcc);
        EXPECT(gbc.sp(), 0x709);
        EXPECT(gbc.pc(), 0x34c4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0015
        gbc.setState(0x2326, 0x5836, 0xbdf0, 0xc2eb, 0x97db, 0x26a1, 0x1, 0x0);
        gbc.writeMem(0x2326, { 0xd4, 0x82, 0x2 });
        gbc.step();
        EXPECT(gbc.a(),  0xbd);
        EXPECT(gbc.b(),  0xc2);
        EXPECT(gbc.c(),  0xeb);
        EXPECT(gbc.d(),  0x97);
        EXPECT(gbc.e(),  0xdb);
        EXPECT(gbc.h(),  0x26);
        EXPECT(gbc.l(),  0xa1);
        EXPECT(gbc.sp(), 0x5836);
        EXPECT(gbc.pc(), 0x2329);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0017
        gbc.setState(0x9bf8, 0x25be, 0x5df0, 0x65f6, 0x2353, 0x5a7, 0x0, 0x1);
        gbc.writeMem(0x9bf8, { 0xd4, 0x99, 0x1f });
        gbc.step();
        EXPECT(gbc.a(),  0x5d);
        EXPECT(gbc.b(),  0x65);
        EXPECT(gbc.c(),  0xf6);
        EXPECT(gbc.d(),  0x23);
        EXPECT(gbc.e(),  0x53);
        EXPECT(gbc.h(),  0x5);
        EXPECT(gbc.l(),  0xa7);
        EXPECT(gbc.sp(), 0x25be);
        EXPECT(gbc.pc(), 0x9bfb);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9bf8), 0xd4);
        EXPECT(gbc.readMem(0x9bf9), 0x99);
        EXPECT(gbc.readMem(0x9bfa), 0x1f);
        // D4 0018
        gbc.setState(0x2676, 0xa4a5, 0x5af0, 0xdc20, 0x3c75, 0x2da1, 0x0, 0x0);
        gbc.writeMem(0x2676, { 0xd4, 0x78, 0x8d });
        gbc.step();
        EXPECT(gbc.a(),  0x5a);
        EXPECT(gbc.b(),  0xdc);
        EXPECT(gbc.c(),  0x20);
        EXPECT(gbc.d(),  0x3c);
        EXPECT(gbc.e(),  0x75);
        EXPECT(gbc.h(),  0x2d);
        EXPECT(gbc.l(),  0xa1);
        EXPECT(gbc.sp(), 0xa4a5);
        EXPECT(gbc.pc(), 0x2679);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 001A
        gbc.setState(0xcb8, 0x39b6, 0xe9d0, 0xcc28, 0x7b88, 0xcf36, 0x1, 0x0);
        gbc.writeMem(0xcb8, { 0xd4, 0x44, 0x71 });
        gbc.step();
        EXPECT(gbc.a(),  0xe9);
        EXPECT(gbc.b(),  0xcc);
        EXPECT(gbc.c(),  0x28);
        EXPECT(gbc.d(),  0x7b);
        EXPECT(gbc.e(),  0x88);
        EXPECT(gbc.h(),  0xcf);
        EXPECT(gbc.l(),  0x36);
        EXPECT(gbc.sp(), 0x39b6);
        EXPECT(gbc.pc(), 0xcbb);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 001B
        gbc.setState(0xce7, 0xc66, 0x10, 0xeff8, 0xad53, 0x1733, 0x1, 0x0);
        gbc.writeMem(0xce7, { 0xd4, 0x1a, 0xf });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0xef);
        EXPECT(gbc.c(),  0xf8);
        EXPECT(gbc.d(),  0xad);
        EXPECT(gbc.e(),  0x53);
        EXPECT(gbc.h(),  0x17);
        EXPECT(gbc.l(),  0x33);
        EXPECT(gbc.sp(), 0xc66);
        EXPECT(gbc.pc(), 0xcea);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 001E
        gbc.setState(0x5167, 0x95e4, 0x3850, 0x49e8, 0x11d3, 0xc74c, 0x0, 0x1);
        gbc.writeMem(0x5167, { 0xd4, 0xf8, 0xc9 });
        gbc.step();
        EXPECT(gbc.a(),  0x38);
        EXPECT(gbc.b(),  0x49);
        EXPECT(gbc.c(),  0xe8);
        EXPECT(gbc.d(),  0x11);
        EXPECT(gbc.e(),  0xd3);
        EXPECT(gbc.h(),  0xc7);
        EXPECT(gbc.l(),  0x4c);
        EXPECT(gbc.sp(), 0x95e4);
        EXPECT(gbc.pc(), 0x516a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0020
        gbc.setState(0xb0e4, 0x54c0, 0x65d0, 0x5efc, 0xeb1e, 0xd65d, 0x0, 0x0);
        gbc.writeMem(0xb0e4, { 0xd4, 0x71, 0xe3 });
        gbc.step();
        EXPECT(gbc.a(),  0x65);
        EXPECT(gbc.b(),  0x5e);
        EXPECT(gbc.c(),  0xfc);
        EXPECT(gbc.d(),  0xeb);
        EXPECT(gbc.e(),  0x1e);
        EXPECT(gbc.h(),  0xd6);
        EXPECT(gbc.l(),  0x5d);
        EXPECT(gbc.sp(), 0x54c0);
        EXPECT(gbc.pc(), 0xb0e7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb0e4), 0xd4);
        EXPECT(gbc.readMem(0xb0e5), 0x71);
        EXPECT(gbc.readMem(0xb0e6), 0xe3);
        // D4 0022
        gbc.setState(0xef56, 0x4398, 0xa810, 0x2319, 0xb969, 0x3ae4, 0x0, 0x1);
        gbc.writeMem(0xef56, { 0xd4, 0x9c, 0xe9 });
        gbc.step();
        EXPECT(gbc.a(),  0xa8);
        EXPECT(gbc.b(),  0x23);
        EXPECT(gbc.c(),  0x19);
        EXPECT(gbc.d(),  0xb9);
        EXPECT(gbc.e(),  0x69);
        EXPECT(gbc.h(),  0x3a);
        EXPECT(gbc.l(),  0xe4);
        EXPECT(gbc.sp(), 0x4398);
        EXPECT(gbc.pc(), 0xef59);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xef56), 0xd4);
        EXPECT(gbc.readMem(0xef57), 0x9c);
        EXPECT(gbc.readMem(0xef58), 0xe9);
        // D4 0024
        gbc.setState(0x409e, 0x373, 0xd3f0, 0x9e7a, 0x9d66, 0xf847, 0x0, 0x0);
        gbc.writeMem(0x409e, { 0xd4, 0x36, 0xed });
        gbc.step();
        EXPECT(gbc.a(),  0xd3);
        EXPECT(gbc.b(),  0x9e);
        EXPECT(gbc.c(),  0x7a);
        EXPECT(gbc.d(),  0x9d);
        EXPECT(gbc.e(),  0x66);
        EXPECT(gbc.h(),  0xf8);
        EXPECT(gbc.l(),  0x47);
        EXPECT(gbc.sp(), 0x373);
        EXPECT(gbc.pc(), 0x40a1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0025
        gbc.setState(0x3ae0, 0x742a, 0xd130, 0xba85, 0x9e46, 0x7120, 0x1, 0x1);
        gbc.writeMem(0x3ae0, { 0xd4, 0xfe, 0x7 });
        gbc.step();
        EXPECT(gbc.a(),  0xd1);
        EXPECT(gbc.b(),  0xba);
        EXPECT(gbc.c(),  0x85);
        EXPECT(gbc.d(),  0x9e);
        EXPECT(gbc.e(),  0x46);
        EXPECT(gbc.h(),  0x71);
        EXPECT(gbc.l(),  0x20);
        EXPECT(gbc.sp(), 0x742a);
        EXPECT(gbc.pc(), 0x3ae3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0026
        gbc.setState(0x88a7, 0xf1cf, 0x3aa0, 0x3a66, 0x478d, 0x7ca9, 0x1, 0x1);
        gbc.writeMem(0x88a7, { 0xd4, 0xe0, 0xa5 });
        gbc.writeMem(0xf1cd, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x3a);
        EXPECT(gbc.b(),  0x3a);
        EXPECT(gbc.c(),  0x66);
        EXPECT(gbc.d(),  0x47);
        EXPECT(gbc.e(),  0x8d);
        EXPECT(gbc.h(),  0x7c);
        EXPECT(gbc.l(),  0xa9);
        EXPECT(gbc.sp(), 0xf1cd);
        EXPECT(gbc.pc(), 0xa5e0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x88a7), 0xd4);
        EXPECT(gbc.readMem(0x88a8), 0xe0);
        EXPECT(gbc.readMem(0x88a9), 0xa5);
        EXPECT(gbc.readMem(0xf1cd), 0xaa);
        EXPECT(gbc.readMem(0xf1ce), 0x88);
        // D4 0027
        gbc.setState(0x1cea, 0x9a9d, 0x5f40, 0xa341, 0x954e, 0xff73, 0x0, 0x1);
        gbc.writeMem(0x1cea, { 0xd4, 0x5d, 0xe5 });
        gbc.writeMem(0x9a9b, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x5f);
        EXPECT(gbc.b(),  0xa3);
        EXPECT(gbc.c(),  0x41);
        EXPECT(gbc.d(),  0x95);
        EXPECT(gbc.e(),  0x4e);
        EXPECT(gbc.h(),  0xff);
        EXPECT(gbc.l(),  0x73);
        EXPECT(gbc.sp(), 0x9a9b);
        EXPECT(gbc.pc(), 0xe55d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9a9b), 0xed);
        EXPECT(gbc.readMem(0x9a9c), 0x1c);
        // D4 0028
        gbc.setState(0x1eb2, 0xfa7f, 0xdb10, 0x840c, 0x4298, 0xc777, 0x0, 0x0);
        gbc.writeMem(0x1eb2, { 0xd4, 0x99, 0xc4 });
        gbc.step();
        EXPECT(gbc.a(),  0xdb);
        EXPECT(gbc.b(),  0x84);
        EXPECT(gbc.c(),  0xc);
        EXPECT(gbc.d(),  0x42);
        EXPECT(gbc.e(),  0x98);
        EXPECT(gbc.h(),  0xc7);
        EXPECT(gbc.l(),  0x77);
        EXPECT(gbc.sp(), 0xfa7f);
        EXPECT(gbc.pc(), 0x1eb5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0029
        gbc.setState(0x455e, 0xb8e7, 0xd600, 0x35e2, 0xad12, 0x5345, 0x0, 0x1);
        gbc.writeMem(0x455e, { 0xd4, 0xab, 0x9a });
        gbc.writeMem(0xb8e5, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xd6);
        EXPECT(gbc.b(),  0x35);
        EXPECT(gbc.c(),  0xe2);
        EXPECT(gbc.d(),  0xad);
        EXPECT(gbc.e(),  0x12);
        EXPECT(gbc.h(),  0x53);
        EXPECT(gbc.l(),  0x45);
        EXPECT(gbc.sp(), 0xb8e5);
        EXPECT(gbc.pc(), 0x9aab);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb8e5), 0x61);
        EXPECT(gbc.readMem(0xb8e6), 0x45);
        // D4 002A
        gbc.setState(0x9ae8, 0x8768, 0xef0, 0xfba4, 0x48c8, 0xa605, 0x1, 0x1);
        gbc.writeMem(0x9ae8, { 0xd4, 0xd9, 0x13 });
        gbc.step();
        EXPECT(gbc.a(),  0xe);
        EXPECT(gbc.b(),  0xfb);
        EXPECT(gbc.c(),  0xa4);
        EXPECT(gbc.d(),  0x48);
        EXPECT(gbc.e(),  0xc8);
        EXPECT(gbc.h(),  0xa6);
        EXPECT(gbc.l(),  0x5);
        EXPECT(gbc.sp(), 0x8768);
        EXPECT(gbc.pc(), 0x9aeb);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9ae8), 0xd4);
        EXPECT(gbc.readMem(0x9ae9), 0xd9);
        EXPECT(gbc.readMem(0x9aea), 0x13);
        // D4 002B
        gbc.setState(0xda93, 0xd337, 0x100, 0x5112, 0x720c, 0x2146, 0x1, 0x1);
        gbc.writeMem(0xd335, { 0x0, 0x0 });
        gbc.writeMem(0xda93, { 0xd4, 0x33, 0x4b });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0x51);
        EXPECT(gbc.c(),  0x12);
        EXPECT(gbc.d(),  0x72);
        EXPECT(gbc.e(),  0xc);
        EXPECT(gbc.h(),  0x21);
        EXPECT(gbc.l(),  0x46);
        EXPECT(gbc.sp(), 0xd335);
        EXPECT(gbc.pc(), 0x4b33);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd335), 0x96);
        EXPECT(gbc.readMem(0xd336), 0xda);
        EXPECT(gbc.readMem(0xda93), 0xd4);
        EXPECT(gbc.readMem(0xda94), 0x33);
        EXPECT(gbc.readMem(0xda95), 0x4b);
        // D4 002D
        gbc.setState(0xde2a, 0x684f, 0xae90, 0x6159, 0x4c9a, 0x96f7, 0x0, 0x1);
        gbc.writeMem(0xde2a, { 0xd4, 0x58, 0xc5 });
        gbc.step();
        EXPECT(gbc.a(),  0xae);
        EXPECT(gbc.b(),  0x61);
        EXPECT(gbc.c(),  0x59);
        EXPECT(gbc.d(),  0x4c);
        EXPECT(gbc.e(),  0x9a);
        EXPECT(gbc.h(),  0x96);
        EXPECT(gbc.l(),  0xf7);
        EXPECT(gbc.sp(), 0x684f);
        EXPECT(gbc.pc(), 0xde2d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xde2a), 0xd4);
        EXPECT(gbc.readMem(0xde2b), 0x58);
        EXPECT(gbc.readMem(0xde2c), 0xc5);
        // D4 002E
        gbc.setState(0xcae4, 0xc57, 0x3930, 0xdd08, 0x60df, 0x77cc, 0x1, 0x0);
        gbc.writeMem(0xcae4, { 0xd4, 0xb6, 0xd3 });
        gbc.step();
        EXPECT(gbc.a(),  0x39);
        EXPECT(gbc.b(),  0xdd);
        EXPECT(gbc.c(),  0x8);
        EXPECT(gbc.d(),  0x60);
        EXPECT(gbc.e(),  0xdf);
        EXPECT(gbc.h(),  0x77);
        EXPECT(gbc.l(),  0xcc);
        EXPECT(gbc.sp(), 0xc57);
        EXPECT(gbc.pc(), 0xcae7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcae4), 0xd4);
        EXPECT(gbc.readMem(0xcae5), 0xb6);
        EXPECT(gbc.readMem(0xcae6), 0xd3);
        // D4 002F
        gbc.setState(0xa349, 0x82f9, 0x5bf0, 0xa90b, 0x1ad9, 0xbac2, 0x1, 0x0);
        gbc.writeMem(0xa349, { 0xd4, 0xff, 0x42 });
        gbc.step();
        EXPECT(gbc.a(),  0x5b);
        EXPECT(gbc.b(),  0xa9);
        EXPECT(gbc.c(),  0xb);
        EXPECT(gbc.d(),  0x1a);
        EXPECT(gbc.e(),  0xd9);
        EXPECT(gbc.h(),  0xba);
        EXPECT(gbc.l(),  0xc2);
        EXPECT(gbc.sp(), 0x82f9);
        EXPECT(gbc.pc(), 0xa34c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa349), 0xd4);
        EXPECT(gbc.readMem(0xa34a), 0xff);
        EXPECT(gbc.readMem(0xa34b), 0x42);
        // D4 0030
        gbc.setState(0x39e5, 0x4b1b, 0x8c50, 0x5dcc, 0x34b8, 0x5d21, 0x0, 0x0);
        gbc.writeMem(0x39e5, { 0xd4, 0xd8, 0x76 });
        gbc.step();
        EXPECT(gbc.a(),  0x8c);
        EXPECT(gbc.b(),  0x5d);
        EXPECT(gbc.c(),  0xcc);
        EXPECT(gbc.d(),  0x34);
        EXPECT(gbc.e(),  0xb8);
        EXPECT(gbc.h(),  0x5d);
        EXPECT(gbc.l(),  0x21);
        EXPECT(gbc.sp(), 0x4b1b);
        EXPECT(gbc.pc(), 0x39e8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0031
        gbc.setState(0xa550, 0x2973, 0x1c50, 0xf98f, 0xe7d7, 0x6575, 0x1, 0x0);
        gbc.writeMem(0xa550, { 0xd4, 0x15, 0xbb });
        gbc.step();
        EXPECT(gbc.a(),  0x1c);
        EXPECT(gbc.b(),  0xf9);
        EXPECT(gbc.c(),  0x8f);
        EXPECT(gbc.d(),  0xe7);
        EXPECT(gbc.e(),  0xd7);
        EXPECT(gbc.h(),  0x65);
        EXPECT(gbc.l(),  0x75);
        EXPECT(gbc.sp(), 0x2973);
        EXPECT(gbc.pc(), 0xa553);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa550), 0xd4);
        EXPECT(gbc.readMem(0xa551), 0x15);
        EXPECT(gbc.readMem(0xa552), 0xbb);
        // D4 0032
        gbc.setState(0x823d, 0x7b90, 0x2f50, 0x995c, 0xf829, 0xf265, 0x1, 0x1);
        gbc.writeMem(0x823d, { 0xd4, 0x0, 0x39 });
        gbc.step();
        EXPECT(gbc.a(),  0x2f);
        EXPECT(gbc.b(),  0x99);
        EXPECT(gbc.c(),  0x5c);
        EXPECT(gbc.d(),  0xf8);
        EXPECT(gbc.e(),  0x29);
        EXPECT(gbc.h(),  0xf2);
        EXPECT(gbc.l(),  0x65);
        EXPECT(gbc.sp(), 0x7b90);
        EXPECT(gbc.pc(), 0x8240);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x823d), 0xd4);
        EXPECT(gbc.readMem(0x823e), 0x0);
        EXPECT(gbc.readMem(0x823f), 0x39);
        // D4 0034
        gbc.setState(0xedb3, 0x496a, 0x5df0, 0xc371, 0x6c5c, 0xe7cd, 0x0, 0x1);
        gbc.writeMem(0xedb3, { 0xd4, 0x61, 0x3b });
        gbc.step();
        EXPECT(gbc.a(),  0x5d);
        EXPECT(gbc.b(),  0xc3);
        EXPECT(gbc.c(),  0x71);
        EXPECT(gbc.d(),  0x6c);
        EXPECT(gbc.e(),  0x5c);
        EXPECT(gbc.h(),  0xe7);
        EXPECT(gbc.l(),  0xcd);
        EXPECT(gbc.sp(), 0x496a);
        EXPECT(gbc.pc(), 0xedb6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xedb3), 0xd4);
        EXPECT(gbc.readMem(0xedb4), 0x61);
        EXPECT(gbc.readMem(0xedb5), 0x3b);
        // D4 0037
        gbc.setState(0x8d86, 0xadfc, 0x9140, 0xf61b, 0x95aa, 0x6164, 0x0, 0x1);
        gbc.writeMem(0x8d86, { 0xd4, 0xdc, 0xb4 });
        gbc.writeMem(0xadfa, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x91);
        EXPECT(gbc.b(),  0xf6);
        EXPECT(gbc.c(),  0x1b);
        EXPECT(gbc.d(),  0x95);
        EXPECT(gbc.e(),  0xaa);
        EXPECT(gbc.h(),  0x61);
        EXPECT(gbc.l(),  0x64);
        EXPECT(gbc.sp(), 0xadfa);
        EXPECT(gbc.pc(), 0xb4dc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8d86), 0xd4);
        EXPECT(gbc.readMem(0x8d87), 0xdc);
        EXPECT(gbc.readMem(0x8d88), 0xb4);
        EXPECT(gbc.readMem(0xadfa), 0x89);
        EXPECT(gbc.readMem(0xadfb), 0x8d);
        // D4 003A
        gbc.setState(0x6e2b, 0x7e8, 0x6990, 0x427e, 0x50c9, 0xb164, 0x1, 0x1);
        gbc.writeMem(0x6e2b, { 0xd4, 0xe0, 0x3a });
        gbc.step();
        EXPECT(gbc.a(),  0x69);
        EXPECT(gbc.b(),  0x42);
        EXPECT(gbc.c(),  0x7e);
        EXPECT(gbc.d(),  0x50);
        EXPECT(gbc.e(),  0xc9);
        EXPECT(gbc.h(),  0xb1);
        EXPECT(gbc.l(),  0x64);
        EXPECT(gbc.sp(), 0x7e8);
        EXPECT(gbc.pc(), 0x6e2e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 003B
        gbc.setState(0xcd68, 0x938a, 0x7e40, 0xaad3, 0x22fe, 0xe288, 0x1, 0x0);
        gbc.writeMem(0x9388, { 0x0, 0x0 });
        gbc.writeMem(0xcd68, { 0xd4, 0x6b, 0x88 });
        gbc.step();
        EXPECT(gbc.a(),  0x7e);
        EXPECT(gbc.b(),  0xaa);
        EXPECT(gbc.c(),  0xd3);
        EXPECT(gbc.d(),  0x22);
        EXPECT(gbc.e(),  0xfe);
        EXPECT(gbc.h(),  0xe2);
        EXPECT(gbc.l(),  0x88);
        EXPECT(gbc.sp(), 0x9388);
        EXPECT(gbc.pc(), 0x886b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9388), 0x6b);
        EXPECT(gbc.readMem(0x9389), 0xcd);
        EXPECT(gbc.readMem(0xcd68), 0xd4);
        EXPECT(gbc.readMem(0xcd69), 0x6b);
        EXPECT(gbc.readMem(0xcd6a), 0x88);
        // D4 003C
        gbc.setState(0x70ac, 0xb6ac, 0xa160, 0xffac, 0xe701, 0x2d29, 0x0, 0x0);
        gbc.writeMem(0x70ac, { 0xd4, 0xa0, 0x16 });
        gbc.writeMem(0xb6aa, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xa1);
        EXPECT(gbc.b(),  0xff);
        EXPECT(gbc.c(),  0xac);
        EXPECT(gbc.d(),  0xe7);
        EXPECT(gbc.e(),  0x1);
        EXPECT(gbc.h(),  0x2d);
        EXPECT(gbc.l(),  0x29);
        EXPECT(gbc.sp(), 0xb6aa);
        EXPECT(gbc.pc(), 0x16a0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb6aa), 0xaf);
        EXPECT(gbc.readMem(0xb6ab), 0x70);
        // D4 003D
        gbc.setState(0x63dd, 0xd898, 0xb5d0, 0x9971, 0xcbb, 0xbfc2, 0x1, 0x1);
        gbc.writeMem(0x63dd, { 0xd4, 0xa7, 0x93 });
        gbc.step();
        EXPECT(gbc.a(),  0xb5);
        EXPECT(gbc.b(),  0x99);
        EXPECT(gbc.c(),  0x71);
        EXPECT(gbc.d(),  0xc);
        EXPECT(gbc.e(),  0xbb);
        EXPECT(gbc.h(),  0xbf);
        EXPECT(gbc.l(),  0xc2);
        EXPECT(gbc.sp(), 0xd898);
        EXPECT(gbc.pc(), 0x63e0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 003E
        gbc.setState(0xe207, 0xad61, 0x81a0, 0xc651, 0x115b, 0xa679, 0x1, 0x0);
        gbc.writeMem(0xad5f, { 0x0, 0x0 });
        gbc.writeMem(0xe207, { 0xd4, 0x8f, 0x37 });
        gbc.step();
        EXPECT(gbc.a(),  0x81);
        EXPECT(gbc.b(),  0xc6);
        EXPECT(gbc.c(),  0x51);
        EXPECT(gbc.d(),  0x11);
        EXPECT(gbc.e(),  0x5b);
        EXPECT(gbc.h(),  0xa6);
        EXPECT(gbc.l(),  0x79);
        EXPECT(gbc.sp(), 0xad5f);
        EXPECT(gbc.pc(), 0x378f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xad5f), 0xa);
        EXPECT(gbc.readMem(0xad60), 0xe2);
        EXPECT(gbc.readMem(0xe207), 0xd4);
        EXPECT(gbc.readMem(0xe208), 0x8f);
        EXPECT(gbc.readMem(0xe209), 0x37);
        // D4 0040
        gbc.setState(0x7f1e, 0xf668, 0xf3d0, 0x8ec7, 0x4b9f, 0x415a, 0x0, 0x1);
        gbc.writeMem(0x7f1e, { 0xd4, 0xbf, 0x32 });
        gbc.step();
        EXPECT(gbc.a(),  0xf3);
        EXPECT(gbc.b(),  0x8e);
        EXPECT(gbc.c(),  0xc7);
        EXPECT(gbc.d(),  0x4b);
        EXPECT(gbc.e(),  0x9f);
        EXPECT(gbc.h(),  0x41);
        EXPECT(gbc.l(),  0x5a);
        EXPECT(gbc.sp(), 0xf668);
        EXPECT(gbc.pc(), 0x7f21);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0041
        gbc.setState(0xb5cf, 0xdb82, 0xb9d0, 0xdbe8, 0x9315, 0x64fc, 0x0, 0x1);
        gbc.writeMem(0xb5cf, { 0xd4, 0xe6, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xb9);
        EXPECT(gbc.b(),  0xdb);
        EXPECT(gbc.c(),  0xe8);
        EXPECT(gbc.d(),  0x93);
        EXPECT(gbc.e(),  0x15);
        EXPECT(gbc.h(),  0x64);
        EXPECT(gbc.l(),  0xfc);
        EXPECT(gbc.sp(), 0xdb82);
        EXPECT(gbc.pc(), 0xb5d2);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb5cf), 0xd4);
        EXPECT(gbc.readMem(0xb5d0), 0xe6);
        EXPECT(gbc.readMem(0xb5d1), 0x0);
        // D4 0042
        gbc.setState(0xc9ca, 0xa247, 0xd530, 0xabbf, 0x4d2e, 0x122e, 0x0, 0x1);
        gbc.writeMem(0xc9ca, { 0xd4, 0xa5, 0xce });
        gbc.step();
        EXPECT(gbc.a(),  0xd5);
        EXPECT(gbc.b(),  0xab);
        EXPECT(gbc.c(),  0xbf);
        EXPECT(gbc.d(),  0x4d);
        EXPECT(gbc.e(),  0x2e);
        EXPECT(gbc.h(),  0x12);
        EXPECT(gbc.l(),  0x2e);
        EXPECT(gbc.sp(), 0xa247);
        EXPECT(gbc.pc(), 0xc9cd);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc9ca), 0xd4);
        EXPECT(gbc.readMem(0xc9cb), 0xa5);
        EXPECT(gbc.readMem(0xc9cc), 0xce);
        // D4 0044
        gbc.setState(0x7449, 0x3493, 0xfaf0, 0x3a4f, 0x8a9, 0xdeac, 0x0, 0x1);
        gbc.writeMem(0x7449, { 0xd4, 0x58, 0x77 });
        gbc.step();
        EXPECT(gbc.a(),  0xfa);
        EXPECT(gbc.b(),  0x3a);
        EXPECT(gbc.c(),  0x4f);
        EXPECT(gbc.d(),  0x8);
        EXPECT(gbc.e(),  0xa9);
        EXPECT(gbc.h(),  0xde);
        EXPECT(gbc.l(),  0xac);
        EXPECT(gbc.sp(), 0x3493);
        EXPECT(gbc.pc(), 0x744c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0045
        gbc.setState(0xa092, 0x9a79, 0x8ab0, 0x6fe0, 0xc2e4, 0x9140, 0x1, 0x1);
        gbc.writeMem(0xa092, { 0xd4, 0x1, 0x29 });
        gbc.step();
        EXPECT(gbc.a(),  0x8a);
        EXPECT(gbc.b(),  0x6f);
        EXPECT(gbc.c(),  0xe0);
        EXPECT(gbc.d(),  0xc2);
        EXPECT(gbc.e(),  0xe4);
        EXPECT(gbc.h(),  0x91);
        EXPECT(gbc.l(),  0x40);
        EXPECT(gbc.sp(), 0x9a79);
        EXPECT(gbc.pc(), 0xa095);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa092), 0xd4);
        EXPECT(gbc.readMem(0xa093), 0x1);
        EXPECT(gbc.readMem(0xa094), 0x29);
        // D4 0046
        gbc.setState(0x8b9f, 0x5228, 0x2870, 0xe755, 0xb031, 0xbb94, 0x1, 0x0);
        gbc.writeMem(0x8b9f, { 0xd4, 0x4b, 0xc0 });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0xe7);
        EXPECT(gbc.c(),  0x55);
        EXPECT(gbc.d(),  0xb0);
        EXPECT(gbc.e(),  0x31);
        EXPECT(gbc.h(),  0xbb);
        EXPECT(gbc.l(),  0x94);
        EXPECT(gbc.sp(), 0x5228);
        EXPECT(gbc.pc(), 0x8ba2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8b9f), 0xd4);
        EXPECT(gbc.readMem(0x8ba0), 0x4b);
        EXPECT(gbc.readMem(0x8ba1), 0xc0);
        // D4 0048
        gbc.setState(0xb77e, 0x941c, 0xc3b0, 0x766c, 0x7420, 0x5a59, 0x0, 0x0);
        gbc.writeMem(0xb77e, { 0xd4, 0xb5, 0x93 });
        gbc.step();
        EXPECT(gbc.a(),  0xc3);
        EXPECT(gbc.b(),  0x76);
        EXPECT(gbc.c(),  0x6c);
        EXPECT(gbc.d(),  0x74);
        EXPECT(gbc.e(),  0x20);
        EXPECT(gbc.h(),  0x5a);
        EXPECT(gbc.l(),  0x59);
        EXPECT(gbc.sp(), 0x941c);
        EXPECT(gbc.pc(), 0xb781);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb77e), 0xd4);
        EXPECT(gbc.readMem(0xb77f), 0xb5);
        EXPECT(gbc.readMem(0xb780), 0x93);
        // D4 0049
        gbc.setState(0x198e, 0xe24a, 0xf0c0, 0xf669, 0xde74, 0x2acb, 0x0, 0x0);
        gbc.writeMem(0x198e, { 0xd4, 0xce, 0x78 });
        gbc.writeMem(0xe248, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xf0);
        EXPECT(gbc.b(),  0xf6);
        EXPECT(gbc.c(),  0x69);
        EXPECT(gbc.d(),  0xde);
        EXPECT(gbc.e(),  0x74);
        EXPECT(gbc.h(),  0x2a);
        EXPECT(gbc.l(),  0xcb);
        EXPECT(gbc.sp(), 0xe248);
        EXPECT(gbc.pc(), 0x78ce);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe248), 0x91);
        EXPECT(gbc.readMem(0xe249), 0x19);
        // D4 004A
        gbc.setState(0xa12, 0x7ef5, 0xc0d0, 0x2a56, 0xcfc, 0xaa09, 0x0, 0x0);
        gbc.writeMem(0xa12, { 0xd4, 0xbf, 0x9a });
        gbc.step();
        EXPECT(gbc.a(),  0xc0);
        EXPECT(gbc.b(),  0x2a);
        EXPECT(gbc.c(),  0x56);
        EXPECT(gbc.d(),  0xc);
        EXPECT(gbc.e(),  0xfc);
        EXPECT(gbc.h(),  0xaa);
        EXPECT(gbc.l(),  0x9);
        EXPECT(gbc.sp(), 0x7ef5);
        EXPECT(gbc.pc(), 0xa15);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 004B
        gbc.setState(0x518f, 0x7283, 0x3570, 0x13e2, 0x9fd4, 0x50cb, 0x0, 0x1);
        gbc.writeMem(0x518f, { 0xd4, 0xf6, 0xaa });
        gbc.step();
        EXPECT(gbc.a(),  0x35);
        EXPECT(gbc.b(),  0x13);
        EXPECT(gbc.c(),  0xe2);
        EXPECT(gbc.d(),  0x9f);
        EXPECT(gbc.e(),  0xd4);
        EXPECT(gbc.h(),  0x50);
        EXPECT(gbc.l(),  0xcb);
        EXPECT(gbc.sp(), 0x7283);
        EXPECT(gbc.pc(), 0x5192);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 004C
        gbc.setState(0x743f, 0x2bb2, 0x4310, 0x2e73, 0x5657, 0x1778, 0x0, 0x1);
        gbc.writeMem(0x743f, { 0xd4, 0xb7, 0x31 });
        gbc.step();
        EXPECT(gbc.a(),  0x43);
        EXPECT(gbc.b(),  0x2e);
        EXPECT(gbc.c(),  0x73);
        EXPECT(gbc.d(),  0x56);
        EXPECT(gbc.e(),  0x57);
        EXPECT(gbc.h(),  0x17);
        EXPECT(gbc.l(),  0x78);
        EXPECT(gbc.sp(), 0x2bb2);
        EXPECT(gbc.pc(), 0x7442);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 004F
        gbc.setState(0xa784, 0x6169, 0x5f30, 0xf0e, 0x62ee, 0x7e2a, 0x1, 0x0);
        gbc.writeMem(0xa784, { 0xd4, 0x83, 0x23 });
        gbc.step();
        EXPECT(gbc.a(),  0x5f);
        EXPECT(gbc.b(),  0xf);
        EXPECT(gbc.c(),  0xe);
        EXPECT(gbc.d(),  0x62);
        EXPECT(gbc.e(),  0xee);
        EXPECT(gbc.h(),  0x7e);
        EXPECT(gbc.l(),  0x2a);
        EXPECT(gbc.sp(), 0x6169);
        EXPECT(gbc.pc(), 0xa787);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa784), 0xd4);
        EXPECT(gbc.readMem(0xa785), 0x83);
        EXPECT(gbc.readMem(0xa786), 0x23);
        // D4 0050
        gbc.setState(0x7b4c, 0x1ef8, 0x3450, 0x75, 0x41b0, 0x91f6, 0x1, 0x0);
        gbc.writeMem(0x7b4c, { 0xd4, 0x58, 0xc9 });
        gbc.step();
        EXPECT(gbc.a(),  0x34);
        EXPECT(gbc.b(),  0x0);
        EXPECT(gbc.c(),  0x75);
        EXPECT(gbc.d(),  0x41);
        EXPECT(gbc.e(),  0xb0);
        EXPECT(gbc.h(),  0x91);
        EXPECT(gbc.l(),  0xf6);
        EXPECT(gbc.sp(), 0x1ef8);
        EXPECT(gbc.pc(), 0x7b4f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0051
        gbc.setState(0x3792, 0x33e5, 0x3190, 0x612d, 0x83d7, 0x1c82, 0x1, 0x0);
        gbc.writeMem(0x3792, { 0xd4, 0xeb, 0x38 });
        gbc.step();
        EXPECT(gbc.a(),  0x31);
        EXPECT(gbc.b(),  0x61);
        EXPECT(gbc.c(),  0x2d);
        EXPECT(gbc.d(),  0x83);
        EXPECT(gbc.e(),  0xd7);
        EXPECT(gbc.h(),  0x1c);
        EXPECT(gbc.l(),  0x82);
        EXPECT(gbc.sp(), 0x33e5);
        EXPECT(gbc.pc(), 0x3795);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0053
        gbc.setState(0x1669, 0xa976, 0x6d20, 0xc37, 0xc299, 0x4088, 0x0, 0x0);
        gbc.writeMem(0x1669, { 0xd4, 0x1e, 0x38 });
        gbc.writeMem(0xa974, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x6d);
        EXPECT(gbc.b(),  0xc);
        EXPECT(gbc.c(),  0x37);
        EXPECT(gbc.d(),  0xc2);
        EXPECT(gbc.e(),  0x99);
        EXPECT(gbc.h(),  0x40);
        EXPECT(gbc.l(),  0x88);
        EXPECT(gbc.sp(), 0xa974);
        EXPECT(gbc.pc(), 0x381e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa974), 0x6c);
        EXPECT(gbc.readMem(0xa975), 0x16);
        // D4 0054
        gbc.setState(0xa0c5, 0xb0c2, 0x9300, 0x3fc4, 0xa23f, 0x3757, 0x0, 0x1);
        gbc.writeMem(0xa0c5, { 0xd4, 0x6f, 0x8d });
        gbc.writeMem(0xb0c0, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x93);
        EXPECT(gbc.b(),  0x3f);
        EXPECT(gbc.c(),  0xc4);
        EXPECT(gbc.d(),  0xa2);
        EXPECT(gbc.e(),  0x3f);
        EXPECT(gbc.h(),  0x37);
        EXPECT(gbc.l(),  0x57);
        EXPECT(gbc.sp(), 0xb0c0);
        EXPECT(gbc.pc(), 0x8d6f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa0c5), 0xd4);
        EXPECT(gbc.readMem(0xa0c6), 0x6f);
        EXPECT(gbc.readMem(0xa0c7), 0x8d);
        EXPECT(gbc.readMem(0xb0c0), 0xc8);
        EXPECT(gbc.readMem(0xb0c1), 0xa0);
        // D4 0055
        gbc.setState(0x48b5, 0xe1e5, 0x1c40, 0x29a1, 0x8f33, 0x19f2, 0x1, 0x0);
        gbc.writeMem(0x48b5, { 0xd4, 0x1b, 0x0 });
        gbc.writeMem(0xe1e3, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x1c);
        EXPECT(gbc.b(),  0x29);
        EXPECT(gbc.c(),  0xa1);
        EXPECT(gbc.d(),  0x8f);
        EXPECT(gbc.e(),  0x33);
        EXPECT(gbc.h(),  0x19);
        EXPECT(gbc.l(),  0xf2);
        EXPECT(gbc.sp(), 0xe1e3);
        EXPECT(gbc.pc(), 0x1b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe1e3), 0xb8);
        EXPECT(gbc.readMem(0xe1e4), 0x48);
        // D4 0056
        gbc.setState(0x8cfc, 0x4d05, 0xbfb0, 0x8a2c, 0x962f, 0xea8f, 0x1, 0x1);
        gbc.writeMem(0x8cfc, { 0xd4, 0xdd, 0x31 });
        gbc.step();
        EXPECT(gbc.a(),  0xbf);
        EXPECT(gbc.b(),  0x8a);
        EXPECT(gbc.c(),  0x2c);
        EXPECT(gbc.d(),  0x96);
        EXPECT(gbc.e(),  0x2f);
        EXPECT(gbc.h(),  0xea);
        EXPECT(gbc.l(),  0x8f);
        EXPECT(gbc.sp(), 0x4d05);
        EXPECT(gbc.pc(), 0x8cff);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8cfc), 0xd4);
        EXPECT(gbc.readMem(0x8cfd), 0xdd);
        EXPECT(gbc.readMem(0x8cfe), 0x31);
        // D4 0058
        gbc.setState(0x6a97, 0xbe3c, 0x4750, 0x5679, 0x9fd9, 0xb15f, 0x0, 0x0);
        gbc.writeMem(0x6a97, { 0xd4, 0x66, 0x48 });
        gbc.step();
        EXPECT(gbc.a(),  0x47);
        EXPECT(gbc.b(),  0x56);
        EXPECT(gbc.c(),  0x79);
        EXPECT(gbc.d(),  0x9f);
        EXPECT(gbc.e(),  0xd9);
        EXPECT(gbc.h(),  0xb1);
        EXPECT(gbc.l(),  0x5f);
        EXPECT(gbc.sp(), 0xbe3c);
        EXPECT(gbc.pc(), 0x6a9a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 005B
        gbc.setState(0x81a6, 0xede0, 0x2520, 0xed57, 0x7bb4, 0x9210, 0x1, 0x1);
        gbc.writeMem(0x81a6, { 0xd4, 0xe9, 0xfd });
        gbc.writeMem(0xedde, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x25);
        EXPECT(gbc.b(),  0xed);
        EXPECT(gbc.c(),  0x57);
        EXPECT(gbc.d(),  0x7b);
        EXPECT(gbc.e(),  0xb4);
        EXPECT(gbc.h(),  0x92);
        EXPECT(gbc.l(),  0x10);
        EXPECT(gbc.sp(), 0xedde);
        EXPECT(gbc.pc(), 0xfde9);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x81a6), 0xd4);
        EXPECT(gbc.readMem(0x81a7), 0xe9);
        EXPECT(gbc.readMem(0x81a8), 0xfd);
        EXPECT(gbc.readMem(0xedde), 0xa9);
        EXPECT(gbc.readMem(0xeddf), 0x81);
        // D4 005C
        gbc.setState(0x46e4, 0x752d, 0xbdd0, 0x6f94, 0xaeda, 0x84e2, 0x1, 0x1);
        gbc.writeMem(0x46e4, { 0xd4, 0x4e, 0x3b });
        gbc.step();
        EXPECT(gbc.a(),  0xbd);
        EXPECT(gbc.b(),  0x6f);
        EXPECT(gbc.c(),  0x94);
        EXPECT(gbc.d(),  0xae);
        EXPECT(gbc.e(),  0xda);
        EXPECT(gbc.h(),  0x84);
        EXPECT(gbc.l(),  0xe2);
        EXPECT(gbc.sp(), 0x752d);
        EXPECT(gbc.pc(), 0x46e7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 005D
        gbc.setState(0x279c, 0x9206, 0xeb00, 0x8c54, 0x6cc, 0xe2ae, 0x1, 0x0);
        gbc.writeMem(0x279c, { 0xd4, 0xef, 0xb4 });
        gbc.writeMem(0x9204, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xeb);
        EXPECT(gbc.b(),  0x8c);
        EXPECT(gbc.c(),  0x54);
        EXPECT(gbc.d(),  0x6);
        EXPECT(gbc.e(),  0xcc);
        EXPECT(gbc.h(),  0xe2);
        EXPECT(gbc.l(),  0xae);
        EXPECT(gbc.sp(), 0x9204);
        EXPECT(gbc.pc(), 0xb4ef);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9204), 0x9f);
        EXPECT(gbc.readMem(0x9205), 0x27);
        // D4 005F
        gbc.setState(0x865b, 0x7099, 0x2c50, 0x46c5, 0x129a, 0x3e8c, 0x0, 0x0);
        gbc.writeMem(0x865b, { 0xd4, 0x7f, 0x9f });
        gbc.step();
        EXPECT(gbc.a(),  0x2c);
        EXPECT(gbc.b(),  0x46);
        EXPECT(gbc.c(),  0xc5);
        EXPECT(gbc.d(),  0x12);
        EXPECT(gbc.e(),  0x9a);
        EXPECT(gbc.h(),  0x3e);
        EXPECT(gbc.l(),  0x8c);
        EXPECT(gbc.sp(), 0x7099);
        EXPECT(gbc.pc(), 0x865e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x865b), 0xd4);
        EXPECT(gbc.readMem(0x865c), 0x7f);
        EXPECT(gbc.readMem(0x865d), 0x9f);
        // D4 0060
        gbc.setState(0xb03f, 0x8b6e, 0x98f0, 0x4df4, 0x95d0, 0x4991, 0x0, 0x0);
        gbc.writeMem(0xb03f, { 0xd4, 0x5c, 0xac });
        gbc.step();
        EXPECT(gbc.a(),  0x98);
        EXPECT(gbc.b(),  0x4d);
        EXPECT(gbc.c(),  0xf4);
        EXPECT(gbc.d(),  0x95);
        EXPECT(gbc.e(),  0xd0);
        EXPECT(gbc.h(),  0x49);
        EXPECT(gbc.l(),  0x91);
        EXPECT(gbc.sp(), 0x8b6e);
        EXPECT(gbc.pc(), 0xb042);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb03f), 0xd4);
        EXPECT(gbc.readMem(0xb040), 0x5c);
        EXPECT(gbc.readMem(0xb041), 0xac);
        // D4 0061
        gbc.setState(0x797e, 0xc811, 0xabb0, 0x9b8a, 0x3d8c, 0x3fce, 0x1, 0x1);
        gbc.writeMem(0x797e, { 0xd4, 0xe6, 0x76 });
        gbc.step();
        EXPECT(gbc.a(),  0xab);
        EXPECT(gbc.b(),  0x9b);
        EXPECT(gbc.c(),  0x8a);
        EXPECT(gbc.d(),  0x3d);
        EXPECT(gbc.e(),  0x8c);
        EXPECT(gbc.h(),  0x3f);
        EXPECT(gbc.l(),  0xce);
        EXPECT(gbc.sp(), 0xc811);
        EXPECT(gbc.pc(), 0x7981);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0062
        gbc.setState(0xe1e3, 0xf6ee, 0x7710, 0x7c92, 0xe5cc, 0x86b0, 0x0, 0x1);
        gbc.writeMem(0xe1e3, { 0xd4, 0xee, 0xfd });
        gbc.step();
        EXPECT(gbc.a(),  0x77);
        EXPECT(gbc.b(),  0x7c);
        EXPECT(gbc.c(),  0x92);
        EXPECT(gbc.d(),  0xe5);
        EXPECT(gbc.e(),  0xcc);
        EXPECT(gbc.h(),  0x86);
        EXPECT(gbc.l(),  0xb0);
        EXPECT(gbc.sp(), 0xf6ee);
        EXPECT(gbc.pc(), 0xe1e6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe1e3), 0xd4);
        EXPECT(gbc.readMem(0xe1e4), 0xee);
        EXPECT(gbc.readMem(0xe1e5), 0xfd);
        // D4 0063
        gbc.setState(0xbe24, 0xdd83, 0x2870, 0xc990, 0xd514, 0x817e, 0x0, 0x0);
        gbc.writeMem(0xbe24, { 0xd4, 0xcb, 0x8c });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0xc9);
        EXPECT(gbc.c(),  0x90);
        EXPECT(gbc.d(),  0xd5);
        EXPECT(gbc.e(),  0x14);
        EXPECT(gbc.h(),  0x81);
        EXPECT(gbc.l(),  0x7e);
        EXPECT(gbc.sp(), 0xdd83);
        EXPECT(gbc.pc(), 0xbe27);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbe24), 0xd4);
        EXPECT(gbc.readMem(0xbe25), 0xcb);
        EXPECT(gbc.readMem(0xbe26), 0x8c);
        // D4 0064
        gbc.setState(0x72b6, 0x50da, 0xb190, 0x555a, 0x89da, 0xfc79, 0x1, 0x1);
        gbc.writeMem(0x72b6, { 0xd4, 0x17, 0xe5 });
        gbc.step();
        EXPECT(gbc.a(),  0xb1);
        EXPECT(gbc.b(),  0x55);
        EXPECT(gbc.c(),  0x5a);
        EXPECT(gbc.d(),  0x89);
        EXPECT(gbc.e(),  0xda);
        EXPECT(gbc.h(),  0xfc);
        EXPECT(gbc.l(),  0x79);
        EXPECT(gbc.sp(), 0x50da);
        EXPECT(gbc.pc(), 0x72b9);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0066
        gbc.setState(0x7b77, 0xf34d, 0x3d00, 0x246d, 0x4f6b, 0x465d, 0x1, 0x1);
        gbc.writeMem(0x7b77, { 0xd4, 0x1f, 0x22 });
        gbc.writeMem(0xf34b, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x3d);
        EXPECT(gbc.b(),  0x24);
        EXPECT(gbc.c(),  0x6d);
        EXPECT(gbc.d(),  0x4f);
        EXPECT(gbc.e(),  0x6b);
        EXPECT(gbc.h(),  0x46);
        EXPECT(gbc.l(),  0x5d);
        EXPECT(gbc.sp(), 0xf34b);
        EXPECT(gbc.pc(), 0x221f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xf34b), 0x7a);
        EXPECT(gbc.readMem(0xf34c), 0x7b);
        // D4 0067
        gbc.setState(0x4d2f, 0xce85, 0x9350, 0x8e58, 0x75c7, 0x5743, 0x1, 0x1);
        gbc.writeMem(0x4d2f, { 0xd4, 0xa6, 0xf8 });
        gbc.step();
        EXPECT(gbc.a(),  0x93);
        EXPECT(gbc.b(),  0x8e);
        EXPECT(gbc.c(),  0x58);
        EXPECT(gbc.d(),  0x75);
        EXPECT(gbc.e(),  0xc7);
        EXPECT(gbc.h(),  0x57);
        EXPECT(gbc.l(),  0x43);
        EXPECT(gbc.sp(), 0xce85);
        EXPECT(gbc.pc(), 0x4d32);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0068
        gbc.setState(0xc10, 0x205b, 0xcb0, 0x1c51, 0x775e, 0x9181, 0x1, 0x0);
        gbc.writeMem(0xc10, { 0xd4, 0x3f, 0x42 });
        gbc.step();
        EXPECT(gbc.a(),  0xc);
        EXPECT(gbc.b(),  0x1c);
        EXPECT(gbc.c(),  0x51);
        EXPECT(gbc.d(),  0x77);
        EXPECT(gbc.e(),  0x5e);
        EXPECT(gbc.h(),  0x91);
        EXPECT(gbc.l(),  0x81);
        EXPECT(gbc.sp(), 0x205b);
        EXPECT(gbc.pc(), 0xc13);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 006A
        gbc.setState(0xc615, 0xc951, 0xf970, 0xe3fa, 0x22a6, 0x2f93, 0x1, 0x1);
        gbc.writeMem(0xc615, { 0xd4, 0x6, 0xdb });
        gbc.step();
        EXPECT(gbc.a(),  0xf9);
        EXPECT(gbc.b(),  0xe3);
        EXPECT(gbc.c(),  0xfa);
        EXPECT(gbc.d(),  0x22);
        EXPECT(gbc.e(),  0xa6);
        EXPECT(gbc.h(),  0x2f);
        EXPECT(gbc.l(),  0x93);
        EXPECT(gbc.sp(), 0xc951);
        EXPECT(gbc.pc(), 0xc618);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc615), 0xd4);
        EXPECT(gbc.readMem(0xc616), 0x6);
        EXPECT(gbc.readMem(0xc617), 0xdb);
        // D4 006B
        gbc.setState(0xbd0b, 0x8421, 0x57f0, 0x9663, 0x8204, 0x4524, 0x0, 0x1);
        gbc.writeMem(0xbd0b, { 0xd4, 0x2b, 0xeb });
        gbc.step();
        EXPECT(gbc.a(),  0x57);
        EXPECT(gbc.b(),  0x96);
        EXPECT(gbc.c(),  0x63);
        EXPECT(gbc.d(),  0x82);
        EXPECT(gbc.e(),  0x4);
        EXPECT(gbc.h(),  0x45);
        EXPECT(gbc.l(),  0x24);
        EXPECT(gbc.sp(), 0x8421);
        EXPECT(gbc.pc(), 0xbd0e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbd0b), 0xd4);
        EXPECT(gbc.readMem(0xbd0c), 0x2b);
        EXPECT(gbc.readMem(0xbd0d), 0xeb);
        // D4 006C
        gbc.setState(0x4ba3, 0x867b, 0x2850, 0x7d27, 0x4ec4, 0x2502, 0x0, 0x1);
        gbc.writeMem(0x4ba3, { 0xd4, 0x9b, 0xdc });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0x7d);
        EXPECT(gbc.c(),  0x27);
        EXPECT(gbc.d(),  0x4e);
        EXPECT(gbc.e(),  0xc4);
        EXPECT(gbc.h(),  0x25);
        EXPECT(gbc.l(),  0x2);
        EXPECT(gbc.sp(), 0x867b);
        EXPECT(gbc.pc(), 0x4ba6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 006E
        gbc.setState(0xa753, 0x9e4e, 0x88b0, 0xf15f, 0xf090, 0x499d, 0x0, 0x1);
        gbc.writeMem(0xa753, { 0xd4, 0x7, 0x9b });
        gbc.step();
        EXPECT(gbc.a(),  0x88);
        EXPECT(gbc.b(),  0xf1);
        EXPECT(gbc.c(),  0x5f);
        EXPECT(gbc.d(),  0xf0);
        EXPECT(gbc.e(),  0x90);
        EXPECT(gbc.h(),  0x49);
        EXPECT(gbc.l(),  0x9d);
        EXPECT(gbc.sp(), 0x9e4e);
        EXPECT(gbc.pc(), 0xa756);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa753), 0xd4);
        EXPECT(gbc.readMem(0xa754), 0x7);
        EXPECT(gbc.readMem(0xa755), 0x9b);
        // D4 0070
        gbc.setState(0x3e17, 0xe94e, 0x4390, 0x3f7e, 0x6118, 0xe343, 0x1, 0x1);
        gbc.writeMem(0x3e17, { 0xd4, 0x1, 0xfd });
        gbc.step();
        EXPECT(gbc.a(),  0x43);
        EXPECT(gbc.b(),  0x3f);
        EXPECT(gbc.c(),  0x7e);
        EXPECT(gbc.d(),  0x61);
        EXPECT(gbc.e(),  0x18);
        EXPECT(gbc.h(),  0xe3);
        EXPECT(gbc.l(),  0x43);
        EXPECT(gbc.sp(), 0xe94e);
        EXPECT(gbc.pc(), 0x3e1a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0071
        gbc.setState(0xaa46, 0x7f9, 0xd570, 0x4cf4, 0x2384, 0x46b8, 0x1, 0x0);
        gbc.writeMem(0xaa46, { 0xd4, 0x56, 0xd5 });
        gbc.step();
        EXPECT(gbc.a(),  0xd5);
        EXPECT(gbc.b(),  0x4c);
        EXPECT(gbc.c(),  0xf4);
        EXPECT(gbc.d(),  0x23);
        EXPECT(gbc.e(),  0x84);
        EXPECT(gbc.h(),  0x46);
        EXPECT(gbc.l(),  0xb8);
        EXPECT(gbc.sp(), 0x7f9);
        EXPECT(gbc.pc(), 0xaa49);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xaa46), 0xd4);
        EXPECT(gbc.readMem(0xaa47), 0x56);
        EXPECT(gbc.readMem(0xaa48), 0xd5);
        // D4 0072
        gbc.setState(0xe3a8, 0xe042, 0x70c0, 0xee92, 0x345, 0xa9eb, 0x1, 0x1);
        gbc.writeMem(0xe040, { 0x0, 0x0 });
        gbc.writeMem(0xe3a8, { 0xd4, 0x4e, 0x38 });
        gbc.step();
        EXPECT(gbc.a(),  0x70);
        EXPECT(gbc.b(),  0xee);
        EXPECT(gbc.c(),  0x92);
        EXPECT(gbc.d(),  0x3);
        EXPECT(gbc.e(),  0x45);
        EXPECT(gbc.h(),  0xa9);
        EXPECT(gbc.l(),  0xeb);
        EXPECT(gbc.sp(), 0xe040);
        EXPECT(gbc.pc(), 0x384e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe040), 0xab);
        EXPECT(gbc.readMem(0xe041), 0xe3);
        EXPECT(gbc.readMem(0xe3a8), 0xd4);
        EXPECT(gbc.readMem(0xe3a9), 0x4e);
        EXPECT(gbc.readMem(0xe3aa), 0x38);
        // D4 0075
        gbc.setState(0xcfd0, 0x6054, 0xb790, 0x2846, 0x93b3, 0xb641, 0x0, 0x0);
        gbc.writeMem(0xcfd0, { 0xd4, 0xdc, 0x9b });
        gbc.step();
        EXPECT(gbc.a(),  0xb7);
        EXPECT(gbc.b(),  0x28);
        EXPECT(gbc.c(),  0x46);
        EXPECT(gbc.d(),  0x93);
        EXPECT(gbc.e(),  0xb3);
        EXPECT(gbc.h(),  0xb6);
        EXPECT(gbc.l(),  0x41);
        EXPECT(gbc.sp(), 0x6054);
        EXPECT(gbc.pc(), 0xcfd3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcfd0), 0xd4);
        EXPECT(gbc.readMem(0xcfd1), 0xdc);
        EXPECT(gbc.readMem(0xcfd2), 0x9b);
        // D4 0076
        gbc.setState(0x9a25, 0xe350, 0xc80, 0xf9e, 0x30a8, 0x828, 0x0, 0x1);
        gbc.writeMem(0x9a25, { 0xd4, 0x8e, 0xf4 });
        gbc.writeMem(0xe34e, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xc);
        EXPECT(gbc.b(),  0xf);
        EXPECT(gbc.c(),  0x9e);
        EXPECT(gbc.d(),  0x30);
        EXPECT(gbc.e(),  0xa8);
        EXPECT(gbc.h(),  0x8);
        EXPECT(gbc.l(),  0x28);
        EXPECT(gbc.sp(), 0xe34e);
        EXPECT(gbc.pc(), 0xf48e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9a25), 0xd4);
        EXPECT(gbc.readMem(0x9a26), 0x8e);
        EXPECT(gbc.readMem(0x9a27), 0xf4);
        EXPECT(gbc.readMem(0xe34e), 0x28);
        EXPECT(gbc.readMem(0xe34f), 0x9a);
        // D4 0077
        gbc.setState(0x278e, 0xd837, 0xb970, 0xe9f7, 0xe9e9, 0x560a, 0x0, 0x1);
        gbc.writeMem(0x278e, { 0xd4, 0xab, 0xeb });
        gbc.step();
        EXPECT(gbc.a(),  0xb9);
        EXPECT(gbc.b(),  0xe9);
        EXPECT(gbc.c(),  0xf7);
        EXPECT(gbc.d(),  0xe9);
        EXPECT(gbc.e(),  0xe9);
        EXPECT(gbc.h(),  0x56);
        EXPECT(gbc.l(),  0xa);
        EXPECT(gbc.sp(), 0xd837);
        EXPECT(gbc.pc(), 0x2791);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0079
        gbc.setState(0xd436, 0x826a, 0x9fc0, 0x3c36, 0x30c3, 0x1057, 0x1, 0x1);
        gbc.writeMem(0x8268, { 0x0, 0x0 });
        gbc.writeMem(0xd436, { 0xd4, 0x2, 0xdb });
        gbc.step();
        EXPECT(gbc.a(),  0x9f);
        EXPECT(gbc.b(),  0x3c);
        EXPECT(gbc.c(),  0x36);
        EXPECT(gbc.d(),  0x30);
        EXPECT(gbc.e(),  0xc3);
        EXPECT(gbc.h(),  0x10);
        EXPECT(gbc.l(),  0x57);
        EXPECT(gbc.sp(), 0x8268);
        EXPECT(gbc.pc(), 0xdb02);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8268), 0x39);
        EXPECT(gbc.readMem(0x8269), 0xd4);
        EXPECT(gbc.readMem(0xd436), 0xd4);
        EXPECT(gbc.readMem(0xd437), 0x2);
        EXPECT(gbc.readMem(0xd438), 0xdb);
        // D4 007C
        gbc.setState(0xc7c6, 0x83cb, 0xcc70, 0xb56, 0x5229, 0x92b5, 0x0, 0x1);
        gbc.writeMem(0xc7c6, { 0xd4, 0xd1, 0x2e });
        gbc.step();
        EXPECT(gbc.a(),  0xcc);
        EXPECT(gbc.b(),  0xb);
        EXPECT(gbc.c(),  0x56);
        EXPECT(gbc.d(),  0x52);
        EXPECT(gbc.e(),  0x29);
        EXPECT(gbc.h(),  0x92);
        EXPECT(gbc.l(),  0xb5);
        EXPECT(gbc.sp(), 0x83cb);
        EXPECT(gbc.pc(), 0xc7c9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc7c6), 0xd4);
        EXPECT(gbc.readMem(0xc7c7), 0xd1);
        EXPECT(gbc.readMem(0xc7c8), 0x2e);
        // D4 007F
        gbc.setState(0xc8db, 0x25bc, 0xc970, 0x1b4f, 0x8f18, 0x46d8, 0x0, 0x0);
        gbc.writeMem(0xc8db, { 0xd4, 0xae, 0xbe });
        gbc.step();
        EXPECT(gbc.a(),  0xc9);
        EXPECT(gbc.b(),  0x1b);
        EXPECT(gbc.c(),  0x4f);
        EXPECT(gbc.d(),  0x8f);
        EXPECT(gbc.e(),  0x18);
        EXPECT(gbc.h(),  0x46);
        EXPECT(gbc.l(),  0xd8);
        EXPECT(gbc.sp(), 0x25bc);
        EXPECT(gbc.pc(), 0xc8de);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc8db), 0xd4);
        EXPECT(gbc.readMem(0xc8dc), 0xae);
        EXPECT(gbc.readMem(0xc8dd), 0xbe);
        // D4 0080
        gbc.setState(0x7fef, 0x477b, 0x3b10, 0xad2, 0xc70f, 0x9154, 0x0, 0x1);
        gbc.writeMem(0x7fef, { 0xd4, 0x6a, 0x2c });
        gbc.step();
        EXPECT(gbc.a(),  0x3b);
        EXPECT(gbc.b(),  0xa);
        EXPECT(gbc.c(),  0xd2);
        EXPECT(gbc.d(),  0xc7);
        EXPECT(gbc.e(),  0xf);
        EXPECT(gbc.h(),  0x91);
        EXPECT(gbc.l(),  0x54);
        EXPECT(gbc.sp(), 0x477b);
        EXPECT(gbc.pc(), 0x7ff2);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0081
        gbc.setState(0xb2b2, 0x9f58, 0xd220, 0xa907, 0xdb97, 0x12c2, 0x1, 0x1);
        gbc.writeMem(0x9f56, { 0x0, 0x0 });
        gbc.writeMem(0xb2b2, { 0xd4, 0x5c, 0x6c });
        gbc.step();
        EXPECT(gbc.a(),  0xd2);
        EXPECT(gbc.b(),  0xa9);
        EXPECT(gbc.c(),  0x7);
        EXPECT(gbc.d(),  0xdb);
        EXPECT(gbc.e(),  0x97);
        EXPECT(gbc.h(),  0x12);
        EXPECT(gbc.l(),  0xc2);
        EXPECT(gbc.sp(), 0x9f56);
        EXPECT(gbc.pc(), 0x6c5c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9f56), 0xb5);
        EXPECT(gbc.readMem(0x9f57), 0xb2);
        EXPECT(gbc.readMem(0xb2b2), 0xd4);
        EXPECT(gbc.readMem(0xb2b3), 0x5c);
        EXPECT(gbc.readMem(0xb2b4), 0x6c);
        // D4 0082
        gbc.setState(0x7782, 0x2cd0, 0x4890, 0x9d65, 0x7fd7, 0xe1db, 0x0, 0x0);
        gbc.writeMem(0x7782, { 0xd4, 0xf4, 0x68 });
        gbc.step();
        EXPECT(gbc.a(),  0x48);
        EXPECT(gbc.b(),  0x9d);
        EXPECT(gbc.c(),  0x65);
        EXPECT(gbc.d(),  0x7f);
        EXPECT(gbc.e(),  0xd7);
        EXPECT(gbc.h(),  0xe1);
        EXPECT(gbc.l(),  0xdb);
        EXPECT(gbc.sp(), 0x2cd0);
        EXPECT(gbc.pc(), 0x7785);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0083
        gbc.setState(0x4a2d, 0xa027, 0x2a60, 0x5538, 0xc080, 0xd128, 0x0, 0x0);
        gbc.writeMem(0x4a2d, { 0xd4, 0xda, 0x51 });
        gbc.writeMem(0xa025, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x2a);
        EXPECT(gbc.b(),  0x55);
        EXPECT(gbc.c(),  0x38);
        EXPECT(gbc.d(),  0xc0);
        EXPECT(gbc.e(),  0x80);
        EXPECT(gbc.h(),  0xd1);
        EXPECT(gbc.l(),  0x28);
        EXPECT(gbc.sp(), 0xa025);
        EXPECT(gbc.pc(), 0x51da);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa025), 0x30);
        EXPECT(gbc.readMem(0xa026), 0x4a);
        // D4 0084
        gbc.setState(0x1a1d, 0x21cd, 0xce10, 0x4c01, 0x7f50, 0xc4a5, 0x0, 0x0);
        gbc.writeMem(0x1a1d, { 0xd4, 0xc3, 0x6f });
        gbc.step();
        EXPECT(gbc.a(),  0xce);
        EXPECT(gbc.b(),  0x4c);
        EXPECT(gbc.c(),  0x1);
        EXPECT(gbc.d(),  0x7f);
        EXPECT(gbc.e(),  0x50);
        EXPECT(gbc.h(),  0xc4);
        EXPECT(gbc.l(),  0xa5);
        EXPECT(gbc.sp(), 0x21cd);
        EXPECT(gbc.pc(), 0x1a20);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0085
        gbc.setState(0x907f, 0xae5f, 0xd440, 0x2836, 0x13d4, 0xe637, 0x1, 0x1);
        gbc.writeMem(0x907f, { 0xd4, 0xab, 0x27 });
        gbc.writeMem(0xae5d, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xd4);
        EXPECT(gbc.b(),  0x28);
        EXPECT(gbc.c(),  0x36);
        EXPECT(gbc.d(),  0x13);
        EXPECT(gbc.e(),  0xd4);
        EXPECT(gbc.h(),  0xe6);
        EXPECT(gbc.l(),  0x37);
        EXPECT(gbc.sp(), 0xae5d);
        EXPECT(gbc.pc(), 0x27ab);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x907f), 0xd4);
        EXPECT(gbc.readMem(0x9080), 0xab);
        EXPECT(gbc.readMem(0x9081), 0x27);
        EXPECT(gbc.readMem(0xae5d), 0x82);
        EXPECT(gbc.readMem(0xae5e), 0x90);
        // D4 0087
        gbc.setState(0x2fa8, 0x9fa6, 0x1800, 0x8ee1, 0x6899, 0xa5af, 0x0, 0x0);
        gbc.writeMem(0x2fa8, { 0xd4, 0xaa, 0x41 });
        gbc.writeMem(0x9fa4, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x18);
        EXPECT(gbc.b(),  0x8e);
        EXPECT(gbc.c(),  0xe1);
        EXPECT(gbc.d(),  0x68);
        EXPECT(gbc.e(),  0x99);
        EXPECT(gbc.h(),  0xa5);
        EXPECT(gbc.l(),  0xaf);
        EXPECT(gbc.sp(), 0x9fa4);
        EXPECT(gbc.pc(), 0x41aa);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9fa4), 0xab);
        EXPECT(gbc.readMem(0x9fa5), 0x2f);
        // D4 0088
        gbc.setState(0xa19e, 0xbffa, 0x36d0, 0xc9a5, 0xaa13, 0x1c68, 0x1, 0x1);
        gbc.writeMem(0xa19e, { 0xd4, 0xa3, 0x3b });
        gbc.step();
        EXPECT(gbc.a(),  0x36);
        EXPECT(gbc.b(),  0xc9);
        EXPECT(gbc.c(),  0xa5);
        EXPECT(gbc.d(),  0xaa);
        EXPECT(gbc.e(),  0x13);
        EXPECT(gbc.h(),  0x1c);
        EXPECT(gbc.l(),  0x68);
        EXPECT(gbc.sp(), 0xbffa);
        EXPECT(gbc.pc(), 0xa1a1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa19e), 0xd4);
        EXPECT(gbc.readMem(0xa19f), 0xa3);
        EXPECT(gbc.readMem(0xa1a0), 0x3b);
        // D4 008B
        gbc.setState(0x2d71, 0xadc4, 0xf910, 0x35a1, 0x4c2d, 0xbbd8, 0x1, 0x0);
        gbc.writeMem(0x2d71, { 0xd4, 0xc3, 0xc });
        gbc.step();
        EXPECT(gbc.a(),  0xf9);
        EXPECT(gbc.b(),  0x35);
        EXPECT(gbc.c(),  0xa1);
        EXPECT(gbc.d(),  0x4c);
        EXPECT(gbc.e(),  0x2d);
        EXPECT(gbc.h(),  0xbb);
        EXPECT(gbc.l(),  0xd8);
        EXPECT(gbc.sp(), 0xadc4);
        EXPECT(gbc.pc(), 0x2d74);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 008C
        gbc.setState(0xabd7, 0xaf0c, 0xa7f0, 0xc192, 0xfe64, 0x21da, 0x0, 0x0);
        gbc.writeMem(0xabd7, { 0xd4, 0xc6, 0x2b });
        gbc.step();
        EXPECT(gbc.a(),  0xa7);
        EXPECT(gbc.b(),  0xc1);
        EXPECT(gbc.c(),  0x92);
        EXPECT(gbc.d(),  0xfe);
        EXPECT(gbc.e(),  0x64);
        EXPECT(gbc.h(),  0x21);
        EXPECT(gbc.l(),  0xda);
        EXPECT(gbc.sp(), 0xaf0c);
        EXPECT(gbc.pc(), 0xabda);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xabd7), 0xd4);
        EXPECT(gbc.readMem(0xabd8), 0xc6);
        EXPECT(gbc.readMem(0xabd9), 0x2b);
        // D4 008D
        gbc.setState(0xbcb, 0xe0a4, 0xccc0, 0xcada, 0x42ff, 0x3085, 0x0, 0x1);
        gbc.writeMem(0xbcb, { 0xd4, 0x70, 0xc1 });
        gbc.writeMem(0xe0a2, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xcc);
        EXPECT(gbc.b(),  0xca);
        EXPECT(gbc.c(),  0xda);
        EXPECT(gbc.d(),  0x42);
        EXPECT(gbc.e(),  0xff);
        EXPECT(gbc.h(),  0x30);
        EXPECT(gbc.l(),  0x85);
        EXPECT(gbc.sp(), 0xe0a2);
        EXPECT(gbc.pc(), 0xc170);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe0a2), 0xce);
        EXPECT(gbc.readMem(0xe0a3), 0xb);
        // D4 008F
        gbc.setState(0x8cc1, 0x9e2a, 0xe130, 0x52d3, 0xc763, 0x5bf8, 0x1, 0x1);
        gbc.writeMem(0x8cc1, { 0xd4, 0x91, 0x40 });
        gbc.step();
        EXPECT(gbc.a(),  0xe1);
        EXPECT(gbc.b(),  0x52);
        EXPECT(gbc.c(),  0xd3);
        EXPECT(gbc.d(),  0xc7);
        EXPECT(gbc.e(),  0x63);
        EXPECT(gbc.h(),  0x5b);
        EXPECT(gbc.l(),  0xf8);
        EXPECT(gbc.sp(), 0x9e2a);
        EXPECT(gbc.pc(), 0x8cc4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8cc1), 0xd4);
        EXPECT(gbc.readMem(0x8cc2), 0x91);
        EXPECT(gbc.readMem(0x8cc3), 0x40);
        // D4 0090
        gbc.setState(0x9347, 0x75d7, 0x6e70, 0xfaa7, 0x906b, 0xb637, 0x1, 0x1);
        gbc.writeMem(0x9347, { 0xd4, 0xe, 0xdc });
        gbc.step();
        EXPECT(gbc.a(),  0x6e);
        EXPECT(gbc.b(),  0xfa);
        EXPECT(gbc.c(),  0xa7);
        EXPECT(gbc.d(),  0x90);
        EXPECT(gbc.e(),  0x6b);
        EXPECT(gbc.h(),  0xb6);
        EXPECT(gbc.l(),  0x37);
        EXPECT(gbc.sp(), 0x75d7);
        EXPECT(gbc.pc(), 0x934a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9347), 0xd4);
        EXPECT(gbc.readMem(0x9348), 0xe);
        EXPECT(gbc.readMem(0x9349), 0xdc);
        // D4 0092
        gbc.setState(0xe471, 0xc77a, 0x2200, 0xd4b5, 0x9443, 0x7d3a, 0x1, 0x0);
        gbc.writeMem(0xc778, { 0x0, 0x0 });
        gbc.writeMem(0xe471, { 0xd4, 0x63, 0xaa });
        gbc.step();
        EXPECT(gbc.a(),  0x22);
        EXPECT(gbc.b(),  0xd4);
        EXPECT(gbc.c(),  0xb5);
        EXPECT(gbc.d(),  0x94);
        EXPECT(gbc.e(),  0x43);
        EXPECT(gbc.h(),  0x7d);
        EXPECT(gbc.l(),  0x3a);
        EXPECT(gbc.sp(), 0xc778);
        EXPECT(gbc.pc(), 0xaa63);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc778), 0x74);
        EXPECT(gbc.readMem(0xc779), 0xe4);
        EXPECT(gbc.readMem(0xe471), 0xd4);
        EXPECT(gbc.readMem(0xe472), 0x63);
        EXPECT(gbc.readMem(0xe473), 0xaa);
        // D4 0093
        gbc.setState(0xd0ab, 0xedfd, 0x8a70, 0xc834, 0x6615, 0x7bd0, 0x0, 0x1);
        gbc.writeMem(0xd0ab, { 0xd4, 0xe4, 0xbd });
        gbc.step();
        EXPECT(gbc.a(),  0x8a);
        EXPECT(gbc.b(),  0xc8);
        EXPECT(gbc.c(),  0x34);
        EXPECT(gbc.d(),  0x66);
        EXPECT(gbc.e(),  0x15);
        EXPECT(gbc.h(),  0x7b);
        EXPECT(gbc.l(),  0xd0);
        EXPECT(gbc.sp(), 0xedfd);
        EXPECT(gbc.pc(), 0xd0ae);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd0ab), 0xd4);
        EXPECT(gbc.readMem(0xd0ac), 0xe4);
        EXPECT(gbc.readMem(0xd0ad), 0xbd);
        // D4 0095
        gbc.setState(0xe0fe, 0x886c, 0x2050, 0x9ac0, 0x198b, 0x2e9d, 0x0, 0x0);
        gbc.writeMem(0xe0fe, { 0xd4, 0x56, 0x3e });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0x9a);
        EXPECT(gbc.c(),  0xc0);
        EXPECT(gbc.d(),  0x19);
        EXPECT(gbc.e(),  0x8b);
        EXPECT(gbc.h(),  0x2e);
        EXPECT(gbc.l(),  0x9d);
        EXPECT(gbc.sp(), 0x886c);
        EXPECT(gbc.pc(), 0xe101);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe0fe), 0xd4);
        EXPECT(gbc.readMem(0xe0ff), 0x56);
        EXPECT(gbc.readMem(0xe100), 0x3e);
        // D4 0098
        gbc.setState(0xba4, 0xf2f1, 0xfd0, 0x8176, 0xa09e, 0x5376, 0x1, 0x1);
        gbc.writeMem(0xba4, { 0xd4, 0x5b, 0x42 });
        gbc.step();
        EXPECT(gbc.a(),  0xf);
        EXPECT(gbc.b(),  0x81);
        EXPECT(gbc.c(),  0x76);
        EXPECT(gbc.d(),  0xa0);
        EXPECT(gbc.e(),  0x9e);
        EXPECT(gbc.h(),  0x53);
        EXPECT(gbc.l(),  0x76);
        EXPECT(gbc.sp(), 0xf2f1);
        EXPECT(gbc.pc(), 0xba7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0099
        gbc.setState(0x203c, 0x81f0, 0xd230, 0xca6f, 0xd8dc, 0xfd5e, 0x1, 0x1);
        gbc.writeMem(0x203c, { 0xd4, 0xce, 0x5b });
        gbc.step();
        EXPECT(gbc.a(),  0xd2);
        EXPECT(gbc.b(),  0xca);
        EXPECT(gbc.c(),  0x6f);
        EXPECT(gbc.d(),  0xd8);
        EXPECT(gbc.e(),  0xdc);
        EXPECT(gbc.h(),  0xfd);
        EXPECT(gbc.l(),  0x5e);
        EXPECT(gbc.sp(), 0x81f0);
        EXPECT(gbc.pc(), 0x203f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 009A
        gbc.setState(0xd66f, 0xfc20, 0x1780, 0xf902, 0x406e, 0x1192, 0x0, 0x1);
        gbc.writeMem(0xd66f, { 0xd4, 0xa2, 0xcd });
        gbc.writeMem(0xfc1e, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x17);
        EXPECT(gbc.b(),  0xf9);
        EXPECT(gbc.c(),  0x2);
        EXPECT(gbc.d(),  0x40);
        EXPECT(gbc.e(),  0x6e);
        EXPECT(gbc.h(),  0x11);
        EXPECT(gbc.l(),  0x92);
        EXPECT(gbc.sp(), 0xfc1e);
        EXPECT(gbc.pc(), 0xcda2);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd66f), 0xd4);
        EXPECT(gbc.readMem(0xd670), 0xa2);
        EXPECT(gbc.readMem(0xd671), 0xcd);
        EXPECT(gbc.readMem(0xfc1e), 0x72);
        EXPECT(gbc.readMem(0xfc1f), 0xd6);
        // D4 009C
        gbc.setState(0xe065, 0xfaf6, 0x8de0, 0x22ef, 0xce04, 0x6809, 0x1, 0x1);
        gbc.writeMem(0xe065, { 0xd4, 0x4b, 0x7a });
        gbc.writeMem(0xfaf4, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x8d);
        EXPECT(gbc.b(),  0x22);
        EXPECT(gbc.c(),  0xef);
        EXPECT(gbc.d(),  0xce);
        EXPECT(gbc.e(),  0x4);
        EXPECT(gbc.h(),  0x68);
        EXPECT(gbc.l(),  0x9);
        EXPECT(gbc.sp(), 0xfaf4);
        EXPECT(gbc.pc(), 0x7a4b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe065), 0xd4);
        EXPECT(gbc.readMem(0xe066), 0x4b);
        EXPECT(gbc.readMem(0xe067), 0x7a);
        EXPECT(gbc.readMem(0xfaf4), 0x68);
        EXPECT(gbc.readMem(0xfaf5), 0xe0);
        // D4 009D
        gbc.setState(0xad4b, 0x8557, 0xb200, 0x48c6, 0xe77a, 0xb487, 0x0, 0x0);
        gbc.writeMem(0x8555, { 0x0, 0x0 });
        gbc.writeMem(0xad4b, { 0xd4, 0xad, 0x8f });
        gbc.step();
        EXPECT(gbc.a(),  0xb2);
        EXPECT(gbc.b(),  0x48);
        EXPECT(gbc.c(),  0xc6);
        EXPECT(gbc.d(),  0xe7);
        EXPECT(gbc.e(),  0x7a);
        EXPECT(gbc.h(),  0xb4);
        EXPECT(gbc.l(),  0x87);
        EXPECT(gbc.sp(), 0x8555);
        EXPECT(gbc.pc(), 0x8fad);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8555), 0x4e);
        EXPECT(gbc.readMem(0x8556), 0xad);
        EXPECT(gbc.readMem(0xad4b), 0xd4);
        EXPECT(gbc.readMem(0xad4c), 0xad);
        EXPECT(gbc.readMem(0xad4d), 0x8f);
        // D4 009E
        gbc.setState(0x17ac, 0xa397, 0xa620, 0x735e, 0xb49, 0x3596, 0x0, 0x0);
        gbc.writeMem(0x17ac, { 0xd4, 0xf, 0x43 });
        gbc.writeMem(0xa395, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xa6);
        EXPECT(gbc.b(),  0x73);
        EXPECT(gbc.c(),  0x5e);
        EXPECT(gbc.d(),  0xb);
        EXPECT(gbc.e(),  0x49);
        EXPECT(gbc.h(),  0x35);
        EXPECT(gbc.l(),  0x96);
        EXPECT(gbc.sp(), 0xa395);
        EXPECT(gbc.pc(), 0x430f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa395), 0xaf);
        EXPECT(gbc.readMem(0xa396), 0x17);
        // D4 009F
        gbc.setState(0xe851, 0x1e08, 0x3090, 0x3dd5, 0xe368, 0x7fd8, 0x1, 0x1);
        gbc.writeMem(0xe851, { 0xd4, 0x91, 0x64 });
        gbc.step();
        EXPECT(gbc.a(),  0x30);
        EXPECT(gbc.b(),  0x3d);
        EXPECT(gbc.c(),  0xd5);
        EXPECT(gbc.d(),  0xe3);
        EXPECT(gbc.e(),  0x68);
        EXPECT(gbc.h(),  0x7f);
        EXPECT(gbc.l(),  0xd8);
        EXPECT(gbc.sp(), 0x1e08);
        EXPECT(gbc.pc(), 0xe854);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe851), 0xd4);
        EXPECT(gbc.readMem(0xe852), 0x91);
        EXPECT(gbc.readMem(0xe853), 0x64);
        // D4 00A0
        gbc.setState(0x205c, 0x3f7e, 0x24b0, 0xbd67, 0xb825, 0xd03b, 0x0, 0x0);
        gbc.writeMem(0x205c, { 0xd4, 0xf0, 0xc5 });
        gbc.step();
        EXPECT(gbc.a(),  0x24);
        EXPECT(gbc.b(),  0xbd);
        EXPECT(gbc.c(),  0x67);
        EXPECT(gbc.d(),  0xb8);
        EXPECT(gbc.e(),  0x25);
        EXPECT(gbc.h(),  0xd0);
        EXPECT(gbc.l(),  0x3b);
        EXPECT(gbc.sp(), 0x3f7e);
        EXPECT(gbc.pc(), 0x205f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 00A1
        gbc.setState(0xe41d, 0x9c7c, 0x6980, 0xb6af, 0x5bef, 0xe029, 0x0, 0x1);
        gbc.writeMem(0x9c7a, { 0x0, 0x0 });
        gbc.writeMem(0xe41d, { 0xd4, 0xbf, 0xdd });
        gbc.step();
        EXPECT(gbc.a(),  0x69);
        EXPECT(gbc.b(),  0xb6);
        EXPECT(gbc.c(),  0xaf);
        EXPECT(gbc.d(),  0x5b);
        EXPECT(gbc.e(),  0xef);
        EXPECT(gbc.h(),  0xe0);
        EXPECT(gbc.l(),  0x29);
        EXPECT(gbc.sp(), 0x9c7a);
        EXPECT(gbc.pc(), 0xddbf);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9c7a), 0x20);
        EXPECT(gbc.readMem(0x9c7b), 0xe4);
        EXPECT(gbc.readMem(0xe41d), 0xd4);
        EXPECT(gbc.readMem(0xe41e), 0xbf);
        EXPECT(gbc.readMem(0xe41f), 0xdd);
        // D4 00A2
        gbc.setState(0x19c3, 0x2580, 0xd0f0, 0x3cf0, 0x95e6, 0xba25, 0x0, 0x1);
        gbc.writeMem(0x19c3, { 0xd4, 0x92, 0xc });
        gbc.step();
        EXPECT(gbc.a(),  0xd0);
        EXPECT(gbc.b(),  0x3c);
        EXPECT(gbc.c(),  0xf0);
        EXPECT(gbc.d(),  0x95);
        EXPECT(gbc.e(),  0xe6);
        EXPECT(gbc.h(),  0xba);
        EXPECT(gbc.l(),  0x25);
        EXPECT(gbc.sp(), 0x2580);
        EXPECT(gbc.pc(), 0x19c6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 00A4
        gbc.setState(0xdf53, 0xfaf5, 0x3a30, 0x7703, 0x7a7, 0xbde8, 0x0, 0x0);
        gbc.writeMem(0xdf53, { 0xd4, 0x2, 0xff });
        gbc.step();
        EXPECT(gbc.a(),  0x3a);
        EXPECT(gbc.b(),  0x77);
        EXPECT(gbc.c(),  0x3);
        EXPECT(gbc.d(),  0x7);
        EXPECT(gbc.e(),  0xa7);
        EXPECT(gbc.h(),  0xbd);
        EXPECT(gbc.l(),  0xe8);
        EXPECT(gbc.sp(), 0xfaf5);
        EXPECT(gbc.pc(), 0xdf56);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xdf53), 0xd4);
        EXPECT(gbc.readMem(0xdf54), 0x2);
        EXPECT(gbc.readMem(0xdf55), 0xff);
        // D4 00A5
        gbc.setState(0x19c0, 0x66c3, 0x2bb0, 0xdf8b, 0xbabc, 0xe67c, 0x1, 0x0);
        gbc.writeMem(0x19c0, { 0xd4, 0x5, 0x85 });
        gbc.step();
        EXPECT(gbc.a(),  0x2b);
        EXPECT(gbc.b(),  0xdf);
        EXPECT(gbc.c(),  0x8b);
        EXPECT(gbc.d(),  0xba);
        EXPECT(gbc.e(),  0xbc);
        EXPECT(gbc.h(),  0xe6);
        EXPECT(gbc.l(),  0x7c);
        EXPECT(gbc.sp(), 0x66c3);
        EXPECT(gbc.pc(), 0x19c3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 00A8
        gbc.setState(0xa5b4, 0x9212, 0xbab0, 0x7e94, 0x18b8, 0x7154, 0x1, 0x0);
        gbc.writeMem(0xa5b4, { 0xd4, 0xc5, 0xbf });
        gbc.step();
        EXPECT(gbc.a(),  0xba);
        EXPECT(gbc.b(),  0x7e);
        EXPECT(gbc.c(),  0x94);
        EXPECT(gbc.d(),  0x18);
        EXPECT(gbc.e(),  0xb8);
        EXPECT(gbc.h(),  0x71);
        EXPECT(gbc.l(),  0x54);
        EXPECT(gbc.sp(), 0x9212);
        EXPECT(gbc.pc(), 0xa5b7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa5b4), 0xd4);
        EXPECT(gbc.readMem(0xa5b5), 0xc5);
        EXPECT(gbc.readMem(0xa5b6), 0xbf);
        // D4 00A9
        gbc.setState(0xbd07, 0xbf98, 0xaac0, 0xfef1, 0xb82, 0xb5a, 0x1, 0x1);
        gbc.writeMem(0xbd07, { 0xd4, 0x5f, 0x50 });
        gbc.writeMem(0xbf96, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xaa);
        EXPECT(gbc.b(),  0xfe);
        EXPECT(gbc.c(),  0xf1);
        EXPECT(gbc.d(),  0xb);
        EXPECT(gbc.e(),  0x82);
        EXPECT(gbc.h(),  0xb);
        EXPECT(gbc.l(),  0x5a);
        EXPECT(gbc.sp(), 0xbf96);
        EXPECT(gbc.pc(), 0x505f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbd07), 0xd4);
        EXPECT(gbc.readMem(0xbd08), 0x5f);
        EXPECT(gbc.readMem(0xbd09), 0x50);
        EXPECT(gbc.readMem(0xbf96), 0xa);
        EXPECT(gbc.readMem(0xbf97), 0xbd);
        // D4 00AA
        gbc.setState(0x320, 0xf4c6, 0x69a0, 0x8170, 0x5a33, 0xc939, 0x0, 0x0);
        gbc.writeMem(0x320, { 0xd4, 0x69, 0xfc });
        gbc.writeMem(0xf4c4, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x69);
        EXPECT(gbc.b(),  0x81);
        EXPECT(gbc.c(),  0x70);
        EXPECT(gbc.d(),  0x5a);
        EXPECT(gbc.e(),  0x33);
        EXPECT(gbc.h(),  0xc9);
        EXPECT(gbc.l(),  0x39);
        EXPECT(gbc.sp(), 0xf4c4);
        EXPECT(gbc.pc(), 0xfc69);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xf4c4), 0x23);
        EXPECT(gbc.readMem(0xf4c5), 0x3);
        // D4 00AC
        gbc.setState(0x9d43, 0xddc9, 0x5d40, 0xf675, 0xbec1, 0xc350, 0x1, 0x0);
        gbc.writeMem(0x9d43, { 0xd4, 0x53, 0xfa });
        gbc.writeMem(0xddc7, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x5d);
        EXPECT(gbc.b(),  0xf6);
        EXPECT(gbc.c(),  0x75);
        EXPECT(gbc.d(),  0xbe);
        EXPECT(gbc.e(),  0xc1);
        EXPECT(gbc.h(),  0xc3);
        EXPECT(gbc.l(),  0x50);
        EXPECT(gbc.sp(), 0xddc7);
        EXPECT(gbc.pc(), 0xfa53);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9d43), 0xd4);
        EXPECT(gbc.readMem(0x9d44), 0x53);
        EXPECT(gbc.readMem(0x9d45), 0xfa);
        EXPECT(gbc.readMem(0xddc7), 0x46);
        EXPECT(gbc.readMem(0xddc8), 0x9d);
        // D4 00AD
        gbc.setState(0xb50e, 0xf851, 0x7de0, 0xe6e3, 0xffe9, 0xb06a, 0x1, 0x1);
        gbc.writeMem(0xb50e, { 0xd4, 0x6e, 0xa4 });
        gbc.writeMem(0xf84f, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x7d);
        EXPECT(gbc.b(),  0xe6);
        EXPECT(gbc.c(),  0xe3);
        EXPECT(gbc.d(),  0xff);
        EXPECT(gbc.e(),  0xe9);
        EXPECT(gbc.h(),  0xb0);
        EXPECT(gbc.l(),  0x6a);
        EXPECT(gbc.sp(), 0xf84f);
        EXPECT(gbc.pc(), 0xa46e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb50e), 0xd4);
        EXPECT(gbc.readMem(0xb50f), 0x6e);
        EXPECT(gbc.readMem(0xb510), 0xa4);
        EXPECT(gbc.readMem(0xf84f), 0x11);
        EXPECT(gbc.readMem(0xf850), 0xb5);
        // D4 00AE
        gbc.setState(0x40e0, 0x53bd, 0x7db0, 0x3097, 0xa4ea, 0x34fe, 0x1, 0x0);
        gbc.writeMem(0x40e0, { 0xd4, 0x3e, 0xd9 });
        gbc.step();
        EXPECT(gbc.a(),  0x7d);
        EXPECT(gbc.b(),  0x30);
        EXPECT(gbc.c(),  0x97);
        EXPECT(gbc.d(),  0xa4);
        EXPECT(gbc.e(),  0xea);
        EXPECT(gbc.h(),  0x34);
        EXPECT(gbc.l(),  0xfe);
        EXPECT(gbc.sp(), 0x53bd);
        EXPECT(gbc.pc(), 0x40e3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 00AF
        gbc.setState(0x53a, 0xb300, 0x26b0, 0xa5a8, 0x2794, 0x89e5, 0x0, 0x1);
        gbc.writeMem(0x53a, { 0xd4, 0xa6, 0x12 });
        gbc.step();
        EXPECT(gbc.a(),  0x26);
        EXPECT(gbc.b(),  0xa5);
        EXPECT(gbc.c(),  0xa8);
        EXPECT(gbc.d(),  0x27);
        EXPECT(gbc.e(),  0x94);
        EXPECT(gbc.h(),  0x89);
        EXPECT(gbc.l(),  0xe5);
        EXPECT(gbc.sp(), 0xb300);
        EXPECT(gbc.pc(), 0x53d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 00B2
        gbc.setState(0x63d6, 0x527c, 0xa590, 0xbed5, 0x90c8, 0xd805, 0x0, 0x0);
        gbc.writeMem(0x63d6, { 0xd4, 0x87, 0x34 });
        gbc.step();
        EXPECT(gbc.a(),  0xa5);
        EXPECT(gbc.b(),  0xbe);
        EXPECT(gbc.c(),  0xd5);
        EXPECT(gbc.d(),  0x90);
        EXPECT(gbc.e(),  0xc8);
        EXPECT(gbc.h(),  0xd8);
        EXPECT(gbc.l(),  0x5);
        EXPECT(gbc.sp(), 0x527c);
        EXPECT(gbc.pc(), 0x63d9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 00B3
        gbc.setState(0x4032, 0xcfd9, 0x7f70, 0x5af6, 0x84b5, 0xa2e8, 0x1, 0x0);
        gbc.writeMem(0x4032, { 0xd4, 0xb4, 0x57 });
        gbc.step();
        EXPECT(gbc.a(),  0x7f);
        EXPECT(gbc.b(),  0x5a);
        EXPECT(gbc.c(),  0xf6);
        EXPECT(gbc.d(),  0x84);
        EXPECT(gbc.e(),  0xb5);
        EXPECT(gbc.h(),  0xa2);
        EXPECT(gbc.l(),  0xe8);
        EXPECT(gbc.sp(), 0xcfd9);
        EXPECT(gbc.pc(), 0x4035);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 00B4
        gbc.setState(0xb772, 0x87f9, 0x3650, 0x276d, 0xc7a9, 0x9872, 0x1, 0x0);
        gbc.writeMem(0xb772, { 0xd4, 0x12, 0x6b });
        gbc.step();
        EXPECT(gbc.a(),  0x36);
        EXPECT(gbc.b(),  0x27);
        EXPECT(gbc.c(),  0x6d);
        EXPECT(gbc.d(),  0xc7);
        EXPECT(gbc.e(),  0xa9);
        EXPECT(gbc.h(),  0x98);
        EXPECT(gbc.l(),  0x72);
        EXPECT(gbc.sp(), 0x87f9);
        EXPECT(gbc.pc(), 0xb775);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb772), 0xd4);
        EXPECT(gbc.readMem(0xb773), 0x12);
        EXPECT(gbc.readMem(0xb774), 0x6b);
        // D4 00B5
        gbc.setState(0x4edc, 0xce0d, 0x3fe0, 0xdb5a, 0x8829, 0xafe2, 0x0, 0x1);
        gbc.writeMem(0x4edc, { 0xd4, 0x6c, 0x73 });
        gbc.writeMem(0xce0b, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x3f);
        EXPECT(gbc.b(),  0xdb);
        EXPECT(gbc.c(),  0x5a);
        EXPECT(gbc.d(),  0x88);
        EXPECT(gbc.e(),  0x29);
        EXPECT(gbc.h(),  0xaf);
        EXPECT(gbc.l(),  0xe2);
        EXPECT(gbc.sp(), 0xce0b);
        EXPECT(gbc.pc(), 0x736c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xce0b), 0xdf);
        EXPECT(gbc.readMem(0xce0c), 0x4e);
        // D4 00B6
        gbc.setState(0x9d92, 0x9e3f, 0x43b0, 0xb068, 0x2150, 0x4dba, 0x1, 0x0);
        gbc.writeMem(0x9d92, { 0xd4, 0x1d, 0x12 });
        gbc.step();
        EXPECT(gbc.a(),  0x43);
        EXPECT(gbc.b(),  0xb0);
        EXPECT(gbc.c(),  0x68);
        EXPECT(gbc.d(),  0x21);
        EXPECT(gbc.e(),  0x50);
        EXPECT(gbc.h(),  0x4d);
        EXPECT(gbc.l(),  0xba);
        EXPECT(gbc.sp(), 0x9e3f);
        EXPECT(gbc.pc(), 0x9d95);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9d92), 0xd4);
        EXPECT(gbc.readMem(0x9d93), 0x1d);
        EXPECT(gbc.readMem(0x9d94), 0x12);
        // D4 00B8
        gbc.setState(0xd83b, 0xa011, 0x5640, 0x8889, 0x7734, 0x992, 0x0, 0x1);
        gbc.writeMem(0xa00f, { 0x0, 0x0 });
        gbc.writeMem(0xd83b, { 0xd4, 0xaa, 0x74 });
        gbc.step();
        EXPECT(gbc.a(),  0x56);
        EXPECT(gbc.b(),  0x88);
        EXPECT(gbc.c(),  0x89);
        EXPECT(gbc.d(),  0x77);
        EXPECT(gbc.e(),  0x34);
        EXPECT(gbc.h(),  0x9);
        EXPECT(gbc.l(),  0x92);
        EXPECT(gbc.sp(), 0xa00f);
        EXPECT(gbc.pc(), 0x74aa);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa00f), 0x3e);
        EXPECT(gbc.readMem(0xa010), 0xd8);
        EXPECT(gbc.readMem(0xd83b), 0xd4);
        EXPECT(gbc.readMem(0xd83c), 0xaa);
        EXPECT(gbc.readMem(0xd83d), 0x74);
        // D4 00B9
        gbc.setState(0xdfc2, 0xfaa6, 0xc90, 0xb1c6, 0x802f, 0x2a83, 0x0, 0x1);
        gbc.writeMem(0xdfc2, { 0xd4, 0xd5, 0xc1 });
        gbc.step();
        EXPECT(gbc.a(),  0xc);
        EXPECT(gbc.b(),  0xb1);
        EXPECT(gbc.c(),  0xc6);
        EXPECT(gbc.d(),  0x80);
        EXPECT(gbc.e(),  0x2f);
        EXPECT(gbc.h(),  0x2a);
        EXPECT(gbc.l(),  0x83);
        EXPECT(gbc.sp(), 0xfaa6);
        EXPECT(gbc.pc(), 0xdfc5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xdfc2), 0xd4);
        EXPECT(gbc.readMem(0xdfc3), 0xd5);
        EXPECT(gbc.readMem(0xdfc4), 0xc1);
        // D4 00BA
        gbc.setState(0xd313, 0xd91d, 0x8c20, 0x52e1, 0x4add, 0x1887, 0x1, 0x0);
        gbc.writeMem(0xd313, { 0xd4, 0x90, 0xf1 });
        gbc.writeMem(0xd91b, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x8c);
        EXPECT(gbc.b(),  0x52);
        EXPECT(gbc.c(),  0xe1);
        EXPECT(gbc.d(),  0x4a);
        EXPECT(gbc.e(),  0xdd);
        EXPECT(gbc.h(),  0x18);
        EXPECT(gbc.l(),  0x87);
        EXPECT(gbc.sp(), 0xd91b);
        EXPECT(gbc.pc(), 0xf190);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd313), 0xd4);
        EXPECT(gbc.readMem(0xd314), 0x90);
        EXPECT(gbc.readMem(0xd315), 0xf1);
        EXPECT(gbc.readMem(0xd91b), 0x16);
        EXPECT(gbc.readMem(0xd91c), 0xd3);
        // D4 00BB
        gbc.setState(0x6ad, 0xea5a, 0xb780, 0xd05d, 0x56cd, 0x81f1, 0x1, 0x0);
        gbc.writeMem(0x6ad, { 0xd4, 0x30, 0xd2 });
        gbc.writeMem(0xea58, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xb7);
        EXPECT(gbc.b(),  0xd0);
        EXPECT(gbc.c(),  0x5d);
        EXPECT(gbc.d(),  0x56);
        EXPECT(gbc.e(),  0xcd);
        EXPECT(gbc.h(),  0x81);
        EXPECT(gbc.l(),  0xf1);
        EXPECT(gbc.sp(), 0xea58);
        EXPECT(gbc.pc(), 0xd230);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xea58), 0xb0);
        EXPECT(gbc.readMem(0xea59), 0x6);
        // D4 00BF
        gbc.setState(0xa9d6, 0x3004, 0x77d0, 0x2861, 0x974d, 0xa39d, 0x0, 0x0);
        gbc.writeMem(0xa9d6, { 0xd4, 0x96, 0xfe });
        gbc.step();
        EXPECT(gbc.a(),  0x77);
        EXPECT(gbc.b(),  0x28);
        EXPECT(gbc.c(),  0x61);
        EXPECT(gbc.d(),  0x97);
        EXPECT(gbc.e(),  0x4d);
        EXPECT(gbc.h(),  0xa3);
        EXPECT(gbc.l(),  0x9d);
        EXPECT(gbc.sp(), 0x3004);
        EXPECT(gbc.pc(), 0xa9d9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa9d6), 0xd4);
        EXPECT(gbc.readMem(0xa9d7), 0x96);
        EXPECT(gbc.readMem(0xa9d8), 0xfe);
        // D4 00C0
        gbc.setState(0x517b, 0xb536, 0x510, 0xf988, 0xbb80, 0xdb60, 0x0, 0x0);
        gbc.writeMem(0x517b, { 0xd4, 0xab, 0x52 });
        gbc.step();
        EXPECT(gbc.a(),  0x5);
        EXPECT(gbc.b(),  0xf9);
        EXPECT(gbc.c(),  0x88);
        EXPECT(gbc.d(),  0xbb);
        EXPECT(gbc.e(),  0x80);
        EXPECT(gbc.h(),  0xdb);
        EXPECT(gbc.l(),  0x60);
        EXPECT(gbc.sp(), 0xb536);
        EXPECT(gbc.pc(), 0x517e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 00C1
        gbc.setState(0x1328, 0x3b0d, 0xc010, 0x71c9, 0x4e1c, 0xd281, 0x1, 0x1);
        gbc.writeMem(0x1328, { 0xd4, 0x98, 0x54 });
        gbc.step();
        EXPECT(gbc.a(),  0xc0);
        EXPECT(gbc.b(),  0x71);
        EXPECT(gbc.c(),  0xc9);
        EXPECT(gbc.d(),  0x4e);
        EXPECT(gbc.e(),  0x1c);
        EXPECT(gbc.h(),  0xd2);
        EXPECT(gbc.l(),  0x81);
        EXPECT(gbc.sp(), 0x3b0d);
        EXPECT(gbc.pc(), 0x132b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 00C3
        gbc.setState(0xbf26, 0xdef6, 0x1a90, 0xd062, 0xc05d, 0xabe0, 0x0, 0x1);
        gbc.writeMem(0xbf26, { 0xd4, 0xce, 0x13 });
        gbc.step();
        EXPECT(gbc.a(),  0x1a);
        EXPECT(gbc.b(),  0xd0);
        EXPECT(gbc.c(),  0x62);
        EXPECT(gbc.d(),  0xc0);
        EXPECT(gbc.e(),  0x5d);
        EXPECT(gbc.h(),  0xab);
        EXPECT(gbc.l(),  0xe0);
        EXPECT(gbc.sp(), 0xdef6);
        EXPECT(gbc.pc(), 0xbf29);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbf26), 0xd4);
        EXPECT(gbc.readMem(0xbf27), 0xce);
        EXPECT(gbc.readMem(0xbf28), 0x13);
        // D4 00C4
        gbc.setState(0x4c4b, 0x3b31, 0xbdd0, 0x9834, 0x760a, 0x327f, 0x1, 0x0);
        gbc.writeMem(0x4c4b, { 0xd4, 0x42, 0x20 });
        gbc.step();
        EXPECT(gbc.a(),  0xbd);
        EXPECT(gbc.b(),  0x98);
        EXPECT(gbc.c(),  0x34);
        EXPECT(gbc.d(),  0x76);
        EXPECT(gbc.e(),  0xa);
        EXPECT(gbc.h(),  0x32);
        EXPECT(gbc.l(),  0x7f);
        EXPECT(gbc.sp(), 0x3b31);
        EXPECT(gbc.pc(), 0x4c4e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 00C6
        gbc.setState(0xcfd6, 0x92cf, 0xda00, 0xbaed, 0xb618, 0xfeac, 0x1, 0x0);
        gbc.writeMem(0x92cd, { 0x0, 0x0 });
        gbc.writeMem(0xcfd6, { 0xd4, 0x91, 0x5f });
        gbc.step();
        EXPECT(gbc.a(),  0xda);
        EXPECT(gbc.b(),  0xba);
        EXPECT(gbc.c(),  0xed);
        EXPECT(gbc.d(),  0xb6);
        EXPECT(gbc.e(),  0x18);
        EXPECT(gbc.h(),  0xfe);
        EXPECT(gbc.l(),  0xac);
        EXPECT(gbc.sp(), 0x92cd);
        EXPECT(gbc.pc(), 0x5f91);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x92cd), 0xd9);
        EXPECT(gbc.readMem(0x92ce), 0xcf);
        EXPECT(gbc.readMem(0xcfd6), 0xd4);
        EXPECT(gbc.readMem(0xcfd7), 0x91);
        EXPECT(gbc.readMem(0xcfd8), 0x5f);
        // D4 00C7
        gbc.setState(0xe8c1, 0xfea1, 0xbf30, 0x735b, 0x1c3a, 0x4851, 0x1, 0x0);
        gbc.writeMem(0xe8c1, { 0xd4, 0xa7, 0xa5 });
        gbc.step();
        EXPECT(gbc.a(),  0xbf);
        EXPECT(gbc.b(),  0x73);
        EXPECT(gbc.c(),  0x5b);
        EXPECT(gbc.d(),  0x1c);
        EXPECT(gbc.e(),  0x3a);
        EXPECT(gbc.h(),  0x48);
        EXPECT(gbc.l(),  0x51);
        EXPECT(gbc.sp(), 0xfea1);
        EXPECT(gbc.pc(), 0xe8c4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe8c1), 0xd4);
        EXPECT(gbc.readMem(0xe8c2), 0xa7);
        EXPECT(gbc.readMem(0xe8c3), 0xa5);
        // D4 00C8
        gbc.setState(0x90e8, 0xa890, 0xff10, 0x3e50, 0x901d, 0xe5e3, 0x0, 0x1);
        gbc.writeMem(0x90e8, { 0xd4, 0xc7, 0x35 });
        gbc.step();
        EXPECT(gbc.a(),  0xff);
        EXPECT(gbc.b(),  0x3e);
        EXPECT(gbc.c(),  0x50);
        EXPECT(gbc.d(),  0x90);
        EXPECT(gbc.e(),  0x1d);
        EXPECT(gbc.h(),  0xe5);
        EXPECT(gbc.l(),  0xe3);
        EXPECT(gbc.sp(), 0xa890);
        EXPECT(gbc.pc(), 0x90eb);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x90e8), 0xd4);
        EXPECT(gbc.readMem(0x90e9), 0xc7);
        EXPECT(gbc.readMem(0x90ea), 0x35);
        // D4 00C9
        gbc.setState(0x33dc, 0xadf1, 0xf370, 0x952e, 0x23c0, 0x24bb, 0x0, 0x1);
        gbc.writeMem(0x33dc, { 0xd4, 0xa, 0xa0 });
        gbc.step();
        EXPECT(gbc.a(),  0xf3);
        EXPECT(gbc.b(),  0x95);
        EXPECT(gbc.c(),  0x2e);
        EXPECT(gbc.d(),  0x23);
        EXPECT(gbc.e(),  0xc0);
        EXPECT(gbc.h(),  0x24);
        EXPECT(gbc.l(),  0xbb);
        EXPECT(gbc.sp(), 0xadf1);
        EXPECT(gbc.pc(), 0x33df);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 00CA
        gbc.setState(0x9e00, 0xcc58, 0x7e70, 0x1b7c, 0x59b1, 0xcd4f, 0x1, 0x0);
        gbc.writeMem(0x9e00, { 0xd4, 0xd, 0x52 });
        gbc.step();
        EXPECT(gbc.a(),  0x7e);
        EXPECT(gbc.b(),  0x1b);
        EXPECT(gbc.c(),  0x7c);
        EXPECT(gbc.d(),  0x59);
        EXPECT(gbc.e(),  0xb1);
        EXPECT(gbc.h(),  0xcd);
        EXPECT(gbc.l(),  0x4f);
        EXPECT(gbc.sp(), 0xcc58);
        EXPECT(gbc.pc(), 0x9e03);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9e00), 0xd4);
        EXPECT(gbc.readMem(0x9e01), 0xd);
        EXPECT(gbc.readMem(0x9e02), 0x52);
        // D4 00CB
        gbc.setState(0xa330, 0xcfb5, 0x24e0, 0xb53d, 0x91f7, 0x31ba, 0x1, 0x1);
        gbc.writeMem(0xa330, { 0xd4, 0x4c, 0xc4 });
        gbc.writeMem(0xcfb3, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x24);
        EXPECT(gbc.b(),  0xb5);
        EXPECT(gbc.c(),  0x3d);
        EXPECT(gbc.d(),  0x91);
        EXPECT(gbc.e(),  0xf7);
        EXPECT(gbc.h(),  0x31);
        EXPECT(gbc.l(),  0xba);
        EXPECT(gbc.sp(), 0xcfb3);
        EXPECT(gbc.pc(), 0xc44c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa330), 0xd4);
        EXPECT(gbc.readMem(0xa331), 0x4c);
        EXPECT(gbc.readMem(0xa332), 0xc4);
        EXPECT(gbc.readMem(0xcfb3), 0x33);
        EXPECT(gbc.readMem(0xcfb4), 0xa3);
        // D4 00CC
        gbc.setState(0x6625, 0x1726, 0xb50, 0xd754, 0x96e6, 0xe8bc, 0x1, 0x1);
        gbc.writeMem(0x6625, { 0xd4, 0xe2, 0x2f });
        gbc.step();
        EXPECT(gbc.a(),  0xb);
        EXPECT(gbc.b(),  0xd7);
        EXPECT(gbc.c(),  0x54);
        EXPECT(gbc.d(),  0x96);
        EXPECT(gbc.e(),  0xe6);
        EXPECT(gbc.h(),  0xe8);
        EXPECT(gbc.l(),  0xbc);
        EXPECT(gbc.sp(), 0x1726);
        EXPECT(gbc.pc(), 0x6628);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 00CF
        gbc.setState(0x36c, 0xed8e, 0xd460, 0x50e, 0xe24f, 0x7874, 0x0, 0x1);
        gbc.writeMem(0x36c, { 0xd4, 0xe, 0xaf });
        gbc.writeMem(0xed8c, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xd4);
        EXPECT(gbc.b(),  0x5);
        EXPECT(gbc.c(),  0xe);
        EXPECT(gbc.d(),  0xe2);
        EXPECT(gbc.e(),  0x4f);
        EXPECT(gbc.h(),  0x78);
        EXPECT(gbc.l(),  0x74);
        EXPECT(gbc.sp(), 0xed8c);
        EXPECT(gbc.pc(), 0xaf0e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xed8c), 0x6f);
        EXPECT(gbc.readMem(0xed8d), 0x3);
        // D4 00D2
        gbc.setState(0x92f4, 0x2460, 0xe270, 0x17d3, 0x92a8, 0x5856, 0x1, 0x0);
        gbc.writeMem(0x92f4, { 0xd4, 0x3d, 0x3c });
        gbc.step();
        EXPECT(gbc.a(),  0xe2);
        EXPECT(gbc.b(),  0x17);
        EXPECT(gbc.c(),  0xd3);
        EXPECT(gbc.d(),  0x92);
        EXPECT(gbc.e(),  0xa8);
        EXPECT(gbc.h(),  0x58);
        EXPECT(gbc.l(),  0x56);
        EXPECT(gbc.sp(), 0x2460);
        EXPECT(gbc.pc(), 0x92f7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x92f4), 0xd4);
        EXPECT(gbc.readMem(0x92f5), 0x3d);
        EXPECT(gbc.readMem(0x92f6), 0x3c);
        // D4 00D4
        gbc.setState(0x6e51, 0x99a5, 0x8b60, 0x64ef, 0xfb6a, 0xda52, 0x0, 0x0);
        gbc.writeMem(0x6e51, { 0xd4, 0xb1, 0x7a });
        gbc.writeMem(0x99a3, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x8b);
        EXPECT(gbc.b(),  0x64);
        EXPECT(gbc.c(),  0xef);
        EXPECT(gbc.d(),  0xfb);
        EXPECT(gbc.e(),  0x6a);
        EXPECT(gbc.h(),  0xda);
        EXPECT(gbc.l(),  0x52);
        EXPECT(gbc.sp(), 0x99a3);
        EXPECT(gbc.pc(), 0x7ab1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x99a3), 0x54);
        EXPECT(gbc.readMem(0x99a4), 0x6e);
        // D4 00D6
        gbc.setState(0x9236, 0xbe7b, 0x6f0, 0xe1e4, 0x6702, 0x3749, 0x0, 0x1);
        gbc.writeMem(0x9236, { 0xd4, 0x52, 0xfe });
        gbc.step();
        EXPECT(gbc.a(),  0x6);
        EXPECT(gbc.b(),  0xe1);
        EXPECT(gbc.c(),  0xe4);
        EXPECT(gbc.d(),  0x67);
        EXPECT(gbc.e(),  0x2);
        EXPECT(gbc.h(),  0x37);
        EXPECT(gbc.l(),  0x49);
        EXPECT(gbc.sp(), 0xbe7b);
        EXPECT(gbc.pc(), 0x9239);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9236), 0xd4);
        EXPECT(gbc.readMem(0x9237), 0x52);
        EXPECT(gbc.readMem(0x9238), 0xfe);
        // D4 00D9
        gbc.setState(0x25e3, 0xe8b2, 0x17a0, 0x7cc4, 0x5a74, 0x8f3d, 0x0, 0x0);
        gbc.writeMem(0x25e3, { 0xd4, 0x27, 0xa3 });
        gbc.writeMem(0xe8b0, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x17);
        EXPECT(gbc.b(),  0x7c);
        EXPECT(gbc.c(),  0xc4);
        EXPECT(gbc.d(),  0x5a);
        EXPECT(gbc.e(),  0x74);
        EXPECT(gbc.h(),  0x8f);
        EXPECT(gbc.l(),  0x3d);
        EXPECT(gbc.sp(), 0xe8b0);
        EXPECT(gbc.pc(), 0xa327);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe8b0), 0xe6);
        EXPECT(gbc.readMem(0xe8b1), 0x25);
        // D4 00DA
        gbc.setState(0x1f6a, 0xb1ef, 0xc200, 0xddf2, 0x9f38, 0x96e0, 0x1, 0x0);
        gbc.writeMem(0x1f6a, { 0xd4, 0x58, 0x5b });
        gbc.writeMem(0xb1ed, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xc2);
        EXPECT(gbc.b(),  0xdd);
        EXPECT(gbc.c(),  0xf2);
        EXPECT(gbc.d(),  0x9f);
        EXPECT(gbc.e(),  0x38);
        EXPECT(gbc.h(),  0x96);
        EXPECT(gbc.l(),  0xe0);
        EXPECT(gbc.sp(), 0xb1ed);
        EXPECT(gbc.pc(), 0x5b58);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb1ed), 0x6d);
        EXPECT(gbc.readMem(0xb1ee), 0x1f);
        // D4 00DB
        gbc.setState(0x78de, 0x7baf, 0x990, 0xe050, 0x7790, 0x4ca, 0x1, 0x0);
        gbc.writeMem(0x78de, { 0xd4, 0x12, 0x7 });
        gbc.step();
        EXPECT(gbc.a(),  0x9);
        EXPECT(gbc.b(),  0xe0);
        EXPECT(gbc.c(),  0x50);
        EXPECT(gbc.d(),  0x77);
        EXPECT(gbc.e(),  0x90);
        EXPECT(gbc.h(),  0x4);
        EXPECT(gbc.l(),  0xca);
        EXPECT(gbc.sp(), 0x7baf);
        EXPECT(gbc.pc(), 0x78e1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 00DF
        gbc.setState(0x8b44, 0x77c, 0xf9d0, 0x20be, 0x820e, 0x884a, 0x1, 0x0);
        gbc.writeMem(0x8b44, { 0xd4, 0xb5, 0x45 });
        gbc.step();
        EXPECT(gbc.a(),  0xf9);
        EXPECT(gbc.b(),  0x20);
        EXPECT(gbc.c(),  0xbe);
        EXPECT(gbc.d(),  0x82);
        EXPECT(gbc.e(),  0xe);
        EXPECT(gbc.h(),  0x88);
        EXPECT(gbc.l(),  0x4a);
        EXPECT(gbc.sp(), 0x77c);
        EXPECT(gbc.pc(), 0x8b47);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8b44), 0xd4);
        EXPECT(gbc.readMem(0x8b45), 0xb5);
        EXPECT(gbc.readMem(0x8b46), 0x45);
        // D4 00E0
        gbc.setState(0x40f2, 0xfb03, 0x6070, 0xad8b, 0x228a, 0x7421, 0x1, 0x0);
        gbc.writeMem(0x40f2, { 0xd4, 0x43, 0x5d });
        gbc.step();
        EXPECT(gbc.a(),  0x60);
        EXPECT(gbc.b(),  0xad);
        EXPECT(gbc.c(),  0x8b);
        EXPECT(gbc.d(),  0x22);
        EXPECT(gbc.e(),  0x8a);
        EXPECT(gbc.h(),  0x74);
        EXPECT(gbc.l(),  0x21);
        EXPECT(gbc.sp(), 0xfb03);
        EXPECT(gbc.pc(), 0x40f5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 00E1
        gbc.setState(0x86f0, 0xd49d, 0x2740, 0xee38, 0x7ffb, 0x5192, 0x1, 0x1);
        gbc.writeMem(0x86f0, { 0xd4, 0xb, 0x5d });
        gbc.writeMem(0xd49b, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x27);
        EXPECT(gbc.b(),  0xee);
        EXPECT(gbc.c(),  0x38);
        EXPECT(gbc.d(),  0x7f);
        EXPECT(gbc.e(),  0xfb);
        EXPECT(gbc.h(),  0x51);
        EXPECT(gbc.l(),  0x92);
        EXPECT(gbc.sp(), 0xd49b);
        EXPECT(gbc.pc(), 0x5d0b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x86f0), 0xd4);
        EXPECT(gbc.readMem(0x86f1), 0xb);
        EXPECT(gbc.readMem(0x86f2), 0x5d);
        EXPECT(gbc.readMem(0xd49b), 0xf3);
        EXPECT(gbc.readMem(0xd49c), 0x86);
        // D4 00E3
        gbc.setState(0xd03a, 0xbe3e, 0x7070, 0x1307, 0x3328, 0xdc7, 0x1, 0x0);
        gbc.writeMem(0xd03a, { 0xd4, 0x51, 0x5 });
        gbc.step();
        EXPECT(gbc.a(),  0x70);
        EXPECT(gbc.b(),  0x13);
        EXPECT(gbc.c(),  0x7);
        EXPECT(gbc.d(),  0x33);
        EXPECT(gbc.e(),  0x28);
        EXPECT(gbc.h(),  0xd);
        EXPECT(gbc.l(),  0xc7);
        EXPECT(gbc.sp(), 0xbe3e);
        EXPECT(gbc.pc(), 0xd03d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd03a), 0xd4);
        EXPECT(gbc.readMem(0xd03b), 0x51);
        EXPECT(gbc.readMem(0xd03c), 0x5);
        // D4 00E5
        gbc.setState(0x5d1e, 0xaaaa, 0xa9b0, 0x6d4b, 0x539d, 0x725b, 0x1, 0x0);
        gbc.writeMem(0x5d1e, { 0xd4, 0xe1, 0x58 });
        gbc.step();
        EXPECT(gbc.a(),  0xa9);
        EXPECT(gbc.b(),  0x6d);
        EXPECT(gbc.c(),  0x4b);
        EXPECT(gbc.d(),  0x53);
        EXPECT(gbc.e(),  0x9d);
        EXPECT(gbc.h(),  0x72);
        EXPECT(gbc.l(),  0x5b);
        EXPECT(gbc.sp(), 0xaaaa);
        EXPECT(gbc.pc(), 0x5d21);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 00E6
        gbc.setState(0xe51f, 0xba39, 0xfd60, 0x55dc, 0xe0d2, 0xf9e7, 0x0, 0x1);
        gbc.writeMem(0xba37, { 0x0, 0x0 });
        gbc.writeMem(0xe51f, { 0xd4, 0x1, 0x7b });
        gbc.step();
        EXPECT(gbc.a(),  0xfd);
        EXPECT(gbc.b(),  0x55);
        EXPECT(gbc.c(),  0xdc);
        EXPECT(gbc.d(),  0xe0);
        EXPECT(gbc.e(),  0xd2);
        EXPECT(gbc.h(),  0xf9);
        EXPECT(gbc.l(),  0xe7);
        EXPECT(gbc.sp(), 0xba37);
        EXPECT(gbc.pc(), 0x7b01);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xba37), 0x22);
        EXPECT(gbc.readMem(0xba38), 0xe5);
        EXPECT(gbc.readMem(0xe51f), 0xd4);
        EXPECT(gbc.readMem(0xe520), 0x1);
        EXPECT(gbc.readMem(0xe521), 0x7b);
        // D4 00E7
        gbc.setState(0x8107, 0x9215, 0x420, 0xbe11, 0xefdc, 0xb3c2, 0x0, 0x0);
        gbc.writeMem(0x8107, { 0xd4, 0xa2, 0xae });
        gbc.writeMem(0x9213, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0xbe);
        EXPECT(gbc.c(),  0x11);
        EXPECT(gbc.d(),  0xef);
        EXPECT(gbc.e(),  0xdc);
        EXPECT(gbc.h(),  0xb3);
        EXPECT(gbc.l(),  0xc2);
        EXPECT(gbc.sp(), 0x9213);
        EXPECT(gbc.pc(), 0xaea2);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8107), 0xd4);
        EXPECT(gbc.readMem(0x8108), 0xa2);
        EXPECT(gbc.readMem(0x8109), 0xae);
        EXPECT(gbc.readMem(0x9213), 0xa);
        EXPECT(gbc.readMem(0x9214), 0x81);
        // D4 00E8
        gbc.setState(0x6bc7, 0xbc0b, 0x7d50, 0xf60a, 0x31ad, 0x34, 0x0, 0x0);
        gbc.writeMem(0x6bc7, { 0xd4, 0x58, 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x7d);
        EXPECT(gbc.b(),  0xf6);
        EXPECT(gbc.c(),  0xa);
        EXPECT(gbc.d(),  0x31);
        EXPECT(gbc.e(),  0xad);
        EXPECT(gbc.h(),  0x0);
        EXPECT(gbc.l(),  0x34);
        EXPECT(gbc.sp(), 0xbc0b);
        EXPECT(gbc.pc(), 0x6bca);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 00E9
        gbc.setState(0x473a, 0x3570, 0xdcb0, 0xc22f, 0x45e, 0x664e, 0x1, 0x1);
        gbc.writeMem(0x473a, { 0xd4, 0x2, 0x61 });
        gbc.step();
        EXPECT(gbc.a(),  0xdc);
        EXPECT(gbc.b(),  0xc2);
        EXPECT(gbc.c(),  0x2f);
        EXPECT(gbc.d(),  0x4);
        EXPECT(gbc.e(),  0x5e);
        EXPECT(gbc.h(),  0x66);
        EXPECT(gbc.l(),  0x4e);
        EXPECT(gbc.sp(), 0x3570);
        EXPECT(gbc.pc(), 0x473d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 00EA
        gbc.setState(0x724f, 0xf79e, 0x4e50, 0xc167, 0x2db6, 0x82bb, 0x1, 0x0);
        gbc.writeMem(0x724f, { 0xd4, 0xb9, 0xaa });
        gbc.step();
        EXPECT(gbc.a(),  0x4e);
        EXPECT(gbc.b(),  0xc1);
        EXPECT(gbc.c(),  0x67);
        EXPECT(gbc.d(),  0x2d);
        EXPECT(gbc.e(),  0xb6);
        EXPECT(gbc.h(),  0x82);
        EXPECT(gbc.l(),  0xbb);
        EXPECT(gbc.sp(), 0xf79e);
        EXPECT(gbc.pc(), 0x7252);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 00EC
        gbc.setState(0x4785, 0xba41, 0x4830, 0x7ad1, 0x150b, 0x89c5, 0x0, 0x1);
        gbc.writeMem(0x4785, { 0xd4, 0xe2, 0xb2 });
        gbc.step();
        EXPECT(gbc.a(),  0x48);
        EXPECT(gbc.b(),  0x7a);
        EXPECT(gbc.c(),  0xd1);
        EXPECT(gbc.d(),  0x15);
        EXPECT(gbc.e(),  0xb);
        EXPECT(gbc.h(),  0x89);
        EXPECT(gbc.l(),  0xc5);
        EXPECT(gbc.sp(), 0xba41);
        EXPECT(gbc.pc(), 0x4788);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 00ED
        gbc.setState(0x91d5, 0xb178, 0xf3d0, 0xfdce, 0x5553, 0xc8c1, 0x0, 0x1);
        gbc.writeMem(0x91d5, { 0xd4, 0x65, 0xc5 });
        gbc.step();
        EXPECT(gbc.a(),  0xf3);
        EXPECT(gbc.b(),  0xfd);
        EXPECT(gbc.c(),  0xce);
        EXPECT(gbc.d(),  0x55);
        EXPECT(gbc.e(),  0x53);
        EXPECT(gbc.h(),  0xc8);
        EXPECT(gbc.l(),  0xc1);
        EXPECT(gbc.sp(), 0xb178);
        EXPECT(gbc.pc(), 0x91d8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x91d5), 0xd4);
        EXPECT(gbc.readMem(0x91d6), 0x65);
        EXPECT(gbc.readMem(0x91d7), 0xc5);
        // D4 00EE
        gbc.setState(0x3099, 0xc4a2, 0xb3c0, 0xf3ae, 0xdb72, 0x4b68, 0x1, 0x0);
        gbc.writeMem(0x3099, { 0xd4, 0xd5, 0x1f });
        gbc.writeMem(0xc4a0, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xb3);
        EXPECT(gbc.b(),  0xf3);
        EXPECT(gbc.c(),  0xae);
        EXPECT(gbc.d(),  0xdb);
        EXPECT(gbc.e(),  0x72);
        EXPECT(gbc.h(),  0x4b);
        EXPECT(gbc.l(),  0x68);
        EXPECT(gbc.sp(), 0xc4a0);
        EXPECT(gbc.pc(), 0x1fd5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc4a0), 0x9c);
        EXPECT(gbc.readMem(0xc4a1), 0x30);
        // D4 00F1
        gbc.setState(0x9b21, 0xd864, 0x2610, 0x8d31, 0xeab3, 0x5d0, 0x0, 0x0);
        gbc.writeMem(0x9b21, { 0xd4, 0x57, 0x92 });
        gbc.step();
        EXPECT(gbc.a(),  0x26);
        EXPECT(gbc.b(),  0x8d);
        EXPECT(gbc.c(),  0x31);
        EXPECT(gbc.d(),  0xea);
        EXPECT(gbc.e(),  0xb3);
        EXPECT(gbc.h(),  0x5);
        EXPECT(gbc.l(),  0xd0);
        EXPECT(gbc.sp(), 0xd864);
        EXPECT(gbc.pc(), 0x9b24);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9b21), 0xd4);
        EXPECT(gbc.readMem(0x9b22), 0x57);
        EXPECT(gbc.readMem(0x9b23), 0x92);
        // D4 00F2
        gbc.setState(0xb9bb, 0x2026, 0xf910, 0x532, 0x64a3, 0x6371, 0x0, 0x0);
        gbc.writeMem(0xb9bb, { 0xd4, 0x71, 0x66 });
        gbc.step();
        EXPECT(gbc.a(),  0xf9);
        EXPECT(gbc.b(),  0x5);
        EXPECT(gbc.c(),  0x32);
        EXPECT(gbc.d(),  0x64);
        EXPECT(gbc.e(),  0xa3);
        EXPECT(gbc.h(),  0x63);
        EXPECT(gbc.l(),  0x71);
        EXPECT(gbc.sp(), 0x2026);
        EXPECT(gbc.pc(), 0xb9be);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb9bb), 0xd4);
        EXPECT(gbc.readMem(0xb9bc), 0x71);
        EXPECT(gbc.readMem(0xb9bd), 0x66);
        // D4 00F3
        gbc.setState(0xe822, 0x2d02, 0x24b0, 0xc9d1, 0x2e7c, 0x9055, 0x1, 0x0);
        gbc.writeMem(0xe822, { 0xd4, 0x86, 0x9b });
        gbc.step();
        EXPECT(gbc.a(),  0x24);
        EXPECT(gbc.b(),  0xc9);
        EXPECT(gbc.c(),  0xd1);
        EXPECT(gbc.d(),  0x2e);
        EXPECT(gbc.e(),  0x7c);
        EXPECT(gbc.h(),  0x90);
        EXPECT(gbc.l(),  0x55);
        EXPECT(gbc.sp(), 0x2d02);
        EXPECT(gbc.pc(), 0xe825);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe822), 0xd4);
        EXPECT(gbc.readMem(0xe823), 0x86);
        EXPECT(gbc.readMem(0xe824), 0x9b);
        // D4 00F6
        gbc.setState(0xaab3, 0xfc00, 0xa4d0, 0x1f72, 0x407a, 0xa2eb, 0x0, 0x0);
        gbc.writeMem(0xaab3, { 0xd4, 0x7e, 0xa9 });
        gbc.step();
        EXPECT(gbc.a(),  0xa4);
        EXPECT(gbc.b(),  0x1f);
        EXPECT(gbc.c(),  0x72);
        EXPECT(gbc.d(),  0x40);
        EXPECT(gbc.e(),  0x7a);
        EXPECT(gbc.h(),  0xa2);
        EXPECT(gbc.l(),  0xeb);
        EXPECT(gbc.sp(), 0xfc00);
        EXPECT(gbc.pc(), 0xaab6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xaab3), 0xd4);
        EXPECT(gbc.readMem(0xaab4), 0x7e);
        EXPECT(gbc.readMem(0xaab5), 0xa9);
        // D4 00F7
        gbc.setState(0x30fb, 0x7c40, 0xaf10, 0x9fcc, 0x9b82, 0x4889, 0x1, 0x1);
        gbc.writeMem(0x30fb, { 0xd4, 0xa6, 0x5f });
        gbc.step();
        EXPECT(gbc.a(),  0xaf);
        EXPECT(gbc.b(),  0x9f);
        EXPECT(gbc.c(),  0xcc);
        EXPECT(gbc.d(),  0x9b);
        EXPECT(gbc.e(),  0x82);
        EXPECT(gbc.h(),  0x48);
        EXPECT(gbc.l(),  0x89);
        EXPECT(gbc.sp(), 0x7c40);
        EXPECT(gbc.pc(), 0x30fe);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 00F8
        gbc.setState(0x95d1, 0xbaee, 0x1d30, 0x2cfb, 0x8f42, 0xcca1, 0x1, 0x1);
        gbc.writeMem(0x95d1, { 0xd4, 0xc5, 0x6f });
        gbc.step();
        EXPECT(gbc.a(),  0x1d);
        EXPECT(gbc.b(),  0x2c);
        EXPECT(gbc.c(),  0xfb);
        EXPECT(gbc.d(),  0x8f);
        EXPECT(gbc.e(),  0x42);
        EXPECT(gbc.h(),  0xcc);
        EXPECT(gbc.l(),  0xa1);
        EXPECT(gbc.sp(), 0xbaee);
        EXPECT(gbc.pc(), 0x95d4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x95d1), 0xd4);
        EXPECT(gbc.readMem(0x95d2), 0xc5);
        EXPECT(gbc.readMem(0x95d3), 0x6f);
        // D4 00F9
        gbc.setState(0xe67b, 0xe931, 0x3660, 0xdc79, 0x4f1d, 0x578, 0x0, 0x1);
        gbc.writeMem(0xe67b, { 0xd4, 0xbc, 0x67 });
        gbc.writeMem(0xe92f, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x36);
        EXPECT(gbc.b(),  0xdc);
        EXPECT(gbc.c(),  0x79);
        EXPECT(gbc.d(),  0x4f);
        EXPECT(gbc.e(),  0x1d);
        EXPECT(gbc.h(),  0x5);
        EXPECT(gbc.l(),  0x78);
        EXPECT(gbc.sp(), 0xe92f);
        EXPECT(gbc.pc(), 0x67bc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe67b), 0xd4);
        EXPECT(gbc.readMem(0xe67c), 0xbc);
        EXPECT(gbc.readMem(0xe67d), 0x67);
        EXPECT(gbc.readMem(0xe92f), 0x7e);
        EXPECT(gbc.readMem(0xe930), 0xe6);
        // D4 00FA
        gbc.setState(0x34cb, 0xdbc8, 0xbd80, 0x20d, 0x41bc, 0x8fbf, 0x1, 0x0);
        gbc.writeMem(0x34cb, { 0xd4, 0xbb, 0x65 });
        gbc.writeMem(0xdbc6, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xbd);
        EXPECT(gbc.b(),  0x2);
        EXPECT(gbc.c(),  0xd);
        EXPECT(gbc.d(),  0x41);
        EXPECT(gbc.e(),  0xbc);
        EXPECT(gbc.h(),  0x8f);
        EXPECT(gbc.l(),  0xbf);
        EXPECT(gbc.sp(), 0xdbc6);
        EXPECT(gbc.pc(), 0x65bb);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdbc6), 0xce);
        EXPECT(gbc.readMem(0xdbc7), 0x34);
        // D4 00FB
        gbc.setState(0x5746, 0x52a6, 0xf290, 0x3890, 0x370, 0x53aa, 0x1, 0x1);
        gbc.writeMem(0x5746, { 0xd4, 0x10, 0x50 });
        gbc.step();
        EXPECT(gbc.a(),  0xf2);
        EXPECT(gbc.b(),  0x38);
        EXPECT(gbc.c(),  0x90);
        EXPECT(gbc.d(),  0x3);
        EXPECT(gbc.e(),  0x70);
        EXPECT(gbc.h(),  0x53);
        EXPECT(gbc.l(),  0xaa);
        EXPECT(gbc.sp(), 0x52a6);
        EXPECT(gbc.pc(), 0x5749);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 00FD
        gbc.setState(0x74e8, 0x1e28, 0x2890, 0x27a9, 0xe89c, 0x80dd, 0x0, 0x0);
        gbc.writeMem(0x74e8, { 0xd4, 0xf3, 0x71 });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0x27);
        EXPECT(gbc.c(),  0xa9);
        EXPECT(gbc.d(),  0xe8);
        EXPECT(gbc.e(),  0x9c);
        EXPECT(gbc.h(),  0x80);
        EXPECT(gbc.l(),  0xdd);
        EXPECT(gbc.sp(), 0x1e28);
        EXPECT(gbc.pc(), 0x74eb);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 00FF
        gbc.setState(0xc76, 0x171b, 0xf770, 0x6c8b, 0x1c1b, 0xd5e4, 0x0, 0x0);
        gbc.writeMem(0xc76, { 0xd4, 0x75, 0x86 });
        gbc.step();
        EXPECT(gbc.a(),  0xf7);
        EXPECT(gbc.b(),  0x6c);
        EXPECT(gbc.c(),  0x8b);
        EXPECT(gbc.d(),  0x1c);
        EXPECT(gbc.e(),  0x1b);
        EXPECT(gbc.h(),  0xd5);
        EXPECT(gbc.l(),  0xe4);
        EXPECT(gbc.sp(), 0x171b);
        EXPECT(gbc.pc(), 0xc79);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0100
        gbc.setState(0xcb76, 0xaedf, 0x54e0, 0xc192, 0x36c4, 0xe7dd, 0x0, 0x1);
        gbc.writeMem(0xaedd, { 0x0, 0x0 });
        gbc.writeMem(0xcb76, { 0xd4, 0x43, 0xc });
        gbc.step();
        EXPECT(gbc.a(),  0x54);
        EXPECT(gbc.b(),  0xc1);
        EXPECT(gbc.c(),  0x92);
        EXPECT(gbc.d(),  0x36);
        EXPECT(gbc.e(),  0xc4);
        EXPECT(gbc.h(),  0xe7);
        EXPECT(gbc.l(),  0xdd);
        EXPECT(gbc.sp(), 0xaedd);
        EXPECT(gbc.pc(), 0xc43);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xaedd), 0x79);
        EXPECT(gbc.readMem(0xaede), 0xcb);
        EXPECT(gbc.readMem(0xcb76), 0xd4);
        EXPECT(gbc.readMem(0xcb77), 0x43);
        EXPECT(gbc.readMem(0xcb78), 0xc);
        // D4 0101
        gbc.setState(0xc211, 0xdb96, 0xf820, 0x5b33, 0xe4e1, 0xc6e0, 0x1, 0x0);
        gbc.writeMem(0xc211, { 0xd4, 0xa9, 0xec });
        gbc.writeMem(0xdb94, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xf8);
        EXPECT(gbc.b(),  0x5b);
        EXPECT(gbc.c(),  0x33);
        EXPECT(gbc.d(),  0xe4);
        EXPECT(gbc.e(),  0xe1);
        EXPECT(gbc.h(),  0xc6);
        EXPECT(gbc.l(),  0xe0);
        EXPECT(gbc.sp(), 0xdb94);
        EXPECT(gbc.pc(), 0xeca9);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc211), 0xd4);
        EXPECT(gbc.readMem(0xc212), 0xa9);
        EXPECT(gbc.readMem(0xc213), 0xec);
        EXPECT(gbc.readMem(0xdb94), 0x14);
        EXPECT(gbc.readMem(0xdb95), 0xc2);
        // D4 0102
        gbc.setState(0x5db9, 0xeba4, 0xda10, 0x875f, 0x933, 0x8cbb, 0x1, 0x0);
        gbc.writeMem(0x5db9, { 0xd4, 0xd0, 0xfb });
        gbc.step();
        EXPECT(gbc.a(),  0xda);
        EXPECT(gbc.b(),  0x87);
        EXPECT(gbc.c(),  0x5f);
        EXPECT(gbc.d(),  0x9);
        EXPECT(gbc.e(),  0x33);
        EXPECT(gbc.h(),  0x8c);
        EXPECT(gbc.l(),  0xbb);
        EXPECT(gbc.sp(), 0xeba4);
        EXPECT(gbc.pc(), 0x5dbc);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0104
        gbc.setState(0x59af, 0x6259, 0x4610, 0x278c, 0x4450, 0x3ab7, 0x1, 0x0);
        gbc.writeMem(0x59af, { 0xd4, 0x97, 0xc });
        gbc.step();
        EXPECT(gbc.a(),  0x46);
        EXPECT(gbc.b(),  0x27);
        EXPECT(gbc.c(),  0x8c);
        EXPECT(gbc.d(),  0x44);
        EXPECT(gbc.e(),  0x50);
        EXPECT(gbc.h(),  0x3a);
        EXPECT(gbc.l(),  0xb7);
        EXPECT(gbc.sp(), 0x6259);
        EXPECT(gbc.pc(), 0x59b2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0105
        gbc.setState(0x64b3, 0xa365, 0xf120, 0xc4c4, 0xab25, 0xb558, 0x0, 0x1);
        gbc.writeMem(0x64b3, { 0xd4, 0x50, 0xaf });
        gbc.writeMem(0xa363, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xf1);
        EXPECT(gbc.b(),  0xc4);
        EXPECT(gbc.c(),  0xc4);
        EXPECT(gbc.d(),  0xab);
        EXPECT(gbc.e(),  0x25);
        EXPECT(gbc.h(),  0xb5);
        EXPECT(gbc.l(),  0x58);
        EXPECT(gbc.sp(), 0xa363);
        EXPECT(gbc.pc(), 0xaf50);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa363), 0xb6);
        EXPECT(gbc.readMem(0xa364), 0x64);
        // D4 0106
        gbc.setState(0xde93, 0x62d3, 0xb050, 0x1847, 0xee37, 0x516d, 0x1, 0x1);
        gbc.writeMem(0xde93, { 0xd4, 0x4f, 0xff });
        gbc.step();
        EXPECT(gbc.a(),  0xb0);
        EXPECT(gbc.b(),  0x18);
        EXPECT(gbc.c(),  0x47);
        EXPECT(gbc.d(),  0xee);
        EXPECT(gbc.e(),  0x37);
        EXPECT(gbc.h(),  0x51);
        EXPECT(gbc.l(),  0x6d);
        EXPECT(gbc.sp(), 0x62d3);
        EXPECT(gbc.pc(), 0xde96);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xde93), 0xd4);
        EXPECT(gbc.readMem(0xde94), 0x4f);
        EXPECT(gbc.readMem(0xde95), 0xff);
        // D4 0107
        gbc.setState(0xcaaf, 0xfab8, 0x50, 0xeb79, 0xfa9e, 0x6a98, 0x1, 0x0);
        gbc.writeMem(0xcaaf, { 0xd4, 0x30, 0x8f });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0xeb);
        EXPECT(gbc.c(),  0x79);
        EXPECT(gbc.d(),  0xfa);
        EXPECT(gbc.e(),  0x9e);
        EXPECT(gbc.h(),  0x6a);
        EXPECT(gbc.l(),  0x98);
        EXPECT(gbc.sp(), 0xfab8);
        EXPECT(gbc.pc(), 0xcab2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcaaf), 0xd4);
        EXPECT(gbc.readMem(0xcab0), 0x30);
        EXPECT(gbc.readMem(0xcab1), 0x8f);
        // D4 0108
        gbc.setState(0x57e3, 0xdeb7, 0x6b50, 0x66bc, 0x9f8a, 0xbf3, 0x0, 0x1);
        gbc.writeMem(0x57e3, { 0xd4, 0xf4, 0xfc });
        gbc.step();
        EXPECT(gbc.a(),  0x6b);
        EXPECT(gbc.b(),  0x66);
        EXPECT(gbc.c(),  0xbc);
        EXPECT(gbc.d(),  0x9f);
        EXPECT(gbc.e(),  0x8a);
        EXPECT(gbc.h(),  0xb);
        EXPECT(gbc.l(),  0xf3);
        EXPECT(gbc.sp(), 0xdeb7);
        EXPECT(gbc.pc(), 0x57e6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0109
        gbc.setState(0x3d2d, 0x1508, 0xab0, 0x766b, 0x9468, 0x9b1f, 0x0, 0x0);
        gbc.writeMem(0x3d2d, { 0xd4, 0x68, 0x42 });
        gbc.step();
        EXPECT(gbc.a(),  0xa);
        EXPECT(gbc.b(),  0x76);
        EXPECT(gbc.c(),  0x6b);
        EXPECT(gbc.d(),  0x94);
        EXPECT(gbc.e(),  0x68);
        EXPECT(gbc.h(),  0x9b);
        EXPECT(gbc.l(),  0x1f);
        EXPECT(gbc.sp(), 0x1508);
        EXPECT(gbc.pc(), 0x3d30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 010A
        gbc.setState(0x81e3, 0x2036, 0xae10, 0x18fc, 0x7c76, 0x9331, 0x0, 0x0);
        gbc.writeMem(0x81e3, { 0xd4, 0x5, 0xf5 });
        gbc.step();
        EXPECT(gbc.a(),  0xae);
        EXPECT(gbc.b(),  0x18);
        EXPECT(gbc.c(),  0xfc);
        EXPECT(gbc.d(),  0x7c);
        EXPECT(gbc.e(),  0x76);
        EXPECT(gbc.h(),  0x93);
        EXPECT(gbc.l(),  0x31);
        EXPECT(gbc.sp(), 0x2036);
        EXPECT(gbc.pc(), 0x81e6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x81e3), 0xd4);
        EXPECT(gbc.readMem(0x81e4), 0x5);
        EXPECT(gbc.readMem(0x81e5), 0xf5);
        // D4 010C
        gbc.setState(0x19f0, 0x507a, 0x3af0, 0xcffe, 0xbd40, 0x14a9, 0x1, 0x0);
        gbc.writeMem(0x19f0, { 0xd4, 0x65, 0xbc });
        gbc.step();
        EXPECT(gbc.a(),  0x3a);
        EXPECT(gbc.b(),  0xcf);
        EXPECT(gbc.c(),  0xfe);
        EXPECT(gbc.d(),  0xbd);
        EXPECT(gbc.e(),  0x40);
        EXPECT(gbc.h(),  0x14);
        EXPECT(gbc.l(),  0xa9);
        EXPECT(gbc.sp(), 0x507a);
        EXPECT(gbc.pc(), 0x19f3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 010E
        gbc.setState(0x432d, 0xbb15, 0xad90, 0x85ed, 0x4381, 0xb117, 0x1, 0x1);
        gbc.writeMem(0x432d, { 0xd4, 0x77, 0x9e });
        gbc.step();
        EXPECT(gbc.a(),  0xad);
        EXPECT(gbc.b(),  0x85);
        EXPECT(gbc.c(),  0xed);
        EXPECT(gbc.d(),  0x43);
        EXPECT(gbc.e(),  0x81);
        EXPECT(gbc.h(),  0xb1);
        EXPECT(gbc.l(),  0x17);
        EXPECT(gbc.sp(), 0xbb15);
        EXPECT(gbc.pc(), 0x4330);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 010F
        gbc.setState(0x578e, 0xde5a, 0xd0c0, 0xc1fd, 0x9320, 0xe581, 0x1, 0x1);
        gbc.writeMem(0x578e, { 0xd4, 0x35, 0xa });
        gbc.writeMem(0xde58, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xd0);
        EXPECT(gbc.b(),  0xc1);
        EXPECT(gbc.c(),  0xfd);
        EXPECT(gbc.d(),  0x93);
        EXPECT(gbc.e(),  0x20);
        EXPECT(gbc.h(),  0xe5);
        EXPECT(gbc.l(),  0x81);
        EXPECT(gbc.sp(), 0xde58);
        EXPECT(gbc.pc(), 0xa35);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xde58), 0x91);
        EXPECT(gbc.readMem(0xde59), 0x57);
        // D4 0110
        gbc.setState(0x24a0, 0xb22a, 0x82b0, 0x3f0c, 0x47dd, 0x2e6e, 0x0, 0x0);
        gbc.writeMem(0x24a0, { 0xd4, 0xda, 0x19 });
        gbc.step();
        EXPECT(gbc.a(),  0x82);
        EXPECT(gbc.b(),  0x3f);
        EXPECT(gbc.c(),  0xc);
        EXPECT(gbc.d(),  0x47);
        EXPECT(gbc.e(),  0xdd);
        EXPECT(gbc.h(),  0x2e);
        EXPECT(gbc.l(),  0x6e);
        EXPECT(gbc.sp(), 0xb22a);
        EXPECT(gbc.pc(), 0x24a3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0112
        gbc.setState(0x53ed, 0x4fb8, 0x5810, 0x81da, 0x5c01, 0x5e, 0x0, 0x0);
        gbc.writeMem(0x53ed, { 0xd4, 0x28, 0xe0 });
        gbc.step();
        EXPECT(gbc.a(),  0x58);
        EXPECT(gbc.b(),  0x81);
        EXPECT(gbc.c(),  0xda);
        EXPECT(gbc.d(),  0x5c);
        EXPECT(gbc.e(),  0x1);
        EXPECT(gbc.h(),  0x0);
        EXPECT(gbc.l(),  0x5e);
        EXPECT(gbc.sp(), 0x4fb8);
        EXPECT(gbc.pc(), 0x53f0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0114
        gbc.setState(0x565b, 0x3b25, 0xbd10, 0xc42a, 0x7e2e, 0xf6e6, 0x1, 0x0);
        gbc.writeMem(0x565b, { 0xd4, 0x39, 0x63 });
        gbc.step();
        EXPECT(gbc.a(),  0xbd);
        EXPECT(gbc.b(),  0xc4);
        EXPECT(gbc.c(),  0x2a);
        EXPECT(gbc.d(),  0x7e);
        EXPECT(gbc.e(),  0x2e);
        EXPECT(gbc.h(),  0xf6);
        EXPECT(gbc.l(),  0xe6);
        EXPECT(gbc.sp(), 0x3b25);
        EXPECT(gbc.pc(), 0x565e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0115
        gbc.setState(0xa129, 0x128e, 0x8610, 0x9028, 0xbfb3, 0xbaf4, 0x1, 0x0);
        gbc.writeMem(0xa129, { 0xd4, 0x53, 0xf1 });
        gbc.step();
        EXPECT(gbc.a(),  0x86);
        EXPECT(gbc.b(),  0x90);
        EXPECT(gbc.c(),  0x28);
        EXPECT(gbc.d(),  0xbf);
        EXPECT(gbc.e(),  0xb3);
        EXPECT(gbc.h(),  0xba);
        EXPECT(gbc.l(),  0xf4);
        EXPECT(gbc.sp(), 0x128e);
        EXPECT(gbc.pc(), 0xa12c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa129), 0xd4);
        EXPECT(gbc.readMem(0xa12a), 0x53);
        EXPECT(gbc.readMem(0xa12b), 0xf1);
        // D4 0118
        gbc.setState(0x9814, 0xf223, 0x7bc0, 0x18dc, 0x3840, 0x6111, 0x1, 0x0);
        gbc.writeMem(0x9814, { 0xd4, 0xf5, 0x4f });
        gbc.writeMem(0xf221, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x7b);
        EXPECT(gbc.b(),  0x18);
        EXPECT(gbc.c(),  0xdc);
        EXPECT(gbc.d(),  0x38);
        EXPECT(gbc.e(),  0x40);
        EXPECT(gbc.h(),  0x61);
        EXPECT(gbc.l(),  0x11);
        EXPECT(gbc.sp(), 0xf221);
        EXPECT(gbc.pc(), 0x4ff5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9814), 0xd4);
        EXPECT(gbc.readMem(0x9815), 0xf5);
        EXPECT(gbc.readMem(0x9816), 0x4f);
        EXPECT(gbc.readMem(0xf221), 0x17);
        EXPECT(gbc.readMem(0xf222), 0x98);
        // D4 0119
        gbc.setState(0xb48, 0x64db, 0x8b50, 0x7385, 0x3df1, 0xc773, 0x1, 0x0);
        gbc.writeMem(0xb48, { 0xd4, 0x57, 0x5a });
        gbc.step();
        EXPECT(gbc.a(),  0x8b);
        EXPECT(gbc.b(),  0x73);
        EXPECT(gbc.c(),  0x85);
        EXPECT(gbc.d(),  0x3d);
        EXPECT(gbc.e(),  0xf1);
        EXPECT(gbc.h(),  0xc7);
        EXPECT(gbc.l(),  0x73);
        EXPECT(gbc.sp(), 0x64db);
        EXPECT(gbc.pc(), 0xb4b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 011A
        gbc.setState(0x14c2, 0xfe9e, 0x48d0, 0x2d02, 0x95f7, 0x4929, 0x1, 0x0);
        gbc.writeMem(0x14c2, { 0xd4, 0x69, 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0x48);
        EXPECT(gbc.b(),  0x2d);
        EXPECT(gbc.c(),  0x2);
        EXPECT(gbc.d(),  0x95);
        EXPECT(gbc.e(),  0xf7);
        EXPECT(gbc.h(),  0x49);
        EXPECT(gbc.l(),  0x29);
        EXPECT(gbc.sp(), 0xfe9e);
        EXPECT(gbc.pc(), 0x14c5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 011C
        gbc.setState(0x2f1c, 0x2f11, 0x8110, 0x304b, 0xf141, 0xe399, 0x1, 0x1);
        gbc.writeMem(0x2f1c, { 0xd4, 0xdb, 0xd1 });
        gbc.step();
        EXPECT(gbc.a(),  0x81);
        EXPECT(gbc.b(),  0x30);
        EXPECT(gbc.c(),  0x4b);
        EXPECT(gbc.d(),  0xf1);
        EXPECT(gbc.e(),  0x41);
        EXPECT(gbc.h(),  0xe3);
        EXPECT(gbc.l(),  0x99);
        EXPECT(gbc.sp(), 0x2f11);
        EXPECT(gbc.pc(), 0x2f1f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 011E
        gbc.setState(0xeb8d, 0x8c5b, 0xdd50, 0xf8ac, 0xb5cb, 0x5d9a, 0x1, 0x0);
        gbc.writeMem(0xeb8d, { 0xd4, 0x30, 0xd5 });
        gbc.step();
        EXPECT(gbc.a(),  0xdd);
        EXPECT(gbc.b(),  0xf8);
        EXPECT(gbc.c(),  0xac);
        EXPECT(gbc.d(),  0xb5);
        EXPECT(gbc.e(),  0xcb);
        EXPECT(gbc.h(),  0x5d);
        EXPECT(gbc.l(),  0x9a);
        EXPECT(gbc.sp(), 0x8c5b);
        EXPECT(gbc.pc(), 0xeb90);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xeb8d), 0xd4);
        EXPECT(gbc.readMem(0xeb8e), 0x30);
        EXPECT(gbc.readMem(0xeb8f), 0xd5);
        // D4 0120
        gbc.setState(0x1436, 0x8d7e, 0x26b0, 0xed30, 0xf986, 0x31c8, 0x0, 0x1);
        gbc.writeMem(0x1436, { 0xd4, 0x10, 0x74 });
        gbc.step();
        EXPECT(gbc.a(),  0x26);
        EXPECT(gbc.b(),  0xed);
        EXPECT(gbc.c(),  0x30);
        EXPECT(gbc.d(),  0xf9);
        EXPECT(gbc.e(),  0x86);
        EXPECT(gbc.h(),  0x31);
        EXPECT(gbc.l(),  0xc8);
        EXPECT(gbc.sp(), 0x8d7e);
        EXPECT(gbc.pc(), 0x1439);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0121
        gbc.setState(0x17ca, 0x9cb9, 0x1500, 0xe264, 0x33b7, 0x4f98, 0x0, 0x1);
        gbc.writeMem(0x17ca, { 0xd4, 0x11, 0x71 });
        gbc.writeMem(0x9cb7, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x15);
        EXPECT(gbc.b(),  0xe2);
        EXPECT(gbc.c(),  0x64);
        EXPECT(gbc.d(),  0x33);
        EXPECT(gbc.e(),  0xb7);
        EXPECT(gbc.h(),  0x4f);
        EXPECT(gbc.l(),  0x98);
        EXPECT(gbc.sp(), 0x9cb7);
        EXPECT(gbc.pc(), 0x7111);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9cb7), 0xcd);
        EXPECT(gbc.readMem(0x9cb8), 0x17);
        // D4 0122
        gbc.setState(0x35c2, 0x8c90, 0xf220, 0xe6a7, 0xe448, 0xf443, 0x0, 0x0);
        gbc.writeMem(0x35c2, { 0xd4, 0x57, 0x7b });
        gbc.writeMem(0x8c8e, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xf2);
        EXPECT(gbc.b(),  0xe6);
        EXPECT(gbc.c(),  0xa7);
        EXPECT(gbc.d(),  0xe4);
        EXPECT(gbc.e(),  0x48);
        EXPECT(gbc.h(),  0xf4);
        EXPECT(gbc.l(),  0x43);
        EXPECT(gbc.sp(), 0x8c8e);
        EXPECT(gbc.pc(), 0x7b57);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8c8e), 0xc5);
        EXPECT(gbc.readMem(0x8c8f), 0x35);
        // D4 0123
        gbc.setState(0x3f37, 0xedc5, 0x8b10, 0xc441, 0x9e3, 0xea62, 0x1, 0x1);
        gbc.writeMem(0x3f37, { 0xd4, 0xd8, 0x8 });
        gbc.step();
        EXPECT(gbc.a(),  0x8b);
        EXPECT(gbc.b(),  0xc4);
        EXPECT(gbc.c(),  0x41);
        EXPECT(gbc.d(),  0x9);
        EXPECT(gbc.e(),  0xe3);
        EXPECT(gbc.h(),  0xea);
        EXPECT(gbc.l(),  0x62);
        EXPECT(gbc.sp(), 0xedc5);
        EXPECT(gbc.pc(), 0x3f3a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0124
        gbc.setState(0x14e4, 0x8566, 0xf240, 0x7943, 0xd56c, 0x7850, 0x1, 0x0);
        gbc.writeMem(0x14e4, { 0xd4, 0x38, 0x41 });
        gbc.writeMem(0x8564, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xf2);
        EXPECT(gbc.b(),  0x79);
        EXPECT(gbc.c(),  0x43);
        EXPECT(gbc.d(),  0xd5);
        EXPECT(gbc.e(),  0x6c);
        EXPECT(gbc.h(),  0x78);
        EXPECT(gbc.l(),  0x50);
        EXPECT(gbc.sp(), 0x8564);
        EXPECT(gbc.pc(), 0x4138);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8564), 0xe7);
        EXPECT(gbc.readMem(0x8565), 0x14);
        // D4 0125
        gbc.setState(0x21a7, 0x2a8e, 0x7b90, 0xc80d, 0xe64d, 0xf430, 0x0, 0x1);
        gbc.writeMem(0x21a7, { 0xd4, 0xf1, 0xcf });
        gbc.step();
        EXPECT(gbc.a(),  0x7b);
        EXPECT(gbc.b(),  0xc8);
        EXPECT(gbc.c(),  0xd);
        EXPECT(gbc.d(),  0xe6);
        EXPECT(gbc.e(),  0x4d);
        EXPECT(gbc.h(),  0xf4);
        EXPECT(gbc.l(),  0x30);
        EXPECT(gbc.sp(), 0x2a8e);
        EXPECT(gbc.pc(), 0x21aa);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0127
        gbc.setState(0xd3e, 0xe751, 0xfdc0, 0xd418, 0x4b93, 0x736d, 0x1, 0x0);
        gbc.writeMem(0xd3e, { 0xd4, 0xfa, 0xfa });
        gbc.writeMem(0xe74f, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xfd);
        EXPECT(gbc.b(),  0xd4);
        EXPECT(gbc.c(),  0x18);
        EXPECT(gbc.d(),  0x4b);
        EXPECT(gbc.e(),  0x93);
        EXPECT(gbc.h(),  0x73);
        EXPECT(gbc.l(),  0x6d);
        EXPECT(gbc.sp(), 0xe74f);
        EXPECT(gbc.pc(), 0xfafa);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe74f), 0x41);
        EXPECT(gbc.readMem(0xe750), 0xd);
        // D4 0128
        gbc.setState(0x698f, 0x1b3f, 0x25d0, 0x74e9, 0x6d62, 0xf983, 0x0, 0x0);
        gbc.writeMem(0x698f, { 0xd4, 0xf, 0x7d });
        gbc.step();
        EXPECT(gbc.a(),  0x25);
        EXPECT(gbc.b(),  0x74);
        EXPECT(gbc.c(),  0xe9);
        EXPECT(gbc.d(),  0x6d);
        EXPECT(gbc.e(),  0x62);
        EXPECT(gbc.h(),  0xf9);
        EXPECT(gbc.l(),  0x83);
        EXPECT(gbc.sp(), 0x1b3f);
        EXPECT(gbc.pc(), 0x6992);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0129
        gbc.setState(0x3c24, 0x73, 0xa810, 0xe372, 0xe806, 0x1159, 0x0, 0x1);
        gbc.writeMem(0x3c24, { 0xd4, 0x68, 0x67 });
        gbc.step();
        EXPECT(gbc.a(),  0xa8);
        EXPECT(gbc.b(),  0xe3);
        EXPECT(gbc.c(),  0x72);
        EXPECT(gbc.d(),  0xe8);
        EXPECT(gbc.e(),  0x6);
        EXPECT(gbc.h(),  0x11);
        EXPECT(gbc.l(),  0x59);
        EXPECT(gbc.sp(), 0x73);
        EXPECT(gbc.pc(), 0x3c27);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 012B
        gbc.setState(0x35b9, 0xcf2c, 0xd860, 0xd6dc, 0xcb01, 0x9afe, 0x1, 0x1);
        gbc.writeMem(0x35b9, { 0xd4, 0x72, 0xfa });
        gbc.writeMem(0xcf2a, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xd8);
        EXPECT(gbc.b(),  0xd6);
        EXPECT(gbc.c(),  0xdc);
        EXPECT(gbc.d(),  0xcb);
        EXPECT(gbc.e(),  0x1);
        EXPECT(gbc.h(),  0x9a);
        EXPECT(gbc.l(),  0xfe);
        EXPECT(gbc.sp(), 0xcf2a);
        EXPECT(gbc.pc(), 0xfa72);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcf2a), 0xbc);
        EXPECT(gbc.readMem(0xcf2b), 0x35);
        // D4 012D
        gbc.setState(0xc153, 0x27ae, 0x7f0, 0xc622, 0x40, 0x683f, 0x0, 0x1);
        gbc.writeMem(0xc153, { 0xd4, 0xc2, 0x3f });
        gbc.step();
        EXPECT(gbc.a(),  0x7);
        EXPECT(gbc.b(),  0xc6);
        EXPECT(gbc.c(),  0x22);
        EXPECT(gbc.d(),  0x0);
        EXPECT(gbc.e(),  0x40);
        EXPECT(gbc.h(),  0x68);
        EXPECT(gbc.l(),  0x3f);
        EXPECT(gbc.sp(), 0x27ae);
        EXPECT(gbc.pc(), 0xc156);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc153), 0xd4);
        EXPECT(gbc.readMem(0xc154), 0xc2);
        EXPECT(gbc.readMem(0xc155), 0x3f);
        // D4 012E
        gbc.setState(0x62e6, 0x5f35, 0x8010, 0x2b6c, 0xadca, 0x360, 0x1, 0x0);
        gbc.writeMem(0x62e6, { 0xd4, 0xaf, 0xdf });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0x2b);
        EXPECT(gbc.c(),  0x6c);
        EXPECT(gbc.d(),  0xad);
        EXPECT(gbc.e(),  0xca);
        EXPECT(gbc.h(),  0x3);
        EXPECT(gbc.l(),  0x60);
        EXPECT(gbc.sp(), 0x5f35);
        EXPECT(gbc.pc(), 0x62e9);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 012F
        gbc.setState(0x214e, 0x1b5f, 0xee50, 0xa6a1, 0x5571, 0x1c7, 0x0, 0x0);
        gbc.writeMem(0x214e, { 0xd4, 0x65, 0x71 });
        gbc.step();
        EXPECT(gbc.a(),  0xee);
        EXPECT(gbc.b(),  0xa6);
        EXPECT(gbc.c(),  0xa1);
        EXPECT(gbc.d(),  0x55);
        EXPECT(gbc.e(),  0x71);
        EXPECT(gbc.h(),  0x1);
        EXPECT(gbc.l(),  0xc7);
        EXPECT(gbc.sp(), 0x1b5f);
        EXPECT(gbc.pc(), 0x2151);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0130
        gbc.setState(0xe10d, 0xb462, 0x5b80, 0x7996, 0x3ea5, 0x840f, 0x1, 0x1);
        gbc.writeMem(0xb460, { 0x0, 0x0 });
        gbc.writeMem(0xe10d, { 0xd4, 0x91, 0x1a });
        gbc.step();
        EXPECT(gbc.a(),  0x5b);
        EXPECT(gbc.b(),  0x79);
        EXPECT(gbc.c(),  0x96);
        EXPECT(gbc.d(),  0x3e);
        EXPECT(gbc.e(),  0xa5);
        EXPECT(gbc.h(),  0x84);
        EXPECT(gbc.l(),  0xf);
        EXPECT(gbc.sp(), 0xb460);
        EXPECT(gbc.pc(), 0x1a91);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb460), 0x10);
        EXPECT(gbc.readMem(0xb461), 0xe1);
        EXPECT(gbc.readMem(0xe10d), 0xd4);
        EXPECT(gbc.readMem(0xe10e), 0x91);
        EXPECT(gbc.readMem(0xe10f), 0x1a);
        // D4 0131
        gbc.setState(0xe87d, 0x5295, 0xafd0, 0x2324, 0xb73c, 0x95b2, 0x0, 0x1);
        gbc.writeMem(0xe87d, { 0xd4, 0x68, 0x77 });
        gbc.step();
        EXPECT(gbc.a(),  0xaf);
        EXPECT(gbc.b(),  0x23);
        EXPECT(gbc.c(),  0x24);
        EXPECT(gbc.d(),  0xb7);
        EXPECT(gbc.e(),  0x3c);
        EXPECT(gbc.h(),  0x95);
        EXPECT(gbc.l(),  0xb2);
        EXPECT(gbc.sp(), 0x5295);
        EXPECT(gbc.pc(), 0xe880);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe87d), 0xd4);
        EXPECT(gbc.readMem(0xe87e), 0x68);
        EXPECT(gbc.readMem(0xe87f), 0x77);
        // D4 0132
        gbc.setState(0xd90e, 0x4bd4, 0x9fb0, 0x7f57, 0x6d5, 0x69dd, 0x0, 0x1);
        gbc.writeMem(0xd90e, { 0xd4, 0x43, 0xbc });
        gbc.step();
        EXPECT(gbc.a(),  0x9f);
        EXPECT(gbc.b(),  0x7f);
        EXPECT(gbc.c(),  0x57);
        EXPECT(gbc.d(),  0x6);
        EXPECT(gbc.e(),  0xd5);
        EXPECT(gbc.h(),  0x69);
        EXPECT(gbc.l(),  0xdd);
        EXPECT(gbc.sp(), 0x4bd4);
        EXPECT(gbc.pc(), 0xd911);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd90e), 0xd4);
        EXPECT(gbc.readMem(0xd90f), 0x43);
        EXPECT(gbc.readMem(0xd910), 0xbc);
        // D4 0133
        gbc.setState(0x7dda, 0xe863, 0x6330, 0x39d2, 0x4a59, 0x9963, 0x1, 0x0);
        gbc.writeMem(0x7dda, { 0xd4, 0xbf, 0x3e });
        gbc.step();
        EXPECT(gbc.a(),  0x63);
        EXPECT(gbc.b(),  0x39);
        EXPECT(gbc.c(),  0xd2);
        EXPECT(gbc.d(),  0x4a);
        EXPECT(gbc.e(),  0x59);
        EXPECT(gbc.h(),  0x99);
        EXPECT(gbc.l(),  0x63);
        EXPECT(gbc.sp(), 0xe863);
        EXPECT(gbc.pc(), 0x7ddd);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0135
        gbc.setState(0xbe37, 0xdfd1, 0xd6e0, 0xd88a, 0x7aaf, 0x1009, 0x1, 0x1);
        gbc.writeMem(0xbe37, { 0xd4, 0xef, 0xfc });
        gbc.writeMem(0xdfcf, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xd6);
        EXPECT(gbc.b(),  0xd8);
        EXPECT(gbc.c(),  0x8a);
        EXPECT(gbc.d(),  0x7a);
        EXPECT(gbc.e(),  0xaf);
        EXPECT(gbc.h(),  0x10);
        EXPECT(gbc.l(),  0x9);
        EXPECT(gbc.sp(), 0xdfcf);
        EXPECT(gbc.pc(), 0xfcef);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbe37), 0xd4);
        EXPECT(gbc.readMem(0xbe38), 0xef);
        EXPECT(gbc.readMem(0xbe39), 0xfc);
        EXPECT(gbc.readMem(0xdfcf), 0x3a);
        EXPECT(gbc.readMem(0xdfd0), 0xbe);
        // D4 0136
        gbc.setState(0x2806, 0x39e8, 0x2fb0, 0x1353, 0xf2e1, 0x964d, 0x0, 0x1);
        gbc.writeMem(0x2806, { 0xd4, 0xff, 0xf8 });
        gbc.step();
        EXPECT(gbc.a(),  0x2f);
        EXPECT(gbc.b(),  0x13);
        EXPECT(gbc.c(),  0x53);
        EXPECT(gbc.d(),  0xf2);
        EXPECT(gbc.e(),  0xe1);
        EXPECT(gbc.h(),  0x96);
        EXPECT(gbc.l(),  0x4d);
        EXPECT(gbc.sp(), 0x39e8);
        EXPECT(gbc.pc(), 0x2809);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0137
        gbc.setState(0x16e6, 0x2e29, 0x5970, 0x8b43, 0x896a, 0x7f9d, 0x0, 0x0);
        gbc.writeMem(0x16e6, { 0xd4, 0x24, 0x96 });
        gbc.step();
        EXPECT(gbc.a(),  0x59);
        EXPECT(gbc.b(),  0x8b);
        EXPECT(gbc.c(),  0x43);
        EXPECT(gbc.d(),  0x89);
        EXPECT(gbc.e(),  0x6a);
        EXPECT(gbc.h(),  0x7f);
        EXPECT(gbc.l(),  0x9d);
        EXPECT(gbc.sp(), 0x2e29);
        EXPECT(gbc.pc(), 0x16e9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0138
        gbc.setState(0xbee8, 0xceb9, 0xdab0, 0xda69, 0xed8e, 0xa90b, 0x1, 0x1);
        gbc.writeMem(0xbee8, { 0xd4, 0x62, 0x3 });
        gbc.step();
        EXPECT(gbc.a(),  0xda);
        EXPECT(gbc.b(),  0xda);
        EXPECT(gbc.c(),  0x69);
        EXPECT(gbc.d(),  0xed);
        EXPECT(gbc.e(),  0x8e);
        EXPECT(gbc.h(),  0xa9);
        EXPECT(gbc.l(),  0xb);
        EXPECT(gbc.sp(), 0xceb9);
        EXPECT(gbc.pc(), 0xbeeb);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbee8), 0xd4);
        EXPECT(gbc.readMem(0xbee9), 0x62);
        EXPECT(gbc.readMem(0xbeea), 0x3);
        // D4 013B
        gbc.setState(0x685d, 0x856, 0x6870, 0xe07f, 0x62e9, 0x6ce0, 0x1, 0x1);
        gbc.writeMem(0x685d, { 0xd4, 0x4e, 0x22 });
        gbc.step();
        EXPECT(gbc.a(),  0x68);
        EXPECT(gbc.b(),  0xe0);
        EXPECT(gbc.c(),  0x7f);
        EXPECT(gbc.d(),  0x62);
        EXPECT(gbc.e(),  0xe9);
        EXPECT(gbc.h(),  0x6c);
        EXPECT(gbc.l(),  0xe0);
        EXPECT(gbc.sp(), 0x856);
        EXPECT(gbc.pc(), 0x6860);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 013C
        gbc.setState(0xd742, 0x832b, 0xabe0, 0x3aa8, 0x5116, 0x9f6f, 0x1, 0x0);
        gbc.writeMem(0x8329, { 0x0, 0x0 });
        gbc.writeMem(0xd742, { 0xd4, 0x36, 0x90 });
        gbc.step();
        EXPECT(gbc.a(),  0xab);
        EXPECT(gbc.b(),  0x3a);
        EXPECT(gbc.c(),  0xa8);
        EXPECT(gbc.d(),  0x51);
        EXPECT(gbc.e(),  0x16);
        EXPECT(gbc.h(),  0x9f);
        EXPECT(gbc.l(),  0x6f);
        EXPECT(gbc.sp(), 0x8329);
        EXPECT(gbc.pc(), 0x9036);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8329), 0x45);
        EXPECT(gbc.readMem(0x832a), 0xd7);
        EXPECT(gbc.readMem(0xd742), 0xd4);
        EXPECT(gbc.readMem(0xd743), 0x36);
        EXPECT(gbc.readMem(0xd744), 0x90);
        // D4 013F
        gbc.setState(0x1cb, 0x8fd1, 0xe680, 0x662d, 0x5e04, 0x121a, 0x1, 0x0);
        gbc.writeMem(0x1cb, { 0xd4, 0x51, 0x9d });
        gbc.writeMem(0x8fcf, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xe6);
        EXPECT(gbc.b(),  0x66);
        EXPECT(gbc.c(),  0x2d);
        EXPECT(gbc.d(),  0x5e);
        EXPECT(gbc.e(),  0x4);
        EXPECT(gbc.h(),  0x12);
        EXPECT(gbc.l(),  0x1a);
        EXPECT(gbc.sp(), 0x8fcf);
        EXPECT(gbc.pc(), 0x9d51);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8fcf), 0xce);
        EXPECT(gbc.readMem(0x8fd0), 0x1);
        // D4 0140
        gbc.setState(0x4e03, 0x67f2, 0x85b0, 0x5880, 0x2bc5, 0x9a27, 0x0, 0x1);
        gbc.writeMem(0x4e03, { 0xd4, 0x3d, 0x45 });
        gbc.step();
        EXPECT(gbc.a(),  0x85);
        EXPECT(gbc.b(),  0x58);
        EXPECT(gbc.c(),  0x80);
        EXPECT(gbc.d(),  0x2b);
        EXPECT(gbc.e(),  0xc5);
        EXPECT(gbc.h(),  0x9a);
        EXPECT(gbc.l(),  0x27);
        EXPECT(gbc.sp(), 0x67f2);
        EXPECT(gbc.pc(), 0x4e06);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0142
        gbc.setState(0xee73, 0xe778, 0xfc00, 0xc95, 0x3a6b, 0x88b8, 0x0, 0x1);
        gbc.writeMem(0xe776, { 0x0, 0x0 });
        gbc.writeMem(0xee73, { 0xd4, 0x2b, 0xab });
        gbc.step();
        EXPECT(gbc.a(),  0xfc);
        EXPECT(gbc.b(),  0xc);
        EXPECT(gbc.c(),  0x95);
        EXPECT(gbc.d(),  0x3a);
        EXPECT(gbc.e(),  0x6b);
        EXPECT(gbc.h(),  0x88);
        EXPECT(gbc.l(),  0xb8);
        EXPECT(gbc.sp(), 0xe776);
        EXPECT(gbc.pc(), 0xab2b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe776), 0x76);
        EXPECT(gbc.readMem(0xe777), 0xee);
        EXPECT(gbc.readMem(0xee73), 0xd4);
        EXPECT(gbc.readMem(0xee74), 0x2b);
        EXPECT(gbc.readMem(0xee75), 0xab);
        // D4 0143
        gbc.setState(0x6235, 0x9b99, 0xfd70, 0x5fa9, 0x2484, 0x295f, 0x1, 0x1);
        gbc.writeMem(0x6235, { 0xd4, 0x7e, 0x12 });
        gbc.step();
        EXPECT(gbc.a(),  0xfd);
        EXPECT(gbc.b(),  0x5f);
        EXPECT(gbc.c(),  0xa9);
        EXPECT(gbc.d(),  0x24);
        EXPECT(gbc.e(),  0x84);
        EXPECT(gbc.h(),  0x29);
        EXPECT(gbc.l(),  0x5f);
        EXPECT(gbc.sp(), 0x9b99);
        EXPECT(gbc.pc(), 0x6238);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0145
        gbc.setState(0x76c3, 0xdd2b, 0x7530, 0xbbc1, 0xf05b, 0x7802, 0x0, 0x0);
        gbc.writeMem(0x76c3, { 0xd4, 0x6b, 0xd6 });
        gbc.step();
        EXPECT(gbc.a(),  0x75);
        EXPECT(gbc.b(),  0xbb);
        EXPECT(gbc.c(),  0xc1);
        EXPECT(gbc.d(),  0xf0);
        EXPECT(gbc.e(),  0x5b);
        EXPECT(gbc.h(),  0x78);
        EXPECT(gbc.l(),  0x2);
        EXPECT(gbc.sp(), 0xdd2b);
        EXPECT(gbc.pc(), 0x76c6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0146
        gbc.setState(0xbb57, 0x76c9, 0xfc90, 0xbbe5, 0xfcd5, 0x7d08, 0x1, 0x0);
        gbc.writeMem(0xbb57, { 0xd4, 0xd8, 0x9f });
        gbc.step();
        EXPECT(gbc.a(),  0xfc);
        EXPECT(gbc.b(),  0xbb);
        EXPECT(gbc.c(),  0xe5);
        EXPECT(gbc.d(),  0xfc);
        EXPECT(gbc.e(),  0xd5);
        EXPECT(gbc.h(),  0x7d);
        EXPECT(gbc.l(),  0x8);
        EXPECT(gbc.sp(), 0x76c9);
        EXPECT(gbc.pc(), 0xbb5a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbb57), 0xd4);
        EXPECT(gbc.readMem(0xbb58), 0xd8);
        EXPECT(gbc.readMem(0xbb59), 0x9f);
        // D4 0147
        gbc.setState(0x1f15, 0x9b83, 0x280, 0xf414, 0xbbdc, 0x40bb, 0x0, 0x1);
        gbc.writeMem(0x1f15, { 0xd4, 0x58, 0x71 });
        gbc.writeMem(0x9b81, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0xf4);
        EXPECT(gbc.c(),  0x14);
        EXPECT(gbc.d(),  0xbb);
        EXPECT(gbc.e(),  0xdc);
        EXPECT(gbc.h(),  0x40);
        EXPECT(gbc.l(),  0xbb);
        EXPECT(gbc.sp(), 0x9b81);
        EXPECT(gbc.pc(), 0x7158);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9b81), 0x18);
        EXPECT(gbc.readMem(0x9b82), 0x1f);
        // D4 014A
        gbc.setState(0xa8da, 0x4e0c, 0xf5b0, 0xe77d, 0xbe49, 0xfe83, 0x1, 0x1);
        gbc.writeMem(0xa8da, { 0xd4, 0x9f, 0x5c });
        gbc.step();
        EXPECT(gbc.a(),  0xf5);
        EXPECT(gbc.b(),  0xe7);
        EXPECT(gbc.c(),  0x7d);
        EXPECT(gbc.d(),  0xbe);
        EXPECT(gbc.e(),  0x49);
        EXPECT(gbc.h(),  0xfe);
        EXPECT(gbc.l(),  0x83);
        EXPECT(gbc.sp(), 0x4e0c);
        EXPECT(gbc.pc(), 0xa8dd);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa8da), 0xd4);
        EXPECT(gbc.readMem(0xa8db), 0x9f);
        EXPECT(gbc.readMem(0xa8dc), 0x5c);
        // D4 014B
        gbc.setState(0x81d4, 0x2234, 0x4d70, 0x8b53, 0x21f9, 0xe1b6, 0x0, 0x1);
        gbc.writeMem(0x81d4, { 0xd4, 0x27, 0x83 });
        gbc.step();
        EXPECT(gbc.a(),  0x4d);
        EXPECT(gbc.b(),  0x8b);
        EXPECT(gbc.c(),  0x53);
        EXPECT(gbc.d(),  0x21);
        EXPECT(gbc.e(),  0xf9);
        EXPECT(gbc.h(),  0xe1);
        EXPECT(gbc.l(),  0xb6);
        EXPECT(gbc.sp(), 0x2234);
        EXPECT(gbc.pc(), 0x81d7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x81d4), 0xd4);
        EXPECT(gbc.readMem(0x81d5), 0x27);
        EXPECT(gbc.readMem(0x81d6), 0x83);
        // D4 014C
        gbc.setState(0x9bb2, 0xd234, 0x4f50, 0xacd3, 0x4099, 0xd485, 0x0, 0x0);
        gbc.writeMem(0x9bb2, { 0xd4, 0x1c, 0xe9 });
        gbc.step();
        EXPECT(gbc.a(),  0x4f);
        EXPECT(gbc.b(),  0xac);
        EXPECT(gbc.c(),  0xd3);
        EXPECT(gbc.d(),  0x40);
        EXPECT(gbc.e(),  0x99);
        EXPECT(gbc.h(),  0xd4);
        EXPECT(gbc.l(),  0x85);
        EXPECT(gbc.sp(), 0xd234);
        EXPECT(gbc.pc(), 0x9bb5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9bb2), 0xd4);
        EXPECT(gbc.readMem(0x9bb3), 0x1c);
        EXPECT(gbc.readMem(0x9bb4), 0xe9);
        // D4 014E
        gbc.setState(0xf17, 0x53bd, 0xdff0, 0x5630, 0xd7fd, 0x62ec, 0x0, 0x0);
        gbc.writeMem(0xf17, { 0xd4, 0x99, 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xdf);
        EXPECT(gbc.b(),  0x56);
        EXPECT(gbc.c(),  0x30);
        EXPECT(gbc.d(),  0xd7);
        EXPECT(gbc.e(),  0xfd);
        EXPECT(gbc.h(),  0x62);
        EXPECT(gbc.l(),  0xec);
        EXPECT(gbc.sp(), 0x53bd);
        EXPECT(gbc.pc(), 0xf1a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 014F
        gbc.setState(0xc7a6, 0xc3d8, 0x7fe0, 0xf9ee, 0x1811, 0x4363, 0x0, 0x1);
        gbc.writeMem(0xc3d6, { 0x0, 0x0 });
        gbc.writeMem(0xc7a6, { 0xd4, 0x83, 0x2a });
        gbc.step();
        EXPECT(gbc.a(),  0x7f);
        EXPECT(gbc.b(),  0xf9);
        EXPECT(gbc.c(),  0xee);
        EXPECT(gbc.d(),  0x18);
        EXPECT(gbc.e(),  0x11);
        EXPECT(gbc.h(),  0x43);
        EXPECT(gbc.l(),  0x63);
        EXPECT(gbc.sp(), 0xc3d6);
        EXPECT(gbc.pc(), 0x2a83);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc3d6), 0xa9);
        EXPECT(gbc.readMem(0xc3d7), 0xc7);
        EXPECT(gbc.readMem(0xc7a6), 0xd4);
        EXPECT(gbc.readMem(0xc7a7), 0x83);
        EXPECT(gbc.readMem(0xc7a8), 0x2a);
        // D4 0150
        gbc.setState(0x429a, 0x4c80, 0x23f0, 0xa7d1, 0xeea5, 0x41af, 0x0, 0x1);
        gbc.writeMem(0x429a, { 0xd4, 0xa7, 0xc5 });
        gbc.step();
        EXPECT(gbc.a(),  0x23);
        EXPECT(gbc.b(),  0xa7);
        EXPECT(gbc.c(),  0xd1);
        EXPECT(gbc.d(),  0xee);
        EXPECT(gbc.e(),  0xa5);
        EXPECT(gbc.h(),  0x41);
        EXPECT(gbc.l(),  0xaf);
        EXPECT(gbc.sp(), 0x4c80);
        EXPECT(gbc.pc(), 0x429d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0151
        gbc.setState(0x18e0, 0xd123, 0xdfd0, 0x814a, 0xe601, 0x5903, 0x1, 0x1);
        gbc.writeMem(0x18e0, { 0xd4, 0xca, 0xf4 });
        gbc.step();
        EXPECT(gbc.a(),  0xdf);
        EXPECT(gbc.b(),  0x81);
        EXPECT(gbc.c(),  0x4a);
        EXPECT(gbc.d(),  0xe6);
        EXPECT(gbc.e(),  0x1);
        EXPECT(gbc.h(),  0x59);
        EXPECT(gbc.l(),  0x3);
        EXPECT(gbc.sp(), 0xd123);
        EXPECT(gbc.pc(), 0x18e3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0152
        gbc.setState(0x8be5, 0x26c0, 0xda30, 0x1075, 0xe746, 0xfcc, 0x1, 0x0);
        gbc.writeMem(0x8be5, { 0xd4, 0xec, 0x7a });
        gbc.step();
        EXPECT(gbc.a(),  0xda);
        EXPECT(gbc.b(),  0x10);
        EXPECT(gbc.c(),  0x75);
        EXPECT(gbc.d(),  0xe7);
        EXPECT(gbc.e(),  0x46);
        EXPECT(gbc.h(),  0xf);
        EXPECT(gbc.l(),  0xcc);
        EXPECT(gbc.sp(), 0x26c0);
        EXPECT(gbc.pc(), 0x8be8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8be5), 0xd4);
        EXPECT(gbc.readMem(0x8be6), 0xec);
        EXPECT(gbc.readMem(0x8be7), 0x7a);
        // D4 0153
        gbc.setState(0x5fb3, 0xec27, 0x6ce0, 0xf349, 0xa88, 0xfd2e, 0x1, 0x0);
        gbc.writeMem(0x5fb3, { 0xd4, 0xf0, 0xa8 });
        gbc.writeMem(0xec25, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x6c);
        EXPECT(gbc.b(),  0xf3);
        EXPECT(gbc.c(),  0x49);
        EXPECT(gbc.d(),  0xa);
        EXPECT(gbc.e(),  0x88);
        EXPECT(gbc.h(),  0xfd);
        EXPECT(gbc.l(),  0x2e);
        EXPECT(gbc.sp(), 0xec25);
        EXPECT(gbc.pc(), 0xa8f0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xec25), 0xb6);
        EXPECT(gbc.readMem(0xec26), 0x5f);
        // D4 0154
        gbc.setState(0x977c, 0x2253, 0x77b0, 0x2ced, 0xf675, 0x4875, 0x1, 0x0);
        gbc.writeMem(0x977c, { 0xd4, 0x91, 0x97 });
        gbc.step();
        EXPECT(gbc.a(),  0x77);
        EXPECT(gbc.b(),  0x2c);
        EXPECT(gbc.c(),  0xed);
        EXPECT(gbc.d(),  0xf6);
        EXPECT(gbc.e(),  0x75);
        EXPECT(gbc.h(),  0x48);
        EXPECT(gbc.l(),  0x75);
        EXPECT(gbc.sp(), 0x2253);
        EXPECT(gbc.pc(), 0x977f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x977c), 0xd4);
        EXPECT(gbc.readMem(0x977d), 0x91);
        EXPECT(gbc.readMem(0x977e), 0x97);
        // D4 0155
        gbc.setState(0xe72b, 0x1d66, 0xd30, 0x7be3, 0xee96, 0x8edc, 0x0, 0x1);
        gbc.writeMem(0xe72b, { 0xd4, 0xa3, 0xc3 });
        gbc.step();
        EXPECT(gbc.a(),  0xd);
        EXPECT(gbc.b(),  0x7b);
        EXPECT(gbc.c(),  0xe3);
        EXPECT(gbc.d(),  0xee);
        EXPECT(gbc.e(),  0x96);
        EXPECT(gbc.h(),  0x8e);
        EXPECT(gbc.l(),  0xdc);
        EXPECT(gbc.sp(), 0x1d66);
        EXPECT(gbc.pc(), 0xe72e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe72b), 0xd4);
        EXPECT(gbc.readMem(0xe72c), 0xa3);
        EXPECT(gbc.readMem(0xe72d), 0xc3);
        // D4 0156
        gbc.setState(0x7b31, 0xf276, 0xdd20, 0x563b, 0x29cf, 0xff54, 0x0, 0x0);
        gbc.writeMem(0x7b31, { 0xd4, 0xfb, 0xfe });
        gbc.writeMem(0xf274, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xdd);
        EXPECT(gbc.b(),  0x56);
        EXPECT(gbc.c(),  0x3b);
        EXPECT(gbc.d(),  0x29);
        EXPECT(gbc.e(),  0xcf);
        EXPECT(gbc.h(),  0xff);
        EXPECT(gbc.l(),  0x54);
        EXPECT(gbc.sp(), 0xf274);
        EXPECT(gbc.pc(), 0xfefb);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xf274), 0x34);
        EXPECT(gbc.readMem(0xf275), 0x7b);
        // D4 0158
        gbc.setState(0xb9e8, 0x2e8a, 0x4150, 0xdfa0, 0x6415, 0x3055, 0x0, 0x1);
        gbc.writeMem(0xb9e8, { 0xd4, 0xc0, 0xda });
        gbc.step();
        EXPECT(gbc.a(),  0x41);
        EXPECT(gbc.b(),  0xdf);
        EXPECT(gbc.c(),  0xa0);
        EXPECT(gbc.d(),  0x64);
        EXPECT(gbc.e(),  0x15);
        EXPECT(gbc.h(),  0x30);
        EXPECT(gbc.l(),  0x55);
        EXPECT(gbc.sp(), 0x2e8a);
        EXPECT(gbc.pc(), 0xb9eb);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb9e8), 0xd4);
        EXPECT(gbc.readMem(0xb9e9), 0xc0);
        EXPECT(gbc.readMem(0xb9ea), 0xda);
        // D4 015A
        gbc.setState(0x8d76, 0xea1f, 0xc4b0, 0x4b63, 0x944d, 0x8092, 0x1, 0x1);
        gbc.writeMem(0x8d76, { 0xd4, 0x86, 0x68 });
        gbc.step();
        EXPECT(gbc.a(),  0xc4);
        EXPECT(gbc.b(),  0x4b);
        EXPECT(gbc.c(),  0x63);
        EXPECT(gbc.d(),  0x94);
        EXPECT(gbc.e(),  0x4d);
        EXPECT(gbc.h(),  0x80);
        EXPECT(gbc.l(),  0x92);
        EXPECT(gbc.sp(), 0xea1f);
        EXPECT(gbc.pc(), 0x8d79);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8d76), 0xd4);
        EXPECT(gbc.readMem(0x8d77), 0x86);
        EXPECT(gbc.readMem(0x8d78), 0x68);
        // D4 015C
        gbc.setState(0x9eaf, 0xb95d, 0x5e90, 0x9f29, 0x9c39, 0x705c, 0x1, 0x1);
        gbc.writeMem(0x9eaf, { 0xd4, 0xd3, 0xee });
        gbc.step();
        EXPECT(gbc.a(),  0x5e);
        EXPECT(gbc.b(),  0x9f);
        EXPECT(gbc.c(),  0x29);
        EXPECT(gbc.d(),  0x9c);
        EXPECT(gbc.e(),  0x39);
        EXPECT(gbc.h(),  0x70);
        EXPECT(gbc.l(),  0x5c);
        EXPECT(gbc.sp(), 0xb95d);
        EXPECT(gbc.pc(), 0x9eb2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9eaf), 0xd4);
        EXPECT(gbc.readMem(0x9eb0), 0xd3);
        EXPECT(gbc.readMem(0x9eb1), 0xee);
        // D4 015D
        gbc.setState(0xbd1d, 0xf10b, 0x1090, 0xb359, 0x4071, 0xeb10, 0x0, 0x1);
        gbc.writeMem(0xbd1d, { 0xd4, 0xdf, 0x9c });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0xb3);
        EXPECT(gbc.c(),  0x59);
        EXPECT(gbc.d(),  0x40);
        EXPECT(gbc.e(),  0x71);
        EXPECT(gbc.h(),  0xeb);
        EXPECT(gbc.l(),  0x10);
        EXPECT(gbc.sp(), 0xf10b);
        EXPECT(gbc.pc(), 0xbd20);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbd1d), 0xd4);
        EXPECT(gbc.readMem(0xbd1e), 0xdf);
        EXPECT(gbc.readMem(0xbd1f), 0x9c);
        // D4 015F
        gbc.setState(0x399c, 0xab7f, 0xc500, 0x5b72, 0xaf47, 0x5893, 0x1, 0x0);
        gbc.writeMem(0x399c, { 0xd4, 0x9e, 0x23 });
        gbc.writeMem(0xab7d, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xc5);
        EXPECT(gbc.b(),  0x5b);
        EXPECT(gbc.c(),  0x72);
        EXPECT(gbc.d(),  0xaf);
        EXPECT(gbc.e(),  0x47);
        EXPECT(gbc.h(),  0x58);
        EXPECT(gbc.l(),  0x93);
        EXPECT(gbc.sp(), 0xab7d);
        EXPECT(gbc.pc(), 0x239e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xab7d), 0x9f);
        EXPECT(gbc.readMem(0xab7e), 0x39);
        // D4 0160
        gbc.setState(0x6e96, 0xc0bc, 0xfb80, 0x812b, 0xa9c1, 0x44fc, 0x1, 0x1);
        gbc.writeMem(0x6e96, { 0xd4, 0xd2, 0xc8 });
        gbc.writeMem(0xc0ba, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xfb);
        EXPECT(gbc.b(),  0x81);
        EXPECT(gbc.c(),  0x2b);
        EXPECT(gbc.d(),  0xa9);
        EXPECT(gbc.e(),  0xc1);
        EXPECT(gbc.h(),  0x44);
        EXPECT(gbc.l(),  0xfc);
        EXPECT(gbc.sp(), 0xc0ba);
        EXPECT(gbc.pc(), 0xc8d2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc0ba), 0x99);
        EXPECT(gbc.readMem(0xc0bb), 0x6e);
        // D4 0161
        gbc.setState(0xefb6, 0x8bee, 0x9130, 0xf179, 0xeec1, 0x2bc0, 0x0, 0x1);
        gbc.writeMem(0xefb6, { 0xd4, 0xda, 0x17 });
        gbc.step();
        EXPECT(gbc.a(),  0x91);
        EXPECT(gbc.b(),  0xf1);
        EXPECT(gbc.c(),  0x79);
        EXPECT(gbc.d(),  0xee);
        EXPECT(gbc.e(),  0xc1);
        EXPECT(gbc.h(),  0x2b);
        EXPECT(gbc.l(),  0xc0);
        EXPECT(gbc.sp(), 0x8bee);
        EXPECT(gbc.pc(), 0xefb9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xefb6), 0xd4);
        EXPECT(gbc.readMem(0xefb7), 0xda);
        EXPECT(gbc.readMem(0xefb8), 0x17);
        // D4 0162
        gbc.setState(0xd5c5, 0x253, 0x4610, 0xdb43, 0x8b2, 0x6dde, 0x0, 0x1);
        gbc.writeMem(0xd5c5, { 0xd4, 0x5c, 0xdf });
        gbc.step();
        EXPECT(gbc.a(),  0x46);
        EXPECT(gbc.b(),  0xdb);
        EXPECT(gbc.c(),  0x43);
        EXPECT(gbc.d(),  0x8);
        EXPECT(gbc.e(),  0xb2);
        EXPECT(gbc.h(),  0x6d);
        EXPECT(gbc.l(),  0xde);
        EXPECT(gbc.sp(), 0x253);
        EXPECT(gbc.pc(), 0xd5c8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd5c5), 0xd4);
        EXPECT(gbc.readMem(0xd5c6), 0x5c);
        EXPECT(gbc.readMem(0xd5c7), 0xdf);
        // D4 0163
        gbc.setState(0x7228, 0x2b09, 0x7b90, 0x83ed, 0x3727, 0x66a6, 0x0, 0x0);
        gbc.writeMem(0x7228, { 0xd4, 0x8, 0x60 });
        gbc.step();
        EXPECT(gbc.a(),  0x7b);
        EXPECT(gbc.b(),  0x83);
        EXPECT(gbc.c(),  0xed);
        EXPECT(gbc.d(),  0x37);
        EXPECT(gbc.e(),  0x27);
        EXPECT(gbc.h(),  0x66);
        EXPECT(gbc.l(),  0xa6);
        EXPECT(gbc.sp(), 0x2b09);
        EXPECT(gbc.pc(), 0x722b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0164
        gbc.setState(0x1d3d, 0xbeef, 0xd90, 0x5fc4, 0x1bf5, 0xc3dc, 0x0, 0x1);
        gbc.writeMem(0x1d3d, { 0xd4, 0x85, 0xb3 });
        gbc.step();
        EXPECT(gbc.a(),  0xd);
        EXPECT(gbc.b(),  0x5f);
        EXPECT(gbc.c(),  0xc4);
        EXPECT(gbc.d(),  0x1b);
        EXPECT(gbc.e(),  0xf5);
        EXPECT(gbc.h(),  0xc3);
        EXPECT(gbc.l(),  0xdc);
        EXPECT(gbc.sp(), 0xbeef);
        EXPECT(gbc.pc(), 0x1d40);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0166
        gbc.setState(0x10bf, 0x69e3, 0x44d0, 0x987, 0x927c, 0x7e92, 0x1, 0x1);
        gbc.writeMem(0x10bf, { 0xd4, 0xb9, 0xb7 });
        gbc.step();
        EXPECT(gbc.a(),  0x44);
        EXPECT(gbc.b(),  0x9);
        EXPECT(gbc.c(),  0x87);
        EXPECT(gbc.d(),  0x92);
        EXPECT(gbc.e(),  0x7c);
        EXPECT(gbc.h(),  0x7e);
        EXPECT(gbc.l(),  0x92);
        EXPECT(gbc.sp(), 0x69e3);
        EXPECT(gbc.pc(), 0x10c2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0167
        gbc.setState(0x8aee, 0xe47c, 0xca00, 0xdc47, 0xbff1, 0xb61, 0x1, 0x0);
        gbc.writeMem(0x8aee, { 0xd4, 0xe3, 0x40 });
        gbc.writeMem(0xe47a, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xca);
        EXPECT(gbc.b(),  0xdc);
        EXPECT(gbc.c(),  0x47);
        EXPECT(gbc.d(),  0xbf);
        EXPECT(gbc.e(),  0xf1);
        EXPECT(gbc.h(),  0xb);
        EXPECT(gbc.l(),  0x61);
        EXPECT(gbc.sp(), 0xe47a);
        EXPECT(gbc.pc(), 0x40e3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8aee), 0xd4);
        EXPECT(gbc.readMem(0x8aef), 0xe3);
        EXPECT(gbc.readMem(0x8af0), 0x40);
        EXPECT(gbc.readMem(0xe47a), 0xf1);
        EXPECT(gbc.readMem(0xe47b), 0x8a);
        // D4 0168
        gbc.setState(0xe21c, 0xa176, 0x47a0, 0xf46b, 0xcbf7, 0xce45, 0x0, 0x1);
        gbc.writeMem(0xa174, { 0x0, 0x0 });
        gbc.writeMem(0xe21c, { 0xd4, 0x4a, 0xdf });
        gbc.step();
        EXPECT(gbc.a(),  0x47);
        EXPECT(gbc.b(),  0xf4);
        EXPECT(gbc.c(),  0x6b);
        EXPECT(gbc.d(),  0xcb);
        EXPECT(gbc.e(),  0xf7);
        EXPECT(gbc.h(),  0xce);
        EXPECT(gbc.l(),  0x45);
        EXPECT(gbc.sp(), 0xa174);
        EXPECT(gbc.pc(), 0xdf4a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa174), 0x1f);
        EXPECT(gbc.readMem(0xa175), 0xe2);
        EXPECT(gbc.readMem(0xe21c), 0xd4);
        EXPECT(gbc.readMem(0xe21d), 0x4a);
        EXPECT(gbc.readMem(0xe21e), 0xdf);
        // D4 0169
        gbc.setState(0xa19a, 0x75d, 0xfd10, 0x518d, 0x515, 0xf955, 0x0, 0x1);
        gbc.writeMem(0xa19a, { 0xd4, 0x36, 0xa6 });
        gbc.step();
        EXPECT(gbc.a(),  0xfd);
        EXPECT(gbc.b(),  0x51);
        EXPECT(gbc.c(),  0x8d);
        EXPECT(gbc.d(),  0x5);
        EXPECT(gbc.e(),  0x15);
        EXPECT(gbc.h(),  0xf9);
        EXPECT(gbc.l(),  0x55);
        EXPECT(gbc.sp(), 0x75d);
        EXPECT(gbc.pc(), 0xa19d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa19a), 0xd4);
        EXPECT(gbc.readMem(0xa19b), 0x36);
        EXPECT(gbc.readMem(0xa19c), 0xa6);
        // D4 016C
        gbc.setState(0x583d, 0x170a, 0xee90, 0xa3a2, 0xb314, 0xb83d, 0x0, 0x0);
        gbc.writeMem(0x583d, { 0xd4, 0xf2, 0xb2 });
        gbc.step();
        EXPECT(gbc.a(),  0xee);
        EXPECT(gbc.b(),  0xa3);
        EXPECT(gbc.c(),  0xa2);
        EXPECT(gbc.d(),  0xb3);
        EXPECT(gbc.e(),  0x14);
        EXPECT(gbc.h(),  0xb8);
        EXPECT(gbc.l(),  0x3d);
        EXPECT(gbc.sp(), 0x170a);
        EXPECT(gbc.pc(), 0x5840);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 016D
        gbc.setState(0xb96f, 0xce16, 0x6ee0, 0xf606, 0x8ede, 0x4f64, 0x1, 0x0);
        gbc.writeMem(0xb96f, { 0xd4, 0x3f, 0x19 });
        gbc.writeMem(0xce14, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x6e);
        EXPECT(gbc.b(),  0xf6);
        EXPECT(gbc.c(),  0x6);
        EXPECT(gbc.d(),  0x8e);
        EXPECT(gbc.e(),  0xde);
        EXPECT(gbc.h(),  0x4f);
        EXPECT(gbc.l(),  0x64);
        EXPECT(gbc.sp(), 0xce14);
        EXPECT(gbc.pc(), 0x193f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb96f), 0xd4);
        EXPECT(gbc.readMem(0xb970), 0x3f);
        EXPECT(gbc.readMem(0xb971), 0x19);
        EXPECT(gbc.readMem(0xce14), 0x72);
        EXPECT(gbc.readMem(0xce15), 0xb9);
        // D4 016E
        gbc.setState(0x4ee1, 0x6db5, 0x3010, 0xb236, 0xfb3d, 0x311a, 0x1, 0x1);
        gbc.writeMem(0x4ee1, { 0xd4, 0x2e, 0xb6 });
        gbc.step();
        EXPECT(gbc.a(),  0x30);
        EXPECT(gbc.b(),  0xb2);
        EXPECT(gbc.c(),  0x36);
        EXPECT(gbc.d(),  0xfb);
        EXPECT(gbc.e(),  0x3d);
        EXPECT(gbc.h(),  0x31);
        EXPECT(gbc.l(),  0x1a);
        EXPECT(gbc.sp(), 0x6db5);
        EXPECT(gbc.pc(), 0x4ee4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0172
        gbc.setState(0x68c, 0xaa8, 0x4a10, 0x652a, 0x7ef0, 0x9145, 0x0, 0x0);
        gbc.writeMem(0x68c, { 0xd4, 0x15, 0x50 });
        gbc.step();
        EXPECT(gbc.a(),  0x4a);
        EXPECT(gbc.b(),  0x65);
        EXPECT(gbc.c(),  0x2a);
        EXPECT(gbc.d(),  0x7e);
        EXPECT(gbc.e(),  0xf0);
        EXPECT(gbc.h(),  0x91);
        EXPECT(gbc.l(),  0x45);
        EXPECT(gbc.sp(), 0xaa8);
        EXPECT(gbc.pc(), 0x68f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0173
        gbc.setState(0x27d1, 0xbde3, 0x8350, 0x625c, 0x8024, 0x8998, 0x1, 0x1);
        gbc.writeMem(0x27d1, { 0xd4, 0xa3, 0x4b });
        gbc.step();
        EXPECT(gbc.a(),  0x83);
        EXPECT(gbc.b(),  0x62);
        EXPECT(gbc.c(),  0x5c);
        EXPECT(gbc.d(),  0x80);
        EXPECT(gbc.e(),  0x24);
        EXPECT(gbc.h(),  0x89);
        EXPECT(gbc.l(),  0x98);
        EXPECT(gbc.sp(), 0xbde3);
        EXPECT(gbc.pc(), 0x27d4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0174
        gbc.setState(0x5530, 0xc663, 0xc10, 0x83c6, 0x7538, 0xb0f7, 0x0, 0x1);
        gbc.writeMem(0x5530, { 0xd4, 0x3d, 0x2 });
        gbc.step();
        EXPECT(gbc.a(),  0xc);
        EXPECT(gbc.b(),  0x83);
        EXPECT(gbc.c(),  0xc6);
        EXPECT(gbc.d(),  0x75);
        EXPECT(gbc.e(),  0x38);
        EXPECT(gbc.h(),  0xb0);
        EXPECT(gbc.l(),  0xf7);
        EXPECT(gbc.sp(), 0xc663);
        EXPECT(gbc.pc(), 0x5533);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0175
        gbc.setState(0xba9e, 0xfca6, 0x29e0, 0xc387, 0xe72b, 0x100f, 0x0, 0x0);
        gbc.writeMem(0xba9e, { 0xd4, 0xc5, 0xbf });
        gbc.writeMem(0xfca4, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x29);
        EXPECT(gbc.b(),  0xc3);
        EXPECT(gbc.c(),  0x87);
        EXPECT(gbc.d(),  0xe7);
        EXPECT(gbc.e(),  0x2b);
        EXPECT(gbc.h(),  0x10);
        EXPECT(gbc.l(),  0xf);
        EXPECT(gbc.sp(), 0xfca4);
        EXPECT(gbc.pc(), 0xbfc5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xba9e), 0xd4);
        EXPECT(gbc.readMem(0xba9f), 0xc5);
        EXPECT(gbc.readMem(0xbaa0), 0xbf);
        EXPECT(gbc.readMem(0xfca4), 0xa1);
        EXPECT(gbc.readMem(0xfca5), 0xba);
        // D4 0176
        gbc.setState(0x7013, 0x1379, 0x2590, 0x72bf, 0x30b9, 0xcb37, 0x0, 0x1);
        gbc.writeMem(0x7013, { 0xd4, 0xfc, 0xc7 });
        gbc.step();
        EXPECT(gbc.a(),  0x25);
        EXPECT(gbc.b(),  0x72);
        EXPECT(gbc.c(),  0xbf);
        EXPECT(gbc.d(),  0x30);
        EXPECT(gbc.e(),  0xb9);
        EXPECT(gbc.h(),  0xcb);
        EXPECT(gbc.l(),  0x37);
        EXPECT(gbc.sp(), 0x1379);
        EXPECT(gbc.pc(), 0x7016);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0178
        gbc.setState(0xb939, 0x73b, 0xdc70, 0x1e0d, 0x857d, 0x4c10, 0x1, 0x1);
        gbc.writeMem(0xb939, { 0xd4, 0xf3, 0xc8 });
        gbc.step();
        EXPECT(gbc.a(),  0xdc);
        EXPECT(gbc.b(),  0x1e);
        EXPECT(gbc.c(),  0xd);
        EXPECT(gbc.d(),  0x85);
        EXPECT(gbc.e(),  0x7d);
        EXPECT(gbc.h(),  0x4c);
        EXPECT(gbc.l(),  0x10);
        EXPECT(gbc.sp(), 0x73b);
        EXPECT(gbc.pc(), 0xb93c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb939), 0xd4);
        EXPECT(gbc.readMem(0xb93a), 0xf3);
        EXPECT(gbc.readMem(0xb93b), 0xc8);
        // D4 0179
        gbc.setState(0x2534, 0x13ff, 0xfd10, 0xb3a2, 0xe78, 0xbbd3, 0x1, 0x1);
        gbc.writeMem(0x2534, { 0xd4, 0x77, 0xfc });
        gbc.step();
        EXPECT(gbc.a(),  0xfd);
        EXPECT(gbc.b(),  0xb3);
        EXPECT(gbc.c(),  0xa2);
        EXPECT(gbc.d(),  0xe);
        EXPECT(gbc.e(),  0x78);
        EXPECT(gbc.h(),  0xbb);
        EXPECT(gbc.l(),  0xd3);
        EXPECT(gbc.sp(), 0x13ff);
        EXPECT(gbc.pc(), 0x2537);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 017A
        gbc.setState(0x1e03, 0xc8ca, 0xaf60, 0xf293, 0x3a00, 0x44c5, 0x1, 0x1);
        gbc.writeMem(0x1e03, { 0xd4, 0x6f, 0xe1 });
        gbc.writeMem(0xc8c8, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xaf);
        EXPECT(gbc.b(),  0xf2);
        EXPECT(gbc.c(),  0x93);
        EXPECT(gbc.d(),  0x3a);
        EXPECT(gbc.e(),  0x0);
        EXPECT(gbc.h(),  0x44);
        EXPECT(gbc.l(),  0xc5);
        EXPECT(gbc.sp(), 0xc8c8);
        EXPECT(gbc.pc(), 0xe16f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc8c8), 0x6);
        EXPECT(gbc.readMem(0xc8c9), 0x1e);
        // D4 017B
        gbc.setState(0x69b2, 0x8e61, 0xa310, 0x19ba, 0xefc8, 0x6ff7, 0x0, 0x0);
        gbc.writeMem(0x69b2, { 0xd4, 0xaf, 0x5c });
        gbc.step();
        EXPECT(gbc.a(),  0xa3);
        EXPECT(gbc.b(),  0x19);
        EXPECT(gbc.c(),  0xba);
        EXPECT(gbc.d(),  0xef);
        EXPECT(gbc.e(),  0xc8);
        EXPECT(gbc.h(),  0x6f);
        EXPECT(gbc.l(),  0xf7);
        EXPECT(gbc.sp(), 0x8e61);
        EXPECT(gbc.pc(), 0x69b5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 017C
        gbc.setState(0x956a, 0xf7fb, 0x4620, 0x7d3c, 0x9eb, 0x8e3c, 0x0, 0x0);
        gbc.writeMem(0x956a, { 0xd4, 0x9f, 0xc1 });
        gbc.writeMem(0xf7f9, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x46);
        EXPECT(gbc.b(),  0x7d);
        EXPECT(gbc.c(),  0x3c);
        EXPECT(gbc.d(),  0x9);
        EXPECT(gbc.e(),  0xeb);
        EXPECT(gbc.h(),  0x8e);
        EXPECT(gbc.l(),  0x3c);
        EXPECT(gbc.sp(), 0xf7f9);
        EXPECT(gbc.pc(), 0xc19f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x956a), 0xd4);
        EXPECT(gbc.readMem(0x956b), 0x9f);
        EXPECT(gbc.readMem(0x956c), 0xc1);
        EXPECT(gbc.readMem(0xf7f9), 0x6d);
        EXPECT(gbc.readMem(0xf7fa), 0x95);
        // D4 017E
        gbc.setState(0xe90b, 0xe54f, 0x9870, 0xec18, 0xb651, 0x77ea, 0x1, 0x0);
        gbc.writeMem(0xe90b, { 0xd4, 0x1, 0x77 });
        gbc.step();
        EXPECT(gbc.a(),  0x98);
        EXPECT(gbc.b(),  0xec);
        EXPECT(gbc.c(),  0x18);
        EXPECT(gbc.d(),  0xb6);
        EXPECT(gbc.e(),  0x51);
        EXPECT(gbc.h(),  0x77);
        EXPECT(gbc.l(),  0xea);
        EXPECT(gbc.sp(), 0xe54f);
        EXPECT(gbc.pc(), 0xe90e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe90b), 0xd4);
        EXPECT(gbc.readMem(0xe90c), 0x1);
        EXPECT(gbc.readMem(0xe90d), 0x77);
        // D4 017F
        gbc.setState(0x88bc, 0xe25e, 0x3970, 0xa719, 0xb971, 0x94ce, 0x0, 0x0);
        gbc.writeMem(0x88bc, { 0xd4, 0x5, 0xd7 });
        gbc.step();
        EXPECT(gbc.a(),  0x39);
        EXPECT(gbc.b(),  0xa7);
        EXPECT(gbc.c(),  0x19);
        EXPECT(gbc.d(),  0xb9);
        EXPECT(gbc.e(),  0x71);
        EXPECT(gbc.h(),  0x94);
        EXPECT(gbc.l(),  0xce);
        EXPECT(gbc.sp(), 0xe25e);
        EXPECT(gbc.pc(), 0x88bf);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x88bc), 0xd4);
        EXPECT(gbc.readMem(0x88bd), 0x5);
        EXPECT(gbc.readMem(0x88be), 0xd7);
        // D4 0180
        gbc.setState(0xed56, 0xf5a7, 0x6f80, 0x8976, 0x781b, 0x4a1c, 0x0, 0x0);
        gbc.writeMem(0xed56, { 0xd4, 0xd8, 0x79 });
        gbc.writeMem(0xf5a5, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x6f);
        EXPECT(gbc.b(),  0x89);
        EXPECT(gbc.c(),  0x76);
        EXPECT(gbc.d(),  0x78);
        EXPECT(gbc.e(),  0x1b);
        EXPECT(gbc.h(),  0x4a);
        EXPECT(gbc.l(),  0x1c);
        EXPECT(gbc.sp(), 0xf5a5);
        EXPECT(gbc.pc(), 0x79d8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xed56), 0xd4);
        EXPECT(gbc.readMem(0xed57), 0xd8);
        EXPECT(gbc.readMem(0xed58), 0x79);
        EXPECT(gbc.readMem(0xf5a5), 0x59);
        EXPECT(gbc.readMem(0xf5a6), 0xed);
        // D4 0182
        gbc.setState(0x7664, 0x6907, 0xc930, 0xab4, 0xb4f4, 0x7fdc, 0x0, 0x0);
        gbc.writeMem(0x7664, { 0xd4, 0x65, 0x46 });
        gbc.step();
        EXPECT(gbc.a(),  0xc9);
        EXPECT(gbc.b(),  0xa);
        EXPECT(gbc.c(),  0xb4);
        EXPECT(gbc.d(),  0xb4);
        EXPECT(gbc.e(),  0xf4);
        EXPECT(gbc.h(),  0x7f);
        EXPECT(gbc.l(),  0xdc);
        EXPECT(gbc.sp(), 0x6907);
        EXPECT(gbc.pc(), 0x7667);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0183
        gbc.setState(0xac79, 0x4542, 0xed0, 0xf111, 0xc949, 0xb07b, 0x1, 0x1);
        gbc.writeMem(0xac79, { 0xd4, 0xad, 0x2b });
        gbc.step();
        EXPECT(gbc.a(),  0xe);
        EXPECT(gbc.b(),  0xf1);
        EXPECT(gbc.c(),  0x11);
        EXPECT(gbc.d(),  0xc9);
        EXPECT(gbc.e(),  0x49);
        EXPECT(gbc.h(),  0xb0);
        EXPECT(gbc.l(),  0x7b);
        EXPECT(gbc.sp(), 0x4542);
        EXPECT(gbc.pc(), 0xac7c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xac79), 0xd4);
        EXPECT(gbc.readMem(0xac7a), 0xad);
        EXPECT(gbc.readMem(0xac7b), 0x2b);
        // D4 0184
        gbc.setState(0x7a66, 0xb585, 0x6e30, 0x80c3, 0xdaca, 0x5178, 0x0, 0x0);
        gbc.writeMem(0x7a66, { 0xd4, 0x41, 0xa0 });
        gbc.step();
        EXPECT(gbc.a(),  0x6e);
        EXPECT(gbc.b(),  0x80);
        EXPECT(gbc.c(),  0xc3);
        EXPECT(gbc.d(),  0xda);
        EXPECT(gbc.e(),  0xca);
        EXPECT(gbc.h(),  0x51);
        EXPECT(gbc.l(),  0x78);
        EXPECT(gbc.sp(), 0xb585);
        EXPECT(gbc.pc(), 0x7a69);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0187
        gbc.setState(0xb30a, 0xee31, 0x9900, 0x3aaf, 0x9379, 0x8300, 0x0, 0x1);
        gbc.writeMem(0xb30a, { 0xd4, 0xe5, 0xd7 });
        gbc.writeMem(0xee2f, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x99);
        EXPECT(gbc.b(),  0x3a);
        EXPECT(gbc.c(),  0xaf);
        EXPECT(gbc.d(),  0x93);
        EXPECT(gbc.e(),  0x79);
        EXPECT(gbc.h(),  0x83);
        EXPECT(gbc.l(),  0x0);
        EXPECT(gbc.sp(), 0xee2f);
        EXPECT(gbc.pc(), 0xd7e5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb30a), 0xd4);
        EXPECT(gbc.readMem(0xb30b), 0xe5);
        EXPECT(gbc.readMem(0xb30c), 0xd7);
        EXPECT(gbc.readMem(0xee2f), 0xd);
        EXPECT(gbc.readMem(0xee30), 0xb3);
        // D4 0188
        gbc.setState(0x3ece, 0x9e30, 0xbd00, 0x849d, 0xab48, 0x12b9, 0x0, 0x1);
        gbc.writeMem(0x3ece, { 0xd4, 0x4, 0xae });
        gbc.writeMem(0x9e2e, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xbd);
        EXPECT(gbc.b(),  0x84);
        EXPECT(gbc.c(),  0x9d);
        EXPECT(gbc.d(),  0xab);
        EXPECT(gbc.e(),  0x48);
        EXPECT(gbc.h(),  0x12);
        EXPECT(gbc.l(),  0xb9);
        EXPECT(gbc.sp(), 0x9e2e);
        EXPECT(gbc.pc(), 0xae04);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9e2e), 0xd1);
        EXPECT(gbc.readMem(0x9e2f), 0x3e);
        // D4 0189
        gbc.setState(0xbf1d, 0xcf7a, 0xdf80, 0x955b, 0xb204, 0x828, 0x0, 0x1);
        gbc.writeMem(0xbf1d, { 0xd4, 0x63, 0x47 });
        gbc.writeMem(0xcf78, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xdf);
        EXPECT(gbc.b(),  0x95);
        EXPECT(gbc.c(),  0x5b);
        EXPECT(gbc.d(),  0xb2);
        EXPECT(gbc.e(),  0x4);
        EXPECT(gbc.h(),  0x8);
        EXPECT(gbc.l(),  0x28);
        EXPECT(gbc.sp(), 0xcf78);
        EXPECT(gbc.pc(), 0x4763);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbf1d), 0xd4);
        EXPECT(gbc.readMem(0xbf1e), 0x63);
        EXPECT(gbc.readMem(0xbf1f), 0x47);
        EXPECT(gbc.readMem(0xcf78), 0x20);
        EXPECT(gbc.readMem(0xcf79), 0xbf);
        // D4 018A
        gbc.setState(0x45cf, 0xe9e8, 0xbce0, 0x980a, 0x13f4, 0x2c3b, 0x0, 0x0);
        gbc.writeMem(0x45cf, { 0xd4, 0x1c, 0x27 });
        gbc.writeMem(0xe9e6, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xbc);
        EXPECT(gbc.b(),  0x98);
        EXPECT(gbc.c(),  0xa);
        EXPECT(gbc.d(),  0x13);
        EXPECT(gbc.e(),  0xf4);
        EXPECT(gbc.h(),  0x2c);
        EXPECT(gbc.l(),  0x3b);
        EXPECT(gbc.sp(), 0xe9e6);
        EXPECT(gbc.pc(), 0x271c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe9e6), 0xd2);
        EXPECT(gbc.readMem(0xe9e7), 0x45);
        // D4 018B
        gbc.setState(0xb7db, 0xc3e1, 0xcc30, 0xe46d, 0xd112, 0xc299, 0x1, 0x0);
        gbc.writeMem(0xb7db, { 0xd4, 0x6f, 0x28 });
        gbc.step();
        EXPECT(gbc.a(),  0xcc);
        EXPECT(gbc.b(),  0xe4);
        EXPECT(gbc.c(),  0x6d);
        EXPECT(gbc.d(),  0xd1);
        EXPECT(gbc.e(),  0x12);
        EXPECT(gbc.h(),  0xc2);
        EXPECT(gbc.l(),  0x99);
        EXPECT(gbc.sp(), 0xc3e1);
        EXPECT(gbc.pc(), 0xb7de);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb7db), 0xd4);
        EXPECT(gbc.readMem(0xb7dc), 0x6f);
        EXPECT(gbc.readMem(0xb7dd), 0x28);
        // D4 018C
        gbc.setState(0x9e25, 0x4649, 0xd5f0, 0x1c94, 0xe67f, 0xa145, 0x1, 0x0);
        gbc.writeMem(0x9e25, { 0xd4, 0xaa, 0x3b });
        gbc.step();
        EXPECT(gbc.a(),  0xd5);
        EXPECT(gbc.b(),  0x1c);
        EXPECT(gbc.c(),  0x94);
        EXPECT(gbc.d(),  0xe6);
        EXPECT(gbc.e(),  0x7f);
        EXPECT(gbc.h(),  0xa1);
        EXPECT(gbc.l(),  0x45);
        EXPECT(gbc.sp(), 0x4649);
        EXPECT(gbc.pc(), 0x9e28);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9e25), 0xd4);
        EXPECT(gbc.readMem(0x9e26), 0xaa);
        EXPECT(gbc.readMem(0x9e27), 0x3b);
        // D4 018D
        gbc.setState(0x6594, 0xeb54, 0xfbf0, 0xb4af, 0x702b, 0xe7a, 0x0, 0x0);
        gbc.writeMem(0x6594, { 0xd4, 0x33, 0x1a });
        gbc.step();
        EXPECT(gbc.a(),  0xfb);
        EXPECT(gbc.b(),  0xb4);
        EXPECT(gbc.c(),  0xaf);
        EXPECT(gbc.d(),  0x70);
        EXPECT(gbc.e(),  0x2b);
        EXPECT(gbc.h(),  0xe);
        EXPECT(gbc.l(),  0x7a);
        EXPECT(gbc.sp(), 0xeb54);
        EXPECT(gbc.pc(), 0x6597);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 018E
        gbc.setState(0xc71e, 0xeb9d, 0x4120, 0x14b7, 0x41bd, 0xa155, 0x1, 0x0);
        gbc.writeMem(0xc71e, { 0xd4, 0x0, 0xe9 });
        gbc.writeMem(0xeb9b, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x41);
        EXPECT(gbc.b(),  0x14);
        EXPECT(gbc.c(),  0xb7);
        EXPECT(gbc.d(),  0x41);
        EXPECT(gbc.e(),  0xbd);
        EXPECT(gbc.h(),  0xa1);
        EXPECT(gbc.l(),  0x55);
        EXPECT(gbc.sp(), 0xeb9b);
        EXPECT(gbc.pc(), 0xe900);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc71e), 0xd4);
        EXPECT(gbc.readMem(0xc71f), 0x0);
        EXPECT(gbc.readMem(0xc720), 0xe9);
        EXPECT(gbc.readMem(0xeb9b), 0x21);
        EXPECT(gbc.readMem(0xeb9c), 0xc7);
        // D4 0190
        gbc.setState(0xb573, 0xe2f9, 0x7a80, 0x53f, 0x7525, 0xabdf, 0x0, 0x0);
        gbc.writeMem(0xb573, { 0xd4, 0x94, 0xb });
        gbc.writeMem(0xe2f7, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x7a);
        EXPECT(gbc.b(),  0x5);
        EXPECT(gbc.c(),  0x3f);
        EXPECT(gbc.d(),  0x75);
        EXPECT(gbc.e(),  0x25);
        EXPECT(gbc.h(),  0xab);
        EXPECT(gbc.l(),  0xdf);
        EXPECT(gbc.sp(), 0xe2f7);
        EXPECT(gbc.pc(), 0xb94);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb573), 0xd4);
        EXPECT(gbc.readMem(0xb574), 0x94);
        EXPECT(gbc.readMem(0xb575), 0xb);
        EXPECT(gbc.readMem(0xe2f7), 0x76);
        EXPECT(gbc.readMem(0xe2f8), 0xb5);
        // D4 0192
        gbc.setState(0x4b8d, 0x2638, 0xf930, 0xdf4d, 0xe91a, 0x50f2, 0x0, 0x1);
        gbc.writeMem(0x4b8d, { 0xd4, 0x41, 0x39 });
        gbc.step();
        EXPECT(gbc.a(),  0xf9);
        EXPECT(gbc.b(),  0xdf);
        EXPECT(gbc.c(),  0x4d);
        EXPECT(gbc.d(),  0xe9);
        EXPECT(gbc.e(),  0x1a);
        EXPECT(gbc.h(),  0x50);
        EXPECT(gbc.l(),  0xf2);
        EXPECT(gbc.sp(), 0x2638);
        EXPECT(gbc.pc(), 0x4b90);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0193
        gbc.setState(0xd72b, 0xb1ee, 0xf720, 0xbf2b, 0x46a0, 0x5eab, 0x0, 0x1);
        gbc.writeMem(0xb1ec, { 0x0, 0x0 });
        gbc.writeMem(0xd72b, { 0xd4, 0xbf, 0xab });
        gbc.step();
        EXPECT(gbc.a(),  0xf7);
        EXPECT(gbc.b(),  0xbf);
        EXPECT(gbc.c(),  0x2b);
        EXPECT(gbc.d(),  0x46);
        EXPECT(gbc.e(),  0xa0);
        EXPECT(gbc.h(),  0x5e);
        EXPECT(gbc.l(),  0xab);
        EXPECT(gbc.sp(), 0xb1ec);
        EXPECT(gbc.pc(), 0xabbf);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb1ec), 0x2e);
        EXPECT(gbc.readMem(0xb1ed), 0xd7);
        EXPECT(gbc.readMem(0xd72b), 0xd4);
        EXPECT(gbc.readMem(0xd72c), 0xbf);
        EXPECT(gbc.readMem(0xd72d), 0xab);
        // D4 0194
        gbc.setState(0x23e1, 0x4f33, 0x4fd0, 0x55fc, 0x9f3f, 0x5cf3, 0x0, 0x0);
        gbc.writeMem(0x23e1, { 0xd4, 0x78, 0xa7 });
        gbc.step();
        EXPECT(gbc.a(),  0x4f);
        EXPECT(gbc.b(),  0x55);
        EXPECT(gbc.c(),  0xfc);
        EXPECT(gbc.d(),  0x9f);
        EXPECT(gbc.e(),  0x3f);
        EXPECT(gbc.h(),  0x5c);
        EXPECT(gbc.l(),  0xf3);
        EXPECT(gbc.sp(), 0x4f33);
        EXPECT(gbc.pc(), 0x23e4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0195
        gbc.setState(0x9f31, 0x8fee, 0x5c00, 0x5d05, 0x9359, 0x1374, 0x1, 0x1);
        gbc.writeMem(0x8fec, { 0x0, 0x0 });
        gbc.writeMem(0x9f31, { 0xd4, 0x13, 0xcd });
        gbc.step();
        EXPECT(gbc.a(),  0x5c);
        EXPECT(gbc.b(),  0x5d);
        EXPECT(gbc.c(),  0x5);
        EXPECT(gbc.d(),  0x93);
        EXPECT(gbc.e(),  0x59);
        EXPECT(gbc.h(),  0x13);
        EXPECT(gbc.l(),  0x74);
        EXPECT(gbc.sp(), 0x8fec);
        EXPECT(gbc.pc(), 0xcd13);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8fec), 0x34);
        EXPECT(gbc.readMem(0x8fed), 0x9f);
        EXPECT(gbc.readMem(0x9f31), 0xd4);
        EXPECT(gbc.readMem(0x9f32), 0x13);
        EXPECT(gbc.readMem(0x9f33), 0xcd);
        // D4 0198
        gbc.setState(0x3e05, 0xcbd7, 0x410, 0xcebf, 0x9077, 0x8c58, 0x0, 0x0);
        gbc.writeMem(0x3e05, { 0xd4, 0x78, 0xf8 });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0xce);
        EXPECT(gbc.c(),  0xbf);
        EXPECT(gbc.d(),  0x90);
        EXPECT(gbc.e(),  0x77);
        EXPECT(gbc.h(),  0x8c);
        EXPECT(gbc.l(),  0x58);
        EXPECT(gbc.sp(), 0xcbd7);
        EXPECT(gbc.pc(), 0x3e08);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0199
        gbc.setState(0x69d1, 0xf287, 0x9b80, 0x3acb, 0xa7fc, 0x9af7, 0x1, 0x0);
        gbc.writeMem(0x69d1, { 0xd4, 0x9, 0x5d });
        gbc.writeMem(0xf285, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x9b);
        EXPECT(gbc.b(),  0x3a);
        EXPECT(gbc.c(),  0xcb);
        EXPECT(gbc.d(),  0xa7);
        EXPECT(gbc.e(),  0xfc);
        EXPECT(gbc.h(),  0x9a);
        EXPECT(gbc.l(),  0xf7);
        EXPECT(gbc.sp(), 0xf285);
        EXPECT(gbc.pc(), 0x5d09);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xf285), 0xd4);
        EXPECT(gbc.readMem(0xf286), 0x69);
        // D4 019A
        gbc.setState(0xd9b7, 0xaaad, 0xe990, 0x4640, 0xf100, 0x2b35, 0x1, 0x1);
        gbc.writeMem(0xd9b7, { 0xd4, 0x37, 0x2d });
        gbc.step();
        EXPECT(gbc.a(),  0xe9);
        EXPECT(gbc.b(),  0x46);
        EXPECT(gbc.c(),  0x40);
        EXPECT(gbc.d(),  0xf1);
        EXPECT(gbc.e(),  0x0);
        EXPECT(gbc.h(),  0x2b);
        EXPECT(gbc.l(),  0x35);
        EXPECT(gbc.sp(), 0xaaad);
        EXPECT(gbc.pc(), 0xd9ba);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd9b7), 0xd4);
        EXPECT(gbc.readMem(0xd9b8), 0x37);
        EXPECT(gbc.readMem(0xd9b9), 0x2d);
        // D4 019C
        gbc.setState(0x5c04, 0x5900, 0xe50, 0x3fcb, 0xcf71, 0xc098, 0x1, 0x0);
        gbc.writeMem(0x5c04, { 0xd4, 0x18, 0xe2 });
        gbc.step();
        EXPECT(gbc.a(),  0xe);
        EXPECT(gbc.b(),  0x3f);
        EXPECT(gbc.c(),  0xcb);
        EXPECT(gbc.d(),  0xcf);
        EXPECT(gbc.e(),  0x71);
        EXPECT(gbc.h(),  0xc0);
        EXPECT(gbc.l(),  0x98);
        EXPECT(gbc.sp(), 0x5900);
        EXPECT(gbc.pc(), 0x5c07);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 019D
        gbc.setState(0x7a4a, 0x88ed, 0xcf00, 0x9e9b, 0xd11, 0x2d0f, 0x0, 0x1);
        gbc.writeMem(0x7a4a, { 0xd4, 0xd3, 0xf4 });
        gbc.writeMem(0x88eb, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xcf);
        EXPECT(gbc.b(),  0x9e);
        EXPECT(gbc.c(),  0x9b);
        EXPECT(gbc.d(),  0xd);
        EXPECT(gbc.e(),  0x11);
        EXPECT(gbc.h(),  0x2d);
        EXPECT(gbc.l(),  0xf);
        EXPECT(gbc.sp(), 0x88eb);
        EXPECT(gbc.pc(), 0xf4d3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x88eb), 0x4d);
        EXPECT(gbc.readMem(0x88ec), 0x7a);
        // D4 01A0
        gbc.setState(0x6712, 0x5eca, 0xec50, 0xd2f9, 0xfef0, 0xc68a, 0x0, 0x0);
        gbc.writeMem(0x6712, { 0xd4, 0xac, 0x7f });
        gbc.step();
        EXPECT(gbc.a(),  0xec);
        EXPECT(gbc.b(),  0xd2);
        EXPECT(gbc.c(),  0xf9);
        EXPECT(gbc.d(),  0xfe);
        EXPECT(gbc.e(),  0xf0);
        EXPECT(gbc.h(),  0xc6);
        EXPECT(gbc.l(),  0x8a);
        EXPECT(gbc.sp(), 0x5eca);
        EXPECT(gbc.pc(), 0x6715);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 01A1
        gbc.setState(0x1903, 0xc34a, 0x6330, 0x244a, 0xb161, 0xf865, 0x1, 0x1);
        gbc.writeMem(0x1903, { 0xd4, 0x82, 0x22 });
        gbc.step();
        EXPECT(gbc.a(),  0x63);
        EXPECT(gbc.b(),  0x24);
        EXPECT(gbc.c(),  0x4a);
        EXPECT(gbc.d(),  0xb1);
        EXPECT(gbc.e(),  0x61);
        EXPECT(gbc.h(),  0xf8);
        EXPECT(gbc.l(),  0x65);
        EXPECT(gbc.sp(), 0xc34a);
        EXPECT(gbc.pc(), 0x1906);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 01A2
        gbc.setState(0xe45a, 0xc32f, 0x6d30, 0xf74f, 0x599, 0xb5b0, 0x1, 0x0);
        gbc.writeMem(0xe45a, { 0xd4, 0x73, 0x7d });
        gbc.step();
        EXPECT(gbc.a(),  0x6d);
        EXPECT(gbc.b(),  0xf7);
        EXPECT(gbc.c(),  0x4f);
        EXPECT(gbc.d(),  0x5);
        EXPECT(gbc.e(),  0x99);
        EXPECT(gbc.h(),  0xb5);
        EXPECT(gbc.l(),  0xb0);
        EXPECT(gbc.sp(), 0xc32f);
        EXPECT(gbc.pc(), 0xe45d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe45a), 0xd4);
        EXPECT(gbc.readMem(0xe45b), 0x73);
        EXPECT(gbc.readMem(0xe45c), 0x7d);
        // D4 01A3
        gbc.setState(0x258f, 0xa30d, 0x2810, 0x3842, 0x202b, 0x3772, 0x1, 0x0);
        gbc.writeMem(0x258f, { 0xd4, 0xb3, 0x79 });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0x38);
        EXPECT(gbc.c(),  0x42);
        EXPECT(gbc.d(),  0x20);
        EXPECT(gbc.e(),  0x2b);
        EXPECT(gbc.h(),  0x37);
        EXPECT(gbc.l(),  0x72);
        EXPECT(gbc.sp(), 0xa30d);
        EXPECT(gbc.pc(), 0x2592);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 01A4
        gbc.setState(0x2866, 0xd55d, 0x9120, 0xa6a3, 0xffe3, 0x610d, 0x1, 0x1);
        gbc.writeMem(0x2866, { 0xd4, 0x44, 0xe8 });
        gbc.writeMem(0xd55b, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x91);
        EXPECT(gbc.b(),  0xa6);
        EXPECT(gbc.c(),  0xa3);
        EXPECT(gbc.d(),  0xff);
        EXPECT(gbc.e(),  0xe3);
        EXPECT(gbc.h(),  0x61);
        EXPECT(gbc.l(),  0xd);
        EXPECT(gbc.sp(), 0xd55b);
        EXPECT(gbc.pc(), 0xe844);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd55b), 0x69);
        EXPECT(gbc.readMem(0xd55c), 0x28);
        // D4 01A6
        gbc.setState(0xb2fd, 0xa628, 0x41b0, 0x53be, 0x8f5, 0xa4a6, 0x1, 0x0);
        gbc.writeMem(0xb2fd, { 0xd4, 0xab, 0xce });
        gbc.step();
        EXPECT(gbc.a(),  0x41);
        EXPECT(gbc.b(),  0x53);
        EXPECT(gbc.c(),  0xbe);
        EXPECT(gbc.d(),  0x8);
        EXPECT(gbc.e(),  0xf5);
        EXPECT(gbc.h(),  0xa4);
        EXPECT(gbc.l(),  0xa6);
        EXPECT(gbc.sp(), 0xa628);
        EXPECT(gbc.pc(), 0xb300);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb2fd), 0xd4);
        EXPECT(gbc.readMem(0xb2fe), 0xab);
        EXPECT(gbc.readMem(0xb2ff), 0xce);
        // D4 01A7
        gbc.setState(0x5378, 0xc5be, 0xb700, 0xbe20, 0xfc1f, 0xf6b4, 0x0, 0x1);
        gbc.writeMem(0x5378, { 0xd4, 0x5, 0xad });
        gbc.writeMem(0xc5bc, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xb7);
        EXPECT(gbc.b(),  0xbe);
        EXPECT(gbc.c(),  0x20);
        EXPECT(gbc.d(),  0xfc);
        EXPECT(gbc.e(),  0x1f);
        EXPECT(gbc.h(),  0xf6);
        EXPECT(gbc.l(),  0xb4);
        EXPECT(gbc.sp(), 0xc5bc);
        EXPECT(gbc.pc(), 0xad05);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc5bc), 0x7b);
        EXPECT(gbc.readMem(0xc5bd), 0x53);
        // D4 01A8
        gbc.setState(0xa885, 0x43b4, 0x84b0, 0x3e2b, 0x1717, 0x4029, 0x1, 0x0);
        gbc.writeMem(0xa885, { 0xd4, 0x4c, 0xa });
        gbc.step();
        EXPECT(gbc.a(),  0x84);
        EXPECT(gbc.b(),  0x3e);
        EXPECT(gbc.c(),  0x2b);
        EXPECT(gbc.d(),  0x17);
        EXPECT(gbc.e(),  0x17);
        EXPECT(gbc.h(),  0x40);
        EXPECT(gbc.l(),  0x29);
        EXPECT(gbc.sp(), 0x43b4);
        EXPECT(gbc.pc(), 0xa888);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa885), 0xd4);
        EXPECT(gbc.readMem(0xa886), 0x4c);
        EXPECT(gbc.readMem(0xa887), 0xa);
        // D4 01A9
        gbc.setState(0x1360, 0xe3f8, 0x7260, 0x32f, 0xe5a7, 0xa3c9, 0x0, 0x1);
        gbc.writeMem(0x1360, { 0xd4, 0x53, 0xb });
        gbc.writeMem(0xe3f6, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x72);
        EXPECT(gbc.b(),  0x3);
        EXPECT(gbc.c(),  0x2f);
        EXPECT(gbc.d(),  0xe5);
        EXPECT(gbc.e(),  0xa7);
        EXPECT(gbc.h(),  0xa3);
        EXPECT(gbc.l(),  0xc9);
        EXPECT(gbc.sp(), 0xe3f6);
        EXPECT(gbc.pc(), 0xb53);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe3f6), 0x63);
        EXPECT(gbc.readMem(0xe3f7), 0x13);
        // D4 01AA
        gbc.setState(0xb136, 0x84d3, 0x47c0, 0x83bd, 0xb89a, 0xa6da, 0x1, 0x1);
        gbc.writeMem(0x84d1, { 0x0, 0x0 });
        gbc.writeMem(0xb136, { 0xd4, 0x45, 0x2f });
        gbc.step();
        EXPECT(gbc.a(),  0x47);
        EXPECT(gbc.b(),  0x83);
        EXPECT(gbc.c(),  0xbd);
        EXPECT(gbc.d(),  0xb8);
        EXPECT(gbc.e(),  0x9a);
        EXPECT(gbc.h(),  0xa6);
        EXPECT(gbc.l(),  0xda);
        EXPECT(gbc.sp(), 0x84d1);
        EXPECT(gbc.pc(), 0x2f45);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x84d1), 0x39);
        EXPECT(gbc.readMem(0x84d2), 0xb1);
        EXPECT(gbc.readMem(0xb136), 0xd4);
        EXPECT(gbc.readMem(0xb137), 0x45);
        EXPECT(gbc.readMem(0xb138), 0x2f);
        // D4 01AB
        gbc.setState(0x973c, 0x3792, 0xc810, 0x8f95, 0x736, 0x339f, 0x0, 0x0);
        gbc.writeMem(0x973c, { 0xd4, 0x8b, 0xe0 });
        gbc.step();
        EXPECT(gbc.a(),  0xc8);
        EXPECT(gbc.b(),  0x8f);
        EXPECT(gbc.c(),  0x95);
        EXPECT(gbc.d(),  0x7);
        EXPECT(gbc.e(),  0x36);
        EXPECT(gbc.h(),  0x33);
        EXPECT(gbc.l(),  0x9f);
        EXPECT(gbc.sp(), 0x3792);
        EXPECT(gbc.pc(), 0x973f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x973c), 0xd4);
        EXPECT(gbc.readMem(0x973d), 0x8b);
        EXPECT(gbc.readMem(0x973e), 0xe0);
        // D4 01AC
        gbc.setState(0x84aa, 0x969b, 0xaf20, 0x708d, 0xf873, 0x77fb, 0x0, 0x0);
        gbc.writeMem(0x84aa, { 0xd4, 0x46, 0x48 });
        gbc.writeMem(0x9699, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xaf);
        EXPECT(gbc.b(),  0x70);
        EXPECT(gbc.c(),  0x8d);
        EXPECT(gbc.d(),  0xf8);
        EXPECT(gbc.e(),  0x73);
        EXPECT(gbc.h(),  0x77);
        EXPECT(gbc.l(),  0xfb);
        EXPECT(gbc.sp(), 0x9699);
        EXPECT(gbc.pc(), 0x4846);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x84aa), 0xd4);
        EXPECT(gbc.readMem(0x84ab), 0x46);
        EXPECT(gbc.readMem(0x84ac), 0x48);
        EXPECT(gbc.readMem(0x9699), 0xad);
        EXPECT(gbc.readMem(0x969a), 0x84);
        // D4 01AE
        gbc.setState(0xaf91, 0xa6a9, 0x65d0, 0xbcd3, 0xfc41, 0xf503, 0x1, 0x1);
        gbc.writeMem(0xaf91, { 0xd4, 0xad, 0x51 });
        gbc.step();
        EXPECT(gbc.a(),  0x65);
        EXPECT(gbc.b(),  0xbc);
        EXPECT(gbc.c(),  0xd3);
        EXPECT(gbc.d(),  0xfc);
        EXPECT(gbc.e(),  0x41);
        EXPECT(gbc.h(),  0xf5);
        EXPECT(gbc.l(),  0x3);
        EXPECT(gbc.sp(), 0xa6a9);
        EXPECT(gbc.pc(), 0xaf94);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xaf91), 0xd4);
        EXPECT(gbc.readMem(0xaf92), 0xad);
        EXPECT(gbc.readMem(0xaf93), 0x51);
        // D4 01AF
        gbc.setState(0x729, 0x9596, 0x8bf0, 0xaf00, 0xf1ac, 0x51c2, 0x0, 0x0);
        gbc.writeMem(0x729, { 0xd4, 0x54, 0x49 });
        gbc.step();
        EXPECT(gbc.a(),  0x8b);
        EXPECT(gbc.b(),  0xaf);
        EXPECT(gbc.c(),  0x0);
        EXPECT(gbc.d(),  0xf1);
        EXPECT(gbc.e(),  0xac);
        EXPECT(gbc.h(),  0x51);
        EXPECT(gbc.l(),  0xc2);
        EXPECT(gbc.sp(), 0x9596);
        EXPECT(gbc.pc(), 0x72c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 01B1
        gbc.setState(0x22d2, 0xb0dc, 0xe240, 0x6b80, 0x5d70, 0xd74f, 0x1, 0x0);
        gbc.writeMem(0x22d2, { 0xd4, 0x96, 0xaa });
        gbc.writeMem(0xb0da, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xe2);
        EXPECT(gbc.b(),  0x6b);
        EXPECT(gbc.c(),  0x80);
        EXPECT(gbc.d(),  0x5d);
        EXPECT(gbc.e(),  0x70);
        EXPECT(gbc.h(),  0xd7);
        EXPECT(gbc.l(),  0x4f);
        EXPECT(gbc.sp(), 0xb0da);
        EXPECT(gbc.pc(), 0xaa96);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb0da), 0xd5);
        EXPECT(gbc.readMem(0xb0db), 0x22);
        // D4 01B5
        gbc.setState(0xaabb, 0xf532, 0x2750, 0xcaae, 0xddfd, 0x6809, 0x1, 0x1);
        gbc.writeMem(0xaabb, { 0xd4, 0xd0, 0x74 });
        gbc.step();
        EXPECT(gbc.a(),  0x27);
        EXPECT(gbc.b(),  0xca);
        EXPECT(gbc.c(),  0xae);
        EXPECT(gbc.d(),  0xdd);
        EXPECT(gbc.e(),  0xfd);
        EXPECT(gbc.h(),  0x68);
        EXPECT(gbc.l(),  0x9);
        EXPECT(gbc.sp(), 0xf532);
        EXPECT(gbc.pc(), 0xaabe);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xaabb), 0xd4);
        EXPECT(gbc.readMem(0xaabc), 0xd0);
        EXPECT(gbc.readMem(0xaabd), 0x74);
        // D4 01B6
        gbc.setState(0x3423, 0xa5bf, 0x87b0, 0xcd9, 0x594d, 0xb81d, 0x1, 0x0);
        gbc.writeMem(0x3423, { 0xd4, 0xf2, 0x77 });
        gbc.step();
        EXPECT(gbc.a(),  0x87);
        EXPECT(gbc.b(),  0xc);
        EXPECT(gbc.c(),  0xd9);
        EXPECT(gbc.d(),  0x59);
        EXPECT(gbc.e(),  0x4d);
        EXPECT(gbc.h(),  0xb8);
        EXPECT(gbc.l(),  0x1d);
        EXPECT(gbc.sp(), 0xa5bf);
        EXPECT(gbc.pc(), 0x3426);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 01B7
        gbc.setState(0x5014, 0x15d2, 0xa3f0, 0x1bef, 0xf7b4, 0x4e9a, 0x0, 0x1);
        gbc.writeMem(0x5014, { 0xd4, 0xbf, 0x3a });
        gbc.step();
        EXPECT(gbc.a(),  0xa3);
        EXPECT(gbc.b(),  0x1b);
        EXPECT(gbc.c(),  0xef);
        EXPECT(gbc.d(),  0xf7);
        EXPECT(gbc.e(),  0xb4);
        EXPECT(gbc.h(),  0x4e);
        EXPECT(gbc.l(),  0x9a);
        EXPECT(gbc.sp(), 0x15d2);
        EXPECT(gbc.pc(), 0x5017);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 01B9
        gbc.setState(0x6c6, 0x16b5, 0x96d0, 0xe429, 0x5460, 0xf0ec, 0x1, 0x1);
        gbc.writeMem(0x6c6, { 0xd4, 0x73, 0x9 });
        gbc.step();
        EXPECT(gbc.a(),  0x96);
        EXPECT(gbc.b(),  0xe4);
        EXPECT(gbc.c(),  0x29);
        EXPECT(gbc.d(),  0x54);
        EXPECT(gbc.e(),  0x60);
        EXPECT(gbc.h(),  0xf0);
        EXPECT(gbc.l(),  0xec);
        EXPECT(gbc.sp(), 0x16b5);
        EXPECT(gbc.pc(), 0x6c9);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 01BA
        gbc.setState(0x45c2, 0x4ec2, 0xdd0, 0xf77c, 0x799e, 0xd476, 0x1, 0x0);
        gbc.writeMem(0x45c2, { 0xd4, 0x19, 0x62 });
        gbc.step();
        EXPECT(gbc.a(),  0xd);
        EXPECT(gbc.b(),  0xf7);
        EXPECT(gbc.c(),  0x7c);
        EXPECT(gbc.d(),  0x79);
        EXPECT(gbc.e(),  0x9e);
        EXPECT(gbc.h(),  0xd4);
        EXPECT(gbc.l(),  0x76);
        EXPECT(gbc.sp(), 0x4ec2);
        EXPECT(gbc.pc(), 0x45c5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 01BB
        gbc.setState(0xc962, 0xe8ce, 0x1770, 0xcc48, 0x16bc, 0xc75c, 0x0, 0x0);
        gbc.writeMem(0xc962, { 0xd4, 0x8a, 0x15 });
        gbc.step();
        EXPECT(gbc.a(),  0x17);
        EXPECT(gbc.b(),  0xcc);
        EXPECT(gbc.c(),  0x48);
        EXPECT(gbc.d(),  0x16);
        EXPECT(gbc.e(),  0xbc);
        EXPECT(gbc.h(),  0xc7);
        EXPECT(gbc.l(),  0x5c);
        EXPECT(gbc.sp(), 0xe8ce);
        EXPECT(gbc.pc(), 0xc965);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc962), 0xd4);
        EXPECT(gbc.readMem(0xc963), 0x8a);
        EXPECT(gbc.readMem(0xc964), 0x15);
        // D4 01BC
        gbc.setState(0x7c73, 0x4555, 0x3330, 0x7361, 0xdc47, 0xbe22, 0x0, 0x0);
        gbc.writeMem(0x7c73, { 0xd4, 0xee, 0x30 });
        gbc.step();
        EXPECT(gbc.a(),  0x33);
        EXPECT(gbc.b(),  0x73);
        EXPECT(gbc.c(),  0x61);
        EXPECT(gbc.d(),  0xdc);
        EXPECT(gbc.e(),  0x47);
        EXPECT(gbc.h(),  0xbe);
        EXPECT(gbc.l(),  0x22);
        EXPECT(gbc.sp(), 0x4555);
        EXPECT(gbc.pc(), 0x7c76);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 01BD
        gbc.setState(0xd9b1, 0x8ea3, 0x70c0, 0xea76, 0xbeb5, 0x4034, 0x1, 0x1);
        gbc.writeMem(0x8ea1, { 0x0, 0x0 });
        gbc.writeMem(0xd9b1, { 0xd4, 0x41, 0xee });
        gbc.step();
        EXPECT(gbc.a(),  0x70);
        EXPECT(gbc.b(),  0xea);
        EXPECT(gbc.c(),  0x76);
        EXPECT(gbc.d(),  0xbe);
        EXPECT(gbc.e(),  0xb5);
        EXPECT(gbc.h(),  0x40);
        EXPECT(gbc.l(),  0x34);
        EXPECT(gbc.sp(), 0x8ea1);
        EXPECT(gbc.pc(), 0xee41);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8ea1), 0xb4);
        EXPECT(gbc.readMem(0x8ea2), 0xd9);
        EXPECT(gbc.readMem(0xd9b1), 0xd4);
        EXPECT(gbc.readMem(0xd9b2), 0x41);
        EXPECT(gbc.readMem(0xd9b3), 0xee);
        // D4 01C0
        gbc.setState(0x4d44, 0xedf5, 0x3390, 0x4de2, 0x6950, 0x8888, 0x0, 0x0);
        gbc.writeMem(0x4d44, { 0xd4, 0x1e, 0x36 });
        gbc.step();
        EXPECT(gbc.a(),  0x33);
        EXPECT(gbc.b(),  0x4d);
        EXPECT(gbc.c(),  0xe2);
        EXPECT(gbc.d(),  0x69);
        EXPECT(gbc.e(),  0x50);
        EXPECT(gbc.h(),  0x88);
        EXPECT(gbc.l(),  0x88);
        EXPECT(gbc.sp(), 0xedf5);
        EXPECT(gbc.pc(), 0x4d47);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 01C1
        gbc.setState(0x2e6e, 0x1f20, 0xcb70, 0x8088, 0x839f, 0x6c99, 0x1, 0x0);
        gbc.writeMem(0x2e6e, { 0xd4, 0xe, 0x6d });
        gbc.step();
        EXPECT(gbc.a(),  0xcb);
        EXPECT(gbc.b(),  0x80);
        EXPECT(gbc.c(),  0x88);
        EXPECT(gbc.d(),  0x83);
        EXPECT(gbc.e(),  0x9f);
        EXPECT(gbc.h(),  0x6c);
        EXPECT(gbc.l(),  0x99);
        EXPECT(gbc.sp(), 0x1f20);
        EXPECT(gbc.pc(), 0x2e71);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 01C2
        gbc.setState(0xaec6, 0xd85a, 0x6030, 0x20d0, 0xc5c2, 0x5266, 0x0, 0x1);
        gbc.writeMem(0xaec6, { 0xd4, 0xba, 0x61 });
        gbc.step();
        EXPECT(gbc.a(),  0x60);
        EXPECT(gbc.b(),  0x20);
        EXPECT(gbc.c(),  0xd0);
        EXPECT(gbc.d(),  0xc5);
        EXPECT(gbc.e(),  0xc2);
        EXPECT(gbc.h(),  0x52);
        EXPECT(gbc.l(),  0x66);
        EXPECT(gbc.sp(), 0xd85a);
        EXPECT(gbc.pc(), 0xaec9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xaec6), 0xd4);
        EXPECT(gbc.readMem(0xaec7), 0xba);
        EXPECT(gbc.readMem(0xaec8), 0x61);
        // D4 01C3
        gbc.setState(0x7d3, 0x34d6, 0xabf0, 0x1013, 0xa21d, 0x2453, 0x0, 0x1);
        gbc.writeMem(0x7d3, { 0xd4, 0x9e, 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0xab);
        EXPECT(gbc.b(),  0x10);
        EXPECT(gbc.c(),  0x13);
        EXPECT(gbc.d(),  0xa2);
        EXPECT(gbc.e(),  0x1d);
        EXPECT(gbc.h(),  0x24);
        EXPECT(gbc.l(),  0x53);
        EXPECT(gbc.sp(), 0x34d6);
        EXPECT(gbc.pc(), 0x7d6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 01C5
        gbc.setState(0x28c9, 0xb2de, 0x2810, 0xc9a7, 0x852, 0x1035, 0x0, 0x0);
        gbc.writeMem(0x28c9, { 0xd4, 0xe4, 0xf0 });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0xc9);
        EXPECT(gbc.c(),  0xa7);
        EXPECT(gbc.d(),  0x8);
        EXPECT(gbc.e(),  0x52);
        EXPECT(gbc.h(),  0x10);
        EXPECT(gbc.l(),  0x35);
        EXPECT(gbc.sp(), 0xb2de);
        EXPECT(gbc.pc(), 0x28cc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 01C6
        gbc.setState(0x6a9c, 0x3d11, 0x9710, 0x1140, 0x778f, 0x76c, 0x1, 0x1);
        gbc.writeMem(0x6a9c, { 0xd4, 0xd, 0xf });
        gbc.step();
        EXPECT(gbc.a(),  0x97);
        EXPECT(gbc.b(),  0x11);
        EXPECT(gbc.c(),  0x40);
        EXPECT(gbc.d(),  0x77);
        EXPECT(gbc.e(),  0x8f);
        EXPECT(gbc.h(),  0x7);
        EXPECT(gbc.l(),  0x6c);
        EXPECT(gbc.sp(), 0x3d11);
        EXPECT(gbc.pc(), 0x6a9f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 01C8
        gbc.setState(0xd1c9, 0x1a61, 0xf590, 0x750a, 0x859f, 0x2cdf, 0x1, 0x0);
        gbc.writeMem(0xd1c9, { 0xd4, 0x38, 0x89 });
        gbc.step();
        EXPECT(gbc.a(),  0xf5);
        EXPECT(gbc.b(),  0x75);
        EXPECT(gbc.c(),  0xa);
        EXPECT(gbc.d(),  0x85);
        EXPECT(gbc.e(),  0x9f);
        EXPECT(gbc.h(),  0x2c);
        EXPECT(gbc.l(),  0xdf);
        EXPECT(gbc.sp(), 0x1a61);
        EXPECT(gbc.pc(), 0xd1cc);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd1c9), 0xd4);
        EXPECT(gbc.readMem(0xd1ca), 0x38);
        EXPECT(gbc.readMem(0xd1cb), 0x89);
        // D4 01CB
        gbc.setState(0x9062, 0x8b33, 0x49c0, 0xb5a8, 0x341, 0x34a2, 0x0, 0x1);
        gbc.writeMem(0x8b31, { 0x0, 0x0 });
        gbc.writeMem(0x9062, { 0xd4, 0x41, 0xd4 });
        gbc.step();
        EXPECT(gbc.a(),  0x49);
        EXPECT(gbc.b(),  0xb5);
        EXPECT(gbc.c(),  0xa8);
        EXPECT(gbc.d(),  0x3);
        EXPECT(gbc.e(),  0x41);
        EXPECT(gbc.h(),  0x34);
        EXPECT(gbc.l(),  0xa2);
        EXPECT(gbc.sp(), 0x8b31);
        EXPECT(gbc.pc(), 0xd441);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8b31), 0x65);
        EXPECT(gbc.readMem(0x8b32), 0x90);
        EXPECT(gbc.readMem(0x9062), 0xd4);
        EXPECT(gbc.readMem(0x9063), 0x41);
        EXPECT(gbc.readMem(0x9064), 0xd4);
        // D4 01CD
        gbc.setState(0x7142, 0x561f, 0x7250, 0x969d, 0x527b, 0x9f9a, 0x0, 0x0);
        gbc.writeMem(0x7142, { 0xd4, 0xed, 0x2c });
        gbc.step();
        EXPECT(gbc.a(),  0x72);
        EXPECT(gbc.b(),  0x96);
        EXPECT(gbc.c(),  0x9d);
        EXPECT(gbc.d(),  0x52);
        EXPECT(gbc.e(),  0x7b);
        EXPECT(gbc.h(),  0x9f);
        EXPECT(gbc.l(),  0x9a);
        EXPECT(gbc.sp(), 0x561f);
        EXPECT(gbc.pc(), 0x7145);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 01CE
        gbc.setState(0x60ff, 0x7bec, 0x5fb0, 0x65ba, 0xc599, 0x3c2c, 0x0, 0x0);
        gbc.writeMem(0x60ff, { 0xd4, 0x2a, 0x84 });
        gbc.step();
        EXPECT(gbc.a(),  0x5f);
        EXPECT(gbc.b(),  0x65);
        EXPECT(gbc.c(),  0xba);
        EXPECT(gbc.d(),  0xc5);
        EXPECT(gbc.e(),  0x99);
        EXPECT(gbc.h(),  0x3c);
        EXPECT(gbc.l(),  0x2c);
        EXPECT(gbc.sp(), 0x7bec);
        EXPECT(gbc.pc(), 0x6102);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 01D0
        gbc.setState(0x8ed7, 0x2d6f, 0x7e90, 0x6f70, 0x5e7c, 0x40c5, 0x0, 0x1);
        gbc.writeMem(0x8ed7, { 0xd4, 0xf, 0x35 });
        gbc.step();
        EXPECT(gbc.a(),  0x7e);
        EXPECT(gbc.b(),  0x6f);
        EXPECT(gbc.c(),  0x70);
        EXPECT(gbc.d(),  0x5e);
        EXPECT(gbc.e(),  0x7c);
        EXPECT(gbc.h(),  0x40);
        EXPECT(gbc.l(),  0xc5);
        EXPECT(gbc.sp(), 0x2d6f);
        EXPECT(gbc.pc(), 0x8eda);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8ed7), 0xd4);
        EXPECT(gbc.readMem(0x8ed8), 0xf);
        EXPECT(gbc.readMem(0x8ed9), 0x35);
        // D4 01D1
        gbc.setState(0x664e, 0xe701, 0xeee0, 0x458d, 0xc002, 0x78e2, 0x0, 0x1);
        gbc.writeMem(0x664e, { 0xd4, 0xb9, 0x8d });
        gbc.writeMem(0xe6ff, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xee);
        EXPECT(gbc.b(),  0x45);
        EXPECT(gbc.c(),  0x8d);
        EXPECT(gbc.d(),  0xc0);
        EXPECT(gbc.e(),  0x2);
        EXPECT(gbc.h(),  0x78);
        EXPECT(gbc.l(),  0xe2);
        EXPECT(gbc.sp(), 0xe6ff);
        EXPECT(gbc.pc(), 0x8db9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe6ff), 0x51);
        EXPECT(gbc.readMem(0xe700), 0x66);
        // D4 01D5
        gbc.setState(0x480c, 0xbaa1, 0xfaa0, 0xe3b, 0xae69, 0xe953, 0x1, 0x1);
        gbc.writeMem(0x480c, { 0xd4, 0x49, 0xe1 });
        gbc.writeMem(0xba9f, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xfa);
        EXPECT(gbc.b(),  0xe);
        EXPECT(gbc.c(),  0x3b);
        EXPECT(gbc.d(),  0xae);
        EXPECT(gbc.e(),  0x69);
        EXPECT(gbc.h(),  0xe9);
        EXPECT(gbc.l(),  0x53);
        EXPECT(gbc.sp(), 0xba9f);
        EXPECT(gbc.pc(), 0xe149);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xba9f), 0xf);
        EXPECT(gbc.readMem(0xbaa0), 0x48);
        // D4 01D6
        gbc.setState(0x2afb, 0xb4c1, 0xcd30, 0x5a3c, 0x707d, 0xd161, 0x0, 0x0);
        gbc.writeMem(0x2afb, { 0xd4, 0x3b, 0x3 });
        gbc.step();
        EXPECT(gbc.a(),  0xcd);
        EXPECT(gbc.b(),  0x5a);
        EXPECT(gbc.c(),  0x3c);
        EXPECT(gbc.d(),  0x70);
        EXPECT(gbc.e(),  0x7d);
        EXPECT(gbc.h(),  0xd1);
        EXPECT(gbc.l(),  0x61);
        EXPECT(gbc.sp(), 0xb4c1);
        EXPECT(gbc.pc(), 0x2afe);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 01D7
        gbc.setState(0x6d8b, 0xda4c, 0x3d10, 0x985d, 0x8544, 0xcce3, 0x0, 0x1);
        gbc.writeMem(0x6d8b, { 0xd4, 0x21, 0x8b });
        gbc.step();
        EXPECT(gbc.a(),  0x3d);
        EXPECT(gbc.b(),  0x98);
        EXPECT(gbc.c(),  0x5d);
        EXPECT(gbc.d(),  0x85);
        EXPECT(gbc.e(),  0x44);
        EXPECT(gbc.h(),  0xcc);
        EXPECT(gbc.l(),  0xe3);
        EXPECT(gbc.sp(), 0xda4c);
        EXPECT(gbc.pc(), 0x6d8e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 01D8
        gbc.setState(0x3617, 0x53f9, 0x2350, 0x4d1d, 0x45aa, 0x4124, 0x0, 0x0);
        gbc.writeMem(0x3617, { 0xd4, 0xe1, 0xfc });
        gbc.step();
        EXPECT(gbc.a(),  0x23);
        EXPECT(gbc.b(),  0x4d);
        EXPECT(gbc.c(),  0x1d);
        EXPECT(gbc.d(),  0x45);
        EXPECT(gbc.e(),  0xaa);
        EXPECT(gbc.h(),  0x41);
        EXPECT(gbc.l(),  0x24);
        EXPECT(gbc.sp(), 0x53f9);
        EXPECT(gbc.pc(), 0x361a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 01DB
        gbc.setState(0x24ec, 0x93bc, 0x50c0, 0x9cc1, 0x3004, 0x3541, 0x0, 0x0);
        gbc.writeMem(0x24ec, { 0xd4, 0x28, 0xb1 });
        gbc.writeMem(0x93ba, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x50);
        EXPECT(gbc.b(),  0x9c);
        EXPECT(gbc.c(),  0xc1);
        EXPECT(gbc.d(),  0x30);
        EXPECT(gbc.e(),  0x4);
        EXPECT(gbc.h(),  0x35);
        EXPECT(gbc.l(),  0x41);
        EXPECT(gbc.sp(), 0x93ba);
        EXPECT(gbc.pc(), 0xb128);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x93ba), 0xef);
        EXPECT(gbc.readMem(0x93bb), 0x24);
        // D4 01DC
        gbc.setState(0x9ff3, 0x8a21, 0x7260, 0x934, 0x200f, 0xc4b9, 0x0, 0x1);
        gbc.writeMem(0x8a1f, { 0x0, 0x0 });
        gbc.writeMem(0x9ff3, { 0xd4, 0x1a, 0x2c });
        gbc.step();
        EXPECT(gbc.a(),  0x72);
        EXPECT(gbc.b(),  0x9);
        EXPECT(gbc.c(),  0x34);
        EXPECT(gbc.d(),  0x20);
        EXPECT(gbc.e(),  0xf);
        EXPECT(gbc.h(),  0xc4);
        EXPECT(gbc.l(),  0xb9);
        EXPECT(gbc.sp(), 0x8a1f);
        EXPECT(gbc.pc(), 0x2c1a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8a1f), 0xf6);
        EXPECT(gbc.readMem(0x8a20), 0x9f);
        EXPECT(gbc.readMem(0x9ff3), 0xd4);
        EXPECT(gbc.readMem(0x9ff4), 0x1a);
        EXPECT(gbc.readMem(0x9ff5), 0x2c);
        // D4 01DE
        gbc.setState(0x5449, 0xcbd0, 0xa540, 0x956c, 0x43c3, 0xb2de, 0x0, 0x0);
        gbc.writeMem(0x5449, { 0xd4, 0x99, 0x7 });
        gbc.writeMem(0xcbce, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xa5);
        EXPECT(gbc.b(),  0x95);
        EXPECT(gbc.c(),  0x6c);
        EXPECT(gbc.d(),  0x43);
        EXPECT(gbc.e(),  0xc3);
        EXPECT(gbc.h(),  0xb2);
        EXPECT(gbc.l(),  0xde);
        EXPECT(gbc.sp(), 0xcbce);
        EXPECT(gbc.pc(), 0x799);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcbce), 0x4c);
        EXPECT(gbc.readMem(0xcbcf), 0x54);
        // D4 01DF
        gbc.setState(0x64ae, 0x1c15, 0x510, 0xc4b2, 0x5e22, 0x640d, 0x1, 0x0);
        gbc.writeMem(0x64ae, { 0xd4, 0xde, 0x5a });
        gbc.step();
        EXPECT(gbc.a(),  0x5);
        EXPECT(gbc.b(),  0xc4);
        EXPECT(gbc.c(),  0xb2);
        EXPECT(gbc.d(),  0x5e);
        EXPECT(gbc.e(),  0x22);
        EXPECT(gbc.h(),  0x64);
        EXPECT(gbc.l(),  0xd);
        EXPECT(gbc.sp(), 0x1c15);
        EXPECT(gbc.pc(), 0x64b1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 01E0
        gbc.setState(0x6d32, 0x9103, 0x1ad0, 0x4554, 0xb5b5, 0x9c1a, 0x0, 0x0);
        gbc.writeMem(0x6d32, { 0xd4, 0xb1, 0xa9 });
        gbc.step();
        EXPECT(gbc.a(),  0x1a);
        EXPECT(gbc.b(),  0x45);
        EXPECT(gbc.c(),  0x54);
        EXPECT(gbc.d(),  0xb5);
        EXPECT(gbc.e(),  0xb5);
        EXPECT(gbc.h(),  0x9c);
        EXPECT(gbc.l(),  0x1a);
        EXPECT(gbc.sp(), 0x9103);
        EXPECT(gbc.pc(), 0x6d35);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 01E1
        gbc.setState(0x1d90, 0xe7a9, 0xda0, 0x17b3, 0x6dbb, 0xeea1, 0x0, 0x1);
        gbc.writeMem(0x1d90, { 0xd4, 0xa6, 0xb5 });
        gbc.writeMem(0xe7a7, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xd);
        EXPECT(gbc.b(),  0x17);
        EXPECT(gbc.c(),  0xb3);
        EXPECT(gbc.d(),  0x6d);
        EXPECT(gbc.e(),  0xbb);
        EXPECT(gbc.h(),  0xee);
        EXPECT(gbc.l(),  0xa1);
        EXPECT(gbc.sp(), 0xe7a7);
        EXPECT(gbc.pc(), 0xb5a6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe7a7), 0x93);
        EXPECT(gbc.readMem(0xe7a8), 0x1d);
        // D4 01E2
        gbc.setState(0xb759, 0xe2b2, 0xb960, 0xf77c, 0x231d, 0x4d99, 0x1, 0x0);
        gbc.writeMem(0xb759, { 0xd4, 0xd2, 0x17 });
        gbc.writeMem(0xe2b0, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xb9);
        EXPECT(gbc.b(),  0xf7);
        EXPECT(gbc.c(),  0x7c);
        EXPECT(gbc.d(),  0x23);
        EXPECT(gbc.e(),  0x1d);
        EXPECT(gbc.h(),  0x4d);
        EXPECT(gbc.l(),  0x99);
        EXPECT(gbc.sp(), 0xe2b0);
        EXPECT(gbc.pc(), 0x17d2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb759), 0xd4);
        EXPECT(gbc.readMem(0xb75a), 0xd2);
        EXPECT(gbc.readMem(0xb75b), 0x17);
        EXPECT(gbc.readMem(0xe2b0), 0x5c);
        EXPECT(gbc.readMem(0xe2b1), 0xb7);
        // D4 01E4
        gbc.setState(0x5712, 0xb390, 0x53a0, 0x59ef, 0xf4ad, 0xabff, 0x0, 0x0);
        gbc.writeMem(0x5712, { 0xd4, 0xf3, 0x96 });
        gbc.writeMem(0xb38e, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x53);
        EXPECT(gbc.b(),  0x59);
        EXPECT(gbc.c(),  0xef);
        EXPECT(gbc.d(),  0xf4);
        EXPECT(gbc.e(),  0xad);
        EXPECT(gbc.h(),  0xab);
        EXPECT(gbc.l(),  0xff);
        EXPECT(gbc.sp(), 0xb38e);
        EXPECT(gbc.pc(), 0x96f3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb38e), 0x15);
        EXPECT(gbc.readMem(0xb38f), 0x57);
        // D4 01E5
        gbc.setState(0xb504, 0xe967, 0x3f00, 0xfa87, 0x9865, 0x1381, 0x0, 0x0);
        gbc.writeMem(0xb504, { 0xd4, 0xb7, 0x3b });
        gbc.writeMem(0xe965, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x3f);
        EXPECT(gbc.b(),  0xfa);
        EXPECT(gbc.c(),  0x87);
        EXPECT(gbc.d(),  0x98);
        EXPECT(gbc.e(),  0x65);
        EXPECT(gbc.h(),  0x13);
        EXPECT(gbc.l(),  0x81);
        EXPECT(gbc.sp(), 0xe965);
        EXPECT(gbc.pc(), 0x3bb7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb504), 0xd4);
        EXPECT(gbc.readMem(0xb505), 0xb7);
        EXPECT(gbc.readMem(0xb506), 0x3b);
        EXPECT(gbc.readMem(0xe965), 0x7);
        EXPECT(gbc.readMem(0xe966), 0xb5);
        // D4 01E7
        gbc.setState(0xc76f, 0x9467, 0xe200, 0xfbe7, 0x9e5c, 0xadb6, 0x0, 0x1);
        gbc.writeMem(0x9465, { 0x0, 0x0 });
        gbc.writeMem(0xc76f, { 0xd4, 0xb, 0x6a });
        gbc.step();
        EXPECT(gbc.a(),  0xe2);
        EXPECT(gbc.b(),  0xfb);
        EXPECT(gbc.c(),  0xe7);
        EXPECT(gbc.d(),  0x9e);
        EXPECT(gbc.e(),  0x5c);
        EXPECT(gbc.h(),  0xad);
        EXPECT(gbc.l(),  0xb6);
        EXPECT(gbc.sp(), 0x9465);
        EXPECT(gbc.pc(), 0x6a0b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9465), 0x72);
        EXPECT(gbc.readMem(0x9466), 0xc7);
        EXPECT(gbc.readMem(0xc76f), 0xd4);
        EXPECT(gbc.readMem(0xc770), 0xb);
        EXPECT(gbc.readMem(0xc771), 0x6a);
        // D4 01E9
        gbc.setState(0x93ee, 0x784b, 0x8d0, 0x560c, 0x30e9, 0x3a65, 0x1, 0x1);
        gbc.writeMem(0x93ee, { 0xd4, 0x46, 0x45 });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0x56);
        EXPECT(gbc.c(),  0xc);
        EXPECT(gbc.d(),  0x30);
        EXPECT(gbc.e(),  0xe9);
        EXPECT(gbc.h(),  0x3a);
        EXPECT(gbc.l(),  0x65);
        EXPECT(gbc.sp(), 0x784b);
        EXPECT(gbc.pc(), 0x93f1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x93ee), 0xd4);
        EXPECT(gbc.readMem(0x93ef), 0x46);
        EXPECT(gbc.readMem(0x93f0), 0x45);
        // D4 01EA
        gbc.setState(0x10ac, 0x9873, 0xb330, 0xe33, 0xb43, 0x98d4, 0x1, 0x0);
        gbc.writeMem(0x10ac, { 0xd4, 0xa6, 0x58 });
        gbc.step();
        EXPECT(gbc.a(),  0xb3);
        EXPECT(gbc.b(),  0xe);
        EXPECT(gbc.c(),  0x33);
        EXPECT(gbc.d(),  0xb);
        EXPECT(gbc.e(),  0x43);
        EXPECT(gbc.h(),  0x98);
        EXPECT(gbc.l(),  0xd4);
        EXPECT(gbc.sp(), 0x9873);
        EXPECT(gbc.pc(), 0x10af);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 01EB
        gbc.setState(0x5730, 0x890b, 0xefc0, 0x66a3, 0xf190, 0x531, 0x1, 0x0);
        gbc.writeMem(0x5730, { 0xd4, 0xe6, 0xe3 });
        gbc.writeMem(0x8909, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xef);
        EXPECT(gbc.b(),  0x66);
        EXPECT(gbc.c(),  0xa3);
        EXPECT(gbc.d(),  0xf1);
        EXPECT(gbc.e(),  0x90);
        EXPECT(gbc.h(),  0x5);
        EXPECT(gbc.l(),  0x31);
        EXPECT(gbc.sp(), 0x8909);
        EXPECT(gbc.pc(), 0xe3e6);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8909), 0x33);
        EXPECT(gbc.readMem(0x890a), 0x57);
        // D4 01EC
        gbc.setState(0x2438, 0xc8bb, 0x5e80, 0xf4b4, 0x9957, 0x1ad4, 0x0, 0x1);
        gbc.writeMem(0x2438, { 0xd4, 0x41, 0xb6 });
        gbc.writeMem(0xc8b9, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x5e);
        EXPECT(gbc.b(),  0xf4);
        EXPECT(gbc.c(),  0xb4);
        EXPECT(gbc.d(),  0x99);
        EXPECT(gbc.e(),  0x57);
        EXPECT(gbc.h(),  0x1a);
        EXPECT(gbc.l(),  0xd4);
        EXPECT(gbc.sp(), 0xc8b9);
        EXPECT(gbc.pc(), 0xb641);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc8b9), 0x3b);
        EXPECT(gbc.readMem(0xc8ba), 0x24);
        // D4 01ED
        gbc.setState(0x4bdf, 0x6a3, 0x8890, 0xe2c2, 0xa0a0, 0x344, 0x0, 0x1);
        gbc.writeMem(0x4bdf, { 0xd4, 0x70, 0x19 });
        gbc.step();
        EXPECT(gbc.a(),  0x88);
        EXPECT(gbc.b(),  0xe2);
        EXPECT(gbc.c(),  0xc2);
        EXPECT(gbc.d(),  0xa0);
        EXPECT(gbc.e(),  0xa0);
        EXPECT(gbc.h(),  0x3);
        EXPECT(gbc.l(),  0x44);
        EXPECT(gbc.sp(), 0x6a3);
        EXPECT(gbc.pc(), 0x4be2);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 01EE
        gbc.setState(0x9c22, 0xc6b7, 0x18f0, 0x6074, 0xb305, 0xbf25, 0x1, 0x1);
        gbc.writeMem(0x9c22, { 0xd4, 0xd6, 0x6a });
        gbc.step();
        EXPECT(gbc.a(),  0x18);
        EXPECT(gbc.b(),  0x60);
        EXPECT(gbc.c(),  0x74);
        EXPECT(gbc.d(),  0xb3);
        EXPECT(gbc.e(),  0x5);
        EXPECT(gbc.h(),  0xbf);
        EXPECT(gbc.l(),  0x25);
        EXPECT(gbc.sp(), 0xc6b7);
        EXPECT(gbc.pc(), 0x9c25);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9c22), 0xd4);
        EXPECT(gbc.readMem(0x9c23), 0xd6);
        EXPECT(gbc.readMem(0x9c24), 0x6a);
        // D4 01EF
        gbc.setState(0x2e7d, 0x87b7, 0x40f0, 0xa611, 0x9647, 0xe77e, 0x0, 0x1);
        gbc.writeMem(0x2e7d, { 0xd4, 0xa3, 0x60 });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0xa6);
        EXPECT(gbc.c(),  0x11);
        EXPECT(gbc.d(),  0x96);
        EXPECT(gbc.e(),  0x47);
        EXPECT(gbc.h(),  0xe7);
        EXPECT(gbc.l(),  0x7e);
        EXPECT(gbc.sp(), 0x87b7);
        EXPECT(gbc.pc(), 0x2e80);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 01F0
        gbc.setState(0x35d9, 0xd72c, 0xe510, 0x349b, 0x3619, 0x7304, 0x0, 0x0);
        gbc.writeMem(0x35d9, { 0xd4, 0x7a, 0x58 });
        gbc.step();
        EXPECT(gbc.a(),  0xe5);
        EXPECT(gbc.b(),  0x34);
        EXPECT(gbc.c(),  0x9b);
        EXPECT(gbc.d(),  0x36);
        EXPECT(gbc.e(),  0x19);
        EXPECT(gbc.h(),  0x73);
        EXPECT(gbc.l(),  0x4);
        EXPECT(gbc.sp(), 0xd72c);
        EXPECT(gbc.pc(), 0x35dc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 01F1
        gbc.setState(0x3093, 0x86bd, 0xcd60, 0x6e68, 0x3ff5, 0x5b60, 0x0, 0x0);
        gbc.writeMem(0x3093, { 0xd4, 0x48, 0x9a });
        gbc.writeMem(0x86bb, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xcd);
        EXPECT(gbc.b(),  0x6e);
        EXPECT(gbc.c(),  0x68);
        EXPECT(gbc.d(),  0x3f);
        EXPECT(gbc.e(),  0xf5);
        EXPECT(gbc.h(),  0x5b);
        EXPECT(gbc.l(),  0x60);
        EXPECT(gbc.sp(), 0x86bb);
        EXPECT(gbc.pc(), 0x9a48);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x86bb), 0x96);
        EXPECT(gbc.readMem(0x86bc), 0x30);
        // D4 01F2
        gbc.setState(0xceca, 0x92a4, 0x8320, 0x4c0f, 0x2893, 0x8907, 0x1, 0x1);
        gbc.writeMem(0x92a2, { 0x0, 0x0 });
        gbc.writeMem(0xceca, { 0xd4, 0x69, 0xc4 });
        gbc.step();
        EXPECT(gbc.a(),  0x83);
        EXPECT(gbc.b(),  0x4c);
        EXPECT(gbc.c(),  0xf);
        EXPECT(gbc.d(),  0x28);
        EXPECT(gbc.e(),  0x93);
        EXPECT(gbc.h(),  0x89);
        EXPECT(gbc.l(),  0x7);
        EXPECT(gbc.sp(), 0x92a2);
        EXPECT(gbc.pc(), 0xc469);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x92a2), 0xcd);
        EXPECT(gbc.readMem(0x92a3), 0xce);
        EXPECT(gbc.readMem(0xceca), 0xd4);
        EXPECT(gbc.readMem(0xcecb), 0x69);
        EXPECT(gbc.readMem(0xcecc), 0xc4);
        // D4 01F3
        gbc.setState(0xe7f6, 0x90c1, 0xde70, 0xc42e, 0xc75f, 0x885a, 0x1, 0x0);
        gbc.writeMem(0xe7f6, { 0xd4, 0x4b, 0x75 });
        gbc.step();
        EXPECT(gbc.a(),  0xde);
        EXPECT(gbc.b(),  0xc4);
        EXPECT(gbc.c(),  0x2e);
        EXPECT(gbc.d(),  0xc7);
        EXPECT(gbc.e(),  0x5f);
        EXPECT(gbc.h(),  0x88);
        EXPECT(gbc.l(),  0x5a);
        EXPECT(gbc.sp(), 0x90c1);
        EXPECT(gbc.pc(), 0xe7f9);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe7f6), 0xd4);
        EXPECT(gbc.readMem(0xe7f7), 0x4b);
        EXPECT(gbc.readMem(0xe7f8), 0x75);
        // D4 01F4
        gbc.setState(0x9b2b, 0x11a0, 0x490, 0x33f7, 0xe868, 0xeb04, 0x0, 0x0);
        gbc.writeMem(0x9b2b, { 0xd4, 0x9a, 0x3a });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0x33);
        EXPECT(gbc.c(),  0xf7);
        EXPECT(gbc.d(),  0xe8);
        EXPECT(gbc.e(),  0x68);
        EXPECT(gbc.h(),  0xeb);
        EXPECT(gbc.l(),  0x4);
        EXPECT(gbc.sp(), 0x11a0);
        EXPECT(gbc.pc(), 0x9b2e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9b2b), 0xd4);
        EXPECT(gbc.readMem(0x9b2c), 0x9a);
        EXPECT(gbc.readMem(0x9b2d), 0x3a);
        // D4 01F6
        gbc.setState(0xb7c8, 0xbc3, 0x56b0, 0x58a3, 0xc286, 0xec4a, 0x0, 0x1);
        gbc.writeMem(0xb7c8, { 0xd4, 0x74, 0xe0 });
        gbc.step();
        EXPECT(gbc.a(),  0x56);
        EXPECT(gbc.b(),  0x58);
        EXPECT(gbc.c(),  0xa3);
        EXPECT(gbc.d(),  0xc2);
        EXPECT(gbc.e(),  0x86);
        EXPECT(gbc.h(),  0xec);
        EXPECT(gbc.l(),  0x4a);
        EXPECT(gbc.sp(), 0xbc3);
        EXPECT(gbc.pc(), 0xb7cb);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb7c8), 0xd4);
        EXPECT(gbc.readMem(0xb7c9), 0x74);
        EXPECT(gbc.readMem(0xb7ca), 0xe0);
        // D4 01F7
        gbc.setState(0x3075, 0xad2c, 0x9e70, 0xb3a1, 0x2ede, 0x7d7a, 0x1, 0x0);
        gbc.writeMem(0x3075, { 0xd4, 0x1b, 0x66 });
        gbc.step();
        EXPECT(gbc.a(),  0x9e);
        EXPECT(gbc.b(),  0xb3);
        EXPECT(gbc.c(),  0xa1);
        EXPECT(gbc.d(),  0x2e);
        EXPECT(gbc.e(),  0xde);
        EXPECT(gbc.h(),  0x7d);
        EXPECT(gbc.l(),  0x7a);
        EXPECT(gbc.sp(), 0xad2c);
        EXPECT(gbc.pc(), 0x3078);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 01F9
        gbc.setState(0xa916, 0x66af, 0x4e10, 0xc00b, 0x79c0, 0x76ce, 0x1, 0x1);
        gbc.writeMem(0xa916, { 0xd4, 0x86, 0x86 });
        gbc.step();
        EXPECT(gbc.a(),  0x4e);
        EXPECT(gbc.b(),  0xc0);
        EXPECT(gbc.c(),  0xb);
        EXPECT(gbc.d(),  0x79);
        EXPECT(gbc.e(),  0xc0);
        EXPECT(gbc.h(),  0x76);
        EXPECT(gbc.l(),  0xce);
        EXPECT(gbc.sp(), 0x66af);
        EXPECT(gbc.pc(), 0xa919);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa916), 0xd4);
        EXPECT(gbc.readMem(0xa917), 0x86);
        EXPECT(gbc.readMem(0xa918), 0x86);
        // D4 01FA
        gbc.setState(0x1b24, 0x1a1e, 0x1d50, 0xae0d, 0x8f3f, 0x428b, 0x0, 0x0);
        gbc.writeMem(0x1b24, { 0xd4, 0x87, 0xd4 });
        gbc.step();
        EXPECT(gbc.a(),  0x1d);
        EXPECT(gbc.b(),  0xae);
        EXPECT(gbc.c(),  0xd);
        EXPECT(gbc.d(),  0x8f);
        EXPECT(gbc.e(),  0x3f);
        EXPECT(gbc.h(),  0x42);
        EXPECT(gbc.l(),  0x8b);
        EXPECT(gbc.sp(), 0x1a1e);
        EXPECT(gbc.pc(), 0x1b27);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 01FB
        gbc.setState(0x5582, 0x8e67, 0x7e00, 0x743c, 0x9754, 0x1846, 0x1, 0x0);
        gbc.writeMem(0x5582, { 0xd4, 0xea, 0x47 });
        gbc.writeMem(0x8e65, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x7e);
        EXPECT(gbc.b(),  0x74);
        EXPECT(gbc.c(),  0x3c);
        EXPECT(gbc.d(),  0x97);
        EXPECT(gbc.e(),  0x54);
        EXPECT(gbc.h(),  0x18);
        EXPECT(gbc.l(),  0x46);
        EXPECT(gbc.sp(), 0x8e65);
        EXPECT(gbc.pc(), 0x47ea);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8e65), 0x85);
        EXPECT(gbc.readMem(0x8e66), 0x55);
        // D4 01FD
        gbc.setState(0xd25b, 0xe6e5, 0x120, 0x6570, 0xcfba, 0xcff7, 0x0, 0x1);
        gbc.writeMem(0xd25b, { 0xd4, 0xfa, 0xce });
        gbc.writeMem(0xe6e3, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0x65);
        EXPECT(gbc.c(),  0x70);
        EXPECT(gbc.d(),  0xcf);
        EXPECT(gbc.e(),  0xba);
        EXPECT(gbc.h(),  0xcf);
        EXPECT(gbc.l(),  0xf7);
        EXPECT(gbc.sp(), 0xe6e3);
        EXPECT(gbc.pc(), 0xcefa);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd25b), 0xd4);
        EXPECT(gbc.readMem(0xd25c), 0xfa);
        EXPECT(gbc.readMem(0xd25d), 0xce);
        EXPECT(gbc.readMem(0xe6e3), 0x5e);
        EXPECT(gbc.readMem(0xe6e4), 0xd2);
        // D4 0200
        gbc.setState(0xeb0b, 0x6b7b, 0xba90, 0xb36f, 0xe74d, 0xbf67, 0x1, 0x0);
        gbc.writeMem(0xeb0b, { 0xd4, 0x10, 0x1 });
        gbc.step();
        EXPECT(gbc.a(),  0xba);
        EXPECT(gbc.b(),  0xb3);
        EXPECT(gbc.c(),  0x6f);
        EXPECT(gbc.d(),  0xe7);
        EXPECT(gbc.e(),  0x4d);
        EXPECT(gbc.h(),  0xbf);
        EXPECT(gbc.l(),  0x67);
        EXPECT(gbc.sp(), 0x6b7b);
        EXPECT(gbc.pc(), 0xeb0e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xeb0b), 0xd4);
        EXPECT(gbc.readMem(0xeb0c), 0x10);
        EXPECT(gbc.readMem(0xeb0d), 0x1);
        // D4 0201
        gbc.setState(0x9529, 0xef10, 0xf490, 0xbb07, 0x4544, 0xbd20, 0x0, 0x0);
        gbc.writeMem(0x9529, { 0xd4, 0x3a, 0x7f });
        gbc.step();
        EXPECT(gbc.a(),  0xf4);
        EXPECT(gbc.b(),  0xbb);
        EXPECT(gbc.c(),  0x7);
        EXPECT(gbc.d(),  0x45);
        EXPECT(gbc.e(),  0x44);
        EXPECT(gbc.h(),  0xbd);
        EXPECT(gbc.l(),  0x20);
        EXPECT(gbc.sp(), 0xef10);
        EXPECT(gbc.pc(), 0x952c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9529), 0xd4);
        EXPECT(gbc.readMem(0x952a), 0x3a);
        EXPECT(gbc.readMem(0x952b), 0x7f);
        // D4 0203
        gbc.setState(0x1245, 0x81b4, 0x8d90, 0x2422, 0x497c, 0x3ef7, 0x0, 0x1);
        gbc.writeMem(0x1245, { 0xd4, 0x2e, 0xc1 });
        gbc.step();
        EXPECT(gbc.a(),  0x8d);
        EXPECT(gbc.b(),  0x24);
        EXPECT(gbc.c(),  0x22);
        EXPECT(gbc.d(),  0x49);
        EXPECT(gbc.e(),  0x7c);
        EXPECT(gbc.h(),  0x3e);
        EXPECT(gbc.l(),  0xf7);
        EXPECT(gbc.sp(), 0x81b4);
        EXPECT(gbc.pc(), 0x1248);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0204
        gbc.setState(0x79bd, 0x603e, 0x38b0, 0xc40, 0xec18, 0xa6a, 0x0, 0x1);
        gbc.writeMem(0x79bd, { 0xd4, 0x29, 0x9c });
        gbc.step();
        EXPECT(gbc.a(),  0x38);
        EXPECT(gbc.b(),  0xc);
        EXPECT(gbc.c(),  0x40);
        EXPECT(gbc.d(),  0xec);
        EXPECT(gbc.e(),  0x18);
        EXPECT(gbc.h(),  0xa);
        EXPECT(gbc.l(),  0x6a);
        EXPECT(gbc.sp(), 0x603e);
        EXPECT(gbc.pc(), 0x79c0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0205
        gbc.setState(0xbd5a, 0x93a2, 0xe4c0, 0x3324, 0x2098, 0x3dac, 0x1, 0x0);
        gbc.writeMem(0x93a0, { 0x0, 0x0 });
        gbc.writeMem(0xbd5a, { 0xd4, 0x61, 0x82 });
        gbc.step();
        EXPECT(gbc.a(),  0xe4);
        EXPECT(gbc.b(),  0x33);
        EXPECT(gbc.c(),  0x24);
        EXPECT(gbc.d(),  0x20);
        EXPECT(gbc.e(),  0x98);
        EXPECT(gbc.h(),  0x3d);
        EXPECT(gbc.l(),  0xac);
        EXPECT(gbc.sp(), 0x93a0);
        EXPECT(gbc.pc(), 0x8261);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x93a0), 0x5d);
        EXPECT(gbc.readMem(0x93a1), 0xbd);
        EXPECT(gbc.readMem(0xbd5a), 0xd4);
        EXPECT(gbc.readMem(0xbd5b), 0x61);
        EXPECT(gbc.readMem(0xbd5c), 0x82);
        // D4 0207
        gbc.setState(0x4459, 0xa1e7, 0xac20, 0x1aa9, 0x635d, 0xfefa, 0x0, 0x1);
        gbc.writeMem(0x4459, { 0xd4, 0xe2, 0x2f });
        gbc.writeMem(0xa1e5, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xac);
        EXPECT(gbc.b(),  0x1a);
        EXPECT(gbc.c(),  0xa9);
        EXPECT(gbc.d(),  0x63);
        EXPECT(gbc.e(),  0x5d);
        EXPECT(gbc.h(),  0xfe);
        EXPECT(gbc.l(),  0xfa);
        EXPECT(gbc.sp(), 0xa1e5);
        EXPECT(gbc.pc(), 0x2fe2);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa1e5), 0x5c);
        EXPECT(gbc.readMem(0xa1e6), 0x44);
        // D4 0208
        gbc.setState(0x380e, 0xb33d, 0x1050, 0x9227, 0x8f9d, 0xc9dd, 0x1, 0x0);
        gbc.writeMem(0x380e, { 0xd4, 0x81, 0x23 });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0x92);
        EXPECT(gbc.c(),  0x27);
        EXPECT(gbc.d(),  0x8f);
        EXPECT(gbc.e(),  0x9d);
        EXPECT(gbc.h(),  0xc9);
        EXPECT(gbc.l(),  0xdd);
        EXPECT(gbc.sp(), 0xb33d);
        EXPECT(gbc.pc(), 0x3811);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 020A
        gbc.setState(0x1bc, 0x8789, 0xc130, 0x241c, 0xa4bc, 0x647b, 0x1, 0x0);
        gbc.writeMem(0x1bc, { 0xd4, 0x99, 0x87 });
        gbc.step();
        EXPECT(gbc.a(),  0xc1);
        EXPECT(gbc.b(),  0x24);
        EXPECT(gbc.c(),  0x1c);
        EXPECT(gbc.d(),  0xa4);
        EXPECT(gbc.e(),  0xbc);
        EXPECT(gbc.h(),  0x64);
        EXPECT(gbc.l(),  0x7b);
        EXPECT(gbc.sp(), 0x8789);
        EXPECT(gbc.pc(), 0x1bf);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 020B
        gbc.setState(0xb5f9, 0xa784, 0x4f70, 0x4ab8, 0x24f3, 0xacbf, 0x0, 0x1);
        gbc.writeMem(0xb5f9, { 0xd4, 0x40, 0xd6 });
        gbc.step();
        EXPECT(gbc.a(),  0x4f);
        EXPECT(gbc.b(),  0x4a);
        EXPECT(gbc.c(),  0xb8);
        EXPECT(gbc.d(),  0x24);
        EXPECT(gbc.e(),  0xf3);
        EXPECT(gbc.h(),  0xac);
        EXPECT(gbc.l(),  0xbf);
        EXPECT(gbc.sp(), 0xa784);
        EXPECT(gbc.pc(), 0xb5fc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb5f9), 0xd4);
        EXPECT(gbc.readMem(0xb5fa), 0x40);
        EXPECT(gbc.readMem(0xb5fb), 0xd6);
        // D4 020C
        gbc.setState(0xdb8f, 0xe7c0, 0x5ba0, 0xd593, 0x86a5, 0x6e59, 0x0, 0x0);
        gbc.writeMem(0xdb8f, { 0xd4, 0x57, 0x10 });
        gbc.writeMem(0xe7be, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x5b);
        EXPECT(gbc.b(),  0xd5);
        EXPECT(gbc.c(),  0x93);
        EXPECT(gbc.d(),  0x86);
        EXPECT(gbc.e(),  0xa5);
        EXPECT(gbc.h(),  0x6e);
        EXPECT(gbc.l(),  0x59);
        EXPECT(gbc.sp(), 0xe7be);
        EXPECT(gbc.pc(), 0x1057);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdb8f), 0xd4);
        EXPECT(gbc.readMem(0xdb90), 0x57);
        EXPECT(gbc.readMem(0xdb91), 0x10);
        EXPECT(gbc.readMem(0xe7be), 0x92);
        EXPECT(gbc.readMem(0xe7bf), 0xdb);
        // D4 020D
        gbc.setState(0xde22, 0x2f79, 0x2c70, 0xe134, 0x3aeb, 0xf103, 0x0, 0x0);
        gbc.writeMem(0xde22, { 0xd4, 0x94, 0x96 });
        gbc.step();
        EXPECT(gbc.a(),  0x2c);
        EXPECT(gbc.b(),  0xe1);
        EXPECT(gbc.c(),  0x34);
        EXPECT(gbc.d(),  0x3a);
        EXPECT(gbc.e(),  0xeb);
        EXPECT(gbc.h(),  0xf1);
        EXPECT(gbc.l(),  0x3);
        EXPECT(gbc.sp(), 0x2f79);
        EXPECT(gbc.pc(), 0xde25);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xde22), 0xd4);
        EXPECT(gbc.readMem(0xde23), 0x94);
        EXPECT(gbc.readMem(0xde24), 0x96);
        // D4 020E
        gbc.setState(0xec33, 0xed9e, 0xad70, 0x60f4, 0xe890, 0xbe85, 0x1, 0x0);
        gbc.writeMem(0xec33, { 0xd4, 0xa8, 0xd4 });
        gbc.step();
        EXPECT(gbc.a(),  0xad);
        EXPECT(gbc.b(),  0x60);
        EXPECT(gbc.c(),  0xf4);
        EXPECT(gbc.d(),  0xe8);
        EXPECT(gbc.e(),  0x90);
        EXPECT(gbc.h(),  0xbe);
        EXPECT(gbc.l(),  0x85);
        EXPECT(gbc.sp(), 0xed9e);
        EXPECT(gbc.pc(), 0xec36);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xec33), 0xd4);
        EXPECT(gbc.readMem(0xec34), 0xa8);
        EXPECT(gbc.readMem(0xec35), 0xd4);
        // D4 020F
        gbc.setState(0xc6b1, 0x86b1, 0x7a50, 0xb887, 0x8111, 0xdfe6, 0x0, 0x0);
        gbc.writeMem(0xc6b1, { 0xd4, 0x0, 0x14 });
        gbc.step();
        EXPECT(gbc.a(),  0x7a);
        EXPECT(gbc.b(),  0xb8);
        EXPECT(gbc.c(),  0x87);
        EXPECT(gbc.d(),  0x81);
        EXPECT(gbc.e(),  0x11);
        EXPECT(gbc.h(),  0xdf);
        EXPECT(gbc.l(),  0xe6);
        EXPECT(gbc.sp(), 0x86b1);
        EXPECT(gbc.pc(), 0xc6b4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc6b1), 0xd4);
        EXPECT(gbc.readMem(0xc6b2), 0x0);
        EXPECT(gbc.readMem(0xc6b3), 0x14);
        // D4 0210
        gbc.setState(0x389, 0x613c, 0xb4b0, 0x1473, 0xece0, 0x9b29, 0x0, 0x1);
        gbc.writeMem(0x389, { 0xd4, 0x24, 0x9d });
        gbc.step();
        EXPECT(gbc.a(),  0xb4);
        EXPECT(gbc.b(),  0x14);
        EXPECT(gbc.c(),  0x73);
        EXPECT(gbc.d(),  0xec);
        EXPECT(gbc.e(),  0xe0);
        EXPECT(gbc.h(),  0x9b);
        EXPECT(gbc.l(),  0x29);
        EXPECT(gbc.sp(), 0x613c);
        EXPECT(gbc.pc(), 0x38c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0211
        gbc.setState(0x56ab, 0x48d9, 0x1ef0, 0x5706, 0x72a3, 0xf76c, 0x1, 0x0);
        gbc.writeMem(0x56ab, { 0xd4, 0x47, 0x80 });
        gbc.step();
        EXPECT(gbc.a(),  0x1e);
        EXPECT(gbc.b(),  0x57);
        EXPECT(gbc.c(),  0x6);
        EXPECT(gbc.d(),  0x72);
        EXPECT(gbc.e(),  0xa3);
        EXPECT(gbc.h(),  0xf7);
        EXPECT(gbc.l(),  0x6c);
        EXPECT(gbc.sp(), 0x48d9);
        EXPECT(gbc.pc(), 0x56ae);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0215
        gbc.setState(0x37fb, 0xc266, 0x1da0, 0x5503, 0x2eef, 0x3b87, 0x1, 0x1);
        gbc.writeMem(0x37fb, { 0xd4, 0xc3, 0x20 });
        gbc.writeMem(0xc264, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x1d);
        EXPECT(gbc.b(),  0x55);
        EXPECT(gbc.c(),  0x3);
        EXPECT(gbc.d(),  0x2e);
        EXPECT(gbc.e(),  0xef);
        EXPECT(gbc.h(),  0x3b);
        EXPECT(gbc.l(),  0x87);
        EXPECT(gbc.sp(), 0xc264);
        EXPECT(gbc.pc(), 0x20c3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc264), 0xfe);
        EXPECT(gbc.readMem(0xc265), 0x37);
        // D4 0216
        gbc.setState(0x4b8, 0x892e, 0x2330, 0x2d01, 0x7fab, 0xdbcc, 0x1, 0x1);
        gbc.writeMem(0x4b8, { 0xd4, 0x4b, 0x8c });
        gbc.step();
        EXPECT(gbc.a(),  0x23);
        EXPECT(gbc.b(),  0x2d);
        EXPECT(gbc.c(),  0x1);
        EXPECT(gbc.d(),  0x7f);
        EXPECT(gbc.e(),  0xab);
        EXPECT(gbc.h(),  0xdb);
        EXPECT(gbc.l(),  0xcc);
        EXPECT(gbc.sp(), 0x892e);
        EXPECT(gbc.pc(), 0x4bb);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0217
        gbc.setState(0xa525, 0xd7d9, 0xb850, 0x5e16, 0x6c93, 0xb78c, 0x0, 0x1);
        gbc.writeMem(0xa525, { 0xd4, 0x91, 0xd1 });
        gbc.step();
        EXPECT(gbc.a(),  0xb8);
        EXPECT(gbc.b(),  0x5e);
        EXPECT(gbc.c(),  0x16);
        EXPECT(gbc.d(),  0x6c);
        EXPECT(gbc.e(),  0x93);
        EXPECT(gbc.h(),  0xb7);
        EXPECT(gbc.l(),  0x8c);
        EXPECT(gbc.sp(), 0xd7d9);
        EXPECT(gbc.pc(), 0xa528);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa525), 0xd4);
        EXPECT(gbc.readMem(0xa526), 0x91);
        EXPECT(gbc.readMem(0xa527), 0xd1);
        // D4 0219
        gbc.setState(0x1ec9, 0x65e5, 0xf10, 0x5418, 0x9105, 0x86e7, 0x1, 0x1);
        gbc.writeMem(0x1ec9, { 0xd4, 0x0, 0x85 });
        gbc.step();
        EXPECT(gbc.a(),  0xf);
        EXPECT(gbc.b(),  0x54);
        EXPECT(gbc.c(),  0x18);
        EXPECT(gbc.d(),  0x91);
        EXPECT(gbc.e(),  0x5);
        EXPECT(gbc.h(),  0x86);
        EXPECT(gbc.l(),  0xe7);
        EXPECT(gbc.sp(), 0x65e5);
        EXPECT(gbc.pc(), 0x1ecc);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 021B
        gbc.setState(0xb38f, 0xefc2, 0xd370, 0xb736, 0xaaaf, 0x715d, 0x0, 0x0);
        gbc.writeMem(0xb38f, { 0xd4, 0xc1, 0x77 });
        gbc.step();
        EXPECT(gbc.a(),  0xd3);
        EXPECT(gbc.b(),  0xb7);
        EXPECT(gbc.c(),  0x36);
        EXPECT(gbc.d(),  0xaa);
        EXPECT(gbc.e(),  0xaf);
        EXPECT(gbc.h(),  0x71);
        EXPECT(gbc.l(),  0x5d);
        EXPECT(gbc.sp(), 0xefc2);
        EXPECT(gbc.pc(), 0xb392);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb38f), 0xd4);
        EXPECT(gbc.readMem(0xb390), 0xc1);
        EXPECT(gbc.readMem(0xb391), 0x77);
        // D4 021C
        gbc.setState(0xaefd, 0x8ac7, 0xb260, 0xf0f8, 0xb320, 0x9bd, 0x0, 0x0);
        gbc.writeMem(0x8ac5, { 0x0, 0x0 });
        gbc.writeMem(0xaefd, { 0xd4, 0xc6, 0xf8 });
        gbc.step();
        EXPECT(gbc.a(),  0xb2);
        EXPECT(gbc.b(),  0xf0);
        EXPECT(gbc.c(),  0xf8);
        EXPECT(gbc.d(),  0xb3);
        EXPECT(gbc.e(),  0x20);
        EXPECT(gbc.h(),  0x9);
        EXPECT(gbc.l(),  0xbd);
        EXPECT(gbc.sp(), 0x8ac5);
        EXPECT(gbc.pc(), 0xf8c6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8ac5), 0x0);
        EXPECT(gbc.readMem(0x8ac6), 0xaf);
        EXPECT(gbc.readMem(0xaefd), 0xd4);
        EXPECT(gbc.readMem(0xaefe), 0xc6);
        EXPECT(gbc.readMem(0xaeff), 0xf8);
        // D4 021D
        gbc.setState(0x3b5b, 0x8aab, 0x2e80, 0x3fc5, 0x65e5, 0xccc3, 0x0, 0x1);
        gbc.writeMem(0x3b5b, { 0xd4, 0xcc, 0xfa });
        gbc.writeMem(0x8aa9, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x2e);
        EXPECT(gbc.b(),  0x3f);
        EXPECT(gbc.c(),  0xc5);
        EXPECT(gbc.d(),  0x65);
        EXPECT(gbc.e(),  0xe5);
        EXPECT(gbc.h(),  0xcc);
        EXPECT(gbc.l(),  0xc3);
        EXPECT(gbc.sp(), 0x8aa9);
        EXPECT(gbc.pc(), 0xfacc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8aa9), 0x5e);
        EXPECT(gbc.readMem(0x8aaa), 0x3b);
        // D4 0220
        gbc.setState(0x98eb, 0x338a, 0xea90, 0x849f, 0xe9e8, 0xeb9f, 0x1, 0x0);
        gbc.writeMem(0x98eb, { 0xd4, 0x29, 0x7d });
        gbc.step();
        EXPECT(gbc.a(),  0xea);
        EXPECT(gbc.b(),  0x84);
        EXPECT(gbc.c(),  0x9f);
        EXPECT(gbc.d(),  0xe9);
        EXPECT(gbc.e(),  0xe8);
        EXPECT(gbc.h(),  0xeb);
        EXPECT(gbc.l(),  0x9f);
        EXPECT(gbc.sp(), 0x338a);
        EXPECT(gbc.pc(), 0x98ee);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x98eb), 0xd4);
        EXPECT(gbc.readMem(0x98ec), 0x29);
        EXPECT(gbc.readMem(0x98ed), 0x7d);
        // D4 0221
        gbc.setState(0x9628, 0xaa6b, 0x14f0, 0xe6b0, 0x37b9, 0x6004, 0x1, 0x0);
        gbc.writeMem(0x9628, { 0xd4, 0xbd, 0xe8 });
        gbc.step();
        EXPECT(gbc.a(),  0x14);
        EXPECT(gbc.b(),  0xe6);
        EXPECT(gbc.c(),  0xb0);
        EXPECT(gbc.d(),  0x37);
        EXPECT(gbc.e(),  0xb9);
        EXPECT(gbc.h(),  0x60);
        EXPECT(gbc.l(),  0x4);
        EXPECT(gbc.sp(), 0xaa6b);
        EXPECT(gbc.pc(), 0x962b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9628), 0xd4);
        EXPECT(gbc.readMem(0x9629), 0xbd);
        EXPECT(gbc.readMem(0x962a), 0xe8);
        // D4 0222
        gbc.setState(0xe84a, 0x9a2b, 0xe100, 0x25d8, 0xef54, 0xf4e8, 0x1, 0x0);
        gbc.writeMem(0x9a29, { 0x0, 0x0 });
        gbc.writeMem(0xe84a, { 0xd4, 0xf2, 0x7a });
        gbc.step();
        EXPECT(gbc.a(),  0xe1);
        EXPECT(gbc.b(),  0x25);
        EXPECT(gbc.c(),  0xd8);
        EXPECT(gbc.d(),  0xef);
        EXPECT(gbc.e(),  0x54);
        EXPECT(gbc.h(),  0xf4);
        EXPECT(gbc.l(),  0xe8);
        EXPECT(gbc.sp(), 0x9a29);
        EXPECT(gbc.pc(), 0x7af2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9a29), 0x4d);
        EXPECT(gbc.readMem(0x9a2a), 0xe8);
        EXPECT(gbc.readMem(0xe84a), 0xd4);
        EXPECT(gbc.readMem(0xe84b), 0xf2);
        EXPECT(gbc.readMem(0xe84c), 0x7a);
        // D4 0224
        gbc.setState(0x7b87, 0x8e2f, 0x3940, 0x4d96, 0xa40a, 0xa7ea, 0x1, 0x1);
        gbc.writeMem(0x7b87, { 0xd4, 0xad, 0xe3 });
        gbc.writeMem(0x8e2d, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x39);
        EXPECT(gbc.b(),  0x4d);
        EXPECT(gbc.c(),  0x96);
        EXPECT(gbc.d(),  0xa4);
        EXPECT(gbc.e(),  0xa);
        EXPECT(gbc.h(),  0xa7);
        EXPECT(gbc.l(),  0xea);
        EXPECT(gbc.sp(), 0x8e2d);
        EXPECT(gbc.pc(), 0xe3ad);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8e2d), 0x8a);
        EXPECT(gbc.readMem(0x8e2e), 0x7b);
        // D4 0225
        gbc.setState(0x44f0, 0xfe0b, 0x4630, 0x962f, 0x10f5, 0x59fa, 0x1, 0x0);
        gbc.writeMem(0x44f0, { 0xd4, 0x57, 0x71 });
        gbc.step();
        EXPECT(gbc.a(),  0x46);
        EXPECT(gbc.b(),  0x96);
        EXPECT(gbc.c(),  0x2f);
        EXPECT(gbc.d(),  0x10);
        EXPECT(gbc.e(),  0xf5);
        EXPECT(gbc.h(),  0x59);
        EXPECT(gbc.l(),  0xfa);
        EXPECT(gbc.sp(), 0xfe0b);
        EXPECT(gbc.pc(), 0x44f3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0226
        gbc.setState(0x59be, 0xa249, 0x4170, 0x1258, 0x71ec, 0xc7bc, 0x1, 0x1);
        gbc.writeMem(0x59be, { 0xd4, 0x65, 0x81 });
        gbc.step();
        EXPECT(gbc.a(),  0x41);
        EXPECT(gbc.b(),  0x12);
        EXPECT(gbc.c(),  0x58);
        EXPECT(gbc.d(),  0x71);
        EXPECT(gbc.e(),  0xec);
        EXPECT(gbc.h(),  0xc7);
        EXPECT(gbc.l(),  0xbc);
        EXPECT(gbc.sp(), 0xa249);
        EXPECT(gbc.pc(), 0x59c1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0227
        gbc.setState(0x91de, 0xcec6, 0xc710, 0x1d7a, 0x9944, 0xe43a, 0x1, 0x1);
        gbc.writeMem(0x91de, { 0xd4, 0xa1, 0xae });
        gbc.step();
        EXPECT(gbc.a(),  0xc7);
        EXPECT(gbc.b(),  0x1d);
        EXPECT(gbc.c(),  0x7a);
        EXPECT(gbc.d(),  0x99);
        EXPECT(gbc.e(),  0x44);
        EXPECT(gbc.h(),  0xe4);
        EXPECT(gbc.l(),  0x3a);
        EXPECT(gbc.sp(), 0xcec6);
        EXPECT(gbc.pc(), 0x91e1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x91de), 0xd4);
        EXPECT(gbc.readMem(0x91df), 0xa1);
        EXPECT(gbc.readMem(0x91e0), 0xae);
        // D4 022A
        gbc.setState(0x23e2, 0xeb3b, 0xc7f0, 0x5adc, 0xf7da, 0x66c9, 0x0, 0x0);
        gbc.writeMem(0x23e2, { 0xd4, 0xa7, 0x42 });
        gbc.step();
        EXPECT(gbc.a(),  0xc7);
        EXPECT(gbc.b(),  0x5a);
        EXPECT(gbc.c(),  0xdc);
        EXPECT(gbc.d(),  0xf7);
        EXPECT(gbc.e(),  0xda);
        EXPECT(gbc.h(),  0x66);
        EXPECT(gbc.l(),  0xc9);
        EXPECT(gbc.sp(), 0xeb3b);
        EXPECT(gbc.pc(), 0x23e5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 022B
        gbc.setState(0xf1c, 0x4038, 0x73b0, 0xb5bc, 0x3666, 0xa51c, 0x1, 0x0);
        gbc.writeMem(0xf1c, { 0xd4, 0x99, 0xcc });
        gbc.step();
        EXPECT(gbc.a(),  0x73);
        EXPECT(gbc.b(),  0xb5);
        EXPECT(gbc.c(),  0xbc);
        EXPECT(gbc.d(),  0x36);
        EXPECT(gbc.e(),  0x66);
        EXPECT(gbc.h(),  0xa5);
        EXPECT(gbc.l(),  0x1c);
        EXPECT(gbc.sp(), 0x4038);
        EXPECT(gbc.pc(), 0xf1f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 022C
        gbc.setState(0xb112, 0x39b5, 0x78b0, 0x5856, 0xd1ac, 0x1724, 0x1, 0x1);
        gbc.writeMem(0xb112, { 0xd4, 0x8d, 0x3c });
        gbc.step();
        EXPECT(gbc.a(),  0x78);
        EXPECT(gbc.b(),  0x58);
        EXPECT(gbc.c(),  0x56);
        EXPECT(gbc.d(),  0xd1);
        EXPECT(gbc.e(),  0xac);
        EXPECT(gbc.h(),  0x17);
        EXPECT(gbc.l(),  0x24);
        EXPECT(gbc.sp(), 0x39b5);
        EXPECT(gbc.pc(), 0xb115);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb112), 0xd4);
        EXPECT(gbc.readMem(0xb113), 0x8d);
        EXPECT(gbc.readMem(0xb114), 0x3c);
        // D4 022D
        gbc.setState(0x6388, 0xca92, 0x14c0, 0xf78e, 0x1a2a, 0xf470, 0x1, 0x1);
        gbc.writeMem(0x6388, { 0xd4, 0x98, 0x55 });
        gbc.writeMem(0xca90, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x14);
        EXPECT(gbc.b(),  0xf7);
        EXPECT(gbc.c(),  0x8e);
        EXPECT(gbc.d(),  0x1a);
        EXPECT(gbc.e(),  0x2a);
        EXPECT(gbc.h(),  0xf4);
        EXPECT(gbc.l(),  0x70);
        EXPECT(gbc.sp(), 0xca90);
        EXPECT(gbc.pc(), 0x5598);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xca90), 0x8b);
        EXPECT(gbc.readMem(0xca91), 0x63);
        // D4 022E
        gbc.setState(0x1d02, 0xed5a, 0x5070, 0x31b0, 0x4ba0, 0x9e84, 0x1, 0x1);
        gbc.writeMem(0x1d02, { 0xd4, 0xb, 0xd2 });
        gbc.step();
        EXPECT(gbc.a(),  0x50);
        EXPECT(gbc.b(),  0x31);
        EXPECT(gbc.c(),  0xb0);
        EXPECT(gbc.d(),  0x4b);
        EXPECT(gbc.e(),  0xa0);
        EXPECT(gbc.h(),  0x9e);
        EXPECT(gbc.l(),  0x84);
        EXPECT(gbc.sp(), 0xed5a);
        EXPECT(gbc.pc(), 0x1d05);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 022F
        gbc.setState(0x73d4, 0xdce3, 0x6ec0, 0x26dd, 0x3e6c, 0x5843, 0x0, 0x1);
        gbc.writeMem(0x73d4, { 0xd4, 0x66, 0x4a });
        gbc.writeMem(0xdce1, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x6e);
        EXPECT(gbc.b(),  0x26);
        EXPECT(gbc.c(),  0xdd);
        EXPECT(gbc.d(),  0x3e);
        EXPECT(gbc.e(),  0x6c);
        EXPECT(gbc.h(),  0x58);
        EXPECT(gbc.l(),  0x43);
        EXPECT(gbc.sp(), 0xdce1);
        EXPECT(gbc.pc(), 0x4a66);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdce1), 0xd7);
        EXPECT(gbc.readMem(0xdce2), 0x73);
        // D4 0230
        gbc.setState(0xe6, 0xb6f1, 0x80f0, 0xdf9d, 0xe3b, 0x2038, 0x0, 0x1);
        gbc.writeMem(0xe6, { 0xd4, 0xb, 0x1d });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0xdf);
        EXPECT(gbc.c(),  0x9d);
        EXPECT(gbc.d(),  0xe);
        EXPECT(gbc.e(),  0x3b);
        EXPECT(gbc.h(),  0x20);
        EXPECT(gbc.l(),  0x38);
        EXPECT(gbc.sp(), 0xb6f1);
        EXPECT(gbc.pc(), 0xe9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0231
        gbc.setState(0xbc01, 0xc023, 0xfb90, 0x8a16, 0x3539, 0x6e81, 0x0, 0x1);
        gbc.writeMem(0xbc01, { 0xd4, 0x96, 0x44 });
        gbc.step();
        EXPECT(gbc.a(),  0xfb);
        EXPECT(gbc.b(),  0x8a);
        EXPECT(gbc.c(),  0x16);
        EXPECT(gbc.d(),  0x35);
        EXPECT(gbc.e(),  0x39);
        EXPECT(gbc.h(),  0x6e);
        EXPECT(gbc.l(),  0x81);
        EXPECT(gbc.sp(), 0xc023);
        EXPECT(gbc.pc(), 0xbc04);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbc01), 0xd4);
        EXPECT(gbc.readMem(0xbc02), 0x96);
        EXPECT(gbc.readMem(0xbc03), 0x44);
        // D4 0232
        gbc.setState(0xd41c, 0xc45d, 0x8fb0, 0x2bab, 0xdc14, 0x13fc, 0x0, 0x1);
        gbc.writeMem(0xd41c, { 0xd4, 0xa9, 0xf3 });
        gbc.step();
        EXPECT(gbc.a(),  0x8f);
        EXPECT(gbc.b(),  0x2b);
        EXPECT(gbc.c(),  0xab);
        EXPECT(gbc.d(),  0xdc);
        EXPECT(gbc.e(),  0x14);
        EXPECT(gbc.h(),  0x13);
        EXPECT(gbc.l(),  0xfc);
        EXPECT(gbc.sp(), 0xc45d);
        EXPECT(gbc.pc(), 0xd41f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd41c), 0xd4);
        EXPECT(gbc.readMem(0xd41d), 0xa9);
        EXPECT(gbc.readMem(0xd41e), 0xf3);
        // D4 0233
        gbc.setState(0x95c4, 0x9fe2, 0x3170, 0xea95, 0x182f, 0x8af5, 0x1, 0x0);
        gbc.writeMem(0x95c4, { 0xd4, 0x96, 0xcd });
        gbc.step();
        EXPECT(gbc.a(),  0x31);
        EXPECT(gbc.b(),  0xea);
        EXPECT(gbc.c(),  0x95);
        EXPECT(gbc.d(),  0x18);
        EXPECT(gbc.e(),  0x2f);
        EXPECT(gbc.h(),  0x8a);
        EXPECT(gbc.l(),  0xf5);
        EXPECT(gbc.sp(), 0x9fe2);
        EXPECT(gbc.pc(), 0x95c7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x95c4), 0xd4);
        EXPECT(gbc.readMem(0x95c5), 0x96);
        EXPECT(gbc.readMem(0x95c6), 0xcd);
        // D4 0234
        gbc.setState(0x272d, 0x4ef, 0xe310, 0xacc1, 0x5e5f, 0x7087, 0x0, 0x0);
        gbc.writeMem(0x272d, { 0xd4, 0xef, 0x86 });
        gbc.step();
        EXPECT(gbc.a(),  0xe3);
        EXPECT(gbc.b(),  0xac);
        EXPECT(gbc.c(),  0xc1);
        EXPECT(gbc.d(),  0x5e);
        EXPECT(gbc.e(),  0x5f);
        EXPECT(gbc.h(),  0x70);
        EXPECT(gbc.l(),  0x87);
        EXPECT(gbc.sp(), 0x4ef);
        EXPECT(gbc.pc(), 0x2730);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0236
        gbc.setState(0x455d, 0xa9c6, 0xaf70, 0xccc1, 0xf87f, 0xef8a, 0x1, 0x1);
        gbc.writeMem(0x455d, { 0xd4, 0x32, 0xab });
        gbc.step();
        EXPECT(gbc.a(),  0xaf);
        EXPECT(gbc.b(),  0xcc);
        EXPECT(gbc.c(),  0xc1);
        EXPECT(gbc.d(),  0xf8);
        EXPECT(gbc.e(),  0x7f);
        EXPECT(gbc.h(),  0xef);
        EXPECT(gbc.l(),  0x8a);
        EXPECT(gbc.sp(), 0xa9c6);
        EXPECT(gbc.pc(), 0x4560);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0237
        gbc.setState(0x68ac, 0xb193, 0x1aa0, 0x5f17, 0xa145, 0x22b2, 0x1, 0x0);
        gbc.writeMem(0x68ac, { 0xd4, 0x5c, 0xf1 });
        gbc.writeMem(0xb191, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x1a);
        EXPECT(gbc.b(),  0x5f);
        EXPECT(gbc.c(),  0x17);
        EXPECT(gbc.d(),  0xa1);
        EXPECT(gbc.e(),  0x45);
        EXPECT(gbc.h(),  0x22);
        EXPECT(gbc.l(),  0xb2);
        EXPECT(gbc.sp(), 0xb191);
        EXPECT(gbc.pc(), 0xf15c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb191), 0xaf);
        EXPECT(gbc.readMem(0xb192), 0x68);
        // D4 0239
        gbc.setState(0x1394, 0xc89e, 0xe650, 0x9d9a, 0xaf65, 0xa67d, 0x0, 0x0);
        gbc.writeMem(0x1394, { 0xd4, 0xc, 0x22 });
        gbc.step();
        EXPECT(gbc.a(),  0xe6);
        EXPECT(gbc.b(),  0x9d);
        EXPECT(gbc.c(),  0x9a);
        EXPECT(gbc.d(),  0xaf);
        EXPECT(gbc.e(),  0x65);
        EXPECT(gbc.h(),  0xa6);
        EXPECT(gbc.l(),  0x7d);
        EXPECT(gbc.sp(), 0xc89e);
        EXPECT(gbc.pc(), 0x1397);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 023B
        gbc.setState(0x4228, 0xe827, 0x7960, 0x9b52, 0xef9b, 0xf8ae, 0x0, 0x1);
        gbc.writeMem(0x4228, { 0xd4, 0xff, 0x4f });
        gbc.writeMem(0xe825, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x79);
        EXPECT(gbc.b(),  0x9b);
        EXPECT(gbc.c(),  0x52);
        EXPECT(gbc.d(),  0xef);
        EXPECT(gbc.e(),  0x9b);
        EXPECT(gbc.h(),  0xf8);
        EXPECT(gbc.l(),  0xae);
        EXPECT(gbc.sp(), 0xe825);
        EXPECT(gbc.pc(), 0x4fff);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe825), 0x2b);
        EXPECT(gbc.readMem(0xe826), 0x42);
        // D4 023C
        gbc.setState(0x9616, 0xc, 0x6790, 0x6a4a, 0xf275, 0x3072, 0x0, 0x0);
        gbc.writeMem(0x9616, { 0xd4, 0xa9, 0x73 });
        gbc.step();
        EXPECT(gbc.a(),  0x67);
        EXPECT(gbc.b(),  0x6a);
        EXPECT(gbc.c(),  0x4a);
        EXPECT(gbc.d(),  0xf2);
        EXPECT(gbc.e(),  0x75);
        EXPECT(gbc.h(),  0x30);
        EXPECT(gbc.l(),  0x72);
        EXPECT(gbc.sp(), 0xc);
        EXPECT(gbc.pc(), 0x9619);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9616), 0xd4);
        EXPECT(gbc.readMem(0x9617), 0xa9);
        EXPECT(gbc.readMem(0x9618), 0x73);
        // D4 023D
        gbc.setState(0x8738, 0xe9a1, 0x2e40, 0x64bc, 0xe8e9, 0x430a, 0x1, 0x0);
        gbc.writeMem(0x8738, { 0xd4, 0xc0, 0xd0 });
        gbc.writeMem(0xe99f, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x2e);
        EXPECT(gbc.b(),  0x64);
        EXPECT(gbc.c(),  0xbc);
        EXPECT(gbc.d(),  0xe8);
        EXPECT(gbc.e(),  0xe9);
        EXPECT(gbc.h(),  0x43);
        EXPECT(gbc.l(),  0xa);
        EXPECT(gbc.sp(), 0xe99f);
        EXPECT(gbc.pc(), 0xd0c0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8738), 0xd4);
        EXPECT(gbc.readMem(0x8739), 0xc0);
        EXPECT(gbc.readMem(0x873a), 0xd0);
        EXPECT(gbc.readMem(0xe99f), 0x3b);
        EXPECT(gbc.readMem(0xe9a0), 0x87);
        // D4 023E
        gbc.setState(0x9d00, 0xcd17, 0x1d50, 0xa2bc, 0xa793, 0xcfb2, 0x1, 0x1);
        gbc.writeMem(0x9d00, { 0xd4, 0x5b, 0xca });
        gbc.step();
        EXPECT(gbc.a(),  0x1d);
        EXPECT(gbc.b(),  0xa2);
        EXPECT(gbc.c(),  0xbc);
        EXPECT(gbc.d(),  0xa7);
        EXPECT(gbc.e(),  0x93);
        EXPECT(gbc.h(),  0xcf);
        EXPECT(gbc.l(),  0xb2);
        EXPECT(gbc.sp(), 0xcd17);
        EXPECT(gbc.pc(), 0x9d03);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9d00), 0xd4);
        EXPECT(gbc.readMem(0x9d01), 0x5b);
        EXPECT(gbc.readMem(0x9d02), 0xca);
        // D4 023F
        gbc.setState(0x23eb, 0x8ad5, 0x54a0, 0x45bd, 0x66c9, 0x9c4f, 0x1, 0x1);
        gbc.writeMem(0x23eb, { 0xd4, 0x4b, 0x65 });
        gbc.writeMem(0x8ad3, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x54);
        EXPECT(gbc.b(),  0x45);
        EXPECT(gbc.c(),  0xbd);
        EXPECT(gbc.d(),  0x66);
        EXPECT(gbc.e(),  0xc9);
        EXPECT(gbc.h(),  0x9c);
        EXPECT(gbc.l(),  0x4f);
        EXPECT(gbc.sp(), 0x8ad3);
        EXPECT(gbc.pc(), 0x654b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8ad3), 0xee);
        EXPECT(gbc.readMem(0x8ad4), 0x23);
        // D4 0241
        gbc.setState(0xe57, 0xb422, 0xdef0, 0xe53, 0x528d, 0xa0d5, 0x0, 0x1);
        gbc.writeMem(0xe57, { 0xd4, 0xd5, 0x59 });
        gbc.step();
        EXPECT(gbc.a(),  0xde);
        EXPECT(gbc.b(),  0xe);
        EXPECT(gbc.c(),  0x53);
        EXPECT(gbc.d(),  0x52);
        EXPECT(gbc.e(),  0x8d);
        EXPECT(gbc.h(),  0xa0);
        EXPECT(gbc.l(),  0xd5);
        EXPECT(gbc.sp(), 0xb422);
        EXPECT(gbc.pc(), 0xe5a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0245
        gbc.setState(0xd6ee, 0x5d3d, 0xf9f0, 0xae86, 0x1cd2, 0x90a9, 0x1, 0x1);
        gbc.writeMem(0xd6ee, { 0xd4, 0xc, 0x4c });
        gbc.step();
        EXPECT(gbc.a(),  0xf9);
        EXPECT(gbc.b(),  0xae);
        EXPECT(gbc.c(),  0x86);
        EXPECT(gbc.d(),  0x1c);
        EXPECT(gbc.e(),  0xd2);
        EXPECT(gbc.h(),  0x90);
        EXPECT(gbc.l(),  0xa9);
        EXPECT(gbc.sp(), 0x5d3d);
        EXPECT(gbc.pc(), 0xd6f1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd6ee), 0xd4);
        EXPECT(gbc.readMem(0xd6ef), 0xc);
        EXPECT(gbc.readMem(0xd6f0), 0x4c);
        // D4 0246
        gbc.setState(0xa0a, 0x358a, 0x1250, 0x829, 0xbee0, 0x591c, 0x1, 0x1);
        gbc.writeMem(0xa0a, { 0xd4, 0xea, 0x77 });
        gbc.step();
        EXPECT(gbc.a(),  0x12);
        EXPECT(gbc.b(),  0x8);
        EXPECT(gbc.c(),  0x29);
        EXPECT(gbc.d(),  0xbe);
        EXPECT(gbc.e(),  0xe0);
        EXPECT(gbc.h(),  0x59);
        EXPECT(gbc.l(),  0x1c);
        EXPECT(gbc.sp(), 0x358a);
        EXPECT(gbc.pc(), 0xa0d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0248
        gbc.setState(0x73e7, 0x9229, 0xde50, 0x8fdf, 0x425b, 0x2388, 0x1, 0x0);
        gbc.writeMem(0x73e7, { 0xd4, 0xf6, 0xb9 });
        gbc.step();
        EXPECT(gbc.a(),  0xde);
        EXPECT(gbc.b(),  0x8f);
        EXPECT(gbc.c(),  0xdf);
        EXPECT(gbc.d(),  0x42);
        EXPECT(gbc.e(),  0x5b);
        EXPECT(gbc.h(),  0x23);
        EXPECT(gbc.l(),  0x88);
        EXPECT(gbc.sp(), 0x9229);
        EXPECT(gbc.pc(), 0x73ea);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0249
        gbc.setState(0x71b3, 0x1806, 0xedf0, 0xdbd7, 0xfc07, 0x1489, 0x0, 0x0);
        gbc.writeMem(0x71b3, { 0xd4, 0xb3, 0xde });
        gbc.step();
        EXPECT(gbc.a(),  0xed);
        EXPECT(gbc.b(),  0xdb);
        EXPECT(gbc.c(),  0xd7);
        EXPECT(gbc.d(),  0xfc);
        EXPECT(gbc.e(),  0x7);
        EXPECT(gbc.h(),  0x14);
        EXPECT(gbc.l(),  0x89);
        EXPECT(gbc.sp(), 0x1806);
        EXPECT(gbc.pc(), 0x71b6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 024A
        gbc.setState(0xa667, 0x8eb2, 0x7f00, 0xe390, 0x19d5, 0xfbde, 0x0, 0x1);
        gbc.writeMem(0x8eb0, { 0x0, 0x0 });
        gbc.writeMem(0xa667, { 0xd4, 0xb0, 0xad });
        gbc.step();
        EXPECT(gbc.a(),  0x7f);
        EXPECT(gbc.b(),  0xe3);
        EXPECT(gbc.c(),  0x90);
        EXPECT(gbc.d(),  0x19);
        EXPECT(gbc.e(),  0xd5);
        EXPECT(gbc.h(),  0xfb);
        EXPECT(gbc.l(),  0xde);
        EXPECT(gbc.sp(), 0x8eb0);
        EXPECT(gbc.pc(), 0xadb0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8eb0), 0x6a);
        EXPECT(gbc.readMem(0x8eb1), 0xa6);
        EXPECT(gbc.readMem(0xa667), 0xd4);
        EXPECT(gbc.readMem(0xa668), 0xb0);
        EXPECT(gbc.readMem(0xa669), 0xad);
        // D4 024B
        gbc.setState(0xa1a2, 0x78a, 0x7e10, 0xcd9a, 0x7353, 0xeca0, 0x1, 0x0);
        gbc.writeMem(0xa1a2, { 0xd4, 0xfe, 0xfa });
        gbc.step();
        EXPECT(gbc.a(),  0x7e);
        EXPECT(gbc.b(),  0xcd);
        EXPECT(gbc.c(),  0x9a);
        EXPECT(gbc.d(),  0x73);
        EXPECT(gbc.e(),  0x53);
        EXPECT(gbc.h(),  0xec);
        EXPECT(gbc.l(),  0xa0);
        EXPECT(gbc.sp(), 0x78a);
        EXPECT(gbc.pc(), 0xa1a5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa1a2), 0xd4);
        EXPECT(gbc.readMem(0xa1a3), 0xfe);
        EXPECT(gbc.readMem(0xa1a4), 0xfa);
        // D4 024C
        gbc.setState(0x46b2, 0xc06b, 0xc540, 0x34ba, 0xd444, 0x120e, 0x0, 0x1);
        gbc.writeMem(0x46b2, { 0xd4, 0xeb, 0x8f });
        gbc.writeMem(0xc069, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xc5);
        EXPECT(gbc.b(),  0x34);
        EXPECT(gbc.c(),  0xba);
        EXPECT(gbc.d(),  0xd4);
        EXPECT(gbc.e(),  0x44);
        EXPECT(gbc.h(),  0x12);
        EXPECT(gbc.l(),  0xe);
        EXPECT(gbc.sp(), 0xc069);
        EXPECT(gbc.pc(), 0x8feb);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc069), 0xb5);
        EXPECT(gbc.readMem(0xc06a), 0x46);
        // D4 024D
        gbc.setState(0xe468, 0xcddd, 0x8f00, 0xa20, 0xbc3b, 0xdeb0, 0x0, 0x1);
        gbc.writeMem(0xcddb, { 0x0, 0x0 });
        gbc.writeMem(0xe468, { 0xd4, 0x5f, 0x2b });
        gbc.step();
        EXPECT(gbc.a(),  0x8f);
        EXPECT(gbc.b(),  0xa);
        EXPECT(gbc.c(),  0x20);
        EXPECT(gbc.d(),  0xbc);
        EXPECT(gbc.e(),  0x3b);
        EXPECT(gbc.h(),  0xde);
        EXPECT(gbc.l(),  0xb0);
        EXPECT(gbc.sp(), 0xcddb);
        EXPECT(gbc.pc(), 0x2b5f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcddb), 0x6b);
        EXPECT(gbc.readMem(0xcddc), 0xe4);
        EXPECT(gbc.readMem(0xe468), 0xd4);
        EXPECT(gbc.readMem(0xe469), 0x5f);
        EXPECT(gbc.readMem(0xe46a), 0x2b);
        // D4 024E
        gbc.setState(0x4275, 0x7bb9, 0x21f0, 0x1305, 0xcf7c, 0x9752, 0x1, 0x1);
        gbc.writeMem(0x4275, { 0xd4, 0x42, 0x27 });
        gbc.step();
        EXPECT(gbc.a(),  0x21);
        EXPECT(gbc.b(),  0x13);
        EXPECT(gbc.c(),  0x5);
        EXPECT(gbc.d(),  0xcf);
        EXPECT(gbc.e(),  0x7c);
        EXPECT(gbc.h(),  0x97);
        EXPECT(gbc.l(),  0x52);
        EXPECT(gbc.sp(), 0x7bb9);
        EXPECT(gbc.pc(), 0x4278);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 024F
        gbc.setState(0xd5c5, 0xdec5, 0x8bd0, 0x4af2, 0x5d3, 0x7df3, 0x1, 0x1);
        gbc.writeMem(0xd5c5, { 0xd4, 0x5c, 0xdf });
        gbc.step();
        EXPECT(gbc.a(),  0x8b);
        EXPECT(gbc.b(),  0x4a);
        EXPECT(gbc.c(),  0xf2);
        EXPECT(gbc.d(),  0x5);
        EXPECT(gbc.e(),  0xd3);
        EXPECT(gbc.h(),  0x7d);
        EXPECT(gbc.l(),  0xf3);
        EXPECT(gbc.sp(), 0xdec5);
        EXPECT(gbc.pc(), 0xd5c8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd5c5), 0xd4);
        EXPECT(gbc.readMem(0xd5c6), 0x5c);
        EXPECT(gbc.readMem(0xd5c7), 0xdf);
        // D4 0250
        gbc.setState(0xd997, 0x9d98, 0x7180, 0xe53e, 0xb09f, 0x2898, 0x0, 0x1);
        gbc.writeMem(0x9d96, { 0x0, 0x0 });
        gbc.writeMem(0xd997, { 0xd4, 0xba, 0xfc });
        gbc.step();
        EXPECT(gbc.a(),  0x71);
        EXPECT(gbc.b(),  0xe5);
        EXPECT(gbc.c(),  0x3e);
        EXPECT(gbc.d(),  0xb0);
        EXPECT(gbc.e(),  0x9f);
        EXPECT(gbc.h(),  0x28);
        EXPECT(gbc.l(),  0x98);
        EXPECT(gbc.sp(), 0x9d96);
        EXPECT(gbc.pc(), 0xfcba);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9d96), 0x9a);
        EXPECT(gbc.readMem(0x9d97), 0xd9);
        EXPECT(gbc.readMem(0xd997), 0xd4);
        EXPECT(gbc.readMem(0xd998), 0xba);
        EXPECT(gbc.readMem(0xd999), 0xfc);
        // D4 0251
        gbc.setState(0xb3c2, 0x9b29, 0xcc20, 0x5122, 0x6427, 0x1921, 0x0, 0x1);
        gbc.writeMem(0x9b27, { 0x0, 0x0 });
        gbc.writeMem(0xb3c2, { 0xd4, 0x2a, 0x36 });
        gbc.step();
        EXPECT(gbc.a(),  0xcc);
        EXPECT(gbc.b(),  0x51);
        EXPECT(gbc.c(),  0x22);
        EXPECT(gbc.d(),  0x64);
        EXPECT(gbc.e(),  0x27);
        EXPECT(gbc.h(),  0x19);
        EXPECT(gbc.l(),  0x21);
        EXPECT(gbc.sp(), 0x9b27);
        EXPECT(gbc.pc(), 0x362a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9b27), 0xc5);
        EXPECT(gbc.readMem(0x9b28), 0xb3);
        EXPECT(gbc.readMem(0xb3c2), 0xd4);
        EXPECT(gbc.readMem(0xb3c3), 0x2a);
        EXPECT(gbc.readMem(0xb3c4), 0x36);
        // D4 0253
        gbc.setState(0x28ea, 0xbf1d, 0xde70, 0xc001, 0x1f5, 0x8b45, 0x1, 0x0);
        gbc.writeMem(0x28ea, { 0xd4, 0x23, 0xec });
        gbc.step();
        EXPECT(gbc.a(),  0xde);
        EXPECT(gbc.b(),  0xc0);
        EXPECT(gbc.c(),  0x1);
        EXPECT(gbc.d(),  0x1);
        EXPECT(gbc.e(),  0xf5);
        EXPECT(gbc.h(),  0x8b);
        EXPECT(gbc.l(),  0x45);
        EXPECT(gbc.sp(), 0xbf1d);
        EXPECT(gbc.pc(), 0x28ed);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0254
        gbc.setState(0xb7fd, 0xb86f, 0x9490, 0x457c, 0x7134, 0xbb27, 0x0, 0x0);
        gbc.writeMem(0xb7fd, { 0xd4, 0x43, 0x73 });
        gbc.step();
        EXPECT(gbc.a(),  0x94);
        EXPECT(gbc.b(),  0x45);
        EXPECT(gbc.c(),  0x7c);
        EXPECT(gbc.d(),  0x71);
        EXPECT(gbc.e(),  0x34);
        EXPECT(gbc.h(),  0xbb);
        EXPECT(gbc.l(),  0x27);
        EXPECT(gbc.sp(), 0xb86f);
        EXPECT(gbc.pc(), 0xb800);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb7fd), 0xd4);
        EXPECT(gbc.readMem(0xb7fe), 0x43);
        EXPECT(gbc.readMem(0xb7ff), 0x73);
        // D4 0256
        gbc.setState(0xa58b, 0x917a, 0x11e0, 0xe644, 0x4b4f, 0x7c7b, 0x1, 0x0);
        gbc.writeMem(0x9178, { 0x0, 0x0 });
        gbc.writeMem(0xa58b, { 0xd4, 0x21, 0xdc });
        gbc.step();
        EXPECT(gbc.a(),  0x11);
        EXPECT(gbc.b(),  0xe6);
        EXPECT(gbc.c(),  0x44);
        EXPECT(gbc.d(),  0x4b);
        EXPECT(gbc.e(),  0x4f);
        EXPECT(gbc.h(),  0x7c);
        EXPECT(gbc.l(),  0x7b);
        EXPECT(gbc.sp(), 0x9178);
        EXPECT(gbc.pc(), 0xdc21);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9178), 0x8e);
        EXPECT(gbc.readMem(0x9179), 0xa5);
        EXPECT(gbc.readMem(0xa58b), 0xd4);
        EXPECT(gbc.readMem(0xa58c), 0x21);
        EXPECT(gbc.readMem(0xa58d), 0xdc);
        // D4 0257
        gbc.setState(0x3152, 0x975e, 0x6a50, 0x18f5, 0x9f99, 0xcd0a, 0x1, 0x0);
        gbc.writeMem(0x3152, { 0xd4, 0xba, 0x7f });
        gbc.step();
        EXPECT(gbc.a(),  0x6a);
        EXPECT(gbc.b(),  0x18);
        EXPECT(gbc.c(),  0xf5);
        EXPECT(gbc.d(),  0x9f);
        EXPECT(gbc.e(),  0x99);
        EXPECT(gbc.h(),  0xcd);
        EXPECT(gbc.l(),  0xa);
        EXPECT(gbc.sp(), 0x975e);
        EXPECT(gbc.pc(), 0x3155);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0258
        gbc.setState(0xc506, 0x1ad6, 0xc8f0, 0x5c60, 0x1e3d, 0x25d1, 0x0, 0x0);
        gbc.writeMem(0xc506, { 0xd4, 0x4, 0x8a });
        gbc.step();
        EXPECT(gbc.a(),  0xc8);
        EXPECT(gbc.b(),  0x5c);
        EXPECT(gbc.c(),  0x60);
        EXPECT(gbc.d(),  0x1e);
        EXPECT(gbc.e(),  0x3d);
        EXPECT(gbc.h(),  0x25);
        EXPECT(gbc.l(),  0xd1);
        EXPECT(gbc.sp(), 0x1ad6);
        EXPECT(gbc.pc(), 0xc509);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc506), 0xd4);
        EXPECT(gbc.readMem(0xc507), 0x4);
        EXPECT(gbc.readMem(0xc508), 0x8a);
        // D4 0259
        gbc.setState(0xa385, 0x9b25, 0xa140, 0xaa3f, 0xed0f, 0x6cef, 0x0, 0x0);
        gbc.writeMem(0x9b23, { 0x0, 0x0 });
        gbc.writeMem(0xa385, { 0xd4, 0x8c, 0x82 });
        gbc.step();
        EXPECT(gbc.a(),  0xa1);
        EXPECT(gbc.b(),  0xaa);
        EXPECT(gbc.c(),  0x3f);
        EXPECT(gbc.d(),  0xed);
        EXPECT(gbc.e(),  0xf);
        EXPECT(gbc.h(),  0x6c);
        EXPECT(gbc.l(),  0xef);
        EXPECT(gbc.sp(), 0x9b23);
        EXPECT(gbc.pc(), 0x828c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9b23), 0x88);
        EXPECT(gbc.readMem(0x9b24), 0xa3);
        EXPECT(gbc.readMem(0xa385), 0xd4);
        EXPECT(gbc.readMem(0xa386), 0x8c);
        EXPECT(gbc.readMem(0xa387), 0x82);
        // D4 025B
        gbc.setState(0xd2cf, 0x70ff, 0x39b0, 0x415f, 0x7ec2, 0xd2bd, 0x0, 0x0);
        gbc.writeMem(0xd2cf, { 0xd4, 0x1, 0xb2 });
        gbc.step();
        EXPECT(gbc.a(),  0x39);
        EXPECT(gbc.b(),  0x41);
        EXPECT(gbc.c(),  0x5f);
        EXPECT(gbc.d(),  0x7e);
        EXPECT(gbc.e(),  0xc2);
        EXPECT(gbc.h(),  0xd2);
        EXPECT(gbc.l(),  0xbd);
        EXPECT(gbc.sp(), 0x70ff);
        EXPECT(gbc.pc(), 0xd2d2);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd2cf), 0xd4);
        EXPECT(gbc.readMem(0xd2d0), 0x1);
        EXPECT(gbc.readMem(0xd2d1), 0xb2);
        // D4 025C
        gbc.setState(0x46e2, 0x8c7a, 0x70f0, 0x5398, 0x7602, 0x2c51, 0x1, 0x0);
        gbc.writeMem(0x46e2, { 0xd4, 0xa7, 0x93 });
        gbc.step();
        EXPECT(gbc.a(),  0x70);
        EXPECT(gbc.b(),  0x53);
        EXPECT(gbc.c(),  0x98);
        EXPECT(gbc.d(),  0x76);
        EXPECT(gbc.e(),  0x2);
        EXPECT(gbc.h(),  0x2c);
        EXPECT(gbc.l(),  0x51);
        EXPECT(gbc.sp(), 0x8c7a);
        EXPECT(gbc.pc(), 0x46e5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 025D
        gbc.setState(0x40e3, 0xf680, 0xff0, 0x246d, 0x2aa1, 0x7436, 0x0, 0x0);
        gbc.writeMem(0x40e3, { 0xd4, 0x39, 0xa5 });
        gbc.step();
        EXPECT(gbc.a(),  0xf);
        EXPECT(gbc.b(),  0x24);
        EXPECT(gbc.c(),  0x6d);
        EXPECT(gbc.d(),  0x2a);
        EXPECT(gbc.e(),  0xa1);
        EXPECT(gbc.h(),  0x74);
        EXPECT(gbc.l(),  0x36);
        EXPECT(gbc.sp(), 0xf680);
        EXPECT(gbc.pc(), 0x40e6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 025F
        gbc.setState(0x89b5, 0xbc89, 0x4fd0, 0x2387, 0x6a85, 0xafbd, 0x0, 0x1);
        gbc.writeMem(0x89b5, { 0xd4, 0x2d, 0xf2 });
        gbc.step();
        EXPECT(gbc.a(),  0x4f);
        EXPECT(gbc.b(),  0x23);
        EXPECT(gbc.c(),  0x87);
        EXPECT(gbc.d(),  0x6a);
        EXPECT(gbc.e(),  0x85);
        EXPECT(gbc.h(),  0xaf);
        EXPECT(gbc.l(),  0xbd);
        EXPECT(gbc.sp(), 0xbc89);
        EXPECT(gbc.pc(), 0x89b8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x89b5), 0xd4);
        EXPECT(gbc.readMem(0x89b6), 0x2d);
        EXPECT(gbc.readMem(0x89b7), 0xf2);
        // D4 0260
        gbc.setState(0xbb7f, 0xb5d6, 0x1310, 0xd931, 0xd7c7, 0x1658, 0x0, 0x1);
        gbc.writeMem(0xbb7f, { 0xd4, 0xd1, 0x3c });
        gbc.step();
        EXPECT(gbc.a(),  0x13);
        EXPECT(gbc.b(),  0xd9);
        EXPECT(gbc.c(),  0x31);
        EXPECT(gbc.d(),  0xd7);
        EXPECT(gbc.e(),  0xc7);
        EXPECT(gbc.h(),  0x16);
        EXPECT(gbc.l(),  0x58);
        EXPECT(gbc.sp(), 0xb5d6);
        EXPECT(gbc.pc(), 0xbb82);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbb7f), 0xd4);
        EXPECT(gbc.readMem(0xbb80), 0xd1);
        EXPECT(gbc.readMem(0xbb81), 0x3c);
        // D4 0261
        gbc.setState(0xb6f2, 0xb788, 0x71d0, 0x2319, 0x998c, 0x8c13, 0x0, 0x0);
        gbc.writeMem(0xb6f2, { 0xd4, 0xa1, 0x30 });
        gbc.step();
        EXPECT(gbc.a(),  0x71);
        EXPECT(gbc.b(),  0x23);
        EXPECT(gbc.c(),  0x19);
        EXPECT(gbc.d(),  0x99);
        EXPECT(gbc.e(),  0x8c);
        EXPECT(gbc.h(),  0x8c);
        EXPECT(gbc.l(),  0x13);
        EXPECT(gbc.sp(), 0xb788);
        EXPECT(gbc.pc(), 0xb6f5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb6f2), 0xd4);
        EXPECT(gbc.readMem(0xb6f3), 0xa1);
        EXPECT(gbc.readMem(0xb6f4), 0x30);
        // D4 0262
        gbc.setState(0xde, 0xac7c, 0xefc0, 0x48fd, 0x12b3, 0x9ca4, 0x0, 0x0);
        gbc.writeMem(0xde, { 0xd4, 0xa, 0x5c });
        gbc.writeMem(0xac7a, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xef);
        EXPECT(gbc.b(),  0x48);
        EXPECT(gbc.c(),  0xfd);
        EXPECT(gbc.d(),  0x12);
        EXPECT(gbc.e(),  0xb3);
        EXPECT(gbc.h(),  0x9c);
        EXPECT(gbc.l(),  0xa4);
        EXPECT(gbc.sp(), 0xac7a);
        EXPECT(gbc.pc(), 0x5c0a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xac7a), 0xe1);
        EXPECT(gbc.readMem(0xac7b), 0x0);
        // D4 0263
        gbc.setState(0xd959, 0xd867, 0xc6e0, 0x6492, 0xa55e, 0x9914, 0x1, 0x0);
        gbc.writeMem(0xd865, { 0x0, 0x0 });
        gbc.writeMem(0xd959, { 0xd4, 0x6f, 0x29 });
        gbc.step();
        EXPECT(gbc.a(),  0xc6);
        EXPECT(gbc.b(),  0x64);
        EXPECT(gbc.c(),  0x92);
        EXPECT(gbc.d(),  0xa5);
        EXPECT(gbc.e(),  0x5e);
        EXPECT(gbc.h(),  0x99);
        EXPECT(gbc.l(),  0x14);
        EXPECT(gbc.sp(), 0xd865);
        EXPECT(gbc.pc(), 0x296f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd865), 0x5c);
        EXPECT(gbc.readMem(0xd866), 0xd9);
        EXPECT(gbc.readMem(0xd959), 0xd4);
        EXPECT(gbc.readMem(0xd95a), 0x6f);
        EXPECT(gbc.readMem(0xd95b), 0x29);
        // D4 0264
        gbc.setState(0x3b1f, 0xd120, 0xf190, 0x3be4, 0x6b28, 0x8b2c, 0x1, 0x0);
        gbc.writeMem(0x3b1f, { 0xd4, 0x36, 0xdc });
        gbc.step();
        EXPECT(gbc.a(),  0xf1);
        EXPECT(gbc.b(),  0x3b);
        EXPECT(gbc.c(),  0xe4);
        EXPECT(gbc.d(),  0x6b);
        EXPECT(gbc.e(),  0x28);
        EXPECT(gbc.h(),  0x8b);
        EXPECT(gbc.l(),  0x2c);
        EXPECT(gbc.sp(), 0xd120);
        EXPECT(gbc.pc(), 0x3b22);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0265
        gbc.setState(0x1e60, 0x1b70, 0x7ad0, 0x18b4, 0x9c0c, 0x423d, 0x0, 0x0);
        gbc.writeMem(0x1e60, { 0xd4, 0x25, 0x89 });
        gbc.step();
        EXPECT(gbc.a(),  0x7a);
        EXPECT(gbc.b(),  0x18);
        EXPECT(gbc.c(),  0xb4);
        EXPECT(gbc.d(),  0x9c);
        EXPECT(gbc.e(),  0xc);
        EXPECT(gbc.h(),  0x42);
        EXPECT(gbc.l(),  0x3d);
        EXPECT(gbc.sp(), 0x1b70);
        EXPECT(gbc.pc(), 0x1e63);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0266
        gbc.setState(0x1479, 0x668e, 0x87f0, 0x3b13, 0xd82d, 0x227b, 0x1, 0x1);
        gbc.writeMem(0x1479, { 0xd4, 0x5f, 0xb });
        gbc.step();
        EXPECT(gbc.a(),  0x87);
        EXPECT(gbc.b(),  0x3b);
        EXPECT(gbc.c(),  0x13);
        EXPECT(gbc.d(),  0xd8);
        EXPECT(gbc.e(),  0x2d);
        EXPECT(gbc.h(),  0x22);
        EXPECT(gbc.l(),  0x7b);
        EXPECT(gbc.sp(), 0x668e);
        EXPECT(gbc.pc(), 0x147c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0267
        gbc.setState(0x3537, 0x4822, 0x5db0, 0x6a0b, 0x6677, 0x63bf, 0x0, 0x0);
        gbc.writeMem(0x3537, { 0xd4, 0x43, 0x8d });
        gbc.step();
        EXPECT(gbc.a(),  0x5d);
        EXPECT(gbc.b(),  0x6a);
        EXPECT(gbc.c(),  0xb);
        EXPECT(gbc.d(),  0x66);
        EXPECT(gbc.e(),  0x77);
        EXPECT(gbc.h(),  0x63);
        EXPECT(gbc.l(),  0xbf);
        EXPECT(gbc.sp(), 0x4822);
        EXPECT(gbc.pc(), 0x353a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0268
        gbc.setState(0x813a, 0x6e50, 0xbf30, 0x1f59, 0x3c83, 0xd801, 0x0, 0x1);
        gbc.writeMem(0x813a, { 0xd4, 0x3, 0xc4 });
        gbc.step();
        EXPECT(gbc.a(),  0xbf);
        EXPECT(gbc.b(),  0x1f);
        EXPECT(gbc.c(),  0x59);
        EXPECT(gbc.d(),  0x3c);
        EXPECT(gbc.e(),  0x83);
        EXPECT(gbc.h(),  0xd8);
        EXPECT(gbc.l(),  0x1);
        EXPECT(gbc.sp(), 0x6e50);
        EXPECT(gbc.pc(), 0x813d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x813a), 0xd4);
        EXPECT(gbc.readMem(0x813b), 0x3);
        EXPECT(gbc.readMem(0x813c), 0xc4);
        // D4 0269
        gbc.setState(0x3a62, 0xe04f, 0x6570, 0x79b9, 0xe1b1, 0x249c, 0x0, 0x0);
        gbc.writeMem(0x3a62, { 0xd4, 0xdd, 0x94 });
        gbc.step();
        EXPECT(gbc.a(),  0x65);
        EXPECT(gbc.b(),  0x79);
        EXPECT(gbc.c(),  0xb9);
        EXPECT(gbc.d(),  0xe1);
        EXPECT(gbc.e(),  0xb1);
        EXPECT(gbc.h(),  0x24);
        EXPECT(gbc.l(),  0x9c);
        EXPECT(gbc.sp(), 0xe04f);
        EXPECT(gbc.pc(), 0x3a65);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 026A
        gbc.setState(0x94e8, 0x3b0d, 0x7990, 0xae12, 0xe483, 0x2fa5, 0x0, 0x1);
        gbc.writeMem(0x94e8, { 0xd4, 0x89, 0x5d });
        gbc.step();
        EXPECT(gbc.a(),  0x79);
        EXPECT(gbc.b(),  0xae);
        EXPECT(gbc.c(),  0x12);
        EXPECT(gbc.d(),  0xe4);
        EXPECT(gbc.e(),  0x83);
        EXPECT(gbc.h(),  0x2f);
        EXPECT(gbc.l(),  0xa5);
        EXPECT(gbc.sp(), 0x3b0d);
        EXPECT(gbc.pc(), 0x94eb);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x94e8), 0xd4);
        EXPECT(gbc.readMem(0x94e9), 0x89);
        EXPECT(gbc.readMem(0x94ea), 0x5d);
        // D4 026B
        gbc.setState(0xabec, 0x6043, 0xcff0, 0xef26, 0xef3e, 0x845b, 0x1, 0x0);
        gbc.writeMem(0xabec, { 0xd4, 0x4a, 0xd1 });
        gbc.step();
        EXPECT(gbc.a(),  0xcf);
        EXPECT(gbc.b(),  0xef);
        EXPECT(gbc.c(),  0x26);
        EXPECT(gbc.d(),  0xef);
        EXPECT(gbc.e(),  0x3e);
        EXPECT(gbc.h(),  0x84);
        EXPECT(gbc.l(),  0x5b);
        EXPECT(gbc.sp(), 0x6043);
        EXPECT(gbc.pc(), 0xabef);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xabec), 0xd4);
        EXPECT(gbc.readMem(0xabed), 0x4a);
        EXPECT(gbc.readMem(0xabee), 0xd1);
        // D4 026C
        gbc.setState(0x5895, 0x4a36, 0x7170, 0xada0, 0x1bd0, 0x1252, 0x0, 0x1);
        gbc.writeMem(0x5895, { 0xd4, 0x14, 0x92 });
        gbc.step();
        EXPECT(gbc.a(),  0x71);
        EXPECT(gbc.b(),  0xad);
        EXPECT(gbc.c(),  0xa0);
        EXPECT(gbc.d(),  0x1b);
        EXPECT(gbc.e(),  0xd0);
        EXPECT(gbc.h(),  0x12);
        EXPECT(gbc.l(),  0x52);
        EXPECT(gbc.sp(), 0x4a36);
        EXPECT(gbc.pc(), 0x5898);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 026E
        gbc.setState(0x4aee, 0xadfb, 0xe560, 0x4178, 0xad24, 0xb3fc, 0x0, 0x1);
        gbc.writeMem(0x4aee, { 0xd4, 0x30, 0xb9 });
        gbc.writeMem(0xadf9, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xe5);
        EXPECT(gbc.b(),  0x41);
        EXPECT(gbc.c(),  0x78);
        EXPECT(gbc.d(),  0xad);
        EXPECT(gbc.e(),  0x24);
        EXPECT(gbc.h(),  0xb3);
        EXPECT(gbc.l(),  0xfc);
        EXPECT(gbc.sp(), 0xadf9);
        EXPECT(gbc.pc(), 0xb930);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xadf9), 0xf1);
        EXPECT(gbc.readMem(0xadfa), 0x4a);
        // D4 0272
        gbc.setState(0x3b51, 0xabe3, 0x16b0, 0xd8e5, 0x859, 0xc35d, 0x1, 0x1);
        gbc.writeMem(0x3b51, { 0xd4, 0xff, 0xc8 });
        gbc.step();
        EXPECT(gbc.a(),  0x16);
        EXPECT(gbc.b(),  0xd8);
        EXPECT(gbc.c(),  0xe5);
        EXPECT(gbc.d(),  0x8);
        EXPECT(gbc.e(),  0x59);
        EXPECT(gbc.h(),  0xc3);
        EXPECT(gbc.l(),  0x5d);
        EXPECT(gbc.sp(), 0xabe3);
        EXPECT(gbc.pc(), 0x3b54);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0273
        gbc.setState(0xb53, 0x3035, 0xcb70, 0x1226, 0x93e3, 0xba97, 0x0, 0x0);
        gbc.writeMem(0xb53, { 0xd4, 0x6a, 0x58 });
        gbc.step();
        EXPECT(gbc.a(),  0xcb);
        EXPECT(gbc.b(),  0x12);
        EXPECT(gbc.c(),  0x26);
        EXPECT(gbc.d(),  0x93);
        EXPECT(gbc.e(),  0xe3);
        EXPECT(gbc.h(),  0xba);
        EXPECT(gbc.l(),  0x97);
        EXPECT(gbc.sp(), 0x3035);
        EXPECT(gbc.pc(), 0xb56);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0274
        gbc.setState(0x4027, 0xa406, 0x7d50, 0xcd29, 0x3cb6, 0x9cb7, 0x0, 0x1);
        gbc.writeMem(0x4027, { 0xd4, 0x11, 0xef });
        gbc.step();
        EXPECT(gbc.a(),  0x7d);
        EXPECT(gbc.b(),  0xcd);
        EXPECT(gbc.c(),  0x29);
        EXPECT(gbc.d(),  0x3c);
        EXPECT(gbc.e(),  0xb6);
        EXPECT(gbc.h(),  0x9c);
        EXPECT(gbc.l(),  0xb7);
        EXPECT(gbc.sp(), 0xa406);
        EXPECT(gbc.pc(), 0x402a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0275
        gbc.setState(0xd84c, 0xf090, 0x9540, 0x494a, 0x305a, 0xb320, 0x0, 0x0);
        gbc.writeMem(0xd84c, { 0xd4, 0x28, 0xa8 });
        gbc.writeMem(0xf08e, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x95);
        EXPECT(gbc.b(),  0x49);
        EXPECT(gbc.c(),  0x4a);
        EXPECT(gbc.d(),  0x30);
        EXPECT(gbc.e(),  0x5a);
        EXPECT(gbc.h(),  0xb3);
        EXPECT(gbc.l(),  0x20);
        EXPECT(gbc.sp(), 0xf08e);
        EXPECT(gbc.pc(), 0xa828);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd84c), 0xd4);
        EXPECT(gbc.readMem(0xd84d), 0x28);
        EXPECT(gbc.readMem(0xd84e), 0xa8);
        EXPECT(gbc.readMem(0xf08e), 0x4f);
        EXPECT(gbc.readMem(0xf08f), 0xd8);
        // D4 0277
        gbc.setState(0xa192, 0x485, 0xfaf0, 0x5eae, 0xaba, 0xc3e9, 0x1, 0x0);
        gbc.writeMem(0xa192, { 0xd4, 0x1b, 0x84 });
        gbc.step();
        EXPECT(gbc.a(),  0xfa);
        EXPECT(gbc.b(),  0x5e);
        EXPECT(gbc.c(),  0xae);
        EXPECT(gbc.d(),  0xa);
        EXPECT(gbc.e(),  0xba);
        EXPECT(gbc.h(),  0xc3);
        EXPECT(gbc.l(),  0xe9);
        EXPECT(gbc.sp(), 0x485);
        EXPECT(gbc.pc(), 0xa195);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa192), 0xd4);
        EXPECT(gbc.readMem(0xa193), 0x1b);
        EXPECT(gbc.readMem(0xa194), 0x84);
        // D4 0278
        gbc.setState(0x2d77, 0xd948, 0xaf70, 0x19af, 0xcdbf, 0xc3f5, 0x1, 0x0);
        gbc.writeMem(0x2d77, { 0xd4, 0x6c, 0x7d });
        gbc.step();
        EXPECT(gbc.a(),  0xaf);
        EXPECT(gbc.b(),  0x19);
        EXPECT(gbc.c(),  0xaf);
        EXPECT(gbc.d(),  0xcd);
        EXPECT(gbc.e(),  0xbf);
        EXPECT(gbc.h(),  0xc3);
        EXPECT(gbc.l(),  0xf5);
        EXPECT(gbc.sp(), 0xd948);
        EXPECT(gbc.pc(), 0x2d7a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0279
        gbc.setState(0x6edc, 0x5d34, 0x57f0, 0x7f4c, 0x5df6, 0x87f7, 0x0, 0x1);
        gbc.writeMem(0x6edc, { 0xd4, 0xd6, 0xc3 });
        gbc.step();
        EXPECT(gbc.a(),  0x57);
        EXPECT(gbc.b(),  0x7f);
        EXPECT(gbc.c(),  0x4c);
        EXPECT(gbc.d(),  0x5d);
        EXPECT(gbc.e(),  0xf6);
        EXPECT(gbc.h(),  0x87);
        EXPECT(gbc.l(),  0xf7);
        EXPECT(gbc.sp(), 0x5d34);
        EXPECT(gbc.pc(), 0x6edf);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 027A
        gbc.setState(0xad59, 0xa6a1, 0x7d90, 0xc68, 0xf2f0, 0x84b5, 0x1, 0x1);
        gbc.writeMem(0xad59, { 0xd4, 0x6f, 0xdb });
        gbc.step();
        EXPECT(gbc.a(),  0x7d);
        EXPECT(gbc.b(),  0xc);
        EXPECT(gbc.c(),  0x68);
        EXPECT(gbc.d(),  0xf2);
        EXPECT(gbc.e(),  0xf0);
        EXPECT(gbc.h(),  0x84);
        EXPECT(gbc.l(),  0xb5);
        EXPECT(gbc.sp(), 0xa6a1);
        EXPECT(gbc.pc(), 0xad5c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xad59), 0xd4);
        EXPECT(gbc.readMem(0xad5a), 0x6f);
        EXPECT(gbc.readMem(0xad5b), 0xdb);
        // D4 027B
        gbc.setState(0xabde, 0xeaac, 0x5b0, 0xd803, 0x4e7, 0xf4b1, 0x1, 0x0);
        gbc.writeMem(0xabde, { 0xd4, 0xfb, 0xa9 });
        gbc.step();
        EXPECT(gbc.a(),  0x5);
        EXPECT(gbc.b(),  0xd8);
        EXPECT(gbc.c(),  0x3);
        EXPECT(gbc.d(),  0x4);
        EXPECT(gbc.e(),  0xe7);
        EXPECT(gbc.h(),  0xf4);
        EXPECT(gbc.l(),  0xb1);
        EXPECT(gbc.sp(), 0xeaac);
        EXPECT(gbc.pc(), 0xabe1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xabde), 0xd4);
        EXPECT(gbc.readMem(0xabdf), 0xfb);
        EXPECT(gbc.readMem(0xabe0), 0xa9);
        // D4 027D
        gbc.setState(0x1054, 0xca94, 0x40e0, 0x2e15, 0x85a8, 0x71b8, 0x1, 0x1);
        gbc.writeMem(0x1054, { 0xd4, 0x86, 0xa });
        gbc.writeMem(0xca92, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0x2e);
        EXPECT(gbc.c(),  0x15);
        EXPECT(gbc.d(),  0x85);
        EXPECT(gbc.e(),  0xa8);
        EXPECT(gbc.h(),  0x71);
        EXPECT(gbc.l(),  0xb8);
        EXPECT(gbc.sp(), 0xca92);
        EXPECT(gbc.pc(), 0xa86);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xca92), 0x57);
        EXPECT(gbc.readMem(0xca93), 0x10);
        // D4 027E
        gbc.setState(0x2a79, 0xa2a8, 0x9bf0, 0x3f12, 0xea33, 0x1550, 0x1, 0x0);
        gbc.writeMem(0x2a79, { 0xd4, 0xd2, 0xb5 });
        gbc.step();
        EXPECT(gbc.a(),  0x9b);
        EXPECT(gbc.b(),  0x3f);
        EXPECT(gbc.c(),  0x12);
        EXPECT(gbc.d(),  0xea);
        EXPECT(gbc.e(),  0x33);
        EXPECT(gbc.h(),  0x15);
        EXPECT(gbc.l(),  0x50);
        EXPECT(gbc.sp(), 0xa2a8);
        EXPECT(gbc.pc(), 0x2a7c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 027F
        gbc.setState(0x4fde, 0x6fd4, 0x7750, 0xe42a, 0x7072, 0xd94e, 0x1, 0x1);
        gbc.writeMem(0x4fde, { 0xd4, 0xd, 0x22 });
        gbc.step();
        EXPECT(gbc.a(),  0x77);
        EXPECT(gbc.b(),  0xe4);
        EXPECT(gbc.c(),  0x2a);
        EXPECT(gbc.d(),  0x70);
        EXPECT(gbc.e(),  0x72);
        EXPECT(gbc.h(),  0xd9);
        EXPECT(gbc.l(),  0x4e);
        EXPECT(gbc.sp(), 0x6fd4);
        EXPECT(gbc.pc(), 0x4fe1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0280
        gbc.setState(0x4c0b, 0x7b71, 0xc170, 0xcdc1, 0xc157, 0x91d5, 0x1, 0x1);
        gbc.writeMem(0x4c0b, { 0xd4, 0x15, 0x9c });
        gbc.step();
        EXPECT(gbc.a(),  0xc1);
        EXPECT(gbc.b(),  0xcd);
        EXPECT(gbc.c(),  0xc1);
        EXPECT(gbc.d(),  0xc1);
        EXPECT(gbc.e(),  0x57);
        EXPECT(gbc.h(),  0x91);
        EXPECT(gbc.l(),  0xd5);
        EXPECT(gbc.sp(), 0x7b71);
        EXPECT(gbc.pc(), 0x4c0e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0281
        gbc.setState(0x6d7f, 0xacc4, 0xba70, 0x2a18, 0x4d11, 0x3c48, 0x1, 0x0);
        gbc.writeMem(0x6d7f, { 0xd4, 0xe2, 0xe1 });
        gbc.step();
        EXPECT(gbc.a(),  0xba);
        EXPECT(gbc.b(),  0x2a);
        EXPECT(gbc.c(),  0x18);
        EXPECT(gbc.d(),  0x4d);
        EXPECT(gbc.e(),  0x11);
        EXPECT(gbc.h(),  0x3c);
        EXPECT(gbc.l(),  0x48);
        EXPECT(gbc.sp(), 0xacc4);
        EXPECT(gbc.pc(), 0x6d82);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0282
        gbc.setState(0x2fd2, 0x25de, 0x4930, 0xedec, 0xbf56, 0xb21f, 0x0, 0x0);
        gbc.writeMem(0x2fd2, { 0xd4, 0x5a, 0xde });
        gbc.step();
        EXPECT(gbc.a(),  0x49);
        EXPECT(gbc.b(),  0xed);
        EXPECT(gbc.c(),  0xec);
        EXPECT(gbc.d(),  0xbf);
        EXPECT(gbc.e(),  0x56);
        EXPECT(gbc.h(),  0xb2);
        EXPECT(gbc.l(),  0x1f);
        EXPECT(gbc.sp(), 0x25de);
        EXPECT(gbc.pc(), 0x2fd5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0285
        gbc.setState(0xcae, 0x9429, 0xe5e0, 0x3ff, 0x2ada, 0x4a4b, 0x0, 0x0);
        gbc.writeMem(0xcae, { 0xd4, 0x1c, 0x72 });
        gbc.writeMem(0x9427, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xe5);
        EXPECT(gbc.b(),  0x3);
        EXPECT(gbc.c(),  0xff);
        EXPECT(gbc.d(),  0x2a);
        EXPECT(gbc.e(),  0xda);
        EXPECT(gbc.h(),  0x4a);
        EXPECT(gbc.l(),  0x4b);
        EXPECT(gbc.sp(), 0x9427);
        EXPECT(gbc.pc(), 0x721c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9427), 0xb1);
        EXPECT(gbc.readMem(0x9428), 0xc);
        // D4 0286
        gbc.setState(0x6760, 0xf0c7, 0xcd80, 0x355b, 0x97ae, 0xcd75, 0x1, 0x1);
        gbc.writeMem(0x6760, { 0xd4, 0xb5, 0x93 });
        gbc.writeMem(0xf0c5, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xcd);
        EXPECT(gbc.b(),  0x35);
        EXPECT(gbc.c(),  0x5b);
        EXPECT(gbc.d(),  0x97);
        EXPECT(gbc.e(),  0xae);
        EXPECT(gbc.h(),  0xcd);
        EXPECT(gbc.l(),  0x75);
        EXPECT(gbc.sp(), 0xf0c5);
        EXPECT(gbc.pc(), 0x93b5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xf0c5), 0x63);
        EXPECT(gbc.readMem(0xf0c6), 0x67);
        // D4 0287
        gbc.setState(0xd7cd, 0x6e6a, 0x1330, 0xdc09, 0x4968, 0xa222, 0x1, 0x1);
        gbc.writeMem(0xd7cd, { 0xd4, 0x79, 0x24 });
        gbc.step();
        EXPECT(gbc.a(),  0x13);
        EXPECT(gbc.b(),  0xdc);
        EXPECT(gbc.c(),  0x9);
        EXPECT(gbc.d(),  0x49);
        EXPECT(gbc.e(),  0x68);
        EXPECT(gbc.h(),  0xa2);
        EXPECT(gbc.l(),  0x22);
        EXPECT(gbc.sp(), 0x6e6a);
        EXPECT(gbc.pc(), 0xd7d0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd7cd), 0xd4);
        EXPECT(gbc.readMem(0xd7ce), 0x79);
        EXPECT(gbc.readMem(0xd7cf), 0x24);
        // D4 0288
        gbc.setState(0x6aee, 0x7d5b, 0xbc30, 0xf691, 0x2e23, 0xe712, 0x1, 0x1);
        gbc.writeMem(0x6aee, { 0xd4, 0x72, 0x84 });
        gbc.step();
        EXPECT(gbc.a(),  0xbc);
        EXPECT(gbc.b(),  0xf6);
        EXPECT(gbc.c(),  0x91);
        EXPECT(gbc.d(),  0x2e);
        EXPECT(gbc.e(),  0x23);
        EXPECT(gbc.h(),  0xe7);
        EXPECT(gbc.l(),  0x12);
        EXPECT(gbc.sp(), 0x7d5b);
        EXPECT(gbc.pc(), 0x6af1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 028A
        gbc.setState(0x2476, 0xcf2a, 0xea10, 0x3b0b, 0xc58b, 0xe03d, 0x1, 0x1);
        gbc.writeMem(0x2476, { 0xd4, 0xfa, 0xd0 });
        gbc.step();
        EXPECT(gbc.a(),  0xea);
        EXPECT(gbc.b(),  0x3b);
        EXPECT(gbc.c(),  0xb);
        EXPECT(gbc.d(),  0xc5);
        EXPECT(gbc.e(),  0x8b);
        EXPECT(gbc.h(),  0xe0);
        EXPECT(gbc.l(),  0x3d);
        EXPECT(gbc.sp(), 0xcf2a);
        EXPECT(gbc.pc(), 0x2479);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 028B
        gbc.setState(0xa4da, 0x1c41, 0xe810, 0x8cba, 0x35aa, 0xa88b, 0x0, 0x1);
        gbc.writeMem(0xa4da, { 0xd4, 0xbd, 0xcc });
        gbc.step();
        EXPECT(gbc.a(),  0xe8);
        EXPECT(gbc.b(),  0x8c);
        EXPECT(gbc.c(),  0xba);
        EXPECT(gbc.d(),  0x35);
        EXPECT(gbc.e(),  0xaa);
        EXPECT(gbc.h(),  0xa8);
        EXPECT(gbc.l(),  0x8b);
        EXPECT(gbc.sp(), 0x1c41);
        EXPECT(gbc.pc(), 0xa4dd);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa4da), 0xd4);
        EXPECT(gbc.readMem(0xa4db), 0xbd);
        EXPECT(gbc.readMem(0xa4dc), 0xcc);
        // D4 028C
        gbc.setState(0x208a, 0x17e1, 0x8110, 0xac0e, 0xae67, 0x9b45, 0x1, 0x1);
        gbc.writeMem(0x208a, { 0xd4, 0x91, 0x84 });
        gbc.step();
        EXPECT(gbc.a(),  0x81);
        EXPECT(gbc.b(),  0xac);
        EXPECT(gbc.c(),  0xe);
        EXPECT(gbc.d(),  0xae);
        EXPECT(gbc.e(),  0x67);
        EXPECT(gbc.h(),  0x9b);
        EXPECT(gbc.l(),  0x45);
        EXPECT(gbc.sp(), 0x17e1);
        EXPECT(gbc.pc(), 0x208d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 028D
        gbc.setState(0xa67d, 0x60da, 0xb010, 0x3a17, 0xf043, 0x9de8, 0x0, 0x1);
        gbc.writeMem(0xa67d, { 0xd4, 0x49, 0x8 });
        gbc.step();
        EXPECT(gbc.a(),  0xb0);
        EXPECT(gbc.b(),  0x3a);
        EXPECT(gbc.c(),  0x17);
        EXPECT(gbc.d(),  0xf0);
        EXPECT(gbc.e(),  0x43);
        EXPECT(gbc.h(),  0x9d);
        EXPECT(gbc.l(),  0xe8);
        EXPECT(gbc.sp(), 0x60da);
        EXPECT(gbc.pc(), 0xa680);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa67d), 0xd4);
        EXPECT(gbc.readMem(0xa67e), 0x49);
        EXPECT(gbc.readMem(0xa67f), 0x8);
        // D4 028E
        gbc.setState(0xddb5, 0x2a6, 0x3230, 0xebb0, 0xba39, 0x9e73, 0x1, 0x1);
        gbc.writeMem(0xddb5, { 0xd4, 0xfb, 0xc1 });
        gbc.step();
        EXPECT(gbc.a(),  0x32);
        EXPECT(gbc.b(),  0xeb);
        EXPECT(gbc.c(),  0xb0);
        EXPECT(gbc.d(),  0xba);
        EXPECT(gbc.e(),  0x39);
        EXPECT(gbc.h(),  0x9e);
        EXPECT(gbc.l(),  0x73);
        EXPECT(gbc.sp(), 0x2a6);
        EXPECT(gbc.pc(), 0xddb8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xddb5), 0xd4);
        EXPECT(gbc.readMem(0xddb6), 0xfb);
        EXPECT(gbc.readMem(0xddb7), 0xc1);
        // D4 028F
        gbc.setState(0x3e19, 0xe776, 0x2c90, 0x1884, 0x4229, 0x89d5, 0x0, 0x0);
        gbc.writeMem(0x3e19, { 0xd4, 0xf0, 0x55 });
        gbc.step();
        EXPECT(gbc.a(),  0x2c);
        EXPECT(gbc.b(),  0x18);
        EXPECT(gbc.c(),  0x84);
        EXPECT(gbc.d(),  0x42);
        EXPECT(gbc.e(),  0x29);
        EXPECT(gbc.h(),  0x89);
        EXPECT(gbc.l(),  0xd5);
        EXPECT(gbc.sp(), 0xe776);
        EXPECT(gbc.pc(), 0x3e1c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0291
        gbc.setState(0xe8d2, 0x29b9, 0x210, 0xa03e, 0xb5b, 0x5f07, 0x1, 0x0);
        gbc.writeMem(0xe8d2, { 0xd4, 0xc3, 0x42 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0xa0);
        EXPECT(gbc.c(),  0x3e);
        EXPECT(gbc.d(),  0xb);
        EXPECT(gbc.e(),  0x5b);
        EXPECT(gbc.h(),  0x5f);
        EXPECT(gbc.l(),  0x7);
        EXPECT(gbc.sp(), 0x29b9);
        EXPECT(gbc.pc(), 0xe8d5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe8d2), 0xd4);
        EXPECT(gbc.readMem(0xe8d3), 0xc3);
        EXPECT(gbc.readMem(0xe8d4), 0x42);
        // D4 0293
        gbc.setState(0xccef, 0x9069, 0x25f0, 0xf82b, 0xd15c, 0xb512, 0x1, 0x0);
        gbc.writeMem(0xccef, { 0xd4, 0xb2, 0x9c });
        gbc.step();
        EXPECT(gbc.a(),  0x25);
        EXPECT(gbc.b(),  0xf8);
        EXPECT(gbc.c(),  0x2b);
        EXPECT(gbc.d(),  0xd1);
        EXPECT(gbc.e(),  0x5c);
        EXPECT(gbc.h(),  0xb5);
        EXPECT(gbc.l(),  0x12);
        EXPECT(gbc.sp(), 0x9069);
        EXPECT(gbc.pc(), 0xccf2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xccef), 0xd4);
        EXPECT(gbc.readMem(0xccf0), 0xb2);
        EXPECT(gbc.readMem(0xccf1), 0x9c);
        // D4 0294
        gbc.setState(0xe222, 0xcda9, 0x80d0, 0x7632, 0x417, 0x26f4, 0x1, 0x0);
        gbc.writeMem(0xe222, { 0xd4, 0xa2, 0x7d });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0x76);
        EXPECT(gbc.c(),  0x32);
        EXPECT(gbc.d(),  0x4);
        EXPECT(gbc.e(),  0x17);
        EXPECT(gbc.h(),  0x26);
        EXPECT(gbc.l(),  0xf4);
        EXPECT(gbc.sp(), 0xcda9);
        EXPECT(gbc.pc(), 0xe225);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe222), 0xd4);
        EXPECT(gbc.readMem(0xe223), 0xa2);
        EXPECT(gbc.readMem(0xe224), 0x7d);
        // D4 0297
        gbc.setState(0x1f8f, 0x748b, 0xf8f0, 0x622c, 0xbe58, 0x1044, 0x1, 0x0);
        gbc.writeMem(0x1f8f, { 0xd4, 0xaa, 0x76 });
        gbc.step();
        EXPECT(gbc.a(),  0xf8);
        EXPECT(gbc.b(),  0x62);
        EXPECT(gbc.c(),  0x2c);
        EXPECT(gbc.d(),  0xbe);
        EXPECT(gbc.e(),  0x58);
        EXPECT(gbc.h(),  0x10);
        EXPECT(gbc.l(),  0x44);
        EXPECT(gbc.sp(), 0x748b);
        EXPECT(gbc.pc(), 0x1f92);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0298
        gbc.setState(0xb68e, 0xcff4, 0x3490, 0xbdf9, 0xf21a, 0x59fb, 0x0, 0x0);
        gbc.writeMem(0xb68e, { 0xd4, 0x68, 0x66 });
        gbc.step();
        EXPECT(gbc.a(),  0x34);
        EXPECT(gbc.b(),  0xbd);
        EXPECT(gbc.c(),  0xf9);
        EXPECT(gbc.d(),  0xf2);
        EXPECT(gbc.e(),  0x1a);
        EXPECT(gbc.h(),  0x59);
        EXPECT(gbc.l(),  0xfb);
        EXPECT(gbc.sp(), 0xcff4);
        EXPECT(gbc.pc(), 0xb691);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb68e), 0xd4);
        EXPECT(gbc.readMem(0xb68f), 0x68);
        EXPECT(gbc.readMem(0xb690), 0x66);
        // D4 0299
        gbc.setState(0x2193, 0x8e9a, 0xf1a0, 0x3ded, 0x4587, 0x60ad, 0x1, 0x0);
        gbc.writeMem(0x2193, { 0xd4, 0x3d, 0x66 });
        gbc.writeMem(0x8e98, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xf1);
        EXPECT(gbc.b(),  0x3d);
        EXPECT(gbc.c(),  0xed);
        EXPECT(gbc.d(),  0x45);
        EXPECT(gbc.e(),  0x87);
        EXPECT(gbc.h(),  0x60);
        EXPECT(gbc.l(),  0xad);
        EXPECT(gbc.sp(), 0x8e98);
        EXPECT(gbc.pc(), 0x663d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8e98), 0x96);
        EXPECT(gbc.readMem(0x8e99), 0x21);
        // D4 029B
        gbc.setState(0x5ffc, 0x1d8c, 0x7370, 0x8658, 0x3e22, 0x35a4, 0x0, 0x1);
        gbc.writeMem(0x5ffc, { 0xd4, 0xea, 0x62 });
        gbc.step();
        EXPECT(gbc.a(),  0x73);
        EXPECT(gbc.b(),  0x86);
        EXPECT(gbc.c(),  0x58);
        EXPECT(gbc.d(),  0x3e);
        EXPECT(gbc.e(),  0x22);
        EXPECT(gbc.h(),  0x35);
        EXPECT(gbc.l(),  0xa4);
        EXPECT(gbc.sp(), 0x1d8c);
        EXPECT(gbc.pc(), 0x5fff);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 029C
        gbc.setState(0x36bd, 0x95f2, 0x81b0, 0x89b, 0xaf4e, 0x85b8, 0x0, 0x0);
        gbc.writeMem(0x36bd, { 0xd4, 0x49, 0x9b });
        gbc.step();
        EXPECT(gbc.a(),  0x81);
        EXPECT(gbc.b(),  0x8);
        EXPECT(gbc.c(),  0x9b);
        EXPECT(gbc.d(),  0xaf);
        EXPECT(gbc.e(),  0x4e);
        EXPECT(gbc.h(),  0x85);
        EXPECT(gbc.l(),  0xb8);
        EXPECT(gbc.sp(), 0x95f2);
        EXPECT(gbc.pc(), 0x36c0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 029E
        gbc.setState(0x7486, 0x990c, 0xe5c0, 0x1f0d, 0x1245, 0x8b0f, 0x0, 0x0);
        gbc.writeMem(0x7486, { 0xd4, 0x9f, 0xe5 });
        gbc.writeMem(0x990a, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xe5);
        EXPECT(gbc.b(),  0x1f);
        EXPECT(gbc.c(),  0xd);
        EXPECT(gbc.d(),  0x12);
        EXPECT(gbc.e(),  0x45);
        EXPECT(gbc.h(),  0x8b);
        EXPECT(gbc.l(),  0xf);
        EXPECT(gbc.sp(), 0x990a);
        EXPECT(gbc.pc(), 0xe59f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x990a), 0x89);
        EXPECT(gbc.readMem(0x990b), 0x74);
        // D4 029F
        gbc.setState(0x857c, 0xfe50, 0x1300, 0xdcda, 0x22c1, 0xbeae, 0x1, 0x0);
        gbc.writeMem(0x857c, { 0xd4, 0x3d, 0x30 });
        gbc.writeMem(0xfe4e, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x13);
        EXPECT(gbc.b(),  0xdc);
        EXPECT(gbc.c(),  0xda);
        EXPECT(gbc.d(),  0x22);
        EXPECT(gbc.e(),  0xc1);
        EXPECT(gbc.h(),  0xbe);
        EXPECT(gbc.l(),  0xae);
        EXPECT(gbc.sp(), 0xfe4e);
        EXPECT(gbc.pc(), 0x303d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x857c), 0xd4);
        EXPECT(gbc.readMem(0x857d), 0x3d);
        EXPECT(gbc.readMem(0x857e), 0x30);
        EXPECT(gbc.readMem(0xfe4e), 0x7f);
        EXPECT(gbc.readMem(0xfe4f), 0x85);
        // D4 02A0
        gbc.setState(0xbb6e, 0xf494, 0x3e00, 0xaa9f, 0xc92b, 0xbf34, 0x1, 0x0);
        gbc.writeMem(0xbb6e, { 0xd4, 0xe1, 0x86 });
        gbc.writeMem(0xf492, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x3e);
        EXPECT(gbc.b(),  0xaa);
        EXPECT(gbc.c(),  0x9f);
        EXPECT(gbc.d(),  0xc9);
        EXPECT(gbc.e(),  0x2b);
        EXPECT(gbc.h(),  0xbf);
        EXPECT(gbc.l(),  0x34);
        EXPECT(gbc.sp(), 0xf492);
        EXPECT(gbc.pc(), 0x86e1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbb6e), 0xd4);
        EXPECT(gbc.readMem(0xbb6f), 0xe1);
        EXPECT(gbc.readMem(0xbb70), 0x86);
        EXPECT(gbc.readMem(0xf492), 0x71);
        EXPECT(gbc.readMem(0xf493), 0xbb);
        // D4 02A1
        gbc.setState(0x9562, 0xd485, 0x4d30, 0x4e72, 0xebf3, 0x8427, 0x0, 0x1);
        gbc.writeMem(0x9562, { 0xd4, 0xb8, 0x4e });
        gbc.step();
        EXPECT(gbc.a(),  0x4d);
        EXPECT(gbc.b(),  0x4e);
        EXPECT(gbc.c(),  0x72);
        EXPECT(gbc.d(),  0xeb);
        EXPECT(gbc.e(),  0xf3);
        EXPECT(gbc.h(),  0x84);
        EXPECT(gbc.l(),  0x27);
        EXPECT(gbc.sp(), 0xd485);
        EXPECT(gbc.pc(), 0x9565);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9562), 0xd4);
        EXPECT(gbc.readMem(0x9563), 0xb8);
        EXPECT(gbc.readMem(0x9564), 0x4e);
        // D4 02A2
        gbc.setState(0xde8d, 0xc66a, 0x69d0, 0xec2a, 0x9b25, 0x7ad4, 0x0, 0x1);
        gbc.writeMem(0xde8d, { 0xd4, 0x99, 0x2 });
        gbc.step();
        EXPECT(gbc.a(),  0x69);
        EXPECT(gbc.b(),  0xec);
        EXPECT(gbc.c(),  0x2a);
        EXPECT(gbc.d(),  0x9b);
        EXPECT(gbc.e(),  0x25);
        EXPECT(gbc.h(),  0x7a);
        EXPECT(gbc.l(),  0xd4);
        EXPECT(gbc.sp(), 0xc66a);
        EXPECT(gbc.pc(), 0xde90);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xde8d), 0xd4);
        EXPECT(gbc.readMem(0xde8e), 0x99);
        EXPECT(gbc.readMem(0xde8f), 0x2);
        // D4 02A4
        gbc.setState(0x75a5, 0xad02, 0xf9c0, 0x772b, 0x5df3, 0x18b0, 0x0, 0x0);
        gbc.writeMem(0x75a5, { 0xd4, 0x1d, 0xd9 });
        gbc.writeMem(0xad00, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xf9);
        EXPECT(gbc.b(),  0x77);
        EXPECT(gbc.c(),  0x2b);
        EXPECT(gbc.d(),  0x5d);
        EXPECT(gbc.e(),  0xf3);
        EXPECT(gbc.h(),  0x18);
        EXPECT(gbc.l(),  0xb0);
        EXPECT(gbc.sp(), 0xad00);
        EXPECT(gbc.pc(), 0xd91d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xad00), 0xa8);
        EXPECT(gbc.readMem(0xad01), 0x75);
        // D4 02A5
        gbc.setState(0x39ca, 0xb5c6, 0x9fe0, 0x650a, 0x9c5, 0xe6c6, 0x0, 0x0);
        gbc.writeMem(0x39ca, { 0xd4, 0x9a, 0x5a });
        gbc.writeMem(0xb5c4, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x9f);
        EXPECT(gbc.b(),  0x65);
        EXPECT(gbc.c(),  0xa);
        EXPECT(gbc.d(),  0x9);
        EXPECT(gbc.e(),  0xc5);
        EXPECT(gbc.h(),  0xe6);
        EXPECT(gbc.l(),  0xc6);
        EXPECT(gbc.sp(), 0xb5c4);
        EXPECT(gbc.pc(), 0x5a9a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb5c4), 0xcd);
        EXPECT(gbc.readMem(0xb5c5), 0x39);
        // D4 02A7
        gbc.setState(0xb445, 0xad55, 0x97c0, 0x64d1, 0x52d1, 0x3fa6, 0x1, 0x0);
        gbc.writeMem(0xad53, { 0x0, 0x0 });
        gbc.writeMem(0xb445, { 0xd4, 0xc3, 0xe6 });
        gbc.step();
        EXPECT(gbc.a(),  0x97);
        EXPECT(gbc.b(),  0x64);
        EXPECT(gbc.c(),  0xd1);
        EXPECT(gbc.d(),  0x52);
        EXPECT(gbc.e(),  0xd1);
        EXPECT(gbc.h(),  0x3f);
        EXPECT(gbc.l(),  0xa6);
        EXPECT(gbc.sp(), 0xad53);
        EXPECT(gbc.pc(), 0xe6c3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xad53), 0x48);
        EXPECT(gbc.readMem(0xad54), 0xb4);
        EXPECT(gbc.readMem(0xb445), 0xd4);
        EXPECT(gbc.readMem(0xb446), 0xc3);
        EXPECT(gbc.readMem(0xb447), 0xe6);
        // D4 02A8
        gbc.setState(0x441a, 0xfb56, 0xccb0, 0x6b3f, 0xa9c7, 0xee3f, 0x1, 0x1);
        gbc.writeMem(0x441a, { 0xd4, 0xad, 0xe5 });
        gbc.step();
        EXPECT(gbc.a(),  0xcc);
        EXPECT(gbc.b(),  0x6b);
        EXPECT(gbc.c(),  0x3f);
        EXPECT(gbc.d(),  0xa9);
        EXPECT(gbc.e(),  0xc7);
        EXPECT(gbc.h(),  0xee);
        EXPECT(gbc.l(),  0x3f);
        EXPECT(gbc.sp(), 0xfb56);
        EXPECT(gbc.pc(), 0x441d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 02A9
        gbc.setState(0x4cd, 0xc1fc, 0xe7a0, 0xca28, 0xaa0c, 0xee76, 0x0, 0x1);
        gbc.writeMem(0x4cd, { 0xd4, 0xbb, 0xb4 });
        gbc.writeMem(0xc1fa, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xe7);
        EXPECT(gbc.b(),  0xca);
        EXPECT(gbc.c(),  0x28);
        EXPECT(gbc.d(),  0xaa);
        EXPECT(gbc.e(),  0xc);
        EXPECT(gbc.h(),  0xee);
        EXPECT(gbc.l(),  0x76);
        EXPECT(gbc.sp(), 0xc1fa);
        EXPECT(gbc.pc(), 0xb4bb);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc1fa), 0xd0);
        EXPECT(gbc.readMem(0xc1fb), 0x4);
        // D4 02AA
        gbc.setState(0xc246, 0x8c08, 0x6b10, 0xe351, 0x5863, 0xe590, 0x1, 0x0);
        gbc.writeMem(0xc246, { 0xd4, 0x58, 0x4d });
        gbc.step();
        EXPECT(gbc.a(),  0x6b);
        EXPECT(gbc.b(),  0xe3);
        EXPECT(gbc.c(),  0x51);
        EXPECT(gbc.d(),  0x58);
        EXPECT(gbc.e(),  0x63);
        EXPECT(gbc.h(),  0xe5);
        EXPECT(gbc.l(),  0x90);
        EXPECT(gbc.sp(), 0x8c08);
        EXPECT(gbc.pc(), 0xc249);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc246), 0xd4);
        EXPECT(gbc.readMem(0xc247), 0x58);
        EXPECT(gbc.readMem(0xc248), 0x4d);
        // D4 02AC
        gbc.setState(0x9c5d, 0x292a, 0x250, 0x0, 0xf43e, 0xcdbd, 0x0, 0x0);
        gbc.writeMem(0x9c5d, { 0xd4, 0xeb, 0x8 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0x0);
        EXPECT(gbc.c(),  0x0);
        EXPECT(gbc.d(),  0xf4);
        EXPECT(gbc.e(),  0x3e);
        EXPECT(gbc.h(),  0xcd);
        EXPECT(gbc.l(),  0xbd);
        EXPECT(gbc.sp(), 0x292a);
        EXPECT(gbc.pc(), 0x9c60);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9c5d), 0xd4);
        EXPECT(gbc.readMem(0x9c5e), 0xeb);
        EXPECT(gbc.readMem(0x9c5f), 0x8);
        // D4 02AD
        gbc.setState(0xb2d1, 0xed9c, 0x2f40, 0xe850, 0x3cf2, 0xefd1, 0x1, 0x0);
        gbc.writeMem(0xb2d1, { 0xd4, 0xe8, 0x4a });
        gbc.writeMem(0xed9a, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x2f);
        EXPECT(gbc.b(),  0xe8);
        EXPECT(gbc.c(),  0x50);
        EXPECT(gbc.d(),  0x3c);
        EXPECT(gbc.e(),  0xf2);
        EXPECT(gbc.h(),  0xef);
        EXPECT(gbc.l(),  0xd1);
        EXPECT(gbc.sp(), 0xed9a);
        EXPECT(gbc.pc(), 0x4ae8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb2d1), 0xd4);
        EXPECT(gbc.readMem(0xb2d2), 0xe8);
        EXPECT(gbc.readMem(0xb2d3), 0x4a);
        EXPECT(gbc.readMem(0xed9a), 0xd4);
        EXPECT(gbc.readMem(0xed9b), 0xb2);
        // D4 02AE
        gbc.setState(0x7cfa, 0xdc12, 0xc520, 0x66ea, 0x2d8d, 0x63ea, 0x0, 0x1);
        gbc.writeMem(0x7cfa, { 0xd4, 0x7, 0xfe });
        gbc.writeMem(0xdc10, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xc5);
        EXPECT(gbc.b(),  0x66);
        EXPECT(gbc.c(),  0xea);
        EXPECT(gbc.d(),  0x2d);
        EXPECT(gbc.e(),  0x8d);
        EXPECT(gbc.h(),  0x63);
        EXPECT(gbc.l(),  0xea);
        EXPECT(gbc.sp(), 0xdc10);
        EXPECT(gbc.pc(), 0xfe07);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdc10), 0xfd);
        EXPECT(gbc.readMem(0xdc11), 0x7c);
        // D4 02AF
        gbc.setState(0xd8c8, 0xe730, 0x3730, 0xf02b, 0xadb7, 0xf687, 0x1, 0x0);
        gbc.writeMem(0xd8c8, { 0xd4, 0x56, 0x6f });
        gbc.step();
        EXPECT(gbc.a(),  0x37);
        EXPECT(gbc.b(),  0xf0);
        EXPECT(gbc.c(),  0x2b);
        EXPECT(gbc.d(),  0xad);
        EXPECT(gbc.e(),  0xb7);
        EXPECT(gbc.h(),  0xf6);
        EXPECT(gbc.l(),  0x87);
        EXPECT(gbc.sp(), 0xe730);
        EXPECT(gbc.pc(), 0xd8cb);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd8c8), 0xd4);
        EXPECT(gbc.readMem(0xd8c9), 0x56);
        EXPECT(gbc.readMem(0xd8ca), 0x6f);
        // D4 02B2
        gbc.setState(0x604b, 0x5660, 0x1fb0, 0x9236, 0x5002, 0x425e, 0x1, 0x1);
        gbc.writeMem(0x604b, { 0xd4, 0x10, 0x52 });
        gbc.step();
        EXPECT(gbc.a(),  0x1f);
        EXPECT(gbc.b(),  0x92);
        EXPECT(gbc.c(),  0x36);
        EXPECT(gbc.d(),  0x50);
        EXPECT(gbc.e(),  0x2);
        EXPECT(gbc.h(),  0x42);
        EXPECT(gbc.l(),  0x5e);
        EXPECT(gbc.sp(), 0x5660);
        EXPECT(gbc.pc(), 0x604e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 02B5
        gbc.setState(0x69ed, 0xe349, 0x64d0, 0x71c, 0xaa3c, 0x755c, 0x1, 0x1);
        gbc.writeMem(0x69ed, { 0xd4, 0x45, 0x6c });
        gbc.step();
        EXPECT(gbc.a(),  0x64);
        EXPECT(gbc.b(),  0x7);
        EXPECT(gbc.c(),  0x1c);
        EXPECT(gbc.d(),  0xaa);
        EXPECT(gbc.e(),  0x3c);
        EXPECT(gbc.h(),  0x75);
        EXPECT(gbc.l(),  0x5c);
        EXPECT(gbc.sp(), 0xe349);
        EXPECT(gbc.pc(), 0x69f0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 02B6
        gbc.setState(0xe464, 0xe362, 0xa5f0, 0x6c8b, 0x6866, 0xc2a8, 0x0, 0x1);
        gbc.writeMem(0xe464, { 0xd4, 0x79, 0x7a });
        gbc.step();
        EXPECT(gbc.a(),  0xa5);
        EXPECT(gbc.b(),  0x6c);
        EXPECT(gbc.c(),  0x8b);
        EXPECT(gbc.d(),  0x68);
        EXPECT(gbc.e(),  0x66);
        EXPECT(gbc.h(),  0xc2);
        EXPECT(gbc.l(),  0xa8);
        EXPECT(gbc.sp(), 0xe362);
        EXPECT(gbc.pc(), 0xe467);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe464), 0xd4);
        EXPECT(gbc.readMem(0xe465), 0x79);
        EXPECT(gbc.readMem(0xe466), 0x7a);
        // D4 02B7
        gbc.setState(0x961c, 0xf605, 0xe790, 0xce8e, 0xf9c0, 0x3005, 0x0, 0x0);
        gbc.writeMem(0x961c, { 0xd4, 0xd, 0x1d });
        gbc.step();
        EXPECT(gbc.a(),  0xe7);
        EXPECT(gbc.b(),  0xce);
        EXPECT(gbc.c(),  0x8e);
        EXPECT(gbc.d(),  0xf9);
        EXPECT(gbc.e(),  0xc0);
        EXPECT(gbc.h(),  0x30);
        EXPECT(gbc.l(),  0x5);
        EXPECT(gbc.sp(), 0xf605);
        EXPECT(gbc.pc(), 0x961f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x961c), 0xd4);
        EXPECT(gbc.readMem(0x961d), 0xd);
        EXPECT(gbc.readMem(0x961e), 0x1d);
        // D4 02B8
        gbc.setState(0xb6b4, 0x4a33, 0x390, 0x875a, 0xe326, 0x77a2, 0x0, 0x0);
        gbc.writeMem(0xb6b4, { 0xd4, 0xa3, 0x82 });
        gbc.step();
        EXPECT(gbc.a(),  0x3);
        EXPECT(gbc.b(),  0x87);
        EXPECT(gbc.c(),  0x5a);
        EXPECT(gbc.d(),  0xe3);
        EXPECT(gbc.e(),  0x26);
        EXPECT(gbc.h(),  0x77);
        EXPECT(gbc.l(),  0xa2);
        EXPECT(gbc.sp(), 0x4a33);
        EXPECT(gbc.pc(), 0xb6b7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb6b4), 0xd4);
        EXPECT(gbc.readMem(0xb6b5), 0xa3);
        EXPECT(gbc.readMem(0xb6b6), 0x82);
        // D4 02B9
        gbc.setState(0x162f, 0x8497, 0x2890, 0x353b, 0xa3b9, 0xf1c6, 0x0, 0x1);
        gbc.writeMem(0x162f, { 0xd4, 0x1b, 0x4d });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0x35);
        EXPECT(gbc.c(),  0x3b);
        EXPECT(gbc.d(),  0xa3);
        EXPECT(gbc.e(),  0xb9);
        EXPECT(gbc.h(),  0xf1);
        EXPECT(gbc.l(),  0xc6);
        EXPECT(gbc.sp(), 0x8497);
        EXPECT(gbc.pc(), 0x1632);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 02BB
        gbc.setState(0x35a4, 0xe1d9, 0xb590, 0x8f4c, 0x9c90, 0x2263, 0x1, 0x1);
        gbc.writeMem(0x35a4, { 0xd4, 0xbc, 0xe8 });
        gbc.step();
        EXPECT(gbc.a(),  0xb5);
        EXPECT(gbc.b(),  0x8f);
        EXPECT(gbc.c(),  0x4c);
        EXPECT(gbc.d(),  0x9c);
        EXPECT(gbc.e(),  0x90);
        EXPECT(gbc.h(),  0x22);
        EXPECT(gbc.l(),  0x63);
        EXPECT(gbc.sp(), 0xe1d9);
        EXPECT(gbc.pc(), 0x35a7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 02BF
        gbc.setState(0x66e0, 0x8cc3, 0xc830, 0xdbd2, 0x3574, 0xe804, 0x0, 0x0);
        gbc.writeMem(0x66e0, { 0xd4, 0x9d, 0x7c });
        gbc.step();
        EXPECT(gbc.a(),  0xc8);
        EXPECT(gbc.b(),  0xdb);
        EXPECT(gbc.c(),  0xd2);
        EXPECT(gbc.d(),  0x35);
        EXPECT(gbc.e(),  0x74);
        EXPECT(gbc.h(),  0xe8);
        EXPECT(gbc.l(),  0x4);
        EXPECT(gbc.sp(), 0x8cc3);
        EXPECT(gbc.pc(), 0x66e3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 02C0
        gbc.setState(0xb7d7, 0x93c6, 0xde80, 0x5f79, 0xd611, 0x9769, 0x0, 0x1);
        gbc.writeMem(0x93c4, { 0x0, 0x0 });
        gbc.writeMem(0xb7d7, { 0xd4, 0x90, 0xea });
        gbc.step();
        EXPECT(gbc.a(),  0xde);
        EXPECT(gbc.b(),  0x5f);
        EXPECT(gbc.c(),  0x79);
        EXPECT(gbc.d(),  0xd6);
        EXPECT(gbc.e(),  0x11);
        EXPECT(gbc.h(),  0x97);
        EXPECT(gbc.l(),  0x69);
        EXPECT(gbc.sp(), 0x93c4);
        EXPECT(gbc.pc(), 0xea90);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x93c4), 0xda);
        EXPECT(gbc.readMem(0x93c5), 0xb7);
        EXPECT(gbc.readMem(0xb7d7), 0xd4);
        EXPECT(gbc.readMem(0xb7d8), 0x90);
        EXPECT(gbc.readMem(0xb7d9), 0xea);
        // D4 02C2
        gbc.setState(0x154e, 0xd45, 0xe10, 0xcccb, 0xebf6, 0xd2e5, 0x1, 0x0);
        gbc.writeMem(0x154e, { 0xd4, 0xf9, 0x7d });
        gbc.step();
        EXPECT(gbc.a(),  0xe);
        EXPECT(gbc.b(),  0xcc);
        EXPECT(gbc.c(),  0xcb);
        EXPECT(gbc.d(),  0xeb);
        EXPECT(gbc.e(),  0xf6);
        EXPECT(gbc.h(),  0xd2);
        EXPECT(gbc.l(),  0xe5);
        EXPECT(gbc.sp(), 0xd45);
        EXPECT(gbc.pc(), 0x1551);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 02C3
        gbc.setState(0xccc1, 0xd1a8, 0xa1c0, 0xb2b4, 0x81be, 0xca5f, 0x1, 0x0);
        gbc.writeMem(0xccc1, { 0xd4, 0xda, 0xf2 });
        gbc.writeMem(0xd1a6, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xa1);
        EXPECT(gbc.b(),  0xb2);
        EXPECT(gbc.c(),  0xb4);
        EXPECT(gbc.d(),  0x81);
        EXPECT(gbc.e(),  0xbe);
        EXPECT(gbc.h(),  0xca);
        EXPECT(gbc.l(),  0x5f);
        EXPECT(gbc.sp(), 0xd1a6);
        EXPECT(gbc.pc(), 0xf2da);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xccc1), 0xd4);
        EXPECT(gbc.readMem(0xccc2), 0xda);
        EXPECT(gbc.readMem(0xccc3), 0xf2);
        EXPECT(gbc.readMem(0xd1a6), 0xc4);
        EXPECT(gbc.readMem(0xd1a7), 0xcc);
        // D4 02C4
        gbc.setState(0x7d01, 0xb6c7, 0xf50, 0x29b, 0xf1a4, 0x8636, 0x0, 0x1);
        gbc.writeMem(0x7d01, { 0xd4, 0x25, 0xb5 });
        gbc.step();
        EXPECT(gbc.a(),  0xf);
        EXPECT(gbc.b(),  0x2);
        EXPECT(gbc.c(),  0x9b);
        EXPECT(gbc.d(),  0xf1);
        EXPECT(gbc.e(),  0xa4);
        EXPECT(gbc.h(),  0x86);
        EXPECT(gbc.l(),  0x36);
        EXPECT(gbc.sp(), 0xb6c7);
        EXPECT(gbc.pc(), 0x7d04);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 02C5
        gbc.setState(0x2bac, 0xecc6, 0x2fe0, 0xff22, 0x5b68, 0xedbe, 0x0, 0x1);
        gbc.writeMem(0x2bac, { 0xd4, 0x1d, 0x2c });
        gbc.writeMem(0xecc4, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x2f);
        EXPECT(gbc.b(),  0xff);
        EXPECT(gbc.c(),  0x22);
        EXPECT(gbc.d(),  0x5b);
        EXPECT(gbc.e(),  0x68);
        EXPECT(gbc.h(),  0xed);
        EXPECT(gbc.l(),  0xbe);
        EXPECT(gbc.sp(), 0xecc4);
        EXPECT(gbc.pc(), 0x2c1d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xecc4), 0xaf);
        EXPECT(gbc.readMem(0xecc5), 0x2b);
        // D4 02C7
        gbc.setState(0x83d7, 0xc8fb, 0xd740, 0xc674, 0xe203, 0x5f0b, 0x0, 0x1);
        gbc.writeMem(0x83d7, { 0xd4, 0x7e, 0x20 });
        gbc.writeMem(0xc8f9, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xd7);
        EXPECT(gbc.b(),  0xc6);
        EXPECT(gbc.c(),  0x74);
        EXPECT(gbc.d(),  0xe2);
        EXPECT(gbc.e(),  0x3);
        EXPECT(gbc.h(),  0x5f);
        EXPECT(gbc.l(),  0xb);
        EXPECT(gbc.sp(), 0xc8f9);
        EXPECT(gbc.pc(), 0x207e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x83d7), 0xd4);
        EXPECT(gbc.readMem(0x83d8), 0x7e);
        EXPECT(gbc.readMem(0x83d9), 0x20);
        EXPECT(gbc.readMem(0xc8f9), 0xda);
        EXPECT(gbc.readMem(0xc8fa), 0x83);
        // D4 02CA
        gbc.setState(0xc779, 0x11f6, 0xe830, 0x8ef0, 0x8126, 0x3b4, 0x1, 0x0);
        gbc.writeMem(0xc779, { 0xd4, 0x70, 0x13 });
        gbc.step();
        EXPECT(gbc.a(),  0xe8);
        EXPECT(gbc.b(),  0x8e);
        EXPECT(gbc.c(),  0xf0);
        EXPECT(gbc.d(),  0x81);
        EXPECT(gbc.e(),  0x26);
        EXPECT(gbc.h(),  0x3);
        EXPECT(gbc.l(),  0xb4);
        EXPECT(gbc.sp(), 0x11f6);
        EXPECT(gbc.pc(), 0xc77c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc779), 0xd4);
        EXPECT(gbc.readMem(0xc77a), 0x70);
        EXPECT(gbc.readMem(0xc77b), 0x13);
        // D4 02CB
        gbc.setState(0xcd2e, 0xe880, 0x290, 0x48d7, 0xce41, 0xf540, 0x0, 0x1);
        gbc.writeMem(0xcd2e, { 0xd4, 0xef, 0x13 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0x48);
        EXPECT(gbc.c(),  0xd7);
        EXPECT(gbc.d(),  0xce);
        EXPECT(gbc.e(),  0x41);
        EXPECT(gbc.h(),  0xf5);
        EXPECT(gbc.l(),  0x40);
        EXPECT(gbc.sp(), 0xe880);
        EXPECT(gbc.pc(), 0xcd31);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcd2e), 0xd4);
        EXPECT(gbc.readMem(0xcd2f), 0xef);
        EXPECT(gbc.readMem(0xcd30), 0x13);
        // D4 02CC
        gbc.setState(0x2f1f, 0x831f, 0xf30, 0xfd27, 0xbec2, 0x6d24, 0x1, 0x1);
        gbc.writeMem(0x2f1f, { 0xd4, 0x96, 0xcf });
        gbc.step();
        EXPECT(gbc.a(),  0xf);
        EXPECT(gbc.b(),  0xfd);
        EXPECT(gbc.c(),  0x27);
        EXPECT(gbc.d(),  0xbe);
        EXPECT(gbc.e(),  0xc2);
        EXPECT(gbc.h(),  0x6d);
        EXPECT(gbc.l(),  0x24);
        EXPECT(gbc.sp(), 0x831f);
        EXPECT(gbc.pc(), 0x2f22);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 02CD
        gbc.setState(0x1f8b, 0x8443, 0xafa0, 0x8896, 0xaf99, 0x1c36, 0x0, 0x0);
        gbc.writeMem(0x1f8b, { 0xd4, 0x0, 0x3b });
        gbc.writeMem(0x8441, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xaf);
        EXPECT(gbc.b(),  0x88);
        EXPECT(gbc.c(),  0x96);
        EXPECT(gbc.d(),  0xaf);
        EXPECT(gbc.e(),  0x99);
        EXPECT(gbc.h(),  0x1c);
        EXPECT(gbc.l(),  0x36);
        EXPECT(gbc.sp(), 0x8441);
        EXPECT(gbc.pc(), 0x3b00);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8441), 0x8e);
        EXPECT(gbc.readMem(0x8442), 0x1f);
        // D4 02CE
        gbc.setState(0x29e, 0x982f, 0xf780, 0xe1bf, 0xab84, 0xf68d, 0x0, 0x1);
        gbc.writeMem(0x29e, { 0xd4, 0xf9, 0x86 });
        gbc.writeMem(0x982d, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xf7);
        EXPECT(gbc.b(),  0xe1);
        EXPECT(gbc.c(),  0xbf);
        EXPECT(gbc.d(),  0xab);
        EXPECT(gbc.e(),  0x84);
        EXPECT(gbc.h(),  0xf6);
        EXPECT(gbc.l(),  0x8d);
        EXPECT(gbc.sp(), 0x982d);
        EXPECT(gbc.pc(), 0x86f9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x982d), 0xa1);
        EXPECT(gbc.readMem(0x982e), 0x2);
        // D4 02CF
        gbc.setState(0x6da3, 0x422a, 0x8250, 0xe5af, 0x5800, 0x98a8, 0x1, 0x1);
        gbc.writeMem(0x6da3, { 0xd4, 0xff, 0x76 });
        gbc.step();
        EXPECT(gbc.a(),  0x82);
        EXPECT(gbc.b(),  0xe5);
        EXPECT(gbc.c(),  0xaf);
        EXPECT(gbc.d(),  0x58);
        EXPECT(gbc.e(),  0x0);
        EXPECT(gbc.h(),  0x98);
        EXPECT(gbc.l(),  0xa8);
        EXPECT(gbc.sp(), 0x422a);
        EXPECT(gbc.pc(), 0x6da6);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 02D0
        gbc.setState(0x3c83, 0x99d6, 0x9ac0, 0xfbd2, 0xb3f9, 0x3e59, 0x1, 0x1);
        gbc.writeMem(0x3c83, { 0xd4, 0x36, 0xfd });
        gbc.writeMem(0x99d4, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x9a);
        EXPECT(gbc.b(),  0xfb);
        EXPECT(gbc.c(),  0xd2);
        EXPECT(gbc.d(),  0xb3);
        EXPECT(gbc.e(),  0xf9);
        EXPECT(gbc.h(),  0x3e);
        EXPECT(gbc.l(),  0x59);
        EXPECT(gbc.sp(), 0x99d4);
        EXPECT(gbc.pc(), 0xfd36);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x99d4), 0x86);
        EXPECT(gbc.readMem(0x99d5), 0x3c);
        // D4 02D1
        gbc.setState(0xe98, 0xf695, 0xef00, 0x6c8d, 0x59a2, 0x532f, 0x1, 0x1);
        gbc.writeMem(0xe98, { 0xd4, 0x9c, 0x2b });
        gbc.writeMem(0xf693, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xef);
        EXPECT(gbc.b(),  0x6c);
        EXPECT(gbc.c(),  0x8d);
        EXPECT(gbc.d(),  0x59);
        EXPECT(gbc.e(),  0xa2);
        EXPECT(gbc.h(),  0x53);
        EXPECT(gbc.l(),  0x2f);
        EXPECT(gbc.sp(), 0xf693);
        EXPECT(gbc.pc(), 0x2b9c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xf693), 0x9b);
        EXPECT(gbc.readMem(0xf694), 0xe);
        // D4 02D2
        gbc.setState(0x5a46, 0xbde2, 0xedc0, 0x8478, 0x1c08, 0x9308, 0x1, 0x1);
        gbc.writeMem(0x5a46, { 0xd4, 0x6d, 0x1d });
        gbc.writeMem(0xbde0, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xed);
        EXPECT(gbc.b(),  0x84);
        EXPECT(gbc.c(),  0x78);
        EXPECT(gbc.d(),  0x1c);
        EXPECT(gbc.e(),  0x8);
        EXPECT(gbc.h(),  0x93);
        EXPECT(gbc.l(),  0x8);
        EXPECT(gbc.sp(), 0xbde0);
        EXPECT(gbc.pc(), 0x1d6d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbde0), 0x49);
        EXPECT(gbc.readMem(0xbde1), 0x5a);
        // D4 02D3
        gbc.setState(0x125c, 0x2869, 0xeed0, 0x1e96, 0xdce5, 0x9491, 0x0, 0x0);
        gbc.writeMem(0x125c, { 0xd4, 0x0, 0x86 });
        gbc.step();
        EXPECT(gbc.a(),  0xee);
        EXPECT(gbc.b(),  0x1e);
        EXPECT(gbc.c(),  0x96);
        EXPECT(gbc.d(),  0xdc);
        EXPECT(gbc.e(),  0xe5);
        EXPECT(gbc.h(),  0x94);
        EXPECT(gbc.l(),  0x91);
        EXPECT(gbc.sp(), 0x2869);
        EXPECT(gbc.pc(), 0x125f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 02D5
        gbc.setState(0x2d67, 0xf373, 0xb6a0, 0x1437, 0xd40b, 0x94d7, 0x0, 0x0);
        gbc.writeMem(0x2d67, { 0xd4, 0x62, 0x3e });
        gbc.writeMem(0xf371, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xb6);
        EXPECT(gbc.b(),  0x14);
        EXPECT(gbc.c(),  0x37);
        EXPECT(gbc.d(),  0xd4);
        EXPECT(gbc.e(),  0xb);
        EXPECT(gbc.h(),  0x94);
        EXPECT(gbc.l(),  0xd7);
        EXPECT(gbc.sp(), 0xf371);
        EXPECT(gbc.pc(), 0x3e62);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xf371), 0x6a);
        EXPECT(gbc.readMem(0xf372), 0x2d);
        // D4 02D6
        gbc.setState(0xab50, 0x1037, 0x4330, 0x5746, 0x9091, 0xd600, 0x0, 0x1);
        gbc.writeMem(0xab50, { 0xd4, 0x1a, 0x38 });
        gbc.step();
        EXPECT(gbc.a(),  0x43);
        EXPECT(gbc.b(),  0x57);
        EXPECT(gbc.c(),  0x46);
        EXPECT(gbc.d(),  0x90);
        EXPECT(gbc.e(),  0x91);
        EXPECT(gbc.h(),  0xd6);
        EXPECT(gbc.l(),  0x0);
        EXPECT(gbc.sp(), 0x1037);
        EXPECT(gbc.pc(), 0xab53);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xab50), 0xd4);
        EXPECT(gbc.readMem(0xab51), 0x1a);
        EXPECT(gbc.readMem(0xab52), 0x38);
        // D4 02D7
        gbc.setState(0x4834, 0x303a, 0x73b0, 0xffcf, 0x1978, 0x98d, 0x1, 0x1);
        gbc.writeMem(0x4834, { 0xd4, 0x2, 0xf3 });
        gbc.step();
        EXPECT(gbc.a(),  0x73);
        EXPECT(gbc.b(),  0xff);
        EXPECT(gbc.c(),  0xcf);
        EXPECT(gbc.d(),  0x19);
        EXPECT(gbc.e(),  0x78);
        EXPECT(gbc.h(),  0x9);
        EXPECT(gbc.l(),  0x8d);
        EXPECT(gbc.sp(), 0x303a);
        EXPECT(gbc.pc(), 0x4837);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 02D8
        gbc.setState(0x7f55, 0xe4e1, 0x3740, 0x7050, 0xab7b, 0x80d9, 0x1, 0x0);
        gbc.writeMem(0x7f55, { 0xd4, 0x56, 0x4b });
        gbc.writeMem(0xe4df, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x37);
        EXPECT(gbc.b(),  0x70);
        EXPECT(gbc.c(),  0x50);
        EXPECT(gbc.d(),  0xab);
        EXPECT(gbc.e(),  0x7b);
        EXPECT(gbc.h(),  0x80);
        EXPECT(gbc.l(),  0xd9);
        EXPECT(gbc.sp(), 0xe4df);
        EXPECT(gbc.pc(), 0x4b56);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe4df), 0x58);
        EXPECT(gbc.readMem(0xe4e0), 0x7f);
        // D4 02D9
        gbc.setState(0x436f, 0xcde2, 0x9180, 0xf738, 0x6e4d, 0x5129, 0x1, 0x1);
        gbc.writeMem(0x436f, { 0xd4, 0x7b, 0xa });
        gbc.writeMem(0xcde0, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x91);
        EXPECT(gbc.b(),  0xf7);
        EXPECT(gbc.c(),  0x38);
        EXPECT(gbc.d(),  0x6e);
        EXPECT(gbc.e(),  0x4d);
        EXPECT(gbc.h(),  0x51);
        EXPECT(gbc.l(),  0x29);
        EXPECT(gbc.sp(), 0xcde0);
        EXPECT(gbc.pc(), 0xa7b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcde0), 0x72);
        EXPECT(gbc.readMem(0xcde1), 0x43);
        // D4 02DB
        gbc.setState(0x2822, 0xba1f, 0xddf0, 0x1181, 0x2c1d, 0xe5d6, 0x1, 0x1);
        gbc.writeMem(0x2822, { 0xd4, 0xd8, 0x67 });
        gbc.step();
        EXPECT(gbc.a(),  0xdd);
        EXPECT(gbc.b(),  0x11);
        EXPECT(gbc.c(),  0x81);
        EXPECT(gbc.d(),  0x2c);
        EXPECT(gbc.e(),  0x1d);
        EXPECT(gbc.h(),  0xe5);
        EXPECT(gbc.l(),  0xd6);
        EXPECT(gbc.sp(), 0xba1f);
        EXPECT(gbc.pc(), 0x2825);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 02DC
        gbc.setState(0x76af, 0xd9d8, 0xc840, 0x4929, 0xcd8d, 0x3021, 0x1, 0x1);
        gbc.writeMem(0x76af, { 0xd4, 0x45, 0x44 });
        gbc.writeMem(0xd9d6, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xc8);
        EXPECT(gbc.b(),  0x49);
        EXPECT(gbc.c(),  0x29);
        EXPECT(gbc.d(),  0xcd);
        EXPECT(gbc.e(),  0x8d);
        EXPECT(gbc.h(),  0x30);
        EXPECT(gbc.l(),  0x21);
        EXPECT(gbc.sp(), 0xd9d6);
        EXPECT(gbc.pc(), 0x4445);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd9d6), 0xb2);
        EXPECT(gbc.readMem(0xd9d7), 0x76);
        // D4 02DD
        gbc.setState(0x93ec, 0x5859, 0x7070, 0x4c22, 0xabc0, 0x8f95, 0x0, 0x1);
        gbc.writeMem(0x93ec, { 0xd4, 0x69, 0xde });
        gbc.step();
        EXPECT(gbc.a(),  0x70);
        EXPECT(gbc.b(),  0x4c);
        EXPECT(gbc.c(),  0x22);
        EXPECT(gbc.d(),  0xab);
        EXPECT(gbc.e(),  0xc0);
        EXPECT(gbc.h(),  0x8f);
        EXPECT(gbc.l(),  0x95);
        EXPECT(gbc.sp(), 0x5859);
        EXPECT(gbc.pc(), 0x93ef);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x93ec), 0xd4);
        EXPECT(gbc.readMem(0x93ed), 0x69);
        EXPECT(gbc.readMem(0x93ee), 0xde);
        // D4 02DE
        gbc.setState(0x1846, 0xb78f, 0x5370, 0xa5ce, 0x3d4a, 0xf11c, 0x1, 0x0);
        gbc.writeMem(0x1846, { 0xd4, 0x2f, 0x87 });
        gbc.step();
        EXPECT(gbc.a(),  0x53);
        EXPECT(gbc.b(),  0xa5);
        EXPECT(gbc.c(),  0xce);
        EXPECT(gbc.d(),  0x3d);
        EXPECT(gbc.e(),  0x4a);
        EXPECT(gbc.h(),  0xf1);
        EXPECT(gbc.l(),  0x1c);
        EXPECT(gbc.sp(), 0xb78f);
        EXPECT(gbc.pc(), 0x1849);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 02DF
        gbc.setState(0xe993, 0xa168, 0xe3d0, 0xc3fa, 0x98dc, 0xbfec, 0x0, 0x0);
        gbc.writeMem(0xe993, { 0xd4, 0xff, 0x61 });
        gbc.step();
        EXPECT(gbc.a(),  0xe3);
        EXPECT(gbc.b(),  0xc3);
        EXPECT(gbc.c(),  0xfa);
        EXPECT(gbc.d(),  0x98);
        EXPECT(gbc.e(),  0xdc);
        EXPECT(gbc.h(),  0xbf);
        EXPECT(gbc.l(),  0xec);
        EXPECT(gbc.sp(), 0xa168);
        EXPECT(gbc.pc(), 0xe996);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe993), 0xd4);
        EXPECT(gbc.readMem(0xe994), 0xff);
        EXPECT(gbc.readMem(0xe995), 0x61);
        // D4 02E1
        gbc.setState(0x695, 0xaee2, 0xa180, 0x3d06, 0x8960, 0x1cd2, 0x0, 0x0);
        gbc.writeMem(0x695, { 0xd4, 0x68, 0xc8 });
        gbc.writeMem(0xaee0, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xa1);
        EXPECT(gbc.b(),  0x3d);
        EXPECT(gbc.c(),  0x6);
        EXPECT(gbc.d(),  0x89);
        EXPECT(gbc.e(),  0x60);
        EXPECT(gbc.h(),  0x1c);
        EXPECT(gbc.l(),  0xd2);
        EXPECT(gbc.sp(), 0xaee0);
        EXPECT(gbc.pc(), 0xc868);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xaee0), 0x98);
        EXPECT(gbc.readMem(0xaee1), 0x6);
        // D4 02E2
        gbc.setState(0xe472, 0x13ae, 0x68f0, 0x7612, 0x2795, 0x10, 0x0, 0x0);
        gbc.writeMem(0xe472, { 0xd4, 0xaa, 0xa6 });
        gbc.step();
        EXPECT(gbc.a(),  0x68);
        EXPECT(gbc.b(),  0x76);
        EXPECT(gbc.c(),  0x12);
        EXPECT(gbc.d(),  0x27);
        EXPECT(gbc.e(),  0x95);
        EXPECT(gbc.h(),  0x0);
        EXPECT(gbc.l(),  0x10);
        EXPECT(gbc.sp(), 0x13ae);
        EXPECT(gbc.pc(), 0xe475);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe472), 0xd4);
        EXPECT(gbc.readMem(0xe473), 0xaa);
        EXPECT(gbc.readMem(0xe474), 0xa6);
        // D4 02E3
        gbc.setState(0x2f2a, 0xbe6f, 0xfc50, 0xc4d9, 0xf400, 0x8621, 0x1, 0x1);
        gbc.writeMem(0x2f2a, { 0xd4, 0x6f, 0xa6 });
        gbc.step();
        EXPECT(gbc.a(),  0xfc);
        EXPECT(gbc.b(),  0xc4);
        EXPECT(gbc.c(),  0xd9);
        EXPECT(gbc.d(),  0xf4);
        EXPECT(gbc.e(),  0x0);
        EXPECT(gbc.h(),  0x86);
        EXPECT(gbc.l(),  0x21);
        EXPECT(gbc.sp(), 0xbe6f);
        EXPECT(gbc.pc(), 0x2f2d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 02E5
        gbc.setState(0x7ed2, 0xb3e, 0x6bf0, 0x229e, 0x1d97, 0x7bc, 0x1, 0x1);
        gbc.writeMem(0x7ed2, { 0xd4, 0xe7, 0x4a });
        gbc.step();
        EXPECT(gbc.a(),  0x6b);
        EXPECT(gbc.b(),  0x22);
        EXPECT(gbc.c(),  0x9e);
        EXPECT(gbc.d(),  0x1d);
        EXPECT(gbc.e(),  0x97);
        EXPECT(gbc.h(),  0x7);
        EXPECT(gbc.l(),  0xbc);
        EXPECT(gbc.sp(), 0xb3e);
        EXPECT(gbc.pc(), 0x7ed5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 02E7
        gbc.setState(0x964f, 0xe4cb, 0x2030, 0xeee2, 0xd97b, 0x145d, 0x1, 0x0);
        gbc.writeMem(0x964f, { 0xd4, 0xf7, 0x86 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0xee);
        EXPECT(gbc.c(),  0xe2);
        EXPECT(gbc.d(),  0xd9);
        EXPECT(gbc.e(),  0x7b);
        EXPECT(gbc.h(),  0x14);
        EXPECT(gbc.l(),  0x5d);
        EXPECT(gbc.sp(), 0xe4cb);
        EXPECT(gbc.pc(), 0x9652);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x964f), 0xd4);
        EXPECT(gbc.readMem(0x9650), 0xf7);
        EXPECT(gbc.readMem(0x9651), 0x86);
        // D4 02E9
        gbc.setState(0x2ff1, 0xc0bf, 0xc180, 0x59bc, 0xc726, 0x1516, 0x0, 0x1);
        gbc.writeMem(0x2ff1, { 0xd4, 0xef, 0x35 });
        gbc.writeMem(0xc0bd, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xc1);
        EXPECT(gbc.b(),  0x59);
        EXPECT(gbc.c(),  0xbc);
        EXPECT(gbc.d(),  0xc7);
        EXPECT(gbc.e(),  0x26);
        EXPECT(gbc.h(),  0x15);
        EXPECT(gbc.l(),  0x16);
        EXPECT(gbc.sp(), 0xc0bd);
        EXPECT(gbc.pc(), 0x35ef);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc0bd), 0xf4);
        EXPECT(gbc.readMem(0xc0be), 0x2f);
        // D4 02EA
        gbc.setState(0x34cf, 0xe079, 0xba10, 0xb1cb, 0x3274, 0x62bb, 0x1, 0x1);
        gbc.writeMem(0x34cf, { 0xd4, 0x33, 0x43 });
        gbc.step();
        EXPECT(gbc.a(),  0xba);
        EXPECT(gbc.b(),  0xb1);
        EXPECT(gbc.c(),  0xcb);
        EXPECT(gbc.d(),  0x32);
        EXPECT(gbc.e(),  0x74);
        EXPECT(gbc.h(),  0x62);
        EXPECT(gbc.l(),  0xbb);
        EXPECT(gbc.sp(), 0xe079);
        EXPECT(gbc.pc(), 0x34d2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 02EC
        gbc.setState(0x80c2, 0xb098, 0xa450, 0x5680, 0x8e2f, 0xed7e, 0x0, 0x0);
        gbc.writeMem(0x80c2, { 0xd4, 0xeb, 0xa9 });
        gbc.step();
        EXPECT(gbc.a(),  0xa4);
        EXPECT(gbc.b(),  0x56);
        EXPECT(gbc.c(),  0x80);
        EXPECT(gbc.d(),  0x8e);
        EXPECT(gbc.e(),  0x2f);
        EXPECT(gbc.h(),  0xed);
        EXPECT(gbc.l(),  0x7e);
        EXPECT(gbc.sp(), 0xb098);
        EXPECT(gbc.pc(), 0x80c5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x80c2), 0xd4);
        EXPECT(gbc.readMem(0x80c3), 0xeb);
        EXPECT(gbc.readMem(0x80c4), 0xa9);
        // D4 02ED
        gbc.setState(0xe07d, 0x693d, 0x23b0, 0x6439, 0x3671, 0x1fa4, 0x1, 0x1);
        gbc.writeMem(0xe07d, { 0xd4, 0xb2, 0x64 });
        gbc.step();
        EXPECT(gbc.a(),  0x23);
        EXPECT(gbc.b(),  0x64);
        EXPECT(gbc.c(),  0x39);
        EXPECT(gbc.d(),  0x36);
        EXPECT(gbc.e(),  0x71);
        EXPECT(gbc.h(),  0x1f);
        EXPECT(gbc.l(),  0xa4);
        EXPECT(gbc.sp(), 0x693d);
        EXPECT(gbc.pc(), 0xe080);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe07d), 0xd4);
        EXPECT(gbc.readMem(0xe07e), 0xb2);
        EXPECT(gbc.readMem(0xe07f), 0x64);
        // D4 02EE
        gbc.setState(0xd005, 0x80e4, 0x96c0, 0xada9, 0x24e5, 0x4730, 0x0, 0x0);
        gbc.writeMem(0x80e2, { 0x0, 0x0 });
        gbc.writeMem(0xd005, { 0xd4, 0x79, 0x52 });
        gbc.step();
        EXPECT(gbc.a(),  0x96);
        EXPECT(gbc.b(),  0xad);
        EXPECT(gbc.c(),  0xa9);
        EXPECT(gbc.d(),  0x24);
        EXPECT(gbc.e(),  0xe5);
        EXPECT(gbc.h(),  0x47);
        EXPECT(gbc.l(),  0x30);
        EXPECT(gbc.sp(), 0x80e2);
        EXPECT(gbc.pc(), 0x5279);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x80e2), 0x8);
        EXPECT(gbc.readMem(0x80e3), 0xd0);
        EXPECT(gbc.readMem(0xd005), 0xd4);
        EXPECT(gbc.readMem(0xd006), 0x79);
        EXPECT(gbc.readMem(0xd007), 0x52);
        // D4 02EF
        gbc.setState(0x79ad, 0xb08c, 0x40f0, 0xa6ee, 0x5990, 0xe58e, 0x0, 0x1);
        gbc.writeMem(0x79ad, { 0xd4, 0x63, 0x60 });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0xa6);
        EXPECT(gbc.c(),  0xee);
        EXPECT(gbc.d(),  0x59);
        EXPECT(gbc.e(),  0x90);
        EXPECT(gbc.h(),  0xe5);
        EXPECT(gbc.l(),  0x8e);
        EXPECT(gbc.sp(), 0xb08c);
        EXPECT(gbc.pc(), 0x79b0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 02F0
        gbc.setState(0xd3e3, 0x4526, 0xb7b0, 0xcd3a, 0x6421, 0x8c4e, 0x0, 0x0);
        gbc.writeMem(0xd3e3, { 0xd4, 0xe9, 0x3b });
        gbc.step();
        EXPECT(gbc.a(),  0xb7);
        EXPECT(gbc.b(),  0xcd);
        EXPECT(gbc.c(),  0x3a);
        EXPECT(gbc.d(),  0x64);
        EXPECT(gbc.e(),  0x21);
        EXPECT(gbc.h(),  0x8c);
        EXPECT(gbc.l(),  0x4e);
        EXPECT(gbc.sp(), 0x4526);
        EXPECT(gbc.pc(), 0xd3e6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd3e3), 0xd4);
        EXPECT(gbc.readMem(0xd3e4), 0xe9);
        EXPECT(gbc.readMem(0xd3e5), 0x3b);
        // D4 02F1
        gbc.setState(0x1947, 0x7751, 0xdb30, 0x5cc4, 0xc5b1, 0xbbc, 0x0, 0x1);
        gbc.writeMem(0x1947, { 0xd4, 0x89, 0x64 });
        gbc.step();
        EXPECT(gbc.a(),  0xdb);
        EXPECT(gbc.b(),  0x5c);
        EXPECT(gbc.c(),  0xc4);
        EXPECT(gbc.d(),  0xc5);
        EXPECT(gbc.e(),  0xb1);
        EXPECT(gbc.h(),  0xb);
        EXPECT(gbc.l(),  0xbc);
        EXPECT(gbc.sp(), 0x7751);
        EXPECT(gbc.pc(), 0x194a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 02F2
        gbc.setState(0x22c1, 0x6c5, 0x8b50, 0xbc82, 0xad5, 0x3f47, 0x1, 0x0);
        gbc.writeMem(0x22c1, { 0xd4, 0xaa, 0xf0 });
        gbc.step();
        EXPECT(gbc.a(),  0x8b);
        EXPECT(gbc.b(),  0xbc);
        EXPECT(gbc.c(),  0x82);
        EXPECT(gbc.d(),  0xa);
        EXPECT(gbc.e(),  0xd5);
        EXPECT(gbc.h(),  0x3f);
        EXPECT(gbc.l(),  0x47);
        EXPECT(gbc.sp(), 0x6c5);
        EXPECT(gbc.pc(), 0x22c4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 02F3
        gbc.setState(0x9d60, 0x1320, 0x6530, 0x711b, 0x6c88, 0xa856, 0x1, 0x0);
        gbc.writeMem(0x9d60, { 0xd4, 0x55, 0x23 });
        gbc.step();
        EXPECT(gbc.a(),  0x65);
        EXPECT(gbc.b(),  0x71);
        EXPECT(gbc.c(),  0x1b);
        EXPECT(gbc.d(),  0x6c);
        EXPECT(gbc.e(),  0x88);
        EXPECT(gbc.h(),  0xa8);
        EXPECT(gbc.l(),  0x56);
        EXPECT(gbc.sp(), 0x1320);
        EXPECT(gbc.pc(), 0x9d63);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9d60), 0xd4);
        EXPECT(gbc.readMem(0x9d61), 0x55);
        EXPECT(gbc.readMem(0x9d62), 0x23);
        // D4 02F4
        gbc.setState(0xdd4b, 0x2975, 0xdf90, 0xb37, 0x1c03, 0xa228, 0x1, 0x0);
        gbc.writeMem(0xdd4b, { 0xd4, 0x16, 0x4 });
        gbc.step();
        EXPECT(gbc.a(),  0xdf);
        EXPECT(gbc.b(),  0xb);
        EXPECT(gbc.c(),  0x37);
        EXPECT(gbc.d(),  0x1c);
        EXPECT(gbc.e(),  0x3);
        EXPECT(gbc.h(),  0xa2);
        EXPECT(gbc.l(),  0x28);
        EXPECT(gbc.sp(), 0x2975);
        EXPECT(gbc.pc(), 0xdd4e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xdd4b), 0xd4);
        EXPECT(gbc.readMem(0xdd4c), 0x16);
        EXPECT(gbc.readMem(0xdd4d), 0x4);
        // D4 02F5
        gbc.setState(0xca7b, 0xcc43, 0xb4a0, 0x652a, 0xcd2, 0x44f2, 0x1, 0x1);
        gbc.writeMem(0xca7b, { 0xd4, 0xca, 0x88 });
        gbc.writeMem(0xcc41, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xb4);
        EXPECT(gbc.b(),  0x65);
        EXPECT(gbc.c(),  0x2a);
        EXPECT(gbc.d(),  0xc);
        EXPECT(gbc.e(),  0xd2);
        EXPECT(gbc.h(),  0x44);
        EXPECT(gbc.l(),  0xf2);
        EXPECT(gbc.sp(), 0xcc41);
        EXPECT(gbc.pc(), 0x88ca);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xca7b), 0xd4);
        EXPECT(gbc.readMem(0xca7c), 0xca);
        EXPECT(gbc.readMem(0xca7d), 0x88);
        EXPECT(gbc.readMem(0xcc41), 0x7e);
        EXPECT(gbc.readMem(0xcc42), 0xca);
        // D4 02F6
        gbc.setState(0x560e, 0xfa57, 0x8a90, 0xaaeb, 0x82f5, 0x3349, 0x1, 0x0);
        gbc.writeMem(0x560e, { 0xd4, 0x52, 0xca });
        gbc.step();
        EXPECT(gbc.a(),  0x8a);
        EXPECT(gbc.b(),  0xaa);
        EXPECT(gbc.c(),  0xeb);
        EXPECT(gbc.d(),  0x82);
        EXPECT(gbc.e(),  0xf5);
        EXPECT(gbc.h(),  0x33);
        EXPECT(gbc.l(),  0x49);
        EXPECT(gbc.sp(), 0xfa57);
        EXPECT(gbc.pc(), 0x5611);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 02F7
        gbc.setState(0x6cb3, 0xfb9, 0x1730, 0x334f, 0x7aa1, 0x2def, 0x1, 0x0);
        gbc.writeMem(0x6cb3, { 0xd4, 0xe4, 0x32 });
        gbc.step();
        EXPECT(gbc.a(),  0x17);
        EXPECT(gbc.b(),  0x33);
        EXPECT(gbc.c(),  0x4f);
        EXPECT(gbc.d(),  0x7a);
        EXPECT(gbc.e(),  0xa1);
        EXPECT(gbc.h(),  0x2d);
        EXPECT(gbc.l(),  0xef);
        EXPECT(gbc.sp(), 0xfb9);
        EXPECT(gbc.pc(), 0x6cb6);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 02FA
        gbc.setState(0xa48b, 0xa9b8, 0x9e80, 0x151a, 0x287f, 0xd050, 0x0, 0x0);
        gbc.writeMem(0xa48b, { 0xd4, 0x45, 0xa7 });
        gbc.writeMem(0xa9b6, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x9e);
        EXPECT(gbc.b(),  0x15);
        EXPECT(gbc.c(),  0x1a);
        EXPECT(gbc.d(),  0x28);
        EXPECT(gbc.e(),  0x7f);
        EXPECT(gbc.h(),  0xd0);
        EXPECT(gbc.l(),  0x50);
        EXPECT(gbc.sp(), 0xa9b6);
        EXPECT(gbc.pc(), 0xa745);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa48b), 0xd4);
        EXPECT(gbc.readMem(0xa48c), 0x45);
        EXPECT(gbc.readMem(0xa48d), 0xa7);
        EXPECT(gbc.readMem(0xa9b6), 0x8e);
        EXPECT(gbc.readMem(0xa9b7), 0xa4);
        // D4 02FB
        gbc.setState(0xd892, 0xd45b, 0xc6b0, 0x47c6, 0xfe13, 0xfe99, 0x0, 0x1);
        gbc.writeMem(0xd892, { 0xd4, 0x5e, 0xa4 });
        gbc.step();
        EXPECT(gbc.a(),  0xc6);
        EXPECT(gbc.b(),  0x47);
        EXPECT(gbc.c(),  0xc6);
        EXPECT(gbc.d(),  0xfe);
        EXPECT(gbc.e(),  0x13);
        EXPECT(gbc.h(),  0xfe);
        EXPECT(gbc.l(),  0x99);
        EXPECT(gbc.sp(), 0xd45b);
        EXPECT(gbc.pc(), 0xd895);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd892), 0xd4);
        EXPECT(gbc.readMem(0xd893), 0x5e);
        EXPECT(gbc.readMem(0xd894), 0xa4);
        // D4 02FC
        gbc.setState(0x28f9, 0x5309, 0x42b0, 0x3d76, 0x4196, 0xe15e, 0x1, 0x1);
        gbc.writeMem(0x28f9, { 0xd4, 0x18, 0x6b });
        gbc.step();
        EXPECT(gbc.a(),  0x42);
        EXPECT(gbc.b(),  0x3d);
        EXPECT(gbc.c(),  0x76);
        EXPECT(gbc.d(),  0x41);
        EXPECT(gbc.e(),  0x96);
        EXPECT(gbc.h(),  0xe1);
        EXPECT(gbc.l(),  0x5e);
        EXPECT(gbc.sp(), 0x5309);
        EXPECT(gbc.pc(), 0x28fc);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 02FD
        gbc.setState(0x9909, 0x60f1, 0x9170, 0xc93f, 0x517f, 0xd951, 0x1, 0x0);
        gbc.writeMem(0x9909, { 0xd4, 0x4f, 0xac });
        gbc.step();
        EXPECT(gbc.a(),  0x91);
        EXPECT(gbc.b(),  0xc9);
        EXPECT(gbc.c(),  0x3f);
        EXPECT(gbc.d(),  0x51);
        EXPECT(gbc.e(),  0x7f);
        EXPECT(gbc.h(),  0xd9);
        EXPECT(gbc.l(),  0x51);
        EXPECT(gbc.sp(), 0x60f1);
        EXPECT(gbc.pc(), 0x990c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9909), 0xd4);
        EXPECT(gbc.readMem(0x990a), 0x4f);
        EXPECT(gbc.readMem(0x990b), 0xac);
        // D4 02FE
        gbc.setState(0x9d23, 0xc78e, 0x2b70, 0x9373, 0xb1e7, 0xd0cf, 0x1, 0x1);
        gbc.writeMem(0x9d23, { 0xd4, 0x50, 0x6b });
        gbc.step();
        EXPECT(gbc.a(),  0x2b);
        EXPECT(gbc.b(),  0x93);
        EXPECT(gbc.c(),  0x73);
        EXPECT(gbc.d(),  0xb1);
        EXPECT(gbc.e(),  0xe7);
        EXPECT(gbc.h(),  0xd0);
        EXPECT(gbc.l(),  0xcf);
        EXPECT(gbc.sp(), 0xc78e);
        EXPECT(gbc.pc(), 0x9d26);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9d23), 0xd4);
        EXPECT(gbc.readMem(0x9d24), 0x50);
        EXPECT(gbc.readMem(0x9d25), 0x6b);
        // D4 02FF
        gbc.setState(0x98c7, 0x9ad, 0x3d70, 0x23aa, 0x5511, 0x7f06, 0x1, 0x0);
        gbc.writeMem(0x98c7, { 0xd4, 0xf2, 0x80 });
        gbc.step();
        EXPECT(gbc.a(),  0x3d);
        EXPECT(gbc.b(),  0x23);
        EXPECT(gbc.c(),  0xaa);
        EXPECT(gbc.d(),  0x55);
        EXPECT(gbc.e(),  0x11);
        EXPECT(gbc.h(),  0x7f);
        EXPECT(gbc.l(),  0x6);
        EXPECT(gbc.sp(), 0x9ad);
        EXPECT(gbc.pc(), 0x98ca);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x98c7), 0xd4);
        EXPECT(gbc.readMem(0x98c8), 0xf2);
        EXPECT(gbc.readMem(0x98c9), 0x80);
        // D4 0300
        gbc.setState(0x272a, 0xa919, 0x17e0, 0x5643, 0xf282, 0x95c9, 0x1, 0x1);
        gbc.writeMem(0x272a, { 0xd4, 0x11, 0xdd });
        gbc.writeMem(0xa917, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x17);
        EXPECT(gbc.b(),  0x56);
        EXPECT(gbc.c(),  0x43);
        EXPECT(gbc.d(),  0xf2);
        EXPECT(gbc.e(),  0x82);
        EXPECT(gbc.h(),  0x95);
        EXPECT(gbc.l(),  0xc9);
        EXPECT(gbc.sp(), 0xa917);
        EXPECT(gbc.pc(), 0xdd11);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa917), 0x2d);
        EXPECT(gbc.readMem(0xa918), 0x27);
        // D4 0301
        gbc.setState(0x2a31, 0xff26, 0x9730, 0xa4a, 0x3b8a, 0xf2dc, 0x1, 0x1);
        gbc.writeMem(0x2a31, { 0xd4, 0xdc, 0x94 });
        gbc.step();
        EXPECT(gbc.a(),  0x97);
        EXPECT(gbc.b(),  0xa);
        EXPECT(gbc.c(),  0x4a);
        EXPECT(gbc.d(),  0x3b);
        EXPECT(gbc.e(),  0x8a);
        EXPECT(gbc.h(),  0xf2);
        EXPECT(gbc.l(),  0xdc);
        EXPECT(gbc.sp(), 0xff26);
        EXPECT(gbc.pc(), 0x2a34);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0302
        gbc.setState(0x3ad6, 0xe04b, 0x7d70, 0xc658, 0xbf32, 0x4f00, 0x0, 0x0);
        gbc.writeMem(0x3ad6, { 0xd4, 0xdc, 0x55 });
        gbc.step();
        EXPECT(gbc.a(),  0x7d);
        EXPECT(gbc.b(),  0xc6);
        EXPECT(gbc.c(),  0x58);
        EXPECT(gbc.d(),  0xbf);
        EXPECT(gbc.e(),  0x32);
        EXPECT(gbc.h(),  0x4f);
        EXPECT(gbc.l(),  0x0);
        EXPECT(gbc.sp(), 0xe04b);
        EXPECT(gbc.pc(), 0x3ad9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0303
        gbc.setState(0x3ad5, 0xc556, 0xb830, 0x464d, 0x8bf1, 0x3325, 0x0, 0x1);
        gbc.writeMem(0x3ad5, { 0xd4, 0x67, 0xdc });
        gbc.step();
        EXPECT(gbc.a(),  0xb8);
        EXPECT(gbc.b(),  0x46);
        EXPECT(gbc.c(),  0x4d);
        EXPECT(gbc.d(),  0x8b);
        EXPECT(gbc.e(),  0xf1);
        EXPECT(gbc.h(),  0x33);
        EXPECT(gbc.l(),  0x25);
        EXPECT(gbc.sp(), 0xc556);
        EXPECT(gbc.pc(), 0x3ad8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0304
        gbc.setState(0xaab6, 0xb303, 0x7ce0, 0xa426, 0x2def, 0xb0af, 0x0, 0x1);
        gbc.writeMem(0xaab6, { 0xd4, 0x50, 0x52 });
        gbc.writeMem(0xb301, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x7c);
        EXPECT(gbc.b(),  0xa4);
        EXPECT(gbc.c(),  0x26);
        EXPECT(gbc.d(),  0x2d);
        EXPECT(gbc.e(),  0xef);
        EXPECT(gbc.h(),  0xb0);
        EXPECT(gbc.l(),  0xaf);
        EXPECT(gbc.sp(), 0xb301);
        EXPECT(gbc.pc(), 0x5250);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xaab6), 0xd4);
        EXPECT(gbc.readMem(0xaab7), 0x50);
        EXPECT(gbc.readMem(0xaab8), 0x52);
        EXPECT(gbc.readMem(0xb301), 0xb9);
        EXPECT(gbc.readMem(0xb302), 0xaa);
        // D4 0305
        gbc.setState(0x3fcc, 0xfbdb, 0xabd0, 0xcb44, 0x4b3f, 0x5738, 0x1, 0x0);
        gbc.writeMem(0x3fcc, { 0xd4, 0x39, 0xf3 });
        gbc.step();
        EXPECT(gbc.a(),  0xab);
        EXPECT(gbc.b(),  0xcb);
        EXPECT(gbc.c(),  0x44);
        EXPECT(gbc.d(),  0x4b);
        EXPECT(gbc.e(),  0x3f);
        EXPECT(gbc.h(),  0x57);
        EXPECT(gbc.l(),  0x38);
        EXPECT(gbc.sp(), 0xfbdb);
        EXPECT(gbc.pc(), 0x3fcf);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0307
        gbc.setState(0xae8f, 0x8034, 0xc580, 0x6ce6, 0x68f8, 0xc39a, 0x0, 0x0);
        gbc.writeMem(0x8032, { 0x0, 0x0 });
        gbc.writeMem(0xae8f, { 0xd4, 0x11, 0x18 });
        gbc.step();
        EXPECT(gbc.a(),  0xc5);
        EXPECT(gbc.b(),  0x6c);
        EXPECT(gbc.c(),  0xe6);
        EXPECT(gbc.d(),  0x68);
        EXPECT(gbc.e(),  0xf8);
        EXPECT(gbc.h(),  0xc3);
        EXPECT(gbc.l(),  0x9a);
        EXPECT(gbc.sp(), 0x8032);
        EXPECT(gbc.pc(), 0x1811);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8032), 0x92);
        EXPECT(gbc.readMem(0x8033), 0xae);
        EXPECT(gbc.readMem(0xae8f), 0xd4);
        EXPECT(gbc.readMem(0xae90), 0x11);
        EXPECT(gbc.readMem(0xae91), 0x18);
        // D4 0308
        gbc.setState(0xc6fa, 0x9123, 0x26c0, 0xd10d, 0x4cd1, 0x8ba2, 0x0, 0x1);
        gbc.writeMem(0x9121, { 0x0, 0x0 });
        gbc.writeMem(0xc6fa, { 0xd4, 0xa9, 0xd });
        gbc.step();
        EXPECT(gbc.a(),  0x26);
        EXPECT(gbc.b(),  0xd1);
        EXPECT(gbc.c(),  0xd);
        EXPECT(gbc.d(),  0x4c);
        EXPECT(gbc.e(),  0xd1);
        EXPECT(gbc.h(),  0x8b);
        EXPECT(gbc.l(),  0xa2);
        EXPECT(gbc.sp(), 0x9121);
        EXPECT(gbc.pc(), 0xda9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9121), 0xfd);
        EXPECT(gbc.readMem(0x9122), 0xc6);
        EXPECT(gbc.readMem(0xc6fa), 0xd4);
        EXPECT(gbc.readMem(0xc6fb), 0xa9);
        EXPECT(gbc.readMem(0xc6fc), 0xd);
        // D4 030A
        gbc.setState(0x429a, 0x376b, 0xbe70, 0x51c2, 0xba13, 0xeef5, 0x1, 0x1);
        gbc.writeMem(0x429a, { 0xd4, 0xa7, 0xc5 });
        gbc.step();
        EXPECT(gbc.a(),  0xbe);
        EXPECT(gbc.b(),  0x51);
        EXPECT(gbc.c(),  0xc2);
        EXPECT(gbc.d(),  0xba);
        EXPECT(gbc.e(),  0x13);
        EXPECT(gbc.h(),  0xee);
        EXPECT(gbc.l(),  0xf5);
        EXPECT(gbc.sp(), 0x376b);
        EXPECT(gbc.pc(), 0x429d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 030B
        gbc.setState(0x8181, 0xb5c4, 0xa300, 0x2cf4, 0xcb50, 0x8409, 0x1, 0x1);
        gbc.writeMem(0x8181, { 0xd4, 0x6e, 0xeb });
        gbc.writeMem(0xb5c2, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xa3);
        EXPECT(gbc.b(),  0x2c);
        EXPECT(gbc.c(),  0xf4);
        EXPECT(gbc.d(),  0xcb);
        EXPECT(gbc.e(),  0x50);
        EXPECT(gbc.h(),  0x84);
        EXPECT(gbc.l(),  0x9);
        EXPECT(gbc.sp(), 0xb5c2);
        EXPECT(gbc.pc(), 0xeb6e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8181), 0xd4);
        EXPECT(gbc.readMem(0x8182), 0x6e);
        EXPECT(gbc.readMem(0x8183), 0xeb);
        EXPECT(gbc.readMem(0xb5c2), 0x84);
        EXPECT(gbc.readMem(0xb5c3), 0x81);
        // D4 030C
        gbc.setState(0x3f60, 0xe2ad, 0x6350, 0xf1db, 0x46c5, 0xcf44, 0x1, 0x0);
        gbc.writeMem(0x3f60, { 0xd4, 0xe9, 0xfc });
        gbc.step();
        EXPECT(gbc.a(),  0x63);
        EXPECT(gbc.b(),  0xf1);
        EXPECT(gbc.c(),  0xdb);
        EXPECT(gbc.d(),  0x46);
        EXPECT(gbc.e(),  0xc5);
        EXPECT(gbc.h(),  0xcf);
        EXPECT(gbc.l(),  0x44);
        EXPECT(gbc.sp(), 0xe2ad);
        EXPECT(gbc.pc(), 0x3f63);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 030D
        gbc.setState(0x1745, 0xa5fd, 0x4320, 0xe8f8, 0x7b59, 0x4be6, 0x1, 0x1);
        gbc.writeMem(0x1745, { 0xd4, 0xf6, 0xed });
        gbc.writeMem(0xa5fb, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x43);
        EXPECT(gbc.b(),  0xe8);
        EXPECT(gbc.c(),  0xf8);
        EXPECT(gbc.d(),  0x7b);
        EXPECT(gbc.e(),  0x59);
        EXPECT(gbc.h(),  0x4b);
        EXPECT(gbc.l(),  0xe6);
        EXPECT(gbc.sp(), 0xa5fb);
        EXPECT(gbc.pc(), 0xedf6);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa5fb), 0x48);
        EXPECT(gbc.readMem(0xa5fc), 0x17);
        // D4 030E
        gbc.setState(0xba2, 0xa92b, 0xbf0, 0x5b8b, 0x2ef3, 0xc876, 0x1, 0x0);
        gbc.writeMem(0xba2, { 0xd4, 0x6a, 0x4f });
        gbc.step();
        EXPECT(gbc.a(),  0xb);
        EXPECT(gbc.b(),  0x5b);
        EXPECT(gbc.c(),  0x8b);
        EXPECT(gbc.d(),  0x2e);
        EXPECT(gbc.e(),  0xf3);
        EXPECT(gbc.h(),  0xc8);
        EXPECT(gbc.l(),  0x76);
        EXPECT(gbc.sp(), 0xa92b);
        EXPECT(gbc.pc(), 0xba5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 030F
        gbc.setState(0x3ca9, 0xf1be, 0x4f40, 0x9be6, 0x90b0, 0x2837, 0x0, 0x0);
        gbc.writeMem(0x3ca9, { 0xd4, 0x13, 0xe3 });
        gbc.writeMem(0xf1bc, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x4f);
        EXPECT(gbc.b(),  0x9b);
        EXPECT(gbc.c(),  0xe6);
        EXPECT(gbc.d(),  0x90);
        EXPECT(gbc.e(),  0xb0);
        EXPECT(gbc.h(),  0x28);
        EXPECT(gbc.l(),  0x37);
        EXPECT(gbc.sp(), 0xf1bc);
        EXPECT(gbc.pc(), 0xe313);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xf1bc), 0xac);
        EXPECT(gbc.readMem(0xf1bd), 0x3c);
        // D4 0310
        gbc.setState(0x2f41, 0x49e3, 0x6e90, 0x357d, 0xff3f, 0x44f7, 0x0, 0x1);
        gbc.writeMem(0x2f41, { 0xd4, 0x49, 0xb5 });
        gbc.step();
        EXPECT(gbc.a(),  0x6e);
        EXPECT(gbc.b(),  0x35);
        EXPECT(gbc.c(),  0x7d);
        EXPECT(gbc.d(),  0xff);
        EXPECT(gbc.e(),  0x3f);
        EXPECT(gbc.h(),  0x44);
        EXPECT(gbc.l(),  0xf7);
        EXPECT(gbc.sp(), 0x49e3);
        EXPECT(gbc.pc(), 0x2f44);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0311
        gbc.setState(0x6261, 0xa16a, 0xea10, 0x5b82, 0x4eec, 0x50e8, 0x0, 0x0);
        gbc.writeMem(0x6261, { 0xd4, 0x26, 0x19 });
        gbc.step();
        EXPECT(gbc.a(),  0xea);
        EXPECT(gbc.b(),  0x5b);
        EXPECT(gbc.c(),  0x82);
        EXPECT(gbc.d(),  0x4e);
        EXPECT(gbc.e(),  0xec);
        EXPECT(gbc.h(),  0x50);
        EXPECT(gbc.l(),  0xe8);
        EXPECT(gbc.sp(), 0xa16a);
        EXPECT(gbc.pc(), 0x6264);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0312
        gbc.setState(0x6080, 0xf44, 0x1e10, 0x49e3, 0x56db, 0x8a53, 0x1, 0x1);
        gbc.writeMem(0x6080, { 0xd4, 0xb0, 0x6c });
        gbc.step();
        EXPECT(gbc.a(),  0x1e);
        EXPECT(gbc.b(),  0x49);
        EXPECT(gbc.c(),  0xe3);
        EXPECT(gbc.d(),  0x56);
        EXPECT(gbc.e(),  0xdb);
        EXPECT(gbc.h(),  0x8a);
        EXPECT(gbc.l(),  0x53);
        EXPECT(gbc.sp(), 0xf44);
        EXPECT(gbc.pc(), 0x6083);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0313
        gbc.setState(0x7098, 0xa08e, 0xedd0, 0xf0cd, 0x3712, 0x768b, 0x1, 0x1);
        gbc.writeMem(0x7098, { 0xd4, 0x7f, 0xc9 });
        gbc.step();
        EXPECT(gbc.a(),  0xed);
        EXPECT(gbc.b(),  0xf0);
        EXPECT(gbc.c(),  0xcd);
        EXPECT(gbc.d(),  0x37);
        EXPECT(gbc.e(),  0x12);
        EXPECT(gbc.h(),  0x76);
        EXPECT(gbc.l(),  0x8b);
        EXPECT(gbc.sp(), 0xa08e);
        EXPECT(gbc.pc(), 0x709b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0314
        gbc.setState(0xe65f, 0xaf75, 0x1c70, 0x1c5b, 0xd0cb, 0x68b1, 0x1, 0x1);
        gbc.writeMem(0xe65f, { 0xd4, 0xc2, 0xaf });
        gbc.step();
        EXPECT(gbc.a(),  0x1c);
        EXPECT(gbc.b(),  0x1c);
        EXPECT(gbc.c(),  0x5b);
        EXPECT(gbc.d(),  0xd0);
        EXPECT(gbc.e(),  0xcb);
        EXPECT(gbc.h(),  0x68);
        EXPECT(gbc.l(),  0xb1);
        EXPECT(gbc.sp(), 0xaf75);
        EXPECT(gbc.pc(), 0xe662);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe65f), 0xd4);
        EXPECT(gbc.readMem(0xe660), 0xc2);
        EXPECT(gbc.readMem(0xe661), 0xaf);
        // D4 0316
        gbc.setState(0x4cca, 0x1cbf, 0xa610, 0x452b, 0xb61e, 0x3a64, 0x1, 0x0);
        gbc.writeMem(0x4cca, { 0xd4, 0x3b, 0xb2 });
        gbc.step();
        EXPECT(gbc.a(),  0xa6);
        EXPECT(gbc.b(),  0x45);
        EXPECT(gbc.c(),  0x2b);
        EXPECT(gbc.d(),  0xb6);
        EXPECT(gbc.e(),  0x1e);
        EXPECT(gbc.h(),  0x3a);
        EXPECT(gbc.l(),  0x64);
        EXPECT(gbc.sp(), 0x1cbf);
        EXPECT(gbc.pc(), 0x4ccd);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0317
        gbc.setState(0xabbc, 0xabf0, 0x7630, 0x5e23, 0x324a, 0x961, 0x0, 0x0);
        gbc.writeMem(0xabbc, { 0xd4, 0x4e, 0xcf });
        gbc.step();
        EXPECT(gbc.a(),  0x76);
        EXPECT(gbc.b(),  0x5e);
        EXPECT(gbc.c(),  0x23);
        EXPECT(gbc.d(),  0x32);
        EXPECT(gbc.e(),  0x4a);
        EXPECT(gbc.h(),  0x9);
        EXPECT(gbc.l(),  0x61);
        EXPECT(gbc.sp(), 0xabf0);
        EXPECT(gbc.pc(), 0xabbf);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xabbc), 0xd4);
        EXPECT(gbc.readMem(0xabbd), 0x4e);
        EXPECT(gbc.readMem(0xabbe), 0xcf);
        // D4 031A
        gbc.setState(0x3d39, 0x1fb4, 0x2230, 0x28b3, 0xc9eb, 0x5b2, 0x0, 0x1);
        gbc.writeMem(0x3d39, { 0xd4, 0x7e, 0x8d });
        gbc.step();
        EXPECT(gbc.a(),  0x22);
        EXPECT(gbc.b(),  0x28);
        EXPECT(gbc.c(),  0xb3);
        EXPECT(gbc.d(),  0xc9);
        EXPECT(gbc.e(),  0xeb);
        EXPECT(gbc.h(),  0x5);
        EXPECT(gbc.l(),  0xb2);
        EXPECT(gbc.sp(), 0x1fb4);
        EXPECT(gbc.pc(), 0x3d3c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 031B
        gbc.setState(0x673d, 0x6551, 0x2b0, 0xffba, 0xa544, 0xc4d6, 0x0, 0x0);
        gbc.writeMem(0x673d, { 0xd4, 0x66, 0x55 });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0xff);
        EXPECT(gbc.c(),  0xba);
        EXPECT(gbc.d(),  0xa5);
        EXPECT(gbc.e(),  0x44);
        EXPECT(gbc.h(),  0xc4);
        EXPECT(gbc.l(),  0xd6);
        EXPECT(gbc.sp(), 0x6551);
        EXPECT(gbc.pc(), 0x6740);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 031C
        gbc.setState(0x41f4, 0x5834, 0x5710, 0x7e8a, 0x68aa, 0x8f4d, 0x0, 0x0);
        gbc.writeMem(0x41f4, { 0xd4, 0x41, 0x9 });
        gbc.step();
        EXPECT(gbc.a(),  0x57);
        EXPECT(gbc.b(),  0x7e);
        EXPECT(gbc.c(),  0x8a);
        EXPECT(gbc.d(),  0x68);
        EXPECT(gbc.e(),  0xaa);
        EXPECT(gbc.h(),  0x8f);
        EXPECT(gbc.l(),  0x4d);
        EXPECT(gbc.sp(), 0x5834);
        EXPECT(gbc.pc(), 0x41f7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 031E
        gbc.setState(0x35d4, 0xc04e, 0x90c0, 0xa62, 0x2cf2, 0x473, 0x0, 0x0);
        gbc.writeMem(0x35d4, { 0xd4, 0x8c, 0x20 });
        gbc.writeMem(0xc04c, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x90);
        EXPECT(gbc.b(),  0xa);
        EXPECT(gbc.c(),  0x62);
        EXPECT(gbc.d(),  0x2c);
        EXPECT(gbc.e(),  0xf2);
        EXPECT(gbc.h(),  0x4);
        EXPECT(gbc.l(),  0x73);
        EXPECT(gbc.sp(), 0xc04c);
        EXPECT(gbc.pc(), 0x208c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc04c), 0xd7);
        EXPECT(gbc.readMem(0xc04d), 0x35);
        // D4 031F
        gbc.setState(0xb9ed, 0xc05c, 0x1780, 0x1a8e, 0x650c, 0xc46b, 0x1, 0x0);
        gbc.writeMem(0xb9ed, { 0xd4, 0xbf, 0x23 });
        gbc.writeMem(0xc05a, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x17);
        EXPECT(gbc.b(),  0x1a);
        EXPECT(gbc.c(),  0x8e);
        EXPECT(gbc.d(),  0x65);
        EXPECT(gbc.e(),  0xc);
        EXPECT(gbc.h(),  0xc4);
        EXPECT(gbc.l(),  0x6b);
        EXPECT(gbc.sp(), 0xc05a);
        EXPECT(gbc.pc(), 0x23bf);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb9ed), 0xd4);
        EXPECT(gbc.readMem(0xb9ee), 0xbf);
        EXPECT(gbc.readMem(0xb9ef), 0x23);
        EXPECT(gbc.readMem(0xc05a), 0xf0);
        EXPECT(gbc.readMem(0xc05b), 0xb9);
        // D4 0321
        gbc.setState(0x8412, 0xd059, 0x550, 0x295f, 0x3217, 0x638c, 0x1, 0x0);
        gbc.writeMem(0x8412, { 0xd4, 0xb7, 0x43 });
        gbc.step();
        EXPECT(gbc.a(),  0x5);
        EXPECT(gbc.b(),  0x29);
        EXPECT(gbc.c(),  0x5f);
        EXPECT(gbc.d(),  0x32);
        EXPECT(gbc.e(),  0x17);
        EXPECT(gbc.h(),  0x63);
        EXPECT(gbc.l(),  0x8c);
        EXPECT(gbc.sp(), 0xd059);
        EXPECT(gbc.pc(), 0x8415);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8412), 0xd4);
        EXPECT(gbc.readMem(0x8413), 0xb7);
        EXPECT(gbc.readMem(0x8414), 0x43);
        // D4 0325
        gbc.setState(0x14ff, 0x253f, 0x8870, 0x470b, 0x76d6, 0xa31e, 0x0, 0x0);
        gbc.writeMem(0x14ff, { 0xd4, 0x71, 0x8 });
        gbc.step();
        EXPECT(gbc.a(),  0x88);
        EXPECT(gbc.b(),  0x47);
        EXPECT(gbc.c(),  0xb);
        EXPECT(gbc.d(),  0x76);
        EXPECT(gbc.e(),  0xd6);
        EXPECT(gbc.h(),  0xa3);
        EXPECT(gbc.l(),  0x1e);
        EXPECT(gbc.sp(), 0x253f);
        EXPECT(gbc.pc(), 0x1502);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0326
        gbc.setState(0xba83, 0x1ccc, 0xbbb0, 0x84be, 0x83a4, 0xa951, 0x0, 0x0);
        gbc.writeMem(0xba83, { 0xd4, 0x9d, 0x76 });
        gbc.step();
        EXPECT(gbc.a(),  0xbb);
        EXPECT(gbc.b(),  0x84);
        EXPECT(gbc.c(),  0xbe);
        EXPECT(gbc.d(),  0x83);
        EXPECT(gbc.e(),  0xa4);
        EXPECT(gbc.h(),  0xa9);
        EXPECT(gbc.l(),  0x51);
        EXPECT(gbc.sp(), 0x1ccc);
        EXPECT(gbc.pc(), 0xba86);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xba83), 0xd4);
        EXPECT(gbc.readMem(0xba84), 0x9d);
        EXPECT(gbc.readMem(0xba85), 0x76);
        // D4 0327
        gbc.setState(0xc732, 0xe80f, 0x4a90, 0x1765, 0xec54, 0x6d20, 0x1, 0x1);
        gbc.writeMem(0xc732, { 0xd4, 0x35, 0x7a });
        gbc.step();
        EXPECT(gbc.a(),  0x4a);
        EXPECT(gbc.b(),  0x17);
        EXPECT(gbc.c(),  0x65);
        EXPECT(gbc.d(),  0xec);
        EXPECT(gbc.e(),  0x54);
        EXPECT(gbc.h(),  0x6d);
        EXPECT(gbc.l(),  0x20);
        EXPECT(gbc.sp(), 0xe80f);
        EXPECT(gbc.pc(), 0xc735);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc732), 0xd4);
        EXPECT(gbc.readMem(0xc733), 0x35);
        EXPECT(gbc.readMem(0xc734), 0x7a);
        // D4 0328
        gbc.setState(0x6ae8, 0x8a15, 0x1790, 0xcd9a, 0xfa90, 0xa41d, 0x1, 0x0);
        gbc.writeMem(0x6ae8, { 0xd4, 0x7f, 0x64 });
        gbc.step();
        EXPECT(gbc.a(),  0x17);
        EXPECT(gbc.b(),  0xcd);
        EXPECT(gbc.c(),  0x9a);
        EXPECT(gbc.d(),  0xfa);
        EXPECT(gbc.e(),  0x90);
        EXPECT(gbc.h(),  0xa4);
        EXPECT(gbc.l(),  0x1d);
        EXPECT(gbc.sp(), 0x8a15);
        EXPECT(gbc.pc(), 0x6aeb);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0329
        gbc.setState(0x8800, 0x3bfa, 0x2750, 0x2049, 0x52cb, 0x8098, 0x1, 0x1);
        gbc.writeMem(0x8800, { 0xd4, 0xbe, 0x28 });
        gbc.step();
        EXPECT(gbc.a(),  0x27);
        EXPECT(gbc.b(),  0x20);
        EXPECT(gbc.c(),  0x49);
        EXPECT(gbc.d(),  0x52);
        EXPECT(gbc.e(),  0xcb);
        EXPECT(gbc.h(),  0x80);
        EXPECT(gbc.l(),  0x98);
        EXPECT(gbc.sp(), 0x3bfa);
        EXPECT(gbc.pc(), 0x8803);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8800), 0xd4);
        EXPECT(gbc.readMem(0x8801), 0xbe);
        EXPECT(gbc.readMem(0x8802), 0x28);
        // D4 032A
        gbc.setState(0xdd, 0xd571, 0x8c30, 0x7bf7, 0x5a08, 0x77a5, 0x1, 0x0);
        gbc.writeMem(0xdd, { 0xd4, 0xe0, 0xa });
        gbc.step();
        EXPECT(gbc.a(),  0x8c);
        EXPECT(gbc.b(),  0x7b);
        EXPECT(gbc.c(),  0xf7);
        EXPECT(gbc.d(),  0x5a);
        EXPECT(gbc.e(),  0x8);
        EXPECT(gbc.h(),  0x77);
        EXPECT(gbc.l(),  0xa5);
        EXPECT(gbc.sp(), 0xd571);
        EXPECT(gbc.pc(), 0xe0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 032B
        gbc.setState(0xe020, 0x4f9a, 0xfd50, 0x1fac, 0x6794, 0xa0ea, 0x0, 0x1);
        gbc.writeMem(0xe020, { 0xd4, 0xff, 0xbd });
        gbc.step();
        EXPECT(gbc.a(),  0xfd);
        EXPECT(gbc.b(),  0x1f);
        EXPECT(gbc.c(),  0xac);
        EXPECT(gbc.d(),  0x67);
        EXPECT(gbc.e(),  0x94);
        EXPECT(gbc.h(),  0xa0);
        EXPECT(gbc.l(),  0xea);
        EXPECT(gbc.sp(), 0x4f9a);
        EXPECT(gbc.pc(), 0xe023);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe020), 0xd4);
        EXPECT(gbc.readMem(0xe021), 0xff);
        EXPECT(gbc.readMem(0xe022), 0xbd);
        // D4 032C
        gbc.setState(0xe8f7, 0xff7f, 0x40c0, 0xc6b8, 0x9767, 0x4164, 0x0, 0x1);
        gbc.writeMem(0xe8f7, { 0xd4, 0x0, 0x4b });
        gbc.writeMem(0xff7d, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0xc6);
        EXPECT(gbc.c(),  0xb8);
        EXPECT(gbc.d(),  0x97);
        EXPECT(gbc.e(),  0x67);
        EXPECT(gbc.h(),  0x41);
        EXPECT(gbc.l(),  0x64);
        EXPECT(gbc.sp(), 0xff7d);
        EXPECT(gbc.pc(), 0x4b00);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe8f7), 0xd4);
        EXPECT(gbc.readMem(0xe8f8), 0x0);
        EXPECT(gbc.readMem(0xe8f9), 0x4b);
        EXPECT(gbc.readMem(0xff7d), 0xfa);
        EXPECT(gbc.readMem(0xff7e), 0xe8);
        // D4 032E
        gbc.setState(0x928a, 0xd80b, 0x2870, 0x3ba5, 0x19da, 0xed1b, 0x0, 0x1);
        gbc.writeMem(0x928a, { 0xd4, 0xeb, 0x58 });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0x3b);
        EXPECT(gbc.c(),  0xa5);
        EXPECT(gbc.d(),  0x19);
        EXPECT(gbc.e(),  0xda);
        EXPECT(gbc.h(),  0xed);
        EXPECT(gbc.l(),  0x1b);
        EXPECT(gbc.sp(), 0xd80b);
        EXPECT(gbc.pc(), 0x928d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x928a), 0xd4);
        EXPECT(gbc.readMem(0x928b), 0xeb);
        EXPECT(gbc.readMem(0x928c), 0x58);
        // D4 0330
        gbc.setState(0xb955, 0xe547, 0xf2a0, 0xbd77, 0x79cd, 0xa659, 0x1, 0x0);
        gbc.writeMem(0xb955, { 0xd4, 0xe5, 0x96 });
        gbc.writeMem(0xe545, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xf2);
        EXPECT(gbc.b(),  0xbd);
        EXPECT(gbc.c(),  0x77);
        EXPECT(gbc.d(),  0x79);
        EXPECT(gbc.e(),  0xcd);
        EXPECT(gbc.h(),  0xa6);
        EXPECT(gbc.l(),  0x59);
        EXPECT(gbc.sp(), 0xe545);
        EXPECT(gbc.pc(), 0x96e5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb955), 0xd4);
        EXPECT(gbc.readMem(0xb956), 0xe5);
        EXPECT(gbc.readMem(0xb957), 0x96);
        EXPECT(gbc.readMem(0xe545), 0x58);
        EXPECT(gbc.readMem(0xe546), 0xb9);
        // D4 0333
        gbc.setState(0xbc2d, 0x7b41, 0x2670, 0xe75a, 0x792e, 0x10ea, 0x0, 0x1);
        gbc.writeMem(0xbc2d, { 0xd4, 0xe0, 0x83 });
        gbc.step();
        EXPECT(gbc.a(),  0x26);
        EXPECT(gbc.b(),  0xe7);
        EXPECT(gbc.c(),  0x5a);
        EXPECT(gbc.d(),  0x79);
        EXPECT(gbc.e(),  0x2e);
        EXPECT(gbc.h(),  0x10);
        EXPECT(gbc.l(),  0xea);
        EXPECT(gbc.sp(), 0x7b41);
        EXPECT(gbc.pc(), 0xbc30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbc2d), 0xd4);
        EXPECT(gbc.readMem(0xbc2e), 0xe0);
        EXPECT(gbc.readMem(0xbc2f), 0x83);
        // D4 0334
        gbc.setState(0xd3fb, 0xe964, 0xc440, 0xe173, 0xbba3, 0x930a, 0x0, 0x0);
        gbc.writeMem(0xd3fb, { 0xd4, 0xa6, 0x50 });
        gbc.writeMem(0xe962, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xc4);
        EXPECT(gbc.b(),  0xe1);
        EXPECT(gbc.c(),  0x73);
        EXPECT(gbc.d(),  0xbb);
        EXPECT(gbc.e(),  0xa3);
        EXPECT(gbc.h(),  0x93);
        EXPECT(gbc.l(),  0xa);
        EXPECT(gbc.sp(), 0xe962);
        EXPECT(gbc.pc(), 0x50a6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd3fb), 0xd4);
        EXPECT(gbc.readMem(0xd3fc), 0xa6);
        EXPECT(gbc.readMem(0xd3fd), 0x50);
        EXPECT(gbc.readMem(0xe962), 0xfe);
        EXPECT(gbc.readMem(0xe963), 0xd3);
        // D4 0335
        gbc.setState(0x6e01, 0xad1a, 0xd30, 0x94eb, 0xc9bf, 0xbb32, 0x0, 0x1);
        gbc.writeMem(0x6e01, { 0xd4, 0x43, 0xfc });
        gbc.step();
        EXPECT(gbc.a(),  0xd);
        EXPECT(gbc.b(),  0x94);
        EXPECT(gbc.c(),  0xeb);
        EXPECT(gbc.d(),  0xc9);
        EXPECT(gbc.e(),  0xbf);
        EXPECT(gbc.h(),  0xbb);
        EXPECT(gbc.l(),  0x32);
        EXPECT(gbc.sp(), 0xad1a);
        EXPECT(gbc.pc(), 0x6e04);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0336
        gbc.setState(0xb6d, 0x8ad0, 0x24e0, 0x1b94, 0x821d, 0xee84, 0x0, 0x1);
        gbc.writeMem(0xb6d, { 0xd4, 0x4f, 0x27 });
        gbc.writeMem(0x8ace, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x24);
        EXPECT(gbc.b(),  0x1b);
        EXPECT(gbc.c(),  0x94);
        EXPECT(gbc.d(),  0x82);
        EXPECT(gbc.e(),  0x1d);
        EXPECT(gbc.h(),  0xee);
        EXPECT(gbc.l(),  0x84);
        EXPECT(gbc.sp(), 0x8ace);
        EXPECT(gbc.pc(), 0x274f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8ace), 0x70);
        EXPECT(gbc.readMem(0x8acf), 0xb);
        // D4 0338
        gbc.setState(0xcb6c, 0x80f6, 0xea40, 0x86b, 0xd3be, 0x8a49, 0x0, 0x0);
        gbc.writeMem(0x80f4, { 0x0, 0x0 });
        gbc.writeMem(0xcb6c, { 0xd4, 0x6f, 0xa9 });
        gbc.step();
        EXPECT(gbc.a(),  0xea);
        EXPECT(gbc.b(),  0x8);
        EXPECT(gbc.c(),  0x6b);
        EXPECT(gbc.d(),  0xd3);
        EXPECT(gbc.e(),  0xbe);
        EXPECT(gbc.h(),  0x8a);
        EXPECT(gbc.l(),  0x49);
        EXPECT(gbc.sp(), 0x80f4);
        EXPECT(gbc.pc(), 0xa96f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x80f4), 0x6f);
        EXPECT(gbc.readMem(0x80f5), 0xcb);
        EXPECT(gbc.readMem(0xcb6c), 0xd4);
        EXPECT(gbc.readMem(0xcb6d), 0x6f);
        EXPECT(gbc.readMem(0xcb6e), 0xa9);
        // D4 0339
        gbc.setState(0x851a, 0xb9a8, 0xff20, 0xf92c, 0xd860, 0x3270, 0x1, 0x1);
        gbc.writeMem(0x851a, { 0xd4, 0x56, 0x9c });
        gbc.writeMem(0xb9a6, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xff);
        EXPECT(gbc.b(),  0xf9);
        EXPECT(gbc.c(),  0x2c);
        EXPECT(gbc.d(),  0xd8);
        EXPECT(gbc.e(),  0x60);
        EXPECT(gbc.h(),  0x32);
        EXPECT(gbc.l(),  0x70);
        EXPECT(gbc.sp(), 0xb9a6);
        EXPECT(gbc.pc(), 0x9c56);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x851a), 0xd4);
        EXPECT(gbc.readMem(0x851b), 0x56);
        EXPECT(gbc.readMem(0x851c), 0x9c);
        EXPECT(gbc.readMem(0xb9a6), 0x1d);
        EXPECT(gbc.readMem(0xb9a7), 0x85);
        // D4 033A
        gbc.setState(0xedc, 0xfe16, 0x51e0, 0xb446, 0x442, 0x19b2, 0x1, 0x0);
        gbc.writeMem(0xedc, { 0xd4, 0x4f, 0xd1 });
        gbc.writeMem(0xfe14, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x51);
        EXPECT(gbc.b(),  0xb4);
        EXPECT(gbc.c(),  0x46);
        EXPECT(gbc.d(),  0x4);
        EXPECT(gbc.e(),  0x42);
        EXPECT(gbc.h(),  0x19);
        EXPECT(gbc.l(),  0xb2);
        EXPECT(gbc.sp(), 0xfe14);
        EXPECT(gbc.pc(), 0xd14f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xfe14), 0xdf);
        EXPECT(gbc.readMem(0xfe15), 0xe);
        // D4 033B
        gbc.setState(0x8218, 0xeed7, 0xbc90, 0xf3a1, 0xf439, 0x95bd, 0x0, 0x0);
        gbc.writeMem(0x8218, { 0xd4, 0x27, 0x7a });
        gbc.step();
        EXPECT(gbc.a(),  0xbc);
        EXPECT(gbc.b(),  0xf3);
        EXPECT(gbc.c(),  0xa1);
        EXPECT(gbc.d(),  0xf4);
        EXPECT(gbc.e(),  0x39);
        EXPECT(gbc.h(),  0x95);
        EXPECT(gbc.l(),  0xbd);
        EXPECT(gbc.sp(), 0xeed7);
        EXPECT(gbc.pc(), 0x821b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8218), 0xd4);
        EXPECT(gbc.readMem(0x8219), 0x27);
        EXPECT(gbc.readMem(0x821a), 0x7a);
        // D4 033C
        gbc.setState(0x1cfb, 0x31a5, 0xb190, 0x5758, 0x40d4, 0x1f4e, 0x0, 0x1);
        gbc.writeMem(0x1cfb, { 0xd4, 0x7e, 0x33 });
        gbc.step();
        EXPECT(gbc.a(),  0xb1);
        EXPECT(gbc.b(),  0x57);
        EXPECT(gbc.c(),  0x58);
        EXPECT(gbc.d(),  0x40);
        EXPECT(gbc.e(),  0xd4);
        EXPECT(gbc.h(),  0x1f);
        EXPECT(gbc.l(),  0x4e);
        EXPECT(gbc.sp(), 0x31a5);
        EXPECT(gbc.pc(), 0x1cfe);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 033E
        gbc.setState(0x9012, 0x2658, 0x2970, 0xc734, 0x4a28, 0x7430, 0x0, 0x0);
        gbc.writeMem(0x9012, { 0xd4, 0x1f, 0x26 });
        gbc.step();
        EXPECT(gbc.a(),  0x29);
        EXPECT(gbc.b(),  0xc7);
        EXPECT(gbc.c(),  0x34);
        EXPECT(gbc.d(),  0x4a);
        EXPECT(gbc.e(),  0x28);
        EXPECT(gbc.h(),  0x74);
        EXPECT(gbc.l(),  0x30);
        EXPECT(gbc.sp(), 0x2658);
        EXPECT(gbc.pc(), 0x9015);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9012), 0xd4);
        EXPECT(gbc.readMem(0x9013), 0x1f);
        EXPECT(gbc.readMem(0x9014), 0x26);
        // D4 0340
        gbc.setState(0x4bd8, 0x434f, 0x4190, 0xf59f, 0x394b, 0x55e9, 0x0, 0x1);
        gbc.writeMem(0x4bd8, { 0xd4, 0xf0, 0xb7 });
        gbc.step();
        EXPECT(gbc.a(),  0x41);
        EXPECT(gbc.b(),  0xf5);
        EXPECT(gbc.c(),  0x9f);
        EXPECT(gbc.d(),  0x39);
        EXPECT(gbc.e(),  0x4b);
        EXPECT(gbc.h(),  0x55);
        EXPECT(gbc.l(),  0xe9);
        EXPECT(gbc.sp(), 0x434f);
        EXPECT(gbc.pc(), 0x4bdb);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0341
        gbc.setState(0x449a, 0xa414, 0x72e0, 0x805e, 0x2d3b, 0x9c1a, 0x1, 0x1);
        gbc.writeMem(0x449a, { 0xd4, 0xe4, 0xe4 });
        gbc.writeMem(0xa412, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x72);
        EXPECT(gbc.b(),  0x80);
        EXPECT(gbc.c(),  0x5e);
        EXPECT(gbc.d(),  0x2d);
        EXPECT(gbc.e(),  0x3b);
        EXPECT(gbc.h(),  0x9c);
        EXPECT(gbc.l(),  0x1a);
        EXPECT(gbc.sp(), 0xa412);
        EXPECT(gbc.pc(), 0xe4e4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa412), 0x9d);
        EXPECT(gbc.readMem(0xa413), 0x44);
        // D4 0343
        gbc.setState(0x9093, 0xd7e4, 0x9350, 0x617f, 0x6264, 0x9820, 0x1, 0x0);
        gbc.writeMem(0x9093, { 0xd4, 0xe0, 0x5c });
        gbc.step();
        EXPECT(gbc.a(),  0x93);
        EXPECT(gbc.b(),  0x61);
        EXPECT(gbc.c(),  0x7f);
        EXPECT(gbc.d(),  0x62);
        EXPECT(gbc.e(),  0x64);
        EXPECT(gbc.h(),  0x98);
        EXPECT(gbc.l(),  0x20);
        EXPECT(gbc.sp(), 0xd7e4);
        EXPECT(gbc.pc(), 0x9096);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9093), 0xd4);
        EXPECT(gbc.readMem(0x9094), 0xe0);
        EXPECT(gbc.readMem(0x9095), 0x5c);
        // D4 0345
        gbc.setState(0x7e7e, 0xb49e, 0xd90, 0x539b, 0xdb7e, 0x2093, 0x0, 0x0);
        gbc.writeMem(0x7e7e, { 0xd4, 0x26, 0x57 });
        gbc.step();
        EXPECT(gbc.a(),  0xd);
        EXPECT(gbc.b(),  0x53);
        EXPECT(gbc.c(),  0x9b);
        EXPECT(gbc.d(),  0xdb);
        EXPECT(gbc.e(),  0x7e);
        EXPECT(gbc.h(),  0x20);
        EXPECT(gbc.l(),  0x93);
        EXPECT(gbc.sp(), 0xb49e);
        EXPECT(gbc.pc(), 0x7e81);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0346
        gbc.setState(0x9c89, 0xcff, 0x1810, 0x759d, 0x2f4e, 0x1624, 0x0, 0x1);
        gbc.writeMem(0x9c89, { 0xd4, 0x7e, 0x74 });
        gbc.step();
        EXPECT(gbc.a(),  0x18);
        EXPECT(gbc.b(),  0x75);
        EXPECT(gbc.c(),  0x9d);
        EXPECT(gbc.d(),  0x2f);
        EXPECT(gbc.e(),  0x4e);
        EXPECT(gbc.h(),  0x16);
        EXPECT(gbc.l(),  0x24);
        EXPECT(gbc.sp(), 0xcff);
        EXPECT(gbc.pc(), 0x9c8c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9c89), 0xd4);
        EXPECT(gbc.readMem(0x9c8a), 0x7e);
        EXPECT(gbc.readMem(0x9c8b), 0x74);
        // D4 0347
        gbc.setState(0xb0b4, 0x9e6b, 0x7740, 0xfb70, 0x6d02, 0x60c9, 0x0, 0x0);
        gbc.writeMem(0x9e69, { 0x0, 0x0 });
        gbc.writeMem(0xb0b4, { 0xd4, 0x21, 0x7d });
        gbc.step();
        EXPECT(gbc.a(),  0x77);
        EXPECT(gbc.b(),  0xfb);
        EXPECT(gbc.c(),  0x70);
        EXPECT(gbc.d(),  0x6d);
        EXPECT(gbc.e(),  0x2);
        EXPECT(gbc.h(),  0x60);
        EXPECT(gbc.l(),  0xc9);
        EXPECT(gbc.sp(), 0x9e69);
        EXPECT(gbc.pc(), 0x7d21);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9e69), 0xb7);
        EXPECT(gbc.readMem(0x9e6a), 0xb0);
        EXPECT(gbc.readMem(0xb0b4), 0xd4);
        EXPECT(gbc.readMem(0xb0b5), 0x21);
        EXPECT(gbc.readMem(0xb0b6), 0x7d);
        // D4 0348
        gbc.setState(0x5fcd, 0xbfdf, 0xdfc0, 0x468a, 0x6dd2, 0x58c9, 0x0, 0x0);
        gbc.writeMem(0x5fcd, { 0xd4, 0x87, 0x8d });
        gbc.writeMem(0xbfdd, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xdf);
        EXPECT(gbc.b(),  0x46);
        EXPECT(gbc.c(),  0x8a);
        EXPECT(gbc.d(),  0x6d);
        EXPECT(gbc.e(),  0xd2);
        EXPECT(gbc.h(),  0x58);
        EXPECT(gbc.l(),  0xc9);
        EXPECT(gbc.sp(), 0xbfdd);
        EXPECT(gbc.pc(), 0x8d87);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbfdd), 0xd0);
        EXPECT(gbc.readMem(0xbfde), 0x5f);
        // D4 034A
        gbc.setState(0x852a, 0xc0e7, 0x9d00, 0x1eb5, 0x64ad, 0xf5e1, 0x1, 0x1);
        gbc.writeMem(0x852a, { 0xd4, 0x2a, 0xab });
        gbc.writeMem(0xc0e5, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x9d);
        EXPECT(gbc.b(),  0x1e);
        EXPECT(gbc.c(),  0xb5);
        EXPECT(gbc.d(),  0x64);
        EXPECT(gbc.e(),  0xad);
        EXPECT(gbc.h(),  0xf5);
        EXPECT(gbc.l(),  0xe1);
        EXPECT(gbc.sp(), 0xc0e5);
        EXPECT(gbc.pc(), 0xab2a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x852a), 0xd4);
        EXPECT(gbc.readMem(0x852b), 0x2a);
        EXPECT(gbc.readMem(0x852c), 0xab);
        EXPECT(gbc.readMem(0xc0e5), 0x2d);
        EXPECT(gbc.readMem(0xc0e6), 0x85);
        // D4 034B
        gbc.setState(0xa616, 0xe032, 0x66c0, 0xfda3, 0x611c, 0x69e4, 0x1, 0x1);
        gbc.writeMem(0xa616, { 0xd4, 0xc8, 0xfb });
        gbc.writeMem(0xe030, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x66);
        EXPECT(gbc.b(),  0xfd);
        EXPECT(gbc.c(),  0xa3);
        EXPECT(gbc.d(),  0x61);
        EXPECT(gbc.e(),  0x1c);
        EXPECT(gbc.h(),  0x69);
        EXPECT(gbc.l(),  0xe4);
        EXPECT(gbc.sp(), 0xe030);
        EXPECT(gbc.pc(), 0xfbc8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa616), 0xd4);
        EXPECT(gbc.readMem(0xa617), 0xc8);
        EXPECT(gbc.readMem(0xa618), 0xfb);
        EXPECT(gbc.readMem(0xe030), 0x19);
        EXPECT(gbc.readMem(0xe031), 0xa6);
        // D4 034D
        gbc.setState(0x11e8, 0x81c8, 0xc060, 0x6a50, 0x7471, 0x67a9, 0x1, 0x0);
        gbc.writeMem(0x11e8, { 0xd4, 0xc6, 0xc8 });
        gbc.writeMem(0x81c6, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xc0);
        EXPECT(gbc.b(),  0x6a);
        EXPECT(gbc.c(),  0x50);
        EXPECT(gbc.d(),  0x74);
        EXPECT(gbc.e(),  0x71);
        EXPECT(gbc.h(),  0x67);
        EXPECT(gbc.l(),  0xa9);
        EXPECT(gbc.sp(), 0x81c6);
        EXPECT(gbc.pc(), 0xc8c6);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x81c6), 0xeb);
        EXPECT(gbc.readMem(0x81c7), 0x11);
        // D4 034F
        gbc.setState(0x6248, 0xc29f, 0xc9d0, 0xbf56, 0x1b32, 0x8f18, 0x1, 0x1);
        gbc.writeMem(0x6248, { 0xd4, 0x41, 0xcb });
        gbc.step();
        EXPECT(gbc.a(),  0xc9);
        EXPECT(gbc.b(),  0xbf);
        EXPECT(gbc.c(),  0x56);
        EXPECT(gbc.d(),  0x1b);
        EXPECT(gbc.e(),  0x32);
        EXPECT(gbc.h(),  0x8f);
        EXPECT(gbc.l(),  0x18);
        EXPECT(gbc.sp(), 0xc29f);
        EXPECT(gbc.pc(), 0x624b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0350
        gbc.setState(0xc65f, 0xb626, 0xc630, 0xaff0, 0x7dfc, 0x5f1b, 0x1, 0x1);
        gbc.writeMem(0xc65f, { 0xd4, 0x1c, 0x12 });
        gbc.step();
        EXPECT(gbc.a(),  0xc6);
        EXPECT(gbc.b(),  0xaf);
        EXPECT(gbc.c(),  0xf0);
        EXPECT(gbc.d(),  0x7d);
        EXPECT(gbc.e(),  0xfc);
        EXPECT(gbc.h(),  0x5f);
        EXPECT(gbc.l(),  0x1b);
        EXPECT(gbc.sp(), 0xb626);
        EXPECT(gbc.pc(), 0xc662);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc65f), 0xd4);
        EXPECT(gbc.readMem(0xc660), 0x1c);
        EXPECT(gbc.readMem(0xc661), 0x12);
        // D4 0351
        gbc.setState(0x3da3, 0x8e42, 0x7b60, 0x557d, 0xef41, 0xeb8d, 0x0, 0x0);
        gbc.writeMem(0x3da3, { 0xd4, 0xe0, 0x5a });
        gbc.writeMem(0x8e40, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x7b);
        EXPECT(gbc.b(),  0x55);
        EXPECT(gbc.c(),  0x7d);
        EXPECT(gbc.d(),  0xef);
        EXPECT(gbc.e(),  0x41);
        EXPECT(gbc.h(),  0xeb);
        EXPECT(gbc.l(),  0x8d);
        EXPECT(gbc.sp(), 0x8e40);
        EXPECT(gbc.pc(), 0x5ae0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8e40), 0xa6);
        EXPECT(gbc.readMem(0x8e41), 0x3d);
        // D4 0353
        gbc.setState(0x341a, 0x8b30, 0xde20, 0x93cd, 0xbac3, 0xbff6, 0x1, 0x0);
        gbc.writeMem(0x341a, { 0xd4, 0xac, 0x6c });
        gbc.writeMem(0x8b2e, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xde);
        EXPECT(gbc.b(),  0x93);
        EXPECT(gbc.c(),  0xcd);
        EXPECT(gbc.d(),  0xba);
        EXPECT(gbc.e(),  0xc3);
        EXPECT(gbc.h(),  0xbf);
        EXPECT(gbc.l(),  0xf6);
        EXPECT(gbc.sp(), 0x8b2e);
        EXPECT(gbc.pc(), 0x6cac);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8b2e), 0x1d);
        EXPECT(gbc.readMem(0x8b2f), 0x34);
        // D4 0354
        gbc.setState(0x34f9, 0xb925, 0xfdf0, 0x924b, 0x4089, 0xccb4, 0x1, 0x1);
        gbc.writeMem(0x34f9, { 0xd4, 0x79, 0xeb });
        gbc.step();
        EXPECT(gbc.a(),  0xfd);
        EXPECT(gbc.b(),  0x92);
        EXPECT(gbc.c(),  0x4b);
        EXPECT(gbc.d(),  0x40);
        EXPECT(gbc.e(),  0x89);
        EXPECT(gbc.h(),  0xcc);
        EXPECT(gbc.l(),  0xb4);
        EXPECT(gbc.sp(), 0xb925);
        EXPECT(gbc.pc(), 0x34fc);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0356
        gbc.setState(0xd776, 0xda41, 0x6cd0, 0xe2cc, 0xb8eb, 0x6a32, 0x1, 0x0);
        gbc.writeMem(0xd776, { 0xd4, 0x59, 0x69 });
        gbc.step();
        EXPECT(gbc.a(),  0x6c);
        EXPECT(gbc.b(),  0xe2);
        EXPECT(gbc.c(),  0xcc);
        EXPECT(gbc.d(),  0xb8);
        EXPECT(gbc.e(),  0xeb);
        EXPECT(gbc.h(),  0x6a);
        EXPECT(gbc.l(),  0x32);
        EXPECT(gbc.sp(), 0xda41);
        EXPECT(gbc.pc(), 0xd779);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd776), 0xd4);
        EXPECT(gbc.readMem(0xd777), 0x59);
        EXPECT(gbc.readMem(0xd778), 0x69);
        // D4 0359
        gbc.setState(0xa22, 0x3fcf, 0xb650, 0x9ef3, 0xd8ab, 0xaf1c, 0x1, 0x0);
        gbc.writeMem(0xa22, { 0xd4, 0x4f, 0xae });
        gbc.step();
        EXPECT(gbc.a(),  0xb6);
        EXPECT(gbc.b(),  0x9e);
        EXPECT(gbc.c(),  0xf3);
        EXPECT(gbc.d(),  0xd8);
        EXPECT(gbc.e(),  0xab);
        EXPECT(gbc.h(),  0xaf);
        EXPECT(gbc.l(),  0x1c);
        EXPECT(gbc.sp(), 0x3fcf);
        EXPECT(gbc.pc(), 0xa25);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 035A
        gbc.setState(0xe10c, 0x72db, 0x8a30, 0x107d, 0x2325, 0x480f, 0x1, 0x1);
        gbc.writeMem(0xe10c, { 0xd4, 0xbf, 0x91 });
        gbc.step();
        EXPECT(gbc.a(),  0x8a);
        EXPECT(gbc.b(),  0x10);
        EXPECT(gbc.c(),  0x7d);
        EXPECT(gbc.d(),  0x23);
        EXPECT(gbc.e(),  0x25);
        EXPECT(gbc.h(),  0x48);
        EXPECT(gbc.l(),  0xf);
        EXPECT(gbc.sp(), 0x72db);
        EXPECT(gbc.pc(), 0xe10f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe10c), 0xd4);
        EXPECT(gbc.readMem(0xe10d), 0xbf);
        EXPECT(gbc.readMem(0xe10e), 0x91);
        // D4 035B
        gbc.setState(0xaa20, 0xecc7, 0x9d30, 0x1b51, 0xbfed, 0xcfd5, 0x1, 0x0);
        gbc.writeMem(0xaa20, { 0xd4, 0xba, 0xa8 });
        gbc.step();
        EXPECT(gbc.a(),  0x9d);
        EXPECT(gbc.b(),  0x1b);
        EXPECT(gbc.c(),  0x51);
        EXPECT(gbc.d(),  0xbf);
        EXPECT(gbc.e(),  0xed);
        EXPECT(gbc.h(),  0xcf);
        EXPECT(gbc.l(),  0xd5);
        EXPECT(gbc.sp(), 0xecc7);
        EXPECT(gbc.pc(), 0xaa23);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xaa20), 0xd4);
        EXPECT(gbc.readMem(0xaa21), 0xba);
        EXPECT(gbc.readMem(0xaa22), 0xa8);
        // D4 035C
        gbc.setState(0xc12e, 0xa506, 0x9400, 0xc1e2, 0x1d69, 0x537, 0x0, 0x0);
        gbc.writeMem(0xa504, { 0x0, 0x0 });
        gbc.writeMem(0xc12e, { 0xd4, 0x52, 0x90 });
        gbc.step();
        EXPECT(gbc.a(),  0x94);
        EXPECT(gbc.b(),  0xc1);
        EXPECT(gbc.c(),  0xe2);
        EXPECT(gbc.d(),  0x1d);
        EXPECT(gbc.e(),  0x69);
        EXPECT(gbc.h(),  0x5);
        EXPECT(gbc.l(),  0x37);
        EXPECT(gbc.sp(), 0xa504);
        EXPECT(gbc.pc(), 0x9052);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa504), 0x31);
        EXPECT(gbc.readMem(0xa505), 0xc1);
        EXPECT(gbc.readMem(0xc12e), 0xd4);
        EXPECT(gbc.readMem(0xc12f), 0x52);
        EXPECT(gbc.readMem(0xc130), 0x90);
        // D4 035D
        gbc.setState(0xee3c, 0xb0e4, 0xeb20, 0x198, 0x4031, 0xdfcd, 0x1, 0x0);
        gbc.writeMem(0xb0e2, { 0x0, 0x0 });
        gbc.writeMem(0xee3c, { 0xd4, 0x41, 0x69 });
        gbc.step();
        EXPECT(gbc.a(),  0xeb);
        EXPECT(gbc.b(),  0x1);
        EXPECT(gbc.c(),  0x98);
        EXPECT(gbc.d(),  0x40);
        EXPECT(gbc.e(),  0x31);
        EXPECT(gbc.h(),  0xdf);
        EXPECT(gbc.l(),  0xcd);
        EXPECT(gbc.sp(), 0xb0e2);
        EXPECT(gbc.pc(), 0x6941);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb0e2), 0x3f);
        EXPECT(gbc.readMem(0xb0e3), 0xee);
        EXPECT(gbc.readMem(0xee3c), 0xd4);
        EXPECT(gbc.readMem(0xee3d), 0x41);
        EXPECT(gbc.readMem(0xee3e), 0x69);
        // D4 035F
        gbc.setState(0xb3c4, 0xa758, 0x30a0, 0xfa4a, 0x6430, 0xf89b, 0x0, 0x0);
        gbc.writeMem(0xa756, { 0x0, 0x0 });
        gbc.writeMem(0xb3c4, { 0xd4, 0xcd, 0x2b });
        gbc.step();
        EXPECT(gbc.a(),  0x30);
        EXPECT(gbc.b(),  0xfa);
        EXPECT(gbc.c(),  0x4a);
        EXPECT(gbc.d(),  0x64);
        EXPECT(gbc.e(),  0x30);
        EXPECT(gbc.h(),  0xf8);
        EXPECT(gbc.l(),  0x9b);
        EXPECT(gbc.sp(), 0xa756);
        EXPECT(gbc.pc(), 0x2bcd);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa756), 0xc7);
        EXPECT(gbc.readMem(0xa757), 0xb3);
        EXPECT(gbc.readMem(0xb3c4), 0xd4);
        EXPECT(gbc.readMem(0xb3c5), 0xcd);
        EXPECT(gbc.readMem(0xb3c6), 0x2b);
        // D4 0360
        gbc.setState(0xcf40, 0xa03d, 0xb370, 0x43a4, 0xc848, 0x82b2, 0x1, 0x0);
        gbc.writeMem(0xcf40, { 0xd4, 0x85, 0x6f });
        gbc.step();
        EXPECT(gbc.a(),  0xb3);
        EXPECT(gbc.b(),  0x43);
        EXPECT(gbc.c(),  0xa4);
        EXPECT(gbc.d(),  0xc8);
        EXPECT(gbc.e(),  0x48);
        EXPECT(gbc.h(),  0x82);
        EXPECT(gbc.l(),  0xb2);
        EXPECT(gbc.sp(), 0xa03d);
        EXPECT(gbc.pc(), 0xcf43);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcf40), 0xd4);
        EXPECT(gbc.readMem(0xcf41), 0x85);
        EXPECT(gbc.readMem(0xcf42), 0x6f);
        // D4 0362
        gbc.setState(0x6f60, 0xf8dc, 0xee30, 0xeb45, 0x4, 0xb0af, 0x0, 0x0);
        gbc.writeMem(0x6f60, { 0xd4, 0x14, 0xdb });
        gbc.step();
        EXPECT(gbc.a(),  0xee);
        EXPECT(gbc.b(),  0xeb);
        EXPECT(gbc.c(),  0x45);
        EXPECT(gbc.d(),  0x0);
        EXPECT(gbc.e(),  0x4);
        EXPECT(gbc.h(),  0xb0);
        EXPECT(gbc.l(),  0xaf);
        EXPECT(gbc.sp(), 0xf8dc);
        EXPECT(gbc.pc(), 0x6f63);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0364
        gbc.setState(0xeaaf, 0xd635, 0xb50, 0x1e3d, 0xd2fa, 0x17ad, 0x1, 0x0);
        gbc.writeMem(0xeaaf, { 0xd4, 0x33, 0xd1 });
        gbc.step();
        EXPECT(gbc.a(),  0xb);
        EXPECT(gbc.b(),  0x1e);
        EXPECT(gbc.c(),  0x3d);
        EXPECT(gbc.d(),  0xd2);
        EXPECT(gbc.e(),  0xfa);
        EXPECT(gbc.h(),  0x17);
        EXPECT(gbc.l(),  0xad);
        EXPECT(gbc.sp(), 0xd635);
        EXPECT(gbc.pc(), 0xeab2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xeaaf), 0xd4);
        EXPECT(gbc.readMem(0xeab0), 0x33);
        EXPECT(gbc.readMem(0xeab1), 0xd1);
        // D4 0365
        gbc.setState(0x7a72, 0x7d8, 0xd510, 0x6d61, 0xe144, 0x44e, 0x1, 0x0);
        gbc.writeMem(0x7a72, { 0xd4, 0x58, 0x4d });
        gbc.step();
        EXPECT(gbc.a(),  0xd5);
        EXPECT(gbc.b(),  0x6d);
        EXPECT(gbc.c(),  0x61);
        EXPECT(gbc.d(),  0xe1);
        EXPECT(gbc.e(),  0x44);
        EXPECT(gbc.h(),  0x4);
        EXPECT(gbc.l(),  0x4e);
        EXPECT(gbc.sp(), 0x7d8);
        EXPECT(gbc.pc(), 0x7a75);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0366
        gbc.setState(0xcac7, 0xa61e, 0x30, 0x8593, 0xee5c, 0x85d7, 0x1, 0x0);
        gbc.writeMem(0xcac7, { 0xd4, 0xc1, 0xf7 });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x85);
        EXPECT(gbc.c(),  0x93);
        EXPECT(gbc.d(),  0xee);
        EXPECT(gbc.e(),  0x5c);
        EXPECT(gbc.h(),  0x85);
        EXPECT(gbc.l(),  0xd7);
        EXPECT(gbc.sp(), 0xa61e);
        EXPECT(gbc.pc(), 0xcaca);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcac7), 0xd4);
        EXPECT(gbc.readMem(0xcac8), 0xc1);
        EXPECT(gbc.readMem(0xcac9), 0xf7);
        // D4 0368
        gbc.setState(0xbff5, 0xf25c, 0xcbd0, 0x66ad, 0x81e6, 0x2031, 0x1, 0x1);
        gbc.writeMem(0xbff5, { 0xd4, 0x62, 0x5c });
        gbc.step();
        EXPECT(gbc.a(),  0xcb);
        EXPECT(gbc.b(),  0x66);
        EXPECT(gbc.c(),  0xad);
        EXPECT(gbc.d(),  0x81);
        EXPECT(gbc.e(),  0xe6);
        EXPECT(gbc.h(),  0x20);
        EXPECT(gbc.l(),  0x31);
        EXPECT(gbc.sp(), 0xf25c);
        EXPECT(gbc.pc(), 0xbff8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbff5), 0xd4);
        EXPECT(gbc.readMem(0xbff6), 0x62);
        EXPECT(gbc.readMem(0xbff7), 0x5c);
        // D4 036A
        gbc.setState(0x26c5, 0x2436, 0xfeb0, 0x460e, 0x8d64, 0x99a7, 0x0, 0x1);
        gbc.writeMem(0x26c5, { 0xd4, 0xb2, 0x24 });
        gbc.step();
        EXPECT(gbc.a(),  0xfe);
        EXPECT(gbc.b(),  0x46);
        EXPECT(gbc.c(),  0xe);
        EXPECT(gbc.d(),  0x8d);
        EXPECT(gbc.e(),  0x64);
        EXPECT(gbc.h(),  0x99);
        EXPECT(gbc.l(),  0xa7);
        EXPECT(gbc.sp(), 0x2436);
        EXPECT(gbc.pc(), 0x26c8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 036B
        gbc.setState(0xd824, 0x12ea, 0x710, 0x3d1, 0xa40, 0x6bee, 0x0, 0x0);
        gbc.writeMem(0xd824, { 0xd4, 0xa1, 0x3b });
        gbc.step();
        EXPECT(gbc.a(),  0x7);
        EXPECT(gbc.b(),  0x3);
        EXPECT(gbc.c(),  0xd1);
        EXPECT(gbc.d(),  0xa);
        EXPECT(gbc.e(),  0x40);
        EXPECT(gbc.h(),  0x6b);
        EXPECT(gbc.l(),  0xee);
        EXPECT(gbc.sp(), 0x12ea);
        EXPECT(gbc.pc(), 0xd827);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd824), 0xd4);
        EXPECT(gbc.readMem(0xd825), 0xa1);
        EXPECT(gbc.readMem(0xd826), 0x3b);
        // D4 036C
        gbc.setState(0x29a9, 0x702c, 0x7d30, 0xbd33, 0xf44c, 0xd0e, 0x0, 0x1);
        gbc.writeMem(0x29a9, { 0xd4, 0x9b, 0x8a });
        gbc.step();
        EXPECT(gbc.a(),  0x7d);
        EXPECT(gbc.b(),  0xbd);
        EXPECT(gbc.c(),  0x33);
        EXPECT(gbc.d(),  0xf4);
        EXPECT(gbc.e(),  0x4c);
        EXPECT(gbc.h(),  0xd);
        EXPECT(gbc.l(),  0xe);
        EXPECT(gbc.sp(), 0x702c);
        EXPECT(gbc.pc(), 0x29ac);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 036E
        gbc.setState(0xd663, 0x7656, 0xd270, 0x2151, 0xe2bd, 0x6664, 0x0, 0x0);
        gbc.writeMem(0xd663, { 0xd4, 0x75, 0xc });
        gbc.step();
        EXPECT(gbc.a(),  0xd2);
        EXPECT(gbc.b(),  0x21);
        EXPECT(gbc.c(),  0x51);
        EXPECT(gbc.d(),  0xe2);
        EXPECT(gbc.e(),  0xbd);
        EXPECT(gbc.h(),  0x66);
        EXPECT(gbc.l(),  0x64);
        EXPECT(gbc.sp(), 0x7656);
        EXPECT(gbc.pc(), 0xd666);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd663), 0xd4);
        EXPECT(gbc.readMem(0xd664), 0x75);
        EXPECT(gbc.readMem(0xd665), 0xc);
        // D4 036F
        gbc.setState(0xc2a3, 0xa254, 0xd200, 0xa88f, 0xd5ed, 0x2767, 0x1, 0x0);
        gbc.writeMem(0xa252, { 0x0, 0x0 });
        gbc.writeMem(0xc2a3, { 0xd4, 0xc2, 0x82 });
        gbc.step();
        EXPECT(gbc.a(),  0xd2);
        EXPECT(gbc.b(),  0xa8);
        EXPECT(gbc.c(),  0x8f);
        EXPECT(gbc.d(),  0xd5);
        EXPECT(gbc.e(),  0xed);
        EXPECT(gbc.h(),  0x27);
        EXPECT(gbc.l(),  0x67);
        EXPECT(gbc.sp(), 0xa252);
        EXPECT(gbc.pc(), 0x82c2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa252), 0xa6);
        EXPECT(gbc.readMem(0xa253), 0xc2);
        EXPECT(gbc.readMem(0xc2a3), 0xd4);
        EXPECT(gbc.readMem(0xc2a4), 0xc2);
        EXPECT(gbc.readMem(0xc2a5), 0x82);
        // D4 0370
        gbc.setState(0xe438, 0x30c9, 0xca10, 0x7034, 0xad5, 0xe231, 0x0, 0x0);
        gbc.writeMem(0xe438, { 0xd4, 0x64, 0x3 });
        gbc.step();
        EXPECT(gbc.a(),  0xca);
        EXPECT(gbc.b(),  0x70);
        EXPECT(gbc.c(),  0x34);
        EXPECT(gbc.d(),  0xa);
        EXPECT(gbc.e(),  0xd5);
        EXPECT(gbc.h(),  0xe2);
        EXPECT(gbc.l(),  0x31);
        EXPECT(gbc.sp(), 0x30c9);
        EXPECT(gbc.pc(), 0xe43b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe438), 0xd4);
        EXPECT(gbc.readMem(0xe439), 0x64);
        EXPECT(gbc.readMem(0xe43a), 0x3);
        // D4 0371
        gbc.setState(0x622c, 0x9b1a, 0x2de0, 0xc99a, 0x279b, 0xa80, 0x0, 0x0);
        gbc.writeMem(0x622c, { 0xd4, 0x1c, 0x4 });
        gbc.writeMem(0x9b18, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x2d);
        EXPECT(gbc.b(),  0xc9);
        EXPECT(gbc.c(),  0x9a);
        EXPECT(gbc.d(),  0x27);
        EXPECT(gbc.e(),  0x9b);
        EXPECT(gbc.h(),  0xa);
        EXPECT(gbc.l(),  0x80);
        EXPECT(gbc.sp(), 0x9b18);
        EXPECT(gbc.pc(), 0x41c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9b18), 0x2f);
        EXPECT(gbc.readMem(0x9b19), 0x62);
        // D4 0373
        gbc.setState(0x45b9, 0xf1f7, 0x71d0, 0xe2d7, 0x2377, 0xfd71, 0x1, 0x1);
        gbc.writeMem(0x45b9, { 0xd4, 0xe5, 0x7e });
        gbc.step();
        EXPECT(gbc.a(),  0x71);
        EXPECT(gbc.b(),  0xe2);
        EXPECT(gbc.c(),  0xd7);
        EXPECT(gbc.d(),  0x23);
        EXPECT(gbc.e(),  0x77);
        EXPECT(gbc.h(),  0xfd);
        EXPECT(gbc.l(),  0x71);
        EXPECT(gbc.sp(), 0xf1f7);
        EXPECT(gbc.pc(), 0x45bc);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 0375
        gbc.setState(0xef89, 0xed31, 0x2e80, 0x3d25, 0x2938, 0xe21, 0x1, 0x1);
        gbc.writeMem(0xed2f, { 0x0, 0x0 });
        gbc.writeMem(0xef89, { 0xd4, 0x64, 0xc1 });
        gbc.step();
        EXPECT(gbc.a(),  0x2e);
        EXPECT(gbc.b(),  0x3d);
        EXPECT(gbc.c(),  0x25);
        EXPECT(gbc.d(),  0x29);
        EXPECT(gbc.e(),  0x38);
        EXPECT(gbc.h(),  0xe);
        EXPECT(gbc.l(),  0x21);
        EXPECT(gbc.sp(), 0xed2f);
        EXPECT(gbc.pc(), 0xc164);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xed2f), 0x8c);
        EXPECT(gbc.readMem(0xed30), 0xef);
        EXPECT(gbc.readMem(0xef89), 0xd4);
        EXPECT(gbc.readMem(0xef8a), 0x64);
        EXPECT(gbc.readMem(0xef8b), 0xc1);
        // D4 0376
        gbc.setState(0x3ffb, 0x5992, 0x330, 0xa181, 0xbcd3, 0x5640, 0x1, 0x0);
        gbc.writeMem(0x3ffb, { 0xd4, 0xf6, 0x8a });
        gbc.step();
        EXPECT(gbc.a(),  0x3);
        EXPECT(gbc.b(),  0xa1);
        EXPECT(gbc.c(),  0x81);
        EXPECT(gbc.d(),  0xbc);
        EXPECT(gbc.e(),  0xd3);
        EXPECT(gbc.h(),  0x56);
        EXPECT(gbc.l(),  0x40);
        EXPECT(gbc.sp(), 0x5992);
        EXPECT(gbc.pc(), 0x3ffe);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0378
        gbc.setState(0x8f9c, 0x89f5, 0x9250, 0x231a, 0xd9de, 0xec97, 0x0, 0x0);
        gbc.writeMem(0x8f9c, { 0xd4, 0x86, 0x32 });
        gbc.step();
        EXPECT(gbc.a(),  0x92);
        EXPECT(gbc.b(),  0x23);
        EXPECT(gbc.c(),  0x1a);
        EXPECT(gbc.d(),  0xd9);
        EXPECT(gbc.e(),  0xde);
        EXPECT(gbc.h(),  0xec);
        EXPECT(gbc.l(),  0x97);
        EXPECT(gbc.sp(), 0x89f5);
        EXPECT(gbc.pc(), 0x8f9f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8f9c), 0xd4);
        EXPECT(gbc.readMem(0x8f9d), 0x86);
        EXPECT(gbc.readMem(0x8f9e), 0x32);
        // D4 0379
        gbc.setState(0xdc6f, 0xea78, 0x8ff0, 0xbedd, 0x76eb, 0x3034, 0x1, 0x0);
        gbc.writeMem(0xdc6f, { 0xd4, 0x25, 0x1e });
        gbc.step();
        EXPECT(gbc.a(),  0x8f);
        EXPECT(gbc.b(),  0xbe);
        EXPECT(gbc.c(),  0xdd);
        EXPECT(gbc.d(),  0x76);
        EXPECT(gbc.e(),  0xeb);
        EXPECT(gbc.h(),  0x30);
        EXPECT(gbc.l(),  0x34);
        EXPECT(gbc.sp(), 0xea78);
        EXPECT(gbc.pc(), 0xdc72);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xdc6f), 0xd4);
        EXPECT(gbc.readMem(0xdc70), 0x25);
        EXPECT(gbc.readMem(0xdc71), 0x1e);
        // D4 037A
        gbc.setState(0x7b60, 0xe651, 0x33c0, 0x16ff, 0xea14, 0x3734, 0x1, 0x0);
        gbc.writeMem(0x7b60, { 0xd4, 0x7d, 0xbe });
        gbc.writeMem(0xe64f, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x33);
        EXPECT(gbc.b(),  0x16);
        EXPECT(gbc.c(),  0xff);
        EXPECT(gbc.d(),  0xea);
        EXPECT(gbc.e(),  0x14);
        EXPECT(gbc.h(),  0x37);
        EXPECT(gbc.l(),  0x34);
        EXPECT(gbc.sp(), 0xe64f);
        EXPECT(gbc.pc(), 0xbe7d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe64f), 0x63);
        EXPECT(gbc.readMem(0xe650), 0x7b);
        // D4 037B
        gbc.setState(0xdc1c, 0x9f2b, 0x2080, 0xe29a, 0x16b9, 0x3728, 0x0, 0x0);
        gbc.writeMem(0x9f29, { 0x0, 0x0 });
        gbc.writeMem(0xdc1c, { 0xd4, 0xd6, 0x31 });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0xe2);
        EXPECT(gbc.c(),  0x9a);
        EXPECT(gbc.d(),  0x16);
        EXPECT(gbc.e(),  0xb9);
        EXPECT(gbc.h(),  0x37);
        EXPECT(gbc.l(),  0x28);
        EXPECT(gbc.sp(), 0x9f29);
        EXPECT(gbc.pc(), 0x31d6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9f29), 0x1f);
        EXPECT(gbc.readMem(0x9f2a), 0xdc);
        EXPECT(gbc.readMem(0xdc1c), 0xd4);
        EXPECT(gbc.readMem(0xdc1d), 0xd6);
        EXPECT(gbc.readMem(0xdc1e), 0x31);
        // D4 037C
        gbc.setState(0x4282, 0xb9d2, 0x7e10, 0x2ad8, 0xf5cc, 0xe9fb, 0x1, 0x1);
        gbc.writeMem(0x4282, { 0xd4, 0x8e, 0x6c });
        gbc.step();
        EXPECT(gbc.a(),  0x7e);
        EXPECT(gbc.b(),  0x2a);
        EXPECT(gbc.c(),  0xd8);
        EXPECT(gbc.d(),  0xf5);
        EXPECT(gbc.e(),  0xcc);
        EXPECT(gbc.h(),  0xe9);
        EXPECT(gbc.l(),  0xfb);
        EXPECT(gbc.sp(), 0xb9d2);
        EXPECT(gbc.pc(), 0x4285);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 037D
        gbc.setState(0xa5bf, 0x22c5, 0x57d0, 0xcfd9, 0x22d0, 0x72b2, 0x1, 0x1);
        gbc.writeMem(0xa5bf, { 0xd4, 0x2c, 0x16 });
        gbc.step();
        EXPECT(gbc.a(),  0x57);
        EXPECT(gbc.b(),  0xcf);
        EXPECT(gbc.c(),  0xd9);
        EXPECT(gbc.d(),  0x22);
        EXPECT(gbc.e(),  0xd0);
        EXPECT(gbc.h(),  0x72);
        EXPECT(gbc.l(),  0xb2);
        EXPECT(gbc.sp(), 0x22c5);
        EXPECT(gbc.pc(), 0xa5c2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa5bf), 0xd4);
        EXPECT(gbc.readMem(0xa5c0), 0x2c);
        EXPECT(gbc.readMem(0xa5c1), 0x16);
        // D4 037F
        gbc.setState(0x7627, 0xef87, 0x7820, 0xbac8, 0xf817, 0x35bb, 0x1, 0x0);
        gbc.writeMem(0x7627, { 0xd4, 0xd4, 0xbf });
        gbc.writeMem(0xef85, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x78);
        EXPECT(gbc.b(),  0xba);
        EXPECT(gbc.c(),  0xc8);
        EXPECT(gbc.d(),  0xf8);
        EXPECT(gbc.e(),  0x17);
        EXPECT(gbc.h(),  0x35);
        EXPECT(gbc.l(),  0xbb);
        EXPECT(gbc.sp(), 0xef85);
        EXPECT(gbc.pc(), 0xbfd4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xef85), 0x2a);
        EXPECT(gbc.readMem(0xef86), 0x76);
        // D4 0381
        gbc.setState(0x769e, 0xa7d2, 0xcf20, 0x512c, 0xf9ea, 0x3281, 0x1, 0x0);
        gbc.writeMem(0x769e, { 0xd4, 0xca, 0x60 });
        gbc.writeMem(0xa7d0, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xcf);
        EXPECT(gbc.b(),  0x51);
        EXPECT(gbc.c(),  0x2c);
        EXPECT(gbc.d(),  0xf9);
        EXPECT(gbc.e(),  0xea);
        EXPECT(gbc.h(),  0x32);
        EXPECT(gbc.l(),  0x81);
        EXPECT(gbc.sp(), 0xa7d0);
        EXPECT(gbc.pc(), 0x60ca);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa7d0), 0xa1);
        EXPECT(gbc.readMem(0xa7d1), 0x76);
        // D4 0382
        gbc.setState(0x8276, 0xd68f, 0x4f80, 0xce1f, 0x3594, 0x1269, 0x1, 0x1);
        gbc.writeMem(0x8276, { 0xd4, 0x37, 0x27 });
        gbc.writeMem(0xd68d, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x4f);
        EXPECT(gbc.b(),  0xce);
        EXPECT(gbc.c(),  0x1f);
        EXPECT(gbc.d(),  0x35);
        EXPECT(gbc.e(),  0x94);
        EXPECT(gbc.h(),  0x12);
        EXPECT(gbc.l(),  0x69);
        EXPECT(gbc.sp(), 0xd68d);
        EXPECT(gbc.pc(), 0x2737);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8276), 0xd4);
        EXPECT(gbc.readMem(0x8277), 0x37);
        EXPECT(gbc.readMem(0x8278), 0x27);
        EXPECT(gbc.readMem(0xd68d), 0x79);
        EXPECT(gbc.readMem(0xd68e), 0x82);
        // D4 0383
        gbc.setState(0xd80, 0x3863, 0x1730, 0xe387, 0x7e36, 0x37c7, 0x0, 0x0);
        gbc.writeMem(0xd80, { 0xd4, 0x1f, 0x77 });
        gbc.step();
        EXPECT(gbc.a(),  0x17);
        EXPECT(gbc.b(),  0xe3);
        EXPECT(gbc.c(),  0x87);
        EXPECT(gbc.d(),  0x7e);
        EXPECT(gbc.e(),  0x36);
        EXPECT(gbc.h(),  0x37);
        EXPECT(gbc.l(),  0xc7);
        EXPECT(gbc.sp(), 0x3863);
        EXPECT(gbc.pc(), 0xd83);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0385
        gbc.setState(0x4149, 0x969a, 0xa660, 0x9ffd, 0xb103, 0xee15, 0x0, 0x1);
        gbc.writeMem(0x4149, { 0xd4, 0x6b, 0xbb });
        gbc.writeMem(0x9698, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xa6);
        EXPECT(gbc.b(),  0x9f);
        EXPECT(gbc.c(),  0xfd);
        EXPECT(gbc.d(),  0xb1);
        EXPECT(gbc.e(),  0x3);
        EXPECT(gbc.h(),  0xee);
        EXPECT(gbc.l(),  0x15);
        EXPECT(gbc.sp(), 0x9698);
        EXPECT(gbc.pc(), 0xbb6b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9698), 0x4c);
        EXPECT(gbc.readMem(0x9699), 0x41);
        // D4 0386
        gbc.setState(0x28e0, 0x215, 0x1230, 0x45ce, 0xe68d, 0x8957, 0x1, 0x1);
        gbc.writeMem(0x28e0, { 0xd4, 0x24, 0xcb });
        gbc.step();
        EXPECT(gbc.a(),  0x12);
        EXPECT(gbc.b(),  0x45);
        EXPECT(gbc.c(),  0xce);
        EXPECT(gbc.d(),  0xe6);
        EXPECT(gbc.e(),  0x8d);
        EXPECT(gbc.h(),  0x89);
        EXPECT(gbc.l(),  0x57);
        EXPECT(gbc.sp(), 0x215);
        EXPECT(gbc.pc(), 0x28e3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0389
        gbc.setState(0x4ba3, 0x26a9, 0x1cd0, 0xae0c, 0xdd13, 0x3c14, 0x0, 0x0);
        gbc.writeMem(0x4ba3, { 0xd4, 0x9b, 0xdc });
        gbc.step();
        EXPECT(gbc.a(),  0x1c);
        EXPECT(gbc.b(),  0xae);
        EXPECT(gbc.c(),  0xc);
        EXPECT(gbc.d(),  0xdd);
        EXPECT(gbc.e(),  0x13);
        EXPECT(gbc.h(),  0x3c);
        EXPECT(gbc.l(),  0x14);
        EXPECT(gbc.sp(), 0x26a9);
        EXPECT(gbc.pc(), 0x4ba6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 038A
        gbc.setState(0x3b11, 0xbd34, 0x5210, 0xe3ba, 0xf26d, 0xcf9c, 0x1, 0x0);
        gbc.writeMem(0x3b11, { 0xd4, 0x94, 0x54 });
        gbc.step();
        EXPECT(gbc.a(),  0x52);
        EXPECT(gbc.b(),  0xe3);
        EXPECT(gbc.c(),  0xba);
        EXPECT(gbc.d(),  0xf2);
        EXPECT(gbc.e(),  0x6d);
        EXPECT(gbc.h(),  0xcf);
        EXPECT(gbc.l(),  0x9c);
        EXPECT(gbc.sp(), 0xbd34);
        EXPECT(gbc.pc(), 0x3b14);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 038B
        gbc.setState(0x5d43, 0x980e, 0x2ad0, 0xc348, 0x825d, 0x2512, 0x1, 0x1);
        gbc.writeMem(0x5d43, { 0xd4, 0x95, 0x98 });
        gbc.step();
        EXPECT(gbc.a(),  0x2a);
        EXPECT(gbc.b(),  0xc3);
        EXPECT(gbc.c(),  0x48);
        EXPECT(gbc.d(),  0x82);
        EXPECT(gbc.e(),  0x5d);
        EXPECT(gbc.h(),  0x25);
        EXPECT(gbc.l(),  0x12);
        EXPECT(gbc.sp(), 0x980e);
        EXPECT(gbc.pc(), 0x5d46);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 038C
        gbc.setState(0x388e, 0xfcc4, 0xdd00, 0xf827, 0x19a8, 0xa0b6, 0x1, 0x0);
        gbc.writeMem(0x388e, { 0xd4, 0x1f, 0x7a });
        gbc.writeMem(0xfcc2, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xdd);
        EXPECT(gbc.b(),  0xf8);
        EXPECT(gbc.c(),  0x27);
        EXPECT(gbc.d(),  0x19);
        EXPECT(gbc.e(),  0xa8);
        EXPECT(gbc.h(),  0xa0);
        EXPECT(gbc.l(),  0xb6);
        EXPECT(gbc.sp(), 0xfcc2);
        EXPECT(gbc.pc(), 0x7a1f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xfcc2), 0x91);
        EXPECT(gbc.readMem(0xfcc3), 0x38);
        // D4 038D
        gbc.setState(0xc52, 0x5934, 0xc9b0, 0xd007, 0xaf42, 0x1bb, 0x1, 0x1);
        gbc.writeMem(0xc52, { 0xd4, 0xf9, 0x29 });
        gbc.step();
        EXPECT(gbc.a(),  0xc9);
        EXPECT(gbc.b(),  0xd0);
        EXPECT(gbc.c(),  0x7);
        EXPECT(gbc.d(),  0xaf);
        EXPECT(gbc.e(),  0x42);
        EXPECT(gbc.h(),  0x1);
        EXPECT(gbc.l(),  0xbb);
        EXPECT(gbc.sp(), 0x5934);
        EXPECT(gbc.pc(), 0xc55);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 038F
        gbc.setState(0x7463, 0xdc39, 0x4400, 0x6ec1, 0xf5db, 0xe013, 0x0, 0x0);
        gbc.writeMem(0x7463, { 0xd4, 0x1c, 0xc6 });
        gbc.writeMem(0xdc37, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x44);
        EXPECT(gbc.b(),  0x6e);
        EXPECT(gbc.c(),  0xc1);
        EXPECT(gbc.d(),  0xf5);
        EXPECT(gbc.e(),  0xdb);
        EXPECT(gbc.h(),  0xe0);
        EXPECT(gbc.l(),  0x13);
        EXPECT(gbc.sp(), 0xdc37);
        EXPECT(gbc.pc(), 0xc61c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdc37), 0x66);
        EXPECT(gbc.readMem(0xdc38), 0x74);
        // D4 0390
        gbc.setState(0xe375, 0x73df, 0x9090, 0xe244, 0x7724, 0x75d3, 0x0, 0x0);
        gbc.writeMem(0xe375, { 0xd4, 0xbe, 0x35 });
        gbc.step();
        EXPECT(gbc.a(),  0x90);
        EXPECT(gbc.b(),  0xe2);
        EXPECT(gbc.c(),  0x44);
        EXPECT(gbc.d(),  0x77);
        EXPECT(gbc.e(),  0x24);
        EXPECT(gbc.h(),  0x75);
        EXPECT(gbc.l(),  0xd3);
        EXPECT(gbc.sp(), 0x73df);
        EXPECT(gbc.pc(), 0xe378);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe375), 0xd4);
        EXPECT(gbc.readMem(0xe376), 0xbe);
        EXPECT(gbc.readMem(0xe377), 0x35);
        // D4 0392
        gbc.setState(0x35de, 0xbbfb, 0x6bf0, 0xe1bb, 0xefbc, 0xc8f6, 0x0, 0x1);
        gbc.writeMem(0x35de, { 0xd4, 0xa5, 0xf6 });
        gbc.step();
        EXPECT(gbc.a(),  0x6b);
        EXPECT(gbc.b(),  0xe1);
        EXPECT(gbc.c(),  0xbb);
        EXPECT(gbc.d(),  0xef);
        EXPECT(gbc.e(),  0xbc);
        EXPECT(gbc.h(),  0xc8);
        EXPECT(gbc.l(),  0xf6);
        EXPECT(gbc.sp(), 0xbbfb);
        EXPECT(gbc.pc(), 0x35e1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 0394
        gbc.setState(0xe537, 0x151f, 0xab0, 0xda5b, 0x95b8, 0xa69e, 0x1, 0x1);
        gbc.writeMem(0xe537, { 0xd4, 0x35, 0x84 });
        gbc.step();
        EXPECT(gbc.a(),  0xa);
        EXPECT(gbc.b(),  0xda);
        EXPECT(gbc.c(),  0x5b);
        EXPECT(gbc.d(),  0x95);
        EXPECT(gbc.e(),  0xb8);
        EXPECT(gbc.h(),  0xa6);
        EXPECT(gbc.l(),  0x9e);
        EXPECT(gbc.sp(), 0x151f);
        EXPECT(gbc.pc(), 0xe53a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe537), 0xd4);
        EXPECT(gbc.readMem(0xe538), 0x35);
        EXPECT(gbc.readMem(0xe539), 0x84);
        // D4 0397
        gbc.setState(0xb13f, 0xbeb5, 0x2e20, 0x6da7, 0xb206, 0xb569, 0x1, 0x0);
        gbc.writeMem(0xb13f, { 0xd4, 0x61, 0x2c });
        gbc.writeMem(0xbeb3, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x2e);
        EXPECT(gbc.b(),  0x6d);
        EXPECT(gbc.c(),  0xa7);
        EXPECT(gbc.d(),  0xb2);
        EXPECT(gbc.e(),  0x6);
        EXPECT(gbc.h(),  0xb5);
        EXPECT(gbc.l(),  0x69);
        EXPECT(gbc.sp(), 0xbeb3);
        EXPECT(gbc.pc(), 0x2c61);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb13f), 0xd4);
        EXPECT(gbc.readMem(0xb140), 0x61);
        EXPECT(gbc.readMem(0xb141), 0x2c);
        EXPECT(gbc.readMem(0xbeb3), 0x42);
        EXPECT(gbc.readMem(0xbeb4), 0xb1);
        // D4 0399
        gbc.setState(0x9f78, 0x8993, 0xe8e0, 0x161c, 0x1f28, 0x8332, 0x0, 0x1);
        gbc.writeMem(0x8991, { 0x0, 0x0 });
        gbc.writeMem(0x9f78, { 0xd4, 0xff, 0xcc });
        gbc.step();
        EXPECT(gbc.a(),  0xe8);
        EXPECT(gbc.b(),  0x16);
        EXPECT(gbc.c(),  0x1c);
        EXPECT(gbc.d(),  0x1f);
        EXPECT(gbc.e(),  0x28);
        EXPECT(gbc.h(),  0x83);
        EXPECT(gbc.l(),  0x32);
        EXPECT(gbc.sp(), 0x8991);
        EXPECT(gbc.pc(), 0xccff);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8991), 0x7b);
        EXPECT(gbc.readMem(0x8992), 0x9f);
        EXPECT(gbc.readMem(0x9f78), 0xd4);
        EXPECT(gbc.readMem(0x9f79), 0xff);
        EXPECT(gbc.readMem(0x9f7a), 0xcc);
        // D4 039A
        gbc.setState(0xa651, 0xe496, 0x3180, 0x4525, 0x71ad, 0xa839, 0x0, 0x1);
        gbc.writeMem(0xa651, { 0xd4, 0x25, 0x28 });
        gbc.writeMem(0xe494, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x31);
        EXPECT(gbc.b(),  0x45);
        EXPECT(gbc.c(),  0x25);
        EXPECT(gbc.d(),  0x71);
        EXPECT(gbc.e(),  0xad);
        EXPECT(gbc.h(),  0xa8);
        EXPECT(gbc.l(),  0x39);
        EXPECT(gbc.sp(), 0xe494);
        EXPECT(gbc.pc(), 0x2825);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa651), 0xd4);
        EXPECT(gbc.readMem(0xa652), 0x25);
        EXPECT(gbc.readMem(0xa653), 0x28);
        EXPECT(gbc.readMem(0xe494), 0x54);
        EXPECT(gbc.readMem(0xe495), 0xa6);
        // D4 039B
        gbc.setState(0x7f1a, 0xa3e8, 0xed10, 0x9b8, 0xb411, 0x762a, 0x0, 0x0);
        gbc.writeMem(0x7f1a, { 0xd4, 0xdc, 0xb7 });
        gbc.step();
        EXPECT(gbc.a(),  0xed);
        EXPECT(gbc.b(),  0x9);
        EXPECT(gbc.c(),  0xb8);
        EXPECT(gbc.d(),  0xb4);
        EXPECT(gbc.e(),  0x11);
        EXPECT(gbc.h(),  0x76);
        EXPECT(gbc.l(),  0x2a);
        EXPECT(gbc.sp(), 0xa3e8);
        EXPECT(gbc.pc(), 0x7f1d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 039C
        gbc.setState(0x25e8, 0xb4e1, 0x35e0, 0x58e1, 0x8726, 0x8bd2, 0x0, 0x0);
        gbc.writeMem(0x25e8, { 0xd4, 0xc2, 0x32 });
        gbc.writeMem(0xb4df, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x35);
        EXPECT(gbc.b(),  0x58);
        EXPECT(gbc.c(),  0xe1);
        EXPECT(gbc.d(),  0x87);
        EXPECT(gbc.e(),  0x26);
        EXPECT(gbc.h(),  0x8b);
        EXPECT(gbc.l(),  0xd2);
        EXPECT(gbc.sp(), 0xb4df);
        EXPECT(gbc.pc(), 0x32c2);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb4df), 0xeb);
        EXPECT(gbc.readMem(0xb4e0), 0x25);
        // D4 039D
        gbc.setState(0x5170, 0x7964, 0xac70, 0x1db, 0x37d3, 0x946b, 0x1, 0x1);
        gbc.writeMem(0x5170, { 0xd4, 0xdf, 0xf2 });
        gbc.step();
        EXPECT(gbc.a(),  0xac);
        EXPECT(gbc.b(),  0x1);
        EXPECT(gbc.c(),  0xdb);
        EXPECT(gbc.d(),  0x37);
        EXPECT(gbc.e(),  0xd3);
        EXPECT(gbc.h(),  0x94);
        EXPECT(gbc.l(),  0x6b);
        EXPECT(gbc.sp(), 0x7964);
        EXPECT(gbc.pc(), 0x5173);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 03A0
        gbc.setState(0x347a, 0x825e, 0x5a0, 0x4d4a, 0x3be, 0x984a, 0x0, 0x1);
        gbc.writeMem(0x347a, { 0xd4, 0x4b, 0xcc });
        gbc.writeMem(0x825c, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x5);
        EXPECT(gbc.b(),  0x4d);
        EXPECT(gbc.c(),  0x4a);
        EXPECT(gbc.d(),  0x3);
        EXPECT(gbc.e(),  0xbe);
        EXPECT(gbc.h(),  0x98);
        EXPECT(gbc.l(),  0x4a);
        EXPECT(gbc.sp(), 0x825c);
        EXPECT(gbc.pc(), 0xcc4b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x825c), 0x7d);
        EXPECT(gbc.readMem(0x825d), 0x34);
        // D4 03A1
        gbc.setState(0xa7b4, 0x92b5, 0xafe0, 0xed7a, 0x70b0, 0x2ec2, 0x0, 0x1);
        gbc.writeMem(0x92b3, { 0x0, 0x0 });
        gbc.writeMem(0xa7b4, { 0xd4, 0x43, 0xde });
        gbc.step();
        EXPECT(gbc.a(),  0xaf);
        EXPECT(gbc.b(),  0xed);
        EXPECT(gbc.c(),  0x7a);
        EXPECT(gbc.d(),  0x70);
        EXPECT(gbc.e(),  0xb0);
        EXPECT(gbc.h(),  0x2e);
        EXPECT(gbc.l(),  0xc2);
        EXPECT(gbc.sp(), 0x92b3);
        EXPECT(gbc.pc(), 0xde43);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x92b3), 0xb7);
        EXPECT(gbc.readMem(0x92b4), 0xa7);
        EXPECT(gbc.readMem(0xa7b4), 0xd4);
        EXPECT(gbc.readMem(0xa7b5), 0x43);
        EXPECT(gbc.readMem(0xa7b6), 0xde);
        // D4 03A3
        gbc.setState(0x53fa, 0xe808, 0xaa40, 0x7bc2, 0xfed, 0x1299, 0x1, 0x0);
        gbc.writeMem(0x53fa, { 0xd4, 0x10, 0x2d });
        gbc.writeMem(0xe806, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xaa);
        EXPECT(gbc.b(),  0x7b);
        EXPECT(gbc.c(),  0xc2);
        EXPECT(gbc.d(),  0xf);
        EXPECT(gbc.e(),  0xed);
        EXPECT(gbc.h(),  0x12);
        EXPECT(gbc.l(),  0x99);
        EXPECT(gbc.sp(), 0xe806);
        EXPECT(gbc.pc(), 0x2d10);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe806), 0xfd);
        EXPECT(gbc.readMem(0xe807), 0x53);
        // D4 03A4
        gbc.setState(0xa404, 0x779, 0x6ad0, 0x9bcf, 0x60b2, 0x3ebb, 0x0, 0x0);
        gbc.writeMem(0xa404, { 0xd4, 0x56, 0xf8 });
        gbc.step();
        EXPECT(gbc.a(),  0x6a);
        EXPECT(gbc.b(),  0x9b);
        EXPECT(gbc.c(),  0xcf);
        EXPECT(gbc.d(),  0x60);
        EXPECT(gbc.e(),  0xb2);
        EXPECT(gbc.h(),  0x3e);
        EXPECT(gbc.l(),  0xbb);
        EXPECT(gbc.sp(), 0x779);
        EXPECT(gbc.pc(), 0xa407);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa404), 0xd4);
        EXPECT(gbc.readMem(0xa405), 0x56);
        EXPECT(gbc.readMem(0xa406), 0xf8);
        // D4 03A5
        gbc.setState(0xb96, 0xde32, 0x890, 0x959f, 0xbe5a, 0xea54, 0x1, 0x1);
        gbc.writeMem(0xb96, { 0xd4, 0xb, 0x58 });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0x95);
        EXPECT(gbc.c(),  0x9f);
        EXPECT(gbc.d(),  0xbe);
        EXPECT(gbc.e(),  0x5a);
        EXPECT(gbc.h(),  0xea);
        EXPECT(gbc.l(),  0x54);
        EXPECT(gbc.sp(), 0xde32);
        EXPECT(gbc.pc(), 0xb99);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 03A6
        gbc.setState(0xaaaa, 0xd50c, 0x73d0, 0x62b, 0xf56d, 0x4b77, 0x0, 0x0);
        gbc.writeMem(0xaaaa, { 0xd4, 0x45, 0x97 });
        gbc.step();
        EXPECT(gbc.a(),  0x73);
        EXPECT(gbc.b(),  0x6);
        EXPECT(gbc.c(),  0x2b);
        EXPECT(gbc.d(),  0xf5);
        EXPECT(gbc.e(),  0x6d);
        EXPECT(gbc.h(),  0x4b);
        EXPECT(gbc.l(),  0x77);
        EXPECT(gbc.sp(), 0xd50c);
        EXPECT(gbc.pc(), 0xaaad);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xaaaa), 0xd4);
        EXPECT(gbc.readMem(0xaaab), 0x45);
        EXPECT(gbc.readMem(0xaaac), 0x97);
        // D4 03A7
        gbc.setState(0xa548, 0xf86d, 0x5960, 0xe94c, 0xdcc2, 0x2030, 0x1, 0x1);
        gbc.writeMem(0xa548, { 0xd4, 0x69, 0xe9 });
        gbc.writeMem(0xf86b, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x59);
        EXPECT(gbc.b(),  0xe9);
        EXPECT(gbc.c(),  0x4c);
        EXPECT(gbc.d(),  0xdc);
        EXPECT(gbc.e(),  0xc2);
        EXPECT(gbc.h(),  0x20);
        EXPECT(gbc.l(),  0x30);
        EXPECT(gbc.sp(), 0xf86b);
        EXPECT(gbc.pc(), 0xe969);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa548), 0xd4);
        EXPECT(gbc.readMem(0xa549), 0x69);
        EXPECT(gbc.readMem(0xa54a), 0xe9);
        EXPECT(gbc.readMem(0xf86b), 0x4b);
        EXPECT(gbc.readMem(0xf86c), 0xa5);
        // D4 03A8
        gbc.setState(0x7998, 0xdce6, 0xf620, 0x2be9, 0xf352, 0x6452, 0x0, 0x0);
        gbc.writeMem(0x7998, { 0xd4, 0xc9, 0x25 });
        gbc.writeMem(0xdce4, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xf6);
        EXPECT(gbc.b(),  0x2b);
        EXPECT(gbc.c(),  0xe9);
        EXPECT(gbc.d(),  0xf3);
        EXPECT(gbc.e(),  0x52);
        EXPECT(gbc.h(),  0x64);
        EXPECT(gbc.l(),  0x52);
        EXPECT(gbc.sp(), 0xdce4);
        EXPECT(gbc.pc(), 0x25c9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdce4), 0x9b);
        EXPECT(gbc.readMem(0xdce5), 0x79);
        // D4 03A9
        gbc.setState(0xb55c, 0xca74, 0x6c60, 0x87ad, 0x6098, 0x2367, 0x1, 0x1);
        gbc.writeMem(0xb55c, { 0xd4, 0xb, 0xfc });
        gbc.writeMem(0xca72, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x6c);
        EXPECT(gbc.b(),  0x87);
        EXPECT(gbc.c(),  0xad);
        EXPECT(gbc.d(),  0x60);
        EXPECT(gbc.e(),  0x98);
        EXPECT(gbc.h(),  0x23);
        EXPECT(gbc.l(),  0x67);
        EXPECT(gbc.sp(), 0xca72);
        EXPECT(gbc.pc(), 0xfc0b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb55c), 0xd4);
        EXPECT(gbc.readMem(0xb55d), 0xb);
        EXPECT(gbc.readMem(0xb55e), 0xfc);
        EXPECT(gbc.readMem(0xca72), 0x5f);
        EXPECT(gbc.readMem(0xca73), 0xb5);
        // D4 03AD
        gbc.setState(0x9bbe, 0xe057, 0xd150, 0xd059, 0xc91a, 0x9214, 0x0, 0x1);
        gbc.writeMem(0x9bbe, { 0xd4, 0x34, 0x4a });
        gbc.step();
        EXPECT(gbc.a(),  0xd1);
        EXPECT(gbc.b(),  0xd0);
        EXPECT(gbc.c(),  0x59);
        EXPECT(gbc.d(),  0xc9);
        EXPECT(gbc.e(),  0x1a);
        EXPECT(gbc.h(),  0x92);
        EXPECT(gbc.l(),  0x14);
        EXPECT(gbc.sp(), 0xe057);
        EXPECT(gbc.pc(), 0x9bc1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9bbe), 0xd4);
        EXPECT(gbc.readMem(0x9bbf), 0x34);
        EXPECT(gbc.readMem(0x9bc0), 0x4a);
        // D4 03AF
        gbc.setState(0xeb11, 0xcb06, 0x2d90, 0xd05e, 0x93a0, 0x46b1, 0x0, 0x0);
        gbc.writeMem(0xeb11, { 0xd4, 0x4d, 0x8f });
        gbc.step();
        EXPECT(gbc.a(),  0x2d);
        EXPECT(gbc.b(),  0xd0);
        EXPECT(gbc.c(),  0x5e);
        EXPECT(gbc.d(),  0x93);
        EXPECT(gbc.e(),  0xa0);
        EXPECT(gbc.h(),  0x46);
        EXPECT(gbc.l(),  0xb1);
        EXPECT(gbc.sp(), 0xcb06);
        EXPECT(gbc.pc(), 0xeb14);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xeb11), 0xd4);
        EXPECT(gbc.readMem(0xeb12), 0x4d);
        EXPECT(gbc.readMem(0xeb13), 0x8f);
        // D4 03B1
        gbc.setState(0xa97a, 0x3f1e, 0x2530, 0xca9b, 0x85a1, 0x2cac, 0x0, 0x0);
        gbc.writeMem(0xa97a, { 0xd4, 0xa2, 0x6c });
        gbc.step();
        EXPECT(gbc.a(),  0x25);
        EXPECT(gbc.b(),  0xca);
        EXPECT(gbc.c(),  0x9b);
        EXPECT(gbc.d(),  0x85);
        EXPECT(gbc.e(),  0xa1);
        EXPECT(gbc.h(),  0x2c);
        EXPECT(gbc.l(),  0xac);
        EXPECT(gbc.sp(), 0x3f1e);
        EXPECT(gbc.pc(), 0xa97d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa97a), 0xd4);
        EXPECT(gbc.readMem(0xa97b), 0xa2);
        EXPECT(gbc.readMem(0xa97c), 0x6c);
        // D4 03B2
        gbc.setState(0xa87f, 0xa32e, 0x31e0, 0x602f, 0x7e44, 0x16, 0x1, 0x1);
        gbc.writeMem(0xa32c, { 0x0, 0x0 });
        gbc.writeMem(0xa87f, { 0xd4, 0x1b, 0x25 });
        gbc.step();
        EXPECT(gbc.a(),  0x31);
        EXPECT(gbc.b(),  0x60);
        EXPECT(gbc.c(),  0x2f);
        EXPECT(gbc.d(),  0x7e);
        EXPECT(gbc.e(),  0x44);
        EXPECT(gbc.h(),  0x0);
        EXPECT(gbc.l(),  0x16);
        EXPECT(gbc.sp(), 0xa32c);
        EXPECT(gbc.pc(), 0x251b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa32c), 0x82);
        EXPECT(gbc.readMem(0xa32d), 0xa8);
        EXPECT(gbc.readMem(0xa87f), 0xd4);
        EXPECT(gbc.readMem(0xa880), 0x1b);
        EXPECT(gbc.readMem(0xa881), 0x25);
        // D4 03B3
        gbc.setState(0x8cd3, 0x7328, 0x4a70, 0x4c7c, 0xbe08, 0xa5f4, 0x0, 0x0);
        gbc.writeMem(0x8cd3, { 0xd4, 0x8, 0x2a });
        gbc.step();
        EXPECT(gbc.a(),  0x4a);
        EXPECT(gbc.b(),  0x4c);
        EXPECT(gbc.c(),  0x7c);
        EXPECT(gbc.d(),  0xbe);
        EXPECT(gbc.e(),  0x8);
        EXPECT(gbc.h(),  0xa5);
        EXPECT(gbc.l(),  0xf4);
        EXPECT(gbc.sp(), 0x7328);
        EXPECT(gbc.pc(), 0x8cd6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8cd3), 0xd4);
        EXPECT(gbc.readMem(0x8cd4), 0x8);
        EXPECT(gbc.readMem(0x8cd5), 0x2a);
        // D4 03B4
        gbc.setState(0x91fd, 0xe9b6, 0x9c40, 0xf74d, 0x16b, 0xd7a9, 0x0, 0x1);
        gbc.writeMem(0x91fd, { 0xd4, 0x21, 0xb9 });
        gbc.writeMem(0xe9b4, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x9c);
        EXPECT(gbc.b(),  0xf7);
        EXPECT(gbc.c(),  0x4d);
        EXPECT(gbc.d(),  0x1);
        EXPECT(gbc.e(),  0x6b);
        EXPECT(gbc.h(),  0xd7);
        EXPECT(gbc.l(),  0xa9);
        EXPECT(gbc.sp(), 0xe9b4);
        EXPECT(gbc.pc(), 0xb921);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x91fd), 0xd4);
        EXPECT(gbc.readMem(0x91fe), 0x21);
        EXPECT(gbc.readMem(0x91ff), 0xb9);
        EXPECT(gbc.readMem(0xe9b4), 0x0);
        EXPECT(gbc.readMem(0xe9b5), 0x92);
        // D4 03B5
        gbc.setState(0x493, 0x92ce, 0x3270, 0xb167, 0x5943, 0xced2, 0x1, 0x0);
        gbc.writeMem(0x493, { 0xd4, 0x8c, 0xfa });
        gbc.step();
        EXPECT(gbc.a(),  0x32);
        EXPECT(gbc.b(),  0xb1);
        EXPECT(gbc.c(),  0x67);
        EXPECT(gbc.d(),  0x59);
        EXPECT(gbc.e(),  0x43);
        EXPECT(gbc.h(),  0xce);
        EXPECT(gbc.l(),  0xd2);
        EXPECT(gbc.sp(), 0x92ce);
        EXPECT(gbc.pc(), 0x496);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 03B6
        gbc.setState(0xe5fd, 0xd30a, 0x32e0, 0x566, 0xef4b, 0x8400, 0x0, 0x1);
        gbc.writeMem(0xd308, { 0x0, 0x0 });
        gbc.writeMem(0xe5fd, { 0xd4, 0xe1, 0xbb });
        gbc.step();
        EXPECT(gbc.a(),  0x32);
        EXPECT(gbc.b(),  0x5);
        EXPECT(gbc.c(),  0x66);
        EXPECT(gbc.d(),  0xef);
        EXPECT(gbc.e(),  0x4b);
        EXPECT(gbc.h(),  0x84);
        EXPECT(gbc.l(),  0x0);
        EXPECT(gbc.sp(), 0xd308);
        EXPECT(gbc.pc(), 0xbbe1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd308), 0x0);
        EXPECT(gbc.readMem(0xd309), 0xe6);
        EXPECT(gbc.readMem(0xe5fd), 0xd4);
        EXPECT(gbc.readMem(0xe5fe), 0xe1);
        EXPECT(gbc.readMem(0xe5ff), 0xbb);
        // D4 03B9
        gbc.setState(0x6add, 0xb93, 0xf570, 0x21a1, 0xda9e, 0x3118, 0x0, 0x0);
        gbc.writeMem(0x6add, { 0xd4, 0xba, 0x4f });
        gbc.step();
        EXPECT(gbc.a(),  0xf5);
        EXPECT(gbc.b(),  0x21);
        EXPECT(gbc.c(),  0xa1);
        EXPECT(gbc.d(),  0xda);
        EXPECT(gbc.e(),  0x9e);
        EXPECT(gbc.h(),  0x31);
        EXPECT(gbc.l(),  0x18);
        EXPECT(gbc.sp(), 0xb93);
        EXPECT(gbc.pc(), 0x6ae0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 03BA
        gbc.setState(0x62d, 0x90eb, 0x8b70, 0x2f4f, 0x31a1, 0x9888, 0x1, 0x1);
        gbc.writeMem(0x62d, { 0xd4, 0x88, 0x9b });
        gbc.step();
        EXPECT(gbc.a(),  0x8b);
        EXPECT(gbc.b(),  0x2f);
        EXPECT(gbc.c(),  0x4f);
        EXPECT(gbc.d(),  0x31);
        EXPECT(gbc.e(),  0xa1);
        EXPECT(gbc.h(),  0x98);
        EXPECT(gbc.l(),  0x88);
        EXPECT(gbc.sp(), 0x90eb);
        EXPECT(gbc.pc(), 0x630);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 03BB
        gbc.setState(0x5001, 0xf6d2, 0x29d0, 0x7741, 0x8f2f, 0x30f2, 0x0, 0x1);
        gbc.writeMem(0x5001, { 0xd4, 0x91, 0x18 });
        gbc.step();
        EXPECT(gbc.a(),  0x29);
        EXPECT(gbc.b(),  0x77);
        EXPECT(gbc.c(),  0x41);
        EXPECT(gbc.d(),  0x8f);
        EXPECT(gbc.e(),  0x2f);
        EXPECT(gbc.h(),  0x30);
        EXPECT(gbc.l(),  0xf2);
        EXPECT(gbc.sp(), 0xf6d2);
        EXPECT(gbc.pc(), 0x5004);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 03BC
        gbc.setState(0x4047, 0x6d78, 0x2eb0, 0x51de, 0x34a6, 0xa991, 0x0, 0x1);
        gbc.writeMem(0x4047, { 0xd4, 0x96, 0x65 });
        gbc.step();
        EXPECT(gbc.a(),  0x2e);
        EXPECT(gbc.b(),  0x51);
        EXPECT(gbc.c(),  0xde);
        EXPECT(gbc.d(),  0x34);
        EXPECT(gbc.e(),  0xa6);
        EXPECT(gbc.h(),  0xa9);
        EXPECT(gbc.l(),  0x91);
        EXPECT(gbc.sp(), 0x6d78);
        EXPECT(gbc.pc(), 0x404a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 03BD
        gbc.setState(0x28a4, 0x696d, 0x8af0, 0x5275, 0x2382, 0xa578, 0x0, 0x0);
        gbc.writeMem(0x28a4, { 0xd4, 0xfc, 0x64 });
        gbc.step();
        EXPECT(gbc.a(),  0x8a);
        EXPECT(gbc.b(),  0x52);
        EXPECT(gbc.c(),  0x75);
        EXPECT(gbc.d(),  0x23);
        EXPECT(gbc.e(),  0x82);
        EXPECT(gbc.h(),  0xa5);
        EXPECT(gbc.l(),  0x78);
        EXPECT(gbc.sp(), 0x696d);
        EXPECT(gbc.pc(), 0x28a7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 03BE
        gbc.setState(0x7d96, 0x3458, 0x69b0, 0x6454, 0x98ef, 0xbe6a, 0x1, 0x0);
        gbc.writeMem(0x7d96, { 0xd4, 0x2, 0xb });
        gbc.step();
        EXPECT(gbc.a(),  0x69);
        EXPECT(gbc.b(),  0x64);
        EXPECT(gbc.c(),  0x54);
        EXPECT(gbc.d(),  0x98);
        EXPECT(gbc.e(),  0xef);
        EXPECT(gbc.h(),  0xbe);
        EXPECT(gbc.l(),  0x6a);
        EXPECT(gbc.sp(), 0x3458);
        EXPECT(gbc.pc(), 0x7d99);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 03C0
        gbc.setState(0x4981, 0x8ff3, 0xb1d0, 0x1d8f, 0x29a, 0xe8e6, 0x1, 0x0);
        gbc.writeMem(0x4981, { 0xd4, 0x46, 0x50 });
        gbc.step();
        EXPECT(gbc.a(),  0xb1);
        EXPECT(gbc.b(),  0x1d);
        EXPECT(gbc.c(),  0x8f);
        EXPECT(gbc.d(),  0x2);
        EXPECT(gbc.e(),  0x9a);
        EXPECT(gbc.h(),  0xe8);
        EXPECT(gbc.l(),  0xe6);
        EXPECT(gbc.sp(), 0x8ff3);
        EXPECT(gbc.pc(), 0x4984);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 03C1
        gbc.setState(0xded2, 0xaec4, 0x2660, 0x2610, 0x5768, 0x383b, 0x1, 0x1);
        gbc.writeMem(0xaec2, { 0x0, 0x0 });
        gbc.writeMem(0xded2, { 0xd4, 0x69, 0x44 });
        gbc.step();
        EXPECT(gbc.a(),  0x26);
        EXPECT(gbc.b(),  0x26);
        EXPECT(gbc.c(),  0x10);
        EXPECT(gbc.d(),  0x57);
        EXPECT(gbc.e(),  0x68);
        EXPECT(gbc.h(),  0x38);
        EXPECT(gbc.l(),  0x3b);
        EXPECT(gbc.sp(), 0xaec2);
        EXPECT(gbc.pc(), 0x4469);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xaec2), 0xd5);
        EXPECT(gbc.readMem(0xaec3), 0xde);
        EXPECT(gbc.readMem(0xded2), 0xd4);
        EXPECT(gbc.readMem(0xded3), 0x69);
        EXPECT(gbc.readMem(0xded4), 0x44);
        // D4 03C2
        gbc.setState(0x12fb, 0x36f4, 0x3830, 0x75ce, 0xdbcc, 0x2f7, 0x0, 0x1);
        gbc.writeMem(0x12fb, { 0xd4, 0x47, 0x64 });
        gbc.step();
        EXPECT(gbc.a(),  0x38);
        EXPECT(gbc.b(),  0x75);
        EXPECT(gbc.c(),  0xce);
        EXPECT(gbc.d(),  0xdb);
        EXPECT(gbc.e(),  0xcc);
        EXPECT(gbc.h(),  0x2);
        EXPECT(gbc.l(),  0xf7);
        EXPECT(gbc.sp(), 0x36f4);
        EXPECT(gbc.pc(), 0x12fe);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 03C3
        gbc.setState(0x73e0, 0x34b3, 0x7d70, 0xae7e, 0xa56a, 0x151a, 0x0, 0x0);
        gbc.writeMem(0x73e0, { 0xd4, 0x40, 0x53 });
        gbc.step();
        EXPECT(gbc.a(),  0x7d);
        EXPECT(gbc.b(),  0xae);
        EXPECT(gbc.c(),  0x7e);
        EXPECT(gbc.d(),  0xa5);
        EXPECT(gbc.e(),  0x6a);
        EXPECT(gbc.h(),  0x15);
        EXPECT(gbc.l(),  0x1a);
        EXPECT(gbc.sp(), 0x34b3);
        EXPECT(gbc.pc(), 0x73e3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 03C5
        gbc.setState(0x6a4f, 0x7b85, 0x5530, 0x7475, 0xd199, 0x71f9, 0x1, 0x1);
        gbc.writeMem(0x6a4f, { 0xd4, 0xf4, 0x43 });
        gbc.step();
        EXPECT(gbc.a(),  0x55);
        EXPECT(gbc.b(),  0x74);
        EXPECT(gbc.c(),  0x75);
        EXPECT(gbc.d(),  0xd1);
        EXPECT(gbc.e(),  0x99);
        EXPECT(gbc.h(),  0x71);
        EXPECT(gbc.l(),  0xf9);
        EXPECT(gbc.sp(), 0x7b85);
        EXPECT(gbc.pc(), 0x6a52);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 03C6
        gbc.setState(0xb167, 0xd4e8, 0x5750, 0x4333, 0x630e, 0x9676, 0x0, 0x0);
        gbc.writeMem(0xb167, { 0xd4, 0x77, 0xcd });
        gbc.step();
        EXPECT(gbc.a(),  0x57);
        EXPECT(gbc.b(),  0x43);
        EXPECT(gbc.c(),  0x33);
        EXPECT(gbc.d(),  0x63);
        EXPECT(gbc.e(),  0xe);
        EXPECT(gbc.h(),  0x96);
        EXPECT(gbc.l(),  0x76);
        EXPECT(gbc.sp(), 0xd4e8);
        EXPECT(gbc.pc(), 0xb16a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb167), 0xd4);
        EXPECT(gbc.readMem(0xb168), 0x77);
        EXPECT(gbc.readMem(0xb169), 0xcd);
        // D4 03C7
        gbc.setState(0x1ca0, 0x3997, 0x1810, 0xc603, 0xf4c6, 0x21ea, 0x1, 0x0);
        gbc.writeMem(0x1ca0, { 0xd4, 0x68, 0x69 });
        gbc.step();
        EXPECT(gbc.a(),  0x18);
        EXPECT(gbc.b(),  0xc6);
        EXPECT(gbc.c(),  0x3);
        EXPECT(gbc.d(),  0xf4);
        EXPECT(gbc.e(),  0xc6);
        EXPECT(gbc.h(),  0x21);
        EXPECT(gbc.l(),  0xea);
        EXPECT(gbc.sp(), 0x3997);
        EXPECT(gbc.pc(), 0x1ca3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // D4 03C8
        gbc.setState(0x760e, 0x2918, 0xd570, 0x3dcc, 0xe379, 0x1797, 0x0, 0x0);
        gbc.writeMem(0x760e, { 0xd4, 0x66, 0xde });
        gbc.step();
        EXPECT(gbc.a(),  0xd5);
        EXPECT(gbc.b(),  0x3d);
        EXPECT(gbc.c(),  0xcc);
        EXPECT(gbc.d(),  0xe3);
        EXPECT(gbc.e(),  0x79);
        EXPECT(gbc.h(),  0x17);
        EXPECT(gbc.l(),  0x97);
        EXPECT(gbc.sp(), 0x2918);
        EXPECT(gbc.pc(), 0x7611);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 03CA
        gbc.setState(0xa8bb, 0xc4a7, 0xe7e0, 0x8dab, 0xfe08, 0x94c7, 0x0, 0x0);
        gbc.writeMem(0xa8bb, { 0xd4, 0xa0, 0x2f });
        gbc.writeMem(0xc4a5, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0xe7);
        EXPECT(gbc.b(),  0x8d);
        EXPECT(gbc.c(),  0xab);
        EXPECT(gbc.d(),  0xfe);
        EXPECT(gbc.e(),  0x8);
        EXPECT(gbc.h(),  0x94);
        EXPECT(gbc.l(),  0xc7);
        EXPECT(gbc.sp(), 0xc4a5);
        EXPECT(gbc.pc(), 0x2fa0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa8bb), 0xd4);
        EXPECT(gbc.readMem(0xa8bc), 0xa0);
        EXPECT(gbc.readMem(0xa8bd), 0x2f);
        EXPECT(gbc.readMem(0xc4a5), 0xbe);
        EXPECT(gbc.readMem(0xc4a6), 0xa8);
        // D4 03CB
        gbc.setState(0x5e53, 0xfad5, 0x9d60, 0x73f2, 0x15f4, 0xc073, 0x1, 0x0);
        gbc.writeMem(0x5e53, { 0xd4, 0xe0, 0x8e });
        gbc.writeMem(0xfad3, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x9d);
        EXPECT(gbc.b(),  0x73);
        EXPECT(gbc.c(),  0xf2);
        EXPECT(gbc.d(),  0x15);
        EXPECT(gbc.e(),  0xf4);
        EXPECT(gbc.h(),  0xc0);
        EXPECT(gbc.l(),  0x73);
        EXPECT(gbc.sp(), 0xfad3);
        EXPECT(gbc.pc(), 0x8ee0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xfad3), 0x56);
        EXPECT(gbc.readMem(0xfad4), 0x5e);
        // D4 03CC
        gbc.setState(0xec28, 0x2f0, 0xead0, 0xeede, 0x369, 0xe4a9, 0x1, 0x1);
        gbc.writeMem(0xec28, { 0xd4, 0x66, 0x14 });
        gbc.step();
        EXPECT(gbc.a(),  0xea);
        EXPECT(gbc.b(),  0xee);
        EXPECT(gbc.c(),  0xde);
        EXPECT(gbc.d(),  0x3);
        EXPECT(gbc.e(),  0x69);
        EXPECT(gbc.h(),  0xe4);
        EXPECT(gbc.l(),  0xa9);
        EXPECT(gbc.sp(), 0x2f0);
        EXPECT(gbc.pc(), 0xec2b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xec28), 0xd4);
        EXPECT(gbc.readMem(0xec29), 0x66);
        EXPECT(gbc.readMem(0xec2a), 0x14);
        // D4 03D0
        gbc.setState(0x192c, 0x846b, 0x8a0, 0x706a, 0xf1ea, 0xb2, 0x1, 0x0);
        gbc.writeMem(0x192c, { 0xd4, 0xe4, 0xef });
        gbc.writeMem(0x8469, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0x70);
        EXPECT(gbc.c(),  0x6a);
        EXPECT(gbc.d(),  0xf1);
        EXPECT(gbc.e(),  0xea);
        EXPECT(gbc.h(),  0x0);
        EXPECT(gbc.l(),  0xb2);
        EXPECT(gbc.sp(), 0x8469);
        EXPECT(gbc.pc(), 0xefe4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8469), 0x2f);
        EXPECT(gbc.readMem(0x846a), 0x19);
        // D4 03D1
        gbc.setState(0xc58c, 0xc2ff, 0x9c90, 0xfe44, 0xbd48, 0xdcc, 0x1, 0x0);
        gbc.writeMem(0xc58c, { 0xd4, 0x21, 0xf4 });
        gbc.step();
        EXPECT(gbc.a(),  0x9c);
        EXPECT(gbc.b(),  0xfe);
        EXPECT(gbc.c(),  0x44);
        EXPECT(gbc.d(),  0xbd);
        EXPECT(gbc.e(),  0x48);
        EXPECT(gbc.h(),  0xd);
        EXPECT(gbc.l(),  0xcc);
        EXPECT(gbc.sp(), 0xc2ff);
        EXPECT(gbc.pc(), 0xc58f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc58c), 0xd4);
        EXPECT(gbc.readMem(0xc58d), 0x21);
        EXPECT(gbc.readMem(0xc58e), 0xf4);
        // D4 03D2
        gbc.setState(0x8190, 0xeab5, 0xe70, 0x46cf, 0x449b, 0x2c6c, 0x1, 0x1);
        gbc.writeMem(0x8190, { 0xd4, 0x63, 0x36 });
        gbc.step();
        EXPECT(gbc.a(),  0xe);
        EXPECT(gbc.b(),  0x46);
        EXPECT(gbc.c(),  0xcf);
        EXPECT(gbc.d(),  0x44);
        EXPECT(gbc.e(),  0x9b);
        EXPECT(gbc.h(),  0x2c);
        EXPECT(gbc.l(),  0x6c);
        EXPECT(gbc.sp(), 0xeab5);
        EXPECT(gbc.pc(), 0x8193);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8190), 0xd4);
        EXPECT(gbc.readMem(0x8191), 0x63);
        EXPECT(gbc.readMem(0x8192), 0x36);
        // D4 03D3
        gbc.setState(0x77dc, 0x82b8, 0xacf0, 0x51f9, 0xa1de, 0x252f, 0x0, 0x1);
        gbc.writeMem(0x77dc, { 0xd4, 0x74, 0x8f });
        gbc.step();
        EXPECT(gbc.a(),  0xac);
        EXPECT(gbc.b(),  0x51);
        EXPECT(gbc.c(),  0xf9);
        EXPECT(gbc.d(),  0xa1);
        EXPECT(gbc.e(),  0xde);
        EXPECT(gbc.h(),  0x25);
        EXPECT(gbc.l(),  0x2f);
        EXPECT(gbc.sp(), 0x82b8);
        EXPECT(gbc.pc(), 0x77df);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 03D6
        gbc.setState(0x97d7, 0x2143, 0x3d30, 0x188e, 0x458c, 0xf2e9, 0x0, 0x0);
        gbc.writeMem(0x97d7, { 0xd4, 0xd5, 0x9d });
        gbc.step();
        EXPECT(gbc.a(),  0x3d);
        EXPECT(gbc.b(),  0x18);
        EXPECT(gbc.c(),  0x8e);
        EXPECT(gbc.d(),  0x45);
        EXPECT(gbc.e(),  0x8c);
        EXPECT(gbc.h(),  0xf2);
        EXPECT(gbc.l(),  0xe9);
        EXPECT(gbc.sp(), 0x2143);
        EXPECT(gbc.pc(), 0x97da);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x97d7), 0xd4);
        EXPECT(gbc.readMem(0x97d8), 0xd5);
        EXPECT(gbc.readMem(0x97d9), 0x9d);
        // D4 03D7
        gbc.setState(0x6c39, 0xa94, 0x5170, 0x76e8, 0xab82, 0xa1f7, 0x0, 0x1);
        gbc.writeMem(0x6c39, { 0xd4, 0x9e, 0xb2 });
        gbc.step();
        EXPECT(gbc.a(),  0x51);
        EXPECT(gbc.b(),  0x76);
        EXPECT(gbc.c(),  0xe8);
        EXPECT(gbc.d(),  0xab);
        EXPECT(gbc.e(),  0x82);
        EXPECT(gbc.h(),  0xa1);
        EXPECT(gbc.l(),  0xf7);
        EXPECT(gbc.sp(), 0xa94);
        EXPECT(gbc.pc(), 0x6c3c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 03DA
        gbc.setState(0x137b, 0x3096, 0xb2b0, 0xa125, 0xda74, 0x4dbf, 0x1, 0x1);
        gbc.writeMem(0x137b, { 0xd4, 0x98, 0xb });
        gbc.step();
        EXPECT(gbc.a(),  0xb2);
        EXPECT(gbc.b(),  0xa1);
        EXPECT(gbc.c(),  0x25);
        EXPECT(gbc.d(),  0xda);
        EXPECT(gbc.e(),  0x74);
        EXPECT(gbc.h(),  0x4d);
        EXPECT(gbc.l(),  0xbf);
        EXPECT(gbc.sp(), 0x3096);
        EXPECT(gbc.pc(), 0x137e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 03DB
        gbc.setState(0x8b05, 0x1c02, 0x12b0, 0x145c, 0xc7e0, 0x1270, 0x1, 0x1);
        gbc.writeMem(0x8b05, { 0xd4, 0x32, 0x9b });
        gbc.step();
        EXPECT(gbc.a(),  0x12);
        EXPECT(gbc.b(),  0x14);
        EXPECT(gbc.c(),  0x5c);
        EXPECT(gbc.d(),  0xc7);
        EXPECT(gbc.e(),  0xe0);
        EXPECT(gbc.h(),  0x12);
        EXPECT(gbc.l(),  0x70);
        EXPECT(gbc.sp(), 0x1c02);
        EXPECT(gbc.pc(), 0x8b08);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8b05), 0xd4);
        EXPECT(gbc.readMem(0x8b06), 0x32);
        EXPECT(gbc.readMem(0x8b07), 0x9b);
        // D4 03DC
        gbc.setState(0xca3b, 0x37f, 0x9050, 0x4254, 0x965f, 0xa3e6, 0x0, 0x1);
        gbc.writeMem(0xca3b, { 0xd4, 0xa0, 0x99 });
        gbc.step();
        EXPECT(gbc.a(),  0x90);
        EXPECT(gbc.b(),  0x42);
        EXPECT(gbc.c(),  0x54);
        EXPECT(gbc.d(),  0x96);
        EXPECT(gbc.e(),  0x5f);
        EXPECT(gbc.h(),  0xa3);
        EXPECT(gbc.l(),  0xe6);
        EXPECT(gbc.sp(), 0x37f);
        EXPECT(gbc.pc(), 0xca3e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xca3b), 0xd4);
        EXPECT(gbc.readMem(0xca3c), 0xa0);
        EXPECT(gbc.readMem(0xca3d), 0x99);
        // D4 03DD
        gbc.setState(0xd80f, 0x1d90, 0x2f30, 0xb801, 0x227b, 0x7aac, 0x1, 0x0);
        gbc.writeMem(0xd80f, { 0xd4, 0x4d, 0x33 });
        gbc.step();
        EXPECT(gbc.a(),  0x2f);
        EXPECT(gbc.b(),  0xb8);
        EXPECT(gbc.c(),  0x1);
        EXPECT(gbc.d(),  0x22);
        EXPECT(gbc.e(),  0x7b);
        EXPECT(gbc.h(),  0x7a);
        EXPECT(gbc.l(),  0xac);
        EXPECT(gbc.sp(), 0x1d90);
        EXPECT(gbc.pc(), 0xd812);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd80f), 0xd4);
        EXPECT(gbc.readMem(0xd810), 0x4d);
        EXPECT(gbc.readMem(0xd811), 0x33);
        // D4 03DE
        gbc.setState(0xd717, 0x4c04, 0x2450, 0xce78, 0x527b, 0xcd08, 0x0, 0x0);
        gbc.writeMem(0xd717, { 0xd4, 0xd8, 0x1b });
        gbc.step();
        EXPECT(gbc.a(),  0x24);
        EXPECT(gbc.b(),  0xce);
        EXPECT(gbc.c(),  0x78);
        EXPECT(gbc.d(),  0x52);
        EXPECT(gbc.e(),  0x7b);
        EXPECT(gbc.h(),  0xcd);
        EXPECT(gbc.l(),  0x8);
        EXPECT(gbc.sp(), 0x4c04);
        EXPECT(gbc.pc(), 0xd71a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd717), 0xd4);
        EXPECT(gbc.readMem(0xd718), 0xd8);
        EXPECT(gbc.readMem(0xd719), 0x1b);
        // D4 03DF
        gbc.setState(0xa2c5, 0x3fcb, 0x1c30, 0x2455, 0xb931, 0xbdc6, 0x1, 0x1);
        gbc.writeMem(0xa2c5, { 0xd4, 0x4, 0x9f });
        gbc.step();
        EXPECT(gbc.a(),  0x1c);
        EXPECT(gbc.b(),  0x24);
        EXPECT(gbc.c(),  0x55);
        EXPECT(gbc.d(),  0xb9);
        EXPECT(gbc.e(),  0x31);
        EXPECT(gbc.h(),  0xbd);
        EXPECT(gbc.l(),  0xc6);
        EXPECT(gbc.sp(), 0x3fcb);
        EXPECT(gbc.pc(), 0xa2c8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa2c5), 0xd4);
        EXPECT(gbc.readMem(0xa2c6), 0x4);
        EXPECT(gbc.readMem(0xa2c7), 0x9f);
        // D4 03E2
        gbc.setState(0x165d, 0x2056, 0xd130, 0x8c42, 0x4ef0, 0xfd96, 0x0, 0x0);
        gbc.writeMem(0x165d, { 0xd4, 0xed, 0x3f });
        gbc.step();
        EXPECT(gbc.a(),  0xd1);
        EXPECT(gbc.b(),  0x8c);
        EXPECT(gbc.c(),  0x42);
        EXPECT(gbc.d(),  0x4e);
        EXPECT(gbc.e(),  0xf0);
        EXPECT(gbc.h(),  0xfd);
        EXPECT(gbc.l(),  0x96);
        EXPECT(gbc.sp(), 0x2056);
        EXPECT(gbc.pc(), 0x1660);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // D4 03E3
        gbc.setState(0xc290, 0x8b47, 0xb360, 0x9e8c, 0xa17f, 0x9060, 0x1, 0x0);
        gbc.writeMem(0x8b45, { 0x0, 0x0 });
        gbc.writeMem(0xc290, { 0xd4, 0xc5, 0x71 });
        gbc.step();
        EXPECT(gbc.a(),  0xb3);
        EXPECT(gbc.b(),  0x9e);
        EXPECT(gbc.c(),  0x8c);
        EXPECT(gbc.d(),  0xa1);
        EXPECT(gbc.e(),  0x7f);
        EXPECT(gbc.h(),  0x90);
        EXPECT(gbc.l(),  0x60);
        EXPECT(gbc.sp(), 0x8b45);
        EXPECT(gbc.pc(), 0x71c5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8b45), 0x93);
        EXPECT(gbc.readMem(0x8b46), 0xc2);
        EXPECT(gbc.readMem(0xc290), 0xd4);
        EXPECT(gbc.readMem(0xc291), 0xc5);
        EXPECT(gbc.readMem(0xc292), 0x71);
        // D4 03E6
        gbc.setState(0x35c8, 0xaf24, 0x2fc0, 0x486c, 0x6579, 0xe4cf, 0x1, 0x1);
        gbc.writeMem(0x35c8, { 0xd4, 0x80, 0xe6 });
        gbc.writeMem(0xaf22, { 0x0, 0x0 });
        gbc.step();
        EXPECT(gbc.a(),  0x2f);
        EXPECT(gbc.b(),  0x48);
        EXPECT(gbc.c(),  0x6c);
        EXPECT(gbc.d(),  0x65);
        EXPECT(gbc.e(),  0x79);
        EXPECT(gbc.h(),  0xe4);
        EXPECT(gbc.l(),  0xcf);
        EXPECT(gbc.sp(), 0xaf22);
        EXPECT(gbc.pc(), 0xe680);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xaf22), 0xcb);
        EXPECT(gbc.readMem(0xaf23), 0x35);
        // D4 03E7
        gbc.setState(0x4e12, 0x1a56, 0x9e90, 0xf323, 0xe367, 0xd9e5, 0x0, 0x1);
        gbc.writeMem(0x4e12, { 0xd4, 0xc1, 0xad });
        gbc.step();
        EXPECT(gbc.a(),  0x9e);
        EXPECT(gbc.b(),  0xf3);
        EXPECT(gbc.c(),  0x23);
        EXPECT(gbc.d(),  0xe3);
        EXPECT(gbc.e(),  0x67);
        EXPECT(gbc.h(),  0xd9);
        EXPECT(gbc.l(),  0xe5);
        EXPECT(gbc.sp(), 0x1a56);
        EXPECT(gbc.pc(), 0x4e15);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  false);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
    }
