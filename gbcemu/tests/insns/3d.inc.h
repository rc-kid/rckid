    TEST(gbcemu, opcode_3d) {
        GBCEmu gbc{};
        uint8_t cartridge[0x8000];
        cartridge[0x149] = 0x02; // 8kb external RAM
        gbc.loadCartridge(new FlashGamePak(cartridge));
        // 3D 0000
        gbc.setState(0x416e, 0x2abd, 0x5af0, 0xf19d, 0x9550, 0x57db, 0x1, 0x1);
        gbc.writeMem(0x416e, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x59);
        EXPECT(gbc.b(),  0xf1);
        EXPECT(gbc.c(),  0x9d);
        EXPECT(gbc.d(),  0x95);
        EXPECT(gbc.e(),  0x50);
        EXPECT(gbc.h(),  0x57);
        EXPECT(gbc.l(),  0xdb);
        EXPECT(gbc.sp(), 0x2abd);
        EXPECT(gbc.pc(), 0x416f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0001
        gbc.setState(0xee5, 0x5361, 0xec70, 0x61ed, 0xda2b, 0x9d22, 0x1, 0x1);
        gbc.writeMem(0xee5, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xeb);
        EXPECT(gbc.b(),  0x61);
        EXPECT(gbc.c(),  0xed);
        EXPECT(gbc.d(),  0xda);
        EXPECT(gbc.e(),  0x2b);
        EXPECT(gbc.h(),  0x9d);
        EXPECT(gbc.l(),  0x22);
        EXPECT(gbc.sp(), 0x5361);
        EXPECT(gbc.pc(), 0xee6);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0002
        gbc.setState(0x547a, 0xe697, 0x57d0, 0x7f0, 0x5a19, 0x8323, 0x1, 0x1);
        gbc.writeMem(0x547a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x56);
        EXPECT(gbc.b(),  0x7);
        EXPECT(gbc.c(),  0xf0);
        EXPECT(gbc.d(),  0x5a);
        EXPECT(gbc.e(),  0x19);
        EXPECT(gbc.h(),  0x83);
        EXPECT(gbc.l(),  0x23);
        EXPECT(gbc.sp(), 0xe697);
        EXPECT(gbc.pc(), 0x547b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0003
        gbc.setState(0x4955, 0x4f76, 0xe690, 0xc977, 0xb967, 0xa7f4, 0x1, 0x1);
        gbc.writeMem(0x4955, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xe5);
        EXPECT(gbc.b(),  0xc9);
        EXPECT(gbc.c(),  0x77);
        EXPECT(gbc.d(),  0xb9);
        EXPECT(gbc.e(),  0x67);
        EXPECT(gbc.h(),  0xa7);
        EXPECT(gbc.l(),  0xf4);
        EXPECT(gbc.sp(), 0x4f76);
        EXPECT(gbc.pc(), 0x4956);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0004
        gbc.setState(0x6860, 0x3800, 0x64d0, 0x20a0, 0x89dd, 0x47ac, 0x0, 0x1);
        gbc.writeMem(0x6860, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x63);
        EXPECT(gbc.b(),  0x20);
        EXPECT(gbc.c(),  0xa0);
        EXPECT(gbc.d(),  0x89);
        EXPECT(gbc.e(),  0xdd);
        EXPECT(gbc.h(),  0x47);
        EXPECT(gbc.l(),  0xac);
        EXPECT(gbc.sp(), 0x3800);
        EXPECT(gbc.pc(), 0x6861);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0005
        gbc.setState(0x27c2, 0x5019, 0xedb0, 0xcee4, 0x8693, 0x7a18, 0x0, 0x1);
        gbc.writeMem(0x27c2, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xec);
        EXPECT(gbc.b(),  0xce);
        EXPECT(gbc.c(),  0xe4);
        EXPECT(gbc.d(),  0x86);
        EXPECT(gbc.e(),  0x93);
        EXPECT(gbc.h(),  0x7a);
        EXPECT(gbc.l(),  0x18);
        EXPECT(gbc.sp(), 0x5019);
        EXPECT(gbc.pc(), 0x27c3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0006
        gbc.setState(0xd61f, 0x3a0b, 0x3c90, 0xc539, 0xe9ad, 0x2511, 0x0, 0x1);
        gbc.writeMem(0xd61f, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x3b);
        EXPECT(gbc.b(),  0xc5);
        EXPECT(gbc.c(),  0x39);
        EXPECT(gbc.d(),  0xe9);
        EXPECT(gbc.e(),  0xad);
        EXPECT(gbc.h(),  0x25);
        EXPECT(gbc.l(),  0x11);
        EXPECT(gbc.sp(), 0x3a0b);
        EXPECT(gbc.pc(), 0xd620);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd61f), 0x3d);
        // 3D 0007
        gbc.setState(0xa988, 0xc26f, 0xcf40, 0x3609, 0x341a, 0xba49, 0x0, 0x1);
        gbc.writeMem(0xa988, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xce);
        EXPECT(gbc.b(),  0x36);
        EXPECT(gbc.c(),  0x9);
        EXPECT(gbc.d(),  0x34);
        EXPECT(gbc.e(),  0x1a);
        EXPECT(gbc.h(),  0xba);
        EXPECT(gbc.l(),  0x49);
        EXPECT(gbc.sp(), 0xc26f);
        EXPECT(gbc.pc(), 0xa989);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa988), 0x3d);
        // 3D 0008
        gbc.setState(0x6a68, 0xd8af, 0x1a80, 0xdb02, 0x1daf, 0xb49e, 0x1, 0x0);
        gbc.writeMem(0x6a68, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x19);
        EXPECT(gbc.b(),  0xdb);
        EXPECT(gbc.c(),  0x2);
        EXPECT(gbc.d(),  0x1d);
        EXPECT(gbc.e(),  0xaf);
        EXPECT(gbc.h(),  0xb4);
        EXPECT(gbc.l(),  0x9e);
        EXPECT(gbc.sp(), 0xd8af);
        EXPECT(gbc.pc(), 0x6a69);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0009
        gbc.setState(0xc43a, 0x1326, 0x6b90, 0x116d, 0xcdb6, 0xec48, 0x0, 0x0);
        gbc.writeMem(0xc43a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x6a);
        EXPECT(gbc.b(),  0x11);
        EXPECT(gbc.c(),  0x6d);
        EXPECT(gbc.d(),  0xcd);
        EXPECT(gbc.e(),  0xb6);
        EXPECT(gbc.h(),  0xec);
        EXPECT(gbc.l(),  0x48);
        EXPECT(gbc.sp(), 0x1326);
        EXPECT(gbc.pc(), 0xc43b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc43a), 0x3d);
        // 3D 000A
        gbc.setState(0x9e98, 0xc1f4, 0x1b80, 0x1955, 0x3781, 0x4f05, 0x1, 0x1);
        gbc.writeMem(0x9e98, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x1a);
        EXPECT(gbc.b(),  0x19);
        EXPECT(gbc.c(),  0x55);
        EXPECT(gbc.d(),  0x37);
        EXPECT(gbc.e(),  0x81);
        EXPECT(gbc.h(),  0x4f);
        EXPECT(gbc.l(),  0x5);
        EXPECT(gbc.sp(), 0xc1f4);
        EXPECT(gbc.pc(), 0x9e99);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9e98), 0x3d);
        // 3D 000B
        gbc.setState(0x35a7, 0x4a5c, 0xa880, 0x8678, 0xc70e, 0x9b56, 0x1, 0x1);
        gbc.writeMem(0x35a7, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa7);
        EXPECT(gbc.b(),  0x86);
        EXPECT(gbc.c(),  0x78);
        EXPECT(gbc.d(),  0xc7);
        EXPECT(gbc.e(),  0xe);
        EXPECT(gbc.h(),  0x9b);
        EXPECT(gbc.l(),  0x56);
        EXPECT(gbc.sp(), 0x4a5c);
        EXPECT(gbc.pc(), 0x35a8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 000C
        gbc.setState(0x7c71, 0x2395, 0x14b0, 0xf3cf, 0x9ee5, 0xcdfb, 0x1, 0x1);
        gbc.writeMem(0x7c71, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x13);
        EXPECT(gbc.b(),  0xf3);
        EXPECT(gbc.c(),  0xcf);
        EXPECT(gbc.d(),  0x9e);
        EXPECT(gbc.e(),  0xe5);
        EXPECT(gbc.h(),  0xcd);
        EXPECT(gbc.l(),  0xfb);
        EXPECT(gbc.sp(), 0x2395);
        EXPECT(gbc.pc(), 0x7c72);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 000D
        gbc.setState(0xd755, 0x9222, 0x8770, 0x9e7c, 0x3627, 0xc5e1, 0x0, 0x1);
        gbc.writeMem(0xd755, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x86);
        EXPECT(gbc.b(),  0x9e);
        EXPECT(gbc.c(),  0x7c);
        EXPECT(gbc.d(),  0x36);
        EXPECT(gbc.e(),  0x27);
        EXPECT(gbc.h(),  0xc5);
        EXPECT(gbc.l(),  0xe1);
        EXPECT(gbc.sp(), 0x9222);
        EXPECT(gbc.pc(), 0xd756);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd755), 0x3d);
        // 3D 000E
        gbc.setState(0xc376, 0x8891, 0xf860, 0x71e6, 0xb57, 0x3d41, 0x0, 0x1);
        gbc.writeMem(0xc376, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf7);
        EXPECT(gbc.b(),  0x71);
        EXPECT(gbc.c(),  0xe6);
        EXPECT(gbc.d(),  0xb);
        EXPECT(gbc.e(),  0x57);
        EXPECT(gbc.h(),  0x3d);
        EXPECT(gbc.l(),  0x41);
        EXPECT(gbc.sp(), 0x8891);
        EXPECT(gbc.pc(), 0xc377);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc376), 0x3d);
        // 3D 000F
        gbc.setState(0x8429, 0x5b22, 0xf840, 0x5b6b, 0xeff2, 0x5a14, 0x1, 0x0);
        gbc.writeMem(0x8429, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf7);
        EXPECT(gbc.b(),  0x5b);
        EXPECT(gbc.c(),  0x6b);
        EXPECT(gbc.d(),  0xef);
        EXPECT(gbc.e(),  0xf2);
        EXPECT(gbc.h(),  0x5a);
        EXPECT(gbc.l(),  0x14);
        EXPECT(gbc.sp(), 0x5b22);
        EXPECT(gbc.pc(), 0x842a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8429), 0x3d);
        // 3D 0010
        gbc.setState(0x9807, 0xd903, 0xf980, 0x344, 0xd60e, 0x15c4, 0x0, 0x0);
        gbc.writeMem(0x9807, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf8);
        EXPECT(gbc.b(),  0x3);
        EXPECT(gbc.c(),  0x44);
        EXPECT(gbc.d(),  0xd6);
        EXPECT(gbc.e(),  0xe);
        EXPECT(gbc.h(),  0x15);
        EXPECT(gbc.l(),  0xc4);
        EXPECT(gbc.sp(), 0xd903);
        EXPECT(gbc.pc(), 0x9808);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9807), 0x3d);
        // 3D 0011
        gbc.setState(0x9be1, 0x5d7b, 0x4880, 0xed49, 0xbed0, 0x9ea2, 0x1, 0x1);
        gbc.writeMem(0x9be1, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x47);
        EXPECT(gbc.b(),  0xed);
        EXPECT(gbc.c(),  0x49);
        EXPECT(gbc.d(),  0xbe);
        EXPECT(gbc.e(),  0xd0);
        EXPECT(gbc.h(),  0x9e);
        EXPECT(gbc.l(),  0xa2);
        EXPECT(gbc.sp(), 0x5d7b);
        EXPECT(gbc.pc(), 0x9be2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9be1), 0x3d);
        // 3D 0012
        gbc.setState(0xda44, 0x711, 0x1080, 0xefa8, 0x9da2, 0xfc54, 0x1, 0x1);
        gbc.writeMem(0xda44, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf);
        EXPECT(gbc.b(),  0xef);
        EXPECT(gbc.c(),  0xa8);
        EXPECT(gbc.d(),  0x9d);
        EXPECT(gbc.e(),  0xa2);
        EXPECT(gbc.h(),  0xfc);
        EXPECT(gbc.l(),  0x54);
        EXPECT(gbc.sp(), 0x711);
        EXPECT(gbc.pc(), 0xda45);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xda44), 0x3d);
        // 3D 0013
        gbc.setState(0xd58b, 0x66fe, 0xd7a0, 0xc2f1, 0x6f55, 0x7383, 0x0, 0x0);
        gbc.writeMem(0xd58b, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xd6);
        EXPECT(gbc.b(),  0xc2);
        EXPECT(gbc.c(),  0xf1);
        EXPECT(gbc.d(),  0x6f);
        EXPECT(gbc.e(),  0x55);
        EXPECT(gbc.h(),  0x73);
        EXPECT(gbc.l(),  0x83);
        EXPECT(gbc.sp(), 0x66fe);
        EXPECT(gbc.pc(), 0xd58c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd58b), 0x3d);
        // 3D 0014
        gbc.setState(0xe266, 0x56b8, 0xc010, 0xf6f6, 0x565e, 0x7473, 0x1, 0x1);
        gbc.writeMem(0xe266, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xbf);
        EXPECT(gbc.b(),  0xf6);
        EXPECT(gbc.c(),  0xf6);
        EXPECT(gbc.d(),  0x56);
        EXPECT(gbc.e(),  0x5e);
        EXPECT(gbc.h(),  0x74);
        EXPECT(gbc.l(),  0x73);
        EXPECT(gbc.sp(), 0x56b8);
        EXPECT(gbc.pc(), 0xe267);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe266), 0x3d);
        // 3D 0015
        gbc.setState(0x6d53, 0x478f, 0x9b70, 0xa50c, 0xea6a, 0x4749, 0x0, 0x1);
        gbc.writeMem(0x6d53, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x9a);
        EXPECT(gbc.b(),  0xa5);
        EXPECT(gbc.c(),  0xc);
        EXPECT(gbc.d(),  0xea);
        EXPECT(gbc.e(),  0x6a);
        EXPECT(gbc.h(),  0x47);
        EXPECT(gbc.l(),  0x49);
        EXPECT(gbc.sp(), 0x478f);
        EXPECT(gbc.pc(), 0x6d54);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0016
        gbc.setState(0x7046, 0xfc8c, 0xff90, 0x9b1a, 0x7ad5, 0x4467, 0x1, 0x1);
        gbc.writeMem(0x7046, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xfe);
        EXPECT(gbc.b(),  0x9b);
        EXPECT(gbc.c(),  0x1a);
        EXPECT(gbc.d(),  0x7a);
        EXPECT(gbc.e(),  0xd5);
        EXPECT(gbc.h(),  0x44);
        EXPECT(gbc.l(),  0x67);
        EXPECT(gbc.sp(), 0xfc8c);
        EXPECT(gbc.pc(), 0x7047);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0017
        gbc.setState(0xe12a, 0x500d, 0x27e0, 0xa5fa, 0x441e, 0xe13, 0x1, 0x0);
        gbc.writeMem(0xe12a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x26);
        EXPECT(gbc.b(),  0xa5);
        EXPECT(gbc.c(),  0xfa);
        EXPECT(gbc.d(),  0x44);
        EXPECT(gbc.e(),  0x1e);
        EXPECT(gbc.h(),  0xe);
        EXPECT(gbc.l(),  0x13);
        EXPECT(gbc.sp(), 0x500d);
        EXPECT(gbc.pc(), 0xe12b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe12a), 0x3d);
        // 3D 0018
        gbc.setState(0x556f, 0xdb49, 0x8d20, 0xd8cc, 0xb00f, 0x5441, 0x0, 0x0);
        gbc.writeMem(0x556f, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x8c);
        EXPECT(gbc.b(),  0xd8);
        EXPECT(gbc.c(),  0xcc);
        EXPECT(gbc.d(),  0xb0);
        EXPECT(gbc.e(),  0xf);
        EXPECT(gbc.h(),  0x54);
        EXPECT(gbc.l(),  0x41);
        EXPECT(gbc.sp(), 0xdb49);
        EXPECT(gbc.pc(), 0x5570);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0019
        gbc.setState(0xcb5e, 0x2e44, 0x51c0, 0x21da, 0x1ae3, 0x7983, 0x0, 0x1);
        gbc.writeMem(0xcb5e, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x50);
        EXPECT(gbc.b(),  0x21);
        EXPECT(gbc.c(),  0xda);
        EXPECT(gbc.d(),  0x1a);
        EXPECT(gbc.e(),  0xe3);
        EXPECT(gbc.h(),  0x79);
        EXPECT(gbc.l(),  0x83);
        EXPECT(gbc.sp(), 0x2e44);
        EXPECT(gbc.pc(), 0xcb5f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcb5e), 0x3d);
        // 3D 001A
        gbc.setState(0xdb3c, 0xb891, 0xf8d0, 0x99b7, 0x3a55, 0xe6a, 0x1, 0x0);
        gbc.writeMem(0xdb3c, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf7);
        EXPECT(gbc.b(),  0x99);
        EXPECT(gbc.c(),  0xb7);
        EXPECT(gbc.d(),  0x3a);
        EXPECT(gbc.e(),  0x55);
        EXPECT(gbc.h(),  0xe);
        EXPECT(gbc.l(),  0x6a);
        EXPECT(gbc.sp(), 0xb891);
        EXPECT(gbc.pc(), 0xdb3d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xdb3c), 0x3d);
        // 3D 001B
        gbc.setState(0xef3d, 0xe0de, 0x9260, 0xd168, 0xacda, 0xf27b, 0x0, 0x1);
        gbc.writeMem(0xef3d, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x91);
        EXPECT(gbc.b(),  0xd1);
        EXPECT(gbc.c(),  0x68);
        EXPECT(gbc.d(),  0xac);
        EXPECT(gbc.e(),  0xda);
        EXPECT(gbc.h(),  0xf2);
        EXPECT(gbc.l(),  0x7b);
        EXPECT(gbc.sp(), 0xe0de);
        EXPECT(gbc.pc(), 0xef3e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xef3d), 0x3d);
        // 3D 001C
        gbc.setState(0x827f, 0xb8c6, 0xfa80, 0x200f, 0x137b, 0x4d84, 0x0, 0x0);
        gbc.writeMem(0x827f, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf9);
        EXPECT(gbc.b(),  0x20);
        EXPECT(gbc.c(),  0xf);
        EXPECT(gbc.d(),  0x13);
        EXPECT(gbc.e(),  0x7b);
        EXPECT(gbc.h(),  0x4d);
        EXPECT(gbc.l(),  0x84);
        EXPECT(gbc.sp(), 0xb8c6);
        EXPECT(gbc.pc(), 0x8280);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x827f), 0x3d);
        // 3D 001D
        gbc.setState(0x5ad5, 0x6adc, 0xb3a0, 0x6719, 0x74d6, 0xf0ae, 0x1, 0x1);
        gbc.writeMem(0x5ad5, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xb2);
        EXPECT(gbc.b(),  0x67);
        EXPECT(gbc.c(),  0x19);
        EXPECT(gbc.d(),  0x74);
        EXPECT(gbc.e(),  0xd6);
        EXPECT(gbc.h(),  0xf0);
        EXPECT(gbc.l(),  0xae);
        EXPECT(gbc.sp(), 0x6adc);
        EXPECT(gbc.pc(), 0x5ad6);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 001F
        gbc.setState(0x6da, 0x1381, 0xbe30, 0x2091, 0x8703, 0x6a2a, 0x1, 0x0);
        gbc.writeMem(0x6da, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xbd);
        EXPECT(gbc.b(),  0x20);
        EXPECT(gbc.c(),  0x91);
        EXPECT(gbc.d(),  0x87);
        EXPECT(gbc.e(),  0x3);
        EXPECT(gbc.h(),  0x6a);
        EXPECT(gbc.l(),  0x2a);
        EXPECT(gbc.sp(), 0x1381);
        EXPECT(gbc.pc(), 0x6db);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0020
        gbc.setState(0x64, 0x151c, 0x6a30, 0xc26a, 0x208b, 0xc877, 0x0, 0x1);
        gbc.writeMem(0x64, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x69);
        EXPECT(gbc.b(),  0xc2);
        EXPECT(gbc.c(),  0x6a);
        EXPECT(gbc.d(),  0x20);
        EXPECT(gbc.e(),  0x8b);
        EXPECT(gbc.h(),  0xc8);
        EXPECT(gbc.l(),  0x77);
        EXPECT(gbc.sp(), 0x151c);
        EXPECT(gbc.pc(), 0x65);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0021
        gbc.setState(0x9e78, 0x86a9, 0xf640, 0xb35e, 0x1f05, 0x1239, 0x0, 0x0);
        gbc.writeMem(0x9e78, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf5);
        EXPECT(gbc.b(),  0xb3);
        EXPECT(gbc.c(),  0x5e);
        EXPECT(gbc.d(),  0x1f);
        EXPECT(gbc.e(),  0x5);
        EXPECT(gbc.h(),  0x12);
        EXPECT(gbc.l(),  0x39);
        EXPECT(gbc.sp(), 0x86a9);
        EXPECT(gbc.pc(), 0x9e79);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9e78), 0x3d);
        // 3D 0022
        gbc.setState(0xade8, 0xbe6d, 0x7a20, 0x5e23, 0xb281, 0x43c3, 0x1, 0x1);
        gbc.writeMem(0xade8, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x79);
        EXPECT(gbc.b(),  0x5e);
        EXPECT(gbc.c(),  0x23);
        EXPECT(gbc.d(),  0xb2);
        EXPECT(gbc.e(),  0x81);
        EXPECT(gbc.h(),  0x43);
        EXPECT(gbc.l(),  0xc3);
        EXPECT(gbc.sp(), 0xbe6d);
        EXPECT(gbc.pc(), 0xade9);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xade8), 0x3d);
        // 3D 0024
        gbc.setState(0xc30a, 0xed82, 0x4c30, 0x9c4a, 0x3404, 0x352e, 0x1, 0x0);
        gbc.writeMem(0xc30a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x4b);
        EXPECT(gbc.b(),  0x9c);
        EXPECT(gbc.c(),  0x4a);
        EXPECT(gbc.d(),  0x34);
        EXPECT(gbc.e(),  0x4);
        EXPECT(gbc.h(),  0x35);
        EXPECT(gbc.l(),  0x2e);
        EXPECT(gbc.sp(), 0xed82);
        EXPECT(gbc.pc(), 0xc30b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc30a), 0x3d);
        // 3D 0025
        gbc.setState(0xa504, 0x62e5, 0x4f50, 0xa40b, 0x5652, 0x2233, 0x0, 0x0);
        gbc.writeMem(0xa504, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x4e);
        EXPECT(gbc.b(),  0xa4);
        EXPECT(gbc.c(),  0xb);
        EXPECT(gbc.d(),  0x56);
        EXPECT(gbc.e(),  0x52);
        EXPECT(gbc.h(),  0x22);
        EXPECT(gbc.l(),  0x33);
        EXPECT(gbc.sp(), 0x62e5);
        EXPECT(gbc.pc(), 0xa505);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa504), 0x3d);
        // 3D 0026
        gbc.setState(0x7f5a, 0x3a73, 0x80a0, 0x85f4, 0xf431, 0x70fc, 0x1, 0x0);
        gbc.writeMem(0x7f5a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x7f);
        EXPECT(gbc.b(),  0x85);
        EXPECT(gbc.c(),  0xf4);
        EXPECT(gbc.d(),  0xf4);
        EXPECT(gbc.e(),  0x31);
        EXPECT(gbc.h(),  0x70);
        EXPECT(gbc.l(),  0xfc);
        EXPECT(gbc.sp(), 0x3a73);
        EXPECT(gbc.pc(), 0x7f5b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 3D 0027
        gbc.setState(0xcd33, 0xd5a4, 0x9890, 0x2972, 0x7a9, 0x7455, 0x1, 0x1);
        gbc.writeMem(0xcd33, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x97);
        EXPECT(gbc.b(),  0x29);
        EXPECT(gbc.c(),  0x72);
        EXPECT(gbc.d(),  0x7);
        EXPECT(gbc.e(),  0xa9);
        EXPECT(gbc.h(),  0x74);
        EXPECT(gbc.l(),  0x55);
        EXPECT(gbc.sp(), 0xd5a4);
        EXPECT(gbc.pc(), 0xcd34);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcd33), 0x3d);
        // 3D 0028
        gbc.setState(0x3d5, 0x44c9, 0x2470, 0x96a8, 0x36c, 0xaa68, 0x1, 0x0);
        gbc.writeMem(0x3d5, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x23);
        EXPECT(gbc.b(),  0x96);
        EXPECT(gbc.c(),  0xa8);
        EXPECT(gbc.d(),  0x3);
        EXPECT(gbc.e(),  0x6c);
        EXPECT(gbc.h(),  0xaa);
        EXPECT(gbc.l(),  0x68);
        EXPECT(gbc.sp(), 0x44c9);
        EXPECT(gbc.pc(), 0x3d6);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0029
        gbc.setState(0x5ed3, 0xa4d7, 0x8000, 0x5413, 0x73f6, 0x1a1e, 0x0, 0x1);
        gbc.writeMem(0x5ed3, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x7f);
        EXPECT(gbc.b(),  0x54);
        EXPECT(gbc.c(),  0x13);
        EXPECT(gbc.d(),  0x73);
        EXPECT(gbc.e(),  0xf6);
        EXPECT(gbc.h(),  0x1a);
        EXPECT(gbc.l(),  0x1e);
        EXPECT(gbc.sp(), 0xa4d7);
        EXPECT(gbc.pc(), 0x5ed4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 3D 002A
        gbc.setState(0x24e4, 0x5386, 0xa3e0, 0xc70f, 0xde96, 0x8d3b, 0x0, 0x0);
        gbc.writeMem(0x24e4, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa2);
        EXPECT(gbc.b(),  0xc7);
        EXPECT(gbc.c(),  0xf);
        EXPECT(gbc.d(),  0xde);
        EXPECT(gbc.e(),  0x96);
        EXPECT(gbc.h(),  0x8d);
        EXPECT(gbc.l(),  0x3b);
        EXPECT(gbc.sp(), 0x5386);
        EXPECT(gbc.pc(), 0x24e5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 002B
        gbc.setState(0x4607, 0x919d, 0xa3e0, 0x4cd8, 0xf328, 0x7eee, 0x1, 0x0);
        gbc.writeMem(0x4607, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa2);
        EXPECT(gbc.b(),  0x4c);
        EXPECT(gbc.c(),  0xd8);
        EXPECT(gbc.d(),  0xf3);
        EXPECT(gbc.e(),  0x28);
        EXPECT(gbc.h(),  0x7e);
        EXPECT(gbc.l(),  0xee);
        EXPECT(gbc.sp(), 0x919d);
        EXPECT(gbc.pc(), 0x4608);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 002C
        gbc.setState(0xa9a0, 0x4497, 0x97d0, 0x15f1, 0x8606, 0x5183, 0x0, 0x0);
        gbc.writeMem(0xa9a0, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x96);
        EXPECT(gbc.b(),  0x15);
        EXPECT(gbc.c(),  0xf1);
        EXPECT(gbc.d(),  0x86);
        EXPECT(gbc.e(),  0x6);
        EXPECT(gbc.h(),  0x51);
        EXPECT(gbc.l(),  0x83);
        EXPECT(gbc.sp(), 0x4497);
        EXPECT(gbc.pc(), 0xa9a1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa9a0), 0x3d);
        // 3D 002D
        gbc.setState(0x6f22, 0x352f, 0x6c20, 0x6d0b, 0x4ac8, 0xc2e1, 0x0, 0x0);
        gbc.writeMem(0x6f22, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x6b);
        EXPECT(gbc.b(),  0x6d);
        EXPECT(gbc.c(),  0xb);
        EXPECT(gbc.d(),  0x4a);
        EXPECT(gbc.e(),  0xc8);
        EXPECT(gbc.h(),  0xc2);
        EXPECT(gbc.l(),  0xe1);
        EXPECT(gbc.sp(), 0x352f);
        EXPECT(gbc.pc(), 0x6f23);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 002E
        gbc.setState(0xd0ae, 0x558a, 0xff60, 0x43fe, 0x9c48, 0xf666, 0x0, 0x0);
        gbc.writeMem(0xd0ae, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xfe);
        EXPECT(gbc.b(),  0x43);
        EXPECT(gbc.c(),  0xfe);
        EXPECT(gbc.d(),  0x9c);
        EXPECT(gbc.e(),  0x48);
        EXPECT(gbc.h(),  0xf6);
        EXPECT(gbc.l(),  0x66);
        EXPECT(gbc.sp(), 0x558a);
        EXPECT(gbc.pc(), 0xd0af);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd0ae), 0x3d);
        // 3D 0030
        gbc.setState(0x60de, 0x2afb, 0x4980, 0x417b, 0x4830, 0xeb6e, 0x0, 0x1);
        gbc.writeMem(0x60de, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x48);
        EXPECT(gbc.b(),  0x41);
        EXPECT(gbc.c(),  0x7b);
        EXPECT(gbc.d(),  0x48);
        EXPECT(gbc.e(),  0x30);
        EXPECT(gbc.h(),  0xeb);
        EXPECT(gbc.l(),  0x6e);
        EXPECT(gbc.sp(), 0x2afb);
        EXPECT(gbc.pc(), 0x60df);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0031
        gbc.setState(0x12cb, 0x4e6b, 0x1000, 0x8115, 0x5c28, 0x656b, 0x0, 0x1);
        gbc.writeMem(0x12cb, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf);
        EXPECT(gbc.b(),  0x81);
        EXPECT(gbc.c(),  0x15);
        EXPECT(gbc.d(),  0x5c);
        EXPECT(gbc.e(),  0x28);
        EXPECT(gbc.h(),  0x65);
        EXPECT(gbc.l(),  0x6b);
        EXPECT(gbc.sp(), 0x4e6b);
        EXPECT(gbc.pc(), 0x12cc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 3D 0032
        gbc.setState(0x3efb, 0xde75, 0x4a50, 0x24cb, 0xceb4, 0x464c, 0x1, 0x0);
        gbc.writeMem(0x3efb, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x49);
        EXPECT(gbc.b(),  0x24);
        EXPECT(gbc.c(),  0xcb);
        EXPECT(gbc.d(),  0xce);
        EXPECT(gbc.e(),  0xb4);
        EXPECT(gbc.h(),  0x46);
        EXPECT(gbc.l(),  0x4c);
        EXPECT(gbc.sp(), 0xde75);
        EXPECT(gbc.pc(), 0x3efc);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0033
        gbc.setState(0x70b1, 0xc280, 0x5900, 0x9d0f, 0xc599, 0x50d9, 0x0, 0x0);
        gbc.writeMem(0x70b1, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x58);
        EXPECT(gbc.b(),  0x9d);
        EXPECT(gbc.c(),  0xf);
        EXPECT(gbc.d(),  0xc5);
        EXPECT(gbc.e(),  0x99);
        EXPECT(gbc.h(),  0x50);
        EXPECT(gbc.l(),  0xd9);
        EXPECT(gbc.sp(), 0xc280);
        EXPECT(gbc.pc(), 0x70b2);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0034
        gbc.setState(0xe567, 0x5c8b, 0x820, 0x3789, 0x3b79, 0xf8d9, 0x0, 0x0);
        gbc.writeMem(0xe567, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x7);
        EXPECT(gbc.b(),  0x37);
        EXPECT(gbc.c(),  0x89);
        EXPECT(gbc.d(),  0x3b);
        EXPECT(gbc.e(),  0x79);
        EXPECT(gbc.h(),  0xf8);
        EXPECT(gbc.l(),  0xd9);
        EXPECT(gbc.sp(), 0x5c8b);
        EXPECT(gbc.pc(), 0xe568);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe567), 0x3d);
        // 3D 0035
        gbc.setState(0xd5ac, 0xdd52, 0x2ca0, 0x131, 0xaae5, 0x6ab3, 0x1, 0x0);
        gbc.writeMem(0xd5ac, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x2b);
        EXPECT(gbc.b(),  0x1);
        EXPECT(gbc.c(),  0x31);
        EXPECT(gbc.d(),  0xaa);
        EXPECT(gbc.e(),  0xe5);
        EXPECT(gbc.h(),  0x6a);
        EXPECT(gbc.l(),  0xb3);
        EXPECT(gbc.sp(), 0xdd52);
        EXPECT(gbc.pc(), 0xd5ad);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd5ac), 0x3d);
        // 3D 0036
        gbc.setState(0xbdf3, 0x17bc, 0xdc10, 0xc6df, 0x7d40, 0xb003, 0x0, 0x0);
        gbc.writeMem(0xbdf3, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xdb);
        EXPECT(gbc.b(),  0xc6);
        EXPECT(gbc.c(),  0xdf);
        EXPECT(gbc.d(),  0x7d);
        EXPECT(gbc.e(),  0x40);
        EXPECT(gbc.h(),  0xb0);
        EXPECT(gbc.l(),  0x3);
        EXPECT(gbc.sp(), 0x17bc);
        EXPECT(gbc.pc(), 0xbdf4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbdf3), 0x3d);
        // 3D 0037
        gbc.setState(0xbc, 0xd7f3, 0x8c60, 0x86ca, 0x1974, 0xd0a6, 0x0, 0x0);
        gbc.writeMem(0xbc, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x8b);
        EXPECT(gbc.b(),  0x86);
        EXPECT(gbc.c(),  0xca);
        EXPECT(gbc.d(),  0x19);
        EXPECT(gbc.e(),  0x74);
        EXPECT(gbc.h(),  0xd0);
        EXPECT(gbc.l(),  0xa6);
        EXPECT(gbc.sp(), 0xd7f3);
        EXPECT(gbc.pc(), 0xbd);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0039
        gbc.setState(0xe171, 0xb4dc, 0xad0, 0x3555, 0x4e19, 0x229c, 0x1, 0x0);
        gbc.writeMem(0xe171, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x9);
        EXPECT(gbc.b(),  0x35);
        EXPECT(gbc.c(),  0x55);
        EXPECT(gbc.d(),  0x4e);
        EXPECT(gbc.e(),  0x19);
        EXPECT(gbc.h(),  0x22);
        EXPECT(gbc.l(),  0x9c);
        EXPECT(gbc.sp(), 0xb4dc);
        EXPECT(gbc.pc(), 0xe172);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe171), 0x3d);
        // 3D 003A
        gbc.setState(0x6763, 0x79d9, 0x1b20, 0xb0b8, 0x1599, 0xc25c, 0x1, 0x0);
        gbc.writeMem(0x6763, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x1a);
        EXPECT(gbc.b(),  0xb0);
        EXPECT(gbc.c(),  0xb8);
        EXPECT(gbc.d(),  0x15);
        EXPECT(gbc.e(),  0x99);
        EXPECT(gbc.h(),  0xc2);
        EXPECT(gbc.l(),  0x5c);
        EXPECT(gbc.sp(), 0x79d9);
        EXPECT(gbc.pc(), 0x6764);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 003B
        gbc.setState(0x896d, 0x1abf, 0xb050, 0x69a0, 0xfcc0, 0xead6, 0x0, 0x1);
        gbc.writeMem(0x896d, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xaf);
        EXPECT(gbc.b(),  0x69);
        EXPECT(gbc.c(),  0xa0);
        EXPECT(gbc.d(),  0xfc);
        EXPECT(gbc.e(),  0xc0);
        EXPECT(gbc.h(),  0xea);
        EXPECT(gbc.l(),  0xd6);
        EXPECT(gbc.sp(), 0x1abf);
        EXPECT(gbc.pc(), 0x896e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x896d), 0x3d);
        // 3D 003C
        gbc.setState(0x7edc, 0x6339, 0x2440, 0xf328, 0xf169, 0x39a9, 0x0, 0x0);
        gbc.writeMem(0x7edc, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x23);
        EXPECT(gbc.b(),  0xf3);
        EXPECT(gbc.c(),  0x28);
        EXPECT(gbc.d(),  0xf1);
        EXPECT(gbc.e(),  0x69);
        EXPECT(gbc.h(),  0x39);
        EXPECT(gbc.l(),  0xa9);
        EXPECT(gbc.sp(), 0x6339);
        EXPECT(gbc.pc(), 0x7edd);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 003D
        gbc.setState(0x40d3, 0x927d, 0x2730, 0xa645, 0xe35d, 0x6ae0, 0x0, 0x0);
        gbc.writeMem(0x40d3, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x26);
        EXPECT(gbc.b(),  0xa6);
        EXPECT(gbc.c(),  0x45);
        EXPECT(gbc.d(),  0xe3);
        EXPECT(gbc.e(),  0x5d);
        EXPECT(gbc.h(),  0x6a);
        EXPECT(gbc.l(),  0xe0);
        EXPECT(gbc.sp(), 0x927d);
        EXPECT(gbc.pc(), 0x40d4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 003E
        gbc.setState(0x6c5, 0x7f98, 0xd670, 0x1abe, 0xd639, 0xb747, 0x1, 0x0);
        gbc.writeMem(0x6c5, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xd5);
        EXPECT(gbc.b(),  0x1a);
        EXPECT(gbc.c(),  0xbe);
        EXPECT(gbc.d(),  0xd6);
        EXPECT(gbc.e(),  0x39);
        EXPECT(gbc.h(),  0xb7);
        EXPECT(gbc.l(),  0x47);
        EXPECT(gbc.sp(), 0x7f98);
        EXPECT(gbc.pc(), 0x6c6);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 003F
        gbc.setState(0x1162, 0x21cd, 0xfc30, 0xf086, 0xe3d, 0x26f3, 0x1, 0x1);
        gbc.writeMem(0x1162, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xfb);
        EXPECT(gbc.b(),  0xf0);
        EXPECT(gbc.c(),  0x86);
        EXPECT(gbc.d(),  0xe);
        EXPECT(gbc.e(),  0x3d);
        EXPECT(gbc.h(),  0x26);
        EXPECT(gbc.l(),  0xf3);
        EXPECT(gbc.sp(), 0x21cd);
        EXPECT(gbc.pc(), 0x1163);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0040
        gbc.setState(0xe2fb, 0xde83, 0xacb0, 0x2a66, 0x6c10, 0x1629, 0x1, 0x0);
        gbc.writeMem(0xe2fb, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xab);
        EXPECT(gbc.b(),  0x2a);
        EXPECT(gbc.c(),  0x66);
        EXPECT(gbc.d(),  0x6c);
        EXPECT(gbc.e(),  0x10);
        EXPECT(gbc.h(),  0x16);
        EXPECT(gbc.l(),  0x29);
        EXPECT(gbc.sp(), 0xde83);
        EXPECT(gbc.pc(), 0xe2fc);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe2fb), 0x3d);
        // 3D 0041
        gbc.setState(0x3e94, 0xbd45, 0x8f50, 0x4345, 0x562c, 0x16ba, 0x1, 0x0);
        gbc.writeMem(0x3e94, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x8e);
        EXPECT(gbc.b(),  0x43);
        EXPECT(gbc.c(),  0x45);
        EXPECT(gbc.d(),  0x56);
        EXPECT(gbc.e(),  0x2c);
        EXPECT(gbc.h(),  0x16);
        EXPECT(gbc.l(),  0xba);
        EXPECT(gbc.sp(), 0xbd45);
        EXPECT(gbc.pc(), 0x3e95);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0042
        gbc.setState(0x43de, 0x31c3, 0x3170, 0xf4a2, 0x6fd3, 0xd710, 0x0, 0x1);
        gbc.writeMem(0x43de, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x30);
        EXPECT(gbc.b(),  0xf4);
        EXPECT(gbc.c(),  0xa2);
        EXPECT(gbc.d(),  0x6f);
        EXPECT(gbc.e(),  0xd3);
        EXPECT(gbc.h(),  0xd7);
        EXPECT(gbc.l(),  0x10);
        EXPECT(gbc.sp(), 0x31c3);
        EXPECT(gbc.pc(), 0x43df);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0043
        gbc.setState(0x95c5, 0x8b56, 0x330, 0xb669, 0x2a9e, 0x1384, 0x1, 0x0);
        gbc.writeMem(0x95c5, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0xb6);
        EXPECT(gbc.c(),  0x69);
        EXPECT(gbc.d(),  0x2a);
        EXPECT(gbc.e(),  0x9e);
        EXPECT(gbc.h(),  0x13);
        EXPECT(gbc.l(),  0x84);
        EXPECT(gbc.sp(), 0x8b56);
        EXPECT(gbc.pc(), 0x95c6);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x95c5), 0x3d);
        // 3D 0044
        gbc.setState(0x18b3, 0xe060, 0x1750, 0x1163, 0xbc6e, 0x9a29, 0x0, 0x0);
        gbc.writeMem(0x18b3, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x16);
        EXPECT(gbc.b(),  0x11);
        EXPECT(gbc.c(),  0x63);
        EXPECT(gbc.d(),  0xbc);
        EXPECT(gbc.e(),  0x6e);
        EXPECT(gbc.h(),  0x9a);
        EXPECT(gbc.l(),  0x29);
        EXPECT(gbc.sp(), 0xe060);
        EXPECT(gbc.pc(), 0x18b4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0045
        gbc.setState(0x6ba4, 0xbc28, 0x7860, 0xea2c, 0xb286, 0x5d62, 0x0, 0x0);
        gbc.writeMem(0x6ba4, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x77);
        EXPECT(gbc.b(),  0xea);
        EXPECT(gbc.c(),  0x2c);
        EXPECT(gbc.d(),  0xb2);
        EXPECT(gbc.e(),  0x86);
        EXPECT(gbc.h(),  0x5d);
        EXPECT(gbc.l(),  0x62);
        EXPECT(gbc.sp(), 0xbc28);
        EXPECT(gbc.pc(), 0x6ba5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0046
        gbc.setState(0xc927, 0x631b, 0x5de0, 0x5fd1, 0x15a2, 0x7f1d, 0x1, 0x0);
        gbc.writeMem(0xc927, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x5c);
        EXPECT(gbc.b(),  0x5f);
        EXPECT(gbc.c(),  0xd1);
        EXPECT(gbc.d(),  0x15);
        EXPECT(gbc.e(),  0xa2);
        EXPECT(gbc.h(),  0x7f);
        EXPECT(gbc.l(),  0x1d);
        EXPECT(gbc.sp(), 0x631b);
        EXPECT(gbc.pc(), 0xc928);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc927), 0x3d);
        // 3D 0047
        gbc.setState(0x2fae, 0xe0ec, 0x8380, 0x1d6, 0x8390, 0x95e2, 0x1, 0x1);
        gbc.writeMem(0x2fae, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x82);
        EXPECT(gbc.b(),  0x1);
        EXPECT(gbc.c(),  0xd6);
        EXPECT(gbc.d(),  0x83);
        EXPECT(gbc.e(),  0x90);
        EXPECT(gbc.h(),  0x95);
        EXPECT(gbc.l(),  0xe2);
        EXPECT(gbc.sp(), 0xe0ec);
        EXPECT(gbc.pc(), 0x2faf);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0048
        gbc.setState(0x9ba6, 0x7aa6, 0x3cf0, 0x7776, 0xba84, 0x75b, 0x0, 0x0);
        gbc.writeMem(0x9ba6, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x3b);
        EXPECT(gbc.b(),  0x77);
        EXPECT(gbc.c(),  0x76);
        EXPECT(gbc.d(),  0xba);
        EXPECT(gbc.e(),  0x84);
        EXPECT(gbc.h(),  0x7);
        EXPECT(gbc.l(),  0x5b);
        EXPECT(gbc.sp(), 0x7aa6);
        EXPECT(gbc.pc(), 0x9ba7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9ba6), 0x3d);
        // 3D 0049
        gbc.setState(0xac94, 0xb2bf, 0x6b0, 0x7d26, 0x4bee, 0x11d, 0x0, 0x0);
        gbc.writeMem(0xac94, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x5);
        EXPECT(gbc.b(),  0x7d);
        EXPECT(gbc.c(),  0x26);
        EXPECT(gbc.d(),  0x4b);
        EXPECT(gbc.e(),  0xee);
        EXPECT(gbc.h(),  0x1);
        EXPECT(gbc.l(),  0x1d);
        EXPECT(gbc.sp(), 0xb2bf);
        EXPECT(gbc.pc(), 0xac95);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xac94), 0x3d);
        // 3D 004A
        gbc.setState(0x8278, 0x3dc5, 0x4d40, 0x8183, 0xce99, 0xed7f, 0x1, 0x1);
        gbc.writeMem(0x8278, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x4c);
        EXPECT(gbc.b(),  0x81);
        EXPECT(gbc.c(),  0x83);
        EXPECT(gbc.d(),  0xce);
        EXPECT(gbc.e(),  0x99);
        EXPECT(gbc.h(),  0xed);
        EXPECT(gbc.l(),  0x7f);
        EXPECT(gbc.sp(), 0x3dc5);
        EXPECT(gbc.pc(), 0x8279);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8278), 0x3d);
        // 3D 004C
        gbc.setState(0x7dd5, 0x5e11, 0xbfc0, 0xe5e, 0xf4c8, 0xcfe0, 0x0, 0x0);
        gbc.writeMem(0x7dd5, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xbe);
        EXPECT(gbc.b(),  0xe);
        EXPECT(gbc.c(),  0x5e);
        EXPECT(gbc.d(),  0xf4);
        EXPECT(gbc.e(),  0xc8);
        EXPECT(gbc.h(),  0xcf);
        EXPECT(gbc.l(),  0xe0);
        EXPECT(gbc.sp(), 0x5e11);
        EXPECT(gbc.pc(), 0x7dd6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 004D
        gbc.setState(0xcb00, 0x2e70, 0x9890, 0x5fe, 0x2fc5, 0xa159, 0x1, 0x1);
        gbc.writeMem(0xcb00, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x97);
        EXPECT(gbc.b(),  0x5);
        EXPECT(gbc.c(),  0xfe);
        EXPECT(gbc.d(),  0x2f);
        EXPECT(gbc.e(),  0xc5);
        EXPECT(gbc.h(),  0xa1);
        EXPECT(gbc.l(),  0x59);
        EXPECT(gbc.sp(), 0x2e70);
        EXPECT(gbc.pc(), 0xcb01);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcb00), 0x3d);
        // 3D 004E
        gbc.setState(0x977, 0xc9b6, 0x9440, 0x940c, 0xadbf, 0xed81, 0x0, 0x1);
        gbc.writeMem(0x977, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x93);
        EXPECT(gbc.b(),  0x94);
        EXPECT(gbc.c(),  0xc);
        EXPECT(gbc.d(),  0xad);
        EXPECT(gbc.e(),  0xbf);
        EXPECT(gbc.h(),  0xed);
        EXPECT(gbc.l(),  0x81);
        EXPECT(gbc.sp(), 0xc9b6);
        EXPECT(gbc.pc(), 0x978);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 004F
        gbc.setState(0xc297, 0x907a, 0xc0f0, 0xdc8b, 0x650c, 0xd261, 0x1, 0x1);
        gbc.writeMem(0xc297, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xbf);
        EXPECT(gbc.b(),  0xdc);
        EXPECT(gbc.c(),  0x8b);
        EXPECT(gbc.d(),  0x65);
        EXPECT(gbc.e(),  0xc);
        EXPECT(gbc.h(),  0xd2);
        EXPECT(gbc.l(),  0x61);
        EXPECT(gbc.sp(), 0x907a);
        EXPECT(gbc.pc(), 0xc298);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc297), 0x3d);
        // 3D 0050
        gbc.setState(0xac2a, 0x5bb1, 0x8f50, 0x975d, 0x54ff, 0xe8f7, 0x1, 0x0);
        gbc.writeMem(0xac2a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x8e);
        EXPECT(gbc.b(),  0x97);
        EXPECT(gbc.c(),  0x5d);
        EXPECT(gbc.d(),  0x54);
        EXPECT(gbc.e(),  0xff);
        EXPECT(gbc.h(),  0xe8);
        EXPECT(gbc.l(),  0xf7);
        EXPECT(gbc.sp(), 0x5bb1);
        EXPECT(gbc.pc(), 0xac2b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xac2a), 0x3d);
        // 3D 0051
        gbc.setState(0xd971, 0x210d, 0x5300, 0x1062, 0x205d, 0xa625, 0x0, 0x1);
        gbc.writeMem(0xd971, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x52);
        EXPECT(gbc.b(),  0x10);
        EXPECT(gbc.c(),  0x62);
        EXPECT(gbc.d(),  0x20);
        EXPECT(gbc.e(),  0x5d);
        EXPECT(gbc.h(),  0xa6);
        EXPECT(gbc.l(),  0x25);
        EXPECT(gbc.sp(), 0x210d);
        EXPECT(gbc.pc(), 0xd972);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd971), 0x3d);
        // 3D 0052
        gbc.setState(0x9a8e, 0x4c70, 0x2d80, 0x86fa, 0xe759, 0x7e03, 0x0, 0x1);
        gbc.writeMem(0x9a8e, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x2c);
        EXPECT(gbc.b(),  0x86);
        EXPECT(gbc.c(),  0xfa);
        EXPECT(gbc.d(),  0xe7);
        EXPECT(gbc.e(),  0x59);
        EXPECT(gbc.h(),  0x7e);
        EXPECT(gbc.l(),  0x3);
        EXPECT(gbc.sp(), 0x4c70);
        EXPECT(gbc.pc(), 0x9a8f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9a8e), 0x3d);
        // 3D 0053
        gbc.setState(0x75fd, 0x94ea, 0x54d0, 0x8f8e, 0xbef, 0xc5e5, 0x0, 0x1);
        gbc.writeMem(0x75fd, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x53);
        EXPECT(gbc.b(),  0x8f);
        EXPECT(gbc.c(),  0x8e);
        EXPECT(gbc.d(),  0xb);
        EXPECT(gbc.e(),  0xef);
        EXPECT(gbc.h(),  0xc5);
        EXPECT(gbc.l(),  0xe5);
        EXPECT(gbc.sp(), 0x94ea);
        EXPECT(gbc.pc(), 0x75fe);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0054
        gbc.setState(0xd2f1, 0x2f37, 0x79a0, 0x57bd, 0xab0d, 0x92df, 0x0, 0x0);
        gbc.writeMem(0xd2f1, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x78);
        EXPECT(gbc.b(),  0x57);
        EXPECT(gbc.c(),  0xbd);
        EXPECT(gbc.d(),  0xab);
        EXPECT(gbc.e(),  0xd);
        EXPECT(gbc.h(),  0x92);
        EXPECT(gbc.l(),  0xdf);
        EXPECT(gbc.sp(), 0x2f37);
        EXPECT(gbc.pc(), 0xd2f2);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd2f1), 0x3d);
        // 3D 0055
        gbc.setState(0x351b, 0x564e, 0x10, 0xeba, 0xf3ac, 0xa204, 0x0, 0x0);
        gbc.writeMem(0x351b, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xff);
        EXPECT(gbc.b(),  0xe);
        EXPECT(gbc.c(),  0xba);
        EXPECT(gbc.d(),  0xf3);
        EXPECT(gbc.e(),  0xac);
        EXPECT(gbc.h(),  0xa2);
        EXPECT(gbc.l(),  0x4);
        EXPECT(gbc.sp(), 0x564e);
        EXPECT(gbc.pc(), 0x351c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 3D 0056
        gbc.setState(0x224b, 0x7ca2, 0x5110, 0xdf4d, 0xcb47, 0xe076, 0x0, 0x1);
        gbc.writeMem(0x224b, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x50);
        EXPECT(gbc.b(),  0xdf);
        EXPECT(gbc.c(),  0x4d);
        EXPECT(gbc.d(),  0xcb);
        EXPECT(gbc.e(),  0x47);
        EXPECT(gbc.h(),  0xe0);
        EXPECT(gbc.l(),  0x76);
        EXPECT(gbc.sp(), 0x7ca2);
        EXPECT(gbc.pc(), 0x224c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0057
        gbc.setState(0x66ba, 0x62ff, 0x9780, 0x1202, 0xbd8e, 0x9bb9, 0x0, 0x1);
        gbc.writeMem(0x66ba, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x96);
        EXPECT(gbc.b(),  0x12);
        EXPECT(gbc.c(),  0x2);
        EXPECT(gbc.d(),  0xbd);
        EXPECT(gbc.e(),  0x8e);
        EXPECT(gbc.h(),  0x9b);
        EXPECT(gbc.l(),  0xb9);
        EXPECT(gbc.sp(), 0x62ff);
        EXPECT(gbc.pc(), 0x66bb);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0058
        gbc.setState(0x364b, 0x870a, 0x1ee0, 0x7e7e, 0x7b67, 0x572f, 0x1, 0x1);
        gbc.writeMem(0x364b, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x1d);
        EXPECT(gbc.b(),  0x7e);
        EXPECT(gbc.c(),  0x7e);
        EXPECT(gbc.d(),  0x7b);
        EXPECT(gbc.e(),  0x67);
        EXPECT(gbc.h(),  0x57);
        EXPECT(gbc.l(),  0x2f);
        EXPECT(gbc.sp(), 0x870a);
        EXPECT(gbc.pc(), 0x364c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0059
        gbc.setState(0xdfa1, 0x793b, 0x2020, 0x15ff, 0xfe68, 0x5fe9, 0x1, 0x1);
        gbc.writeMem(0xdfa1, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x1f);
        EXPECT(gbc.b(),  0x15);
        EXPECT(gbc.c(),  0xff);
        EXPECT(gbc.d(),  0xfe);
        EXPECT(gbc.e(),  0x68);
        EXPECT(gbc.h(),  0x5f);
        EXPECT(gbc.l(),  0xe9);
        EXPECT(gbc.sp(), 0x793b);
        EXPECT(gbc.pc(), 0xdfa2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdfa1), 0x3d);
        // 3D 005A
        gbc.setState(0xb498, 0xac4, 0x4a50, 0xef85, 0xa628, 0x201d, 0x0, 0x0);
        gbc.writeMem(0xb498, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x49);
        EXPECT(gbc.b(),  0xef);
        EXPECT(gbc.c(),  0x85);
        EXPECT(gbc.d(),  0xa6);
        EXPECT(gbc.e(),  0x28);
        EXPECT(gbc.h(),  0x20);
        EXPECT(gbc.l(),  0x1d);
        EXPECT(gbc.sp(), 0xac4);
        EXPECT(gbc.pc(), 0xb499);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb498), 0x3d);
        // 3D 005B
        gbc.setState(0x3c1e, 0xe16d, 0x41e0, 0xe83f, 0xa1bf, 0x1021, 0x0, 0x0);
        gbc.writeMem(0x3c1e, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0xe8);
        EXPECT(gbc.c(),  0x3f);
        EXPECT(gbc.d(),  0xa1);
        EXPECT(gbc.e(),  0xbf);
        EXPECT(gbc.h(),  0x10);
        EXPECT(gbc.l(),  0x21);
        EXPECT(gbc.sp(), 0xe16d);
        EXPECT(gbc.pc(), 0x3c1f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 005C
        gbc.setState(0x4640, 0x601b, 0x18c0, 0xfb2d, 0x611d, 0x19e3, 0x0, 0x0);
        gbc.writeMem(0x4640, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x17);
        EXPECT(gbc.b(),  0xfb);
        EXPECT(gbc.c(),  0x2d);
        EXPECT(gbc.d(),  0x61);
        EXPECT(gbc.e(),  0x1d);
        EXPECT(gbc.h(),  0x19);
        EXPECT(gbc.l(),  0xe3);
        EXPECT(gbc.sp(), 0x601b);
        EXPECT(gbc.pc(), 0x4641);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 005D
        gbc.setState(0xac2f, 0xcb51, 0xb290, 0xc8bd, 0xf61f, 0xd9f6, 0x0, 0x1);
        gbc.writeMem(0xac2f, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xb1);
        EXPECT(gbc.b(),  0xc8);
        EXPECT(gbc.c(),  0xbd);
        EXPECT(gbc.d(),  0xf6);
        EXPECT(gbc.e(),  0x1f);
        EXPECT(gbc.h(),  0xd9);
        EXPECT(gbc.l(),  0xf6);
        EXPECT(gbc.sp(), 0xcb51);
        EXPECT(gbc.pc(), 0xac30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xac2f), 0x3d);
        // 3D 005E
        gbc.setState(0x3473, 0x69a8, 0x6620, 0x924, 0xc176, 0x495d, 0x1, 0x0);
        gbc.writeMem(0x3473, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x65);
        EXPECT(gbc.b(),  0x9);
        EXPECT(gbc.c(),  0x24);
        EXPECT(gbc.d(),  0xc1);
        EXPECT(gbc.e(),  0x76);
        EXPECT(gbc.h(),  0x49);
        EXPECT(gbc.l(),  0x5d);
        EXPECT(gbc.sp(), 0x69a8);
        EXPECT(gbc.pc(), 0x3474);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 005F
        gbc.setState(0x96ab, 0xf01d, 0xe660, 0x171f, 0xe9b2, 0x9040, 0x1, 0x0);
        gbc.writeMem(0x96ab, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xe5);
        EXPECT(gbc.b(),  0x17);
        EXPECT(gbc.c(),  0x1f);
        EXPECT(gbc.d(),  0xe9);
        EXPECT(gbc.e(),  0xb2);
        EXPECT(gbc.h(),  0x90);
        EXPECT(gbc.l(),  0x40);
        EXPECT(gbc.sp(), 0xf01d);
        EXPECT(gbc.pc(), 0x96ac);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x96ab), 0x3d);
        // 3D 0060
        gbc.setState(0xa605, 0x8ab1, 0xf300, 0x818b, 0xb355, 0x477d, 0x1, 0x0);
        gbc.writeMem(0xa605, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf2);
        EXPECT(gbc.b(),  0x81);
        EXPECT(gbc.c(),  0x8b);
        EXPECT(gbc.d(),  0xb3);
        EXPECT(gbc.e(),  0x55);
        EXPECT(gbc.h(),  0x47);
        EXPECT(gbc.l(),  0x7d);
        EXPECT(gbc.sp(), 0x8ab1);
        EXPECT(gbc.pc(), 0xa606);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa605), 0x3d);
        // 3D 0061
        gbc.setState(0x55e3, 0x1c6b, 0xbe00, 0x74fb, 0x89f6, 0xe7a7, 0x1, 0x1);
        gbc.writeMem(0x55e3, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xbd);
        EXPECT(gbc.b(),  0x74);
        EXPECT(gbc.c(),  0xfb);
        EXPECT(gbc.d(),  0x89);
        EXPECT(gbc.e(),  0xf6);
        EXPECT(gbc.h(),  0xe7);
        EXPECT(gbc.l(),  0xa7);
        EXPECT(gbc.sp(), 0x1c6b);
        EXPECT(gbc.pc(), 0x55e4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0062
        gbc.setState(0xc059, 0x37ac, 0x3fa0, 0xdfb5, 0x28a7, 0xaba9, 0x1, 0x1);
        gbc.writeMem(0xc059, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x3e);
        EXPECT(gbc.b(),  0xdf);
        EXPECT(gbc.c(),  0xb5);
        EXPECT(gbc.d(),  0x28);
        EXPECT(gbc.e(),  0xa7);
        EXPECT(gbc.h(),  0xab);
        EXPECT(gbc.l(),  0xa9);
        EXPECT(gbc.sp(), 0x37ac);
        EXPECT(gbc.pc(), 0xc05a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc059), 0x3d);
        // 3D 0063
        gbc.setState(0x4ccd, 0xbebd, 0x1eb0, 0xbf93, 0xcff9, 0x789b, 0x0, 0x1);
        gbc.writeMem(0x4ccd, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x1d);
        EXPECT(gbc.b(),  0xbf);
        EXPECT(gbc.c(),  0x93);
        EXPECT(gbc.d(),  0xcf);
        EXPECT(gbc.e(),  0xf9);
        EXPECT(gbc.h(),  0x78);
        EXPECT(gbc.l(),  0x9b);
        EXPECT(gbc.sp(), 0xbebd);
        EXPECT(gbc.pc(), 0x4cce);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0064
        gbc.setState(0x9b66, 0x9962, 0xd790, 0xdb8d, 0xf956, 0xb9ce, 0x1, 0x1);
        gbc.writeMem(0x9b66, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xd6);
        EXPECT(gbc.b(),  0xdb);
        EXPECT(gbc.c(),  0x8d);
        EXPECT(gbc.d(),  0xf9);
        EXPECT(gbc.e(),  0x56);
        EXPECT(gbc.h(),  0xb9);
        EXPECT(gbc.l(),  0xce);
        EXPECT(gbc.sp(), 0x9962);
        EXPECT(gbc.pc(), 0x9b67);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9b66), 0x3d);
        // 3D 0065
        gbc.setState(0x1ddc, 0x2ea3, 0x2680, 0xa4c1, 0xe8be, 0x377b, 0x0, 0x1);
        gbc.writeMem(0x1ddc, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x25);
        EXPECT(gbc.b(),  0xa4);
        EXPECT(gbc.c(),  0xc1);
        EXPECT(gbc.d(),  0xe8);
        EXPECT(gbc.e(),  0xbe);
        EXPECT(gbc.h(),  0x37);
        EXPECT(gbc.l(),  0x7b);
        EXPECT(gbc.sp(), 0x2ea3);
        EXPECT(gbc.pc(), 0x1ddd);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0066
        gbc.setState(0x44a6, 0x74cf, 0xe500, 0xca77, 0x3a4, 0xd016, 0x0, 0x0);
        gbc.writeMem(0x44a6, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xe4);
        EXPECT(gbc.b(),  0xca);
        EXPECT(gbc.c(),  0x77);
        EXPECT(gbc.d(),  0x3);
        EXPECT(gbc.e(),  0xa4);
        EXPECT(gbc.h(),  0xd0);
        EXPECT(gbc.l(),  0x16);
        EXPECT(gbc.sp(), 0x74cf);
        EXPECT(gbc.pc(), 0x44a7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0067
        gbc.setState(0x39dd, 0xaddc, 0xb430, 0x6570, 0x621, 0x3643, 0x0, 0x1);
        gbc.writeMem(0x39dd, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xb3);
        EXPECT(gbc.b(),  0x65);
        EXPECT(gbc.c(),  0x70);
        EXPECT(gbc.d(),  0x6);
        EXPECT(gbc.e(),  0x21);
        EXPECT(gbc.h(),  0x36);
        EXPECT(gbc.l(),  0x43);
        EXPECT(gbc.sp(), 0xaddc);
        EXPECT(gbc.pc(), 0x39de);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0068
        gbc.setState(0x2e45, 0x7ca6, 0x6440, 0x260, 0x8be5, 0x8d32, 0x0, 0x0);
        gbc.writeMem(0x2e45, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x63);
        EXPECT(gbc.b(),  0x2);
        EXPECT(gbc.c(),  0x60);
        EXPECT(gbc.d(),  0x8b);
        EXPECT(gbc.e(),  0xe5);
        EXPECT(gbc.h(),  0x8d);
        EXPECT(gbc.l(),  0x32);
        EXPECT(gbc.sp(), 0x7ca6);
        EXPECT(gbc.pc(), 0x2e46);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0069
        gbc.setState(0xa16d, 0x6129, 0xf180, 0x3519, 0x552e, 0xfdb7, 0x0, 0x0);
        gbc.writeMem(0xa16d, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf0);
        EXPECT(gbc.b(),  0x35);
        EXPECT(gbc.c(),  0x19);
        EXPECT(gbc.d(),  0x55);
        EXPECT(gbc.e(),  0x2e);
        EXPECT(gbc.h(),  0xfd);
        EXPECT(gbc.l(),  0xb7);
        EXPECT(gbc.sp(), 0x6129);
        EXPECT(gbc.pc(), 0xa16e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa16d), 0x3d);
        // 3D 006A
        gbc.setState(0xd011, 0x287c, 0x4010, 0xb95b, 0x71c1, 0x7218, 0x1, 0x0);
        gbc.writeMem(0xd011, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x3f);
        EXPECT(gbc.b(),  0xb9);
        EXPECT(gbc.c(),  0x5b);
        EXPECT(gbc.d(),  0x71);
        EXPECT(gbc.e(),  0xc1);
        EXPECT(gbc.h(),  0x72);
        EXPECT(gbc.l(),  0x18);
        EXPECT(gbc.sp(), 0x287c);
        EXPECT(gbc.pc(), 0xd012);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd011), 0x3d);
        // 3D 006B
        gbc.setState(0x17af, 0xb63f, 0xff70, 0xfd71, 0x41ae, 0x841, 0x1, 0x1);
        gbc.writeMem(0x17af, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xfe);
        EXPECT(gbc.b(),  0xfd);
        EXPECT(gbc.c(),  0x71);
        EXPECT(gbc.d(),  0x41);
        EXPECT(gbc.e(),  0xae);
        EXPECT(gbc.h(),  0x8);
        EXPECT(gbc.l(),  0x41);
        EXPECT(gbc.sp(), 0xb63f);
        EXPECT(gbc.pc(), 0x17b0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 006C
        gbc.setState(0xdd27, 0x2d73, 0xde30, 0x8779, 0xfd49, 0x114a, 0x0, 0x1);
        gbc.writeMem(0xdd27, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xdd);
        EXPECT(gbc.b(),  0x87);
        EXPECT(gbc.c(),  0x79);
        EXPECT(gbc.d(),  0xfd);
        EXPECT(gbc.e(),  0x49);
        EXPECT(gbc.h(),  0x11);
        EXPECT(gbc.l(),  0x4a);
        EXPECT(gbc.sp(), 0x2d73);
        EXPECT(gbc.pc(), 0xdd28);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xdd27), 0x3d);
        // 3D 006D
        gbc.setState(0x2848, 0xd8dd, 0x710, 0x9b4b, 0xcee7, 0x7a33, 0x0, 0x0);
        gbc.writeMem(0x2848, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x6);
        EXPECT(gbc.b(),  0x9b);
        EXPECT(gbc.c(),  0x4b);
        EXPECT(gbc.d(),  0xce);
        EXPECT(gbc.e(),  0xe7);
        EXPECT(gbc.h(),  0x7a);
        EXPECT(gbc.l(),  0x33);
        EXPECT(gbc.sp(), 0xd8dd);
        EXPECT(gbc.pc(), 0x2849);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 006E
        gbc.setState(0x3026, 0x4a97, 0x5dd0, 0x95b9, 0x5b70, 0x2851, 0x0, 0x1);
        gbc.writeMem(0x3026, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x5c);
        EXPECT(gbc.b(),  0x95);
        EXPECT(gbc.c(),  0xb9);
        EXPECT(gbc.d(),  0x5b);
        EXPECT(gbc.e(),  0x70);
        EXPECT(gbc.h(),  0x28);
        EXPECT(gbc.l(),  0x51);
        EXPECT(gbc.sp(), 0x4a97);
        EXPECT(gbc.pc(), 0x3027);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 006F
        gbc.setState(0x1b80, 0x11c2, 0x9670, 0x801f, 0x6232, 0x245, 0x0, 0x0);
        gbc.writeMem(0x1b80, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x95);
        EXPECT(gbc.b(),  0x80);
        EXPECT(gbc.c(),  0x1f);
        EXPECT(gbc.d(),  0x62);
        EXPECT(gbc.e(),  0x32);
        EXPECT(gbc.h(),  0x2);
        EXPECT(gbc.l(),  0x45);
        EXPECT(gbc.sp(), 0x11c2);
        EXPECT(gbc.pc(), 0x1b81);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0070
        gbc.setState(0xba80, 0x8c26, 0x1410, 0x342, 0x80a, 0x1347, 0x0, 0x0);
        gbc.writeMem(0xba80, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x13);
        EXPECT(gbc.b(),  0x3);
        EXPECT(gbc.c(),  0x42);
        EXPECT(gbc.d(),  0x8);
        EXPECT(gbc.e(),  0xa);
        EXPECT(gbc.h(),  0x13);
        EXPECT(gbc.l(),  0x47);
        EXPECT(gbc.sp(), 0x8c26);
        EXPECT(gbc.pc(), 0xba81);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xba80), 0x3d);
        // 3D 0071
        gbc.setState(0x5063, 0xf3e1, 0x2030, 0x1744, 0x713c, 0xfa2f, 0x1, 0x1);
        gbc.writeMem(0x5063, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x1f);
        EXPECT(gbc.b(),  0x17);
        EXPECT(gbc.c(),  0x44);
        EXPECT(gbc.d(),  0x71);
        EXPECT(gbc.e(),  0x3c);
        EXPECT(gbc.h(),  0xfa);
        EXPECT(gbc.l(),  0x2f);
        EXPECT(gbc.sp(), 0xf3e1);
        EXPECT(gbc.pc(), 0x5064);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 3D 0072
        gbc.setState(0xc1f1, 0x641b, 0x3d70, 0x8d3b, 0x860d, 0x8f6, 0x1, 0x0);
        gbc.writeMem(0xc1f1, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x3c);
        EXPECT(gbc.b(),  0x8d);
        EXPECT(gbc.c(),  0x3b);
        EXPECT(gbc.d(),  0x86);
        EXPECT(gbc.e(),  0xd);
        EXPECT(gbc.h(),  0x8);
        EXPECT(gbc.l(),  0xf6);
        EXPECT(gbc.sp(), 0x641b);
        EXPECT(gbc.pc(), 0xc1f2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc1f1), 0x3d);
        // 3D 0074
        gbc.setState(0xcf43, 0xab42, 0x3310, 0x47bd, 0x41e7, 0xd1a7, 0x0, 0x1);
        gbc.writeMem(0xcf43, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x32);
        EXPECT(gbc.b(),  0x47);
        EXPECT(gbc.c(),  0xbd);
        EXPECT(gbc.d(),  0x41);
        EXPECT(gbc.e(),  0xe7);
        EXPECT(gbc.h(),  0xd1);
        EXPECT(gbc.l(),  0xa7);
        EXPECT(gbc.sp(), 0xab42);
        EXPECT(gbc.pc(), 0xcf44);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcf43), 0x3d);
        // 3D 0075
        gbc.setState(0x9855, 0x1f15, 0x4c70, 0xa0e4, 0xbbc3, 0x29d4, 0x0, 0x0);
        gbc.writeMem(0x9855, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x4b);
        EXPECT(gbc.b(),  0xa0);
        EXPECT(gbc.c(),  0xe4);
        EXPECT(gbc.d(),  0xbb);
        EXPECT(gbc.e(),  0xc3);
        EXPECT(gbc.h(),  0x29);
        EXPECT(gbc.l(),  0xd4);
        EXPECT(gbc.sp(), 0x1f15);
        EXPECT(gbc.pc(), 0x9856);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9855), 0x3d);
        // 3D 0076
        gbc.setState(0x1457, 0x5a1d, 0x6c80, 0xdc2, 0x90e8, 0xcc13, 0x0, 0x0);
        gbc.writeMem(0x1457, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x6b);
        EXPECT(gbc.b(),  0xd);
        EXPECT(gbc.c(),  0xc2);
        EXPECT(gbc.d(),  0x90);
        EXPECT(gbc.e(),  0xe8);
        EXPECT(gbc.h(),  0xcc);
        EXPECT(gbc.l(),  0x13);
        EXPECT(gbc.sp(), 0x5a1d);
        EXPECT(gbc.pc(), 0x1458);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0077
        gbc.setState(0x5b31, 0x3504, 0xfcb0, 0xce92, 0xb906, 0xbaa4, 0x0, 0x0);
        gbc.writeMem(0x5b31, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xfb);
        EXPECT(gbc.b(),  0xce);
        EXPECT(gbc.c(),  0x92);
        EXPECT(gbc.d(),  0xb9);
        EXPECT(gbc.e(),  0x6);
        EXPECT(gbc.h(),  0xba);
        EXPECT(gbc.l(),  0xa4);
        EXPECT(gbc.sp(), 0x3504);
        EXPECT(gbc.pc(), 0x5b32);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0078
        gbc.setState(0x991, 0x410c, 0x6510, 0xc933, 0x1185, 0x94ac, 0x0, 0x1);
        gbc.writeMem(0x991, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x64);
        EXPECT(gbc.b(),  0xc9);
        EXPECT(gbc.c(),  0x33);
        EXPECT(gbc.d(),  0x11);
        EXPECT(gbc.e(),  0x85);
        EXPECT(gbc.h(),  0x94);
        EXPECT(gbc.l(),  0xac);
        EXPECT(gbc.sp(), 0x410c);
        EXPECT(gbc.pc(), 0x992);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0079
        gbc.setState(0xb49d, 0x24df, 0x6e70, 0xc0bc, 0x82e1, 0x4b27, 0x0, 0x1);
        gbc.writeMem(0xb49d, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x6d);
        EXPECT(gbc.b(),  0xc0);
        EXPECT(gbc.c(),  0xbc);
        EXPECT(gbc.d(),  0x82);
        EXPECT(gbc.e(),  0xe1);
        EXPECT(gbc.h(),  0x4b);
        EXPECT(gbc.l(),  0x27);
        EXPECT(gbc.sp(), 0x24df);
        EXPECT(gbc.pc(), 0xb49e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb49d), 0x3d);
        // 3D 007A
        gbc.setState(0x7e65, 0xa7c3, 0xa260, 0xc801, 0xe7fb, 0xe4ba, 0x0, 0x1);
        gbc.writeMem(0x7e65, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa1);
        EXPECT(gbc.b(),  0xc8);
        EXPECT(gbc.c(),  0x1);
        EXPECT(gbc.d(),  0xe7);
        EXPECT(gbc.e(),  0xfb);
        EXPECT(gbc.h(),  0xe4);
        EXPECT(gbc.l(),  0xba);
        EXPECT(gbc.sp(), 0xa7c3);
        EXPECT(gbc.pc(), 0x7e66);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 007C
        gbc.setState(0x6e10, 0x59f3, 0x9230, 0x99e4, 0xd7d0, 0x249a, 0x1, 0x1);
        gbc.writeMem(0x6e10, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x91);
        EXPECT(gbc.b(),  0x99);
        EXPECT(gbc.c(),  0xe4);
        EXPECT(gbc.d(),  0xd7);
        EXPECT(gbc.e(),  0xd0);
        EXPECT(gbc.h(),  0x24);
        EXPECT(gbc.l(),  0x9a);
        EXPECT(gbc.sp(), 0x59f3);
        EXPECT(gbc.pc(), 0x6e11);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 007D
        gbc.setState(0x22f1, 0x9927, 0x9450, 0xdc4d, 0xa816, 0x6ca9, 0x1, 0x0);
        gbc.writeMem(0x22f1, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x93);
        EXPECT(gbc.b(),  0xdc);
        EXPECT(gbc.c(),  0x4d);
        EXPECT(gbc.d(),  0xa8);
        EXPECT(gbc.e(),  0x16);
        EXPECT(gbc.h(),  0x6c);
        EXPECT(gbc.l(),  0xa9);
        EXPECT(gbc.sp(), 0x9927);
        EXPECT(gbc.pc(), 0x22f2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 007E
        gbc.setState(0xff2, 0x2f59, 0xd880, 0xe49, 0x6e49, 0xee4e, 0x0, 0x0);
        gbc.writeMem(0xff2, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xd7);
        EXPECT(gbc.b(),  0xe);
        EXPECT(gbc.c(),  0x49);
        EXPECT(gbc.d(),  0x6e);
        EXPECT(gbc.e(),  0x49);
        EXPECT(gbc.h(),  0xee);
        EXPECT(gbc.l(),  0x4e);
        EXPECT(gbc.sp(), 0x2f59);
        EXPECT(gbc.pc(), 0xff3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 007F
        gbc.setState(0x458d, 0xf5bc, 0x41d0, 0xd6cb, 0x7626, 0xa87, 0x0, 0x0);
        gbc.writeMem(0x458d, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0xd6);
        EXPECT(gbc.c(),  0xcb);
        EXPECT(gbc.d(),  0x76);
        EXPECT(gbc.e(),  0x26);
        EXPECT(gbc.h(),  0xa);
        EXPECT(gbc.l(),  0x87);
        EXPECT(gbc.sp(), 0xf5bc);
        EXPECT(gbc.pc(), 0x458e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0080
        gbc.setState(0xdc8a, 0x77e1, 0xc920, 0x4ba7, 0xf38d, 0x922e, 0x0, 0x1);
        gbc.writeMem(0xdc8a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xc8);
        EXPECT(gbc.b(),  0x4b);
        EXPECT(gbc.c(),  0xa7);
        EXPECT(gbc.d(),  0xf3);
        EXPECT(gbc.e(),  0x8d);
        EXPECT(gbc.h(),  0x92);
        EXPECT(gbc.l(),  0x2e);
        EXPECT(gbc.sp(), 0x77e1);
        EXPECT(gbc.pc(), 0xdc8b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdc8a), 0x3d);
        // 3D 0081
        gbc.setState(0x3256, 0xe037, 0xc0a0, 0xe93f, 0x6b82, 0x52d2, 0x1, 0x1);
        gbc.writeMem(0x3256, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xbf);
        EXPECT(gbc.b(),  0xe9);
        EXPECT(gbc.c(),  0x3f);
        EXPECT(gbc.d(),  0x6b);
        EXPECT(gbc.e(),  0x82);
        EXPECT(gbc.h(),  0x52);
        EXPECT(gbc.l(),  0xd2);
        EXPECT(gbc.sp(), 0xe037);
        EXPECT(gbc.pc(), 0x3257);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 3D 0082
        gbc.setState(0xb30a, 0xc977, 0xbc70, 0x1c53, 0x67ef, 0x4feb, 0x0, 0x0);
        gbc.writeMem(0xb30a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xbb);
        EXPECT(gbc.b(),  0x1c);
        EXPECT(gbc.c(),  0x53);
        EXPECT(gbc.d(),  0x67);
        EXPECT(gbc.e(),  0xef);
        EXPECT(gbc.h(),  0x4f);
        EXPECT(gbc.l(),  0xeb);
        EXPECT(gbc.sp(), 0xc977);
        EXPECT(gbc.pc(), 0xb30b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb30a), 0x3d);
        // 3D 0083
        gbc.setState(0x26a6, 0x99e9, 0x7870, 0xce87, 0xc46e, 0x5825, 0x1, 0x0);
        gbc.writeMem(0x26a6, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x77);
        EXPECT(gbc.b(),  0xce);
        EXPECT(gbc.c(),  0x87);
        EXPECT(gbc.d(),  0xc4);
        EXPECT(gbc.e(),  0x6e);
        EXPECT(gbc.h(),  0x58);
        EXPECT(gbc.l(),  0x25);
        EXPECT(gbc.sp(), 0x99e9);
        EXPECT(gbc.pc(), 0x26a7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0086
        gbc.setState(0x250b, 0xd02, 0xcf30, 0xa3de, 0xe6b9, 0xd066, 0x0, 0x0);
        gbc.writeMem(0x250b, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xce);
        EXPECT(gbc.b(),  0xa3);
        EXPECT(gbc.c(),  0xde);
        EXPECT(gbc.d(),  0xe6);
        EXPECT(gbc.e(),  0xb9);
        EXPECT(gbc.h(),  0xd0);
        EXPECT(gbc.l(),  0x66);
        EXPECT(gbc.sp(), 0xd02);
        EXPECT(gbc.pc(), 0x250c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0087
        gbc.setState(0xec44, 0xb5ec, 0x3c40, 0x8592, 0xec42, 0xc295, 0x0, 0x1);
        gbc.writeMem(0xec44, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x3b);
        EXPECT(gbc.b(),  0x85);
        EXPECT(gbc.c(),  0x92);
        EXPECT(gbc.d(),  0xec);
        EXPECT(gbc.e(),  0x42);
        EXPECT(gbc.h(),  0xc2);
        EXPECT(gbc.l(),  0x95);
        EXPECT(gbc.sp(), 0xb5ec);
        EXPECT(gbc.pc(), 0xec45);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xec44), 0x3d);
        // 3D 0088
        gbc.setState(0x19d0, 0xc98e, 0x5850, 0x6df9, 0xe84e, 0xc6c0, 0x1, 0x0);
        gbc.writeMem(0x19d0, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x57);
        EXPECT(gbc.b(),  0x6d);
        EXPECT(gbc.c(),  0xf9);
        EXPECT(gbc.d(),  0xe8);
        EXPECT(gbc.e(),  0x4e);
        EXPECT(gbc.h(),  0xc6);
        EXPECT(gbc.l(),  0xc0);
        EXPECT(gbc.sp(), 0xc98e);
        EXPECT(gbc.pc(), 0x19d1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0089
        gbc.setState(0x6072, 0xfdcb, 0xeb70, 0x66bc, 0x397b, 0xecd0, 0x1, 0x1);
        gbc.writeMem(0x6072, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xea);
        EXPECT(gbc.b(),  0x66);
        EXPECT(gbc.c(),  0xbc);
        EXPECT(gbc.d(),  0x39);
        EXPECT(gbc.e(),  0x7b);
        EXPECT(gbc.h(),  0xec);
        EXPECT(gbc.l(),  0xd0);
        EXPECT(gbc.sp(), 0xfdcb);
        EXPECT(gbc.pc(), 0x6073);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 008A
        gbc.setState(0x58a9, 0x28dd, 0x6350, 0x61b8, 0xa8d5, 0xd5f9, 0x1, 0x0);
        gbc.writeMem(0x58a9, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x62);
        EXPECT(gbc.b(),  0x61);
        EXPECT(gbc.c(),  0xb8);
        EXPECT(gbc.d(),  0xa8);
        EXPECT(gbc.e(),  0xd5);
        EXPECT(gbc.h(),  0xd5);
        EXPECT(gbc.l(),  0xf9);
        EXPECT(gbc.sp(), 0x28dd);
        EXPECT(gbc.pc(), 0x58aa);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 008B
        gbc.setState(0xc139, 0xb7f5, 0x2e30, 0x4b88, 0x4cfa, 0x6eb, 0x1, 0x1);
        gbc.writeMem(0xc139, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x2d);
        EXPECT(gbc.b(),  0x4b);
        EXPECT(gbc.c(),  0x88);
        EXPECT(gbc.d(),  0x4c);
        EXPECT(gbc.e(),  0xfa);
        EXPECT(gbc.h(),  0x6);
        EXPECT(gbc.l(),  0xeb);
        EXPECT(gbc.sp(), 0xb7f5);
        EXPECT(gbc.pc(), 0xc13a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc139), 0x3d);
        // 3D 008C
        gbc.setState(0xc900, 0xcc15, 0x81d0, 0xfe69, 0xdbe8, 0x2789, 0x1, 0x0);
        gbc.writeMem(0xc900, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0xfe);
        EXPECT(gbc.c(),  0x69);
        EXPECT(gbc.d(),  0xdb);
        EXPECT(gbc.e(),  0xe8);
        EXPECT(gbc.h(),  0x27);
        EXPECT(gbc.l(),  0x89);
        EXPECT(gbc.sp(), 0xcc15);
        EXPECT(gbc.pc(), 0xc901);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc900), 0x3d);
        // 3D 008D
        gbc.setState(0xd9bc, 0xf5ca, 0xe470, 0x3ad3, 0x9e19, 0xb1cf, 0x0, 0x0);
        gbc.writeMem(0xd9bc, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xe3);
        EXPECT(gbc.b(),  0x3a);
        EXPECT(gbc.c(),  0xd3);
        EXPECT(gbc.d(),  0x9e);
        EXPECT(gbc.e(),  0x19);
        EXPECT(gbc.h(),  0xb1);
        EXPECT(gbc.l(),  0xcf);
        EXPECT(gbc.sp(), 0xf5ca);
        EXPECT(gbc.pc(), 0xd9bd);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd9bc), 0x3d);
        // 3D 008E
        gbc.setState(0x29d1, 0x13e6, 0xf050, 0xc318, 0xd5a2, 0x2470, 0x1, 0x1);
        gbc.writeMem(0x29d1, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xef);
        EXPECT(gbc.b(),  0xc3);
        EXPECT(gbc.c(),  0x18);
        EXPECT(gbc.d(),  0xd5);
        EXPECT(gbc.e(),  0xa2);
        EXPECT(gbc.h(),  0x24);
        EXPECT(gbc.l(),  0x70);
        EXPECT(gbc.sp(), 0x13e6);
        EXPECT(gbc.pc(), 0x29d2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 3D 008F
        gbc.setState(0x4618, 0x177b, 0x30, 0x94fe, 0xfcb8, 0xae5c, 0x0, 0x0);
        gbc.writeMem(0x4618, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xff);
        EXPECT(gbc.b(),  0x94);
        EXPECT(gbc.c(),  0xfe);
        EXPECT(gbc.d(),  0xfc);
        EXPECT(gbc.e(),  0xb8);
        EXPECT(gbc.h(),  0xae);
        EXPECT(gbc.l(),  0x5c);
        EXPECT(gbc.sp(), 0x177b);
        EXPECT(gbc.pc(), 0x4619);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 3D 0090
        gbc.setState(0x4841, 0x5e39, 0xe190, 0xaa2e, 0xcde0, 0xe77b, 0x0, 0x1);
        gbc.writeMem(0x4841, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xe0);
        EXPECT(gbc.b(),  0xaa);
        EXPECT(gbc.c(),  0x2e);
        EXPECT(gbc.d(),  0xcd);
        EXPECT(gbc.e(),  0xe0);
        EXPECT(gbc.h(),  0xe7);
        EXPECT(gbc.l(),  0x7b);
        EXPECT(gbc.sp(), 0x5e39);
        EXPECT(gbc.pc(), 0x4842);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0091
        gbc.setState(0x9adb, 0x817c, 0xe0c0, 0xaafb, 0xdce4, 0x869f, 0x0, 0x1);
        gbc.writeMem(0x9adb, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xdf);
        EXPECT(gbc.b(),  0xaa);
        EXPECT(gbc.c(),  0xfb);
        EXPECT(gbc.d(),  0xdc);
        EXPECT(gbc.e(),  0xe4);
        EXPECT(gbc.h(),  0x86);
        EXPECT(gbc.l(),  0x9f);
        EXPECT(gbc.sp(), 0x817c);
        EXPECT(gbc.pc(), 0x9adc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9adb), 0x3d);
        // 3D 0092
        gbc.setState(0x803d, 0xf990, 0xb480, 0xcd37, 0x4a79, 0xd0a8, 0x0, 0x1);
        gbc.writeMem(0x803d, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xb3);
        EXPECT(gbc.b(),  0xcd);
        EXPECT(gbc.c(),  0x37);
        EXPECT(gbc.d(),  0x4a);
        EXPECT(gbc.e(),  0x79);
        EXPECT(gbc.h(),  0xd0);
        EXPECT(gbc.l(),  0xa8);
        EXPECT(gbc.sp(), 0xf990);
        EXPECT(gbc.pc(), 0x803e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x803d), 0x3d);
        // 3D 0093
        gbc.setState(0x5458, 0x2ef9, 0xa40, 0x6b2e, 0x10d1, 0xc149, 0x1, 0x0);
        gbc.writeMem(0x5458, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x9);
        EXPECT(gbc.b(),  0x6b);
        EXPECT(gbc.c(),  0x2e);
        EXPECT(gbc.d(),  0x10);
        EXPECT(gbc.e(),  0xd1);
        EXPECT(gbc.h(),  0xc1);
        EXPECT(gbc.l(),  0x49);
        EXPECT(gbc.sp(), 0x2ef9);
        EXPECT(gbc.pc(), 0x5459);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0094
        gbc.setState(0x46a0, 0xfd0a, 0x8b60, 0xd8e4, 0x53c2, 0xdeaa, 0x1, 0x0);
        gbc.writeMem(0x46a0, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x8a);
        EXPECT(gbc.b(),  0xd8);
        EXPECT(gbc.c(),  0xe4);
        EXPECT(gbc.d(),  0x53);
        EXPECT(gbc.e(),  0xc2);
        EXPECT(gbc.h(),  0xde);
        EXPECT(gbc.l(),  0xaa);
        EXPECT(gbc.sp(), 0xfd0a);
        EXPECT(gbc.pc(), 0x46a1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0095
        gbc.setState(0x4fcf, 0x9c68, 0x6540, 0x765c, 0x3c1d, 0x98fa, 0x0, 0x0);
        gbc.writeMem(0x4fcf, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x64);
        EXPECT(gbc.b(),  0x76);
        EXPECT(gbc.c(),  0x5c);
        EXPECT(gbc.d(),  0x3c);
        EXPECT(gbc.e(),  0x1d);
        EXPECT(gbc.h(),  0x98);
        EXPECT(gbc.l(),  0xfa);
        EXPECT(gbc.sp(), 0x9c68);
        EXPECT(gbc.pc(), 0x4fd0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0096
        gbc.setState(0x7bb0, 0x487c, 0xe260, 0xe505, 0xfc6a, 0x4300, 0x0, 0x1);
        gbc.writeMem(0x7bb0, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xe1);
        EXPECT(gbc.b(),  0xe5);
        EXPECT(gbc.c(),  0x5);
        EXPECT(gbc.d(),  0xfc);
        EXPECT(gbc.e(),  0x6a);
        EXPECT(gbc.h(),  0x43);
        EXPECT(gbc.l(),  0x0);
        EXPECT(gbc.sp(), 0x487c);
        EXPECT(gbc.pc(), 0x7bb1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0097
        gbc.setState(0x7f00, 0xa4c4, 0xdcc0, 0xad1d, 0xc8c9, 0xb29, 0x1, 0x1);
        gbc.writeMem(0x7f00, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xdb);
        EXPECT(gbc.b(),  0xad);
        EXPECT(gbc.c(),  0x1d);
        EXPECT(gbc.d(),  0xc8);
        EXPECT(gbc.e(),  0xc9);
        EXPECT(gbc.h(),  0xb);
        EXPECT(gbc.l(),  0x29);
        EXPECT(gbc.sp(), 0xa4c4);
        EXPECT(gbc.pc(), 0x7f01);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0098
        gbc.setState(0xdf29, 0x4527, 0x3eb0, 0xb245, 0x6cb1, 0xd106, 0x1, 0x0);
        gbc.writeMem(0xdf29, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x3d);
        EXPECT(gbc.b(),  0xb2);
        EXPECT(gbc.c(),  0x45);
        EXPECT(gbc.d(),  0x6c);
        EXPECT(gbc.e(),  0xb1);
        EXPECT(gbc.h(),  0xd1);
        EXPECT(gbc.l(),  0x6);
        EXPECT(gbc.sp(), 0x4527);
        EXPECT(gbc.pc(), 0xdf2a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xdf29), 0x3d);
        // 3D 0099
        gbc.setState(0x28f1, 0x6a3a, 0xfb60, 0x11e, 0x26f, 0xf00f, 0x0, 0x0);
        gbc.writeMem(0x28f1, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xfa);
        EXPECT(gbc.b(),  0x1);
        EXPECT(gbc.c(),  0x1e);
        EXPECT(gbc.d(),  0x2);
        EXPECT(gbc.e(),  0x6f);
        EXPECT(gbc.h(),  0xf0);
        EXPECT(gbc.l(),  0xf);
        EXPECT(gbc.sp(), 0x6a3a);
        EXPECT(gbc.pc(), 0x28f2);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 009A
        gbc.setState(0xdfd8, 0xf0e, 0x4140, 0x8e1e, 0xe982, 0xd83a, 0x0, 0x1);
        gbc.writeMem(0xdfd8, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0x8e);
        EXPECT(gbc.c(),  0x1e);
        EXPECT(gbc.d(),  0xe9);
        EXPECT(gbc.e(),  0x82);
        EXPECT(gbc.h(),  0xd8);
        EXPECT(gbc.l(),  0x3a);
        EXPECT(gbc.sp(), 0xf0e);
        EXPECT(gbc.pc(), 0xdfd9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdfd8), 0x3d);
        // 3D 009B
        gbc.setState(0xd80e, 0x775c, 0x9b20, 0x8726, 0xe615, 0x515a, 0x1, 0x0);
        gbc.writeMem(0xd80e, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x9a);
        EXPECT(gbc.b(),  0x87);
        EXPECT(gbc.c(),  0x26);
        EXPECT(gbc.d(),  0xe6);
        EXPECT(gbc.e(),  0x15);
        EXPECT(gbc.h(),  0x51);
        EXPECT(gbc.l(),  0x5a);
        EXPECT(gbc.sp(), 0x775c);
        EXPECT(gbc.pc(), 0xd80f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd80e), 0x3d);
        // 3D 009C
        gbc.setState(0xd43c, 0xf97f, 0xfc00, 0x6f55, 0xe892, 0xec24, 0x0, 0x1);
        gbc.writeMem(0xd43c, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xfb);
        EXPECT(gbc.b(),  0x6f);
        EXPECT(gbc.c(),  0x55);
        EXPECT(gbc.d(),  0xe8);
        EXPECT(gbc.e(),  0x92);
        EXPECT(gbc.h(),  0xec);
        EXPECT(gbc.l(),  0x24);
        EXPECT(gbc.sp(), 0xf97f);
        EXPECT(gbc.pc(), 0xd43d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd43c), 0x3d);
        // 3D 009D
        gbc.setState(0x7729, 0xa877, 0x1f50, 0xa4f3, 0x5dee, 0xd8e2, 0x1, 0x1);
        gbc.writeMem(0x7729, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x1e);
        EXPECT(gbc.b(),  0xa4);
        EXPECT(gbc.c(),  0xf3);
        EXPECT(gbc.d(),  0x5d);
        EXPECT(gbc.e(),  0xee);
        EXPECT(gbc.h(),  0xd8);
        EXPECT(gbc.l(),  0xe2);
        EXPECT(gbc.sp(), 0xa877);
        EXPECT(gbc.pc(), 0x772a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 009E
        gbc.setState(0x8350, 0xe1d9, 0x3a00, 0x387e, 0x5d10, 0xb0e, 0x1, 0x1);
        gbc.writeMem(0x8350, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x39);
        EXPECT(gbc.b(),  0x38);
        EXPECT(gbc.c(),  0x7e);
        EXPECT(gbc.d(),  0x5d);
        EXPECT(gbc.e(),  0x10);
        EXPECT(gbc.h(),  0xb);
        EXPECT(gbc.l(),  0xe);
        EXPECT(gbc.sp(), 0xe1d9);
        EXPECT(gbc.pc(), 0x8351);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8350), 0x3d);
        // 3D 009F
        gbc.setState(0x7783, 0x90a3, 0xdc80, 0x2284, 0x70ff, 0x7333, 0x1, 0x1);
        gbc.writeMem(0x7783, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xdb);
        EXPECT(gbc.b(),  0x22);
        EXPECT(gbc.c(),  0x84);
        EXPECT(gbc.d(),  0x70);
        EXPECT(gbc.e(),  0xff);
        EXPECT(gbc.h(),  0x73);
        EXPECT(gbc.l(),  0x33);
        EXPECT(gbc.sp(), 0x90a3);
        EXPECT(gbc.pc(), 0x7784);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 00A0
        gbc.setState(0x85cc, 0x3264, 0x1850, 0x3ef6, 0x84c1, 0xc5e0, 0x1, 0x0);
        gbc.writeMem(0x85cc, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x17);
        EXPECT(gbc.b(),  0x3e);
        EXPECT(gbc.c(),  0xf6);
        EXPECT(gbc.d(),  0x84);
        EXPECT(gbc.e(),  0xc1);
        EXPECT(gbc.h(),  0xc5);
        EXPECT(gbc.l(),  0xe0);
        EXPECT(gbc.sp(), 0x3264);
        EXPECT(gbc.pc(), 0x85cd);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x85cc), 0x3d);
        // 3D 00A1
        gbc.setState(0x4bb3, 0xea24, 0xd870, 0x9b6d, 0x3ed6, 0x9220, 0x1, 0x0);
        gbc.writeMem(0x4bb3, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xd7);
        EXPECT(gbc.b(),  0x9b);
        EXPECT(gbc.c(),  0x6d);
        EXPECT(gbc.d(),  0x3e);
        EXPECT(gbc.e(),  0xd6);
        EXPECT(gbc.h(),  0x92);
        EXPECT(gbc.l(),  0x20);
        EXPECT(gbc.sp(), 0xea24);
        EXPECT(gbc.pc(), 0x4bb4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 00A3
        gbc.setState(0x38f3, 0x96dc, 0x1380, 0x43e8, 0x4413, 0xbd65, 0x0, 0x1);
        gbc.writeMem(0x38f3, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x12);
        EXPECT(gbc.b(),  0x43);
        EXPECT(gbc.c(),  0xe8);
        EXPECT(gbc.d(),  0x44);
        EXPECT(gbc.e(),  0x13);
        EXPECT(gbc.h(),  0xbd);
        EXPECT(gbc.l(),  0x65);
        EXPECT(gbc.sp(), 0x96dc);
        EXPECT(gbc.pc(), 0x38f4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 00A4
        gbc.setState(0x3671, 0x4d19, 0xb940, 0x99df, 0xb547, 0x274, 0x1, 0x1);
        gbc.writeMem(0x3671, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xb8);
        EXPECT(gbc.b(),  0x99);
        EXPECT(gbc.c(),  0xdf);
        EXPECT(gbc.d(),  0xb5);
        EXPECT(gbc.e(),  0x47);
        EXPECT(gbc.h(),  0x2);
        EXPECT(gbc.l(),  0x74);
        EXPECT(gbc.sp(), 0x4d19);
        EXPECT(gbc.pc(), 0x3672);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 00A5
        gbc.setState(0x7911, 0x33b9, 0x65c0, 0x463a, 0xa068, 0x81e, 0x1, 0x1);
        gbc.writeMem(0x7911, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x64);
        EXPECT(gbc.b(),  0x46);
        EXPECT(gbc.c(),  0x3a);
        EXPECT(gbc.d(),  0xa0);
        EXPECT(gbc.e(),  0x68);
        EXPECT(gbc.h(),  0x8);
        EXPECT(gbc.l(),  0x1e);
        EXPECT(gbc.sp(), 0x33b9);
        EXPECT(gbc.pc(), 0x7912);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 00A7
        gbc.setState(0xdb00, 0x32cf, 0xd0a0, 0xf52d, 0xeea3, 0x2805, 0x0, 0x0);
        gbc.writeMem(0xdb00, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xcf);
        EXPECT(gbc.b(),  0xf5);
        EXPECT(gbc.c(),  0x2d);
        EXPECT(gbc.d(),  0xee);
        EXPECT(gbc.e(),  0xa3);
        EXPECT(gbc.h(),  0x28);
        EXPECT(gbc.l(),  0x5);
        EXPECT(gbc.sp(), 0x32cf);
        EXPECT(gbc.pc(), 0xdb01);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdb00), 0x3d);
        // 3D 00A8
        gbc.setState(0xb0bc, 0xe4f5, 0xe3b0, 0x86a6, 0xc907, 0x9e50, 0x1, 0x0);
        gbc.writeMem(0xb0bc, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xe2);
        EXPECT(gbc.b(),  0x86);
        EXPECT(gbc.c(),  0xa6);
        EXPECT(gbc.d(),  0xc9);
        EXPECT(gbc.e(),  0x7);
        EXPECT(gbc.h(),  0x9e);
        EXPECT(gbc.l(),  0x50);
        EXPECT(gbc.sp(), 0xe4f5);
        EXPECT(gbc.pc(), 0xb0bd);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb0bc), 0x3d);
        // 3D 00A9
        gbc.setState(0xd859, 0x29da, 0x1440, 0xe0dd, 0x314f, 0x9f1f, 0x1, 0x1);
        gbc.writeMem(0xd859, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x13);
        EXPECT(gbc.b(),  0xe0);
        EXPECT(gbc.c(),  0xdd);
        EXPECT(gbc.d(),  0x31);
        EXPECT(gbc.e(),  0x4f);
        EXPECT(gbc.h(),  0x9f);
        EXPECT(gbc.l(),  0x1f);
        EXPECT(gbc.sp(), 0x29da);
        EXPECT(gbc.pc(), 0xd85a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd859), 0x3d);
        // 3D 00AA
        gbc.setState(0xb7d7, 0x7fe3, 0xf7c0, 0x4dfb, 0x7023, 0xc71b, 0x1, 0x0);
        gbc.writeMem(0xb7d7, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf6);
        EXPECT(gbc.b(),  0x4d);
        EXPECT(gbc.c(),  0xfb);
        EXPECT(gbc.d(),  0x70);
        EXPECT(gbc.e(),  0x23);
        EXPECT(gbc.h(),  0xc7);
        EXPECT(gbc.l(),  0x1b);
        EXPECT(gbc.sp(), 0x7fe3);
        EXPECT(gbc.pc(), 0xb7d8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb7d7), 0x3d);
        // 3D 00AC
        gbc.setState(0x6f1a, 0xb980, 0x2320, 0xa5c7, 0x6562, 0x4fd3, 0x1, 0x0);
        gbc.writeMem(0x6f1a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x22);
        EXPECT(gbc.b(),  0xa5);
        EXPECT(gbc.c(),  0xc7);
        EXPECT(gbc.d(),  0x65);
        EXPECT(gbc.e(),  0x62);
        EXPECT(gbc.h(),  0x4f);
        EXPECT(gbc.l(),  0xd3);
        EXPECT(gbc.sp(), 0xb980);
        EXPECT(gbc.pc(), 0x6f1b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 00AD
        gbc.setState(0xc828, 0x6ced, 0xf280, 0xc271, 0xa410, 0xf821, 0x0, 0x0);
        gbc.writeMem(0xc828, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf1);
        EXPECT(gbc.b(),  0xc2);
        EXPECT(gbc.c(),  0x71);
        EXPECT(gbc.d(),  0xa4);
        EXPECT(gbc.e(),  0x10);
        EXPECT(gbc.h(),  0xf8);
        EXPECT(gbc.l(),  0x21);
        EXPECT(gbc.sp(), 0x6ced);
        EXPECT(gbc.pc(), 0xc829);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc828), 0x3d);
        // 3D 00AE
        gbc.setState(0x36df, 0xdf32, 0x4580, 0x48d7, 0x374, 0x5bdd, 0x1, 0x1);
        gbc.writeMem(0x36df, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x44);
        EXPECT(gbc.b(),  0x48);
        EXPECT(gbc.c(),  0xd7);
        EXPECT(gbc.d(),  0x3);
        EXPECT(gbc.e(),  0x74);
        EXPECT(gbc.h(),  0x5b);
        EXPECT(gbc.l(),  0xdd);
        EXPECT(gbc.sp(), 0xdf32);
        EXPECT(gbc.pc(), 0x36e0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 00B0
        gbc.setState(0xb572, 0x4315, 0xadd0, 0x3531, 0x719a, 0xe781, 0x1, 0x1);
        gbc.writeMem(0xb572, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xac);
        EXPECT(gbc.b(),  0x35);
        EXPECT(gbc.c(),  0x31);
        EXPECT(gbc.d(),  0x71);
        EXPECT(gbc.e(),  0x9a);
        EXPECT(gbc.h(),  0xe7);
        EXPECT(gbc.l(),  0x81);
        EXPECT(gbc.sp(), 0x4315);
        EXPECT(gbc.pc(), 0xb573);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb572), 0x3d);
        // 3D 00B1
        gbc.setState(0x453e, 0x53ae, 0x9980, 0xfd0f, 0xaa61, 0x1c88, 0x0, 0x0);
        gbc.writeMem(0x453e, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x98);
        EXPECT(gbc.b(),  0xfd);
        EXPECT(gbc.c(),  0xf);
        EXPECT(gbc.d(),  0xaa);
        EXPECT(gbc.e(),  0x61);
        EXPECT(gbc.h(),  0x1c);
        EXPECT(gbc.l(),  0x88);
        EXPECT(gbc.sp(), 0x53ae);
        EXPECT(gbc.pc(), 0x453f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 00B2
        gbc.setState(0xda4e, 0x3af4, 0x1eb0, 0xf59e, 0x7fb4, 0xbaf3, 0x1, 0x0);
        gbc.writeMem(0xda4e, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x1d);
        EXPECT(gbc.b(),  0xf5);
        EXPECT(gbc.c(),  0x9e);
        EXPECT(gbc.d(),  0x7f);
        EXPECT(gbc.e(),  0xb4);
        EXPECT(gbc.h(),  0xba);
        EXPECT(gbc.l(),  0xf3);
        EXPECT(gbc.sp(), 0x3af4);
        EXPECT(gbc.pc(), 0xda4f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xda4e), 0x3d);
        // 3D 00B3
        gbc.setState(0x7b4, 0xb24b, 0xa000, 0x1ca2, 0xf0, 0x2afe, 0x1, 0x0);
        gbc.writeMem(0x7b4, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x9f);
        EXPECT(gbc.b(),  0x1c);
        EXPECT(gbc.c(),  0xa2);
        EXPECT(gbc.d(),  0x0);
        EXPECT(gbc.e(),  0xf0);
        EXPECT(gbc.h(),  0x2a);
        EXPECT(gbc.l(),  0xfe);
        EXPECT(gbc.sp(), 0xb24b);
        EXPECT(gbc.pc(), 0x7b5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 3D 00B5
        gbc.setState(0x7d1, 0xc2f3, 0xf80, 0x7d74, 0xf4a1, 0xfa98, 0x0, 0x0);
        gbc.writeMem(0x7d1, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xe);
        EXPECT(gbc.b(),  0x7d);
        EXPECT(gbc.c(),  0x74);
        EXPECT(gbc.d(),  0xf4);
        EXPECT(gbc.e(),  0xa1);
        EXPECT(gbc.h(),  0xfa);
        EXPECT(gbc.l(),  0x98);
        EXPECT(gbc.sp(), 0xc2f3);
        EXPECT(gbc.pc(), 0x7d2);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 00B6
        gbc.setState(0x707a, 0xa940, 0x77c0, 0x4878, 0xc383, 0x19c2, 0x0, 0x0);
        gbc.writeMem(0x707a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x76);
        EXPECT(gbc.b(),  0x48);
        EXPECT(gbc.c(),  0x78);
        EXPECT(gbc.d(),  0xc3);
        EXPECT(gbc.e(),  0x83);
        EXPECT(gbc.h(),  0x19);
        EXPECT(gbc.l(),  0xc2);
        EXPECT(gbc.sp(), 0xa940);
        EXPECT(gbc.pc(), 0x707b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 00B7
        gbc.setState(0x3efa, 0xbbb0, 0x7d80, 0x4af6, 0x57f5, 0x1fdc, 0x0, 0x0);
        gbc.writeMem(0x3efa, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x7c);
        EXPECT(gbc.b(),  0x4a);
        EXPECT(gbc.c(),  0xf6);
        EXPECT(gbc.d(),  0x57);
        EXPECT(gbc.e(),  0xf5);
        EXPECT(gbc.h(),  0x1f);
        EXPECT(gbc.l(),  0xdc);
        EXPECT(gbc.sp(), 0xbbb0);
        EXPECT(gbc.pc(), 0x3efb);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 00B8
        gbc.setState(0xeb49, 0x50b3, 0x1310, 0x9930, 0xc949, 0x46d0, 0x0, 0x1);
        gbc.writeMem(0xeb49, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x12);
        EXPECT(gbc.b(),  0x99);
        EXPECT(gbc.c(),  0x30);
        EXPECT(gbc.d(),  0xc9);
        EXPECT(gbc.e(),  0x49);
        EXPECT(gbc.h(),  0x46);
        EXPECT(gbc.l(),  0xd0);
        EXPECT(gbc.sp(), 0x50b3);
        EXPECT(gbc.pc(), 0xeb4a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xeb49), 0x3d);
        // 3D 00B9
        gbc.setState(0xbb39, 0x806c, 0xfc80, 0xc53c, 0x8dd, 0xbae3, 0x0, 0x0);
        gbc.writeMem(0xbb39, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xfb);
        EXPECT(gbc.b(),  0xc5);
        EXPECT(gbc.c(),  0x3c);
        EXPECT(gbc.d(),  0x8);
        EXPECT(gbc.e(),  0xdd);
        EXPECT(gbc.h(),  0xba);
        EXPECT(gbc.l(),  0xe3);
        EXPECT(gbc.sp(), 0x806c);
        EXPECT(gbc.pc(), 0xbb3a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbb39), 0x3d);
        // 3D 00BA
        gbc.setState(0xc20c, 0x119a, 0xd150, 0x7f25, 0x45b8, 0x2c8c, 0x0, 0x1);
        gbc.writeMem(0xc20c, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xd0);
        EXPECT(gbc.b(),  0x7f);
        EXPECT(gbc.c(),  0x25);
        EXPECT(gbc.d(),  0x45);
        EXPECT(gbc.e(),  0xb8);
        EXPECT(gbc.h(),  0x2c);
        EXPECT(gbc.l(),  0x8c);
        EXPECT(gbc.sp(), 0x119a);
        EXPECT(gbc.pc(), 0xc20d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc20c), 0x3d);
        // 3D 00BB
        gbc.setState(0x7870, 0xcd8c, 0x6f30, 0xf4cf, 0x7951, 0x30a, 0x0, 0x0);
        gbc.writeMem(0x7870, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x6e);
        EXPECT(gbc.b(),  0xf4);
        EXPECT(gbc.c(),  0xcf);
        EXPECT(gbc.d(),  0x79);
        EXPECT(gbc.e(),  0x51);
        EXPECT(gbc.h(),  0x3);
        EXPECT(gbc.l(),  0xa);
        EXPECT(gbc.sp(), 0xcd8c);
        EXPECT(gbc.pc(), 0x7871);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 00BC
        gbc.setState(0x2aa, 0x210, 0x7670, 0xdb86, 0x5554, 0x17a5, 0x1, 0x0);
        gbc.writeMem(0x2aa, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x75);
        EXPECT(gbc.b(),  0xdb);
        EXPECT(gbc.c(),  0x86);
        EXPECT(gbc.d(),  0x55);
        EXPECT(gbc.e(),  0x54);
        EXPECT(gbc.h(),  0x17);
        EXPECT(gbc.l(),  0xa5);
        EXPECT(gbc.sp(), 0x210);
        EXPECT(gbc.pc(), 0x2ab);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 00BD
        gbc.setState(0x72f7, 0x776a, 0x9ac0, 0xa66b, 0x6a11, 0x438, 0x0, 0x1);
        gbc.writeMem(0x72f7, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x99);
        EXPECT(gbc.b(),  0xa6);
        EXPECT(gbc.c(),  0x6b);
        EXPECT(gbc.d(),  0x6a);
        EXPECT(gbc.e(),  0x11);
        EXPECT(gbc.h(),  0x4);
        EXPECT(gbc.l(),  0x38);
        EXPECT(gbc.sp(), 0x776a);
        EXPECT(gbc.pc(), 0x72f8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 00BE
        gbc.setState(0x24dd, 0xf36c, 0xe2c0, 0x973a, 0x2f9b, 0xff1f, 0x1, 0x0);
        gbc.writeMem(0x24dd, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xe1);
        EXPECT(gbc.b(),  0x97);
        EXPECT(gbc.c(),  0x3a);
        EXPECT(gbc.d(),  0x2f);
        EXPECT(gbc.e(),  0x9b);
        EXPECT(gbc.h(),  0xff);
        EXPECT(gbc.l(),  0x1f);
        EXPECT(gbc.sp(), 0xf36c);
        EXPECT(gbc.pc(), 0x24de);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 00BF
        gbc.setState(0x6059, 0x904b, 0x1d70, 0xf260, 0x10c1, 0x6858, 0x0, 0x1);
        gbc.writeMem(0x6059, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x1c);
        EXPECT(gbc.b(),  0xf2);
        EXPECT(gbc.c(),  0x60);
        EXPECT(gbc.d(),  0x10);
        EXPECT(gbc.e(),  0xc1);
        EXPECT(gbc.h(),  0x68);
        EXPECT(gbc.l(),  0x58);
        EXPECT(gbc.sp(), 0x904b);
        EXPECT(gbc.pc(), 0x605a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 00C0
        gbc.setState(0xcbf7, 0x108d, 0x7de0, 0xe62d, 0x4b7b, 0x4cea, 0x0, 0x1);
        gbc.writeMem(0xcbf7, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x7c);
        EXPECT(gbc.b(),  0xe6);
        EXPECT(gbc.c(),  0x2d);
        EXPECT(gbc.d(),  0x4b);
        EXPECT(gbc.e(),  0x7b);
        EXPECT(gbc.h(),  0x4c);
        EXPECT(gbc.l(),  0xea);
        EXPECT(gbc.sp(), 0x108d);
        EXPECT(gbc.pc(), 0xcbf8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcbf7), 0x3d);
        // 3D 00C1
        gbc.setState(0x4cb5, 0x2e4d, 0x5490, 0x8d9f, 0x65a0, 0x5f85, 0x0, 0x0);
        gbc.writeMem(0x4cb5, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x53);
        EXPECT(gbc.b(),  0x8d);
        EXPECT(gbc.c(),  0x9f);
        EXPECT(gbc.d(),  0x65);
        EXPECT(gbc.e(),  0xa0);
        EXPECT(gbc.h(),  0x5f);
        EXPECT(gbc.l(),  0x85);
        EXPECT(gbc.sp(), 0x2e4d);
        EXPECT(gbc.pc(), 0x4cb6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 00C2
        gbc.setState(0x64a2, 0x2b5d, 0x1a10, 0x3f83, 0x1bea, 0x15a9, 0x1, 0x1);
        gbc.writeMem(0x64a2, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x19);
        EXPECT(gbc.b(),  0x3f);
        EXPECT(gbc.c(),  0x83);
        EXPECT(gbc.d(),  0x1b);
        EXPECT(gbc.e(),  0xea);
        EXPECT(gbc.h(),  0x15);
        EXPECT(gbc.l(),  0xa9);
        EXPECT(gbc.sp(), 0x2b5d);
        EXPECT(gbc.pc(), 0x64a3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 00C3
        gbc.setState(0xa0e8, 0x89ba, 0xa340, 0xfeee, 0xae00, 0x124c, 0x1, 0x1);
        gbc.writeMem(0xa0e8, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa2);
        EXPECT(gbc.b(),  0xfe);
        EXPECT(gbc.c(),  0xee);
        EXPECT(gbc.d(),  0xae);
        EXPECT(gbc.e(),  0x0);
        EXPECT(gbc.h(),  0x12);
        EXPECT(gbc.l(),  0x4c);
        EXPECT(gbc.sp(), 0x89ba);
        EXPECT(gbc.pc(), 0xa0e9);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa0e8), 0x3d);
        // 3D 00C4
        gbc.setState(0xc4d6, 0x3694, 0x2850, 0xc887, 0xe627, 0x246b, 0x0, 0x1);
        gbc.writeMem(0xc4d6, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x27);
        EXPECT(gbc.b(),  0xc8);
        EXPECT(gbc.c(),  0x87);
        EXPECT(gbc.d(),  0xe6);
        EXPECT(gbc.e(),  0x27);
        EXPECT(gbc.h(),  0x24);
        EXPECT(gbc.l(),  0x6b);
        EXPECT(gbc.sp(), 0x3694);
        EXPECT(gbc.pc(), 0xc4d7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc4d6), 0x3d);
        // 3D 00C5
        gbc.setState(0xe28b, 0x1e9f, 0x6fe0, 0x9d17, 0xd6e8, 0x94fd, 0x1, 0x0);
        gbc.writeMem(0xe28b, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x6e);
        EXPECT(gbc.b(),  0x9d);
        EXPECT(gbc.c(),  0x17);
        EXPECT(gbc.d(),  0xd6);
        EXPECT(gbc.e(),  0xe8);
        EXPECT(gbc.h(),  0x94);
        EXPECT(gbc.l(),  0xfd);
        EXPECT(gbc.sp(), 0x1e9f);
        EXPECT(gbc.pc(), 0xe28c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe28b), 0x3d);
        // 3D 00C6
        gbc.setState(0xc976, 0x1571, 0x9350, 0x617f, 0x2664, 0x6b6c, 0x0, 0x1);
        gbc.writeMem(0xc976, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x92);
        EXPECT(gbc.b(),  0x61);
        EXPECT(gbc.c(),  0x7f);
        EXPECT(gbc.d(),  0x26);
        EXPECT(gbc.e(),  0x64);
        EXPECT(gbc.h(),  0x6b);
        EXPECT(gbc.l(),  0x6c);
        EXPECT(gbc.sp(), 0x1571);
        EXPECT(gbc.pc(), 0xc977);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc976), 0x3d);
        // 3D 00C7
        gbc.setState(0x1a28, 0xcb8f, 0xf660, 0x85f9, 0xe165, 0xeea5, 0x1, 0x1);
        gbc.writeMem(0x1a28, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf5);
        EXPECT(gbc.b(),  0x85);
        EXPECT(gbc.c(),  0xf9);
        EXPECT(gbc.d(),  0xe1);
        EXPECT(gbc.e(),  0x65);
        EXPECT(gbc.h(),  0xee);
        EXPECT(gbc.l(),  0xa5);
        EXPECT(gbc.sp(), 0xcb8f);
        EXPECT(gbc.pc(), 0x1a29);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 00C8
        gbc.setState(0xda33, 0xdd52, 0x5910, 0x7048, 0xa737, 0x7cb0, 0x0, 0x1);
        gbc.writeMem(0xda33, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x58);
        EXPECT(gbc.b(),  0x70);
        EXPECT(gbc.c(),  0x48);
        EXPECT(gbc.d(),  0xa7);
        EXPECT(gbc.e(),  0x37);
        EXPECT(gbc.h(),  0x7c);
        EXPECT(gbc.l(),  0xb0);
        EXPECT(gbc.sp(), 0xdd52);
        EXPECT(gbc.pc(), 0xda34);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xda33), 0x3d);
        // 3D 00C9
        gbc.setState(0x9918, 0x6de9, 0x69e0, 0x83ed, 0x42fa, 0xca49, 0x1, 0x1);
        gbc.writeMem(0x9918, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x68);
        EXPECT(gbc.b(),  0x83);
        EXPECT(gbc.c(),  0xed);
        EXPECT(gbc.d(),  0x42);
        EXPECT(gbc.e(),  0xfa);
        EXPECT(gbc.h(),  0xca);
        EXPECT(gbc.l(),  0x49);
        EXPECT(gbc.sp(), 0x6de9);
        EXPECT(gbc.pc(), 0x9919);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9918), 0x3d);
        // 3D 00CA
        gbc.setState(0x8eca, 0x8a72, 0xe260, 0xc77a, 0x58b, 0x55fe, 0x1, 0x0);
        gbc.writeMem(0x8eca, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xe1);
        EXPECT(gbc.b(),  0xc7);
        EXPECT(gbc.c(),  0x7a);
        EXPECT(gbc.d(),  0x5);
        EXPECT(gbc.e(),  0x8b);
        EXPECT(gbc.h(),  0x55);
        EXPECT(gbc.l(),  0xfe);
        EXPECT(gbc.sp(), 0x8a72);
        EXPECT(gbc.pc(), 0x8ecb);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8eca), 0x3d);
        // 3D 00CC
        gbc.setState(0xad11, 0x15e1, 0xb70, 0x8191, 0x18f0, 0xd320, 0x0, 0x0);
        gbc.writeMem(0xad11, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa);
        EXPECT(gbc.b(),  0x81);
        EXPECT(gbc.c(),  0x91);
        EXPECT(gbc.d(),  0x18);
        EXPECT(gbc.e(),  0xf0);
        EXPECT(gbc.h(),  0xd3);
        EXPECT(gbc.l(),  0x20);
        EXPECT(gbc.sp(), 0x15e1);
        EXPECT(gbc.pc(), 0xad12);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xad11), 0x3d);
        // 3D 00CD
        gbc.setState(0xe323, 0xb4f1, 0x13c0, 0x2963, 0x5236, 0x583c, 0x1, 0x1);
        gbc.writeMem(0xe323, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x12);
        EXPECT(gbc.b(),  0x29);
        EXPECT(gbc.c(),  0x63);
        EXPECT(gbc.d(),  0x52);
        EXPECT(gbc.e(),  0x36);
        EXPECT(gbc.h(),  0x58);
        EXPECT(gbc.l(),  0x3c);
        EXPECT(gbc.sp(), 0xb4f1);
        EXPECT(gbc.pc(), 0xe324);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe323), 0x3d);
        // 3D 00CE
        gbc.setState(0x757e, 0xdef8, 0x9610, 0x4d8d, 0x4c70, 0xc63c, 0x1, 0x0);
        gbc.writeMem(0x757e, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x95);
        EXPECT(gbc.b(),  0x4d);
        EXPECT(gbc.c(),  0x8d);
        EXPECT(gbc.d(),  0x4c);
        EXPECT(gbc.e(),  0x70);
        EXPECT(gbc.h(),  0xc6);
        EXPECT(gbc.l(),  0x3c);
        EXPECT(gbc.sp(), 0xdef8);
        EXPECT(gbc.pc(), 0x757f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 00CF
        gbc.setState(0xdbb, 0x98ad, 0xd4e0, 0xb447, 0x3a46, 0x8a63, 0x0, 0x0);
        gbc.writeMem(0xdbb, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xd3);
        EXPECT(gbc.b(),  0xb4);
        EXPECT(gbc.c(),  0x47);
        EXPECT(gbc.d(),  0x3a);
        EXPECT(gbc.e(),  0x46);
        EXPECT(gbc.h(),  0x8a);
        EXPECT(gbc.l(),  0x63);
        EXPECT(gbc.sp(), 0x98ad);
        EXPECT(gbc.pc(), 0xdbc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 00D0
        gbc.setState(0xc252, 0xe487, 0x5860, 0x1409, 0xcc55, 0xe102, 0x0, 0x0);
        gbc.writeMem(0xc252, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x57);
        EXPECT(gbc.b(),  0x14);
        EXPECT(gbc.c(),  0x9);
        EXPECT(gbc.d(),  0xcc);
        EXPECT(gbc.e(),  0x55);
        EXPECT(gbc.h(),  0xe1);
        EXPECT(gbc.l(),  0x2);
        EXPECT(gbc.sp(), 0xe487);
        EXPECT(gbc.pc(), 0xc253);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc252), 0x3d);
        // 3D 00D1
        gbc.setState(0xe715, 0x8164, 0xb070, 0x8f3d, 0x8df2, 0x8c72, 0x1, 0x0);
        gbc.writeMem(0xe715, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xaf);
        EXPECT(gbc.b(),  0x8f);
        EXPECT(gbc.c(),  0x3d);
        EXPECT(gbc.d(),  0x8d);
        EXPECT(gbc.e(),  0xf2);
        EXPECT(gbc.h(),  0x8c);
        EXPECT(gbc.l(),  0x72);
        EXPECT(gbc.sp(), 0x8164);
        EXPECT(gbc.pc(), 0xe716);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe715), 0x3d);
        // 3D 00D2
        gbc.setState(0x6951, 0xfd41, 0x6390, 0x7aa5, 0xb5ca, 0xf130, 0x1, 0x1);
        gbc.writeMem(0x6951, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x62);
        EXPECT(gbc.b(),  0x7a);
        EXPECT(gbc.c(),  0xa5);
        EXPECT(gbc.d(),  0xb5);
        EXPECT(gbc.e(),  0xca);
        EXPECT(gbc.h(),  0xf1);
        EXPECT(gbc.l(),  0x30);
        EXPECT(gbc.sp(), 0xfd41);
        EXPECT(gbc.pc(), 0x6952);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 00D3
        gbc.setState(0xec55, 0xb73b, 0xd580, 0xc4d0, 0xd2d8, 0xaabd, 0x0, 0x1);
        gbc.writeMem(0xec55, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xd4);
        EXPECT(gbc.b(),  0xc4);
        EXPECT(gbc.c(),  0xd0);
        EXPECT(gbc.d(),  0xd2);
        EXPECT(gbc.e(),  0xd8);
        EXPECT(gbc.h(),  0xaa);
        EXPECT(gbc.l(),  0xbd);
        EXPECT(gbc.sp(), 0xb73b);
        EXPECT(gbc.pc(), 0xec56);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xec55), 0x3d);
        // 3D 00D4
        gbc.setState(0xd9c3, 0xaa2d, 0xc4e0, 0x2507, 0xe8d1, 0xc30d, 0x0, 0x0);
        gbc.writeMem(0xd9c3, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xc3);
        EXPECT(gbc.b(),  0x25);
        EXPECT(gbc.c(),  0x7);
        EXPECT(gbc.d(),  0xe8);
        EXPECT(gbc.e(),  0xd1);
        EXPECT(gbc.h(),  0xc3);
        EXPECT(gbc.l(),  0xd);
        EXPECT(gbc.sp(), 0xaa2d);
        EXPECT(gbc.pc(), 0xd9c4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd9c3), 0x3d);
        // 3D 00D5
        gbc.setState(0x8461, 0xf725, 0xad70, 0x616e, 0xb166, 0xa62b, 0x0, 0x1);
        gbc.writeMem(0x8461, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xac);
        EXPECT(gbc.b(),  0x61);
        EXPECT(gbc.c(),  0x6e);
        EXPECT(gbc.d(),  0xb1);
        EXPECT(gbc.e(),  0x66);
        EXPECT(gbc.h(),  0xa6);
        EXPECT(gbc.l(),  0x2b);
        EXPECT(gbc.sp(), 0xf725);
        EXPECT(gbc.pc(), 0x8462);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8461), 0x3d);
        // 3D 00D6
        gbc.setState(0x505c, 0xa6ce, 0x7a10, 0xd6e5, 0x2ca8, 0x7126, 0x1, 0x1);
        gbc.writeMem(0x505c, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x79);
        EXPECT(gbc.b(),  0xd6);
        EXPECT(gbc.c(),  0xe5);
        EXPECT(gbc.d(),  0x2c);
        EXPECT(gbc.e(),  0xa8);
        EXPECT(gbc.h(),  0x71);
        EXPECT(gbc.l(),  0x26);
        EXPECT(gbc.sp(), 0xa6ce);
        EXPECT(gbc.pc(), 0x505d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 00D7
        gbc.setState(0xd658, 0xde8e, 0xe630, 0x1f0e, 0xe1f5, 0x2716, 0x1, 0x0);
        gbc.writeMem(0xd658, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xe5);
        EXPECT(gbc.b(),  0x1f);
        EXPECT(gbc.c(),  0xe);
        EXPECT(gbc.d(),  0xe1);
        EXPECT(gbc.e(),  0xf5);
        EXPECT(gbc.h(),  0x27);
        EXPECT(gbc.l(),  0x16);
        EXPECT(gbc.sp(), 0xde8e);
        EXPECT(gbc.pc(), 0xd659);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd658), 0x3d);
        // 3D 00D8
        gbc.setState(0xdb70, 0xbd09, 0x95c0, 0x895c, 0x8c9b, 0x3fb8, 0x1, 0x1);
        gbc.writeMem(0xdb70, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x94);
        EXPECT(gbc.b(),  0x89);
        EXPECT(gbc.c(),  0x5c);
        EXPECT(gbc.d(),  0x8c);
        EXPECT(gbc.e(),  0x9b);
        EXPECT(gbc.h(),  0x3f);
        EXPECT(gbc.l(),  0xb8);
        EXPECT(gbc.sp(), 0xbd09);
        EXPECT(gbc.pc(), 0xdb71);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdb70), 0x3d);
        // 3D 00D9
        gbc.setState(0x305f, 0xeab3, 0xfc30, 0x9fcb, 0x68ea, 0x7a71, 0x1, 0x1);
        gbc.writeMem(0x305f, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xfb);
        EXPECT(gbc.b(),  0x9f);
        EXPECT(gbc.c(),  0xcb);
        EXPECT(gbc.d(),  0x68);
        EXPECT(gbc.e(),  0xea);
        EXPECT(gbc.h(),  0x7a);
        EXPECT(gbc.l(),  0x71);
        EXPECT(gbc.sp(), 0xeab3);
        EXPECT(gbc.pc(), 0x3060);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 00DA
        gbc.setState(0x1941, 0x626f, 0x47d0, 0xafe7, 0xf5c9, 0xb54a, 0x0, 0x0);
        gbc.writeMem(0x1941, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x46);
        EXPECT(gbc.b(),  0xaf);
        EXPECT(gbc.c(),  0xe7);
        EXPECT(gbc.d(),  0xf5);
        EXPECT(gbc.e(),  0xc9);
        EXPECT(gbc.h(),  0xb5);
        EXPECT(gbc.l(),  0x4a);
        EXPECT(gbc.sp(), 0x626f);
        EXPECT(gbc.pc(), 0x1942);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 00DB
        gbc.setState(0x2e6f, 0x9827, 0xa720, 0x4912, 0x3246, 0x1c7c, 0x0, 0x1);
        gbc.writeMem(0x2e6f, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa6);
        EXPECT(gbc.b(),  0x49);
        EXPECT(gbc.c(),  0x12);
        EXPECT(gbc.d(),  0x32);
        EXPECT(gbc.e(),  0x46);
        EXPECT(gbc.h(),  0x1c);
        EXPECT(gbc.l(),  0x7c);
        EXPECT(gbc.sp(), 0x9827);
        EXPECT(gbc.pc(), 0x2e70);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 00DC
        gbc.setState(0xd9cb, 0xe25, 0x9970, 0xa0dd, 0x26d, 0xcdd3, 0x0, 0x1);
        gbc.writeMem(0xd9cb, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x98);
        EXPECT(gbc.b(),  0xa0);
        EXPECT(gbc.c(),  0xdd);
        EXPECT(gbc.d(),  0x2);
        EXPECT(gbc.e(),  0x6d);
        EXPECT(gbc.h(),  0xcd);
        EXPECT(gbc.l(),  0xd3);
        EXPECT(gbc.sp(), 0xe25);
        EXPECT(gbc.pc(), 0xd9cc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd9cb), 0x3d);
        // 3D 00DD
        gbc.setState(0x79ba, 0x69ac, 0x2b10, 0xf577, 0x1ed0, 0x9e77, 0x1, 0x1);
        gbc.writeMem(0x79ba, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x2a);
        EXPECT(gbc.b(),  0xf5);
        EXPECT(gbc.c(),  0x77);
        EXPECT(gbc.d(),  0x1e);
        EXPECT(gbc.e(),  0xd0);
        EXPECT(gbc.h(),  0x9e);
        EXPECT(gbc.l(),  0x77);
        EXPECT(gbc.sp(), 0x69ac);
        EXPECT(gbc.pc(), 0x79bb);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 00E0
        gbc.setState(0x698a, 0xd651, 0xfee0, 0xa6ad, 0xb3f1, 0x5838, 0x1, 0x0);
        gbc.writeMem(0x698a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xfd);
        EXPECT(gbc.b(),  0xa6);
        EXPECT(gbc.c(),  0xad);
        EXPECT(gbc.d(),  0xb3);
        EXPECT(gbc.e(),  0xf1);
        EXPECT(gbc.h(),  0x58);
        EXPECT(gbc.l(),  0x38);
        EXPECT(gbc.sp(), 0xd651);
        EXPECT(gbc.pc(), 0x698b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 00E1
        gbc.setState(0x31db, 0x5266, 0x6d60, 0x28a8, 0x489a, 0x392b, 0x0, 0x0);
        gbc.writeMem(0x31db, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x6c);
        EXPECT(gbc.b(),  0x28);
        EXPECT(gbc.c(),  0xa8);
        EXPECT(gbc.d(),  0x48);
        EXPECT(gbc.e(),  0x9a);
        EXPECT(gbc.h(),  0x39);
        EXPECT(gbc.l(),  0x2b);
        EXPECT(gbc.sp(), 0x5266);
        EXPECT(gbc.pc(), 0x31dc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 00E2
        gbc.setState(0xbda6, 0xd6cc, 0xf380, 0x5618, 0x6716, 0x87a5, 0x1, 0x0);
        gbc.writeMem(0xbda6, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf2);
        EXPECT(gbc.b(),  0x56);
        EXPECT(gbc.c(),  0x18);
        EXPECT(gbc.d(),  0x67);
        EXPECT(gbc.e(),  0x16);
        EXPECT(gbc.h(),  0x87);
        EXPECT(gbc.l(),  0xa5);
        EXPECT(gbc.sp(), 0xd6cc);
        EXPECT(gbc.pc(), 0xbda7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbda6), 0x3d);
        // 3D 00E3
        gbc.setState(0x300e, 0x725a, 0x2790, 0x7d31, 0xa9b4, 0x4271, 0x0, 0x1);
        gbc.writeMem(0x300e, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x26);
        EXPECT(gbc.b(),  0x7d);
        EXPECT(gbc.c(),  0x31);
        EXPECT(gbc.d(),  0xa9);
        EXPECT(gbc.e(),  0xb4);
        EXPECT(gbc.h(),  0x42);
        EXPECT(gbc.l(),  0x71);
        EXPECT(gbc.sp(), 0x725a);
        EXPECT(gbc.pc(), 0x300f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 00E4
        gbc.setState(0x4216, 0x7543, 0xe870, 0x1536, 0x5a75, 0x78a7, 0x1, 0x1);
        gbc.writeMem(0x4216, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xe7);
        EXPECT(gbc.b(),  0x15);
        EXPECT(gbc.c(),  0x36);
        EXPECT(gbc.d(),  0x5a);
        EXPECT(gbc.e(),  0x75);
        EXPECT(gbc.h(),  0x78);
        EXPECT(gbc.l(),  0xa7);
        EXPECT(gbc.sp(), 0x7543);
        EXPECT(gbc.pc(), 0x4217);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 00E5
        gbc.setState(0x2407, 0x683b, 0x9410, 0x1503, 0x8f58, 0xae96, 0x1, 0x0);
        gbc.writeMem(0x2407, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x93);
        EXPECT(gbc.b(),  0x15);
        EXPECT(gbc.c(),  0x3);
        EXPECT(gbc.d(),  0x8f);
        EXPECT(gbc.e(),  0x58);
        EXPECT(gbc.h(),  0xae);
        EXPECT(gbc.l(),  0x96);
        EXPECT(gbc.sp(), 0x683b);
        EXPECT(gbc.pc(), 0x2408);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 00E6
        gbc.setState(0x6914, 0x9d5d, 0x41e0, 0xe6bc, 0x5302, 0x31ea, 0x1, 0x1);
        gbc.writeMem(0x6914, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0xe6);
        EXPECT(gbc.c(),  0xbc);
        EXPECT(gbc.d(),  0x53);
        EXPECT(gbc.e(),  0x2);
        EXPECT(gbc.h(),  0x31);
        EXPECT(gbc.l(),  0xea);
        EXPECT(gbc.sp(), 0x9d5d);
        EXPECT(gbc.pc(), 0x6915);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 00E7
        gbc.setState(0x7ab0, 0x8954, 0x5e90, 0x6012, 0xef2e, 0xa768, 0x1, 0x1);
        gbc.writeMem(0x7ab0, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x5d);
        EXPECT(gbc.b(),  0x60);
        EXPECT(gbc.c(),  0x12);
        EXPECT(gbc.d(),  0xef);
        EXPECT(gbc.e(),  0x2e);
        EXPECT(gbc.h(),  0xa7);
        EXPECT(gbc.l(),  0x68);
        EXPECT(gbc.sp(), 0x8954);
        EXPECT(gbc.pc(), 0x7ab1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 00E8
        gbc.setState(0x5b45, 0xd17e, 0xd8a0, 0xbc19, 0x770d, 0x250, 0x1, 0x1);
        gbc.writeMem(0x5b45, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xd7);
        EXPECT(gbc.b(),  0xbc);
        EXPECT(gbc.c(),  0x19);
        EXPECT(gbc.d(),  0x77);
        EXPECT(gbc.e(),  0xd);
        EXPECT(gbc.h(),  0x2);
        EXPECT(gbc.l(),  0x50);
        EXPECT(gbc.sp(), 0xd17e);
        EXPECT(gbc.pc(), 0x5b46);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 00E9
        gbc.setState(0x928d, 0x38ba, 0x20a0, 0x8c2d, 0xdf5, 0x2d7b, 0x1, 0x0);
        gbc.writeMem(0x928d, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x1f);
        EXPECT(gbc.b(),  0x8c);
        EXPECT(gbc.c(),  0x2d);
        EXPECT(gbc.d(),  0xd);
        EXPECT(gbc.e(),  0xf5);
        EXPECT(gbc.h(),  0x2d);
        EXPECT(gbc.l(),  0x7b);
        EXPECT(gbc.sp(), 0x38ba);
        EXPECT(gbc.pc(), 0x928e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x928d), 0x3d);
        // 3D 00EA
        gbc.setState(0x2b37, 0x6bc4, 0x47d0, 0x9c3e, 0x514f, 0x82ae, 0x1, 0x1);
        gbc.writeMem(0x2b37, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x46);
        EXPECT(gbc.b(),  0x9c);
        EXPECT(gbc.c(),  0x3e);
        EXPECT(gbc.d(),  0x51);
        EXPECT(gbc.e(),  0x4f);
        EXPECT(gbc.h(),  0x82);
        EXPECT(gbc.l(),  0xae);
        EXPECT(gbc.sp(), 0x6bc4);
        EXPECT(gbc.pc(), 0x2b38);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 00EB
        gbc.setState(0xe86, 0xee08, 0xb3b0, 0x1e87, 0xdd2f, 0xf56b, 0x0, 0x0);
        gbc.writeMem(0xe86, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xb2);
        EXPECT(gbc.b(),  0x1e);
        EXPECT(gbc.c(),  0x87);
        EXPECT(gbc.d(),  0xdd);
        EXPECT(gbc.e(),  0x2f);
        EXPECT(gbc.h(),  0xf5);
        EXPECT(gbc.l(),  0x6b);
        EXPECT(gbc.sp(), 0xee08);
        EXPECT(gbc.pc(), 0xe87);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 00EC
        gbc.setState(0x255a, 0x4a94, 0x6df0, 0xc333, 0x81b8, 0x517f, 0x0, 0x0);
        gbc.writeMem(0x255a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x6c);
        EXPECT(gbc.b(),  0xc3);
        EXPECT(gbc.c(),  0x33);
        EXPECT(gbc.d(),  0x81);
        EXPECT(gbc.e(),  0xb8);
        EXPECT(gbc.h(),  0x51);
        EXPECT(gbc.l(),  0x7f);
        EXPECT(gbc.sp(), 0x4a94);
        EXPECT(gbc.pc(), 0x255b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 00ED
        gbc.setState(0xba67, 0xc64e, 0x8880, 0xdbc5, 0x938d, 0xe4f1, 0x1, 0x0);
        gbc.writeMem(0xba67, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x87);
        EXPECT(gbc.b(),  0xdb);
        EXPECT(gbc.c(),  0xc5);
        EXPECT(gbc.d(),  0x93);
        EXPECT(gbc.e(),  0x8d);
        EXPECT(gbc.h(),  0xe4);
        EXPECT(gbc.l(),  0xf1);
        EXPECT(gbc.sp(), 0xc64e);
        EXPECT(gbc.pc(), 0xba68);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xba67), 0x3d);
        // 3D 00EE
        gbc.setState(0xb85c, 0xb6ac, 0x2e60, 0xc05c, 0x2357, 0xd343, 0x1, 0x0);
        gbc.writeMem(0xb85c, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x2d);
        EXPECT(gbc.b(),  0xc0);
        EXPECT(gbc.c(),  0x5c);
        EXPECT(gbc.d(),  0x23);
        EXPECT(gbc.e(),  0x57);
        EXPECT(gbc.h(),  0xd3);
        EXPECT(gbc.l(),  0x43);
        EXPECT(gbc.sp(), 0xb6ac);
        EXPECT(gbc.pc(), 0xb85d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb85c), 0x3d);
        // 3D 00EF
        gbc.setState(0xbf4a, 0xca03, 0x7b60, 0x6af0, 0xa549, 0x23b3, 0x0, 0x1);
        gbc.writeMem(0xbf4a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x7a);
        EXPECT(gbc.b(),  0x6a);
        EXPECT(gbc.c(),  0xf0);
        EXPECT(gbc.d(),  0xa5);
        EXPECT(gbc.e(),  0x49);
        EXPECT(gbc.h(),  0x23);
        EXPECT(gbc.l(),  0xb3);
        EXPECT(gbc.sp(), 0xca03);
        EXPECT(gbc.pc(), 0xbf4b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbf4a), 0x3d);
        // 3D 00F0
        gbc.setState(0xdbad, 0xa7bf, 0xdbd0, 0x5a68, 0xf655, 0x7d3a, 0x1, 0x1);
        gbc.writeMem(0xdbad, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xda);
        EXPECT(gbc.b(),  0x5a);
        EXPECT(gbc.c(),  0x68);
        EXPECT(gbc.d(),  0xf6);
        EXPECT(gbc.e(),  0x55);
        EXPECT(gbc.h(),  0x7d);
        EXPECT(gbc.l(),  0x3a);
        EXPECT(gbc.sp(), 0xa7bf);
        EXPECT(gbc.pc(), 0xdbae);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xdbad), 0x3d);
        // 3D 00F1
        gbc.setState(0xe63c, 0xcb6d, 0xdb30, 0x5e9f, 0x4282, 0xed1, 0x0, 0x0);
        gbc.writeMem(0xe63c, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xda);
        EXPECT(gbc.b(),  0x5e);
        EXPECT(gbc.c(),  0x9f);
        EXPECT(gbc.d(),  0x42);
        EXPECT(gbc.e(),  0x82);
        EXPECT(gbc.h(),  0xe);
        EXPECT(gbc.l(),  0xd1);
        EXPECT(gbc.sp(), 0xcb6d);
        EXPECT(gbc.pc(), 0xe63d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe63c), 0x3d);
        // 3D 00F3
        gbc.setState(0xadf2, 0xd6b1, 0xf2d0, 0xc08e, 0x98a6, 0xd2, 0x1, 0x1);
        gbc.writeMem(0xadf2, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf1);
        EXPECT(gbc.b(),  0xc0);
        EXPECT(gbc.c(),  0x8e);
        EXPECT(gbc.d(),  0x98);
        EXPECT(gbc.e(),  0xa6);
        EXPECT(gbc.h(),  0x0);
        EXPECT(gbc.l(),  0xd2);
        EXPECT(gbc.sp(), 0xd6b1);
        EXPECT(gbc.pc(), 0xadf3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xadf2), 0x3d);
        // 3D 00F4
        gbc.setState(0x1da8, 0x5543, 0x1ef0, 0x7923, 0x7b77, 0x5b7d, 0x0, 0x1);
        gbc.writeMem(0x1da8, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x1d);
        EXPECT(gbc.b(),  0x79);
        EXPECT(gbc.c(),  0x23);
        EXPECT(gbc.d(),  0x7b);
        EXPECT(gbc.e(),  0x77);
        EXPECT(gbc.h(),  0x5b);
        EXPECT(gbc.l(),  0x7d);
        EXPECT(gbc.sp(), 0x5543);
        EXPECT(gbc.pc(), 0x1da9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 00F5
        gbc.setState(0xb1fd, 0xee10, 0xb720, 0xf15d, 0xd73e, 0x9d5d, 0x1, 0x0);
        gbc.writeMem(0xb1fd, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xb6);
        EXPECT(gbc.b(),  0xf1);
        EXPECT(gbc.c(),  0x5d);
        EXPECT(gbc.d(),  0xd7);
        EXPECT(gbc.e(),  0x3e);
        EXPECT(gbc.h(),  0x9d);
        EXPECT(gbc.l(),  0x5d);
        EXPECT(gbc.sp(), 0xee10);
        EXPECT(gbc.pc(), 0xb1fe);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb1fd), 0x3d);
        // 3D 00F6
        gbc.setState(0xc4f, 0x1224, 0xe700, 0x823b, 0x85d, 0x7ee4, 0x0, 0x1);
        gbc.writeMem(0xc4f, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xe6);
        EXPECT(gbc.b(),  0x82);
        EXPECT(gbc.c(),  0x3b);
        EXPECT(gbc.d(),  0x8);
        EXPECT(gbc.e(),  0x5d);
        EXPECT(gbc.h(),  0x7e);
        EXPECT(gbc.l(),  0xe4);
        EXPECT(gbc.sp(), 0x1224);
        EXPECT(gbc.pc(), 0xc50);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 00F7
        gbc.setState(0xa2a4, 0xc884, 0xff30, 0x1ddc, 0x1dc5, 0xf089, 0x0, 0x0);
        gbc.writeMem(0xa2a4, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xfe);
        EXPECT(gbc.b(),  0x1d);
        EXPECT(gbc.c(),  0xdc);
        EXPECT(gbc.d(),  0x1d);
        EXPECT(gbc.e(),  0xc5);
        EXPECT(gbc.h(),  0xf0);
        EXPECT(gbc.l(),  0x89);
        EXPECT(gbc.sp(), 0xc884);
        EXPECT(gbc.pc(), 0xa2a5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa2a4), 0x3d);
        // 3D 00F8
        gbc.setState(0x93e2, 0x2bf2, 0xaf50, 0xbaea, 0xb781, 0xe778, 0x0, 0x1);
        gbc.writeMem(0x93e2, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xae);
        EXPECT(gbc.b(),  0xba);
        EXPECT(gbc.c(),  0xea);
        EXPECT(gbc.d(),  0xb7);
        EXPECT(gbc.e(),  0x81);
        EXPECT(gbc.h(),  0xe7);
        EXPECT(gbc.l(),  0x78);
        EXPECT(gbc.sp(), 0x2bf2);
        EXPECT(gbc.pc(), 0x93e3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x93e2), 0x3d);
        // 3D 00F9
        gbc.setState(0x14b7, 0x3986, 0x3d50, 0xe727, 0x4be8, 0x2f08, 0x1, 0x1);
        gbc.writeMem(0x14b7, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x3c);
        EXPECT(gbc.b(),  0xe7);
        EXPECT(gbc.c(),  0x27);
        EXPECT(gbc.d(),  0x4b);
        EXPECT(gbc.e(),  0xe8);
        EXPECT(gbc.h(),  0x2f);
        EXPECT(gbc.l(),  0x8);
        EXPECT(gbc.sp(), 0x3986);
        EXPECT(gbc.pc(), 0x14b8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 00FA
        gbc.setState(0x6581, 0x95ed, 0xeed0, 0xe8b9, 0x5bab, 0x5537, 0x1, 0x0);
        gbc.writeMem(0x6581, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xed);
        EXPECT(gbc.b(),  0xe8);
        EXPECT(gbc.c(),  0xb9);
        EXPECT(gbc.d(),  0x5b);
        EXPECT(gbc.e(),  0xab);
        EXPECT(gbc.h(),  0x55);
        EXPECT(gbc.l(),  0x37);
        EXPECT(gbc.sp(), 0x95ed);
        EXPECT(gbc.pc(), 0x6582);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 00FB
        gbc.setState(0x8a0c, 0x3832, 0x7280, 0xbd05, 0x53b, 0x5d8a, 0x0, 0x1);
        gbc.writeMem(0x8a0c, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x71);
        EXPECT(gbc.b(),  0xbd);
        EXPECT(gbc.c(),  0x5);
        EXPECT(gbc.d(),  0x5);
        EXPECT(gbc.e(),  0x3b);
        EXPECT(gbc.h(),  0x5d);
        EXPECT(gbc.l(),  0x8a);
        EXPECT(gbc.sp(), 0x3832);
        EXPECT(gbc.pc(), 0x8a0d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8a0c), 0x3d);
        // 3D 00FC
        gbc.setState(0xab38, 0xc83e, 0x8710, 0xebc3, 0x2df, 0x16d1, 0x0, 0x0);
        gbc.writeMem(0xab38, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x86);
        EXPECT(gbc.b(),  0xeb);
        EXPECT(gbc.c(),  0xc3);
        EXPECT(gbc.d(),  0x2);
        EXPECT(gbc.e(),  0xdf);
        EXPECT(gbc.h(),  0x16);
        EXPECT(gbc.l(),  0xd1);
        EXPECT(gbc.sp(), 0xc83e);
        EXPECT(gbc.pc(), 0xab39);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xab38), 0x3d);
        // 3D 00FD
        gbc.setState(0x7809, 0xc8b5, 0x3680, 0x29ba, 0x3f17, 0x2369, 0x0, 0x1);
        gbc.writeMem(0x7809, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x35);
        EXPECT(gbc.b(),  0x29);
        EXPECT(gbc.c(),  0xba);
        EXPECT(gbc.d(),  0x3f);
        EXPECT(gbc.e(),  0x17);
        EXPECT(gbc.h(),  0x23);
        EXPECT(gbc.l(),  0x69);
        EXPECT(gbc.sp(), 0xc8b5);
        EXPECT(gbc.pc(), 0x780a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 00FE
        gbc.setState(0xe263, 0x13ae, 0x6880, 0x3cc3, 0x2d19, 0x1389, 0x1, 0x1);
        gbc.writeMem(0xe263, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x67);
        EXPECT(gbc.b(),  0x3c);
        EXPECT(gbc.c(),  0xc3);
        EXPECT(gbc.d(),  0x2d);
        EXPECT(gbc.e(),  0x19);
        EXPECT(gbc.h(),  0x13);
        EXPECT(gbc.l(),  0x89);
        EXPECT(gbc.sp(), 0x13ae);
        EXPECT(gbc.pc(), 0xe264);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe263), 0x3d);
        // 3D 00FF
        gbc.setState(0xa203, 0xfcda, 0xba30, 0x6e8e, 0x423b, 0x6644, 0x1, 0x0);
        gbc.writeMem(0xa203, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xb9);
        EXPECT(gbc.b(),  0x6e);
        EXPECT(gbc.c(),  0x8e);
        EXPECT(gbc.d(),  0x42);
        EXPECT(gbc.e(),  0x3b);
        EXPECT(gbc.h(),  0x66);
        EXPECT(gbc.l(),  0x44);
        EXPECT(gbc.sp(), 0xfcda);
        EXPECT(gbc.pc(), 0xa204);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa203), 0x3d);
        // 3D 0100
        gbc.setState(0xefdb, 0x1c9a, 0x6c00, 0x95a, 0xd015, 0x4ec2, 0x0, 0x1);
        gbc.writeMem(0xefdb, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x6b);
        EXPECT(gbc.b(),  0x9);
        EXPECT(gbc.c(),  0x5a);
        EXPECT(gbc.d(),  0xd0);
        EXPECT(gbc.e(),  0x15);
        EXPECT(gbc.h(),  0x4e);
        EXPECT(gbc.l(),  0xc2);
        EXPECT(gbc.sp(), 0x1c9a);
        EXPECT(gbc.pc(), 0xefdc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xefdb), 0x3d);
        // 3D 0101
        gbc.setState(0x666, 0x680d, 0x9720, 0x7906, 0xe63d, 0xb7d3, 0x0, 0x0);
        gbc.writeMem(0x666, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x96);
        EXPECT(gbc.b(),  0x79);
        EXPECT(gbc.c(),  0x6);
        EXPECT(gbc.d(),  0xe6);
        EXPECT(gbc.e(),  0x3d);
        EXPECT(gbc.h(),  0xb7);
        EXPECT(gbc.l(),  0xd3);
        EXPECT(gbc.sp(), 0x680d);
        EXPECT(gbc.pc(), 0x667);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0102
        gbc.setState(0xadc0, 0x61f3, 0x1620, 0xb2d8, 0xa139, 0xf2cc, 0x0, 0x0);
        gbc.writeMem(0xadc0, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x15);
        EXPECT(gbc.b(),  0xb2);
        EXPECT(gbc.c(),  0xd8);
        EXPECT(gbc.d(),  0xa1);
        EXPECT(gbc.e(),  0x39);
        EXPECT(gbc.h(),  0xf2);
        EXPECT(gbc.l(),  0xcc);
        EXPECT(gbc.sp(), 0x61f3);
        EXPECT(gbc.pc(), 0xadc1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xadc0), 0x3d);
        // 3D 0103
        gbc.setState(0x64b2, 0x3829, 0xc6d0, 0xef17, 0x374c, 0x39ba, 0x0, 0x1);
        gbc.writeMem(0x64b2, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xc5);
        EXPECT(gbc.b(),  0xef);
        EXPECT(gbc.c(),  0x17);
        EXPECT(gbc.d(),  0x37);
        EXPECT(gbc.e(),  0x4c);
        EXPECT(gbc.h(),  0x39);
        EXPECT(gbc.l(),  0xba);
        EXPECT(gbc.sp(), 0x3829);
        EXPECT(gbc.pc(), 0x64b3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0104
        gbc.setState(0x58f3, 0x5966, 0x36e0, 0xb87e, 0x7e64, 0xdcd6, 0x1, 0x0);
        gbc.writeMem(0x58f3, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x35);
        EXPECT(gbc.b(),  0xb8);
        EXPECT(gbc.c(),  0x7e);
        EXPECT(gbc.d(),  0x7e);
        EXPECT(gbc.e(),  0x64);
        EXPECT(gbc.h(),  0xdc);
        EXPECT(gbc.l(),  0xd6);
        EXPECT(gbc.sp(), 0x5966);
        EXPECT(gbc.pc(), 0x58f4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0105
        gbc.setState(0x75be, 0x8652, 0x7280, 0xf570, 0x4cee, 0x1f34, 0x1, 0x1);
        gbc.writeMem(0x75be, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x71);
        EXPECT(gbc.b(),  0xf5);
        EXPECT(gbc.c(),  0x70);
        EXPECT(gbc.d(),  0x4c);
        EXPECT(gbc.e(),  0xee);
        EXPECT(gbc.h(),  0x1f);
        EXPECT(gbc.l(),  0x34);
        EXPECT(gbc.sp(), 0x8652);
        EXPECT(gbc.pc(), 0x75bf);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0106
        gbc.setState(0x82cd, 0x7a2f, 0x5690, 0xe229, 0xee10, 0x3110, 0x0, 0x0);
        gbc.writeMem(0x82cd, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x55);
        EXPECT(gbc.b(),  0xe2);
        EXPECT(gbc.c(),  0x29);
        EXPECT(gbc.d(),  0xee);
        EXPECT(gbc.e(),  0x10);
        EXPECT(gbc.h(),  0x31);
        EXPECT(gbc.l(),  0x10);
        EXPECT(gbc.sp(), 0x7a2f);
        EXPECT(gbc.pc(), 0x82ce);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x82cd), 0x3d);
        // 3D 0108
        gbc.setState(0xb7f9, 0x43ff, 0x4180, 0x922a, 0x2d83, 0xcbea, 0x1, 0x0);
        gbc.writeMem(0xb7f9, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x40);
        EXPECT(gbc.b(),  0x92);
        EXPECT(gbc.c(),  0x2a);
        EXPECT(gbc.d(),  0x2d);
        EXPECT(gbc.e(),  0x83);
        EXPECT(gbc.h(),  0xcb);
        EXPECT(gbc.l(),  0xea);
        EXPECT(gbc.sp(), 0x43ff);
        EXPECT(gbc.pc(), 0xb7fa);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb7f9), 0x3d);
        // 3D 0109
        gbc.setState(0x316a, 0xae27, 0x7d90, 0x6178, 0x2310, 0xb3ef, 0x0, 0x1);
        gbc.writeMem(0x316a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x7c);
        EXPECT(gbc.b(),  0x61);
        EXPECT(gbc.c(),  0x78);
        EXPECT(gbc.d(),  0x23);
        EXPECT(gbc.e(),  0x10);
        EXPECT(gbc.h(),  0xb3);
        EXPECT(gbc.l(),  0xef);
        EXPECT(gbc.sp(), 0xae27);
        EXPECT(gbc.pc(), 0x316b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 010A
        gbc.setState(0xe484, 0xef74, 0xe6e0, 0xd79a, 0x2103, 0x26c8, 0x0, 0x0);
        gbc.writeMem(0xe484, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xe5);
        EXPECT(gbc.b(),  0xd7);
        EXPECT(gbc.c(),  0x9a);
        EXPECT(gbc.d(),  0x21);
        EXPECT(gbc.e(),  0x3);
        EXPECT(gbc.h(),  0x26);
        EXPECT(gbc.l(),  0xc8);
        EXPECT(gbc.sp(), 0xef74);
        EXPECT(gbc.pc(), 0xe485);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe484), 0x3d);
        // 3D 010B
        gbc.setState(0xe18a, 0x59c3, 0x22c0, 0xeec, 0x6ed, 0x806a, 0x1, 0x1);
        gbc.writeMem(0xe18a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x21);
        EXPECT(gbc.b(),  0xe);
        EXPECT(gbc.c(),  0xec);
        EXPECT(gbc.d(),  0x6);
        EXPECT(gbc.e(),  0xed);
        EXPECT(gbc.h(),  0x80);
        EXPECT(gbc.l(),  0x6a);
        EXPECT(gbc.sp(), 0x59c3);
        EXPECT(gbc.pc(), 0xe18b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe18a), 0x3d);
        // 3D 010C
        gbc.setState(0x58c, 0x6f1c, 0x87c0, 0x675d, 0x5ff1, 0x9c9f, 0x0, 0x0);
        gbc.writeMem(0x58c, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x86);
        EXPECT(gbc.b(),  0x67);
        EXPECT(gbc.c(),  0x5d);
        EXPECT(gbc.d(),  0x5f);
        EXPECT(gbc.e(),  0xf1);
        EXPECT(gbc.h(),  0x9c);
        EXPECT(gbc.l(),  0x9f);
        EXPECT(gbc.sp(), 0x6f1c);
        EXPECT(gbc.pc(), 0x58d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 010D
        gbc.setState(0xb2bd, 0x2ef5, 0xbba0, 0xf3e3, 0x4e03, 0xb133, 0x1, 0x0);
        gbc.writeMem(0xb2bd, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xba);
        EXPECT(gbc.b(),  0xf3);
        EXPECT(gbc.c(),  0xe3);
        EXPECT(gbc.d(),  0x4e);
        EXPECT(gbc.e(),  0x3);
        EXPECT(gbc.h(),  0xb1);
        EXPECT(gbc.l(),  0x33);
        EXPECT(gbc.sp(), 0x2ef5);
        EXPECT(gbc.pc(), 0xb2be);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb2bd), 0x3d);
        // 3D 010E
        gbc.setState(0xa550, 0xb761, 0xffd0, 0xb002, 0xc42a, 0x7adc, 0x1, 0x0);
        gbc.writeMem(0xa550, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xfe);
        EXPECT(gbc.b(),  0xb0);
        EXPECT(gbc.c(),  0x2);
        EXPECT(gbc.d(),  0xc4);
        EXPECT(gbc.e(),  0x2a);
        EXPECT(gbc.h(),  0x7a);
        EXPECT(gbc.l(),  0xdc);
        EXPECT(gbc.sp(), 0xb761);
        EXPECT(gbc.pc(), 0xa551);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa550), 0x3d);
        // 3D 0110
        gbc.setState(0x9b50, 0x680c, 0x2810, 0xcb8e, 0xd71b, 0x14ce, 0x1, 0x1);
        gbc.writeMem(0x9b50, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x27);
        EXPECT(gbc.b(),  0xcb);
        EXPECT(gbc.c(),  0x8e);
        EXPECT(gbc.d(),  0xd7);
        EXPECT(gbc.e(),  0x1b);
        EXPECT(gbc.h(),  0x14);
        EXPECT(gbc.l(),  0xce);
        EXPECT(gbc.sp(), 0x680c);
        EXPECT(gbc.pc(), 0x9b51);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9b50), 0x3d);
        // 3D 0111
        gbc.setState(0x8529, 0x257c, 0x87e0, 0xffe2, 0x5a7f, 0xaec2, 0x1, 0x0);
        gbc.writeMem(0x8529, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x86);
        EXPECT(gbc.b(),  0xff);
        EXPECT(gbc.c(),  0xe2);
        EXPECT(gbc.d(),  0x5a);
        EXPECT(gbc.e(),  0x7f);
        EXPECT(gbc.h(),  0xae);
        EXPECT(gbc.l(),  0xc2);
        EXPECT(gbc.sp(), 0x257c);
        EXPECT(gbc.pc(), 0x852a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8529), 0x3d);
        // 3D 0112
        gbc.setState(0xc207, 0x14a8, 0xecd0, 0x6af9, 0x10a7, 0x543a, 0x1, 0x1);
        gbc.writeMem(0xc207, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xeb);
        EXPECT(gbc.b(),  0x6a);
        EXPECT(gbc.c(),  0xf9);
        EXPECT(gbc.d(),  0x10);
        EXPECT(gbc.e(),  0xa7);
        EXPECT(gbc.h(),  0x54);
        EXPECT(gbc.l(),  0x3a);
        EXPECT(gbc.sp(), 0x14a8);
        EXPECT(gbc.pc(), 0xc208);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc207), 0x3d);
        // 3D 0113
        gbc.setState(0x117f, 0xd83a, 0x68b0, 0xd92f, 0x7f0e, 0xf3f6, 0x0, 0x1);
        gbc.writeMem(0x117f, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x67);
        EXPECT(gbc.b(),  0xd9);
        EXPECT(gbc.c(),  0x2f);
        EXPECT(gbc.d(),  0x7f);
        EXPECT(gbc.e(),  0xe);
        EXPECT(gbc.h(),  0xf3);
        EXPECT(gbc.l(),  0xf6);
        EXPECT(gbc.sp(), 0xd83a);
        EXPECT(gbc.pc(), 0x1180);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0114
        gbc.setState(0xb160, 0x40a6, 0x8a90, 0x1e98, 0xddd3, 0x2bf7, 0x0, 0x0);
        gbc.writeMem(0xb160, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x89);
        EXPECT(gbc.b(),  0x1e);
        EXPECT(gbc.c(),  0x98);
        EXPECT(gbc.d(),  0xdd);
        EXPECT(gbc.e(),  0xd3);
        EXPECT(gbc.h(),  0x2b);
        EXPECT(gbc.l(),  0xf7);
        EXPECT(gbc.sp(), 0x40a6);
        EXPECT(gbc.pc(), 0xb161);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb160), 0x3d);
        // 3D 0115
        gbc.setState(0xb8f, 0xb8cc, 0xd110, 0x5476, 0x8d9a, 0x4b29, 0x1, 0x0);
        gbc.writeMem(0xb8f, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xd0);
        EXPECT(gbc.b(),  0x54);
        EXPECT(gbc.c(),  0x76);
        EXPECT(gbc.d(),  0x8d);
        EXPECT(gbc.e(),  0x9a);
        EXPECT(gbc.h(),  0x4b);
        EXPECT(gbc.l(),  0x29);
        EXPECT(gbc.sp(), 0xb8cc);
        EXPECT(gbc.pc(), 0xb90);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0116
        gbc.setState(0x164a, 0xf5df, 0xcb70, 0x3a63, 0x409, 0x8c7c, 0x0, 0x0);
        gbc.writeMem(0x164a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xca);
        EXPECT(gbc.b(),  0x3a);
        EXPECT(gbc.c(),  0x63);
        EXPECT(gbc.d(),  0x4);
        EXPECT(gbc.e(),  0x9);
        EXPECT(gbc.h(),  0x8c);
        EXPECT(gbc.l(),  0x7c);
        EXPECT(gbc.sp(), 0xf5df);
        EXPECT(gbc.pc(), 0x164b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0118
        gbc.setState(0x109f, 0xed01, 0x3450, 0xba19, 0xa7d7, 0x185, 0x1, 0x0);
        gbc.writeMem(0x109f, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x33);
        EXPECT(gbc.b(),  0xba);
        EXPECT(gbc.c(),  0x19);
        EXPECT(gbc.d(),  0xa7);
        EXPECT(gbc.e(),  0xd7);
        EXPECT(gbc.h(),  0x1);
        EXPECT(gbc.l(),  0x85);
        EXPECT(gbc.sp(), 0xed01);
        EXPECT(gbc.pc(), 0x10a0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0119
        gbc.setState(0x66a3, 0xa556, 0x77f0, 0x870b, 0x2d5b, 0xd8e6, 0x1, 0x0);
        gbc.writeMem(0x66a3, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x76);
        EXPECT(gbc.b(),  0x87);
        EXPECT(gbc.c(),  0xb);
        EXPECT(gbc.d(),  0x2d);
        EXPECT(gbc.e(),  0x5b);
        EXPECT(gbc.h(),  0xd8);
        EXPECT(gbc.l(),  0xe6);
        EXPECT(gbc.sp(), 0xa556);
        EXPECT(gbc.pc(), 0x66a4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 011A
        gbc.setState(0x2f7f, 0xf3c1, 0xdea0, 0xe2e6, 0x18f1, 0x3e27, 0x1, 0x0);
        gbc.writeMem(0x2f7f, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xdd);
        EXPECT(gbc.b(),  0xe2);
        EXPECT(gbc.c(),  0xe6);
        EXPECT(gbc.d(),  0x18);
        EXPECT(gbc.e(),  0xf1);
        EXPECT(gbc.h(),  0x3e);
        EXPECT(gbc.l(),  0x27);
        EXPECT(gbc.sp(), 0xf3c1);
        EXPECT(gbc.pc(), 0x2f80);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 011B
        gbc.setState(0x8f59, 0xb228, 0xf160, 0xb7ab, 0x31bb, 0x2320, 0x1, 0x0);
        gbc.writeMem(0x8f59, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf0);
        EXPECT(gbc.b(),  0xb7);
        EXPECT(gbc.c(),  0xab);
        EXPECT(gbc.d(),  0x31);
        EXPECT(gbc.e(),  0xbb);
        EXPECT(gbc.h(),  0x23);
        EXPECT(gbc.l(),  0x20);
        EXPECT(gbc.sp(), 0xb228);
        EXPECT(gbc.pc(), 0x8f5a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8f59), 0x3d);
        // 3D 011C
        gbc.setState(0x324e, 0x2f3b, 0x8e0, 0xe13a, 0x6446, 0xd74e, 0x1, 0x1);
        gbc.writeMem(0x324e, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x7);
        EXPECT(gbc.b(),  0xe1);
        EXPECT(gbc.c(),  0x3a);
        EXPECT(gbc.d(),  0x64);
        EXPECT(gbc.e(),  0x46);
        EXPECT(gbc.h(),  0xd7);
        EXPECT(gbc.l(),  0x4e);
        EXPECT(gbc.sp(), 0x2f3b);
        EXPECT(gbc.pc(), 0x324f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 011D
        gbc.setState(0x8c22, 0xe10e, 0x2430, 0xc6f0, 0x9399, 0xacb1, 0x0, 0x0);
        gbc.writeMem(0x8c22, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x23);
        EXPECT(gbc.b(),  0xc6);
        EXPECT(gbc.c(),  0xf0);
        EXPECT(gbc.d(),  0x93);
        EXPECT(gbc.e(),  0x99);
        EXPECT(gbc.h(),  0xac);
        EXPECT(gbc.l(),  0xb1);
        EXPECT(gbc.sp(), 0xe10e);
        EXPECT(gbc.pc(), 0x8c23);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8c22), 0x3d);
        // 3D 011E
        gbc.setState(0x1162, 0x6182, 0x6300, 0xdf40, 0x115a, 0x8b92, 0x0, 0x0);
        gbc.writeMem(0x1162, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x62);
        EXPECT(gbc.b(),  0xdf);
        EXPECT(gbc.c(),  0x40);
        EXPECT(gbc.d(),  0x11);
        EXPECT(gbc.e(),  0x5a);
        EXPECT(gbc.h(),  0x8b);
        EXPECT(gbc.l(),  0x92);
        EXPECT(gbc.sp(), 0x6182);
        EXPECT(gbc.pc(), 0x1163);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0121
        gbc.setState(0x148e, 0x8123, 0xe9f0, 0x6f42, 0x4edb, 0x2593, 0x1, 0x0);
        gbc.writeMem(0x148e, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xe8);
        EXPECT(gbc.b(),  0x6f);
        EXPECT(gbc.c(),  0x42);
        EXPECT(gbc.d(),  0x4e);
        EXPECT(gbc.e(),  0xdb);
        EXPECT(gbc.h(),  0x25);
        EXPECT(gbc.l(),  0x93);
        EXPECT(gbc.sp(), 0x8123);
        EXPECT(gbc.pc(), 0x148f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0122
        gbc.setState(0x845a, 0x2bf0, 0x1510, 0xec8f, 0x5ee0, 0xc19b, 0x1, 0x1);
        gbc.writeMem(0x845a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x14);
        EXPECT(gbc.b(),  0xec);
        EXPECT(gbc.c(),  0x8f);
        EXPECT(gbc.d(),  0x5e);
        EXPECT(gbc.e(),  0xe0);
        EXPECT(gbc.h(),  0xc1);
        EXPECT(gbc.l(),  0x9b);
        EXPECT(gbc.sp(), 0x2bf0);
        EXPECT(gbc.pc(), 0x845b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x845a), 0x3d);
        // 3D 0123
        gbc.setState(0x6e00, 0xed5a, 0xb1d0, 0xef37, 0x9145, 0x796a, 0x0, 0x0);
        gbc.writeMem(0x6e00, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xb0);
        EXPECT(gbc.b(),  0xef);
        EXPECT(gbc.c(),  0x37);
        EXPECT(gbc.d(),  0x91);
        EXPECT(gbc.e(),  0x45);
        EXPECT(gbc.h(),  0x79);
        EXPECT(gbc.l(),  0x6a);
        EXPECT(gbc.sp(), 0xed5a);
        EXPECT(gbc.pc(), 0x6e01);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0126
        gbc.setState(0x1847, 0x197e, 0xfe00, 0xd14d, 0x8ebd, 0x3688, 0x1, 0x0);
        gbc.writeMem(0x1847, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xfd);
        EXPECT(gbc.b(),  0xd1);
        EXPECT(gbc.c(),  0x4d);
        EXPECT(gbc.d(),  0x8e);
        EXPECT(gbc.e(),  0xbd);
        EXPECT(gbc.h(),  0x36);
        EXPECT(gbc.l(),  0x88);
        EXPECT(gbc.sp(), 0x197e);
        EXPECT(gbc.pc(), 0x1848);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0127
        gbc.setState(0xa032, 0x4036, 0x6e70, 0xa808, 0xae84, 0xf4da, 0x1, 0x0);
        gbc.writeMem(0xa032, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x6d);
        EXPECT(gbc.b(),  0xa8);
        EXPECT(gbc.c(),  0x8);
        EXPECT(gbc.d(),  0xae);
        EXPECT(gbc.e(),  0x84);
        EXPECT(gbc.h(),  0xf4);
        EXPECT(gbc.l(),  0xda);
        EXPECT(gbc.sp(), 0x4036);
        EXPECT(gbc.pc(), 0xa033);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa032), 0x3d);
        // 3D 0128
        gbc.setState(0x5828, 0x7b60, 0x46a0, 0x152a, 0xed82, 0x5562, 0x0, 0x1);
        gbc.writeMem(0x5828, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x45);
        EXPECT(gbc.b(),  0x15);
        EXPECT(gbc.c(),  0x2a);
        EXPECT(gbc.d(),  0xed);
        EXPECT(gbc.e(),  0x82);
        EXPECT(gbc.h(),  0x55);
        EXPECT(gbc.l(),  0x62);
        EXPECT(gbc.sp(), 0x7b60);
        EXPECT(gbc.pc(), 0x5829);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0129
        gbc.setState(0x15a3, 0x811c, 0x6d80, 0xca68, 0xb4d8, 0x20f, 0x1, 0x1);
        gbc.writeMem(0x15a3, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x6c);
        EXPECT(gbc.b(),  0xca);
        EXPECT(gbc.c(),  0x68);
        EXPECT(gbc.d(),  0xb4);
        EXPECT(gbc.e(),  0xd8);
        EXPECT(gbc.h(),  0x2);
        EXPECT(gbc.l(),  0xf);
        EXPECT(gbc.sp(), 0x811c);
        EXPECT(gbc.pc(), 0x15a4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 012A
        gbc.setState(0x9c53, 0xcfc, 0xc240, 0x11c4, 0x6057, 0x99c8, 0x1, 0x1);
        gbc.writeMem(0x9c53, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xc1);
        EXPECT(gbc.b(),  0x11);
        EXPECT(gbc.c(),  0xc4);
        EXPECT(gbc.d(),  0x60);
        EXPECT(gbc.e(),  0x57);
        EXPECT(gbc.h(),  0x99);
        EXPECT(gbc.l(),  0xc8);
        EXPECT(gbc.sp(), 0xcfc);
        EXPECT(gbc.pc(), 0x9c54);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9c53), 0x3d);
        // 3D 012B
        gbc.setState(0x13fc, 0x82a0, 0x5c80, 0x9bc1, 0xcde7, 0x8769, 0x0, 0x0);
        gbc.writeMem(0x13fc, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x5b);
        EXPECT(gbc.b(),  0x9b);
        EXPECT(gbc.c(),  0xc1);
        EXPECT(gbc.d(),  0xcd);
        EXPECT(gbc.e(),  0xe7);
        EXPECT(gbc.h(),  0x87);
        EXPECT(gbc.l(),  0x69);
        EXPECT(gbc.sp(), 0x82a0);
        EXPECT(gbc.pc(), 0x13fd);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 012C
        gbc.setState(0xb668, 0xbbbb, 0xeca0, 0xc8c2, 0x1bf0, 0x3cd6, 0x0, 0x1);
        gbc.writeMem(0xb668, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xeb);
        EXPECT(gbc.b(),  0xc8);
        EXPECT(gbc.c(),  0xc2);
        EXPECT(gbc.d(),  0x1b);
        EXPECT(gbc.e(),  0xf0);
        EXPECT(gbc.h(),  0x3c);
        EXPECT(gbc.l(),  0xd6);
        EXPECT(gbc.sp(), 0xbbbb);
        EXPECT(gbc.pc(), 0xb669);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb668), 0x3d);
        // 3D 012D
        gbc.setState(0xd670, 0xcf3b, 0xed80, 0xddaa, 0xf5, 0x6481, 0x0, 0x0);
        gbc.writeMem(0xd670, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xec);
        EXPECT(gbc.b(),  0xdd);
        EXPECT(gbc.c(),  0xaa);
        EXPECT(gbc.d(),  0x0);
        EXPECT(gbc.e(),  0xf5);
        EXPECT(gbc.h(),  0x64);
        EXPECT(gbc.l(),  0x81);
        EXPECT(gbc.sp(), 0xcf3b);
        EXPECT(gbc.pc(), 0xd671);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd670), 0x3d);
        // 3D 012E
        gbc.setState(0x69d1, 0x575d, 0xfa40, 0xa644, 0xe986, 0xb27e, 0x1, 0x0);
        gbc.writeMem(0x69d1, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf9);
        EXPECT(gbc.b(),  0xa6);
        EXPECT(gbc.c(),  0x44);
        EXPECT(gbc.d(),  0xe9);
        EXPECT(gbc.e(),  0x86);
        EXPECT(gbc.h(),  0xb2);
        EXPECT(gbc.l(),  0x7e);
        EXPECT(gbc.sp(), 0x575d);
        EXPECT(gbc.pc(), 0x69d2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 012F
        gbc.setState(0x1eec, 0x76a6, 0x8e90, 0xadec, 0x8610, 0xed04, 0x0, 0x0);
        gbc.writeMem(0x1eec, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x8d);
        EXPECT(gbc.b(),  0xad);
        EXPECT(gbc.c(),  0xec);
        EXPECT(gbc.d(),  0x86);
        EXPECT(gbc.e(),  0x10);
        EXPECT(gbc.h(),  0xed);
        EXPECT(gbc.l(),  0x4);
        EXPECT(gbc.sp(), 0x76a6);
        EXPECT(gbc.pc(), 0x1eed);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0130
        gbc.setState(0x8fbc, 0xea77, 0xdf0, 0x2852, 0xae70, 0x3de6, 0x0, 0x1);
        gbc.writeMem(0x8fbc, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xc);
        EXPECT(gbc.b(),  0x28);
        EXPECT(gbc.c(),  0x52);
        EXPECT(gbc.d(),  0xae);
        EXPECT(gbc.e(),  0x70);
        EXPECT(gbc.h(),  0x3d);
        EXPECT(gbc.l(),  0xe6);
        EXPECT(gbc.sp(), 0xea77);
        EXPECT(gbc.pc(), 0x8fbd);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8fbc), 0x3d);
        // 3D 0131
        gbc.setState(0x6015, 0x669c, 0xa890, 0x773a, 0x28ad, 0x7eb8, 0x0, 0x1);
        gbc.writeMem(0x6015, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa7);
        EXPECT(gbc.b(),  0x77);
        EXPECT(gbc.c(),  0x3a);
        EXPECT(gbc.d(),  0x28);
        EXPECT(gbc.e(),  0xad);
        EXPECT(gbc.h(),  0x7e);
        EXPECT(gbc.l(),  0xb8);
        EXPECT(gbc.sp(), 0x669c);
        EXPECT(gbc.pc(), 0x6016);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0132
        gbc.setState(0x4355, 0x3dfa, 0x8090, 0xd0d6, 0xa9bd, 0xeced, 0x1, 0x0);
        gbc.writeMem(0x4355, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x7f);
        EXPECT(gbc.b(),  0xd0);
        EXPECT(gbc.c(),  0xd6);
        EXPECT(gbc.d(),  0xa9);
        EXPECT(gbc.e(),  0xbd);
        EXPECT(gbc.h(),  0xec);
        EXPECT(gbc.l(),  0xed);
        EXPECT(gbc.sp(), 0x3dfa);
        EXPECT(gbc.pc(), 0x4356);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 3D 0133
        gbc.setState(0x9f30, 0x8b04, 0xd630, 0xc31e, 0x20ad, 0xd321, 0x1, 0x0);
        gbc.writeMem(0x9f30, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xd5);
        EXPECT(gbc.b(),  0xc3);
        EXPECT(gbc.c(),  0x1e);
        EXPECT(gbc.d(),  0x20);
        EXPECT(gbc.e(),  0xad);
        EXPECT(gbc.h(),  0xd3);
        EXPECT(gbc.l(),  0x21);
        EXPECT(gbc.sp(), 0x8b04);
        EXPECT(gbc.pc(), 0x9f31);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9f30), 0x3d);
        // 3D 0134
        gbc.setState(0x4b9e, 0xee97, 0x4410, 0xa14b, 0xb994, 0x934e, 0x0, 0x0);
        gbc.writeMem(0x4b9e, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x43);
        EXPECT(gbc.b(),  0xa1);
        EXPECT(gbc.c(),  0x4b);
        EXPECT(gbc.d(),  0xb9);
        EXPECT(gbc.e(),  0x94);
        EXPECT(gbc.h(),  0x93);
        EXPECT(gbc.l(),  0x4e);
        EXPECT(gbc.sp(), 0xee97);
        EXPECT(gbc.pc(), 0x4b9f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0135
        gbc.setState(0xc8e5, 0x7180, 0x3540, 0xe525, 0xf903, 0x8701, 0x0, 0x1);
        gbc.writeMem(0xc8e5, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x34);
        EXPECT(gbc.b(),  0xe5);
        EXPECT(gbc.c(),  0x25);
        EXPECT(gbc.d(),  0xf9);
        EXPECT(gbc.e(),  0x3);
        EXPECT(gbc.h(),  0x87);
        EXPECT(gbc.l(),  0x1);
        EXPECT(gbc.sp(), 0x7180);
        EXPECT(gbc.pc(), 0xc8e6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc8e5), 0x3d);
        // 3D 0136
        gbc.setState(0x8647, 0x53eb, 0x8640, 0xfa52, 0x2e06, 0xaba5, 0x1, 0x1);
        gbc.writeMem(0x8647, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x85);
        EXPECT(gbc.b(),  0xfa);
        EXPECT(gbc.c(),  0x52);
        EXPECT(gbc.d(),  0x2e);
        EXPECT(gbc.e(),  0x6);
        EXPECT(gbc.h(),  0xab);
        EXPECT(gbc.l(),  0xa5);
        EXPECT(gbc.sp(), 0x53eb);
        EXPECT(gbc.pc(), 0x8648);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8647), 0x3d);
        // 3D 0137
        gbc.setState(0xcf40, 0x35b1, 0xd330, 0x4a10, 0xa13c, 0x8167, 0x1, 0x1);
        gbc.writeMem(0xcf40, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xd2);
        EXPECT(gbc.b(),  0x4a);
        EXPECT(gbc.c(),  0x10);
        EXPECT(gbc.d(),  0xa1);
        EXPECT(gbc.e(),  0x3c);
        EXPECT(gbc.h(),  0x81);
        EXPECT(gbc.l(),  0x67);
        EXPECT(gbc.sp(), 0x35b1);
        EXPECT(gbc.pc(), 0xcf41);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcf40), 0x3d);
        // 3D 0138
        gbc.setState(0x9f8d, 0x9f70, 0xe060, 0xfe69, 0xc406, 0x7139, 0x1, 0x0);
        gbc.writeMem(0x9f8d, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xdf);
        EXPECT(gbc.b(),  0xfe);
        EXPECT(gbc.c(),  0x69);
        EXPECT(gbc.d(),  0xc4);
        EXPECT(gbc.e(),  0x6);
        EXPECT(gbc.h(),  0x71);
        EXPECT(gbc.l(),  0x39);
        EXPECT(gbc.sp(), 0x9f70);
        EXPECT(gbc.pc(), 0x9f8e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9f8d), 0x3d);
        // 3D 0139
        gbc.setState(0xd2d, 0xa638, 0x2ab0, 0x9c80, 0x234e, 0x33fc, 0x1, 0x1);
        gbc.writeMem(0xd2d, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x29);
        EXPECT(gbc.b(),  0x9c);
        EXPECT(gbc.c(),  0x80);
        EXPECT(gbc.d(),  0x23);
        EXPECT(gbc.e(),  0x4e);
        EXPECT(gbc.h(),  0x33);
        EXPECT(gbc.l(),  0xfc);
        EXPECT(gbc.sp(), 0xa638);
        EXPECT(gbc.pc(), 0xd2e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 013A
        gbc.setState(0x8178, 0x706d, 0x1080, 0x14f3, 0x4e10, 0xdf9d, 0x1, 0x0);
        gbc.writeMem(0x8178, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf);
        EXPECT(gbc.b(),  0x14);
        EXPECT(gbc.c(),  0xf3);
        EXPECT(gbc.d(),  0x4e);
        EXPECT(gbc.e(),  0x10);
        EXPECT(gbc.h(),  0xdf);
        EXPECT(gbc.l(),  0x9d);
        EXPECT(gbc.sp(), 0x706d);
        EXPECT(gbc.pc(), 0x8179);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8178), 0x3d);
        // 3D 013B
        gbc.setState(0xa8ae, 0x7e99, 0x5020, 0xcad2, 0xcab7, 0xed7e, 0x1, 0x1);
        gbc.writeMem(0xa8ae, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x4f);
        EXPECT(gbc.b(),  0xca);
        EXPECT(gbc.c(),  0xd2);
        EXPECT(gbc.d(),  0xca);
        EXPECT(gbc.e(),  0xb7);
        EXPECT(gbc.h(),  0xed);
        EXPECT(gbc.l(),  0x7e);
        EXPECT(gbc.sp(), 0x7e99);
        EXPECT(gbc.pc(), 0xa8af);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa8ae), 0x3d);
        // 3D 013C
        gbc.setState(0x66c2, 0xbbb9, 0x6810, 0x70d6, 0x34aa, 0x942d, 0x0, 0x0);
        gbc.writeMem(0x66c2, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x67);
        EXPECT(gbc.b(),  0x70);
        EXPECT(gbc.c(),  0xd6);
        EXPECT(gbc.d(),  0x34);
        EXPECT(gbc.e(),  0xaa);
        EXPECT(gbc.h(),  0x94);
        EXPECT(gbc.l(),  0x2d);
        EXPECT(gbc.sp(), 0xbbb9);
        EXPECT(gbc.pc(), 0x66c3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 013D
        gbc.setState(0x42d4, 0xbbfc, 0xbf00, 0xb17b, 0x86be, 0x8ed5, 0x0, 0x0);
        gbc.writeMem(0x42d4, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xbe);
        EXPECT(gbc.b(),  0xb1);
        EXPECT(gbc.c(),  0x7b);
        EXPECT(gbc.d(),  0x86);
        EXPECT(gbc.e(),  0xbe);
        EXPECT(gbc.h(),  0x8e);
        EXPECT(gbc.l(),  0xd5);
        EXPECT(gbc.sp(), 0xbbfc);
        EXPECT(gbc.pc(), 0x42d5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 013E
        gbc.setState(0xa43, 0x2004, 0x2d50, 0x1935, 0xa299, 0xd1fd, 0x0, 0x1);
        gbc.writeMem(0xa43, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x2c);
        EXPECT(gbc.b(),  0x19);
        EXPECT(gbc.c(),  0x35);
        EXPECT(gbc.d(),  0xa2);
        EXPECT(gbc.e(),  0x99);
        EXPECT(gbc.h(),  0xd1);
        EXPECT(gbc.l(),  0xfd);
        EXPECT(gbc.sp(), 0x2004);
        EXPECT(gbc.pc(), 0xa44);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 013F
        gbc.setState(0x8d1b, 0xd249, 0x6bd0, 0xb159, 0x62df, 0xf13d, 0x1, 0x1);
        gbc.writeMem(0x8d1b, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x6a);
        EXPECT(gbc.b(),  0xb1);
        EXPECT(gbc.c(),  0x59);
        EXPECT(gbc.d(),  0x62);
        EXPECT(gbc.e(),  0xdf);
        EXPECT(gbc.h(),  0xf1);
        EXPECT(gbc.l(),  0x3d);
        EXPECT(gbc.sp(), 0xd249);
        EXPECT(gbc.pc(), 0x8d1c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8d1b), 0x3d);
        // 3D 0140
        gbc.setState(0x4d09, 0xbec7, 0x3c70, 0xc9eb, 0xb225, 0x1ff, 0x1, 0x0);
        gbc.writeMem(0x4d09, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x3b);
        EXPECT(gbc.b(),  0xc9);
        EXPECT(gbc.c(),  0xeb);
        EXPECT(gbc.d(),  0xb2);
        EXPECT(gbc.e(),  0x25);
        EXPECT(gbc.h(),  0x1);
        EXPECT(gbc.l(),  0xff);
        EXPECT(gbc.sp(), 0xbec7);
        EXPECT(gbc.pc(), 0x4d0a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0141
        gbc.setState(0xa1b6, 0x1c23, 0x5c50, 0xc1b3, 0xa6a6, 0xc718, 0x0, 0x0);
        gbc.writeMem(0xa1b6, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x5b);
        EXPECT(gbc.b(),  0xc1);
        EXPECT(gbc.c(),  0xb3);
        EXPECT(gbc.d(),  0xa6);
        EXPECT(gbc.e(),  0xa6);
        EXPECT(gbc.h(),  0xc7);
        EXPECT(gbc.l(),  0x18);
        EXPECT(gbc.sp(), 0x1c23);
        EXPECT(gbc.pc(), 0xa1b7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa1b6), 0x3d);
        // 3D 0142
        gbc.setState(0xc9b9, 0xf03f, 0xd9f0, 0xf9bc, 0x890d, 0x6018, 0x0, 0x1);
        gbc.writeMem(0xc9b9, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xd8);
        EXPECT(gbc.b(),  0xf9);
        EXPECT(gbc.c(),  0xbc);
        EXPECT(gbc.d(),  0x89);
        EXPECT(gbc.e(),  0xd);
        EXPECT(gbc.h(),  0x60);
        EXPECT(gbc.l(),  0x18);
        EXPECT(gbc.sp(), 0xf03f);
        EXPECT(gbc.pc(), 0xc9ba);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc9b9), 0x3d);
        // 3D 0143
        gbc.setState(0xb751, 0x994, 0xf640, 0x8c1f, 0x3af4, 0x4dab, 0x0, 0x1);
        gbc.writeMem(0xb751, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf5);
        EXPECT(gbc.b(),  0x8c);
        EXPECT(gbc.c(),  0x1f);
        EXPECT(gbc.d(),  0x3a);
        EXPECT(gbc.e(),  0xf4);
        EXPECT(gbc.h(),  0x4d);
        EXPECT(gbc.l(),  0xab);
        EXPECT(gbc.sp(), 0x994);
        EXPECT(gbc.pc(), 0xb752);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb751), 0x3d);
        // 3D 0144
        gbc.setState(0xd2a6, 0x607, 0x160, 0x6ec, 0x2caa, 0xba93, 0x0, 0x1);
        gbc.writeMem(0xd2a6, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x0);
        EXPECT(gbc.b(),  0x6);
        EXPECT(gbc.c(),  0xec);
        EXPECT(gbc.d(),  0x2c);
        EXPECT(gbc.e(),  0xaa);
        EXPECT(gbc.h(),  0xba);
        EXPECT(gbc.l(),  0x93);
        EXPECT(gbc.sp(), 0x607);
        EXPECT(gbc.pc(), 0xd2a7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  true);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd2a6), 0x3d);
        // 3D 0145
        gbc.setState(0xe4b6, 0x4d28, 0x4560, 0xf24e, 0xbc5f, 0x3b03, 0x1, 0x1);
        gbc.writeMem(0xe4b6, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x44);
        EXPECT(gbc.b(),  0xf2);
        EXPECT(gbc.c(),  0x4e);
        EXPECT(gbc.d(),  0xbc);
        EXPECT(gbc.e(),  0x5f);
        EXPECT(gbc.h(),  0x3b);
        EXPECT(gbc.l(),  0x3);
        EXPECT(gbc.sp(), 0x4d28);
        EXPECT(gbc.pc(), 0xe4b7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe4b6), 0x3d);
        // 3D 0146
        gbc.setState(0x8b5c, 0x33b3, 0xf530, 0x84, 0xd3a1, 0x9c73, 0x0, 0x1);
        gbc.writeMem(0x8b5c, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf4);
        EXPECT(gbc.b(),  0x0);
        EXPECT(gbc.c(),  0x84);
        EXPECT(gbc.d(),  0xd3);
        EXPECT(gbc.e(),  0xa1);
        EXPECT(gbc.h(),  0x9c);
        EXPECT(gbc.l(),  0x73);
        EXPECT(gbc.sp(), 0x33b3);
        EXPECT(gbc.pc(), 0x8b5d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8b5c), 0x3d);
        // 3D 0147
        gbc.setState(0x7b9d, 0xd1c1, 0x1a40, 0xef57, 0x33b3, 0xf13b, 0x1, 0x1);
        gbc.writeMem(0x7b9d, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x19);
        EXPECT(gbc.b(),  0xef);
        EXPECT(gbc.c(),  0x57);
        EXPECT(gbc.d(),  0x33);
        EXPECT(gbc.e(),  0xb3);
        EXPECT(gbc.h(),  0xf1);
        EXPECT(gbc.l(),  0x3b);
        EXPECT(gbc.sp(), 0xd1c1);
        EXPECT(gbc.pc(), 0x7b9e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0148
        gbc.setState(0x321, 0xfbd0, 0xb0e0, 0x359d, 0xa8a7, 0xea92, 0x1, 0x0);
        gbc.writeMem(0x321, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xaf);
        EXPECT(gbc.b(),  0x35);
        EXPECT(gbc.c(),  0x9d);
        EXPECT(gbc.d(),  0xa8);
        EXPECT(gbc.e(),  0xa7);
        EXPECT(gbc.h(),  0xea);
        EXPECT(gbc.l(),  0x92);
        EXPECT(gbc.sp(), 0xfbd0);
        EXPECT(gbc.pc(), 0x322);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 3D 0149
        gbc.setState(0x74f0, 0x1edd, 0xe160, 0x40f0, 0xc1b8, 0x5682, 0x0, 0x0);
        gbc.writeMem(0x74f0, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xe0);
        EXPECT(gbc.b(),  0x40);
        EXPECT(gbc.c(),  0xf0);
        EXPECT(gbc.d(),  0xc1);
        EXPECT(gbc.e(),  0xb8);
        EXPECT(gbc.h(),  0x56);
        EXPECT(gbc.l(),  0x82);
        EXPECT(gbc.sp(), 0x1edd);
        EXPECT(gbc.pc(), 0x74f1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 014A
        gbc.setState(0x85df, 0x201b, 0xd5b0, 0x7c98, 0xec1f, 0xf7f2, 0x0, 0x0);
        gbc.writeMem(0x85df, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xd4);
        EXPECT(gbc.b(),  0x7c);
        EXPECT(gbc.c(),  0x98);
        EXPECT(gbc.d(),  0xec);
        EXPECT(gbc.e(),  0x1f);
        EXPECT(gbc.h(),  0xf7);
        EXPECT(gbc.l(),  0xf2);
        EXPECT(gbc.sp(), 0x201b);
        EXPECT(gbc.pc(), 0x85e0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x85df), 0x3d);
        // 3D 014B
        gbc.setState(0x594c, 0xd6f, 0x9990, 0xf89a, 0x81cd, 0x945e, 0x0, 0x0);
        gbc.writeMem(0x594c, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x98);
        EXPECT(gbc.b(),  0xf8);
        EXPECT(gbc.c(),  0x9a);
        EXPECT(gbc.d(),  0x81);
        EXPECT(gbc.e(),  0xcd);
        EXPECT(gbc.h(),  0x94);
        EXPECT(gbc.l(),  0x5e);
        EXPECT(gbc.sp(), 0xd6f);
        EXPECT(gbc.pc(), 0x594d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 014C
        gbc.setState(0x29a5, 0xa2a4, 0xbde0, 0x31ec, 0x79fd, 0xbf40, 0x1, 0x1);
        gbc.writeMem(0x29a5, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xbc);
        EXPECT(gbc.b(),  0x31);
        EXPECT(gbc.c(),  0xec);
        EXPECT(gbc.d(),  0x79);
        EXPECT(gbc.e(),  0xfd);
        EXPECT(gbc.h(),  0xbf);
        EXPECT(gbc.l(),  0x40);
        EXPECT(gbc.sp(), 0xa2a4);
        EXPECT(gbc.pc(), 0x29a6);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 014D
        gbc.setState(0xbe31, 0x7370, 0x69f0, 0xd7ae, 0x9317, 0x3635, 0x0, 0x1);
        gbc.writeMem(0xbe31, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x68);
        EXPECT(gbc.b(),  0xd7);
        EXPECT(gbc.c(),  0xae);
        EXPECT(gbc.d(),  0x93);
        EXPECT(gbc.e(),  0x17);
        EXPECT(gbc.h(),  0x36);
        EXPECT(gbc.l(),  0x35);
        EXPECT(gbc.sp(), 0x7370);
        EXPECT(gbc.pc(), 0xbe32);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbe31), 0x3d);
        // 3D 014E
        gbc.setState(0xae4f, 0x48e9, 0x1770, 0x6caf, 0x3c1a, 0x606e, 0x1, 0x1);
        gbc.writeMem(0xae4f, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x16);
        EXPECT(gbc.b(),  0x6c);
        EXPECT(gbc.c(),  0xaf);
        EXPECT(gbc.d(),  0x3c);
        EXPECT(gbc.e(),  0x1a);
        EXPECT(gbc.h(),  0x60);
        EXPECT(gbc.l(),  0x6e);
        EXPECT(gbc.sp(), 0x48e9);
        EXPECT(gbc.pc(), 0xae50);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xae4f), 0x3d);
        // 3D 014F
        gbc.setState(0xd572, 0x9508, 0x6860, 0x4bbf, 0xf78e, 0xe74c, 0x1, 0x0);
        gbc.writeMem(0xd572, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x67);
        EXPECT(gbc.b(),  0x4b);
        EXPECT(gbc.c(),  0xbf);
        EXPECT(gbc.d(),  0xf7);
        EXPECT(gbc.e(),  0x8e);
        EXPECT(gbc.h(),  0xe7);
        EXPECT(gbc.l(),  0x4c);
        EXPECT(gbc.sp(), 0x9508);
        EXPECT(gbc.pc(), 0xd573);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd572), 0x3d);
        // 3D 0150
        gbc.setState(0x9cec, 0x2418, 0xe990, 0xab60, 0x5280, 0xf673, 0x0, 0x0);
        gbc.writeMem(0x9cec, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xe8);
        EXPECT(gbc.b(),  0xab);
        EXPECT(gbc.c(),  0x60);
        EXPECT(gbc.d(),  0x52);
        EXPECT(gbc.e(),  0x80);
        EXPECT(gbc.h(),  0xf6);
        EXPECT(gbc.l(),  0x73);
        EXPECT(gbc.sp(), 0x2418);
        EXPECT(gbc.pc(), 0x9ced);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9cec), 0x3d);
        // 3D 0152
        gbc.setState(0xf9f, 0x78c9, 0xc0e0, 0x9ae3, 0x2858, 0xfb1e, 0x1, 0x1);
        gbc.writeMem(0xf9f, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xbf);
        EXPECT(gbc.b(),  0x9a);
        EXPECT(gbc.c(),  0xe3);
        EXPECT(gbc.d(),  0x28);
        EXPECT(gbc.e(),  0x58);
        EXPECT(gbc.h(),  0xfb);
        EXPECT(gbc.l(),  0x1e);
        EXPECT(gbc.sp(), 0x78c9);
        EXPECT(gbc.pc(), 0xfa0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 3D 0153
        gbc.setState(0xc8aa, 0xfa7f, 0x58d0, 0xf70d, 0xd5b, 0xa1d8, 0x1, 0x1);
        gbc.writeMem(0xc8aa, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x57);
        EXPECT(gbc.b(),  0xf7);
        EXPECT(gbc.c(),  0xd);
        EXPECT(gbc.d(),  0xd);
        EXPECT(gbc.e(),  0x5b);
        EXPECT(gbc.h(),  0xa1);
        EXPECT(gbc.l(),  0xd8);
        EXPECT(gbc.sp(), 0xfa7f);
        EXPECT(gbc.pc(), 0xc8ab);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc8aa), 0x3d);
        // 3D 0154
        gbc.setState(0xef71, 0xdcbb, 0xd400, 0xf3bf, 0x57a6, 0x591b, 0x1, 0x1);
        gbc.writeMem(0xef71, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xd3);
        EXPECT(gbc.b(),  0xf3);
        EXPECT(gbc.c(),  0xbf);
        EXPECT(gbc.d(),  0x57);
        EXPECT(gbc.e(),  0xa6);
        EXPECT(gbc.h(),  0x59);
        EXPECT(gbc.l(),  0x1b);
        EXPECT(gbc.sp(), 0xdcbb);
        EXPECT(gbc.pc(), 0xef72);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xef71), 0x3d);
        // 3D 0155
        gbc.setState(0xea01, 0xa0f0, 0x65a0, 0xd66f, 0x2a25, 0xae19, 0x1, 0x1);
        gbc.writeMem(0xea01, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x64);
        EXPECT(gbc.b(),  0xd6);
        EXPECT(gbc.c(),  0x6f);
        EXPECT(gbc.d(),  0x2a);
        EXPECT(gbc.e(),  0x25);
        EXPECT(gbc.h(),  0xae);
        EXPECT(gbc.l(),  0x19);
        EXPECT(gbc.sp(), 0xa0f0);
        EXPECT(gbc.pc(), 0xea02);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xea01), 0x3d);
        // 3D 0156
        gbc.setState(0x260a, 0x1eff, 0xd310, 0x73b3, 0x4379, 0x1cdc, 0x0, 0x1);
        gbc.writeMem(0x260a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xd2);
        EXPECT(gbc.b(),  0x73);
        EXPECT(gbc.c(),  0xb3);
        EXPECT(gbc.d(),  0x43);
        EXPECT(gbc.e(),  0x79);
        EXPECT(gbc.h(),  0x1c);
        EXPECT(gbc.l(),  0xdc);
        EXPECT(gbc.sp(), 0x1eff);
        EXPECT(gbc.pc(), 0x260b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0157
        gbc.setState(0xd859, 0xed24, 0xdf40, 0xb0be, 0xea, 0x8f16, 0x1, 0x0);
        gbc.writeMem(0xd859, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xde);
        EXPECT(gbc.b(),  0xb0);
        EXPECT(gbc.c(),  0xbe);
        EXPECT(gbc.d(),  0x0);
        EXPECT(gbc.e(),  0xea);
        EXPECT(gbc.h(),  0x8f);
        EXPECT(gbc.l(),  0x16);
        EXPECT(gbc.sp(), 0xed24);
        EXPECT(gbc.pc(), 0xd85a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd859), 0x3d);
        // 3D 0158
        gbc.setState(0x56b3, 0x6a1f, 0xe520, 0x6926, 0x227c, 0xde46, 0x1, 0x1);
        gbc.writeMem(0x56b3, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xe4);
        EXPECT(gbc.b(),  0x69);
        EXPECT(gbc.c(),  0x26);
        EXPECT(gbc.d(),  0x22);
        EXPECT(gbc.e(),  0x7c);
        EXPECT(gbc.h(),  0xde);
        EXPECT(gbc.l(),  0x46);
        EXPECT(gbc.sp(), 0x6a1f);
        EXPECT(gbc.pc(), 0x56b4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 015A
        gbc.setState(0x49d5, 0xe1c6, 0x3d50, 0x3202, 0x4612, 0x99dd, 0x0, 0x0);
        gbc.writeMem(0x49d5, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x3c);
        EXPECT(gbc.b(),  0x32);
        EXPECT(gbc.c(),  0x2);
        EXPECT(gbc.d(),  0x46);
        EXPECT(gbc.e(),  0x12);
        EXPECT(gbc.h(),  0x99);
        EXPECT(gbc.l(),  0xdd);
        EXPECT(gbc.sp(), 0xe1c6);
        EXPECT(gbc.pc(), 0x49d6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 015B
        gbc.setState(0x1751, 0x79f5, 0x8b70, 0xaa92, 0x6c04, 0xe074, 0x1, 0x0);
        gbc.writeMem(0x1751, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x8a);
        EXPECT(gbc.b(),  0xaa);
        EXPECT(gbc.c(),  0x92);
        EXPECT(gbc.d(),  0x6c);
        EXPECT(gbc.e(),  0x4);
        EXPECT(gbc.h(),  0xe0);
        EXPECT(gbc.l(),  0x74);
        EXPECT(gbc.sp(), 0x79f5);
        EXPECT(gbc.pc(), 0x1752);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 015C
        gbc.setState(0x2217, 0xd356, 0x710, 0xa39a, 0x601e, 0xb2e1, 0x1, 0x0);
        gbc.writeMem(0x2217, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x6);
        EXPECT(gbc.b(),  0xa3);
        EXPECT(gbc.c(),  0x9a);
        EXPECT(gbc.d(),  0x60);
        EXPECT(gbc.e(),  0x1e);
        EXPECT(gbc.h(),  0xb2);
        EXPECT(gbc.l(),  0xe1);
        EXPECT(gbc.sp(), 0xd356);
        EXPECT(gbc.pc(), 0x2218);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 015D
        gbc.setState(0x359a, 0x67c5, 0xe8b0, 0x54b2, 0x7f9d, 0x3cb2, 0x1, 0x1);
        gbc.writeMem(0x359a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xe7);
        EXPECT(gbc.b(),  0x54);
        EXPECT(gbc.c(),  0xb2);
        EXPECT(gbc.d(),  0x7f);
        EXPECT(gbc.e(),  0x9d);
        EXPECT(gbc.h(),  0x3c);
        EXPECT(gbc.l(),  0xb2);
        EXPECT(gbc.sp(), 0x67c5);
        EXPECT(gbc.pc(), 0x359b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 015E
        gbc.setState(0xe47a, 0xa66d, 0x71a0, 0x3f95, 0x8fbc, 0x7341, 0x0, 0x0);
        gbc.writeMem(0xe47a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x70);
        EXPECT(gbc.b(),  0x3f);
        EXPECT(gbc.c(),  0x95);
        EXPECT(gbc.d(),  0x8f);
        EXPECT(gbc.e(),  0xbc);
        EXPECT(gbc.h(),  0x73);
        EXPECT(gbc.l(),  0x41);
        EXPECT(gbc.sp(), 0xa66d);
        EXPECT(gbc.pc(), 0xe47b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe47a), 0x3d);
        // 3D 015F
        gbc.setState(0x8971, 0xf3e5, 0xffc0, 0xa65b, 0x932a, 0x7c5e, 0x1, 0x0);
        gbc.writeMem(0x8971, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xfe);
        EXPECT(gbc.b(),  0xa6);
        EXPECT(gbc.c(),  0x5b);
        EXPECT(gbc.d(),  0x93);
        EXPECT(gbc.e(),  0x2a);
        EXPECT(gbc.h(),  0x7c);
        EXPECT(gbc.l(),  0x5e);
        EXPECT(gbc.sp(), 0xf3e5);
        EXPECT(gbc.pc(), 0x8972);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8971), 0x3d);
        // 3D 0160
        gbc.setState(0x33ac, 0x460d, 0x6f30, 0x7e4, 0x49fb, 0xee65, 0x0, 0x1);
        gbc.writeMem(0x33ac, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x6e);
        EXPECT(gbc.b(),  0x7);
        EXPECT(gbc.c(),  0xe4);
        EXPECT(gbc.d(),  0x49);
        EXPECT(gbc.e(),  0xfb);
        EXPECT(gbc.h(),  0xee);
        EXPECT(gbc.l(),  0x65);
        EXPECT(gbc.sp(), 0x460d);
        EXPECT(gbc.pc(), 0x33ad);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0161
        gbc.setState(0xe38c, 0x4b46, 0xa830, 0x2fdb, 0x9fc, 0x8d0e, 0x0, 0x1);
        gbc.writeMem(0xe38c, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa7);
        EXPECT(gbc.b(),  0x2f);
        EXPECT(gbc.c(),  0xdb);
        EXPECT(gbc.d(),  0x9);
        EXPECT(gbc.e(),  0xfc);
        EXPECT(gbc.h(),  0x8d);
        EXPECT(gbc.l(),  0xe);
        EXPECT(gbc.sp(), 0x4b46);
        EXPECT(gbc.pc(), 0xe38d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe38c), 0x3d);
        // 3D 0162
        gbc.setState(0x653e, 0xd052, 0xc0c0, 0x23b2, 0x484c, 0xf024, 0x1, 0x0);
        gbc.writeMem(0x653e, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xbf);
        EXPECT(gbc.b(),  0x23);
        EXPECT(gbc.c(),  0xb2);
        EXPECT(gbc.d(),  0x48);
        EXPECT(gbc.e(),  0x4c);
        EXPECT(gbc.h(),  0xf0);
        EXPECT(gbc.l(),  0x24);
        EXPECT(gbc.sp(), 0xd052);
        EXPECT(gbc.pc(), 0x653f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 3D 0164
        gbc.setState(0xa894, 0x7323, 0xf140, 0x5522, 0xbc7d, 0x122f, 0x1, 0x1);
        gbc.writeMem(0xa894, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf0);
        EXPECT(gbc.b(),  0x55);
        EXPECT(gbc.c(),  0x22);
        EXPECT(gbc.d(),  0xbc);
        EXPECT(gbc.e(),  0x7d);
        EXPECT(gbc.h(),  0x12);
        EXPECT(gbc.l(),  0x2f);
        EXPECT(gbc.sp(), 0x7323);
        EXPECT(gbc.pc(), 0xa895);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa894), 0x3d);
        // 3D 0165
        gbc.setState(0x1bbd, 0x460, 0xea20, 0x521b, 0x3591, 0x40d2, 0x1, 0x0);
        gbc.writeMem(0x1bbd, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xe9);
        EXPECT(gbc.b(),  0x52);
        EXPECT(gbc.c(),  0x1b);
        EXPECT(gbc.d(),  0x35);
        EXPECT(gbc.e(),  0x91);
        EXPECT(gbc.h(),  0x40);
        EXPECT(gbc.l(),  0xd2);
        EXPECT(gbc.sp(), 0x460);
        EXPECT(gbc.pc(), 0x1bbe);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0167
        gbc.setState(0x95bb, 0x3360, 0xd40, 0xd6ad, 0x95f5, 0x1cb8, 0x0, 0x1);
        gbc.writeMem(0x95bb, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xc);
        EXPECT(gbc.b(),  0xd6);
        EXPECT(gbc.c(),  0xad);
        EXPECT(gbc.d(),  0x95);
        EXPECT(gbc.e(),  0xf5);
        EXPECT(gbc.h(),  0x1c);
        EXPECT(gbc.l(),  0xb8);
        EXPECT(gbc.sp(), 0x3360);
        EXPECT(gbc.pc(), 0x95bc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x95bb), 0x3d);
        // 3D 0168
        gbc.setState(0x2fc1, 0x3d00, 0xfb30, 0xdb75, 0xfcec, 0x92ea, 0x1, 0x0);
        gbc.writeMem(0x2fc1, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xfa);
        EXPECT(gbc.b(),  0xdb);
        EXPECT(gbc.c(),  0x75);
        EXPECT(gbc.d(),  0xfc);
        EXPECT(gbc.e(),  0xec);
        EXPECT(gbc.h(),  0x92);
        EXPECT(gbc.l(),  0xea);
        EXPECT(gbc.sp(), 0x3d00);
        EXPECT(gbc.pc(), 0x2fc2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0169
        gbc.setState(0xcb29, 0x933c, 0x1770, 0xdb5a, 0xa266, 0x80b4, 0x0, 0x0);
        gbc.writeMem(0xcb29, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x16);
        EXPECT(gbc.b(),  0xdb);
        EXPECT(gbc.c(),  0x5a);
        EXPECT(gbc.d(),  0xa2);
        EXPECT(gbc.e(),  0x66);
        EXPECT(gbc.h(),  0x80);
        EXPECT(gbc.l(),  0xb4);
        EXPECT(gbc.sp(), 0x933c);
        EXPECT(gbc.pc(), 0xcb2a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcb29), 0x3d);
        // 3D 016B
        gbc.setState(0x2f2f, 0x5312, 0xae00, 0x1fc5, 0x4922, 0x38f4, 0x1, 0x0);
        gbc.writeMem(0x2f2f, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xad);
        EXPECT(gbc.b(),  0x1f);
        EXPECT(gbc.c(),  0xc5);
        EXPECT(gbc.d(),  0x49);
        EXPECT(gbc.e(),  0x22);
        EXPECT(gbc.h(),  0x38);
        EXPECT(gbc.l(),  0xf4);
        EXPECT(gbc.sp(), 0x5312);
        EXPECT(gbc.pc(), 0x2f30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 016C
        gbc.setState(0xe571, 0x4a09, 0xdaa0, 0xe5c1, 0xac41, 0x2da4, 0x1, 0x1);
        gbc.writeMem(0xe571, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xd9);
        EXPECT(gbc.b(),  0xe5);
        EXPECT(gbc.c(),  0xc1);
        EXPECT(gbc.d(),  0xac);
        EXPECT(gbc.e(),  0x41);
        EXPECT(gbc.h(),  0x2d);
        EXPECT(gbc.l(),  0xa4);
        EXPECT(gbc.sp(), 0x4a09);
        EXPECT(gbc.pc(), 0xe572);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe571), 0x3d);
        // 3D 016D
        gbc.setState(0xe8c7, 0xc, 0xbba0, 0x24f6, 0xfd72, 0x6c4d, 0x0, 0x1);
        gbc.writeMem(0xe8c7, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xba);
        EXPECT(gbc.b(),  0x24);
        EXPECT(gbc.c(),  0xf6);
        EXPECT(gbc.d(),  0xfd);
        EXPECT(gbc.e(),  0x72);
        EXPECT(gbc.h(),  0x6c);
        EXPECT(gbc.l(),  0x4d);
        EXPECT(gbc.sp(), 0xc);
        EXPECT(gbc.pc(), 0xe8c8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe8c7), 0x3d);
        // 3D 016E
        gbc.setState(0xc3e0, 0x8a9d, 0xa4c0, 0x52e4, 0xe8bd, 0xf67b, 0x1, 0x0);
        gbc.writeMem(0xc3e0, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa3);
        EXPECT(gbc.b(),  0x52);
        EXPECT(gbc.c(),  0xe4);
        EXPECT(gbc.d(),  0xe8);
        EXPECT(gbc.e(),  0xbd);
        EXPECT(gbc.h(),  0xf6);
        EXPECT(gbc.l(),  0x7b);
        EXPECT(gbc.sp(), 0x8a9d);
        EXPECT(gbc.pc(), 0xc3e1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc3e0), 0x3d);
        // 3D 016F
        gbc.setState(0x874a, 0xfebd, 0xe1b0, 0x3bfc, 0xb791, 0x488c, 0x0, 0x0);
        gbc.writeMem(0x874a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xe0);
        EXPECT(gbc.b(),  0x3b);
        EXPECT(gbc.c(),  0xfc);
        EXPECT(gbc.d(),  0xb7);
        EXPECT(gbc.e(),  0x91);
        EXPECT(gbc.h(),  0x48);
        EXPECT(gbc.l(),  0x8c);
        EXPECT(gbc.sp(), 0xfebd);
        EXPECT(gbc.pc(), 0x874b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x874a), 0x3d);
        // 3D 0170
        gbc.setState(0x3428, 0x989f, 0xf50, 0x7ab9, 0x5e34, 0x7702, 0x1, 0x0);
        gbc.writeMem(0x3428, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xe);
        EXPECT(gbc.b(),  0x7a);
        EXPECT(gbc.c(),  0xb9);
        EXPECT(gbc.d(),  0x5e);
        EXPECT(gbc.e(),  0x34);
        EXPECT(gbc.h(),  0x77);
        EXPECT(gbc.l(),  0x2);
        EXPECT(gbc.sp(), 0x989f);
        EXPECT(gbc.pc(), 0x3429);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0171
        gbc.setState(0x3d32, 0x6930, 0x7670, 0x6b18, 0x5bf7, 0x469, 0x0, 0x0);
        gbc.writeMem(0x3d32, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x75);
        EXPECT(gbc.b(),  0x6b);
        EXPECT(gbc.c(),  0x18);
        EXPECT(gbc.d(),  0x5b);
        EXPECT(gbc.e(),  0xf7);
        EXPECT(gbc.h(),  0x4);
        EXPECT(gbc.l(),  0x69);
        EXPECT(gbc.sp(), 0x6930);
        EXPECT(gbc.pc(), 0x3d33);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0172
        gbc.setState(0x3e00, 0x86e5, 0x7e70, 0xc901, 0x133b, 0x1347, 0x0, 0x1);
        gbc.writeMem(0x3e00, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x7d);
        EXPECT(gbc.b(),  0xc9);
        EXPECT(gbc.c(),  0x1);
        EXPECT(gbc.d(),  0x13);
        EXPECT(gbc.e(),  0x3b);
        EXPECT(gbc.h(),  0x13);
        EXPECT(gbc.l(),  0x47);
        EXPECT(gbc.sp(), 0x86e5);
        EXPECT(gbc.pc(), 0x3e01);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0173
        gbc.setState(0xe9df, 0x9a8e, 0x58d0, 0xb763, 0x5730, 0x54ce, 0x0, 0x0);
        gbc.writeMem(0xe9df, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x57);
        EXPECT(gbc.b(),  0xb7);
        EXPECT(gbc.c(),  0x63);
        EXPECT(gbc.d(),  0x57);
        EXPECT(gbc.e(),  0x30);
        EXPECT(gbc.h(),  0x54);
        EXPECT(gbc.l(),  0xce);
        EXPECT(gbc.sp(), 0x9a8e);
        EXPECT(gbc.pc(), 0xe9e0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe9df), 0x3d);
        // 3D 0174
        gbc.setState(0xc423, 0x9979, 0x15e0, 0xb028, 0x9b1b, 0x1fc2, 0x1, 0x0);
        gbc.writeMem(0xc423, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x14);
        EXPECT(gbc.b(),  0xb0);
        EXPECT(gbc.c(),  0x28);
        EXPECT(gbc.d(),  0x9b);
        EXPECT(gbc.e(),  0x1b);
        EXPECT(gbc.h(),  0x1f);
        EXPECT(gbc.l(),  0xc2);
        EXPECT(gbc.sp(), 0x9979);
        EXPECT(gbc.pc(), 0xc424);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc423), 0x3d);
        // 3D 0175
        gbc.setState(0x7d42, 0x7a34, 0xb40, 0xe4fd, 0x6061, 0x42fa, 0x0, 0x1);
        gbc.writeMem(0x7d42, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa);
        EXPECT(gbc.b(),  0xe4);
        EXPECT(gbc.c(),  0xfd);
        EXPECT(gbc.d(),  0x60);
        EXPECT(gbc.e(),  0x61);
        EXPECT(gbc.h(),  0x42);
        EXPECT(gbc.l(),  0xfa);
        EXPECT(gbc.sp(), 0x7a34);
        EXPECT(gbc.pc(), 0x7d43);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0176
        gbc.setState(0x3448, 0x8da4, 0x4c10, 0x255f, 0x1f65, 0xefad, 0x1, 0x0);
        gbc.writeMem(0x3448, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x4b);
        EXPECT(gbc.b(),  0x25);
        EXPECT(gbc.c(),  0x5f);
        EXPECT(gbc.d(),  0x1f);
        EXPECT(gbc.e(),  0x65);
        EXPECT(gbc.h(),  0xef);
        EXPECT(gbc.l(),  0xad);
        EXPECT(gbc.sp(), 0x8da4);
        EXPECT(gbc.pc(), 0x3449);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0177
        gbc.setState(0x11db, 0x6085, 0xf2f0, 0xd30a, 0x8baa, 0xa23e, 0x0, 0x0);
        gbc.writeMem(0x11db, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf1);
        EXPECT(gbc.b(),  0xd3);
        EXPECT(gbc.c(),  0xa);
        EXPECT(gbc.d(),  0x8b);
        EXPECT(gbc.e(),  0xaa);
        EXPECT(gbc.h(),  0xa2);
        EXPECT(gbc.l(),  0x3e);
        EXPECT(gbc.sp(), 0x6085);
        EXPECT(gbc.pc(), 0x11dc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0178
        gbc.setState(0x4c55, 0xf573, 0x17f0, 0xfc71, 0x4415, 0xbc45, 0x0, 0x1);
        gbc.writeMem(0x4c55, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x16);
        EXPECT(gbc.b(),  0xfc);
        EXPECT(gbc.c(),  0x71);
        EXPECT(gbc.d(),  0x44);
        EXPECT(gbc.e(),  0x15);
        EXPECT(gbc.h(),  0xbc);
        EXPECT(gbc.l(),  0x45);
        EXPECT(gbc.sp(), 0xf573);
        EXPECT(gbc.pc(), 0x4c56);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0179
        gbc.setState(0xee02, 0x3d04, 0x5fe0, 0x9d2c, 0x9082, 0xd253, 0x1, 0x1);
        gbc.writeMem(0xee02, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x5e);
        EXPECT(gbc.b(),  0x9d);
        EXPECT(gbc.c(),  0x2c);
        EXPECT(gbc.d(),  0x90);
        EXPECT(gbc.e(),  0x82);
        EXPECT(gbc.h(),  0xd2);
        EXPECT(gbc.l(),  0x53);
        EXPECT(gbc.sp(), 0x3d04);
        EXPECT(gbc.pc(), 0xee03);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xee02), 0x3d);
        // 3D 017B
        gbc.setState(0x952b, 0x52bf, 0x3100, 0x92e9, 0x19fa, 0xe932, 0x0, 0x0);
        gbc.writeMem(0x952b, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x30);
        EXPECT(gbc.b(),  0x92);
        EXPECT(gbc.c(),  0xe9);
        EXPECT(gbc.d(),  0x19);
        EXPECT(gbc.e(),  0xfa);
        EXPECT(gbc.h(),  0xe9);
        EXPECT(gbc.l(),  0x32);
        EXPECT(gbc.sp(), 0x52bf);
        EXPECT(gbc.pc(), 0x952c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x952b), 0x3d);
        // 3D 017C
        gbc.setState(0x6e6b, 0x455a, 0x2dd0, 0x1fc3, 0xd1ae, 0x2a35, 0x1, 0x1);
        gbc.writeMem(0x6e6b, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x2c);
        EXPECT(gbc.b(),  0x1f);
        EXPECT(gbc.c(),  0xc3);
        EXPECT(gbc.d(),  0xd1);
        EXPECT(gbc.e(),  0xae);
        EXPECT(gbc.h(),  0x2a);
        EXPECT(gbc.l(),  0x35);
        EXPECT(gbc.sp(), 0x455a);
        EXPECT(gbc.pc(), 0x6e6c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 017D
        gbc.setState(0x5e78, 0x1e38, 0xa790, 0x12f8, 0x64dd, 0x3b40, 0x1, 0x1);
        gbc.writeMem(0x5e78, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa6);
        EXPECT(gbc.b(),  0x12);
        EXPECT(gbc.c(),  0xf8);
        EXPECT(gbc.d(),  0x64);
        EXPECT(gbc.e(),  0xdd);
        EXPECT(gbc.h(),  0x3b);
        EXPECT(gbc.l(),  0x40);
        EXPECT(gbc.sp(), 0x1e38);
        EXPECT(gbc.pc(), 0x5e79);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 017E
        gbc.setState(0x6822, 0xb867, 0x2490, 0x6b82, 0x68d3, 0x20e5, 0x1, 0x0);
        gbc.writeMem(0x6822, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x23);
        EXPECT(gbc.b(),  0x6b);
        EXPECT(gbc.c(),  0x82);
        EXPECT(gbc.d(),  0x68);
        EXPECT(gbc.e(),  0xd3);
        EXPECT(gbc.h(),  0x20);
        EXPECT(gbc.l(),  0xe5);
        EXPECT(gbc.sp(), 0xb867);
        EXPECT(gbc.pc(), 0x6823);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 017F
        gbc.setState(0xd88a, 0x384d, 0x5650, 0x957e, 0xa8eb, 0x1c20, 0x0, 0x0);
        gbc.writeMem(0xd88a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x55);
        EXPECT(gbc.b(),  0x95);
        EXPECT(gbc.c(),  0x7e);
        EXPECT(gbc.d(),  0xa8);
        EXPECT(gbc.e(),  0xeb);
        EXPECT(gbc.h(),  0x1c);
        EXPECT(gbc.l(),  0x20);
        EXPECT(gbc.sp(), 0x384d);
        EXPECT(gbc.pc(), 0xd88b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd88a), 0x3d);
        // 3D 0180
        gbc.setState(0x8617, 0x8941, 0x1070, 0x43e3, 0xe130, 0xe1d8, 0x1, 0x1);
        gbc.writeMem(0x8617, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf);
        EXPECT(gbc.b(),  0x43);
        EXPECT(gbc.c(),  0xe3);
        EXPECT(gbc.d(),  0xe1);
        EXPECT(gbc.e(),  0x30);
        EXPECT(gbc.h(),  0xe1);
        EXPECT(gbc.l(),  0xd8);
        EXPECT(gbc.sp(), 0x8941);
        EXPECT(gbc.pc(), 0x8618);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8617), 0x3d);
        // 3D 0181
        gbc.setState(0x2659, 0xd5e8, 0x2830, 0x3a03, 0x9f9, 0x539, 0x0, 0x1);
        gbc.writeMem(0x2659, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x27);
        EXPECT(gbc.b(),  0x3a);
        EXPECT(gbc.c(),  0x3);
        EXPECT(gbc.d(),  0x9);
        EXPECT(gbc.e(),  0xf9);
        EXPECT(gbc.h(),  0x5);
        EXPECT(gbc.l(),  0x39);
        EXPECT(gbc.sp(), 0xd5e8);
        EXPECT(gbc.pc(), 0x265a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0182
        gbc.setState(0x1fec, 0x71ca, 0x29b0, 0x882, 0xf03b, 0xd40f, 0x0, 0x1);
        gbc.writeMem(0x1fec, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0x8);
        EXPECT(gbc.c(),  0x82);
        EXPECT(gbc.d(),  0xf0);
        EXPECT(gbc.e(),  0x3b);
        EXPECT(gbc.h(),  0xd4);
        EXPECT(gbc.l(),  0xf);
        EXPECT(gbc.sp(), 0x71ca);
        EXPECT(gbc.pc(), 0x1fed);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0183
        gbc.setState(0xdd11, 0x10c2, 0xd850, 0x6a85, 0x3ece, 0xc5d9, 0x1, 0x1);
        gbc.writeMem(0xdd11, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xd7);
        EXPECT(gbc.b(),  0x6a);
        EXPECT(gbc.c(),  0x85);
        EXPECT(gbc.d(),  0x3e);
        EXPECT(gbc.e(),  0xce);
        EXPECT(gbc.h(),  0xc5);
        EXPECT(gbc.l(),  0xd9);
        EXPECT(gbc.sp(), 0x10c2);
        EXPECT(gbc.pc(), 0xdd12);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xdd11), 0x3d);
        // 3D 0184
        gbc.setState(0x6546, 0x797b, 0xfe70, 0x192b, 0x9f46, 0xdcc4, 0x1, 0x0);
        gbc.writeMem(0x6546, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xfd);
        EXPECT(gbc.b(),  0x19);
        EXPECT(gbc.c(),  0x2b);
        EXPECT(gbc.d(),  0x9f);
        EXPECT(gbc.e(),  0x46);
        EXPECT(gbc.h(),  0xdc);
        EXPECT(gbc.l(),  0xc4);
        EXPECT(gbc.sp(), 0x797b);
        EXPECT(gbc.pc(), 0x6547);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0186
        gbc.setState(0x8e2e, 0x8711, 0x20e0, 0xb974, 0x64cc, 0xd330, 0x0, 0x0);
        gbc.writeMem(0x8e2e, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x1f);
        EXPECT(gbc.b(),  0xb9);
        EXPECT(gbc.c(),  0x74);
        EXPECT(gbc.d(),  0x64);
        EXPECT(gbc.e(),  0xcc);
        EXPECT(gbc.h(),  0xd3);
        EXPECT(gbc.l(),  0x30);
        EXPECT(gbc.sp(), 0x8711);
        EXPECT(gbc.pc(), 0x8e2f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8e2e), 0x3d);
        // 3D 0188
        gbc.setState(0xa76f, 0xb3f7, 0x5fd0, 0x81d3, 0x6711, 0x616, 0x0, 0x0);
        gbc.writeMem(0xa76f, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x5e);
        EXPECT(gbc.b(),  0x81);
        EXPECT(gbc.c(),  0xd3);
        EXPECT(gbc.d(),  0x67);
        EXPECT(gbc.e(),  0x11);
        EXPECT(gbc.h(),  0x6);
        EXPECT(gbc.l(),  0x16);
        EXPECT(gbc.sp(), 0xb3f7);
        EXPECT(gbc.pc(), 0xa770);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa76f), 0x3d);
        // 3D 0189
        gbc.setState(0xc236, 0x65e9, 0x76e0, 0x61a, 0x1859, 0x74e1, 0x0, 0x0);
        gbc.writeMem(0xc236, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x75);
        EXPECT(gbc.b(),  0x6);
        EXPECT(gbc.c(),  0x1a);
        EXPECT(gbc.d(),  0x18);
        EXPECT(gbc.e(),  0x59);
        EXPECT(gbc.h(),  0x74);
        EXPECT(gbc.l(),  0xe1);
        EXPECT(gbc.sp(), 0x65e9);
        EXPECT(gbc.pc(), 0xc237);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc236), 0x3d);
        // 3D 018A
        gbc.setState(0xc6cb, 0x2999, 0xd7e0, 0xfd2c, 0xabe5, 0xca4e, 0x0, 0x0);
        gbc.writeMem(0xc6cb, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xd6);
        EXPECT(gbc.b(),  0xfd);
        EXPECT(gbc.c(),  0x2c);
        EXPECT(gbc.d(),  0xab);
        EXPECT(gbc.e(),  0xe5);
        EXPECT(gbc.h(),  0xca);
        EXPECT(gbc.l(),  0x4e);
        EXPECT(gbc.sp(), 0x2999);
        EXPECT(gbc.pc(), 0xc6cc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc6cb), 0x3d);
        // 3D 018B
        gbc.setState(0xe02a, 0xb4ab, 0x6430, 0xafc3, 0xd93d, 0x29fa, 0x1, 0x0);
        gbc.writeMem(0xe02a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x63);
        EXPECT(gbc.b(),  0xaf);
        EXPECT(gbc.c(),  0xc3);
        EXPECT(gbc.d(),  0xd9);
        EXPECT(gbc.e(),  0x3d);
        EXPECT(gbc.h(),  0x29);
        EXPECT(gbc.l(),  0xfa);
        EXPECT(gbc.sp(), 0xb4ab);
        EXPECT(gbc.pc(), 0xe02b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe02a), 0x3d);
        // 3D 018C
        gbc.setState(0xb, 0x9691, 0xc270, 0x59d4, 0x829, 0xeb49, 0x1, 0x0);
        gbc.writeMem(0xb, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xc1);
        EXPECT(gbc.b(),  0x59);
        EXPECT(gbc.c(),  0xd4);
        EXPECT(gbc.d(),  0x8);
        EXPECT(gbc.e(),  0x29);
        EXPECT(gbc.h(),  0xeb);
        EXPECT(gbc.l(),  0x49);
        EXPECT(gbc.sp(), 0x9691);
        EXPECT(gbc.pc(), 0xc);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 018D
        gbc.setState(0xbc39, 0x287f, 0xe1c0, 0x3cff, 0x9913, 0x6635, 0x1, 0x0);
        gbc.writeMem(0xbc39, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xe0);
        EXPECT(gbc.b(),  0x3c);
        EXPECT(gbc.c(),  0xff);
        EXPECT(gbc.d(),  0x99);
        EXPECT(gbc.e(),  0x13);
        EXPECT(gbc.h(),  0x66);
        EXPECT(gbc.l(),  0x35);
        EXPECT(gbc.sp(), 0x287f);
        EXPECT(gbc.pc(), 0xbc3a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbc39), 0x3d);
        // 3D 018E
        gbc.setState(0xd6f6, 0xa474, 0xd4e0, 0x64a4, 0xc396, 0x5e8, 0x0, 0x0);
        gbc.writeMem(0xd6f6, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xd3);
        EXPECT(gbc.b(),  0x64);
        EXPECT(gbc.c(),  0xa4);
        EXPECT(gbc.d(),  0xc3);
        EXPECT(gbc.e(),  0x96);
        EXPECT(gbc.h(),  0x5);
        EXPECT(gbc.l(),  0xe8);
        EXPECT(gbc.sp(), 0xa474);
        EXPECT(gbc.pc(), 0xd6f7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd6f6), 0x3d);
        // 3D 018F
        gbc.setState(0xbca8, 0xe11e, 0xc2b0, 0x1677, 0x6fd8, 0xb89b, 0x0, 0x1);
        gbc.writeMem(0xbca8, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xc1);
        EXPECT(gbc.b(),  0x16);
        EXPECT(gbc.c(),  0x77);
        EXPECT(gbc.d(),  0x6f);
        EXPECT(gbc.e(),  0xd8);
        EXPECT(gbc.h(),  0xb8);
        EXPECT(gbc.l(),  0x9b);
        EXPECT(gbc.sp(), 0xe11e);
        EXPECT(gbc.pc(), 0xbca9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbca8), 0x3d);
        // 3D 0190
        gbc.setState(0x3bb6, 0x5ce6, 0xf040, 0x7f15, 0xca0d, 0x73ba, 0x1, 0x0);
        gbc.writeMem(0x3bb6, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xef);
        EXPECT(gbc.b(),  0x7f);
        EXPECT(gbc.c(),  0x15);
        EXPECT(gbc.d(),  0xca);
        EXPECT(gbc.e(),  0xd);
        EXPECT(gbc.h(),  0x73);
        EXPECT(gbc.l(),  0xba);
        EXPECT(gbc.sp(), 0x5ce6);
        EXPECT(gbc.pc(), 0x3bb7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 3D 0191
        gbc.setState(0xad35, 0x2ed3, 0xb830, 0xe15c, 0x7aae, 0x998f, 0x1, 0x0);
        gbc.writeMem(0xad35, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xb7);
        EXPECT(gbc.b(),  0xe1);
        EXPECT(gbc.c(),  0x5c);
        EXPECT(gbc.d(),  0x7a);
        EXPECT(gbc.e(),  0xae);
        EXPECT(gbc.h(),  0x99);
        EXPECT(gbc.l(),  0x8f);
        EXPECT(gbc.sp(), 0x2ed3);
        EXPECT(gbc.pc(), 0xad36);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xad35), 0x3d);
        // 3D 0192
        gbc.setState(0x2c16, 0xb65f, 0xf450, 0xcbee, 0x38cd, 0xb7a0, 0x1, 0x0);
        gbc.writeMem(0x2c16, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf3);
        EXPECT(gbc.b(),  0xcb);
        EXPECT(gbc.c(),  0xee);
        EXPECT(gbc.d(),  0x38);
        EXPECT(gbc.e(),  0xcd);
        EXPECT(gbc.h(),  0xb7);
        EXPECT(gbc.l(),  0xa0);
        EXPECT(gbc.sp(), 0xb65f);
        EXPECT(gbc.pc(), 0x2c17);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0193
        gbc.setState(0xa916, 0x8040, 0x9680, 0xa636, 0xf5df, 0x96e3, 0x0, 0x1);
        gbc.writeMem(0xa916, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x95);
        EXPECT(gbc.b(),  0xa6);
        EXPECT(gbc.c(),  0x36);
        EXPECT(gbc.d(),  0xf5);
        EXPECT(gbc.e(),  0xdf);
        EXPECT(gbc.h(),  0x96);
        EXPECT(gbc.l(),  0xe3);
        EXPECT(gbc.sp(), 0x8040);
        EXPECT(gbc.pc(), 0xa917);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa916), 0x3d);
        // 3D 0194
        gbc.setState(0xc081, 0xe09e, 0xa7c0, 0xbe0e, 0x9b67, 0xc4a2, 0x1, 0x0);
        gbc.writeMem(0xc081, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa6);
        EXPECT(gbc.b(),  0xbe);
        EXPECT(gbc.c(),  0xe);
        EXPECT(gbc.d(),  0x9b);
        EXPECT(gbc.e(),  0x67);
        EXPECT(gbc.h(),  0xc4);
        EXPECT(gbc.l(),  0xa2);
        EXPECT(gbc.sp(), 0xe09e);
        EXPECT(gbc.pc(), 0xc082);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc081), 0x3d);
        // 3D 0195
        gbc.setState(0x531d, 0x25c6, 0x15d0, 0xe760, 0x26d6, 0xc631, 0x1, 0x0);
        gbc.writeMem(0x531d, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x14);
        EXPECT(gbc.b(),  0xe7);
        EXPECT(gbc.c(),  0x60);
        EXPECT(gbc.d(),  0x26);
        EXPECT(gbc.e(),  0xd6);
        EXPECT(gbc.h(),  0xc6);
        EXPECT(gbc.l(),  0x31);
        EXPECT(gbc.sp(), 0x25c6);
        EXPECT(gbc.pc(), 0x531e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0196
        gbc.setState(0x3274, 0x94ea, 0x480, 0x48d1, 0x5bd6, 0x349b, 0x1, 0x0);
        gbc.writeMem(0x3274, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x3);
        EXPECT(gbc.b(),  0x48);
        EXPECT(gbc.c(),  0xd1);
        EXPECT(gbc.d(),  0x5b);
        EXPECT(gbc.e(),  0xd6);
        EXPECT(gbc.h(),  0x34);
        EXPECT(gbc.l(),  0x9b);
        EXPECT(gbc.sp(), 0x94ea);
        EXPECT(gbc.pc(), 0x3275);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0197
        gbc.setState(0xc142, 0x2c90, 0x770, 0xc105, 0xed83, 0xfaed, 0x0, 0x0);
        gbc.writeMem(0xc142, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x6);
        EXPECT(gbc.b(),  0xc1);
        EXPECT(gbc.c(),  0x5);
        EXPECT(gbc.d(),  0xed);
        EXPECT(gbc.e(),  0x83);
        EXPECT(gbc.h(),  0xfa);
        EXPECT(gbc.l(),  0xed);
        EXPECT(gbc.sp(), 0x2c90);
        EXPECT(gbc.pc(), 0xc143);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc142), 0x3d);
        // 3D 0198
        gbc.setState(0xc9c0, 0xff72, 0x8f30, 0xf986, 0x36a9, 0x2744, 0x0, 0x0);
        gbc.writeMem(0xc9c0, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x8e);
        EXPECT(gbc.b(),  0xf9);
        EXPECT(gbc.c(),  0x86);
        EXPECT(gbc.d(),  0x36);
        EXPECT(gbc.e(),  0xa9);
        EXPECT(gbc.h(),  0x27);
        EXPECT(gbc.l(),  0x44);
        EXPECT(gbc.sp(), 0xff72);
        EXPECT(gbc.pc(), 0xc9c1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc9c0), 0x3d);
        // 3D 0199
        gbc.setState(0x1105, 0xb232, 0xdc30, 0xe40b, 0xad54, 0xf805, 0x1, 0x0);
        gbc.writeMem(0x1105, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xdb);
        EXPECT(gbc.b(),  0xe4);
        EXPECT(gbc.c(),  0xb);
        EXPECT(gbc.d(),  0xad);
        EXPECT(gbc.e(),  0x54);
        EXPECT(gbc.h(),  0xf8);
        EXPECT(gbc.l(),  0x5);
        EXPECT(gbc.sp(), 0xb232);
        EXPECT(gbc.pc(), 0x1106);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 019A
        gbc.setState(0xeb57, 0x7809, 0xfae0, 0x64fe, 0xc303, 0x8a1, 0x0, 0x1);
        gbc.writeMem(0xeb57, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf9);
        EXPECT(gbc.b(),  0x64);
        EXPECT(gbc.c(),  0xfe);
        EXPECT(gbc.d(),  0xc3);
        EXPECT(gbc.e(),  0x3);
        EXPECT(gbc.h(),  0x8);
        EXPECT(gbc.l(),  0xa1);
        EXPECT(gbc.sp(), 0x7809);
        EXPECT(gbc.pc(), 0xeb58);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xeb57), 0x3d);
        // 3D 019B
        gbc.setState(0xc216, 0x570c, 0xa380, 0xa811, 0x6e4e, 0xe652, 0x0, 0x1);
        gbc.writeMem(0xc216, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa2);
        EXPECT(gbc.b(),  0xa8);
        EXPECT(gbc.c(),  0x11);
        EXPECT(gbc.d(),  0x6e);
        EXPECT(gbc.e(),  0x4e);
        EXPECT(gbc.h(),  0xe6);
        EXPECT(gbc.l(),  0x52);
        EXPECT(gbc.sp(), 0x570c);
        EXPECT(gbc.pc(), 0xc217);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc216), 0x3d);
        // 3D 019C
        gbc.setState(0x903a, 0xdbe9, 0xab0, 0x3d28, 0x63da, 0xe4b4, 0x0, 0x0);
        gbc.writeMem(0x903a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x9);
        EXPECT(gbc.b(),  0x3d);
        EXPECT(gbc.c(),  0x28);
        EXPECT(gbc.d(),  0x63);
        EXPECT(gbc.e(),  0xda);
        EXPECT(gbc.h(),  0xe4);
        EXPECT(gbc.l(),  0xb4);
        EXPECT(gbc.sp(), 0xdbe9);
        EXPECT(gbc.pc(), 0x903b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x903a), 0x3d);
        // 3D 019D
        gbc.setState(0x876c, 0xb40d, 0x38b0, 0x4749, 0xc7b8, 0x5294, 0x1, 0x0);
        gbc.writeMem(0x876c, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x37);
        EXPECT(gbc.b(),  0x47);
        EXPECT(gbc.c(),  0x49);
        EXPECT(gbc.d(),  0xc7);
        EXPECT(gbc.e(),  0xb8);
        EXPECT(gbc.h(),  0x52);
        EXPECT(gbc.l(),  0x94);
        EXPECT(gbc.sp(), 0xb40d);
        EXPECT(gbc.pc(), 0x876d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x876c), 0x3d);
        // 3D 019E
        gbc.setState(0x7b74, 0x4305, 0x88a0, 0x958f, 0xd531, 0x51b, 0x1, 0x0);
        gbc.writeMem(0x7b74, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x87);
        EXPECT(gbc.b(),  0x95);
        EXPECT(gbc.c(),  0x8f);
        EXPECT(gbc.d(),  0xd5);
        EXPECT(gbc.e(),  0x31);
        EXPECT(gbc.h(),  0x5);
        EXPECT(gbc.l(),  0x1b);
        EXPECT(gbc.sp(), 0x4305);
        EXPECT(gbc.pc(), 0x7b75);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 019F
        gbc.setState(0xb09a, 0x7446, 0x10a0, 0x4a92, 0x23a6, 0xd2a7, 0x1, 0x1);
        gbc.writeMem(0xb09a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf);
        EXPECT(gbc.b(),  0x4a);
        EXPECT(gbc.c(),  0x92);
        EXPECT(gbc.d(),  0x23);
        EXPECT(gbc.e(),  0xa6);
        EXPECT(gbc.h(),  0xd2);
        EXPECT(gbc.l(),  0xa7);
        EXPECT(gbc.sp(), 0x7446);
        EXPECT(gbc.pc(), 0xb09b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb09a), 0x3d);
        // 3D 01A0
        gbc.setState(0x61b9, 0x14ef, 0x2e80, 0xe300, 0xe18, 0x690c, 0x1, 0x0);
        gbc.writeMem(0x61b9, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x2d);
        EXPECT(gbc.b(),  0xe3);
        EXPECT(gbc.c(),  0x0);
        EXPECT(gbc.d(),  0xe);
        EXPECT(gbc.e(),  0x18);
        EXPECT(gbc.h(),  0x69);
        EXPECT(gbc.l(),  0xc);
        EXPECT(gbc.sp(), 0x14ef);
        EXPECT(gbc.pc(), 0x61ba);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 01A1
        gbc.setState(0xfea, 0x4c3a, 0xb420, 0x6f88, 0x9979, 0x8300, 0x1, 0x0);
        gbc.writeMem(0xfea, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xb3);
        EXPECT(gbc.b(),  0x6f);
        EXPECT(gbc.c(),  0x88);
        EXPECT(gbc.d(),  0x99);
        EXPECT(gbc.e(),  0x79);
        EXPECT(gbc.h(),  0x83);
        EXPECT(gbc.l(),  0x0);
        EXPECT(gbc.sp(), 0x4c3a);
        EXPECT(gbc.pc(), 0xfeb);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 01A2
        gbc.setState(0xc9ff, 0xd4b, 0x1ca0, 0xafeb, 0x92ff, 0x915d, 0x0, 0x1);
        gbc.writeMem(0xc9ff, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x1b);
        EXPECT(gbc.b(),  0xaf);
        EXPECT(gbc.c(),  0xeb);
        EXPECT(gbc.d(),  0x92);
        EXPECT(gbc.e(),  0xff);
        EXPECT(gbc.h(),  0x91);
        EXPECT(gbc.l(),  0x5d);
        EXPECT(gbc.sp(), 0xd4b);
        EXPECT(gbc.pc(), 0xca00);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc9ff), 0x3d);
        // 3D 01A3
        gbc.setState(0x9540, 0x3709, 0x3af0, 0x9c74, 0x2077, 0x90a8, 0x0, 0x0);
        gbc.writeMem(0x9540, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x39);
        EXPECT(gbc.b(),  0x9c);
        EXPECT(gbc.c(),  0x74);
        EXPECT(gbc.d(),  0x20);
        EXPECT(gbc.e(),  0x77);
        EXPECT(gbc.h(),  0x90);
        EXPECT(gbc.l(),  0xa8);
        EXPECT(gbc.sp(), 0x3709);
        EXPECT(gbc.pc(), 0x9541);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9540), 0x3d);
        // 3D 01A4
        gbc.setState(0x5dfc, 0x2728, 0xd4d0, 0x8432, 0x3014, 0x8ab, 0x1, 0x0);
        gbc.writeMem(0x5dfc, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xd3);
        EXPECT(gbc.b(),  0x84);
        EXPECT(gbc.c(),  0x32);
        EXPECT(gbc.d(),  0x30);
        EXPECT(gbc.e(),  0x14);
        EXPECT(gbc.h(),  0x8);
        EXPECT(gbc.l(),  0xab);
        EXPECT(gbc.sp(), 0x2728);
        EXPECT(gbc.pc(), 0x5dfd);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 01A5
        gbc.setState(0xe07, 0x6e06, 0x9c30, 0xabe3, 0x60a0, 0xe1ff, 0x1, 0x1);
        gbc.writeMem(0xe07, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x9b);
        EXPECT(gbc.b(),  0xab);
        EXPECT(gbc.c(),  0xe3);
        EXPECT(gbc.d(),  0x60);
        EXPECT(gbc.e(),  0xa0);
        EXPECT(gbc.h(),  0xe1);
        EXPECT(gbc.l(),  0xff);
        EXPECT(gbc.sp(), 0x6e06);
        EXPECT(gbc.pc(), 0xe08);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 01A6
        gbc.setState(0xc0a0, 0x614a, 0x1370, 0x4141, 0x60d9, 0x5e42, 0x0, 0x1);
        gbc.writeMem(0xc0a0, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x12);
        EXPECT(gbc.b(),  0x41);
        EXPECT(gbc.c(),  0x41);
        EXPECT(gbc.d(),  0x60);
        EXPECT(gbc.e(),  0xd9);
        EXPECT(gbc.h(),  0x5e);
        EXPECT(gbc.l(),  0x42);
        EXPECT(gbc.sp(), 0x614a);
        EXPECT(gbc.pc(), 0xc0a1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc0a0), 0x3d);
        // 3D 01A7
        gbc.setState(0xb1aa, 0xb206, 0x6ec0, 0xe77f, 0xbe5e, 0xcba4, 0x0, 0x1);
        gbc.writeMem(0xb1aa, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x6d);
        EXPECT(gbc.b(),  0xe7);
        EXPECT(gbc.c(),  0x7f);
        EXPECT(gbc.d(),  0xbe);
        EXPECT(gbc.e(),  0x5e);
        EXPECT(gbc.h(),  0xcb);
        EXPECT(gbc.l(),  0xa4);
        EXPECT(gbc.sp(), 0xb206);
        EXPECT(gbc.pc(), 0xb1ab);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb1aa), 0x3d);
        // 3D 01A8
        gbc.setState(0x44a9, 0x9210, 0x3070, 0x61f2, 0x96e7, 0xc57b, 0x1, 0x0);
        gbc.writeMem(0x44a9, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x2f);
        EXPECT(gbc.b(),  0x61);
        EXPECT(gbc.c(),  0xf2);
        EXPECT(gbc.d(),  0x96);
        EXPECT(gbc.e(),  0xe7);
        EXPECT(gbc.h(),  0xc5);
        EXPECT(gbc.l(),  0x7b);
        EXPECT(gbc.sp(), 0x9210);
        EXPECT(gbc.pc(), 0x44aa);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 3D 01A9
        gbc.setState(0x754, 0x7cc2, 0x6b30, 0x31d, 0x3517, 0x7b46, 0x1, 0x1);
        gbc.writeMem(0x754, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x6a);
        EXPECT(gbc.b(),  0x3);
        EXPECT(gbc.c(),  0x1d);
        EXPECT(gbc.d(),  0x35);
        EXPECT(gbc.e(),  0x17);
        EXPECT(gbc.h(),  0x7b);
        EXPECT(gbc.l(),  0x46);
        EXPECT(gbc.sp(), 0x7cc2);
        EXPECT(gbc.pc(), 0x755);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 01AA
        gbc.setState(0xd71e, 0x4c4a, 0xb050, 0xe3ce, 0xab1e, 0xb5c5, 0x0, 0x0);
        gbc.writeMem(0xd71e, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xaf);
        EXPECT(gbc.b(),  0xe3);
        EXPECT(gbc.c(),  0xce);
        EXPECT(gbc.d(),  0xab);
        EXPECT(gbc.e(),  0x1e);
        EXPECT(gbc.h(),  0xb5);
        EXPECT(gbc.l(),  0xc5);
        EXPECT(gbc.sp(), 0x4c4a);
        EXPECT(gbc.pc(), 0xd71f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd71e), 0x3d);
        // 3D 01AB
        gbc.setState(0x87e7, 0xe545, 0xd9e0, 0x4d2, 0xa8c8, 0xd254, 0x0, 0x0);
        gbc.writeMem(0x87e7, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xd8);
        EXPECT(gbc.b(),  0x4);
        EXPECT(gbc.c(),  0xd2);
        EXPECT(gbc.d(),  0xa8);
        EXPECT(gbc.e(),  0xc8);
        EXPECT(gbc.h(),  0xd2);
        EXPECT(gbc.l(),  0x54);
        EXPECT(gbc.sp(), 0xe545);
        EXPECT(gbc.pc(), 0x87e8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x87e7), 0x3d);
        // 3D 01AD
        gbc.setState(0x7e7c, 0xf258, 0x93d0, 0xb293, 0x3e55, 0x615d, 0x1, 0x1);
        gbc.writeMem(0x7e7c, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x92);
        EXPECT(gbc.b(),  0xb2);
        EXPECT(gbc.c(),  0x93);
        EXPECT(gbc.d(),  0x3e);
        EXPECT(gbc.e(),  0x55);
        EXPECT(gbc.h(),  0x61);
        EXPECT(gbc.l(),  0x5d);
        EXPECT(gbc.sp(), 0xf258);
        EXPECT(gbc.pc(), 0x7e7d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 01AE
        gbc.setState(0x5ae7, 0xf573, 0xef80, 0x67a1, 0xcc4c, 0xa5fe, 0x0, 0x1);
        gbc.writeMem(0x5ae7, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xee);
        EXPECT(gbc.b(),  0x67);
        EXPECT(gbc.c(),  0xa1);
        EXPECT(gbc.d(),  0xcc);
        EXPECT(gbc.e(),  0x4c);
        EXPECT(gbc.h(),  0xa5);
        EXPECT(gbc.l(),  0xfe);
        EXPECT(gbc.sp(), 0xf573);
        EXPECT(gbc.pc(), 0x5ae8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 01AF
        gbc.setState(0x7219, 0x7a0f, 0xa020, 0xb36c, 0x29af, 0xcbde, 0x0, 0x0);
        gbc.writeMem(0x7219, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x9f);
        EXPECT(gbc.b(),  0xb3);
        EXPECT(gbc.c(),  0x6c);
        EXPECT(gbc.d(),  0x29);
        EXPECT(gbc.e(),  0xaf);
        EXPECT(gbc.h(),  0xcb);
        EXPECT(gbc.l(),  0xde);
        EXPECT(gbc.sp(), 0x7a0f);
        EXPECT(gbc.pc(), 0x721a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 3D 01B0
        gbc.setState(0x4081, 0x8c64, 0xc690, 0xac39, 0x167c, 0x82c4, 0x0, 0x1);
        gbc.writeMem(0x4081, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xc5);
        EXPECT(gbc.b(),  0xac);
        EXPECT(gbc.c(),  0x39);
        EXPECT(gbc.d(),  0x16);
        EXPECT(gbc.e(),  0x7c);
        EXPECT(gbc.h(),  0x82);
        EXPECT(gbc.l(),  0xc4);
        EXPECT(gbc.sp(), 0x8c64);
        EXPECT(gbc.pc(), 0x4082);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 01B1
        gbc.setState(0xba98, 0xb0cf, 0x8d20, 0x2f63, 0x4d64, 0x1817, 0x1, 0x0);
        gbc.writeMem(0xba98, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x8c);
        EXPECT(gbc.b(),  0x2f);
        EXPECT(gbc.c(),  0x63);
        EXPECT(gbc.d(),  0x4d);
        EXPECT(gbc.e(),  0x64);
        EXPECT(gbc.h(),  0x18);
        EXPECT(gbc.l(),  0x17);
        EXPECT(gbc.sp(), 0xb0cf);
        EXPECT(gbc.pc(), 0xba99);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xba98), 0x3d);
        // 3D 01B2
        gbc.setState(0x7d54, 0x5f7f, 0xa600, 0xb83c, 0xbc3f, 0xa7a0, 0x1, 0x0);
        gbc.writeMem(0x7d54, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa5);
        EXPECT(gbc.b(),  0xb8);
        EXPECT(gbc.c(),  0x3c);
        EXPECT(gbc.d(),  0xbc);
        EXPECT(gbc.e(),  0x3f);
        EXPECT(gbc.h(),  0xa7);
        EXPECT(gbc.l(),  0xa0);
        EXPECT(gbc.sp(), 0x5f7f);
        EXPECT(gbc.pc(), 0x7d55);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 01B3
        gbc.setState(0x6409, 0x6793, 0x8f60, 0x763, 0x72a3, 0x18c3, 0x1, 0x0);
        gbc.writeMem(0x6409, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x8e);
        EXPECT(gbc.b(),  0x7);
        EXPECT(gbc.c(),  0x63);
        EXPECT(gbc.d(),  0x72);
        EXPECT(gbc.e(),  0xa3);
        EXPECT(gbc.h(),  0x18);
        EXPECT(gbc.l(),  0xc3);
        EXPECT(gbc.sp(), 0x6793);
        EXPECT(gbc.pc(), 0x640a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 01B4
        gbc.setState(0xcf75, 0x4f25, 0x9fc0, 0x8cd3, 0x6363, 0xf4e3, 0x0, 0x0);
        gbc.writeMem(0xcf75, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x9e);
        EXPECT(gbc.b(),  0x8c);
        EXPECT(gbc.c(),  0xd3);
        EXPECT(gbc.d(),  0x63);
        EXPECT(gbc.e(),  0x63);
        EXPECT(gbc.h(),  0xf4);
        EXPECT(gbc.l(),  0xe3);
        EXPECT(gbc.sp(), 0x4f25);
        EXPECT(gbc.pc(), 0xcf76);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcf75), 0x3d);
        // 3D 01B5
        gbc.setState(0x890a, 0x35df, 0x50, 0x25d7, 0x8285, 0xe52f, 0x0, 0x0);
        gbc.writeMem(0x890a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xff);
        EXPECT(gbc.b(),  0x25);
        EXPECT(gbc.c(),  0xd7);
        EXPECT(gbc.d(),  0x82);
        EXPECT(gbc.e(),  0x85);
        EXPECT(gbc.h(),  0xe5);
        EXPECT(gbc.l(),  0x2f);
        EXPECT(gbc.sp(), 0x35df);
        EXPECT(gbc.pc(), 0x890b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x890a), 0x3d);
        // 3D 01B6
        gbc.setState(0x447, 0x1127, 0x2da0, 0x2d7, 0x9cfa, 0xdb98, 0x1, 0x0);
        gbc.writeMem(0x447, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x2c);
        EXPECT(gbc.b(),  0x2);
        EXPECT(gbc.c(),  0xd7);
        EXPECT(gbc.d(),  0x9c);
        EXPECT(gbc.e(),  0xfa);
        EXPECT(gbc.h(),  0xdb);
        EXPECT(gbc.l(),  0x98);
        EXPECT(gbc.sp(), 0x1127);
        EXPECT(gbc.pc(), 0x448);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 01B7
        gbc.setState(0x5390, 0xb065, 0xa5e0, 0x1d40, 0xd3b6, 0x264, 0x1, 0x0);
        gbc.writeMem(0x5390, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa4);
        EXPECT(gbc.b(),  0x1d);
        EXPECT(gbc.c(),  0x40);
        EXPECT(gbc.d(),  0xd3);
        EXPECT(gbc.e(),  0xb6);
        EXPECT(gbc.h(),  0x2);
        EXPECT(gbc.l(),  0x64);
        EXPECT(gbc.sp(), 0xb065);
        EXPECT(gbc.pc(), 0x5391);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 01B8
        gbc.setState(0xb222, 0x7b3, 0xe430, 0x25c0, 0xf366, 0xfc30, 0x0, 0x1);
        gbc.writeMem(0xb222, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xe3);
        EXPECT(gbc.b(),  0x25);
        EXPECT(gbc.c(),  0xc0);
        EXPECT(gbc.d(),  0xf3);
        EXPECT(gbc.e(),  0x66);
        EXPECT(gbc.h(),  0xfc);
        EXPECT(gbc.l(),  0x30);
        EXPECT(gbc.sp(), 0x7b3);
        EXPECT(gbc.pc(), 0xb223);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb222), 0x3d);
        // 3D 01B9
        gbc.setState(0x95a6, 0x3dc5, 0x6e60, 0x4e9b, 0x3499, 0xe8f6, 0x1, 0x0);
        gbc.writeMem(0x95a6, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x6d);
        EXPECT(gbc.b(),  0x4e);
        EXPECT(gbc.c(),  0x9b);
        EXPECT(gbc.d(),  0x34);
        EXPECT(gbc.e(),  0x99);
        EXPECT(gbc.h(),  0xe8);
        EXPECT(gbc.l(),  0xf6);
        EXPECT(gbc.sp(), 0x3dc5);
        EXPECT(gbc.pc(), 0x95a7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x95a6), 0x3d);
        // 3D 01BA
        gbc.setState(0xa8ec, 0x7866, 0x8610, 0x1b4d, 0xdb42, 0xc092, 0x1, 0x0);
        gbc.writeMem(0xa8ec, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x85);
        EXPECT(gbc.b(),  0x1b);
        EXPECT(gbc.c(),  0x4d);
        EXPECT(gbc.d(),  0xdb);
        EXPECT(gbc.e(),  0x42);
        EXPECT(gbc.h(),  0xc0);
        EXPECT(gbc.l(),  0x92);
        EXPECT(gbc.sp(), 0x7866);
        EXPECT(gbc.pc(), 0xa8ed);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa8ec), 0x3d);
        // 3D 01BB
        gbc.setState(0xdb32, 0xa757, 0x2620, 0x19c2, 0x462f, 0x8245, 0x1, 0x0);
        gbc.writeMem(0xdb32, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x25);
        EXPECT(gbc.b(),  0x19);
        EXPECT(gbc.c(),  0xc2);
        EXPECT(gbc.d(),  0x46);
        EXPECT(gbc.e(),  0x2f);
        EXPECT(gbc.h(),  0x82);
        EXPECT(gbc.l(),  0x45);
        EXPECT(gbc.sp(), 0xa757);
        EXPECT(gbc.pc(), 0xdb33);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdb32), 0x3d);
        // 3D 01BC
        gbc.setState(0xee2f, 0x3030, 0xa3e0, 0x2f67, 0x9599, 0x80fc, 0x0, 0x1);
        gbc.writeMem(0xee2f, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa2);
        EXPECT(gbc.b(),  0x2f);
        EXPECT(gbc.c(),  0x67);
        EXPECT(gbc.d(),  0x95);
        EXPECT(gbc.e(),  0x99);
        EXPECT(gbc.h(),  0x80);
        EXPECT(gbc.l(),  0xfc);
        EXPECT(gbc.sp(), 0x3030);
        EXPECT(gbc.pc(), 0xee30);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xee2f), 0x3d);
        // 3D 01BD
        gbc.setState(0x5bdb, 0x9488, 0xcf10, 0x2616, 0x4327, 0x3318, 0x0, 0x1);
        gbc.writeMem(0x5bdb, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xce);
        EXPECT(gbc.b(),  0x26);
        EXPECT(gbc.c(),  0x16);
        EXPECT(gbc.d(),  0x43);
        EXPECT(gbc.e(),  0x27);
        EXPECT(gbc.h(),  0x33);
        EXPECT(gbc.l(),  0x18);
        EXPECT(gbc.sp(), 0x9488);
        EXPECT(gbc.pc(), 0x5bdc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 01BE
        gbc.setState(0x492, 0x9039, 0x9ff0, 0x9073, 0xf48d, 0x5263, 0x1, 0x1);
        gbc.writeMem(0x492, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x9e);
        EXPECT(gbc.b(),  0x90);
        EXPECT(gbc.c(),  0x73);
        EXPECT(gbc.d(),  0xf4);
        EXPECT(gbc.e(),  0x8d);
        EXPECT(gbc.h(),  0x52);
        EXPECT(gbc.l(),  0x63);
        EXPECT(gbc.sp(), 0x9039);
        EXPECT(gbc.pc(), 0x493);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 01BF
        gbc.setState(0x901a, 0x9f4d, 0xe770, 0x86c6, 0x86e9, 0x99df, 0x1, 0x0);
        gbc.writeMem(0x901a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xe6);
        EXPECT(gbc.b(),  0x86);
        EXPECT(gbc.c(),  0xc6);
        EXPECT(gbc.d(),  0x86);
        EXPECT(gbc.e(),  0xe9);
        EXPECT(gbc.h(),  0x99);
        EXPECT(gbc.l(),  0xdf);
        EXPECT(gbc.sp(), 0x9f4d);
        EXPECT(gbc.pc(), 0x901b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x901a), 0x3d);
        // 3D 01C0
        gbc.setState(0xbb21, 0x7053, 0x2e00, 0xebb0, 0xec5f, 0x744e, 0x0, 0x0);
        gbc.writeMem(0xbb21, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x2d);
        EXPECT(gbc.b(),  0xeb);
        EXPECT(gbc.c(),  0xb0);
        EXPECT(gbc.d(),  0xec);
        EXPECT(gbc.e(),  0x5f);
        EXPECT(gbc.h(),  0x74);
        EXPECT(gbc.l(),  0x4e);
        EXPECT(gbc.sp(), 0x7053);
        EXPECT(gbc.pc(), 0xbb22);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbb21), 0x3d);
        // 3D 01C1
        gbc.setState(0x7837, 0x57a8, 0x4750, 0x5a46, 0x9071, 0x9b26, 0x1, 0x0);
        gbc.writeMem(0x7837, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x46);
        EXPECT(gbc.b(),  0x5a);
        EXPECT(gbc.c(),  0x46);
        EXPECT(gbc.d(),  0x90);
        EXPECT(gbc.e(),  0x71);
        EXPECT(gbc.h(),  0x9b);
        EXPECT(gbc.l(),  0x26);
        EXPECT(gbc.sp(), 0x57a8);
        EXPECT(gbc.pc(), 0x7838);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 01C2
        gbc.setState(0x6483, 0xbc1, 0xe070, 0x8e0d, 0x2ea8, 0x9da5, 0x0, 0x1);
        gbc.writeMem(0x6483, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xdf);
        EXPECT(gbc.b(),  0x8e);
        EXPECT(gbc.c(),  0xd);
        EXPECT(gbc.d(),  0x2e);
        EXPECT(gbc.e(),  0xa8);
        EXPECT(gbc.h(),  0x9d);
        EXPECT(gbc.l(),  0xa5);
        EXPECT(gbc.sp(), 0xbc1);
        EXPECT(gbc.pc(), 0x6484);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 3D 01C3
        gbc.setState(0x2c39, 0xa07d, 0xc0f0, 0x7177, 0x978a, 0xbda2, 0x1, 0x1);
        gbc.writeMem(0x2c39, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xbf);
        EXPECT(gbc.b(),  0x71);
        EXPECT(gbc.c(),  0x77);
        EXPECT(gbc.d(),  0x97);
        EXPECT(gbc.e(),  0x8a);
        EXPECT(gbc.h(),  0xbd);
        EXPECT(gbc.l(),  0xa2);
        EXPECT(gbc.sp(), 0xa07d);
        EXPECT(gbc.pc(), 0x2c3a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 3D 01C4
        gbc.setState(0xea8f, 0x20c8, 0x8e0, 0xd484, 0xfa26, 0x9329, 0x1, 0x0);
        gbc.writeMem(0xea8f, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x7);
        EXPECT(gbc.b(),  0xd4);
        EXPECT(gbc.c(),  0x84);
        EXPECT(gbc.d(),  0xfa);
        EXPECT(gbc.e(),  0x26);
        EXPECT(gbc.h(),  0x93);
        EXPECT(gbc.l(),  0x29);
        EXPECT(gbc.sp(), 0x20c8);
        EXPECT(gbc.pc(), 0xea90);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xea8f), 0x3d);
        // 3D 01C5
        gbc.setState(0x4b49, 0x5026, 0x6220, 0xa4f4, 0xfdf9, 0x8ddd, 0x0, 0x1);
        gbc.writeMem(0x4b49, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x61);
        EXPECT(gbc.b(),  0xa4);
        EXPECT(gbc.c(),  0xf4);
        EXPECT(gbc.d(),  0xfd);
        EXPECT(gbc.e(),  0xf9);
        EXPECT(gbc.h(),  0x8d);
        EXPECT(gbc.l(),  0xdd);
        EXPECT(gbc.sp(), 0x5026);
        EXPECT(gbc.pc(), 0x4b4a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 01C6
        gbc.setState(0x7a71, 0x63ac, 0xc150, 0x3ec8, 0xe500, 0xd1a5, 0x1, 0x0);
        gbc.writeMem(0x7a71, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xc0);
        EXPECT(gbc.b(),  0x3e);
        EXPECT(gbc.c(),  0xc8);
        EXPECT(gbc.d(),  0xe5);
        EXPECT(gbc.e(),  0x0);
        EXPECT(gbc.h(),  0xd1);
        EXPECT(gbc.l(),  0xa5);
        EXPECT(gbc.sp(), 0x63ac);
        EXPECT(gbc.pc(), 0x7a72);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 01C7
        gbc.setState(0x5c14, 0x7135, 0x6df0, 0xcde3, 0x1f65, 0x866b, 0x0, 0x0);
        gbc.writeMem(0x5c14, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x6c);
        EXPECT(gbc.b(),  0xcd);
        EXPECT(gbc.c(),  0xe3);
        EXPECT(gbc.d(),  0x1f);
        EXPECT(gbc.e(),  0x65);
        EXPECT(gbc.h(),  0x86);
        EXPECT(gbc.l(),  0x6b);
        EXPECT(gbc.sp(), 0x7135);
        EXPECT(gbc.pc(), 0x5c15);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 01C8
        gbc.setState(0xc444, 0x61a1, 0x9570, 0x2cea, 0xb594, 0xb925, 0x0, 0x0);
        gbc.writeMem(0xc444, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x94);
        EXPECT(gbc.b(),  0x2c);
        EXPECT(gbc.c(),  0xea);
        EXPECT(gbc.d(),  0xb5);
        EXPECT(gbc.e(),  0x94);
        EXPECT(gbc.h(),  0xb9);
        EXPECT(gbc.l(),  0x25);
        EXPECT(gbc.sp(), 0x61a1);
        EXPECT(gbc.pc(), 0xc445);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc444), 0x3d);
        // 3D 01C9
        gbc.setState(0x4acf, 0x297e, 0x9a90, 0x6b43, 0x7938, 0x5683, 0x0, 0x0);
        gbc.writeMem(0x4acf, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x99);
        EXPECT(gbc.b(),  0x6b);
        EXPECT(gbc.c(),  0x43);
        EXPECT(gbc.d(),  0x79);
        EXPECT(gbc.e(),  0x38);
        EXPECT(gbc.h(),  0x56);
        EXPECT(gbc.l(),  0x83);
        EXPECT(gbc.sp(), 0x297e);
        EXPECT(gbc.pc(), 0x4ad0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 01CA
        gbc.setState(0x7d8e, 0xb8b0, 0xcd30, 0xb43c, 0x53dd, 0xfa4, 0x1, 0x1);
        gbc.writeMem(0x7d8e, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xcc);
        EXPECT(gbc.b(),  0xb4);
        EXPECT(gbc.c(),  0x3c);
        EXPECT(gbc.d(),  0x53);
        EXPECT(gbc.e(),  0xdd);
        EXPECT(gbc.h(),  0xf);
        EXPECT(gbc.l(),  0xa4);
        EXPECT(gbc.sp(), 0xb8b0);
        EXPECT(gbc.pc(), 0x7d8f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 01CB
        gbc.setState(0xd717, 0x892b, 0x4a30, 0xcd0, 0x841d, 0x4135, 0x0, 0x0);
        gbc.writeMem(0xd717, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x49);
        EXPECT(gbc.b(),  0xc);
        EXPECT(gbc.c(),  0xd0);
        EXPECT(gbc.d(),  0x84);
        EXPECT(gbc.e(),  0x1d);
        EXPECT(gbc.h(),  0x41);
        EXPECT(gbc.l(),  0x35);
        EXPECT(gbc.sp(), 0x892b);
        EXPECT(gbc.pc(), 0xd718);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd717), 0x3d);
        // 3D 01CC
        gbc.setState(0x61f7, 0x159c, 0x39f0, 0xbafd, 0xe082, 0x9398, 0x1, 0x0);
        gbc.writeMem(0x61f7, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x38);
        EXPECT(gbc.b(),  0xba);
        EXPECT(gbc.c(),  0xfd);
        EXPECT(gbc.d(),  0xe0);
        EXPECT(gbc.e(),  0x82);
        EXPECT(gbc.h(),  0x93);
        EXPECT(gbc.l(),  0x98);
        EXPECT(gbc.sp(), 0x159c);
        EXPECT(gbc.pc(), 0x61f8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 01CD
        gbc.setState(0xeda5, 0x2845, 0xc80, 0xcdf6, 0x137c, 0xd569, 0x1, 0x0);
        gbc.writeMem(0xeda5, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xb);
        EXPECT(gbc.b(),  0xcd);
        EXPECT(gbc.c(),  0xf6);
        EXPECT(gbc.d(),  0x13);
        EXPECT(gbc.e(),  0x7c);
        EXPECT(gbc.h(),  0xd5);
        EXPECT(gbc.l(),  0x69);
        EXPECT(gbc.sp(), 0x2845);
        EXPECT(gbc.pc(), 0xeda6);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xeda5), 0x3d);
        // 3D 01CE
        gbc.setState(0xc346, 0x87fd, 0x1d90, 0xbbc4, 0x7343, 0xe86c, 0x0, 0x1);
        gbc.writeMem(0xc346, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x1c);
        EXPECT(gbc.b(),  0xbb);
        EXPECT(gbc.c(),  0xc4);
        EXPECT(gbc.d(),  0x73);
        EXPECT(gbc.e(),  0x43);
        EXPECT(gbc.h(),  0xe8);
        EXPECT(gbc.l(),  0x6c);
        EXPECT(gbc.sp(), 0x87fd);
        EXPECT(gbc.pc(), 0xc347);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc346), 0x3d);
        // 3D 01CF
        gbc.setState(0xc4c0, 0x47f9, 0xb100, 0xebc8, 0x1895, 0xca6f, 0x1, 0x1);
        gbc.writeMem(0xc4c0, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xb0);
        EXPECT(gbc.b(),  0xeb);
        EXPECT(gbc.c(),  0xc8);
        EXPECT(gbc.d(),  0x18);
        EXPECT(gbc.e(),  0x95);
        EXPECT(gbc.h(),  0xca);
        EXPECT(gbc.l(),  0x6f);
        EXPECT(gbc.sp(), 0x47f9);
        EXPECT(gbc.pc(), 0xc4c1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc4c0), 0x3d);
        // 3D 01D0
        gbc.setState(0xa47e, 0x9cfe, 0xa9a0, 0x1ed2, 0x414f, 0x325e, 0x0, 0x0);
        gbc.writeMem(0xa47e, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa8);
        EXPECT(gbc.b(),  0x1e);
        EXPECT(gbc.c(),  0xd2);
        EXPECT(gbc.d(),  0x41);
        EXPECT(gbc.e(),  0x4f);
        EXPECT(gbc.h(),  0x32);
        EXPECT(gbc.l(),  0x5e);
        EXPECT(gbc.sp(), 0x9cfe);
        EXPECT(gbc.pc(), 0xa47f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa47e), 0x3d);
        // 3D 01D1
        gbc.setState(0xa4bc, 0xb4fd, 0x1070, 0x7a35, 0xb438, 0xa6dc, 0x0, 0x0);
        gbc.writeMem(0xa4bc, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf);
        EXPECT(gbc.b(),  0x7a);
        EXPECT(gbc.c(),  0x35);
        EXPECT(gbc.d(),  0xb4);
        EXPECT(gbc.e(),  0x38);
        EXPECT(gbc.h(),  0xa6);
        EXPECT(gbc.l(),  0xdc);
        EXPECT(gbc.sp(), 0xb4fd);
        EXPECT(gbc.pc(), 0xa4bd);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa4bc), 0x3d);
        // 3D 01D2
        gbc.setState(0x2e1d, 0xdb74, 0xbe20, 0x7153, 0x4ba3, 0xc471, 0x1, 0x1);
        gbc.writeMem(0x2e1d, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xbd);
        EXPECT(gbc.b(),  0x71);
        EXPECT(gbc.c(),  0x53);
        EXPECT(gbc.d(),  0x4b);
        EXPECT(gbc.e(),  0xa3);
        EXPECT(gbc.h(),  0xc4);
        EXPECT(gbc.l(),  0x71);
        EXPECT(gbc.sp(), 0xdb74);
        EXPECT(gbc.pc(), 0x2e1e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 01D3
        gbc.setState(0xdf75, 0xfd3e, 0x1d80, 0xcbb9, 0x8f9a, 0x8aa4, 0x1, 0x0);
        gbc.writeMem(0xdf75, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x1c);
        EXPECT(gbc.b(),  0xcb);
        EXPECT(gbc.c(),  0xb9);
        EXPECT(gbc.d(),  0x8f);
        EXPECT(gbc.e(),  0x9a);
        EXPECT(gbc.h(),  0x8a);
        EXPECT(gbc.l(),  0xa4);
        EXPECT(gbc.sp(), 0xfd3e);
        EXPECT(gbc.pc(), 0xdf76);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdf75), 0x3d);
        // 3D 01D4
        gbc.setState(0x6ae3, 0xa630, 0xfe40, 0x1b2a, 0xd8e3, 0x55da, 0x0, 0x1);
        gbc.writeMem(0x6ae3, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xfd);
        EXPECT(gbc.b(),  0x1b);
        EXPECT(gbc.c(),  0x2a);
        EXPECT(gbc.d(),  0xd8);
        EXPECT(gbc.e(),  0xe3);
        EXPECT(gbc.h(),  0x55);
        EXPECT(gbc.l(),  0xda);
        EXPECT(gbc.sp(), 0xa630);
        EXPECT(gbc.pc(), 0x6ae4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 01D5
        gbc.setState(0xd15, 0x6b0d, 0x280, 0x717e, 0xe10e, 0xc034, 0x1, 0x0);
        gbc.writeMem(0xd15, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0x71);
        EXPECT(gbc.c(),  0x7e);
        EXPECT(gbc.d(),  0xe1);
        EXPECT(gbc.e(),  0xe);
        EXPECT(gbc.h(),  0xc0);
        EXPECT(gbc.l(),  0x34);
        EXPECT(gbc.sp(), 0x6b0d);
        EXPECT(gbc.pc(), 0xd16);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 01D6
        gbc.setState(0xd906, 0xde46, 0xb990, 0x621e, 0x44bc, 0x30a1, 0x1, 0x1);
        gbc.writeMem(0xd906, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xb8);
        EXPECT(gbc.b(),  0x62);
        EXPECT(gbc.c(),  0x1e);
        EXPECT(gbc.d(),  0x44);
        EXPECT(gbc.e(),  0xbc);
        EXPECT(gbc.h(),  0x30);
        EXPECT(gbc.l(),  0xa1);
        EXPECT(gbc.sp(), 0xde46);
        EXPECT(gbc.pc(), 0xd907);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd906), 0x3d);
        // 3D 01D7
        gbc.setState(0x1948, 0xc6f0, 0xa10, 0x13e, 0x7c09, 0x65e7, 0x0, 0x0);
        gbc.writeMem(0x1948, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x9);
        EXPECT(gbc.b(),  0x1);
        EXPECT(gbc.c(),  0x3e);
        EXPECT(gbc.d(),  0x7c);
        EXPECT(gbc.e(),  0x9);
        EXPECT(gbc.h(),  0x65);
        EXPECT(gbc.l(),  0xe7);
        EXPECT(gbc.sp(), 0xc6f0);
        EXPECT(gbc.pc(), 0x1949);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 01D8
        gbc.setState(0x9259, 0x332d, 0xfb00, 0x8485, 0x1793, 0xd432, 0x0, 0x1);
        gbc.writeMem(0x9259, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xfa);
        EXPECT(gbc.b(),  0x84);
        EXPECT(gbc.c(),  0x85);
        EXPECT(gbc.d(),  0x17);
        EXPECT(gbc.e(),  0x93);
        EXPECT(gbc.h(),  0xd4);
        EXPECT(gbc.l(),  0x32);
        EXPECT(gbc.sp(), 0x332d);
        EXPECT(gbc.pc(), 0x925a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9259), 0x3d);
        // 3D 01D9
        gbc.setState(0x4072, 0x931c, 0xcce0, 0x59c6, 0x390f, 0xdd68, 0x1, 0x1);
        gbc.writeMem(0x4072, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xcb);
        EXPECT(gbc.b(),  0x59);
        EXPECT(gbc.c(),  0xc6);
        EXPECT(gbc.d(),  0x39);
        EXPECT(gbc.e(),  0xf);
        EXPECT(gbc.h(),  0xdd);
        EXPECT(gbc.l(),  0x68);
        EXPECT(gbc.sp(), 0x931c);
        EXPECT(gbc.pc(), 0x4073);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 01DA
        gbc.setState(0x9d78, 0x410, 0x4670, 0x3b1c, 0xe573, 0x4876, 0x0, 0x0);
        gbc.writeMem(0x9d78, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x45);
        EXPECT(gbc.b(),  0x3b);
        EXPECT(gbc.c(),  0x1c);
        EXPECT(gbc.d(),  0xe5);
        EXPECT(gbc.e(),  0x73);
        EXPECT(gbc.h(),  0x48);
        EXPECT(gbc.l(),  0x76);
        EXPECT(gbc.sp(), 0x410);
        EXPECT(gbc.pc(), 0x9d79);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9d78), 0x3d);
        // 3D 01DB
        gbc.setState(0xabca, 0x1d05, 0xf750, 0xc41d, 0x77b3, 0x7dde, 0x0, 0x1);
        gbc.writeMem(0xabca, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf6);
        EXPECT(gbc.b(),  0xc4);
        EXPECT(gbc.c(),  0x1d);
        EXPECT(gbc.d(),  0x77);
        EXPECT(gbc.e(),  0xb3);
        EXPECT(gbc.h(),  0x7d);
        EXPECT(gbc.l(),  0xde);
        EXPECT(gbc.sp(), 0x1d05);
        EXPECT(gbc.pc(), 0xabcb);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xabca), 0x3d);
        // 3D 01DC
        gbc.setState(0x4d1, 0x6b17, 0x4ac0, 0xac0, 0xbe3f, 0xa209, 0x0, 0x0);
        gbc.writeMem(0x4d1, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x49);
        EXPECT(gbc.b(),  0xa);
        EXPECT(gbc.c(),  0xc0);
        EXPECT(gbc.d(),  0xbe);
        EXPECT(gbc.e(),  0x3f);
        EXPECT(gbc.h(),  0xa2);
        EXPECT(gbc.l(),  0x9);
        EXPECT(gbc.sp(), 0x6b17);
        EXPECT(gbc.pc(), 0x4d2);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 01DD
        gbc.setState(0x38e9, 0x32f3, 0x3830, 0xa9a, 0xc2f7, 0x2a7d, 0x1, 0x1);
        gbc.writeMem(0x38e9, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x37);
        EXPECT(gbc.b(),  0xa);
        EXPECT(gbc.c(),  0x9a);
        EXPECT(gbc.d(),  0xc2);
        EXPECT(gbc.e(),  0xf7);
        EXPECT(gbc.h(),  0x2a);
        EXPECT(gbc.l(),  0x7d);
        EXPECT(gbc.sp(), 0x32f3);
        EXPECT(gbc.pc(), 0x38ea);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 01DE
        gbc.setState(0x52ad, 0xb0bd, 0x7c40, 0x632f, 0x5d61, 0xa00d, 0x1, 0x1);
        gbc.writeMem(0x52ad, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x7b);
        EXPECT(gbc.b(),  0x63);
        EXPECT(gbc.c(),  0x2f);
        EXPECT(gbc.d(),  0x5d);
        EXPECT(gbc.e(),  0x61);
        EXPECT(gbc.h(),  0xa0);
        EXPECT(gbc.l(),  0xd);
        EXPECT(gbc.sp(), 0xb0bd);
        EXPECT(gbc.pc(), 0x52ae);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 01DF
        gbc.setState(0x5716, 0xa804, 0x3110, 0x70a9, 0x546c, 0xf9f7, 0x0, 0x1);
        gbc.writeMem(0x5716, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x30);
        EXPECT(gbc.b(),  0x70);
        EXPECT(gbc.c(),  0xa9);
        EXPECT(gbc.d(),  0x54);
        EXPECT(gbc.e(),  0x6c);
        EXPECT(gbc.h(),  0xf9);
        EXPECT(gbc.l(),  0xf7);
        EXPECT(gbc.sp(), 0xa804);
        EXPECT(gbc.pc(), 0x5717);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 01E0
        gbc.setState(0xc9f8, 0x9e52, 0xbd70, 0x3c94, 0x9f47, 0x21ff, 0x1, 0x0);
        gbc.writeMem(0xc9f8, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xbc);
        EXPECT(gbc.b(),  0x3c);
        EXPECT(gbc.c(),  0x94);
        EXPECT(gbc.d(),  0x9f);
        EXPECT(gbc.e(),  0x47);
        EXPECT(gbc.h(),  0x21);
        EXPECT(gbc.l(),  0xff);
        EXPECT(gbc.sp(), 0x9e52);
        EXPECT(gbc.pc(), 0xc9f9);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc9f8), 0x3d);
        // 3D 01E1
        gbc.setState(0x540d, 0xfe8b, 0x6250, 0xfe08, 0x2bad, 0x8822, 0x0, 0x0);
        gbc.writeMem(0x540d, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x61);
        EXPECT(gbc.b(),  0xfe);
        EXPECT(gbc.c(),  0x8);
        EXPECT(gbc.d(),  0x2b);
        EXPECT(gbc.e(),  0xad);
        EXPECT(gbc.h(),  0x88);
        EXPECT(gbc.l(),  0x22);
        EXPECT(gbc.sp(), 0xfe8b);
        EXPECT(gbc.pc(), 0x540e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 01E2
        gbc.setState(0x55b5, 0xb8c1, 0x8460, 0x10c, 0x5941, 0x6a57, 0x0, 0x1);
        gbc.writeMem(0x55b5, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x83);
        EXPECT(gbc.b(),  0x1);
        EXPECT(gbc.c(),  0xc);
        EXPECT(gbc.d(),  0x59);
        EXPECT(gbc.e(),  0x41);
        EXPECT(gbc.h(),  0x6a);
        EXPECT(gbc.l(),  0x57);
        EXPECT(gbc.sp(), 0xb8c1);
        EXPECT(gbc.pc(), 0x55b6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 01E3
        gbc.setState(0xb062, 0x1bea, 0xcac0, 0x79fe, 0x1e6f, 0x8ce0, 0x1, 0x0);
        gbc.writeMem(0xb062, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xc9);
        EXPECT(gbc.b(),  0x79);
        EXPECT(gbc.c(),  0xfe);
        EXPECT(gbc.d(),  0x1e);
        EXPECT(gbc.e(),  0x6f);
        EXPECT(gbc.h(),  0x8c);
        EXPECT(gbc.l(),  0xe0);
        EXPECT(gbc.sp(), 0x1bea);
        EXPECT(gbc.pc(), 0xb063);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb062), 0x3d);
        // 3D 01E4
        gbc.setState(0x3cf, 0x8343, 0xa3e0, 0xdff7, 0xb5cf, 0xb494, 0x0, 0x0);
        gbc.writeMem(0x3cf, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa2);
        EXPECT(gbc.b(),  0xdf);
        EXPECT(gbc.c(),  0xf7);
        EXPECT(gbc.d(),  0xb5);
        EXPECT(gbc.e(),  0xcf);
        EXPECT(gbc.h(),  0xb4);
        EXPECT(gbc.l(),  0x94);
        EXPECT(gbc.sp(), 0x8343);
        EXPECT(gbc.pc(), 0x3d0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 01E5
        gbc.setState(0x244a, 0x11e8, 0x68c0, 0xdefa, 0x2ec5, 0x8dfa, 0x1, 0x1);
        gbc.writeMem(0x244a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x67);
        EXPECT(gbc.b(),  0xde);
        EXPECT(gbc.c(),  0xfa);
        EXPECT(gbc.d(),  0x2e);
        EXPECT(gbc.e(),  0xc5);
        EXPECT(gbc.h(),  0x8d);
        EXPECT(gbc.l(),  0xfa);
        EXPECT(gbc.sp(), 0x11e8);
        EXPECT(gbc.pc(), 0x244b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 01E6
        gbc.setState(0x103a, 0x5b6a, 0x11c0, 0x14b4, 0x812d, 0x822b, 0x1, 0x0);
        gbc.writeMem(0x103a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0x14);
        EXPECT(gbc.c(),  0xb4);
        EXPECT(gbc.d(),  0x81);
        EXPECT(gbc.e(),  0x2d);
        EXPECT(gbc.h(),  0x82);
        EXPECT(gbc.l(),  0x2b);
        EXPECT(gbc.sp(), 0x5b6a);
        EXPECT(gbc.pc(), 0x103b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 01E7
        gbc.setState(0xae87, 0x4dcc, 0xc2f0, 0xb920, 0xc89c, 0xcbdb, 0x1, 0x1);
        gbc.writeMem(0xae87, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xc1);
        EXPECT(gbc.b(),  0xb9);
        EXPECT(gbc.c(),  0x20);
        EXPECT(gbc.d(),  0xc8);
        EXPECT(gbc.e(),  0x9c);
        EXPECT(gbc.h(),  0xcb);
        EXPECT(gbc.l(),  0xdb);
        EXPECT(gbc.sp(), 0x4dcc);
        EXPECT(gbc.pc(), 0xae88);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xae87), 0x3d);
        // 3D 01E8
        gbc.setState(0xdec7, 0xde3f, 0xce60, 0x7869, 0x45c3, 0xcb76, 0x0, 0x0);
        gbc.writeMem(0xdec7, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xcd);
        EXPECT(gbc.b(),  0x78);
        EXPECT(gbc.c(),  0x69);
        EXPECT(gbc.d(),  0x45);
        EXPECT(gbc.e(),  0xc3);
        EXPECT(gbc.h(),  0xcb);
        EXPECT(gbc.l(),  0x76);
        EXPECT(gbc.sp(), 0xde3f);
        EXPECT(gbc.pc(), 0xdec8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdec7), 0x3d);
        // 3D 01E9
        gbc.setState(0x1660, 0xfea1, 0x4fd0, 0xabdd, 0x76ac, 0x8d8f, 0x0, 0x1);
        gbc.writeMem(0x1660, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x4e);
        EXPECT(gbc.b(),  0xab);
        EXPECT(gbc.c(),  0xdd);
        EXPECT(gbc.d(),  0x76);
        EXPECT(gbc.e(),  0xac);
        EXPECT(gbc.h(),  0x8d);
        EXPECT(gbc.l(),  0x8f);
        EXPECT(gbc.sp(), 0xfea1);
        EXPECT(gbc.pc(), 0x1661);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 01EA
        gbc.setState(0xe142, 0x9736, 0xa150, 0x888c, 0x5be5, 0xd6da, 0x1, 0x0);
        gbc.writeMem(0xe142, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa0);
        EXPECT(gbc.b(),  0x88);
        EXPECT(gbc.c(),  0x8c);
        EXPECT(gbc.d(),  0x5b);
        EXPECT(gbc.e(),  0xe5);
        EXPECT(gbc.h(),  0xd6);
        EXPECT(gbc.l(),  0xda);
        EXPECT(gbc.sp(), 0x9736);
        EXPECT(gbc.pc(), 0xe143);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe142), 0x3d);
        // 3D 01EB
        gbc.setState(0x32be, 0x63a7, 0x5d80, 0x8a72, 0x13c7, 0x84d4, 0x0, 0x1);
        gbc.writeMem(0x32be, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x5c);
        EXPECT(gbc.b(),  0x8a);
        EXPECT(gbc.c(),  0x72);
        EXPECT(gbc.d(),  0x13);
        EXPECT(gbc.e(),  0xc7);
        EXPECT(gbc.h(),  0x84);
        EXPECT(gbc.l(),  0xd4);
        EXPECT(gbc.sp(), 0x63a7);
        EXPECT(gbc.pc(), 0x32bf);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 01EC
        gbc.setState(0xd192, 0x2a80, 0x2910, 0x9998, 0xdf96, 0x5deb, 0x0, 0x1);
        gbc.writeMem(0xd192, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0x99);
        EXPECT(gbc.c(),  0x98);
        EXPECT(gbc.d(),  0xdf);
        EXPECT(gbc.e(),  0x96);
        EXPECT(gbc.h(),  0x5d);
        EXPECT(gbc.l(),  0xeb);
        EXPECT(gbc.sp(), 0x2a80);
        EXPECT(gbc.pc(), 0xd193);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd192), 0x3d);
        // 3D 01ED
        gbc.setState(0x971e, 0x8d65, 0x7040, 0xc973, 0x346f, 0x10c2, 0x1, 0x1);
        gbc.writeMem(0x971e, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x6f);
        EXPECT(gbc.b(),  0xc9);
        EXPECT(gbc.c(),  0x73);
        EXPECT(gbc.d(),  0x34);
        EXPECT(gbc.e(),  0x6f);
        EXPECT(gbc.h(),  0x10);
        EXPECT(gbc.l(),  0xc2);
        EXPECT(gbc.sp(), 0x8d65);
        EXPECT(gbc.pc(), 0x971f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x971e), 0x3d);
        // 3D 01EE
        gbc.setState(0x2e15, 0xef63, 0xa6d0, 0x98e0, 0x3404, 0xc573, 0x1, 0x1);
        gbc.writeMem(0x2e15, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa5);
        EXPECT(gbc.b(),  0x98);
        EXPECT(gbc.c(),  0xe0);
        EXPECT(gbc.d(),  0x34);
        EXPECT(gbc.e(),  0x4);
        EXPECT(gbc.h(),  0xc5);
        EXPECT(gbc.l(),  0x73);
        EXPECT(gbc.sp(), 0xef63);
        EXPECT(gbc.pc(), 0x2e16);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 01EF
        gbc.setState(0x4746, 0x5387, 0xd7a0, 0x495a, 0x58a8, 0x763e, 0x0, 0x0);
        gbc.writeMem(0x4746, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xd6);
        EXPECT(gbc.b(),  0x49);
        EXPECT(gbc.c(),  0x5a);
        EXPECT(gbc.d(),  0x58);
        EXPECT(gbc.e(),  0xa8);
        EXPECT(gbc.h(),  0x76);
        EXPECT(gbc.l(),  0x3e);
        EXPECT(gbc.sp(), 0x5387);
        EXPECT(gbc.pc(), 0x4747);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 01F0
        gbc.setState(0xaa52, 0xd947, 0x8590, 0xefbc, 0xa1f7, 0xea6f, 0x0, 0x1);
        gbc.writeMem(0xaa52, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x84);
        EXPECT(gbc.b(),  0xef);
        EXPECT(gbc.c(),  0xbc);
        EXPECT(gbc.d(),  0xa1);
        EXPECT(gbc.e(),  0xf7);
        EXPECT(gbc.h(),  0xea);
        EXPECT(gbc.l(),  0x6f);
        EXPECT(gbc.sp(), 0xd947);
        EXPECT(gbc.pc(), 0xaa53);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xaa52), 0x3d);
        // 3D 01F1
        gbc.setState(0x58b7, 0x6991, 0xc890, 0xfcf6, 0x6fa, 0x85f5, 0x1, 0x1);
        gbc.writeMem(0x58b7, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xc7);
        EXPECT(gbc.b(),  0xfc);
        EXPECT(gbc.c(),  0xf6);
        EXPECT(gbc.d(),  0x6);
        EXPECT(gbc.e(),  0xfa);
        EXPECT(gbc.h(),  0x85);
        EXPECT(gbc.l(),  0xf5);
        EXPECT(gbc.sp(), 0x6991);
        EXPECT(gbc.pc(), 0x58b8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 01F2
        gbc.setState(0x5c1d, 0x9cc6, 0x82c0, 0x4c8a, 0x5eec, 0x19f4, 0x0, 0x1);
        gbc.writeMem(0x5c1d, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x81);
        EXPECT(gbc.b(),  0x4c);
        EXPECT(gbc.c(),  0x8a);
        EXPECT(gbc.d(),  0x5e);
        EXPECT(gbc.e(),  0xec);
        EXPECT(gbc.h(),  0x19);
        EXPECT(gbc.l(),  0xf4);
        EXPECT(gbc.sp(), 0x9cc6);
        EXPECT(gbc.pc(), 0x5c1e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 01F3
        gbc.setState(0xec18, 0xa9a8, 0x8cd0, 0xc752, 0x5d27, 0xbae0, 0x1, 0x1);
        gbc.writeMem(0xec18, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x8b);
        EXPECT(gbc.b(),  0xc7);
        EXPECT(gbc.c(),  0x52);
        EXPECT(gbc.d(),  0x5d);
        EXPECT(gbc.e(),  0x27);
        EXPECT(gbc.h(),  0xba);
        EXPECT(gbc.l(),  0xe0);
        EXPECT(gbc.sp(), 0xa9a8);
        EXPECT(gbc.pc(), 0xec19);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xec18), 0x3d);
        // 3D 01F4
        gbc.setState(0x3c98, 0x11ec, 0x4920, 0x11d4, 0xaabc, 0xe636, 0x1, 0x0);
        gbc.writeMem(0x3c98, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x48);
        EXPECT(gbc.b(),  0x11);
        EXPECT(gbc.c(),  0xd4);
        EXPECT(gbc.d(),  0xaa);
        EXPECT(gbc.e(),  0xbc);
        EXPECT(gbc.h(),  0xe6);
        EXPECT(gbc.l(),  0x36);
        EXPECT(gbc.sp(), 0x11ec);
        EXPECT(gbc.pc(), 0x3c99);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 01F6
        gbc.setState(0x4c8e, 0xa6e6, 0x9230, 0x3b23, 0xab2, 0x4e68, 0x1, 0x0);
        gbc.writeMem(0x4c8e, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x91);
        EXPECT(gbc.b(),  0x3b);
        EXPECT(gbc.c(),  0x23);
        EXPECT(gbc.d(),  0xa);
        EXPECT(gbc.e(),  0xb2);
        EXPECT(gbc.h(),  0x4e);
        EXPECT(gbc.l(),  0x68);
        EXPECT(gbc.sp(), 0xa6e6);
        EXPECT(gbc.pc(), 0x4c8f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 01F7
        gbc.setState(0x745e, 0x84af, 0xe80, 0x639e, 0xaa19, 0xe2db, 0x0, 0x0);
        gbc.writeMem(0x745e, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xd);
        EXPECT(gbc.b(),  0x63);
        EXPECT(gbc.c(),  0x9e);
        EXPECT(gbc.d(),  0xaa);
        EXPECT(gbc.e(),  0x19);
        EXPECT(gbc.h(),  0xe2);
        EXPECT(gbc.l(),  0xdb);
        EXPECT(gbc.sp(), 0x84af);
        EXPECT(gbc.pc(), 0x745f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 01F8
        gbc.setState(0x3871, 0x9cb6, 0x2170, 0x6ba7, 0xebf7, 0x116b, 0x1, 0x1);
        gbc.writeMem(0x3871, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0x6b);
        EXPECT(gbc.c(),  0xa7);
        EXPECT(gbc.d(),  0xeb);
        EXPECT(gbc.e(),  0xf7);
        EXPECT(gbc.h(),  0x11);
        EXPECT(gbc.l(),  0x6b);
        EXPECT(gbc.sp(), 0x9cb6);
        EXPECT(gbc.pc(), 0x3872);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 01F9
        gbc.setState(0x9006, 0xc887, 0xbbb0, 0x40a0, 0x745, 0x2374, 0x1, 0x0);
        gbc.writeMem(0x9006, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xba);
        EXPECT(gbc.b(),  0x40);
        EXPECT(gbc.c(),  0xa0);
        EXPECT(gbc.d(),  0x7);
        EXPECT(gbc.e(),  0x45);
        EXPECT(gbc.h(),  0x23);
        EXPECT(gbc.l(),  0x74);
        EXPECT(gbc.sp(), 0xc887);
        EXPECT(gbc.pc(), 0x9007);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9006), 0x3d);
        // 3D 01FA
        gbc.setState(0xfe, 0x3399, 0x71f0, 0x3ea6, 0x701e, 0x157c, 0x0, 0x0);
        gbc.writeMem(0xfe, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x70);
        EXPECT(gbc.b(),  0x3e);
        EXPECT(gbc.c(),  0xa6);
        EXPECT(gbc.d(),  0x70);
        EXPECT(gbc.e(),  0x1e);
        EXPECT(gbc.h(),  0x15);
        EXPECT(gbc.l(),  0x7c);
        EXPECT(gbc.sp(), 0x3399);
        EXPECT(gbc.pc(), 0xff);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 01FB
        gbc.setState(0x6140, 0xeb6c, 0xe90, 0xb523, 0xe52e, 0x9a90, 0x1, 0x0);
        gbc.writeMem(0x6140, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xd);
        EXPECT(gbc.b(),  0xb5);
        EXPECT(gbc.c(),  0x23);
        EXPECT(gbc.d(),  0xe5);
        EXPECT(gbc.e(),  0x2e);
        EXPECT(gbc.h(),  0x9a);
        EXPECT(gbc.l(),  0x90);
        EXPECT(gbc.sp(), 0xeb6c);
        EXPECT(gbc.pc(), 0x6141);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 01FC
        gbc.setState(0xcea2, 0x1c95, 0x5f00, 0xba4c, 0xb495, 0xa781, 0x0, 0x1);
        gbc.writeMem(0xcea2, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x5e);
        EXPECT(gbc.b(),  0xba);
        EXPECT(gbc.c(),  0x4c);
        EXPECT(gbc.d(),  0xb4);
        EXPECT(gbc.e(),  0x95);
        EXPECT(gbc.h(),  0xa7);
        EXPECT(gbc.l(),  0x81);
        EXPECT(gbc.sp(), 0x1c95);
        EXPECT(gbc.pc(), 0xcea3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcea2), 0x3d);
        // 3D 01FE
        gbc.setState(0x668b, 0xa8a9, 0xc950, 0xad73, 0x694d, 0xe1f0, 0x0, 0x0);
        gbc.writeMem(0x668b, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xc8);
        EXPECT(gbc.b(),  0xad);
        EXPECT(gbc.c(),  0x73);
        EXPECT(gbc.d(),  0x69);
        EXPECT(gbc.e(),  0x4d);
        EXPECT(gbc.h(),  0xe1);
        EXPECT(gbc.l(),  0xf0);
        EXPECT(gbc.sp(), 0xa8a9);
        EXPECT(gbc.pc(), 0x668c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 01FF
        gbc.setState(0xcf67, 0x8c56, 0xc720, 0x4d64, 0xb43d, 0x1278, 0x1, 0x0);
        gbc.writeMem(0xcf67, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xc6);
        EXPECT(gbc.b(),  0x4d);
        EXPECT(gbc.c(),  0x64);
        EXPECT(gbc.d(),  0xb4);
        EXPECT(gbc.e(),  0x3d);
        EXPECT(gbc.h(),  0x12);
        EXPECT(gbc.l(),  0x78);
        EXPECT(gbc.sp(), 0x8c56);
        EXPECT(gbc.pc(), 0xcf68);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcf67), 0x3d);
        // 3D 0201
        gbc.setState(0x8fd3, 0x7e64, 0xa830, 0x28d7, 0xb156, 0x3481, 0x0, 0x1);
        gbc.writeMem(0x8fd3, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa7);
        EXPECT(gbc.b(),  0x28);
        EXPECT(gbc.c(),  0xd7);
        EXPECT(gbc.d(),  0xb1);
        EXPECT(gbc.e(),  0x56);
        EXPECT(gbc.h(),  0x34);
        EXPECT(gbc.l(),  0x81);
        EXPECT(gbc.sp(), 0x7e64);
        EXPECT(gbc.pc(), 0x8fd4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8fd3), 0x3d);
        // 3D 0202
        gbc.setState(0x8676, 0x45da, 0x9d70, 0x806, 0xc7d2, 0xd2bf, 0x1, 0x0);
        gbc.writeMem(0x8676, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x9c);
        EXPECT(gbc.b(),  0x8);
        EXPECT(gbc.c(),  0x6);
        EXPECT(gbc.d(),  0xc7);
        EXPECT(gbc.e(),  0xd2);
        EXPECT(gbc.h(),  0xd2);
        EXPECT(gbc.l(),  0xbf);
        EXPECT(gbc.sp(), 0x45da);
        EXPECT(gbc.pc(), 0x8677);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8676), 0x3d);
        // 3D 0203
        gbc.setState(0xc125, 0x9281, 0x7020, 0x5131, 0x733c, 0x6645, 0x1, 0x0);
        gbc.writeMem(0xc125, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x6f);
        EXPECT(gbc.b(),  0x51);
        EXPECT(gbc.c(),  0x31);
        EXPECT(gbc.d(),  0x73);
        EXPECT(gbc.e(),  0x3c);
        EXPECT(gbc.h(),  0x66);
        EXPECT(gbc.l(),  0x45);
        EXPECT(gbc.sp(), 0x9281);
        EXPECT(gbc.pc(), 0xc126);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc125), 0x3d);
        // 3D 0205
        gbc.setState(0x5dd6, 0x6e09, 0x8930, 0x3c8c, 0xb69c, 0xeee6, 0x0, 0x0);
        gbc.writeMem(0x5dd6, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x88);
        EXPECT(gbc.b(),  0x3c);
        EXPECT(gbc.c(),  0x8c);
        EXPECT(gbc.d(),  0xb6);
        EXPECT(gbc.e(),  0x9c);
        EXPECT(gbc.h(),  0xee);
        EXPECT(gbc.l(),  0xe6);
        EXPECT(gbc.sp(), 0x6e09);
        EXPECT(gbc.pc(), 0x5dd7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0206
        gbc.setState(0xa0a3, 0x8ee, 0xe2a0, 0x1779, 0x11c5, 0xf75, 0x0, 0x0);
        gbc.writeMem(0xa0a3, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xe1);
        EXPECT(gbc.b(),  0x17);
        EXPECT(gbc.c(),  0x79);
        EXPECT(gbc.d(),  0x11);
        EXPECT(gbc.e(),  0xc5);
        EXPECT(gbc.h(),  0xf);
        EXPECT(gbc.l(),  0x75);
        EXPECT(gbc.sp(), 0x8ee);
        EXPECT(gbc.pc(), 0xa0a4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa0a3), 0x3d);
        // 3D 0207
        gbc.setState(0xe3f4, 0xe845, 0x6350, 0x766f, 0x8da, 0x9536, 0x0, 0x1);
        gbc.writeMem(0xe3f4, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x62);
        EXPECT(gbc.b(),  0x76);
        EXPECT(gbc.c(),  0x6f);
        EXPECT(gbc.d(),  0x8);
        EXPECT(gbc.e(),  0xda);
        EXPECT(gbc.h(),  0x95);
        EXPECT(gbc.l(),  0x36);
        EXPECT(gbc.sp(), 0xe845);
        EXPECT(gbc.pc(), 0xe3f5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe3f4), 0x3d);
        // 3D 0208
        gbc.setState(0xca50, 0xb91f, 0x7d10, 0x6e09, 0xe957, 0xdc91, 0x0, 0x0);
        gbc.writeMem(0xca50, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x7c);
        EXPECT(gbc.b(),  0x6e);
        EXPECT(gbc.c(),  0x9);
        EXPECT(gbc.d(),  0xe9);
        EXPECT(gbc.e(),  0x57);
        EXPECT(gbc.h(),  0xdc);
        EXPECT(gbc.l(),  0x91);
        EXPECT(gbc.sp(), 0xb91f);
        EXPECT(gbc.pc(), 0xca51);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xca50), 0x3d);
        // 3D 0209
        gbc.setState(0x4716, 0x166c, 0x6e20, 0x6681, 0xbc6d, 0xc3b7, 0x0, 0x0);
        gbc.writeMem(0x4716, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x6d);
        EXPECT(gbc.b(),  0x66);
        EXPECT(gbc.c(),  0x81);
        EXPECT(gbc.d(),  0xbc);
        EXPECT(gbc.e(),  0x6d);
        EXPECT(gbc.h(),  0xc3);
        EXPECT(gbc.l(),  0xb7);
        EXPECT(gbc.sp(), 0x166c);
        EXPECT(gbc.pc(), 0x4717);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 020A
        gbc.setState(0x5369, 0x27bc, 0x1ea0, 0xf0ec, 0xb2df, 0x4596, 0x1, 0x0);
        gbc.writeMem(0x5369, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x1d);
        EXPECT(gbc.b(),  0xf0);
        EXPECT(gbc.c(),  0xec);
        EXPECT(gbc.d(),  0xb2);
        EXPECT(gbc.e(),  0xdf);
        EXPECT(gbc.h(),  0x45);
        EXPECT(gbc.l(),  0x96);
        EXPECT(gbc.sp(), 0x27bc);
        EXPECT(gbc.pc(), 0x536a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 020B
        gbc.setState(0x7ef3, 0xbd8f, 0x1b70, 0xbf21, 0x42f4, 0x331c, 0x0, 0x1);
        gbc.writeMem(0x7ef3, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x1a);
        EXPECT(gbc.b(),  0xbf);
        EXPECT(gbc.c(),  0x21);
        EXPECT(gbc.d(),  0x42);
        EXPECT(gbc.e(),  0xf4);
        EXPECT(gbc.h(),  0x33);
        EXPECT(gbc.l(),  0x1c);
        EXPECT(gbc.sp(), 0xbd8f);
        EXPECT(gbc.pc(), 0x7ef4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 020C
        gbc.setState(0x27d4, 0xb399, 0xea20, 0xda5a, 0x873, 0x5c54, 0x1, 0x0);
        gbc.writeMem(0x27d4, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xe9);
        EXPECT(gbc.b(),  0xda);
        EXPECT(gbc.c(),  0x5a);
        EXPECT(gbc.d(),  0x8);
        EXPECT(gbc.e(),  0x73);
        EXPECT(gbc.h(),  0x5c);
        EXPECT(gbc.l(),  0x54);
        EXPECT(gbc.sp(), 0xb399);
        EXPECT(gbc.pc(), 0x27d5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 020D
        gbc.setState(0xcbce, 0x7e56, 0xb00, 0x694, 0x4c45, 0xdb41, 0x1, 0x1);
        gbc.writeMem(0xcbce, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa);
        EXPECT(gbc.b(),  0x6);
        EXPECT(gbc.c(),  0x94);
        EXPECT(gbc.d(),  0x4c);
        EXPECT(gbc.e(),  0x45);
        EXPECT(gbc.h(),  0xdb);
        EXPECT(gbc.l(),  0x41);
        EXPECT(gbc.sp(), 0x7e56);
        EXPECT(gbc.pc(), 0xcbcf);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcbce), 0x3d);
        // 3D 020E
        gbc.setState(0x9bba, 0x6ddc, 0xf8f0, 0xd73b, 0x2b17, 0x1fac, 0x1, 0x0);
        gbc.writeMem(0x9bba, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf7);
        EXPECT(gbc.b(),  0xd7);
        EXPECT(gbc.c(),  0x3b);
        EXPECT(gbc.d(),  0x2b);
        EXPECT(gbc.e(),  0x17);
        EXPECT(gbc.h(),  0x1f);
        EXPECT(gbc.l(),  0xac);
        EXPECT(gbc.sp(), 0x6ddc);
        EXPECT(gbc.pc(), 0x9bbb);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9bba), 0x3d);
        // 3D 020F
        gbc.setState(0xb8db, 0x3769, 0xcd20, 0x19b9, 0xc9b4, 0x5a29, 0x0, 0x0);
        gbc.writeMem(0xb8db, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xcc);
        EXPECT(gbc.b(),  0x19);
        EXPECT(gbc.c(),  0xb9);
        EXPECT(gbc.d(),  0xc9);
        EXPECT(gbc.e(),  0xb4);
        EXPECT(gbc.h(),  0x5a);
        EXPECT(gbc.l(),  0x29);
        EXPECT(gbc.sp(), 0x3769);
        EXPECT(gbc.pc(), 0xb8dc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb8db), 0x3d);
        // 3D 0210
        gbc.setState(0x20c4, 0x61a6, 0xceb0, 0x6519, 0x960b, 0xe363, 0x0, 0x1);
        gbc.writeMem(0x20c4, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xcd);
        EXPECT(gbc.b(),  0x65);
        EXPECT(gbc.c(),  0x19);
        EXPECT(gbc.d(),  0x96);
        EXPECT(gbc.e(),  0xb);
        EXPECT(gbc.h(),  0xe3);
        EXPECT(gbc.l(),  0x63);
        EXPECT(gbc.sp(), 0x61a6);
        EXPECT(gbc.pc(), 0x20c5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0211
        gbc.setState(0xad45, 0x7160, 0xc140, 0xfb0f, 0x6ec5, 0xa0b0, 0x1, 0x1);
        gbc.writeMem(0xad45, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xc0);
        EXPECT(gbc.b(),  0xfb);
        EXPECT(gbc.c(),  0xf);
        EXPECT(gbc.d(),  0x6e);
        EXPECT(gbc.e(),  0xc5);
        EXPECT(gbc.h(),  0xa0);
        EXPECT(gbc.l(),  0xb0);
        EXPECT(gbc.sp(), 0x7160);
        EXPECT(gbc.pc(), 0xad46);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xad45), 0x3d);
        // 3D 0212
        gbc.setState(0x30d8, 0xdcbe, 0x9370, 0x3423, 0x708, 0x51b8, 0x0, 0x0);
        gbc.writeMem(0x30d8, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x92);
        EXPECT(gbc.b(),  0x34);
        EXPECT(gbc.c(),  0x23);
        EXPECT(gbc.d(),  0x7);
        EXPECT(gbc.e(),  0x8);
        EXPECT(gbc.h(),  0x51);
        EXPECT(gbc.l(),  0xb8);
        EXPECT(gbc.sp(), 0xdcbe);
        EXPECT(gbc.pc(), 0x30d9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0214
        gbc.setState(0x2a64, 0xac63, 0x3480, 0xce81, 0x2c8d, 0x644f, 0x0, 0x0);
        gbc.writeMem(0x2a64, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x33);
        EXPECT(gbc.b(),  0xce);
        EXPECT(gbc.c(),  0x81);
        EXPECT(gbc.d(),  0x2c);
        EXPECT(gbc.e(),  0x8d);
        EXPECT(gbc.h(),  0x64);
        EXPECT(gbc.l(),  0x4f);
        EXPECT(gbc.sp(), 0xac63);
        EXPECT(gbc.pc(), 0x2a65);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0215
        gbc.setState(0x5aaf, 0xaa18, 0xe3d0, 0xd81d, 0xb391, 0x8f19, 0x0, 0x1);
        gbc.writeMem(0x5aaf, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xe2);
        EXPECT(gbc.b(),  0xd8);
        EXPECT(gbc.c(),  0x1d);
        EXPECT(gbc.d(),  0xb3);
        EXPECT(gbc.e(),  0x91);
        EXPECT(gbc.h(),  0x8f);
        EXPECT(gbc.l(),  0x19);
        EXPECT(gbc.sp(), 0xaa18);
        EXPECT(gbc.pc(), 0x5ab0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0216
        gbc.setState(0x17f2, 0x60d7, 0x9790, 0x5f6f, 0x5d13, 0xd023, 0x1, 0x1);
        gbc.writeMem(0x17f2, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x96);
        EXPECT(gbc.b(),  0x5f);
        EXPECT(gbc.c(),  0x6f);
        EXPECT(gbc.d(),  0x5d);
        EXPECT(gbc.e(),  0x13);
        EXPECT(gbc.h(),  0xd0);
        EXPECT(gbc.l(),  0x23);
        EXPECT(gbc.sp(), 0x60d7);
        EXPECT(gbc.pc(), 0x17f3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0217
        gbc.setState(0xe7c9, 0xe58b, 0x2990, 0x91d8, 0x9f83, 0x784, 0x0, 0x0);
        gbc.writeMem(0xe7c9, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0x91);
        EXPECT(gbc.c(),  0xd8);
        EXPECT(gbc.d(),  0x9f);
        EXPECT(gbc.e(),  0x83);
        EXPECT(gbc.h(),  0x7);
        EXPECT(gbc.l(),  0x84);
        EXPECT(gbc.sp(), 0xe58b);
        EXPECT(gbc.pc(), 0xe7ca);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe7c9), 0x3d);
        // 3D 0218
        gbc.setState(0xca0d, 0x6a8, 0x10a0, 0xdddb, 0x90e7, 0x825c, 0x1, 0x0);
        gbc.writeMem(0xca0d, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf);
        EXPECT(gbc.b(),  0xdd);
        EXPECT(gbc.c(),  0xdb);
        EXPECT(gbc.d(),  0x90);
        EXPECT(gbc.e(),  0xe7);
        EXPECT(gbc.h(),  0x82);
        EXPECT(gbc.l(),  0x5c);
        EXPECT(gbc.sp(), 0x6a8);
        EXPECT(gbc.pc(), 0xca0e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xca0d), 0x3d);
        // 3D 0219
        gbc.setState(0xda6f, 0x3dff, 0x1b60, 0x2d01, 0xaf9b, 0x1c42, 0x1, 0x1);
        gbc.writeMem(0xda6f, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x1a);
        EXPECT(gbc.b(),  0x2d);
        EXPECT(gbc.c(),  0x1);
        EXPECT(gbc.d(),  0xaf);
        EXPECT(gbc.e(),  0x9b);
        EXPECT(gbc.h(),  0x1c);
        EXPECT(gbc.l(),  0x42);
        EXPECT(gbc.sp(), 0x3dff);
        EXPECT(gbc.pc(), 0xda70);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xda6f), 0x3d);
        // 3D 021A
        gbc.setState(0xd7f4, 0xc11d, 0x3e70, 0xb09f, 0x5558, 0x6722, 0x1, 0x0);
        gbc.writeMem(0xd7f4, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x3d);
        EXPECT(gbc.b(),  0xb0);
        EXPECT(gbc.c(),  0x9f);
        EXPECT(gbc.d(),  0x55);
        EXPECT(gbc.e(),  0x58);
        EXPECT(gbc.h(),  0x67);
        EXPECT(gbc.l(),  0x22);
        EXPECT(gbc.sp(), 0xc11d);
        EXPECT(gbc.pc(), 0xd7f5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd7f4), 0x3d);
        // 3D 021B
        gbc.setState(0xbd3a, 0x15bd, 0xb460, 0x3158, 0xd29, 0x3636, 0x1, 0x0);
        gbc.writeMem(0xbd3a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xb3);
        EXPECT(gbc.b(),  0x31);
        EXPECT(gbc.c(),  0x58);
        EXPECT(gbc.d(),  0xd);
        EXPECT(gbc.e(),  0x29);
        EXPECT(gbc.h(),  0x36);
        EXPECT(gbc.l(),  0x36);
        EXPECT(gbc.sp(), 0x15bd);
        EXPECT(gbc.pc(), 0xbd3b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbd3a), 0x3d);
        // 3D 021C
        gbc.setState(0xedfc, 0xe478, 0xb2b0, 0x5d68, 0xc84a, 0x9371, 0x0, 0x1);
        gbc.writeMem(0xedfc, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xb1);
        EXPECT(gbc.b(),  0x5d);
        EXPECT(gbc.c(),  0x68);
        EXPECT(gbc.d(),  0xc8);
        EXPECT(gbc.e(),  0x4a);
        EXPECT(gbc.h(),  0x93);
        EXPECT(gbc.l(),  0x71);
        EXPECT(gbc.sp(), 0xe478);
        EXPECT(gbc.pc(), 0xedfd);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xedfc), 0x3d);
        // 3D 021D
        gbc.setState(0x7b32, 0xff26, 0x9020, 0x75e2, 0xf849, 0x1f0, 0x1, 0x1);
        gbc.writeMem(0x7b32, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x8f);
        EXPECT(gbc.b(),  0x75);
        EXPECT(gbc.c(),  0xe2);
        EXPECT(gbc.d(),  0xf8);
        EXPECT(gbc.e(),  0x49);
        EXPECT(gbc.h(),  0x1);
        EXPECT(gbc.l(),  0xf0);
        EXPECT(gbc.sp(), 0xff26);
        EXPECT(gbc.pc(), 0x7b33);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 3D 021E
        gbc.setState(0xc161, 0x6ba9, 0x27b0, 0xdbbd, 0x8aaa, 0xc1e7, 0x0, 0x0);
        gbc.writeMem(0xc161, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x26);
        EXPECT(gbc.b(),  0xdb);
        EXPECT(gbc.c(),  0xbd);
        EXPECT(gbc.d(),  0x8a);
        EXPECT(gbc.e(),  0xaa);
        EXPECT(gbc.h(),  0xc1);
        EXPECT(gbc.l(),  0xe7);
        EXPECT(gbc.sp(), 0x6ba9);
        EXPECT(gbc.pc(), 0xc162);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc161), 0x3d);
        // 3D 021F
        gbc.setState(0xe2ff, 0x86d8, 0x7fb0, 0xb0c0, 0x933c, 0xc5e1, 0x1, 0x1);
        gbc.writeMem(0xe2ff, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x7e);
        EXPECT(gbc.b(),  0xb0);
        EXPECT(gbc.c(),  0xc0);
        EXPECT(gbc.d(),  0x93);
        EXPECT(gbc.e(),  0x3c);
        EXPECT(gbc.h(),  0xc5);
        EXPECT(gbc.l(),  0xe1);
        EXPECT(gbc.sp(), 0x86d8);
        EXPECT(gbc.pc(), 0xe300);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe2ff), 0x3d);
        // 3D 0220
        gbc.setState(0x41fb, 0x4e39, 0x5f70, 0x1171, 0xa191, 0x2652, 0x1, 0x1);
        gbc.writeMem(0x41fb, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x5e);
        EXPECT(gbc.b(),  0x11);
        EXPECT(gbc.c(),  0x71);
        EXPECT(gbc.d(),  0xa1);
        EXPECT(gbc.e(),  0x91);
        EXPECT(gbc.h(),  0x26);
        EXPECT(gbc.l(),  0x52);
        EXPECT(gbc.sp(), 0x4e39);
        EXPECT(gbc.pc(), 0x41fc);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0221
        gbc.setState(0xb8da, 0x9a99, 0x1af0, 0x3ccc, 0x343c, 0x1121, 0x1, 0x1);
        gbc.writeMem(0xb8da, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x19);
        EXPECT(gbc.b(),  0x3c);
        EXPECT(gbc.c(),  0xcc);
        EXPECT(gbc.d(),  0x34);
        EXPECT(gbc.e(),  0x3c);
        EXPECT(gbc.h(),  0x11);
        EXPECT(gbc.l(),  0x21);
        EXPECT(gbc.sp(), 0x9a99);
        EXPECT(gbc.pc(), 0xb8db);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb8da), 0x3d);
        // 3D 0222
        gbc.setState(0xe9da, 0x482e, 0x6c40, 0xd45a, 0xd337, 0x754d, 0x1, 0x1);
        gbc.writeMem(0xe9da, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x6b);
        EXPECT(gbc.b(),  0xd4);
        EXPECT(gbc.c(),  0x5a);
        EXPECT(gbc.d(),  0xd3);
        EXPECT(gbc.e(),  0x37);
        EXPECT(gbc.h(),  0x75);
        EXPECT(gbc.l(),  0x4d);
        EXPECT(gbc.sp(), 0x482e);
        EXPECT(gbc.pc(), 0xe9db);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe9da), 0x3d);
        // 3D 0223
        gbc.setState(0x892e, 0x7083, 0xd780, 0xc178, 0x91bf, 0x2996, 0x0, 0x0);
        gbc.writeMem(0x892e, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xd6);
        EXPECT(gbc.b(),  0xc1);
        EXPECT(gbc.c(),  0x78);
        EXPECT(gbc.d(),  0x91);
        EXPECT(gbc.e(),  0xbf);
        EXPECT(gbc.h(),  0x29);
        EXPECT(gbc.l(),  0x96);
        EXPECT(gbc.sp(), 0x7083);
        EXPECT(gbc.pc(), 0x892f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x892e), 0x3d);
        // 3D 0224
        gbc.setState(0x8613, 0xf2eb, 0xa9e0, 0xe301, 0x1439, 0xe387, 0x0, 0x0);
        gbc.writeMem(0x8613, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa8);
        EXPECT(gbc.b(),  0xe3);
        EXPECT(gbc.c(),  0x1);
        EXPECT(gbc.d(),  0x14);
        EXPECT(gbc.e(),  0x39);
        EXPECT(gbc.h(),  0xe3);
        EXPECT(gbc.l(),  0x87);
        EXPECT(gbc.sp(), 0xf2eb);
        EXPECT(gbc.pc(), 0x8614);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8613), 0x3d);
        // 3D 0225
        gbc.setState(0xee4f, 0xa07f, 0x36c0, 0xb65b, 0x1764, 0x79b5, 0x0, 0x0);
        gbc.writeMem(0xee4f, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x35);
        EXPECT(gbc.b(),  0xb6);
        EXPECT(gbc.c(),  0x5b);
        EXPECT(gbc.d(),  0x17);
        EXPECT(gbc.e(),  0x64);
        EXPECT(gbc.h(),  0x79);
        EXPECT(gbc.l(),  0xb5);
        EXPECT(gbc.sp(), 0xa07f);
        EXPECT(gbc.pc(), 0xee50);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xee4f), 0x3d);
        // 3D 0226
        gbc.setState(0xe36a, 0x2083, 0x7590, 0x20e9, 0x810f, 0x9da7, 0x1, 0x0);
        gbc.writeMem(0xe36a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x74);
        EXPECT(gbc.b(),  0x20);
        EXPECT(gbc.c(),  0xe9);
        EXPECT(gbc.d(),  0x81);
        EXPECT(gbc.e(),  0xf);
        EXPECT(gbc.h(),  0x9d);
        EXPECT(gbc.l(),  0xa7);
        EXPECT(gbc.sp(), 0x2083);
        EXPECT(gbc.pc(), 0xe36b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe36a), 0x3d);
        // 3D 0227
        gbc.setState(0xc738, 0x7c88, 0xc10, 0x5acd, 0xab7e, 0xb731, 0x0, 0x0);
        gbc.writeMem(0xc738, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xb);
        EXPECT(gbc.b(),  0x5a);
        EXPECT(gbc.c(),  0xcd);
        EXPECT(gbc.d(),  0xab);
        EXPECT(gbc.e(),  0x7e);
        EXPECT(gbc.h(),  0xb7);
        EXPECT(gbc.l(),  0x31);
        EXPECT(gbc.sp(), 0x7c88);
        EXPECT(gbc.pc(), 0xc739);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc738), 0x3d);
        // 3D 0228
        gbc.setState(0xba52, 0xdcbc, 0x3470, 0x67af, 0x9702, 0x415c, 0x0, 0x1);
        gbc.writeMem(0xba52, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x33);
        EXPECT(gbc.b(),  0x67);
        EXPECT(gbc.c(),  0xaf);
        EXPECT(gbc.d(),  0x97);
        EXPECT(gbc.e(),  0x2);
        EXPECT(gbc.h(),  0x41);
        EXPECT(gbc.l(),  0x5c);
        EXPECT(gbc.sp(), 0xdcbc);
        EXPECT(gbc.pc(), 0xba53);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xba52), 0x3d);
        // 3D 0229
        gbc.setState(0x89, 0x91bb, 0xbfd0, 0x99a, 0x7d3a, 0x30a9, 0x1, 0x0);
        gbc.writeMem(0x89, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xbe);
        EXPECT(gbc.b(),  0x9);
        EXPECT(gbc.c(),  0x9a);
        EXPECT(gbc.d(),  0x7d);
        EXPECT(gbc.e(),  0x3a);
        EXPECT(gbc.h(),  0x30);
        EXPECT(gbc.l(),  0xa9);
        EXPECT(gbc.sp(), 0x91bb);
        EXPECT(gbc.pc(), 0x8a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 022A
        gbc.setState(0xc77, 0xa901, 0xdbf0, 0xa0a5, 0xef1f, 0xb8c, 0x1, 0x0);
        gbc.writeMem(0xc77, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xda);
        EXPECT(gbc.b(),  0xa0);
        EXPECT(gbc.c(),  0xa5);
        EXPECT(gbc.d(),  0xef);
        EXPECT(gbc.e(),  0x1f);
        EXPECT(gbc.h(),  0xb);
        EXPECT(gbc.l(),  0x8c);
        EXPECT(gbc.sp(), 0xa901);
        EXPECT(gbc.pc(), 0xc78);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 022B
        gbc.setState(0xbe06, 0x1d73, 0x9600, 0xd657, 0xaf2b, 0xdf9d, 0x0, 0x0);
        gbc.writeMem(0xbe06, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x95);
        EXPECT(gbc.b(),  0xd6);
        EXPECT(gbc.c(),  0x57);
        EXPECT(gbc.d(),  0xaf);
        EXPECT(gbc.e(),  0x2b);
        EXPECT(gbc.h(),  0xdf);
        EXPECT(gbc.l(),  0x9d);
        EXPECT(gbc.sp(), 0x1d73);
        EXPECT(gbc.pc(), 0xbe07);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbe06), 0x3d);
        // 3D 022C
        gbc.setState(0x7913, 0xf143, 0x3940, 0xc3b, 0xe653, 0x4be, 0x1, 0x0);
        gbc.writeMem(0x7913, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x38);
        EXPECT(gbc.b(),  0xc);
        EXPECT(gbc.c(),  0x3b);
        EXPECT(gbc.d(),  0xe6);
        EXPECT(gbc.e(),  0x53);
        EXPECT(gbc.h(),  0x4);
        EXPECT(gbc.l(),  0xbe);
        EXPECT(gbc.sp(), 0xf143);
        EXPECT(gbc.pc(), 0x7914);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 022D
        gbc.setState(0x99d2, 0xc3cf, 0x4070, 0x61e5, 0xd22d, 0xcb1f, 0x0, 0x1);
        gbc.writeMem(0x99d2, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x3f);
        EXPECT(gbc.b(),  0x61);
        EXPECT(gbc.c(),  0xe5);
        EXPECT(gbc.d(),  0xd2);
        EXPECT(gbc.e(),  0x2d);
        EXPECT(gbc.h(),  0xcb);
        EXPECT(gbc.l(),  0x1f);
        EXPECT(gbc.sp(), 0xc3cf);
        EXPECT(gbc.pc(), 0x99d3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x99d2), 0x3d);
        // 3D 022E
        gbc.setState(0x8e38, 0x3ab, 0x98c0, 0xccc1, 0xdad, 0xed85, 0x1, 0x1);
        gbc.writeMem(0x8e38, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x97);
        EXPECT(gbc.b(),  0xcc);
        EXPECT(gbc.c(),  0xc1);
        EXPECT(gbc.d(),  0xd);
        EXPECT(gbc.e(),  0xad);
        EXPECT(gbc.h(),  0xed);
        EXPECT(gbc.l(),  0x85);
        EXPECT(gbc.sp(), 0x3ab);
        EXPECT(gbc.pc(), 0x8e39);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8e38), 0x3d);
        // 3D 022F
        gbc.setState(0x98f7, 0x79b8, 0x57d0, 0xdc6a, 0x486e, 0xf01, 0x1, 0x1);
        gbc.writeMem(0x98f7, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x56);
        EXPECT(gbc.b(),  0xdc);
        EXPECT(gbc.c(),  0x6a);
        EXPECT(gbc.d(),  0x48);
        EXPECT(gbc.e(),  0x6e);
        EXPECT(gbc.h(),  0xf);
        EXPECT(gbc.l(),  0x1);
        EXPECT(gbc.sp(), 0x79b8);
        EXPECT(gbc.pc(), 0x98f8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x98f7), 0x3d);
        // 3D 0230
        gbc.setState(0x8b60, 0x273d, 0x6dd0, 0xde7, 0x9d3d, 0x6c12, 0x0, 0x1);
        gbc.writeMem(0x8b60, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x6c);
        EXPECT(gbc.b(),  0xd);
        EXPECT(gbc.c(),  0xe7);
        EXPECT(gbc.d(),  0x9d);
        EXPECT(gbc.e(),  0x3d);
        EXPECT(gbc.h(),  0x6c);
        EXPECT(gbc.l(),  0x12);
        EXPECT(gbc.sp(), 0x273d);
        EXPECT(gbc.pc(), 0x8b61);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8b60), 0x3d);
        // 3D 0231
        gbc.setState(0x10b6, 0x76f5, 0x7040, 0x473, 0xff1f, 0xd7bf, 0x1, 0x0);
        gbc.writeMem(0x10b6, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x6f);
        EXPECT(gbc.b(),  0x4);
        EXPECT(gbc.c(),  0x73);
        EXPECT(gbc.d(),  0xff);
        EXPECT(gbc.e(),  0x1f);
        EXPECT(gbc.h(),  0xd7);
        EXPECT(gbc.l(),  0xbf);
        EXPECT(gbc.sp(), 0x76f5);
        EXPECT(gbc.pc(), 0x10b7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 3D 0232
        gbc.setState(0x782d, 0x155c, 0x1610, 0xa167, 0x5997, 0x53ac, 0x0, 0x0);
        gbc.writeMem(0x782d, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x15);
        EXPECT(gbc.b(),  0xa1);
        EXPECT(gbc.c(),  0x67);
        EXPECT(gbc.d(),  0x59);
        EXPECT(gbc.e(),  0x97);
        EXPECT(gbc.h(),  0x53);
        EXPECT(gbc.l(),  0xac);
        EXPECT(gbc.sp(), 0x155c);
        EXPECT(gbc.pc(), 0x782e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0233
        gbc.setState(0x688d, 0xaa56, 0xd480, 0xc831, 0xfcfb, 0xc8e1, 0x1, 0x0);
        gbc.writeMem(0x688d, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xd3);
        EXPECT(gbc.b(),  0xc8);
        EXPECT(gbc.c(),  0x31);
        EXPECT(gbc.d(),  0xfc);
        EXPECT(gbc.e(),  0xfb);
        EXPECT(gbc.h(),  0xc8);
        EXPECT(gbc.l(),  0xe1);
        EXPECT(gbc.sp(), 0xaa56);
        EXPECT(gbc.pc(), 0x688e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0234
        gbc.setState(0x3c03, 0xcede, 0x9c60, 0xf8f4, 0xe125, 0x3de, 0x0, 0x0);
        gbc.writeMem(0x3c03, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x9b);
        EXPECT(gbc.b(),  0xf8);
        EXPECT(gbc.c(),  0xf4);
        EXPECT(gbc.d(),  0xe1);
        EXPECT(gbc.e(),  0x25);
        EXPECT(gbc.h(),  0x3);
        EXPECT(gbc.l(),  0xde);
        EXPECT(gbc.sp(), 0xcede);
        EXPECT(gbc.pc(), 0x3c04);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0235
        gbc.setState(0x1e34, 0x7aa0, 0x7ff0, 0x9bdf, 0x73de, 0x2575, 0x0, 0x1);
        gbc.writeMem(0x1e34, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x7e);
        EXPECT(gbc.b(),  0x9b);
        EXPECT(gbc.c(),  0xdf);
        EXPECT(gbc.d(),  0x73);
        EXPECT(gbc.e(),  0xde);
        EXPECT(gbc.h(),  0x25);
        EXPECT(gbc.l(),  0x75);
        EXPECT(gbc.sp(), 0x7aa0);
        EXPECT(gbc.pc(), 0x1e35);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0236
        gbc.setState(0xce24, 0xf919, 0x4780, 0x12c8, 0x395c, 0xc70e, 0x1, 0x1);
        gbc.writeMem(0xce24, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x46);
        EXPECT(gbc.b(),  0x12);
        EXPECT(gbc.c(),  0xc8);
        EXPECT(gbc.d(),  0x39);
        EXPECT(gbc.e(),  0x5c);
        EXPECT(gbc.h(),  0xc7);
        EXPECT(gbc.l(),  0xe);
        EXPECT(gbc.sp(), 0xf919);
        EXPECT(gbc.pc(), 0xce25);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xce24), 0x3d);
        // 3D 0237
        gbc.setState(0xefb7, 0xe0c7, 0xd00, 0xe652, 0x4434, 0x2b84, 0x0, 0x0);
        gbc.writeMem(0xefb7, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xc);
        EXPECT(gbc.b(),  0xe6);
        EXPECT(gbc.c(),  0x52);
        EXPECT(gbc.d(),  0x44);
        EXPECT(gbc.e(),  0x34);
        EXPECT(gbc.h(),  0x2b);
        EXPECT(gbc.l(),  0x84);
        EXPECT(gbc.sp(), 0xe0c7);
        EXPECT(gbc.pc(), 0xefb8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xefb7), 0x3d);
        // 3D 0238
        gbc.setState(0xa018, 0x58e6, 0x6d10, 0x4c48, 0xdb2c, 0xc9bb, 0x0, 0x1);
        gbc.writeMem(0xa018, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x6c);
        EXPECT(gbc.b(),  0x4c);
        EXPECT(gbc.c(),  0x48);
        EXPECT(gbc.d(),  0xdb);
        EXPECT(gbc.e(),  0x2c);
        EXPECT(gbc.h(),  0xc9);
        EXPECT(gbc.l(),  0xbb);
        EXPECT(gbc.sp(), 0x58e6);
        EXPECT(gbc.pc(), 0xa019);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa018), 0x3d);
        // 3D 0239
        gbc.setState(0x1d39, 0xc1c, 0xf790, 0xcc2, 0xb377, 0x6aae, 0x0, 0x1);
        gbc.writeMem(0x1d39, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf6);
        EXPECT(gbc.b(),  0xc);
        EXPECT(gbc.c(),  0xc2);
        EXPECT(gbc.d(),  0xb3);
        EXPECT(gbc.e(),  0x77);
        EXPECT(gbc.h(),  0x6a);
        EXPECT(gbc.l(),  0xae);
        EXPECT(gbc.sp(), 0xc1c);
        EXPECT(gbc.pc(), 0x1d3a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 023A
        gbc.setState(0x88ab, 0xc2a2, 0xe1a0, 0xec8c, 0x5969, 0xcfb2, 0x1, 0x0);
        gbc.writeMem(0x88ab, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xe0);
        EXPECT(gbc.b(),  0xec);
        EXPECT(gbc.c(),  0x8c);
        EXPECT(gbc.d(),  0x59);
        EXPECT(gbc.e(),  0x69);
        EXPECT(gbc.h(),  0xcf);
        EXPECT(gbc.l(),  0xb2);
        EXPECT(gbc.sp(), 0xc2a2);
        EXPECT(gbc.pc(), 0x88ac);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x88ab), 0x3d);
        // 3D 023C
        gbc.setState(0x68b8, 0x9b45, 0xa5b0, 0x5ce8, 0xd6f4, 0x6f83, 0x1, 0x0);
        gbc.writeMem(0x68b8, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa4);
        EXPECT(gbc.b(),  0x5c);
        EXPECT(gbc.c(),  0xe8);
        EXPECT(gbc.d(),  0xd6);
        EXPECT(gbc.e(),  0xf4);
        EXPECT(gbc.h(),  0x6f);
        EXPECT(gbc.l(),  0x83);
        EXPECT(gbc.sp(), 0x9b45);
        EXPECT(gbc.pc(), 0x68b9);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 023D
        gbc.setState(0x521b, 0x98cb, 0xe850, 0x8f90, 0x13ca, 0xc8c3, 0x0, 0x0);
        gbc.writeMem(0x521b, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xe7);
        EXPECT(gbc.b(),  0x8f);
        EXPECT(gbc.c(),  0x90);
        EXPECT(gbc.d(),  0x13);
        EXPECT(gbc.e(),  0xca);
        EXPECT(gbc.h(),  0xc8);
        EXPECT(gbc.l(),  0xc3);
        EXPECT(gbc.sp(), 0x98cb);
        EXPECT(gbc.pc(), 0x521c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 023E
        gbc.setState(0x3066, 0x248c, 0x9540, 0xa206, 0x5c8c, 0x9dc, 0x0, 0x0);
        gbc.writeMem(0x3066, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x94);
        EXPECT(gbc.b(),  0xa2);
        EXPECT(gbc.c(),  0x6);
        EXPECT(gbc.d(),  0x5c);
        EXPECT(gbc.e(),  0x8c);
        EXPECT(gbc.h(),  0x9);
        EXPECT(gbc.l(),  0xdc);
        EXPECT(gbc.sp(), 0x248c);
        EXPECT(gbc.pc(), 0x3067);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 023F
        gbc.setState(0x23bc, 0xae76, 0x70c0, 0x5a9f, 0xf30b, 0x8f13, 0x1, 0x1);
        gbc.writeMem(0x23bc, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x6f);
        EXPECT(gbc.b(),  0x5a);
        EXPECT(gbc.c(),  0x9f);
        EXPECT(gbc.d(),  0xf3);
        EXPECT(gbc.e(),  0xb);
        EXPECT(gbc.h(),  0x8f);
        EXPECT(gbc.l(),  0x13);
        EXPECT(gbc.sp(), 0xae76);
        EXPECT(gbc.pc(), 0x23bd);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 3D 0240
        gbc.setState(0x4cf6, 0xb981, 0x5dc0, 0xf982, 0xbc95, 0x4584, 0x0, 0x0);
        gbc.writeMem(0x4cf6, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x5c);
        EXPECT(gbc.b(),  0xf9);
        EXPECT(gbc.c(),  0x82);
        EXPECT(gbc.d(),  0xbc);
        EXPECT(gbc.e(),  0x95);
        EXPECT(gbc.h(),  0x45);
        EXPECT(gbc.l(),  0x84);
        EXPECT(gbc.sp(), 0xb981);
        EXPECT(gbc.pc(), 0x4cf7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0241
        gbc.setState(0xa219, 0x98a1, 0x2b20, 0x399c, 0x265, 0x4996, 0x0, 0x0);
        gbc.writeMem(0xa219, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x2a);
        EXPECT(gbc.b(),  0x39);
        EXPECT(gbc.c(),  0x9c);
        EXPECT(gbc.d(),  0x2);
        EXPECT(gbc.e(),  0x65);
        EXPECT(gbc.h(),  0x49);
        EXPECT(gbc.l(),  0x96);
        EXPECT(gbc.sp(), 0x98a1);
        EXPECT(gbc.pc(), 0xa21a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa219), 0x3d);
        // 3D 0242
        gbc.setState(0x5cce, 0x11ef, 0xd2a0, 0xeee8, 0x3ba3, 0x474a, 0x1, 0x0);
        gbc.writeMem(0x5cce, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xd1);
        EXPECT(gbc.b(),  0xee);
        EXPECT(gbc.c(),  0xe8);
        EXPECT(gbc.d(),  0x3b);
        EXPECT(gbc.e(),  0xa3);
        EXPECT(gbc.h(),  0x47);
        EXPECT(gbc.l(),  0x4a);
        EXPECT(gbc.sp(), 0x11ef);
        EXPECT(gbc.pc(), 0x5ccf);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0243
        gbc.setState(0x42a4, 0x292f, 0x2ee0, 0xabf, 0x364e, 0xbc3d, 0x0, 0x1);
        gbc.writeMem(0x42a4, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x2d);
        EXPECT(gbc.b(),  0xa);
        EXPECT(gbc.c(),  0xbf);
        EXPECT(gbc.d(),  0x36);
        EXPECT(gbc.e(),  0x4e);
        EXPECT(gbc.h(),  0xbc);
        EXPECT(gbc.l(),  0x3d);
        EXPECT(gbc.sp(), 0x292f);
        EXPECT(gbc.pc(), 0x42a5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0244
        gbc.setState(0x927a, 0x83a, 0x65d0, 0x6d25, 0x4ecc, 0xff80, 0x1, 0x0);
        gbc.writeMem(0x927a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x64);
        EXPECT(gbc.b(),  0x6d);
        EXPECT(gbc.c(),  0x25);
        EXPECT(gbc.d(),  0x4e);
        EXPECT(gbc.e(),  0xcc);
        EXPECT(gbc.h(),  0xff);
        EXPECT(gbc.l(),  0x80);
        EXPECT(gbc.sp(), 0x83a);
        EXPECT(gbc.pc(), 0x927b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x927a), 0x3d);
        // 3D 0245
        gbc.setState(0xc4bf, 0x5383, 0xef50, 0xf243, 0x80b3, 0x36ae, 0x0, 0x1);
        gbc.writeMem(0xc4bf, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xee);
        EXPECT(gbc.b(),  0xf2);
        EXPECT(gbc.c(),  0x43);
        EXPECT(gbc.d(),  0x80);
        EXPECT(gbc.e(),  0xb3);
        EXPECT(gbc.h(),  0x36);
        EXPECT(gbc.l(),  0xae);
        EXPECT(gbc.sp(), 0x5383);
        EXPECT(gbc.pc(), 0xc4c0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc4bf), 0x3d);
        // 3D 0246
        gbc.setState(0xa1db, 0xecc5, 0xce0, 0x9ca8, 0x776, 0xdb9f, 0x1, 0x0);
        gbc.writeMem(0xa1db, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xb);
        EXPECT(gbc.b(),  0x9c);
        EXPECT(gbc.c(),  0xa8);
        EXPECT(gbc.d(),  0x7);
        EXPECT(gbc.e(),  0x76);
        EXPECT(gbc.h(),  0xdb);
        EXPECT(gbc.l(),  0x9f);
        EXPECT(gbc.sp(), 0xecc5);
        EXPECT(gbc.pc(), 0xa1dc);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa1db), 0x3d);
        // 3D 0247
        gbc.setState(0x8034, 0x7d3f, 0x5420, 0xeab, 0x7f78, 0x778, 0x0, 0x0);
        gbc.writeMem(0x8034, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x53);
        EXPECT(gbc.b(),  0xe);
        EXPECT(gbc.c(),  0xab);
        EXPECT(gbc.d(),  0x7f);
        EXPECT(gbc.e(),  0x78);
        EXPECT(gbc.h(),  0x7);
        EXPECT(gbc.l(),  0x78);
        EXPECT(gbc.sp(), 0x7d3f);
        EXPECT(gbc.pc(), 0x8035);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8034), 0x3d);
        // 3D 0248
        gbc.setState(0xfb3, 0x3ba9, 0x63f0, 0x2588, 0xeba5, 0xe6ff, 0x0, 0x0);
        gbc.writeMem(0xfb3, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x62);
        EXPECT(gbc.b(),  0x25);
        EXPECT(gbc.c(),  0x88);
        EXPECT(gbc.d(),  0xeb);
        EXPECT(gbc.e(),  0xa5);
        EXPECT(gbc.h(),  0xe6);
        EXPECT(gbc.l(),  0xff);
        EXPECT(gbc.sp(), 0x3ba9);
        EXPECT(gbc.pc(), 0xfb4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0249
        gbc.setState(0x3a9a, 0xd2a6, 0xbe30, 0xd9f3, 0x4dc8, 0x1af6, 0x0, 0x0);
        gbc.writeMem(0x3a9a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xbd);
        EXPECT(gbc.b(),  0xd9);
        EXPECT(gbc.c(),  0xf3);
        EXPECT(gbc.d(),  0x4d);
        EXPECT(gbc.e(),  0xc8);
        EXPECT(gbc.h(),  0x1a);
        EXPECT(gbc.l(),  0xf6);
        EXPECT(gbc.sp(), 0xd2a6);
        EXPECT(gbc.pc(), 0x3a9b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 024A
        gbc.setState(0x68b0, 0x7c08, 0x6e20, 0x1270, 0x53c0, 0xbfad, 0x0, 0x1);
        gbc.writeMem(0x68b0, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x6d);
        EXPECT(gbc.b(),  0x12);
        EXPECT(gbc.c(),  0x70);
        EXPECT(gbc.d(),  0x53);
        EXPECT(gbc.e(),  0xc0);
        EXPECT(gbc.h(),  0xbf);
        EXPECT(gbc.l(),  0xad);
        EXPECT(gbc.sp(), 0x7c08);
        EXPECT(gbc.pc(), 0x68b1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 024B
        gbc.setState(0xb531, 0xcd02, 0x3960, 0x95c7, 0xf410, 0x959d, 0x1, 0x1);
        gbc.writeMem(0xb531, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x38);
        EXPECT(gbc.b(),  0x95);
        EXPECT(gbc.c(),  0xc7);
        EXPECT(gbc.d(),  0xf4);
        EXPECT(gbc.e(),  0x10);
        EXPECT(gbc.h(),  0x95);
        EXPECT(gbc.l(),  0x9d);
        EXPECT(gbc.sp(), 0xcd02);
        EXPECT(gbc.pc(), 0xb532);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb531), 0x3d);
        // 3D 024C
        gbc.setState(0x1c98, 0xb871, 0xca30, 0xa202, 0x2d7, 0xe46, 0x0, 0x1);
        gbc.writeMem(0x1c98, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xc9);
        EXPECT(gbc.b(),  0xa2);
        EXPECT(gbc.c(),  0x2);
        EXPECT(gbc.d(),  0x2);
        EXPECT(gbc.e(),  0xd7);
        EXPECT(gbc.h(),  0xe);
        EXPECT(gbc.l(),  0x46);
        EXPECT(gbc.sp(), 0xb871);
        EXPECT(gbc.pc(), 0x1c99);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 024D
        gbc.setState(0x38a1, 0xb4d4, 0xccd0, 0xc85a, 0x1a4a, 0x9027, 0x1, 0x0);
        gbc.writeMem(0x38a1, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xcb);
        EXPECT(gbc.b(),  0xc8);
        EXPECT(gbc.c(),  0x5a);
        EXPECT(gbc.d(),  0x1a);
        EXPECT(gbc.e(),  0x4a);
        EXPECT(gbc.h(),  0x90);
        EXPECT(gbc.l(),  0x27);
        EXPECT(gbc.sp(), 0xb4d4);
        EXPECT(gbc.pc(), 0x38a2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 024E
        gbc.setState(0xcdff, 0xa873, 0x5e50, 0xd784, 0xd88c, 0x1847, 0x1, 0x1);
        gbc.writeMem(0xcdff, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x5d);
        EXPECT(gbc.b(),  0xd7);
        EXPECT(gbc.c(),  0x84);
        EXPECT(gbc.d(),  0xd8);
        EXPECT(gbc.e(),  0x8c);
        EXPECT(gbc.h(),  0x18);
        EXPECT(gbc.l(),  0x47);
        EXPECT(gbc.sp(), 0xa873);
        EXPECT(gbc.pc(), 0xce00);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcdff), 0x3d);
        // 3D 024F
        gbc.setState(0xe084, 0xab52, 0xd240, 0xe297, 0x39f2, 0x5635, 0x0, 0x1);
        gbc.writeMem(0xe084, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xd1);
        EXPECT(gbc.b(),  0xe2);
        EXPECT(gbc.c(),  0x97);
        EXPECT(gbc.d(),  0x39);
        EXPECT(gbc.e(),  0xf2);
        EXPECT(gbc.h(),  0x56);
        EXPECT(gbc.l(),  0x35);
        EXPECT(gbc.sp(), 0xab52);
        EXPECT(gbc.pc(), 0xe085);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe084), 0x3d);
        // 3D 0250
        gbc.setState(0x3ee6, 0xf259, 0x44c0, 0xbc4, 0x228f, 0xc546, 0x0, 0x1);
        gbc.writeMem(0x3ee6, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x43);
        EXPECT(gbc.b(),  0xb);
        EXPECT(gbc.c(),  0xc4);
        EXPECT(gbc.d(),  0x22);
        EXPECT(gbc.e(),  0x8f);
        EXPECT(gbc.h(),  0xc5);
        EXPECT(gbc.l(),  0x46);
        EXPECT(gbc.sp(), 0xf259);
        EXPECT(gbc.pc(), 0x3ee7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0251
        gbc.setState(0x24f4, 0x955e, 0x4810, 0x3db4, 0x24a4, 0xeae1, 0x0, 0x0);
        gbc.writeMem(0x24f4, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x47);
        EXPECT(gbc.b(),  0x3d);
        EXPECT(gbc.c(),  0xb4);
        EXPECT(gbc.d(),  0x24);
        EXPECT(gbc.e(),  0xa4);
        EXPECT(gbc.h(),  0xea);
        EXPECT(gbc.l(),  0xe1);
        EXPECT(gbc.sp(), 0x955e);
        EXPECT(gbc.pc(), 0x24f5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0252
        gbc.setState(0x5355, 0xfe2b, 0x6da0, 0x4ba3, 0x8927, 0x391e, 0x0, 0x0);
        gbc.writeMem(0x5355, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x6c);
        EXPECT(gbc.b(),  0x4b);
        EXPECT(gbc.c(),  0xa3);
        EXPECT(gbc.d(),  0x89);
        EXPECT(gbc.e(),  0x27);
        EXPECT(gbc.h(),  0x39);
        EXPECT(gbc.l(),  0x1e);
        EXPECT(gbc.sp(), 0xfe2b);
        EXPECT(gbc.pc(), 0x5356);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0253
        gbc.setState(0x3d99, 0xc83a, 0x73a0, 0xd100, 0xede2, 0xd1d5, 0x1, 0x0);
        gbc.writeMem(0x3d99, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x72);
        EXPECT(gbc.b(),  0xd1);
        EXPECT(gbc.c(),  0x0);
        EXPECT(gbc.d(),  0xed);
        EXPECT(gbc.e(),  0xe2);
        EXPECT(gbc.h(),  0xd1);
        EXPECT(gbc.l(),  0xd5);
        EXPECT(gbc.sp(), 0xc83a);
        EXPECT(gbc.pc(), 0x3d9a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0254
        gbc.setState(0x1522, 0x47e0, 0x3000, 0xf021, 0xede6, 0xe127, 0x1, 0x1);
        gbc.writeMem(0x1522, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x2f);
        EXPECT(gbc.b(),  0xf0);
        EXPECT(gbc.c(),  0x21);
        EXPECT(gbc.d(),  0xed);
        EXPECT(gbc.e(),  0xe6);
        EXPECT(gbc.h(),  0xe1);
        EXPECT(gbc.l(),  0x27);
        EXPECT(gbc.sp(), 0x47e0);
        EXPECT(gbc.pc(), 0x1523);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 3D 0255
        gbc.setState(0xe650, 0xadc1, 0x4490, 0x856d, 0x9eca, 0xe188, 0x0, 0x1);
        gbc.writeMem(0xe650, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x43);
        EXPECT(gbc.b(),  0x85);
        EXPECT(gbc.c(),  0x6d);
        EXPECT(gbc.d(),  0x9e);
        EXPECT(gbc.e(),  0xca);
        EXPECT(gbc.h(),  0xe1);
        EXPECT(gbc.l(),  0x88);
        EXPECT(gbc.sp(), 0xadc1);
        EXPECT(gbc.pc(), 0xe651);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe650), 0x3d);
        // 3D 0256
        gbc.setState(0x594f, 0xe238, 0xc350, 0x95a5, 0xd084, 0xc248, 0x0, 0x1);
        gbc.writeMem(0x594f, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xc2);
        EXPECT(gbc.b(),  0x95);
        EXPECT(gbc.c(),  0xa5);
        EXPECT(gbc.d(),  0xd0);
        EXPECT(gbc.e(),  0x84);
        EXPECT(gbc.h(),  0xc2);
        EXPECT(gbc.l(),  0x48);
        EXPECT(gbc.sp(), 0xe238);
        EXPECT(gbc.pc(), 0x5950);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0257
        gbc.setState(0x2e97, 0x815, 0xa240, 0x289b, 0x2cc2, 0x6320, 0x0, 0x1);
        gbc.writeMem(0x2e97, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa1);
        EXPECT(gbc.b(),  0x28);
        EXPECT(gbc.c(),  0x9b);
        EXPECT(gbc.d(),  0x2c);
        EXPECT(gbc.e(),  0xc2);
        EXPECT(gbc.h(),  0x63);
        EXPECT(gbc.l(),  0x20);
        EXPECT(gbc.sp(), 0x815);
        EXPECT(gbc.pc(), 0x2e98);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0258
        gbc.setState(0xa00c, 0x7f7d, 0x9c50, 0xd51a, 0x790e, 0xc038, 0x1, 0x1);
        gbc.writeMem(0xa00c, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x9b);
        EXPECT(gbc.b(),  0xd5);
        EXPECT(gbc.c(),  0x1a);
        EXPECT(gbc.d(),  0x79);
        EXPECT(gbc.e(),  0xe);
        EXPECT(gbc.h(),  0xc0);
        EXPECT(gbc.l(),  0x38);
        EXPECT(gbc.sp(), 0x7f7d);
        EXPECT(gbc.pc(), 0xa00d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa00c), 0x3d);
        // 3D 0259
        gbc.setState(0x8474, 0xa158, 0x6a50, 0x9704, 0xb917, 0xa57f, 0x1, 0x1);
        gbc.writeMem(0x8474, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x69);
        EXPECT(gbc.b(),  0x97);
        EXPECT(gbc.c(),  0x4);
        EXPECT(gbc.d(),  0xb9);
        EXPECT(gbc.e(),  0x17);
        EXPECT(gbc.h(),  0xa5);
        EXPECT(gbc.l(),  0x7f);
        EXPECT(gbc.sp(), 0xa158);
        EXPECT(gbc.pc(), 0x8475);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8474), 0x3d);
        // 3D 025A
        gbc.setState(0x7f65, 0x2b45, 0xdb70, 0x817f, 0x4bd2, 0xa33b, 0x0, 0x0);
        gbc.writeMem(0x7f65, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xda);
        EXPECT(gbc.b(),  0x81);
        EXPECT(gbc.c(),  0x7f);
        EXPECT(gbc.d(),  0x4b);
        EXPECT(gbc.e(),  0xd2);
        EXPECT(gbc.h(),  0xa3);
        EXPECT(gbc.l(),  0x3b);
        EXPECT(gbc.sp(), 0x2b45);
        EXPECT(gbc.pc(), 0x7f66);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 025B
        gbc.setState(0x1945, 0xcf8f, 0x7a10, 0x48c2, 0x5b0, 0xbfcf, 0x1, 0x0);
        gbc.writeMem(0x1945, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x79);
        EXPECT(gbc.b(),  0x48);
        EXPECT(gbc.c(),  0xc2);
        EXPECT(gbc.d(),  0x5);
        EXPECT(gbc.e(),  0xb0);
        EXPECT(gbc.h(),  0xbf);
        EXPECT(gbc.l(),  0xcf);
        EXPECT(gbc.sp(), 0xcf8f);
        EXPECT(gbc.pc(), 0x1946);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 025D
        gbc.setState(0x881f, 0x434c, 0xaf40, 0x42a5, 0x7d0e, 0x3acb, 0x0, 0x0);
        gbc.writeMem(0x881f, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xae);
        EXPECT(gbc.b(),  0x42);
        EXPECT(gbc.c(),  0xa5);
        EXPECT(gbc.d(),  0x7d);
        EXPECT(gbc.e(),  0xe);
        EXPECT(gbc.h(),  0x3a);
        EXPECT(gbc.l(),  0xcb);
        EXPECT(gbc.sp(), 0x434c);
        EXPECT(gbc.pc(), 0x8820);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x881f), 0x3d);
        // 3D 025E
        gbc.setState(0xb23d, 0xc643, 0x5d10, 0x498f, 0x9279, 0x1a4c, 0x1, 0x0);
        gbc.writeMem(0xb23d, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x5c);
        EXPECT(gbc.b(),  0x49);
        EXPECT(gbc.c(),  0x8f);
        EXPECT(gbc.d(),  0x92);
        EXPECT(gbc.e(),  0x79);
        EXPECT(gbc.h(),  0x1a);
        EXPECT(gbc.l(),  0x4c);
        EXPECT(gbc.sp(), 0xc643);
        EXPECT(gbc.pc(), 0xb23e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb23d), 0x3d);
        // 3D 025F
        gbc.setState(0x8e48, 0xc370, 0xc3d0, 0x347f, 0x7783, 0x5f9e, 0x1, 0x1);
        gbc.writeMem(0x8e48, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xc2);
        EXPECT(gbc.b(),  0x34);
        EXPECT(gbc.c(),  0x7f);
        EXPECT(gbc.d(),  0x77);
        EXPECT(gbc.e(),  0x83);
        EXPECT(gbc.h(),  0x5f);
        EXPECT(gbc.l(),  0x9e);
        EXPECT(gbc.sp(), 0xc370);
        EXPECT(gbc.pc(), 0x8e49);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8e48), 0x3d);
        // 3D 0261
        gbc.setState(0xcc2e, 0xe26c, 0xcec0, 0x2677, 0xb41c, 0x13c3, 0x0, 0x1);
        gbc.writeMem(0xcc2e, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xcd);
        EXPECT(gbc.b(),  0x26);
        EXPECT(gbc.c(),  0x77);
        EXPECT(gbc.d(),  0xb4);
        EXPECT(gbc.e(),  0x1c);
        EXPECT(gbc.h(),  0x13);
        EXPECT(gbc.l(),  0xc3);
        EXPECT(gbc.sp(), 0xe26c);
        EXPECT(gbc.pc(), 0xcc2f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcc2e), 0x3d);
        // 3D 0262
        gbc.setState(0x42c6, 0x7da2, 0x6f00, 0x4916, 0x113b, 0xad68, 0x1, 0x0);
        gbc.writeMem(0x42c6, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x6e);
        EXPECT(gbc.b(),  0x49);
        EXPECT(gbc.c(),  0x16);
        EXPECT(gbc.d(),  0x11);
        EXPECT(gbc.e(),  0x3b);
        EXPECT(gbc.h(),  0xad);
        EXPECT(gbc.l(),  0x68);
        EXPECT(gbc.sp(), 0x7da2);
        EXPECT(gbc.pc(), 0x42c7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0263
        gbc.setState(0xb65, 0x2938, 0xb1f0, 0x5cdd, 0xb7f0, 0x75ce, 0x0, 0x1);
        gbc.writeMem(0xb65, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xb0);
        EXPECT(gbc.b(),  0x5c);
        EXPECT(gbc.c(),  0xdd);
        EXPECT(gbc.d(),  0xb7);
        EXPECT(gbc.e(),  0xf0);
        EXPECT(gbc.h(),  0x75);
        EXPECT(gbc.l(),  0xce);
        EXPECT(gbc.sp(), 0x2938);
        EXPECT(gbc.pc(), 0xb66);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0264
        gbc.setState(0x9dc0, 0x74af, 0x4af0, 0x9754, 0xc76d, 0x686e, 0x0, 0x0);
        gbc.writeMem(0x9dc0, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x49);
        EXPECT(gbc.b(),  0x97);
        EXPECT(gbc.c(),  0x54);
        EXPECT(gbc.d(),  0xc7);
        EXPECT(gbc.e(),  0x6d);
        EXPECT(gbc.h(),  0x68);
        EXPECT(gbc.l(),  0x6e);
        EXPECT(gbc.sp(), 0x74af);
        EXPECT(gbc.pc(), 0x9dc1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9dc0), 0x3d);
        // 3D 0265
        gbc.setState(0xbe71, 0x2e1e, 0x1470, 0x8725, 0x24d3, 0x50ef, 0x1, 0x0);
        gbc.writeMem(0xbe71, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x13);
        EXPECT(gbc.b(),  0x87);
        EXPECT(gbc.c(),  0x25);
        EXPECT(gbc.d(),  0x24);
        EXPECT(gbc.e(),  0xd3);
        EXPECT(gbc.h(),  0x50);
        EXPECT(gbc.l(),  0xef);
        EXPECT(gbc.sp(), 0x2e1e);
        EXPECT(gbc.pc(), 0xbe72);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbe71), 0x3d);
        // 3D 0266
        gbc.setState(0x87ab, 0xf92c, 0x8bc0, 0x45f1, 0x9518, 0x3a5a, 0x1, 0x1);
        gbc.writeMem(0x87ab, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x8a);
        EXPECT(gbc.b(),  0x45);
        EXPECT(gbc.c(),  0xf1);
        EXPECT(gbc.d(),  0x95);
        EXPECT(gbc.e(),  0x18);
        EXPECT(gbc.h(),  0x3a);
        EXPECT(gbc.l(),  0x5a);
        EXPECT(gbc.sp(), 0xf92c);
        EXPECT(gbc.pc(), 0x87ac);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x87ab), 0x3d);
        // 3D 0268
        gbc.setState(0x91aa, 0xdced, 0x4d10, 0xf406, 0xbb60, 0xd00e, 0x1, 0x0);
        gbc.writeMem(0x91aa, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x4c);
        EXPECT(gbc.b(),  0xf4);
        EXPECT(gbc.c(),  0x6);
        EXPECT(gbc.d(),  0xbb);
        EXPECT(gbc.e(),  0x60);
        EXPECT(gbc.h(),  0xd0);
        EXPECT(gbc.l(),  0xe);
        EXPECT(gbc.sp(), 0xdced);
        EXPECT(gbc.pc(), 0x91ab);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x91aa), 0x3d);
        // 3D 0269
        gbc.setState(0x5177, 0x3b3f, 0xfc20, 0xc358, 0xe18a, 0xd72, 0x0, 0x0);
        gbc.writeMem(0x5177, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xfb);
        EXPECT(gbc.b(),  0xc3);
        EXPECT(gbc.c(),  0x58);
        EXPECT(gbc.d(),  0xe1);
        EXPECT(gbc.e(),  0x8a);
        EXPECT(gbc.h(),  0xd);
        EXPECT(gbc.l(),  0x72);
        EXPECT(gbc.sp(), 0x3b3f);
        EXPECT(gbc.pc(), 0x5178);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 026A
        gbc.setState(0x546c, 0x48d, 0x7c10, 0xdd57, 0xf01a, 0x8cb2, 0x1, 0x1);
        gbc.writeMem(0x546c, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x7b);
        EXPECT(gbc.b(),  0xdd);
        EXPECT(gbc.c(),  0x57);
        EXPECT(gbc.d(),  0xf0);
        EXPECT(gbc.e(),  0x1a);
        EXPECT(gbc.h(),  0x8c);
        EXPECT(gbc.l(),  0xb2);
        EXPECT(gbc.sp(), 0x48d);
        EXPECT(gbc.pc(), 0x546d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 026B
        gbc.setState(0x4be3, 0x2dff, 0xa9e0, 0xdf72, 0x87a, 0xaf52, 0x1, 0x0);
        gbc.writeMem(0x4be3, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa8);
        EXPECT(gbc.b(),  0xdf);
        EXPECT(gbc.c(),  0x72);
        EXPECT(gbc.d(),  0x8);
        EXPECT(gbc.e(),  0x7a);
        EXPECT(gbc.h(),  0xaf);
        EXPECT(gbc.l(),  0x52);
        EXPECT(gbc.sp(), 0x2dff);
        EXPECT(gbc.pc(), 0x4be4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 026C
        gbc.setState(0xaa1d, 0x955b, 0x7380, 0xb65d, 0xb325, 0xb78, 0x0, 0x1);
        gbc.writeMem(0xaa1d, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x72);
        EXPECT(gbc.b(),  0xb6);
        EXPECT(gbc.c(),  0x5d);
        EXPECT(gbc.d(),  0xb3);
        EXPECT(gbc.e(),  0x25);
        EXPECT(gbc.h(),  0xb);
        EXPECT(gbc.l(),  0x78);
        EXPECT(gbc.sp(), 0x955b);
        EXPECT(gbc.pc(), 0xaa1e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xaa1d), 0x3d);
        // 3D 026D
        gbc.setState(0xee5c, 0xed6d, 0xd170, 0x9d97, 0x110e, 0xabd9, 0x1, 0x0);
        gbc.writeMem(0xee5c, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xd0);
        EXPECT(gbc.b(),  0x9d);
        EXPECT(gbc.c(),  0x97);
        EXPECT(gbc.d(),  0x11);
        EXPECT(gbc.e(),  0xe);
        EXPECT(gbc.h(),  0xab);
        EXPECT(gbc.l(),  0xd9);
        EXPECT(gbc.sp(), 0xed6d);
        EXPECT(gbc.pc(), 0xee5d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xee5c), 0x3d);
        // 3D 026E
        gbc.setState(0x1716, 0x6ef3, 0xa3d0, 0x5ca0, 0xb48d, 0x740d, 0x0, 0x0);
        gbc.writeMem(0x1716, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa2);
        EXPECT(gbc.b(),  0x5c);
        EXPECT(gbc.c(),  0xa0);
        EXPECT(gbc.d(),  0xb4);
        EXPECT(gbc.e(),  0x8d);
        EXPECT(gbc.h(),  0x74);
        EXPECT(gbc.l(),  0xd);
        EXPECT(gbc.sp(), 0x6ef3);
        EXPECT(gbc.pc(), 0x1717);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 026F
        gbc.setState(0x6ee5, 0x272f, 0xa110, 0x2e02, 0x3b98, 0x258c, 0x1, 0x1);
        gbc.writeMem(0x6ee5, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa0);
        EXPECT(gbc.b(),  0x2e);
        EXPECT(gbc.c(),  0x2);
        EXPECT(gbc.d(),  0x3b);
        EXPECT(gbc.e(),  0x98);
        EXPECT(gbc.h(),  0x25);
        EXPECT(gbc.l(),  0x8c);
        EXPECT(gbc.sp(), 0x272f);
        EXPECT(gbc.pc(), 0x6ee6);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0271
        gbc.setState(0xdd10, 0xb225, 0x31c0, 0xb7ce, 0x5235, 0xaf9b, 0x0, 0x1);
        gbc.writeMem(0xdd10, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x30);
        EXPECT(gbc.b(),  0xb7);
        EXPECT(gbc.c(),  0xce);
        EXPECT(gbc.d(),  0x52);
        EXPECT(gbc.e(),  0x35);
        EXPECT(gbc.h(),  0xaf);
        EXPECT(gbc.l(),  0x9b);
        EXPECT(gbc.sp(), 0xb225);
        EXPECT(gbc.pc(), 0xdd11);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdd10), 0x3d);
        // 3D 0272
        gbc.setState(0xbd11, 0xc70e, 0x8960, 0x9bbc, 0xcbdd, 0xbb06, 0x1, 0x1);
        gbc.writeMem(0xbd11, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x88);
        EXPECT(gbc.b(),  0x9b);
        EXPECT(gbc.c(),  0xbc);
        EXPECT(gbc.d(),  0xcb);
        EXPECT(gbc.e(),  0xdd);
        EXPECT(gbc.h(),  0xbb);
        EXPECT(gbc.l(),  0x6);
        EXPECT(gbc.sp(), 0xc70e);
        EXPECT(gbc.pc(), 0xbd12);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbd11), 0x3d);
        // 3D 0273
        gbc.setState(0x43d0, 0xd0a4, 0xbe70, 0xe4fd, 0xfd34, 0xdd01, 0x1, 0x1);
        gbc.writeMem(0x43d0, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xbd);
        EXPECT(gbc.b(),  0xe4);
        EXPECT(gbc.c(),  0xfd);
        EXPECT(gbc.d(),  0xfd);
        EXPECT(gbc.e(),  0x34);
        EXPECT(gbc.h(),  0xdd);
        EXPECT(gbc.l(),  0x1);
        EXPECT(gbc.sp(), 0xd0a4);
        EXPECT(gbc.pc(), 0x43d1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0274
        gbc.setState(0x1a7c, 0x267d, 0xbb00, 0x82fc, 0x2abb, 0x4ffc, 0x1, 0x1);
        gbc.writeMem(0x1a7c, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xba);
        EXPECT(gbc.b(),  0x82);
        EXPECT(gbc.c(),  0xfc);
        EXPECT(gbc.d(),  0x2a);
        EXPECT(gbc.e(),  0xbb);
        EXPECT(gbc.h(),  0x4f);
        EXPECT(gbc.l(),  0xfc);
        EXPECT(gbc.sp(), 0x267d);
        EXPECT(gbc.pc(), 0x1a7d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0275
        gbc.setState(0x1738, 0x4e1c, 0x6e00, 0xd44a, 0xff82, 0x6085, 0x1, 0x0);
        gbc.writeMem(0x1738, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x6d);
        EXPECT(gbc.b(),  0xd4);
        EXPECT(gbc.c(),  0x4a);
        EXPECT(gbc.d(),  0xff);
        EXPECT(gbc.e(),  0x82);
        EXPECT(gbc.h(),  0x60);
        EXPECT(gbc.l(),  0x85);
        EXPECT(gbc.sp(), 0x4e1c);
        EXPECT(gbc.pc(), 0x1739);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0276
        gbc.setState(0xcd3f, 0xf43b, 0xb4b0, 0x3c84, 0xd51e, 0x5ada, 0x1, 0x0);
        gbc.writeMem(0xcd3f, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xb3);
        EXPECT(gbc.b(),  0x3c);
        EXPECT(gbc.c(),  0x84);
        EXPECT(gbc.d(),  0xd5);
        EXPECT(gbc.e(),  0x1e);
        EXPECT(gbc.h(),  0x5a);
        EXPECT(gbc.l(),  0xda);
        EXPECT(gbc.sp(), 0xf43b);
        EXPECT(gbc.pc(), 0xcd40);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcd3f), 0x3d);
        // 3D 0277
        gbc.setState(0x3cbd, 0xad0d, 0xd6c0, 0xb5bf, 0xbffc, 0x15ea, 0x1, 0x1);
        gbc.writeMem(0x3cbd, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xd5);
        EXPECT(gbc.b(),  0xb5);
        EXPECT(gbc.c(),  0xbf);
        EXPECT(gbc.d(),  0xbf);
        EXPECT(gbc.e(),  0xfc);
        EXPECT(gbc.h(),  0x15);
        EXPECT(gbc.l(),  0xea);
        EXPECT(gbc.sp(), 0xad0d);
        EXPECT(gbc.pc(), 0x3cbe);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0278
        gbc.setState(0xbd44, 0x11dd, 0x2790, 0x867d, 0x71b4, 0x876f, 0x1, 0x0);
        gbc.writeMem(0xbd44, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x26);
        EXPECT(gbc.b(),  0x86);
        EXPECT(gbc.c(),  0x7d);
        EXPECT(gbc.d(),  0x71);
        EXPECT(gbc.e(),  0xb4);
        EXPECT(gbc.h(),  0x87);
        EXPECT(gbc.l(),  0x6f);
        EXPECT(gbc.sp(), 0x11dd);
        EXPECT(gbc.pc(), 0xbd45);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbd44), 0x3d);
        // 3D 0279
        gbc.setState(0x80a7, 0x6ebe, 0xc0f0, 0x9323, 0xe62e, 0xe38e, 0x1, 0x1);
        gbc.writeMem(0x80a7, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xbf);
        EXPECT(gbc.b(),  0x93);
        EXPECT(gbc.c(),  0x23);
        EXPECT(gbc.d(),  0xe6);
        EXPECT(gbc.e(),  0x2e);
        EXPECT(gbc.h(),  0xe3);
        EXPECT(gbc.l(),  0x8e);
        EXPECT(gbc.sp(), 0x6ebe);
        EXPECT(gbc.pc(), 0x80a8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x80a7), 0x3d);
        // 3D 027A
        gbc.setState(0x744d, 0x8dbd, 0x4520, 0x5c8d, 0x2595, 0x85fb, 0x1, 0x0);
        gbc.writeMem(0x744d, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x44);
        EXPECT(gbc.b(),  0x5c);
        EXPECT(gbc.c(),  0x8d);
        EXPECT(gbc.d(),  0x25);
        EXPECT(gbc.e(),  0x95);
        EXPECT(gbc.h(),  0x85);
        EXPECT(gbc.l(),  0xfb);
        EXPECT(gbc.sp(), 0x8dbd);
        EXPECT(gbc.pc(), 0x744e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 027B
        gbc.setState(0xe251, 0x1c39, 0xb1a0, 0x2fa, 0x7e08, 0x5900, 0x0, 0x0);
        gbc.writeMem(0xe251, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xb0);
        EXPECT(gbc.b(),  0x2);
        EXPECT(gbc.c(),  0xfa);
        EXPECT(gbc.d(),  0x7e);
        EXPECT(gbc.e(),  0x8);
        EXPECT(gbc.h(),  0x59);
        EXPECT(gbc.l(),  0x0);
        EXPECT(gbc.sp(), 0x1c39);
        EXPECT(gbc.pc(), 0xe252);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe251), 0x3d);
        // 3D 027C
        gbc.setState(0xc4b3, 0xf7cc, 0x81c0, 0x3fbc, 0xc9c7, 0xe1ae, 0x0, 0x1);
        gbc.writeMem(0xc4b3, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0x3f);
        EXPECT(gbc.c(),  0xbc);
        EXPECT(gbc.d(),  0xc9);
        EXPECT(gbc.e(),  0xc7);
        EXPECT(gbc.h(),  0xe1);
        EXPECT(gbc.l(),  0xae);
        EXPECT(gbc.sp(), 0xf7cc);
        EXPECT(gbc.pc(), 0xc4b4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc4b3), 0x3d);
        // 3D 027D
        gbc.setState(0x8867, 0xaa89, 0xd660, 0xc098, 0x2e2b, 0x7259, 0x1, 0x0);
        gbc.writeMem(0x8867, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xd5);
        EXPECT(gbc.b(),  0xc0);
        EXPECT(gbc.c(),  0x98);
        EXPECT(gbc.d(),  0x2e);
        EXPECT(gbc.e(),  0x2b);
        EXPECT(gbc.h(),  0x72);
        EXPECT(gbc.l(),  0x59);
        EXPECT(gbc.sp(), 0xaa89);
        EXPECT(gbc.pc(), 0x8868);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8867), 0x3d);
        // 3D 027E
        gbc.setState(0x1648, 0xc0a0, 0x6fc0, 0x61a7, 0xc17e, 0xed6b, 0x0, 0x0);
        gbc.writeMem(0x1648, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x6e);
        EXPECT(gbc.b(),  0x61);
        EXPECT(gbc.c(),  0xa7);
        EXPECT(gbc.d(),  0xc1);
        EXPECT(gbc.e(),  0x7e);
        EXPECT(gbc.h(),  0xed);
        EXPECT(gbc.l(),  0x6b);
        EXPECT(gbc.sp(), 0xc0a0);
        EXPECT(gbc.pc(), 0x1649);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 027F
        gbc.setState(0xa527, 0x366f, 0x6d10, 0x7472, 0xb5fa, 0x997b, 0x0, 0x1);
        gbc.writeMem(0xa527, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x6c);
        EXPECT(gbc.b(),  0x74);
        EXPECT(gbc.c(),  0x72);
        EXPECT(gbc.d(),  0xb5);
        EXPECT(gbc.e(),  0xfa);
        EXPECT(gbc.h(),  0x99);
        EXPECT(gbc.l(),  0x7b);
        EXPECT(gbc.sp(), 0x366f);
        EXPECT(gbc.pc(), 0xa528);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa527), 0x3d);
        // 3D 0280
        gbc.setState(0xc8b2, 0x9a6b, 0x7e70, 0xb10b, 0x13ae, 0x5ee1, 0x0, 0x1);
        gbc.writeMem(0xc8b2, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x7d);
        EXPECT(gbc.b(),  0xb1);
        EXPECT(gbc.c(),  0xb);
        EXPECT(gbc.d(),  0x13);
        EXPECT(gbc.e(),  0xae);
        EXPECT(gbc.h(),  0x5e);
        EXPECT(gbc.l(),  0xe1);
        EXPECT(gbc.sp(), 0x9a6b);
        EXPECT(gbc.pc(), 0xc8b3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc8b2), 0x3d);
        // 3D 0281
        gbc.setState(0x5971, 0x23f7, 0xcea0, 0x56e1, 0x7f8e, 0xa07d, 0x0, 0x0);
        gbc.writeMem(0x5971, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xcd);
        EXPECT(gbc.b(),  0x56);
        EXPECT(gbc.c(),  0xe1);
        EXPECT(gbc.d(),  0x7f);
        EXPECT(gbc.e(),  0x8e);
        EXPECT(gbc.h(),  0xa0);
        EXPECT(gbc.l(),  0x7d);
        EXPECT(gbc.sp(), 0x23f7);
        EXPECT(gbc.pc(), 0x5972);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0282
        gbc.setState(0x4ddb, 0xcbc8, 0x2f30, 0xd0de, 0xdf3, 0x4404, 0x0, 0x1);
        gbc.writeMem(0x4ddb, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x2e);
        EXPECT(gbc.b(),  0xd0);
        EXPECT(gbc.c(),  0xde);
        EXPECT(gbc.d(),  0xd);
        EXPECT(gbc.e(),  0xf3);
        EXPECT(gbc.h(),  0x44);
        EXPECT(gbc.l(),  0x4);
        EXPECT(gbc.sp(), 0xcbc8);
        EXPECT(gbc.pc(), 0x4ddc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0283
        gbc.setState(0x9497, 0x8522, 0xcd00, 0xf309, 0xe05c, 0x8c73, 0x0, 0x1);
        gbc.writeMem(0x9497, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xcc);
        EXPECT(gbc.b(),  0xf3);
        EXPECT(gbc.c(),  0x9);
        EXPECT(gbc.d(),  0xe0);
        EXPECT(gbc.e(),  0x5c);
        EXPECT(gbc.h(),  0x8c);
        EXPECT(gbc.l(),  0x73);
        EXPECT(gbc.sp(), 0x8522);
        EXPECT(gbc.pc(), 0x9498);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9497), 0x3d);
        // 3D 0284
        gbc.setState(0x8e4c, 0x7e35, 0x7470, 0xc6bb, 0x1a8c, 0x1177, 0x0, 0x0);
        gbc.writeMem(0x8e4c, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x73);
        EXPECT(gbc.b(),  0xc6);
        EXPECT(gbc.c(),  0xbb);
        EXPECT(gbc.d(),  0x1a);
        EXPECT(gbc.e(),  0x8c);
        EXPECT(gbc.h(),  0x11);
        EXPECT(gbc.l(),  0x77);
        EXPECT(gbc.sp(), 0x7e35);
        EXPECT(gbc.pc(), 0x8e4d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8e4c), 0x3d);
        // 3D 0285
        gbc.setState(0x8a06, 0x822b, 0x80c0, 0x9767, 0x9cac, 0xc0f4, 0x1, 0x1);
        gbc.writeMem(0x8a06, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x7f);
        EXPECT(gbc.b(),  0x97);
        EXPECT(gbc.c(),  0x67);
        EXPECT(gbc.d(),  0x9c);
        EXPECT(gbc.e(),  0xac);
        EXPECT(gbc.h(),  0xc0);
        EXPECT(gbc.l(),  0xf4);
        EXPECT(gbc.sp(), 0x822b);
        EXPECT(gbc.pc(), 0x8a07);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8a06), 0x3d);
        // 3D 0286
        gbc.setState(0x58f0, 0xa1df, 0x81f0, 0x53cf, 0x9af2, 0x872a, 0x1, 0x1);
        gbc.writeMem(0x58f0, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0x53);
        EXPECT(gbc.c(),  0xcf);
        EXPECT(gbc.d(),  0x9a);
        EXPECT(gbc.e(),  0xf2);
        EXPECT(gbc.h(),  0x87);
        EXPECT(gbc.l(),  0x2a);
        EXPECT(gbc.sp(), 0xa1df);
        EXPECT(gbc.pc(), 0x58f1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0287
        gbc.setState(0xe3b9, 0x8286, 0x7980, 0x7c3e, 0x53f3, 0xebb3, 0x0, 0x0);
        gbc.writeMem(0xe3b9, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x78);
        EXPECT(gbc.b(),  0x7c);
        EXPECT(gbc.c(),  0x3e);
        EXPECT(gbc.d(),  0x53);
        EXPECT(gbc.e(),  0xf3);
        EXPECT(gbc.h(),  0xeb);
        EXPECT(gbc.l(),  0xb3);
        EXPECT(gbc.sp(), 0x8286);
        EXPECT(gbc.pc(), 0xe3ba);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe3b9), 0x3d);
        // 3D 0288
        gbc.setState(0x2368, 0x238d, 0x38b0, 0xecd7, 0x484, 0x3b95, 0x0, 0x1);
        gbc.writeMem(0x2368, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x37);
        EXPECT(gbc.b(),  0xec);
        EXPECT(gbc.c(),  0xd7);
        EXPECT(gbc.d(),  0x4);
        EXPECT(gbc.e(),  0x84);
        EXPECT(gbc.h(),  0x3b);
        EXPECT(gbc.l(),  0x95);
        EXPECT(gbc.sp(), 0x238d);
        EXPECT(gbc.pc(), 0x2369);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0289
        gbc.setState(0x402c, 0xef7, 0xc90, 0x56d, 0x23a0, 0x671d, 0x1, 0x1);
        gbc.writeMem(0x402c, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xb);
        EXPECT(gbc.b(),  0x5);
        EXPECT(gbc.c(),  0x6d);
        EXPECT(gbc.d(),  0x23);
        EXPECT(gbc.e(),  0xa0);
        EXPECT(gbc.h(),  0x67);
        EXPECT(gbc.l(),  0x1d);
        EXPECT(gbc.sp(), 0xef7);
        EXPECT(gbc.pc(), 0x402d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 028A
        gbc.setState(0x7e68, 0x1fd, 0xecb0, 0x9496, 0xc723, 0x6440, 0x0, 0x0);
        gbc.writeMem(0x7e68, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xeb);
        EXPECT(gbc.b(),  0x94);
        EXPECT(gbc.c(),  0x96);
        EXPECT(gbc.d(),  0xc7);
        EXPECT(gbc.e(),  0x23);
        EXPECT(gbc.h(),  0x64);
        EXPECT(gbc.l(),  0x40);
        EXPECT(gbc.sp(), 0x1fd);
        EXPECT(gbc.pc(), 0x7e69);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 028B
        gbc.setState(0xb940, 0x8195, 0xd1a0, 0x9c6, 0xf96d, 0x34bc, 0x1, 0x1);
        gbc.writeMem(0xb940, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xd0);
        EXPECT(gbc.b(),  0x9);
        EXPECT(gbc.c(),  0xc6);
        EXPECT(gbc.d(),  0xf9);
        EXPECT(gbc.e(),  0x6d);
        EXPECT(gbc.h(),  0x34);
        EXPECT(gbc.l(),  0xbc);
        EXPECT(gbc.sp(), 0x8195);
        EXPECT(gbc.pc(), 0xb941);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb940), 0x3d);
        // 3D 028C
        gbc.setState(0xce4e, 0x8ca7, 0x3070, 0x6e53, 0xbbcb, 0x3dc5, 0x1, 0x1);
        gbc.writeMem(0xce4e, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x2f);
        EXPECT(gbc.b(),  0x6e);
        EXPECT(gbc.c(),  0x53);
        EXPECT(gbc.d(),  0xbb);
        EXPECT(gbc.e(),  0xcb);
        EXPECT(gbc.h(),  0x3d);
        EXPECT(gbc.l(),  0xc5);
        EXPECT(gbc.sp(), 0x8ca7);
        EXPECT(gbc.pc(), 0xce4f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xce4e), 0x3d);
        // 3D 028D
        gbc.setState(0xef55, 0xc897, 0xa830, 0x5985, 0xb3f8, 0xa1fe, 0x0, 0x0);
        gbc.writeMem(0xef55, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa7);
        EXPECT(gbc.b(),  0x59);
        EXPECT(gbc.c(),  0x85);
        EXPECT(gbc.d(),  0xb3);
        EXPECT(gbc.e(),  0xf8);
        EXPECT(gbc.h(),  0xa1);
        EXPECT(gbc.l(),  0xfe);
        EXPECT(gbc.sp(), 0xc897);
        EXPECT(gbc.pc(), 0xef56);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xef55), 0x3d);
        // 3D 028E
        gbc.setState(0x938, 0x3361, 0x2e10, 0x7394, 0x8943, 0xe74a, 0x1, 0x1);
        gbc.writeMem(0x938, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x2d);
        EXPECT(gbc.b(),  0x73);
        EXPECT(gbc.c(),  0x94);
        EXPECT(gbc.d(),  0x89);
        EXPECT(gbc.e(),  0x43);
        EXPECT(gbc.h(),  0xe7);
        EXPECT(gbc.l(),  0x4a);
        EXPECT(gbc.sp(), 0x3361);
        EXPECT(gbc.pc(), 0x939);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 028F
        gbc.setState(0x34e, 0xf05e, 0x490, 0x9045, 0x3ab, 0x58df, 0x0, 0x0);
        gbc.writeMem(0x34e, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x3);
        EXPECT(gbc.b(),  0x90);
        EXPECT(gbc.c(),  0x45);
        EXPECT(gbc.d(),  0x3);
        EXPECT(gbc.e(),  0xab);
        EXPECT(gbc.h(),  0x58);
        EXPECT(gbc.l(),  0xdf);
        EXPECT(gbc.sp(), 0xf05e);
        EXPECT(gbc.pc(), 0x34f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0290
        gbc.setState(0x3303, 0xf560, 0xcf30, 0xc023, 0xcd71, 0xf1f7, 0x0, 0x1);
        gbc.writeMem(0x3303, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xce);
        EXPECT(gbc.b(),  0xc0);
        EXPECT(gbc.c(),  0x23);
        EXPECT(gbc.d(),  0xcd);
        EXPECT(gbc.e(),  0x71);
        EXPECT(gbc.h(),  0xf1);
        EXPECT(gbc.l(),  0xf7);
        EXPECT(gbc.sp(), 0xf560);
        EXPECT(gbc.pc(), 0x3304);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0291
        gbc.setState(0x35bd, 0x5612, 0xb560, 0x929, 0x776e, 0x5d3a, 0x1, 0x0);
        gbc.writeMem(0x35bd, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xb4);
        EXPECT(gbc.b(),  0x9);
        EXPECT(gbc.c(),  0x29);
        EXPECT(gbc.d(),  0x77);
        EXPECT(gbc.e(),  0x6e);
        EXPECT(gbc.h(),  0x5d);
        EXPECT(gbc.l(),  0x3a);
        EXPECT(gbc.sp(), 0x5612);
        EXPECT(gbc.pc(), 0x35be);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0292
        gbc.setState(0x1398, 0xa60a, 0x11a0, 0x11d1, 0xa1b0, 0x822d, 0x0, 0x0);
        gbc.writeMem(0x1398, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0x11);
        EXPECT(gbc.c(),  0xd1);
        EXPECT(gbc.d(),  0xa1);
        EXPECT(gbc.e(),  0xb0);
        EXPECT(gbc.h(),  0x82);
        EXPECT(gbc.l(),  0x2d);
        EXPECT(gbc.sp(), 0xa60a);
        EXPECT(gbc.pc(), 0x1399);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0293
        gbc.setState(0x3c87, 0xa02b, 0x6840, 0xfdb4, 0x57f9, 0xc525, 0x0, 0x0);
        gbc.writeMem(0x3c87, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x67);
        EXPECT(gbc.b(),  0xfd);
        EXPECT(gbc.c(),  0xb4);
        EXPECT(gbc.d(),  0x57);
        EXPECT(gbc.e(),  0xf9);
        EXPECT(gbc.h(),  0xc5);
        EXPECT(gbc.l(),  0x25);
        EXPECT(gbc.sp(), 0xa02b);
        EXPECT(gbc.pc(), 0x3c88);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0294
        gbc.setState(0xae7c, 0xd4d3, 0x5660, 0x9d49, 0xc705, 0x2f96, 0x0, 0x1);
        gbc.writeMem(0xae7c, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x55);
        EXPECT(gbc.b(),  0x9d);
        EXPECT(gbc.c(),  0x49);
        EXPECT(gbc.d(),  0xc7);
        EXPECT(gbc.e(),  0x5);
        EXPECT(gbc.h(),  0x2f);
        EXPECT(gbc.l(),  0x96);
        EXPECT(gbc.sp(), 0xd4d3);
        EXPECT(gbc.pc(), 0xae7d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xae7c), 0x3d);
        // 3D 0296
        gbc.setState(0x6e3d, 0x3ed4, 0x620, 0xbbe2, 0xa766, 0x6b6b, 0x0, 0x1);
        gbc.writeMem(0x6e3d, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x5);
        EXPECT(gbc.b(),  0xbb);
        EXPECT(gbc.c(),  0xe2);
        EXPECT(gbc.d(),  0xa7);
        EXPECT(gbc.e(),  0x66);
        EXPECT(gbc.h(),  0x6b);
        EXPECT(gbc.l(),  0x6b);
        EXPECT(gbc.sp(), 0x3ed4);
        EXPECT(gbc.pc(), 0x6e3e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0297
        gbc.setState(0xcb5b, 0x967c, 0xe830, 0xdf48, 0xe1b2, 0x4eac, 0x1, 0x0);
        gbc.writeMem(0xcb5b, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xe7);
        EXPECT(gbc.b(),  0xdf);
        EXPECT(gbc.c(),  0x48);
        EXPECT(gbc.d(),  0xe1);
        EXPECT(gbc.e(),  0xb2);
        EXPECT(gbc.h(),  0x4e);
        EXPECT(gbc.l(),  0xac);
        EXPECT(gbc.sp(), 0x967c);
        EXPECT(gbc.pc(), 0xcb5c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcb5b), 0x3d);
        // 3D 0298
        gbc.setState(0xadb2, 0xad4d, 0x5030, 0x2d2e, 0x22b9, 0x6a28, 0x1, 0x0);
        gbc.writeMem(0xadb2, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x4f);
        EXPECT(gbc.b(),  0x2d);
        EXPECT(gbc.c(),  0x2e);
        EXPECT(gbc.d(),  0x22);
        EXPECT(gbc.e(),  0xb9);
        EXPECT(gbc.h(),  0x6a);
        EXPECT(gbc.l(),  0x28);
        EXPECT(gbc.sp(), 0xad4d);
        EXPECT(gbc.pc(), 0xadb3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xadb2), 0x3d);
        // 3D 0299
        gbc.setState(0x95c3, 0x9e0d, 0x96a0, 0x9d31, 0xa54c, 0x199b, 0x1, 0x1);
        gbc.writeMem(0x95c3, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x95);
        EXPECT(gbc.b(),  0x9d);
        EXPECT(gbc.c(),  0x31);
        EXPECT(gbc.d(),  0xa5);
        EXPECT(gbc.e(),  0x4c);
        EXPECT(gbc.h(),  0x19);
        EXPECT(gbc.l(),  0x9b);
        EXPECT(gbc.sp(), 0x9e0d);
        EXPECT(gbc.pc(), 0x95c4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x95c3), 0x3d);
        // 3D 029A
        gbc.setState(0x2898, 0x477e, 0xb320, 0x8307, 0x8d37, 0x8edf, 0x0, 0x1);
        gbc.writeMem(0x2898, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xb2);
        EXPECT(gbc.b(),  0x83);
        EXPECT(gbc.c(),  0x7);
        EXPECT(gbc.d(),  0x8d);
        EXPECT(gbc.e(),  0x37);
        EXPECT(gbc.h(),  0x8e);
        EXPECT(gbc.l(),  0xdf);
        EXPECT(gbc.sp(), 0x477e);
        EXPECT(gbc.pc(), 0x2899);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 029B
        gbc.setState(0x4b0e, 0xd6f, 0xb390, 0xe964, 0x9c0c, 0xe9fe, 0x1, 0x1);
        gbc.writeMem(0x4b0e, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xb2);
        EXPECT(gbc.b(),  0xe9);
        EXPECT(gbc.c(),  0x64);
        EXPECT(gbc.d(),  0x9c);
        EXPECT(gbc.e(),  0xc);
        EXPECT(gbc.h(),  0xe9);
        EXPECT(gbc.l(),  0xfe);
        EXPECT(gbc.sp(), 0xd6f);
        EXPECT(gbc.pc(), 0x4b0f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 029C
        gbc.setState(0x3a72, 0x2fdd, 0x1f10, 0x530c, 0x1815, 0x903d, 0x0, 0x1);
        gbc.writeMem(0x3a72, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x1e);
        EXPECT(gbc.b(),  0x53);
        EXPECT(gbc.c(),  0xc);
        EXPECT(gbc.d(),  0x18);
        EXPECT(gbc.e(),  0x15);
        EXPECT(gbc.h(),  0x90);
        EXPECT(gbc.l(),  0x3d);
        EXPECT(gbc.sp(), 0x2fdd);
        EXPECT(gbc.pc(), 0x3a73);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 029E
        gbc.setState(0x7d92, 0xf445, 0xf1d0, 0xd041, 0x5862, 0xbbb5, 0x0, 0x0);
        gbc.writeMem(0x7d92, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf0);
        EXPECT(gbc.b(),  0xd0);
        EXPECT(gbc.c(),  0x41);
        EXPECT(gbc.d(),  0x58);
        EXPECT(gbc.e(),  0x62);
        EXPECT(gbc.h(),  0xbb);
        EXPECT(gbc.l(),  0xb5);
        EXPECT(gbc.sp(), 0xf445);
        EXPECT(gbc.pc(), 0x7d93);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 029F
        gbc.setState(0x4722, 0xb5f, 0xe210, 0x2243, 0xddf6, 0x1b39, 0x0, 0x0);
        gbc.writeMem(0x4722, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xe1);
        EXPECT(gbc.b(),  0x22);
        EXPECT(gbc.c(),  0x43);
        EXPECT(gbc.d(),  0xdd);
        EXPECT(gbc.e(),  0xf6);
        EXPECT(gbc.h(),  0x1b);
        EXPECT(gbc.l(),  0x39);
        EXPECT(gbc.sp(), 0xb5f);
        EXPECT(gbc.pc(), 0x4723);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 02A0
        gbc.setState(0x893a, 0x43b7, 0xa760, 0x922e, 0x9056, 0xe0a2, 0x1, 0x1);
        gbc.writeMem(0x893a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa6);
        EXPECT(gbc.b(),  0x92);
        EXPECT(gbc.c(),  0x2e);
        EXPECT(gbc.d(),  0x90);
        EXPECT(gbc.e(),  0x56);
        EXPECT(gbc.h(),  0xe0);
        EXPECT(gbc.l(),  0xa2);
        EXPECT(gbc.sp(), 0x43b7);
        EXPECT(gbc.pc(), 0x893b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x893a), 0x3d);
        // 3D 02A1
        gbc.setState(0x1108, 0x3363, 0x3d50, 0x1de2, 0x3313, 0xcb1d, 0x1, 0x1);
        gbc.writeMem(0x1108, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x3c);
        EXPECT(gbc.b(),  0x1d);
        EXPECT(gbc.c(),  0xe2);
        EXPECT(gbc.d(),  0x33);
        EXPECT(gbc.e(),  0x13);
        EXPECT(gbc.h(),  0xcb);
        EXPECT(gbc.l(),  0x1d);
        EXPECT(gbc.sp(), 0x3363);
        EXPECT(gbc.pc(), 0x1109);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 02A2
        gbc.setState(0x8e1, 0x9ada, 0xf0, 0x943, 0xff00, 0x1144, 0x1, 0x0);
        gbc.writeMem(0x8e1, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xff);
        EXPECT(gbc.b(),  0x9);
        EXPECT(gbc.c(),  0x43);
        EXPECT(gbc.d(),  0xff);
        EXPECT(gbc.e(),  0x0);
        EXPECT(gbc.h(),  0x11);
        EXPECT(gbc.l(),  0x44);
        EXPECT(gbc.sp(), 0x9ada);
        EXPECT(gbc.pc(), 0x8e2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 3D 02A3
        gbc.setState(0x78b9, 0xf0ff, 0xa100, 0x9d49, 0x83d8, 0xe1e2, 0x1, 0x1);
        gbc.writeMem(0x78b9, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa0);
        EXPECT(gbc.b(),  0x9d);
        EXPECT(gbc.c(),  0x49);
        EXPECT(gbc.d(),  0x83);
        EXPECT(gbc.e(),  0xd8);
        EXPECT(gbc.h(),  0xe1);
        EXPECT(gbc.l(),  0xe2);
        EXPECT(gbc.sp(), 0xf0ff);
        EXPECT(gbc.pc(), 0x78ba);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 02A4
        gbc.setState(0xdf7, 0x88, 0x8a80, 0x7b58, 0xac0e, 0xd, 0x1, 0x1);
        gbc.writeMem(0xdf7, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x89);
        EXPECT(gbc.b(),  0x7b);
        EXPECT(gbc.c(),  0x58);
        EXPECT(gbc.d(),  0xac);
        EXPECT(gbc.e(),  0xe);
        EXPECT(gbc.h(),  0x0);
        EXPECT(gbc.l(),  0xd);
        EXPECT(gbc.sp(), 0x88);
        EXPECT(gbc.pc(), 0xdf8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 02A5
        gbc.setState(0x5845, 0x408d, 0xa590, 0xc3ac, 0xd7ba, 0x7f4, 0x0, 0x1);
        gbc.writeMem(0x5845, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa4);
        EXPECT(gbc.b(),  0xc3);
        EXPECT(gbc.c(),  0xac);
        EXPECT(gbc.d(),  0xd7);
        EXPECT(gbc.e(),  0xba);
        EXPECT(gbc.h(),  0x7);
        EXPECT(gbc.l(),  0xf4);
        EXPECT(gbc.sp(), 0x408d);
        EXPECT(gbc.pc(), 0x5846);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 02A6
        gbc.setState(0x9708, 0xc58c, 0xab0, 0xc4fd, 0xcbbc, 0x64d1, 0x1, 0x1);
        gbc.writeMem(0x9708, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x9);
        EXPECT(gbc.b(),  0xc4);
        EXPECT(gbc.c(),  0xfd);
        EXPECT(gbc.d(),  0xcb);
        EXPECT(gbc.e(),  0xbc);
        EXPECT(gbc.h(),  0x64);
        EXPECT(gbc.l(),  0xd1);
        EXPECT(gbc.sp(), 0xc58c);
        EXPECT(gbc.pc(), 0x9709);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9708), 0x3d);
        // 3D 02A8
        gbc.setState(0x7beb, 0x800a, 0x21f0, 0x3792, 0x1234, 0xb9fb, 0x0, 0x0);
        gbc.writeMem(0x7beb, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x20);
        EXPECT(gbc.b(),  0x37);
        EXPECT(gbc.c(),  0x92);
        EXPECT(gbc.d(),  0x12);
        EXPECT(gbc.e(),  0x34);
        EXPECT(gbc.h(),  0xb9);
        EXPECT(gbc.l(),  0xfb);
        EXPECT(gbc.sp(), 0x800a);
        EXPECT(gbc.pc(), 0x7bec);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 02A9
        gbc.setState(0xa2a, 0xc7cd, 0x6130, 0x4fcf, 0x9c15, 0xf7e9, 0x0, 0x0);
        gbc.writeMem(0xa2a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x60);
        EXPECT(gbc.b(),  0x4f);
        EXPECT(gbc.c(),  0xcf);
        EXPECT(gbc.d(),  0x9c);
        EXPECT(gbc.e(),  0x15);
        EXPECT(gbc.h(),  0xf7);
        EXPECT(gbc.l(),  0xe9);
        EXPECT(gbc.sp(), 0xc7cd);
        EXPECT(gbc.pc(), 0xa2b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 02AA
        gbc.setState(0xd1df, 0x7642, 0xda20, 0xf066, 0x4e1f, 0xdd54, 0x1, 0x1);
        gbc.writeMem(0xd1df, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xd9);
        EXPECT(gbc.b(),  0xf0);
        EXPECT(gbc.c(),  0x66);
        EXPECT(gbc.d(),  0x4e);
        EXPECT(gbc.e(),  0x1f);
        EXPECT(gbc.h(),  0xdd);
        EXPECT(gbc.l(),  0x54);
        EXPECT(gbc.sp(), 0x7642);
        EXPECT(gbc.pc(), 0xd1e0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd1df), 0x3d);
        // 3D 02AB
        gbc.setState(0xd759, 0x76b3, 0x8050, 0x50c2, 0x18fb, 0x131b, 0x0, 0x1);
        gbc.writeMem(0xd759, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x7f);
        EXPECT(gbc.b(),  0x50);
        EXPECT(gbc.c(),  0xc2);
        EXPECT(gbc.d(),  0x18);
        EXPECT(gbc.e(),  0xfb);
        EXPECT(gbc.h(),  0x13);
        EXPECT(gbc.l(),  0x1b);
        EXPECT(gbc.sp(), 0x76b3);
        EXPECT(gbc.pc(), 0xd75a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd759), 0x3d);
        // 3D 02AC
        gbc.setState(0xa5b6, 0x19ec, 0x87f0, 0x7cde, 0x498c, 0xa23b, 0x1, 0x1);
        gbc.writeMem(0xa5b6, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x86);
        EXPECT(gbc.b(),  0x7c);
        EXPECT(gbc.c(),  0xde);
        EXPECT(gbc.d(),  0x49);
        EXPECT(gbc.e(),  0x8c);
        EXPECT(gbc.h(),  0xa2);
        EXPECT(gbc.l(),  0x3b);
        EXPECT(gbc.sp(), 0x19ec);
        EXPECT(gbc.pc(), 0xa5b7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa5b6), 0x3d);
        // 3D 02AD
        gbc.setState(0x2927, 0xf62a, 0xb200, 0x54e6, 0xb524, 0x9192, 0x0, 0x0);
        gbc.writeMem(0x2927, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xb1);
        EXPECT(gbc.b(),  0x54);
        EXPECT(gbc.c(),  0xe6);
        EXPECT(gbc.d(),  0xb5);
        EXPECT(gbc.e(),  0x24);
        EXPECT(gbc.h(),  0x91);
        EXPECT(gbc.l(),  0x92);
        EXPECT(gbc.sp(), 0xf62a);
        EXPECT(gbc.pc(), 0x2928);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 02AE
        gbc.setState(0xdf61, 0xbefd, 0xd450, 0x94cc, 0x836b, 0x33da, 0x0, 0x0);
        gbc.writeMem(0xdf61, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xd3);
        EXPECT(gbc.b(),  0x94);
        EXPECT(gbc.c(),  0xcc);
        EXPECT(gbc.d(),  0x83);
        EXPECT(gbc.e(),  0x6b);
        EXPECT(gbc.h(),  0x33);
        EXPECT(gbc.l(),  0xda);
        EXPECT(gbc.sp(), 0xbefd);
        EXPECT(gbc.pc(), 0xdf62);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xdf61), 0x3d);
        // 3D 02AF
        gbc.setState(0x666d, 0xcf42, 0x9090, 0x9efd, 0x1641, 0xc0f7, 0x1, 0x0);
        gbc.writeMem(0x666d, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x8f);
        EXPECT(gbc.b(),  0x9e);
        EXPECT(gbc.c(),  0xfd);
        EXPECT(gbc.d(),  0x16);
        EXPECT(gbc.e(),  0x41);
        EXPECT(gbc.h(),  0xc0);
        EXPECT(gbc.l(),  0xf7);
        EXPECT(gbc.sp(), 0xcf42);
        EXPECT(gbc.pc(), 0x666e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 3D 02B0
        gbc.setState(0x96a8, 0x13eb, 0x10b0, 0x9725, 0x2b44, 0xa46f, 0x1, 0x1);
        gbc.writeMem(0x96a8, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf);
        EXPECT(gbc.b(),  0x97);
        EXPECT(gbc.c(),  0x25);
        EXPECT(gbc.d(),  0x2b);
        EXPECT(gbc.e(),  0x44);
        EXPECT(gbc.h(),  0xa4);
        EXPECT(gbc.l(),  0x6f);
        EXPECT(gbc.sp(), 0x13eb);
        EXPECT(gbc.pc(), 0x96a9);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x96a8), 0x3d);
        // 3D 02B1
        gbc.setState(0xd408, 0xc84, 0x5730, 0xdbaf, 0xe174, 0x7f86, 0x0, 0x1);
        gbc.writeMem(0xd408, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x56);
        EXPECT(gbc.b(),  0xdb);
        EXPECT(gbc.c(),  0xaf);
        EXPECT(gbc.d(),  0xe1);
        EXPECT(gbc.e(),  0x74);
        EXPECT(gbc.h(),  0x7f);
        EXPECT(gbc.l(),  0x86);
        EXPECT(gbc.sp(), 0xc84);
        EXPECT(gbc.pc(), 0xd409);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd408), 0x3d);
        // 3D 02B2
        gbc.setState(0x56d6, 0x7cc0, 0xbd50, 0x982b, 0xcff, 0xfdcf, 0x0, 0x0);
        gbc.writeMem(0x56d6, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xbc);
        EXPECT(gbc.b(),  0x98);
        EXPECT(gbc.c(),  0x2b);
        EXPECT(gbc.d(),  0xc);
        EXPECT(gbc.e(),  0xff);
        EXPECT(gbc.h(),  0xfd);
        EXPECT(gbc.l(),  0xcf);
        EXPECT(gbc.sp(), 0x7cc0);
        EXPECT(gbc.pc(), 0x56d7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 02B3
        gbc.setState(0x62d9, 0xb9c, 0x1eb0, 0x342e, 0x5205, 0xced3, 0x0, 0x1);
        gbc.writeMem(0x62d9, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x1d);
        EXPECT(gbc.b(),  0x34);
        EXPECT(gbc.c(),  0x2e);
        EXPECT(gbc.d(),  0x52);
        EXPECT(gbc.e(),  0x5);
        EXPECT(gbc.h(),  0xce);
        EXPECT(gbc.l(),  0xd3);
        EXPECT(gbc.sp(), 0xb9c);
        EXPECT(gbc.pc(), 0x62da);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 02B4
        gbc.setState(0xc964, 0x23f6, 0x9cb0, 0xc44d, 0x83ae, 0x8ac9, 0x1, 0x1);
        gbc.writeMem(0xc964, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x9b);
        EXPECT(gbc.b(),  0xc4);
        EXPECT(gbc.c(),  0x4d);
        EXPECT(gbc.d(),  0x83);
        EXPECT(gbc.e(),  0xae);
        EXPECT(gbc.h(),  0x8a);
        EXPECT(gbc.l(),  0xc9);
        EXPECT(gbc.sp(), 0x23f6);
        EXPECT(gbc.pc(), 0xc965);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc964), 0x3d);
        // 3D 02B5
        gbc.setState(0xc39f, 0xf26e, 0x1ee0, 0x9b62, 0xcbc, 0xc4e2, 0x1, 0x1);
        gbc.writeMem(0xc39f, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x1d);
        EXPECT(gbc.b(),  0x9b);
        EXPECT(gbc.c(),  0x62);
        EXPECT(gbc.d(),  0xc);
        EXPECT(gbc.e(),  0xbc);
        EXPECT(gbc.h(),  0xc4);
        EXPECT(gbc.l(),  0xe2);
        EXPECT(gbc.sp(), 0xf26e);
        EXPECT(gbc.pc(), 0xc3a0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc39f), 0x3d);
        // 3D 02B6
        gbc.setState(0xc04f, 0x5b38, 0xdd50, 0xe16c, 0xb791, 0x1aec, 0x1, 0x1);
        gbc.writeMem(0xc04f, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xdc);
        EXPECT(gbc.b(),  0xe1);
        EXPECT(gbc.c(),  0x6c);
        EXPECT(gbc.d(),  0xb7);
        EXPECT(gbc.e(),  0x91);
        EXPECT(gbc.h(),  0x1a);
        EXPECT(gbc.l(),  0xec);
        EXPECT(gbc.sp(), 0x5b38);
        EXPECT(gbc.pc(), 0xc050);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc04f), 0x3d);
        // 3D 02B7
        gbc.setState(0xe0e6, 0x8a59, 0x1fd0, 0xb53c, 0x2f88, 0xa223, 0x1, 0x0);
        gbc.writeMem(0xe0e6, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x1e);
        EXPECT(gbc.b(),  0xb5);
        EXPECT(gbc.c(),  0x3c);
        EXPECT(gbc.d(),  0x2f);
        EXPECT(gbc.e(),  0x88);
        EXPECT(gbc.h(),  0xa2);
        EXPECT(gbc.l(),  0x23);
        EXPECT(gbc.sp(), 0x8a59);
        EXPECT(gbc.pc(), 0xe0e7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe0e6), 0x3d);
        // 3D 02B8
        gbc.setState(0x62c8, 0x325d, 0xffb0, 0x88a7, 0x8984, 0x366a, 0x1, 0x0);
        gbc.writeMem(0x62c8, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xfe);
        EXPECT(gbc.b(),  0x88);
        EXPECT(gbc.c(),  0xa7);
        EXPECT(gbc.d(),  0x89);
        EXPECT(gbc.e(),  0x84);
        EXPECT(gbc.h(),  0x36);
        EXPECT(gbc.l(),  0x6a);
        EXPECT(gbc.sp(), 0x325d);
        EXPECT(gbc.pc(), 0x62c9);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 02B9
        gbc.setState(0x4f1d, 0x6c63, 0x74b0, 0x8cc6, 0xd225, 0x8ca2, 0x1, 0x1);
        gbc.writeMem(0x4f1d, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x73);
        EXPECT(gbc.b(),  0x8c);
        EXPECT(gbc.c(),  0xc6);
        EXPECT(gbc.d(),  0xd2);
        EXPECT(gbc.e(),  0x25);
        EXPECT(gbc.h(),  0x8c);
        EXPECT(gbc.l(),  0xa2);
        EXPECT(gbc.sp(), 0x6c63);
        EXPECT(gbc.pc(), 0x4f1e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 02BA
        gbc.setState(0x219e, 0x370c, 0x5a90, 0x36f5, 0xd324, 0x99c3, 0x1, 0x0);
        gbc.writeMem(0x219e, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x59);
        EXPECT(gbc.b(),  0x36);
        EXPECT(gbc.c(),  0xf5);
        EXPECT(gbc.d(),  0xd3);
        EXPECT(gbc.e(),  0x24);
        EXPECT(gbc.h(),  0x99);
        EXPECT(gbc.l(),  0xc3);
        EXPECT(gbc.sp(), 0x370c);
        EXPECT(gbc.pc(), 0x219f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 02BB
        gbc.setState(0xb2b5, 0x6f00, 0xa6f0, 0xcfb4, 0xb398, 0x8b7, 0x1, 0x0);
        gbc.writeMem(0xb2b5, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa5);
        EXPECT(gbc.b(),  0xcf);
        EXPECT(gbc.c(),  0xb4);
        EXPECT(gbc.d(),  0xb3);
        EXPECT(gbc.e(),  0x98);
        EXPECT(gbc.h(),  0x8);
        EXPECT(gbc.l(),  0xb7);
        EXPECT(gbc.sp(), 0x6f00);
        EXPECT(gbc.pc(), 0xb2b6);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb2b5), 0x3d);
        // 3D 02BC
        gbc.setState(0xc3f2, 0xbdfc, 0xf2b0, 0xc8bc, 0xdc11, 0xbf23, 0x1, 0x0);
        gbc.writeMem(0xc3f2, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf1);
        EXPECT(gbc.b(),  0xc8);
        EXPECT(gbc.c(),  0xbc);
        EXPECT(gbc.d(),  0xdc);
        EXPECT(gbc.e(),  0x11);
        EXPECT(gbc.h(),  0xbf);
        EXPECT(gbc.l(),  0x23);
        EXPECT(gbc.sp(), 0xbdfc);
        EXPECT(gbc.pc(), 0xc3f3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc3f2), 0x3d);
        // 3D 02BD
        gbc.setState(0xc95b, 0x6fc3, 0x1ab0, 0xcd3d, 0x62ca, 0xb7a5, 0x0, 0x0);
        gbc.writeMem(0xc95b, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x19);
        EXPECT(gbc.b(),  0xcd);
        EXPECT(gbc.c(),  0x3d);
        EXPECT(gbc.d(),  0x62);
        EXPECT(gbc.e(),  0xca);
        EXPECT(gbc.h(),  0xb7);
        EXPECT(gbc.l(),  0xa5);
        EXPECT(gbc.sp(), 0x6fc3);
        EXPECT(gbc.pc(), 0xc95c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc95b), 0x3d);
        // 3D 02BE
        gbc.setState(0xb1a8, 0x7bec, 0x84c0, 0xb16d, 0xd3c4, 0x7b0a, 0x1, 0x1);
        gbc.writeMem(0xb1a8, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x83);
        EXPECT(gbc.b(),  0xb1);
        EXPECT(gbc.c(),  0x6d);
        EXPECT(gbc.d(),  0xd3);
        EXPECT(gbc.e(),  0xc4);
        EXPECT(gbc.h(),  0x7b);
        EXPECT(gbc.l(),  0xa);
        EXPECT(gbc.sp(), 0x7bec);
        EXPECT(gbc.pc(), 0xb1a9);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb1a8), 0x3d);
        // 3D 02BF
        gbc.setState(0xef7f, 0x8fd8, 0xf100, 0x4d36, 0x167f, 0x2b8a, 0x0, 0x0);
        gbc.writeMem(0xef7f, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf0);
        EXPECT(gbc.b(),  0x4d);
        EXPECT(gbc.c(),  0x36);
        EXPECT(gbc.d(),  0x16);
        EXPECT(gbc.e(),  0x7f);
        EXPECT(gbc.h(),  0x2b);
        EXPECT(gbc.l(),  0x8a);
        EXPECT(gbc.sp(), 0x8fd8);
        EXPECT(gbc.pc(), 0xef80);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xef7f), 0x3d);
        // 3D 02C0
        gbc.setState(0x7f2c, 0x796b, 0x63e0, 0x2b3e, 0xe2c3, 0xf9f0, 0x0, 0x0);
        gbc.writeMem(0x7f2c, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x62);
        EXPECT(gbc.b(),  0x2b);
        EXPECT(gbc.c(),  0x3e);
        EXPECT(gbc.d(),  0xe2);
        EXPECT(gbc.e(),  0xc3);
        EXPECT(gbc.h(),  0xf9);
        EXPECT(gbc.l(),  0xf0);
        EXPECT(gbc.sp(), 0x796b);
        EXPECT(gbc.pc(), 0x7f2d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 02C1
        gbc.setState(0xacb9, 0xf64, 0x8f30, 0x4d4b, 0xad3f, 0x8f36, 0x1, 0x0);
        gbc.writeMem(0xacb9, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x8e);
        EXPECT(gbc.b(),  0x4d);
        EXPECT(gbc.c(),  0x4b);
        EXPECT(gbc.d(),  0xad);
        EXPECT(gbc.e(),  0x3f);
        EXPECT(gbc.h(),  0x8f);
        EXPECT(gbc.l(),  0x36);
        EXPECT(gbc.sp(), 0xf64);
        EXPECT(gbc.pc(), 0xacba);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xacb9), 0x3d);
        // 3D 02C3
        gbc.setState(0x737e, 0xa5d8, 0xf40, 0xdeb7, 0x97bc, 0x1b91, 0x0, 0x0);
        gbc.writeMem(0x737e, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xe);
        EXPECT(gbc.b(),  0xde);
        EXPECT(gbc.c(),  0xb7);
        EXPECT(gbc.d(),  0x97);
        EXPECT(gbc.e(),  0xbc);
        EXPECT(gbc.h(),  0x1b);
        EXPECT(gbc.l(),  0x91);
        EXPECT(gbc.sp(), 0xa5d8);
        EXPECT(gbc.pc(), 0x737f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 02C4
        gbc.setState(0x3fcf, 0xfa4c, 0xafc0, 0x8d8c, 0x3578, 0x85c2, 0x1, 0x0);
        gbc.writeMem(0x3fcf, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xae);
        EXPECT(gbc.b(),  0x8d);
        EXPECT(gbc.c(),  0x8c);
        EXPECT(gbc.d(),  0x35);
        EXPECT(gbc.e(),  0x78);
        EXPECT(gbc.h(),  0x85);
        EXPECT(gbc.l(),  0xc2);
        EXPECT(gbc.sp(), 0xfa4c);
        EXPECT(gbc.pc(), 0x3fd0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 02C5
        gbc.setState(0x7859, 0x4dcc, 0x7620, 0x103c, 0xc19d, 0xd5b5, 0x1, 0x0);
        gbc.writeMem(0x7859, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x75);
        EXPECT(gbc.b(),  0x10);
        EXPECT(gbc.c(),  0x3c);
        EXPECT(gbc.d(),  0xc1);
        EXPECT(gbc.e(),  0x9d);
        EXPECT(gbc.h(),  0xd5);
        EXPECT(gbc.l(),  0xb5);
        EXPECT(gbc.sp(), 0x4dcc);
        EXPECT(gbc.pc(), 0x785a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 02C6
        gbc.setState(0x8b93, 0xe98b, 0x7320, 0xb8f3, 0x7b15, 0x77f, 0x0, 0x0);
        gbc.writeMem(0x8b93, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x72);
        EXPECT(gbc.b(),  0xb8);
        EXPECT(gbc.c(),  0xf3);
        EXPECT(gbc.d(),  0x7b);
        EXPECT(gbc.e(),  0x15);
        EXPECT(gbc.h(),  0x7);
        EXPECT(gbc.l(),  0x7f);
        EXPECT(gbc.sp(), 0xe98b);
        EXPECT(gbc.pc(), 0x8b94);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8b93), 0x3d);
        // 3D 02C7
        gbc.setState(0xde07, 0x5501, 0x82b0, 0xa4d, 0x880a, 0x6e8d, 0x0, 0x1);
        gbc.writeMem(0xde07, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x81);
        EXPECT(gbc.b(),  0xa);
        EXPECT(gbc.c(),  0x4d);
        EXPECT(gbc.d(),  0x88);
        EXPECT(gbc.e(),  0xa);
        EXPECT(gbc.h(),  0x6e);
        EXPECT(gbc.l(),  0x8d);
        EXPECT(gbc.sp(), 0x5501);
        EXPECT(gbc.pc(), 0xde08);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xde07), 0x3d);
        // 3D 02C8
        gbc.setState(0xcb20, 0x348f, 0xaa0, 0x517, 0xe8d, 0x35f, 0x1, 0x0);
        gbc.writeMem(0xcb20, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x9);
        EXPECT(gbc.b(),  0x5);
        EXPECT(gbc.c(),  0x17);
        EXPECT(gbc.d(),  0xe);
        EXPECT(gbc.e(),  0x8d);
        EXPECT(gbc.h(),  0x3);
        EXPECT(gbc.l(),  0x5f);
        EXPECT(gbc.sp(), 0x348f);
        EXPECT(gbc.pc(), 0xcb21);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcb20), 0x3d);
        // 3D 02C9
        gbc.setState(0x9752, 0xa9cf, 0x84c0, 0x2, 0x590a, 0xdde, 0x0, 0x0);
        gbc.writeMem(0x9752, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x83);
        EXPECT(gbc.b(),  0x0);
        EXPECT(gbc.c(),  0x2);
        EXPECT(gbc.d(),  0x59);
        EXPECT(gbc.e(),  0xa);
        EXPECT(gbc.h(),  0xd);
        EXPECT(gbc.l(),  0xde);
        EXPECT(gbc.sp(), 0xa9cf);
        EXPECT(gbc.pc(), 0x9753);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9752), 0x3d);
        // 3D 02CA
        gbc.setState(0xbdaf, 0x31ae, 0x7360, 0xc79e, 0x5b3a, 0x96b1, 0x0, 0x0);
        gbc.writeMem(0xbdaf, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x72);
        EXPECT(gbc.b(),  0xc7);
        EXPECT(gbc.c(),  0x9e);
        EXPECT(gbc.d(),  0x5b);
        EXPECT(gbc.e(),  0x3a);
        EXPECT(gbc.h(),  0x96);
        EXPECT(gbc.l(),  0xb1);
        EXPECT(gbc.sp(), 0x31ae);
        EXPECT(gbc.pc(), 0xbdb0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbdaf), 0x3d);
        // 3D 02CB
        gbc.setState(0x2493, 0x451f, 0xe3a0, 0x6416, 0xff23, 0xcf7a, 0x1, 0x1);
        gbc.writeMem(0x2493, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xe2);
        EXPECT(gbc.b(),  0x64);
        EXPECT(gbc.c(),  0x16);
        EXPECT(gbc.d(),  0xff);
        EXPECT(gbc.e(),  0x23);
        EXPECT(gbc.h(),  0xcf);
        EXPECT(gbc.l(),  0x7a);
        EXPECT(gbc.sp(), 0x451f);
        EXPECT(gbc.pc(), 0x2494);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 02CC
        gbc.setState(0x91bb, 0xd74f, 0x7870, 0xb4e2, 0xb03f, 0xbddc, 0x0, 0x1);
        gbc.writeMem(0x91bb, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x77);
        EXPECT(gbc.b(),  0xb4);
        EXPECT(gbc.c(),  0xe2);
        EXPECT(gbc.d(),  0xb0);
        EXPECT(gbc.e(),  0x3f);
        EXPECT(gbc.h(),  0xbd);
        EXPECT(gbc.l(),  0xdc);
        EXPECT(gbc.sp(), 0xd74f);
        EXPECT(gbc.pc(), 0x91bc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x91bb), 0x3d);
        // 3D 02CD
        gbc.setState(0x458b, 0xe4ad, 0x1360, 0xc21c, 0x891b, 0xc59c, 0x1, 0x1);
        gbc.writeMem(0x458b, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x12);
        EXPECT(gbc.b(),  0xc2);
        EXPECT(gbc.c(),  0x1c);
        EXPECT(gbc.d(),  0x89);
        EXPECT(gbc.e(),  0x1b);
        EXPECT(gbc.h(),  0xc5);
        EXPECT(gbc.l(),  0x9c);
        EXPECT(gbc.sp(), 0xe4ad);
        EXPECT(gbc.pc(), 0x458c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 02CE
        gbc.setState(0x8986, 0x63d6, 0xcfc0, 0x2ef4, 0xfbc, 0xfbe0, 0x0, 0x1);
        gbc.writeMem(0x8986, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xce);
        EXPECT(gbc.b(),  0x2e);
        EXPECT(gbc.c(),  0xf4);
        EXPECT(gbc.d(),  0xf);
        EXPECT(gbc.e(),  0xbc);
        EXPECT(gbc.h(),  0xfb);
        EXPECT(gbc.l(),  0xe0);
        EXPECT(gbc.sp(), 0x63d6);
        EXPECT(gbc.pc(), 0x8987);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8986), 0x3d);
        // 3D 02D0
        gbc.setState(0x8b1a, 0x75dc, 0x6280, 0xdd19, 0xb2b5, 0x8dd9, 0x0, 0x0);
        gbc.writeMem(0x8b1a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x61);
        EXPECT(gbc.b(),  0xdd);
        EXPECT(gbc.c(),  0x19);
        EXPECT(gbc.d(),  0xb2);
        EXPECT(gbc.e(),  0xb5);
        EXPECT(gbc.h(),  0x8d);
        EXPECT(gbc.l(),  0xd9);
        EXPECT(gbc.sp(), 0x75dc);
        EXPECT(gbc.pc(), 0x8b1b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8b1a), 0x3d);
        // 3D 02D1
        gbc.setState(0x8488, 0xc8bf, 0xf390, 0x702e, 0xa9df, 0x65b8, 0x0, 0x1);
        gbc.writeMem(0x8488, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf2);
        EXPECT(gbc.b(),  0x70);
        EXPECT(gbc.c(),  0x2e);
        EXPECT(gbc.d(),  0xa9);
        EXPECT(gbc.e(),  0xdf);
        EXPECT(gbc.h(),  0x65);
        EXPECT(gbc.l(),  0xb8);
        EXPECT(gbc.sp(), 0xc8bf);
        EXPECT(gbc.pc(), 0x8489);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8488), 0x3d);
        // 3D 02D2
        gbc.setState(0xe9c8, 0x1793, 0x19a0, 0x8fb5, 0x796e, 0xfaac, 0x0, 0x1);
        gbc.writeMem(0xe9c8, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x18);
        EXPECT(gbc.b(),  0x8f);
        EXPECT(gbc.c(),  0xb5);
        EXPECT(gbc.d(),  0x79);
        EXPECT(gbc.e(),  0x6e);
        EXPECT(gbc.h(),  0xfa);
        EXPECT(gbc.l(),  0xac);
        EXPECT(gbc.sp(), 0x1793);
        EXPECT(gbc.pc(), 0xe9c9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe9c8), 0x3d);
        // 3D 02D3
        gbc.setState(0x854b, 0x7db8, 0x6ca0, 0x6808, 0x2eab, 0xedb1, 0x0, 0x1);
        gbc.writeMem(0x854b, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x6b);
        EXPECT(gbc.b(),  0x68);
        EXPECT(gbc.c(),  0x8);
        EXPECT(gbc.d(),  0x2e);
        EXPECT(gbc.e(),  0xab);
        EXPECT(gbc.h(),  0xed);
        EXPECT(gbc.l(),  0xb1);
        EXPECT(gbc.sp(), 0x7db8);
        EXPECT(gbc.pc(), 0x854c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x854b), 0x3d);
        // 3D 02D4
        gbc.setState(0xac29, 0x4588, 0xc670, 0x5a38, 0x159d, 0x4f5c, 0x1, 0x1);
        gbc.writeMem(0xac29, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xc5);
        EXPECT(gbc.b(),  0x5a);
        EXPECT(gbc.c(),  0x38);
        EXPECT(gbc.d(),  0x15);
        EXPECT(gbc.e(),  0x9d);
        EXPECT(gbc.h(),  0x4f);
        EXPECT(gbc.l(),  0x5c);
        EXPECT(gbc.sp(), 0x4588);
        EXPECT(gbc.pc(), 0xac2a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xac29), 0x3d);
        // 3D 02D5
        gbc.setState(0x10fe, 0x15f6, 0x78b0, 0x20db, 0x81cc, 0x50e3, 0x1, 0x1);
        gbc.writeMem(0x10fe, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x77);
        EXPECT(gbc.b(),  0x20);
        EXPECT(gbc.c(),  0xdb);
        EXPECT(gbc.d(),  0x81);
        EXPECT(gbc.e(),  0xcc);
        EXPECT(gbc.h(),  0x50);
        EXPECT(gbc.l(),  0xe3);
        EXPECT(gbc.sp(), 0x15f6);
        EXPECT(gbc.pc(), 0x10ff);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 02D6
        gbc.setState(0xaf3, 0x929a, 0x7b30, 0x3344, 0x2c4, 0xbebb, 0x1, 0x1);
        gbc.writeMem(0xaf3, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x7a);
        EXPECT(gbc.b(),  0x33);
        EXPECT(gbc.c(),  0x44);
        EXPECT(gbc.d(),  0x2);
        EXPECT(gbc.e(),  0xc4);
        EXPECT(gbc.h(),  0xbe);
        EXPECT(gbc.l(),  0xbb);
        EXPECT(gbc.sp(), 0x929a);
        EXPECT(gbc.pc(), 0xaf4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 02D7
        gbc.setState(0xd8f0, 0x77f3, 0xd2a0, 0x7fb9, 0x824e, 0xf430, 0x0, 0x0);
        gbc.writeMem(0xd8f0, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xd1);
        EXPECT(gbc.b(),  0x7f);
        EXPECT(gbc.c(),  0xb9);
        EXPECT(gbc.d(),  0x82);
        EXPECT(gbc.e(),  0x4e);
        EXPECT(gbc.h(),  0xf4);
        EXPECT(gbc.l(),  0x30);
        EXPECT(gbc.sp(), 0x77f3);
        EXPECT(gbc.pc(), 0xd8f1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd8f0), 0x3d);
        // 3D 02D8
        gbc.setState(0x85ea, 0xfd7b, 0x5c20, 0x4e21, 0x1af9, 0x22a5, 0x1, 0x0);
        gbc.writeMem(0x85ea, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x5b);
        EXPECT(gbc.b(),  0x4e);
        EXPECT(gbc.c(),  0x21);
        EXPECT(gbc.d(),  0x1a);
        EXPECT(gbc.e(),  0xf9);
        EXPECT(gbc.h(),  0x22);
        EXPECT(gbc.l(),  0xa5);
        EXPECT(gbc.sp(), 0xfd7b);
        EXPECT(gbc.pc(), 0x85eb);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x85ea), 0x3d);
        // 3D 02D9
        gbc.setState(0x99c8, 0x8a2a, 0x2010, 0xe48e, 0xd68f, 0xa27, 0x0, 0x0);
        gbc.writeMem(0x99c8, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x1f);
        EXPECT(gbc.b(),  0xe4);
        EXPECT(gbc.c(),  0x8e);
        EXPECT(gbc.d(),  0xd6);
        EXPECT(gbc.e(),  0x8f);
        EXPECT(gbc.h(),  0xa);
        EXPECT(gbc.l(),  0x27);
        EXPECT(gbc.sp(), 0x8a2a);
        EXPECT(gbc.pc(), 0x99c9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x99c8), 0x3d);
        // 3D 02DA
        gbc.setState(0x134, 0xce41, 0x8b40, 0x9d5c, 0x92fa, 0x9238, 0x1, 0x0);
        gbc.writeMem(0x134, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x8a);
        EXPECT(gbc.b(),  0x9d);
        EXPECT(gbc.c(),  0x5c);
        EXPECT(gbc.d(),  0x92);
        EXPECT(gbc.e(),  0xfa);
        EXPECT(gbc.h(),  0x92);
        EXPECT(gbc.l(),  0x38);
        EXPECT(gbc.sp(), 0xce41);
        EXPECT(gbc.pc(), 0x135);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 02DB
        gbc.setState(0x51b7, 0xa997, 0xd220, 0x8436, 0xc41, 0x6c22, 0x0, 0x0);
        gbc.writeMem(0x51b7, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xd1);
        EXPECT(gbc.b(),  0x84);
        EXPECT(gbc.c(),  0x36);
        EXPECT(gbc.d(),  0xc);
        EXPECT(gbc.e(),  0x41);
        EXPECT(gbc.h(),  0x6c);
        EXPECT(gbc.l(),  0x22);
        EXPECT(gbc.sp(), 0xa997);
        EXPECT(gbc.pc(), 0x51b8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 02DC
        gbc.setState(0x8fdc, 0x52ff, 0xf2e0, 0x7f93, 0xb922, 0x19b, 0x1, 0x0);
        gbc.writeMem(0x8fdc, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf1);
        EXPECT(gbc.b(),  0x7f);
        EXPECT(gbc.c(),  0x93);
        EXPECT(gbc.d(),  0xb9);
        EXPECT(gbc.e(),  0x22);
        EXPECT(gbc.h(),  0x1);
        EXPECT(gbc.l(),  0x9b);
        EXPECT(gbc.sp(), 0x52ff);
        EXPECT(gbc.pc(), 0x8fdd);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8fdc), 0x3d);
        // 3D 02DD
        gbc.setState(0xdcd, 0xa71a, 0x8b90, 0x69e5, 0x1380, 0xc9e8, 0x0, 0x0);
        gbc.writeMem(0xdcd, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x8a);
        EXPECT(gbc.b(),  0x69);
        EXPECT(gbc.c(),  0xe5);
        EXPECT(gbc.d(),  0x13);
        EXPECT(gbc.e(),  0x80);
        EXPECT(gbc.h(),  0xc9);
        EXPECT(gbc.l(),  0xe8);
        EXPECT(gbc.sp(), 0xa71a);
        EXPECT(gbc.pc(), 0xdce);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 02DE
        gbc.setState(0xd186, 0xe3d7, 0xf430, 0x4b60, 0xf191, 0x33dd, 0x0, 0x0);
        gbc.writeMem(0xd186, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf3);
        EXPECT(gbc.b(),  0x4b);
        EXPECT(gbc.c(),  0x60);
        EXPECT(gbc.d(),  0xf1);
        EXPECT(gbc.e(),  0x91);
        EXPECT(gbc.h(),  0x33);
        EXPECT(gbc.l(),  0xdd);
        EXPECT(gbc.sp(), 0xe3d7);
        EXPECT(gbc.pc(), 0xd187);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd186), 0x3d);
        // 3D 02DF
        gbc.setState(0x9797, 0xa6cd, 0xedb0, 0xec38, 0x19a5, 0x41f1, 0x1, 0x0);
        gbc.writeMem(0x9797, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xec);
        EXPECT(gbc.b(),  0xec);
        EXPECT(gbc.c(),  0x38);
        EXPECT(gbc.d(),  0x19);
        EXPECT(gbc.e(),  0xa5);
        EXPECT(gbc.h(),  0x41);
        EXPECT(gbc.l(),  0xf1);
        EXPECT(gbc.sp(), 0xa6cd);
        EXPECT(gbc.pc(), 0x9798);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9797), 0x3d);
        // 3D 02E0
        gbc.setState(0x140b, 0x9a06, 0x29b0, 0xee13, 0xc521, 0x21a, 0x0, 0x0);
        gbc.writeMem(0x140b, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0xee);
        EXPECT(gbc.c(),  0x13);
        EXPECT(gbc.d(),  0xc5);
        EXPECT(gbc.e(),  0x21);
        EXPECT(gbc.h(),  0x2);
        EXPECT(gbc.l(),  0x1a);
        EXPECT(gbc.sp(), 0x9a06);
        EXPECT(gbc.pc(), 0x140c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 02E1
        gbc.setState(0xecbe, 0x766a, 0xfd40, 0xed72, 0x7046, 0x57c6, 0x1, 0x0);
        gbc.writeMem(0xecbe, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xfc);
        EXPECT(gbc.b(),  0xed);
        EXPECT(gbc.c(),  0x72);
        EXPECT(gbc.d(),  0x70);
        EXPECT(gbc.e(),  0x46);
        EXPECT(gbc.h(),  0x57);
        EXPECT(gbc.l(),  0xc6);
        EXPECT(gbc.sp(), 0x766a);
        EXPECT(gbc.pc(), 0xecbf);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xecbe), 0x3d);
        // 3D 02E2
        gbc.setState(0x4c5a, 0x1d75, 0xe3f0, 0x2bd, 0xa501, 0x3708, 0x1, 0x1);
        gbc.writeMem(0x4c5a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xe2);
        EXPECT(gbc.b(),  0x2);
        EXPECT(gbc.c(),  0xbd);
        EXPECT(gbc.d(),  0xa5);
        EXPECT(gbc.e(),  0x1);
        EXPECT(gbc.h(),  0x37);
        EXPECT(gbc.l(),  0x8);
        EXPECT(gbc.sp(), 0x1d75);
        EXPECT(gbc.pc(), 0x4c5b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 02E3
        gbc.setState(0xd713, 0x155, 0x23f0, 0x4aec, 0xcaf5, 0xa023, 0x0, 0x0);
        gbc.writeMem(0xd713, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x22);
        EXPECT(gbc.b(),  0x4a);
        EXPECT(gbc.c(),  0xec);
        EXPECT(gbc.d(),  0xca);
        EXPECT(gbc.e(),  0xf5);
        EXPECT(gbc.h(),  0xa0);
        EXPECT(gbc.l(),  0x23);
        EXPECT(gbc.sp(), 0x155);
        EXPECT(gbc.pc(), 0xd714);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd713), 0x3d);
        // 3D 02E4
        gbc.setState(0x9e1c, 0xc883, 0x8a30, 0xc96e, 0x172f, 0x28b1, 0x1, 0x0);
        gbc.writeMem(0x9e1c, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x89);
        EXPECT(gbc.b(),  0xc9);
        EXPECT(gbc.c(),  0x6e);
        EXPECT(gbc.d(),  0x17);
        EXPECT(gbc.e(),  0x2f);
        EXPECT(gbc.h(),  0x28);
        EXPECT(gbc.l(),  0xb1);
        EXPECT(gbc.sp(), 0xc883);
        EXPECT(gbc.pc(), 0x9e1d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9e1c), 0x3d);
        // 3D 02E5
        gbc.setState(0x4e8, 0x2b27, 0x8650, 0xa2d6, 0x4013, 0x4a1a, 0x0, 0x1);
        gbc.writeMem(0x4e8, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x85);
        EXPECT(gbc.b(),  0xa2);
        EXPECT(gbc.c(),  0xd6);
        EXPECT(gbc.d(),  0x40);
        EXPECT(gbc.e(),  0x13);
        EXPECT(gbc.h(),  0x4a);
        EXPECT(gbc.l(),  0x1a);
        EXPECT(gbc.sp(), 0x2b27);
        EXPECT(gbc.pc(), 0x4e9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 02E6
        gbc.setState(0xef40, 0xf226, 0xc300, 0x2b8c, 0x9f41, 0x38a9, 0x0, 0x1);
        gbc.writeMem(0xef40, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xc2);
        EXPECT(gbc.b(),  0x2b);
        EXPECT(gbc.c(),  0x8c);
        EXPECT(gbc.d(),  0x9f);
        EXPECT(gbc.e(),  0x41);
        EXPECT(gbc.h(),  0x38);
        EXPECT(gbc.l(),  0xa9);
        EXPECT(gbc.sp(), 0xf226);
        EXPECT(gbc.pc(), 0xef41);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xef40), 0x3d);
        // 3D 02E7
        gbc.setState(0xd698, 0x8d3d, 0x200, 0xda67, 0x6f2f, 0x9e93, 0x1, 0x1);
        gbc.writeMem(0xd698, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0xda);
        EXPECT(gbc.c(),  0x67);
        EXPECT(gbc.d(),  0x6f);
        EXPECT(gbc.e(),  0x2f);
        EXPECT(gbc.h(),  0x9e);
        EXPECT(gbc.l(),  0x93);
        EXPECT(gbc.sp(), 0x8d3d);
        EXPECT(gbc.pc(), 0xd699);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd698), 0x3d);
        // 3D 02E8
        gbc.setState(0x5647, 0xa8af, 0x9d80, 0xdac0, 0x4c07, 0x10e0, 0x1, 0x1);
        gbc.writeMem(0x5647, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x9c);
        EXPECT(gbc.b(),  0xda);
        EXPECT(gbc.c(),  0xc0);
        EXPECT(gbc.d(),  0x4c);
        EXPECT(gbc.e(),  0x7);
        EXPECT(gbc.h(),  0x10);
        EXPECT(gbc.l(),  0xe0);
        EXPECT(gbc.sp(), 0xa8af);
        EXPECT(gbc.pc(), 0x5648);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 02E9
        gbc.setState(0xc13a, 0x6f55, 0x8d0, 0xc374, 0x1fc9, 0x4e38, 0x0, 0x0);
        gbc.writeMem(0xc13a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x7);
        EXPECT(gbc.b(),  0xc3);
        EXPECT(gbc.c(),  0x74);
        EXPECT(gbc.d(),  0x1f);
        EXPECT(gbc.e(),  0xc9);
        EXPECT(gbc.h(),  0x4e);
        EXPECT(gbc.l(),  0x38);
        EXPECT(gbc.sp(), 0x6f55);
        EXPECT(gbc.pc(), 0xc13b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc13a), 0x3d);
        // 3D 02EA
        gbc.setState(0x9f13, 0x148, 0x3280, 0x8c75, 0x81b, 0xa3d1, 0x0, 0x1);
        gbc.writeMem(0x9f13, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x31);
        EXPECT(gbc.b(),  0x8c);
        EXPECT(gbc.c(),  0x75);
        EXPECT(gbc.d(),  0x8);
        EXPECT(gbc.e(),  0x1b);
        EXPECT(gbc.h(),  0xa3);
        EXPECT(gbc.l(),  0xd1);
        EXPECT(gbc.sp(), 0x148);
        EXPECT(gbc.pc(), 0x9f14);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9f13), 0x3d);
        // 3D 02EB
        gbc.setState(0xa23d, 0x8487, 0x93a0, 0x6ab8, 0x9d61, 0x167b, 0x0, 0x1);
        gbc.writeMem(0xa23d, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x92);
        EXPECT(gbc.b(),  0x6a);
        EXPECT(gbc.c(),  0xb8);
        EXPECT(gbc.d(),  0x9d);
        EXPECT(gbc.e(),  0x61);
        EXPECT(gbc.h(),  0x16);
        EXPECT(gbc.l(),  0x7b);
        EXPECT(gbc.sp(), 0x8487);
        EXPECT(gbc.pc(), 0xa23e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa23d), 0x3d);
        // 3D 02EC
        gbc.setState(0x80c6, 0x4310, 0xc0a0, 0x101a, 0x8b74, 0xddde, 0x0, 0x1);
        gbc.writeMem(0x80c6, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xbf);
        EXPECT(gbc.b(),  0x10);
        EXPECT(gbc.c(),  0x1a);
        EXPECT(gbc.d(),  0x8b);
        EXPECT(gbc.e(),  0x74);
        EXPECT(gbc.h(),  0xdd);
        EXPECT(gbc.l(),  0xde);
        EXPECT(gbc.sp(), 0x4310);
        EXPECT(gbc.pc(), 0x80c7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x80c6), 0x3d);
        // 3D 02ED
        gbc.setState(0x5c89, 0x68ec, 0x99b0, 0xa657, 0xab38, 0x6f32, 0x1, 0x1);
        gbc.writeMem(0x5c89, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x98);
        EXPECT(gbc.b(),  0xa6);
        EXPECT(gbc.c(),  0x57);
        EXPECT(gbc.d(),  0xab);
        EXPECT(gbc.e(),  0x38);
        EXPECT(gbc.h(),  0x6f);
        EXPECT(gbc.l(),  0x32);
        EXPECT(gbc.sp(), 0x68ec);
        EXPECT(gbc.pc(), 0x5c8a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 02EE
        gbc.setState(0x758b, 0x679a, 0x5800, 0x4ada, 0x5b81, 0x6c90, 0x1, 0x1);
        gbc.writeMem(0x758b, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x57);
        EXPECT(gbc.b(),  0x4a);
        EXPECT(gbc.c(),  0xda);
        EXPECT(gbc.d(),  0x5b);
        EXPECT(gbc.e(),  0x81);
        EXPECT(gbc.h(),  0x6c);
        EXPECT(gbc.l(),  0x90);
        EXPECT(gbc.sp(), 0x679a);
        EXPECT(gbc.pc(), 0x758c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 02F0
        gbc.setState(0x9c58, 0x57db, 0xba10, 0x9720, 0x80ec, 0xf3d, 0x1, 0x0);
        gbc.writeMem(0x9c58, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xb9);
        EXPECT(gbc.b(),  0x97);
        EXPECT(gbc.c(),  0x20);
        EXPECT(gbc.d(),  0x80);
        EXPECT(gbc.e(),  0xec);
        EXPECT(gbc.h(),  0xf);
        EXPECT(gbc.l(),  0x3d);
        EXPECT(gbc.sp(), 0x57db);
        EXPECT(gbc.pc(), 0x9c59);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9c58), 0x3d);
        // 3D 02F1
        gbc.setState(0xac4, 0xcdd1, 0x6460, 0xb08a, 0x35fe, 0x3e10, 0x1, 0x0);
        gbc.writeMem(0xac4, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x63);
        EXPECT(gbc.b(),  0xb0);
        EXPECT(gbc.c(),  0x8a);
        EXPECT(gbc.d(),  0x35);
        EXPECT(gbc.e(),  0xfe);
        EXPECT(gbc.h(),  0x3e);
        EXPECT(gbc.l(),  0x10);
        EXPECT(gbc.sp(), 0xcdd1);
        EXPECT(gbc.pc(), 0xac5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 02F2
        gbc.setState(0x668c, 0x39f7, 0x7530, 0x8b62, 0x5d63, 0x6458, 0x1, 0x0);
        gbc.writeMem(0x668c, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x74);
        EXPECT(gbc.b(),  0x8b);
        EXPECT(gbc.c(),  0x62);
        EXPECT(gbc.d(),  0x5d);
        EXPECT(gbc.e(),  0x63);
        EXPECT(gbc.h(),  0x64);
        EXPECT(gbc.l(),  0x58);
        EXPECT(gbc.sp(), 0x39f7);
        EXPECT(gbc.pc(), 0x668d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 02F3
        gbc.setState(0xc9d7, 0x63ca, 0xfd90, 0xfdcf, 0x42b3, 0x3bf7, 0x1, 0x1);
        gbc.writeMem(0xc9d7, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xfc);
        EXPECT(gbc.b(),  0xfd);
        EXPECT(gbc.c(),  0xcf);
        EXPECT(gbc.d(),  0x42);
        EXPECT(gbc.e(),  0xb3);
        EXPECT(gbc.h(),  0x3b);
        EXPECT(gbc.l(),  0xf7);
        EXPECT(gbc.sp(), 0x63ca);
        EXPECT(gbc.pc(), 0xc9d8);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc9d7), 0x3d);
        // 3D 02F4
        gbc.setState(0x3a7c, 0x7dcb, 0xbd10, 0xe44c, 0x44e9, 0x8743, 0x0, 0x0);
        gbc.writeMem(0x3a7c, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xbc);
        EXPECT(gbc.b(),  0xe4);
        EXPECT(gbc.c(),  0x4c);
        EXPECT(gbc.d(),  0x44);
        EXPECT(gbc.e(),  0xe9);
        EXPECT(gbc.h(),  0x87);
        EXPECT(gbc.l(),  0x43);
        EXPECT(gbc.sp(), 0x7dcb);
        EXPECT(gbc.pc(), 0x3a7d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 02F5
        gbc.setState(0x1fbf, 0xdb7d, 0x9560, 0x48b5, 0x897f, 0x14d8, 0x0, 0x1);
        gbc.writeMem(0x1fbf, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x94);
        EXPECT(gbc.b(),  0x48);
        EXPECT(gbc.c(),  0xb5);
        EXPECT(gbc.d(),  0x89);
        EXPECT(gbc.e(),  0x7f);
        EXPECT(gbc.h(),  0x14);
        EXPECT(gbc.l(),  0xd8);
        EXPECT(gbc.sp(), 0xdb7d);
        EXPECT(gbc.pc(), 0x1fc0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 02F6
        gbc.setState(0x1a22, 0xbce0, 0x2c40, 0x896e, 0x1d32, 0xdb37, 0x1, 0x0);
        gbc.writeMem(0x1a22, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x2b);
        EXPECT(gbc.b(),  0x89);
        EXPECT(gbc.c(),  0x6e);
        EXPECT(gbc.d(),  0x1d);
        EXPECT(gbc.e(),  0x32);
        EXPECT(gbc.h(),  0xdb);
        EXPECT(gbc.l(),  0x37);
        EXPECT(gbc.sp(), 0xbce0);
        EXPECT(gbc.pc(), 0x1a23);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 02F7
        gbc.setState(0xb0ab, 0xa97c, 0xd30, 0x389e, 0x41e9, 0x89f, 0x1, 0x1);
        gbc.writeMem(0xb0ab, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xc);
        EXPECT(gbc.b(),  0x38);
        EXPECT(gbc.c(),  0x9e);
        EXPECT(gbc.d(),  0x41);
        EXPECT(gbc.e(),  0xe9);
        EXPECT(gbc.h(),  0x8);
        EXPECT(gbc.l(),  0x9f);
        EXPECT(gbc.sp(), 0xa97c);
        EXPECT(gbc.pc(), 0xb0ac);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb0ab), 0x3d);
        // 3D 02F8
        gbc.setState(0xb869, 0x9033, 0x1350, 0x9c20, 0xca00, 0x9e80, 0x0, 0x0);
        gbc.writeMem(0xb869, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x12);
        EXPECT(gbc.b(),  0x9c);
        EXPECT(gbc.c(),  0x20);
        EXPECT(gbc.d(),  0xca);
        EXPECT(gbc.e(),  0x0);
        EXPECT(gbc.h(),  0x9e);
        EXPECT(gbc.l(),  0x80);
        EXPECT(gbc.sp(), 0x9033);
        EXPECT(gbc.pc(), 0xb86a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb869), 0x3d);
        // 3D 02F9
        gbc.setState(0xa145, 0x67ff, 0xdda0, 0x1471, 0xe10f, 0xcff7, 0x0, 0x1);
        gbc.writeMem(0xa145, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xdc);
        EXPECT(gbc.b(),  0x14);
        EXPECT(gbc.c(),  0x71);
        EXPECT(gbc.d(),  0xe1);
        EXPECT(gbc.e(),  0xf);
        EXPECT(gbc.h(),  0xcf);
        EXPECT(gbc.l(),  0xf7);
        EXPECT(gbc.sp(), 0x67ff);
        EXPECT(gbc.pc(), 0xa146);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa145), 0x3d);
        // 3D 02FA
        gbc.setState(0x62a9, 0xc36a, 0x27d0, 0xdc92, 0x4bf4, 0xce29, 0x0, 0x1);
        gbc.writeMem(0x62a9, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x26);
        EXPECT(gbc.b(),  0xdc);
        EXPECT(gbc.c(),  0x92);
        EXPECT(gbc.d(),  0x4b);
        EXPECT(gbc.e(),  0xf4);
        EXPECT(gbc.h(),  0xce);
        EXPECT(gbc.l(),  0x29);
        EXPECT(gbc.sp(), 0xc36a);
        EXPECT(gbc.pc(), 0x62aa);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 02FB
        gbc.setState(0xb098, 0x7b0c, 0xcf80, 0x1e68, 0xc990, 0xd848, 0x0, 0x1);
        gbc.writeMem(0xb098, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xce);
        EXPECT(gbc.b(),  0x1e);
        EXPECT(gbc.c(),  0x68);
        EXPECT(gbc.d(),  0xc9);
        EXPECT(gbc.e(),  0x90);
        EXPECT(gbc.h(),  0xd8);
        EXPECT(gbc.l(),  0x48);
        EXPECT(gbc.sp(), 0x7b0c);
        EXPECT(gbc.pc(), 0xb099);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb098), 0x3d);
        // 3D 02FC
        gbc.setState(0x80b6, 0x31da, 0xb730, 0x2f64, 0x6408, 0x717c, 0x0, 0x0);
        gbc.writeMem(0x80b6, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xb6);
        EXPECT(gbc.b(),  0x2f);
        EXPECT(gbc.c(),  0x64);
        EXPECT(gbc.d(),  0x64);
        EXPECT(gbc.e(),  0x8);
        EXPECT(gbc.h(),  0x71);
        EXPECT(gbc.l(),  0x7c);
        EXPECT(gbc.sp(), 0x31da);
        EXPECT(gbc.pc(), 0x80b7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x80b6), 0x3d);
        // 3D 02FD
        gbc.setState(0xbe36, 0x8682, 0xa180, 0x7100, 0xc85d, 0xd2a5, 0x1, 0x0);
        gbc.writeMem(0xbe36, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa0);
        EXPECT(gbc.b(),  0x71);
        EXPECT(gbc.c(),  0x0);
        EXPECT(gbc.d(),  0xc8);
        EXPECT(gbc.e(),  0x5d);
        EXPECT(gbc.h(),  0xd2);
        EXPECT(gbc.l(),  0xa5);
        EXPECT(gbc.sp(), 0x8682);
        EXPECT(gbc.pc(), 0xbe37);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbe36), 0x3d);
        // 3D 02FE
        gbc.setState(0x9c3f, 0x5f66, 0xf7e0, 0x3941, 0x2553, 0x4127, 0x0, 0x1);
        gbc.writeMem(0x9c3f, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf6);
        EXPECT(gbc.b(),  0x39);
        EXPECT(gbc.c(),  0x41);
        EXPECT(gbc.d(),  0x25);
        EXPECT(gbc.e(),  0x53);
        EXPECT(gbc.h(),  0x41);
        EXPECT(gbc.l(),  0x27);
        EXPECT(gbc.sp(), 0x5f66);
        EXPECT(gbc.pc(), 0x9c40);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9c3f), 0x3d);
        // 3D 02FF
        gbc.setState(0x5d14, 0x7c5f, 0xf6e0, 0x3550, 0xd9c8, 0x209e, 0x1, 0x1);
        gbc.writeMem(0x5d14, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf5);
        EXPECT(gbc.b(),  0x35);
        EXPECT(gbc.c(),  0x50);
        EXPECT(gbc.d(),  0xd9);
        EXPECT(gbc.e(),  0xc8);
        EXPECT(gbc.h(),  0x20);
        EXPECT(gbc.l(),  0x9e);
        EXPECT(gbc.sp(), 0x7c5f);
        EXPECT(gbc.pc(), 0x5d15);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0300
        gbc.setState(0x8b68, 0xba1, 0xdb00, 0x104f, 0x38f4, 0x3efb, 0x1, 0x0);
        gbc.writeMem(0x8b68, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xda);
        EXPECT(gbc.b(),  0x10);
        EXPECT(gbc.c(),  0x4f);
        EXPECT(gbc.d(),  0x38);
        EXPECT(gbc.e(),  0xf4);
        EXPECT(gbc.h(),  0x3e);
        EXPECT(gbc.l(),  0xfb);
        EXPECT(gbc.sp(), 0xba1);
        EXPECT(gbc.pc(), 0x8b69);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8b68), 0x3d);
        // 3D 0301
        gbc.setState(0x4213, 0xe1b5, 0x28e0, 0x7c66, 0x6b87, 0xda8c, 0x0, 0x1);
        gbc.writeMem(0x4213, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x27);
        EXPECT(gbc.b(),  0x7c);
        EXPECT(gbc.c(),  0x66);
        EXPECT(gbc.d(),  0x6b);
        EXPECT(gbc.e(),  0x87);
        EXPECT(gbc.h(),  0xda);
        EXPECT(gbc.l(),  0x8c);
        EXPECT(gbc.sp(), 0xe1b5);
        EXPECT(gbc.pc(), 0x4214);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0302
        gbc.setState(0x9afd, 0x2d1d, 0xbee0, 0xc32, 0x2fe6, 0xe9dc, 0x1, 0x1);
        gbc.writeMem(0x9afd, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xbd);
        EXPECT(gbc.b(),  0xc);
        EXPECT(gbc.c(),  0x32);
        EXPECT(gbc.d(),  0x2f);
        EXPECT(gbc.e(),  0xe6);
        EXPECT(gbc.h(),  0xe9);
        EXPECT(gbc.l(),  0xdc);
        EXPECT(gbc.sp(), 0x2d1d);
        EXPECT(gbc.pc(), 0x9afe);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9afd), 0x3d);
        // 3D 0304
        gbc.setState(0x8bc8, 0x6923, 0xac50, 0xb654, 0x9cf5, 0xea06, 0x1, 0x1);
        gbc.writeMem(0x8bc8, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xab);
        EXPECT(gbc.b(),  0xb6);
        EXPECT(gbc.c(),  0x54);
        EXPECT(gbc.d(),  0x9c);
        EXPECT(gbc.e(),  0xf5);
        EXPECT(gbc.h(),  0xea);
        EXPECT(gbc.l(),  0x6);
        EXPECT(gbc.sp(), 0x6923);
        EXPECT(gbc.pc(), 0x8bc9);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8bc8), 0x3d);
        // 3D 0305
        gbc.setState(0xe397, 0xf617, 0x7030, 0x6fd8, 0xa13e, 0x63c4, 0x0, 0x1);
        gbc.writeMem(0xe397, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x6f);
        EXPECT(gbc.b(),  0x6f);
        EXPECT(gbc.c(),  0xd8);
        EXPECT(gbc.d(),  0xa1);
        EXPECT(gbc.e(),  0x3e);
        EXPECT(gbc.h(),  0x63);
        EXPECT(gbc.l(),  0xc4);
        EXPECT(gbc.sp(), 0xf617);
        EXPECT(gbc.pc(), 0xe398);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe397), 0x3d);
        // 3D 0306
        gbc.setState(0xb7bb, 0xc892, 0x8440, 0x5fff, 0x8f74, 0x7d52, 0x0, 0x1);
        gbc.writeMem(0xb7bb, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x83);
        EXPECT(gbc.b(),  0x5f);
        EXPECT(gbc.c(),  0xff);
        EXPECT(gbc.d(),  0x8f);
        EXPECT(gbc.e(),  0x74);
        EXPECT(gbc.h(),  0x7d);
        EXPECT(gbc.l(),  0x52);
        EXPECT(gbc.sp(), 0xc892);
        EXPECT(gbc.pc(), 0xb7bc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb7bb), 0x3d);
        // 3D 0307
        gbc.setState(0x524a, 0x4f9d, 0x410, 0xeedb, 0xc508, 0x6017, 0x0, 0x0);
        gbc.writeMem(0x524a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x3);
        EXPECT(gbc.b(),  0xee);
        EXPECT(gbc.c(),  0xdb);
        EXPECT(gbc.d(),  0xc5);
        EXPECT(gbc.e(),  0x8);
        EXPECT(gbc.h(),  0x60);
        EXPECT(gbc.l(),  0x17);
        EXPECT(gbc.sp(), 0x4f9d);
        EXPECT(gbc.pc(), 0x524b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0308
        gbc.setState(0x2027, 0x6d9, 0x2b60, 0xc63, 0xd4e9, 0x42ec, 0x0, 0x1);
        gbc.writeMem(0x2027, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x2a);
        EXPECT(gbc.b(),  0xc);
        EXPECT(gbc.c(),  0x63);
        EXPECT(gbc.d(),  0xd4);
        EXPECT(gbc.e(),  0xe9);
        EXPECT(gbc.h(),  0x42);
        EXPECT(gbc.l(),  0xec);
        EXPECT(gbc.sp(), 0x6d9);
        EXPECT(gbc.pc(), 0x2028);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0309
        gbc.setState(0xafa1, 0xba40, 0xa930, 0xa237, 0x46a7, 0x4a10, 0x0, 0x1);
        gbc.writeMem(0xafa1, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa8);
        EXPECT(gbc.b(),  0xa2);
        EXPECT(gbc.c(),  0x37);
        EXPECT(gbc.d(),  0x46);
        EXPECT(gbc.e(),  0xa7);
        EXPECT(gbc.h(),  0x4a);
        EXPECT(gbc.l(),  0x10);
        EXPECT(gbc.sp(), 0xba40);
        EXPECT(gbc.pc(), 0xafa2);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xafa1), 0x3d);
        // 3D 030A
        gbc.setState(0xde56, 0x954f, 0xe210, 0xabb, 0x72b7, 0x736f, 0x1, 0x0);
        gbc.writeMem(0xde56, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xe1);
        EXPECT(gbc.b(),  0xa);
        EXPECT(gbc.c(),  0xbb);
        EXPECT(gbc.d(),  0x72);
        EXPECT(gbc.e(),  0xb7);
        EXPECT(gbc.h(),  0x73);
        EXPECT(gbc.l(),  0x6f);
        EXPECT(gbc.sp(), 0x954f);
        EXPECT(gbc.pc(), 0xde57);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xde56), 0x3d);
        // 3D 030B
        gbc.setState(0x257a, 0xe652, 0x49a0, 0x9900, 0x451, 0xf805, 0x1, 0x1);
        gbc.writeMem(0x257a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x48);
        EXPECT(gbc.b(),  0x99);
        EXPECT(gbc.c(),  0x0);
        EXPECT(gbc.d(),  0x4);
        EXPECT(gbc.e(),  0x51);
        EXPECT(gbc.h(),  0xf8);
        EXPECT(gbc.l(),  0x5);
        EXPECT(gbc.sp(), 0xe652);
        EXPECT(gbc.pc(), 0x257b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 030C
        gbc.setState(0xad49, 0x2c3f, 0xde60, 0x9f1f, 0xfd18, 0x8344, 0x1, 0x0);
        gbc.writeMem(0xad49, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xdd);
        EXPECT(gbc.b(),  0x9f);
        EXPECT(gbc.c(),  0x1f);
        EXPECT(gbc.d(),  0xfd);
        EXPECT(gbc.e(),  0x18);
        EXPECT(gbc.h(),  0x83);
        EXPECT(gbc.l(),  0x44);
        EXPECT(gbc.sp(), 0x2c3f);
        EXPECT(gbc.pc(), 0xad4a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xad49), 0x3d);
        // 3D 030D
        gbc.setState(0x7d18, 0xfb14, 0xde0, 0xff61, 0x1216, 0xbcda, 0x1, 0x1);
        gbc.writeMem(0x7d18, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xc);
        EXPECT(gbc.b(),  0xff);
        EXPECT(gbc.c(),  0x61);
        EXPECT(gbc.d(),  0x12);
        EXPECT(gbc.e(),  0x16);
        EXPECT(gbc.h(),  0xbc);
        EXPECT(gbc.l(),  0xda);
        EXPECT(gbc.sp(), 0xfb14);
        EXPECT(gbc.pc(), 0x7d19);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 030E
        gbc.setState(0xc815, 0x33a4, 0x3080, 0x3c94, 0x527c, 0x7d6f, 0x0, 0x0);
        gbc.writeMem(0xc815, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x2f);
        EXPECT(gbc.b(),  0x3c);
        EXPECT(gbc.c(),  0x94);
        EXPECT(gbc.d(),  0x52);
        EXPECT(gbc.e(),  0x7c);
        EXPECT(gbc.h(),  0x7d);
        EXPECT(gbc.l(),  0x6f);
        EXPECT(gbc.sp(), 0x33a4);
        EXPECT(gbc.pc(), 0xc816);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc815), 0x3d);
        // 3D 030F
        gbc.setState(0x3185, 0x314e, 0xcc30, 0x856f, 0x1427, 0x2bf4, 0x0, 0x0);
        gbc.writeMem(0x3185, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xcb);
        EXPECT(gbc.b(),  0x85);
        EXPECT(gbc.c(),  0x6f);
        EXPECT(gbc.d(),  0x14);
        EXPECT(gbc.e(),  0x27);
        EXPECT(gbc.h(),  0x2b);
        EXPECT(gbc.l(),  0xf4);
        EXPECT(gbc.sp(), 0x314e);
        EXPECT(gbc.pc(), 0x3186);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0310
        gbc.setState(0x6710, 0x8578, 0x2cb0, 0x7000, 0xab60, 0x3f3a, 0x1, 0x1);
        gbc.writeMem(0x6710, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x2b);
        EXPECT(gbc.b(),  0x70);
        EXPECT(gbc.c(),  0x0);
        EXPECT(gbc.d(),  0xab);
        EXPECT(gbc.e(),  0x60);
        EXPECT(gbc.h(),  0x3f);
        EXPECT(gbc.l(),  0x3a);
        EXPECT(gbc.sp(), 0x8578);
        EXPECT(gbc.pc(), 0x6711);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0311
        gbc.setState(0x3c6d, 0xd282, 0xd200, 0x4e78, 0x99a0, 0x8012, 0x0, 0x1);
        gbc.writeMem(0x3c6d, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xd1);
        EXPECT(gbc.b(),  0x4e);
        EXPECT(gbc.c(),  0x78);
        EXPECT(gbc.d(),  0x99);
        EXPECT(gbc.e(),  0xa0);
        EXPECT(gbc.h(),  0x80);
        EXPECT(gbc.l(),  0x12);
        EXPECT(gbc.sp(), 0xd282);
        EXPECT(gbc.pc(), 0x3c6e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0312
        gbc.setState(0xd7a7, 0xa89d, 0x8020, 0x2959, 0xb4cd, 0x955c, 0x0, 0x0);
        gbc.writeMem(0xd7a7, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x7f);
        EXPECT(gbc.b(),  0x29);
        EXPECT(gbc.c(),  0x59);
        EXPECT(gbc.d(),  0xb4);
        EXPECT(gbc.e(),  0xcd);
        EXPECT(gbc.h(),  0x95);
        EXPECT(gbc.l(),  0x5c);
        EXPECT(gbc.sp(), 0xa89d);
        EXPECT(gbc.pc(), 0xd7a8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd7a7), 0x3d);
        // 3D 0313
        gbc.setState(0x8dcb, 0x9848, 0x9980, 0x4d93, 0xef7c, 0xdfc6, 0x1, 0x0);
        gbc.writeMem(0x8dcb, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x98);
        EXPECT(gbc.b(),  0x4d);
        EXPECT(gbc.c(),  0x93);
        EXPECT(gbc.d(),  0xef);
        EXPECT(gbc.e(),  0x7c);
        EXPECT(gbc.h(),  0xdf);
        EXPECT(gbc.l(),  0xc6);
        EXPECT(gbc.sp(), 0x9848);
        EXPECT(gbc.pc(), 0x8dcc);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8dcb), 0x3d);
        // 3D 0314
        gbc.setState(0xa802, 0x6520, 0xf800, 0x10b2, 0x1743, 0x3425, 0x1, 0x0);
        gbc.writeMem(0xa802, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf7);
        EXPECT(gbc.b(),  0x10);
        EXPECT(gbc.c(),  0xb2);
        EXPECT(gbc.d(),  0x17);
        EXPECT(gbc.e(),  0x43);
        EXPECT(gbc.h(),  0x34);
        EXPECT(gbc.l(),  0x25);
        EXPECT(gbc.sp(), 0x6520);
        EXPECT(gbc.pc(), 0xa803);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa802), 0x3d);
        // 3D 0315
        gbc.setState(0x5259, 0xa526, 0x6e20, 0x774b, 0xa836, 0x5584, 0x1, 0x0);
        gbc.writeMem(0x5259, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x6d);
        EXPECT(gbc.b(),  0x77);
        EXPECT(gbc.c(),  0x4b);
        EXPECT(gbc.d(),  0xa8);
        EXPECT(gbc.e(),  0x36);
        EXPECT(gbc.h(),  0x55);
        EXPECT(gbc.l(),  0x84);
        EXPECT(gbc.sp(), 0xa526);
        EXPECT(gbc.pc(), 0x525a);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0316
        gbc.setState(0x9b5, 0xdf77, 0xa2e0, 0xb182, 0xb56c, 0x99c, 0x0, 0x0);
        gbc.writeMem(0x9b5, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa1);
        EXPECT(gbc.b(),  0xb1);
        EXPECT(gbc.c(),  0x82);
        EXPECT(gbc.d(),  0xb5);
        EXPECT(gbc.e(),  0x6c);
        EXPECT(gbc.h(),  0x9);
        EXPECT(gbc.l(),  0x9c);
        EXPECT(gbc.sp(), 0xdf77);
        EXPECT(gbc.pc(), 0x9b6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0317
        gbc.setState(0x2eab, 0x1c27, 0x7e90, 0x7c9a, 0x9175, 0x4cb0, 0x1, 0x0);
        gbc.writeMem(0x2eab, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x7d);
        EXPECT(gbc.b(),  0x7c);
        EXPECT(gbc.c(),  0x9a);
        EXPECT(gbc.d(),  0x91);
        EXPECT(gbc.e(),  0x75);
        EXPECT(gbc.h(),  0x4c);
        EXPECT(gbc.l(),  0xb0);
        EXPECT(gbc.sp(), 0x1c27);
        EXPECT(gbc.pc(), 0x2eac);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0318
        gbc.setState(0x43f8, 0xeb4c, 0xa9c0, 0x7f02, 0xab97, 0x10a, 0x0, 0x0);
        gbc.writeMem(0x43f8, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa8);
        EXPECT(gbc.b(),  0x7f);
        EXPECT(gbc.c(),  0x2);
        EXPECT(gbc.d(),  0xab);
        EXPECT(gbc.e(),  0x97);
        EXPECT(gbc.h(),  0x1);
        EXPECT(gbc.l(),  0xa);
        EXPECT(gbc.sp(), 0xeb4c);
        EXPECT(gbc.pc(), 0x43f9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 031A
        gbc.setState(0x9724, 0xf67d, 0x7d90, 0xd5e5, 0x76a3, 0x362e, 0x0, 0x1);
        gbc.writeMem(0x9724, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x7c);
        EXPECT(gbc.b(),  0xd5);
        EXPECT(gbc.c(),  0xe5);
        EXPECT(gbc.d(),  0x76);
        EXPECT(gbc.e(),  0xa3);
        EXPECT(gbc.h(),  0x36);
        EXPECT(gbc.l(),  0x2e);
        EXPECT(gbc.sp(), 0xf67d);
        EXPECT(gbc.pc(), 0x9725);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9724), 0x3d);
        // 3D 031B
        gbc.setState(0x6197, 0xc537, 0x2eb0, 0x3c1c, 0x2a9e, 0xd810, 0x1, 0x1);
        gbc.writeMem(0x6197, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x2d);
        EXPECT(gbc.b(),  0x3c);
        EXPECT(gbc.c(),  0x1c);
        EXPECT(gbc.d(),  0x2a);
        EXPECT(gbc.e(),  0x9e);
        EXPECT(gbc.h(),  0xd8);
        EXPECT(gbc.l(),  0x10);
        EXPECT(gbc.sp(), 0xc537);
        EXPECT(gbc.pc(), 0x6198);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 031C
        gbc.setState(0xdb9d, 0x7d27, 0x7ce0, 0x48cf, 0xd641, 0x9b9a, 0x1, 0x0);
        gbc.writeMem(0xdb9d, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x7b);
        EXPECT(gbc.b(),  0x48);
        EXPECT(gbc.c(),  0xcf);
        EXPECT(gbc.d(),  0xd6);
        EXPECT(gbc.e(),  0x41);
        EXPECT(gbc.h(),  0x9b);
        EXPECT(gbc.l(),  0x9a);
        EXPECT(gbc.sp(), 0x7d27);
        EXPECT(gbc.pc(), 0xdb9e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdb9d), 0x3d);
        // 3D 031D
        gbc.setState(0xecc4, 0xe1fb, 0x9e20, 0x3a93, 0x94be, 0xed61, 0x0, 0x1);
        gbc.writeMem(0xecc4, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x9d);
        EXPECT(gbc.b(),  0x3a);
        EXPECT(gbc.c(),  0x93);
        EXPECT(gbc.d(),  0x94);
        EXPECT(gbc.e(),  0xbe);
        EXPECT(gbc.h(),  0xed);
        EXPECT(gbc.l(),  0x61);
        EXPECT(gbc.sp(), 0xe1fb);
        EXPECT(gbc.pc(), 0xecc5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xecc4), 0x3d);
        // 3D 031F
        gbc.setState(0xd0cf, 0x6a3e, 0x370, 0x72bc, 0x6194, 0x3835, 0x1, 0x0);
        gbc.writeMem(0xd0cf, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x2);
        EXPECT(gbc.b(),  0x72);
        EXPECT(gbc.c(),  0xbc);
        EXPECT(gbc.d(),  0x61);
        EXPECT(gbc.e(),  0x94);
        EXPECT(gbc.h(),  0x38);
        EXPECT(gbc.l(),  0x35);
        EXPECT(gbc.sp(), 0x6a3e);
        EXPECT(gbc.pc(), 0xd0d0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd0cf), 0x3d);
        // 3D 0320
        gbc.setState(0x8ea5, 0x2bc6, 0xaa40, 0xdf1b, 0xb64d, 0xa355, 0x0, 0x0);
        gbc.writeMem(0x8ea5, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa9);
        EXPECT(gbc.b(),  0xdf);
        EXPECT(gbc.c(),  0x1b);
        EXPECT(gbc.d(),  0xb6);
        EXPECT(gbc.e(),  0x4d);
        EXPECT(gbc.h(),  0xa3);
        EXPECT(gbc.l(),  0x55);
        EXPECT(gbc.sp(), 0x2bc6);
        EXPECT(gbc.pc(), 0x8ea6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8ea5), 0x3d);
        // 3D 0321
        gbc.setState(0x1718, 0x8b73, 0x6de0, 0xa1a4, 0xb7c5, 0xab0c, 0x1, 0x0);
        gbc.writeMem(0x1718, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x6c);
        EXPECT(gbc.b(),  0xa1);
        EXPECT(gbc.c(),  0xa4);
        EXPECT(gbc.d(),  0xb7);
        EXPECT(gbc.e(),  0xc5);
        EXPECT(gbc.h(),  0xab);
        EXPECT(gbc.l(),  0xc);
        EXPECT(gbc.sp(), 0x8b73);
        EXPECT(gbc.pc(), 0x1719);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0322
        gbc.setState(0x58ee, 0x2820, 0xb540, 0xac3c, 0x8950, 0xa748, 0x1, 0x1);
        gbc.writeMem(0x58ee, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xb4);
        EXPECT(gbc.b(),  0xac);
        EXPECT(gbc.c(),  0x3c);
        EXPECT(gbc.d(),  0x89);
        EXPECT(gbc.e(),  0x50);
        EXPECT(gbc.h(),  0xa7);
        EXPECT(gbc.l(),  0x48);
        EXPECT(gbc.sp(), 0x2820);
        EXPECT(gbc.pc(), 0x58ef);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0323
        gbc.setState(0x47f3, 0xb49b, 0x7960, 0x4adc, 0xf2f3, 0xa0ae, 0x1, 0x0);
        gbc.writeMem(0x47f3, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x78);
        EXPECT(gbc.b(),  0x4a);
        EXPECT(gbc.c(),  0xdc);
        EXPECT(gbc.d(),  0xf2);
        EXPECT(gbc.e(),  0xf3);
        EXPECT(gbc.h(),  0xa0);
        EXPECT(gbc.l(),  0xae);
        EXPECT(gbc.sp(), 0xb49b);
        EXPECT(gbc.pc(), 0x47f4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0324
        gbc.setState(0x4591, 0xdfff, 0x7180, 0x929b, 0x3923, 0xd21a, 0x1, 0x1);
        gbc.writeMem(0x4591, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x70);
        EXPECT(gbc.b(),  0x92);
        EXPECT(gbc.c(),  0x9b);
        EXPECT(gbc.d(),  0x39);
        EXPECT(gbc.e(),  0x23);
        EXPECT(gbc.h(),  0xd2);
        EXPECT(gbc.l(),  0x1a);
        EXPECT(gbc.sp(), 0xdfff);
        EXPECT(gbc.pc(), 0x4592);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0325
        gbc.setState(0x24cb, 0x29f0, 0xce90, 0x3453, 0x9ac4, 0x56d1, 0x0, 0x1);
        gbc.writeMem(0x24cb, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xcd);
        EXPECT(gbc.b(),  0x34);
        EXPECT(gbc.c(),  0x53);
        EXPECT(gbc.d(),  0x9a);
        EXPECT(gbc.e(),  0xc4);
        EXPECT(gbc.h(),  0x56);
        EXPECT(gbc.l(),  0xd1);
        EXPECT(gbc.sp(), 0x29f0);
        EXPECT(gbc.pc(), 0x24cc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0326
        gbc.setState(0xde1c, 0x4c5, 0xb8b0, 0xce5c, 0xfe0d, 0xc514, 0x0, 0x0);
        gbc.writeMem(0xde1c, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xb7);
        EXPECT(gbc.b(),  0xce);
        EXPECT(gbc.c(),  0x5c);
        EXPECT(gbc.d(),  0xfe);
        EXPECT(gbc.e(),  0xd);
        EXPECT(gbc.h(),  0xc5);
        EXPECT(gbc.l(),  0x14);
        EXPECT(gbc.sp(), 0x4c5);
        EXPECT(gbc.pc(), 0xde1d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xde1c), 0x3d);
        // 3D 0327
        gbc.setState(0x1781, 0xdeb7, 0x6220, 0xa2e6, 0xd6d8, 0xb353, 0x0, 0x0);
        gbc.writeMem(0x1781, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x61);
        EXPECT(gbc.b(),  0xa2);
        EXPECT(gbc.c(),  0xe6);
        EXPECT(gbc.d(),  0xd6);
        EXPECT(gbc.e(),  0xd8);
        EXPECT(gbc.h(),  0xb3);
        EXPECT(gbc.l(),  0x53);
        EXPECT(gbc.sp(), 0xdeb7);
        EXPECT(gbc.pc(), 0x1782);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0328
        gbc.setState(0x97d4, 0xa10e, 0xddb0, 0xd80b, 0x1fe6, 0x9d0e, 0x1, 0x0);
        gbc.writeMem(0x97d4, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xdc);
        EXPECT(gbc.b(),  0xd8);
        EXPECT(gbc.c(),  0xb);
        EXPECT(gbc.d(),  0x1f);
        EXPECT(gbc.e(),  0xe6);
        EXPECT(gbc.h(),  0x9d);
        EXPECT(gbc.l(),  0xe);
        EXPECT(gbc.sp(), 0xa10e);
        EXPECT(gbc.pc(), 0x97d5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x97d4), 0x3d);
        // 3D 0329
        gbc.setState(0xab38, 0x797b, 0xff0, 0x34c4, 0x4919, 0x3b4c, 0x1, 0x1);
        gbc.writeMem(0xab38, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xe);
        EXPECT(gbc.b(),  0x34);
        EXPECT(gbc.c(),  0xc4);
        EXPECT(gbc.d(),  0x49);
        EXPECT(gbc.e(),  0x19);
        EXPECT(gbc.h(),  0x3b);
        EXPECT(gbc.l(),  0x4c);
        EXPECT(gbc.sp(), 0x797b);
        EXPECT(gbc.pc(), 0xab39);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xab38), 0x3d);
        // 3D 032A
        gbc.setState(0xbe81, 0x9f87, 0x8730, 0x532c, 0xcb40, 0x9b8d, 0x0, 0x1);
        gbc.writeMem(0xbe81, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x86);
        EXPECT(gbc.b(),  0x53);
        EXPECT(gbc.c(),  0x2c);
        EXPECT(gbc.d(),  0xcb);
        EXPECT(gbc.e(),  0x40);
        EXPECT(gbc.h(),  0x9b);
        EXPECT(gbc.l(),  0x8d);
        EXPECT(gbc.sp(), 0x9f87);
        EXPECT(gbc.pc(), 0xbe82);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbe81), 0x3d);
        // 3D 032B
        gbc.setState(0x1ec0, 0xcfff, 0x8a50, 0xbaf5, 0xb8a7, 0x1dfa, 0x0, 0x1);
        gbc.writeMem(0x1ec0, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x89);
        EXPECT(gbc.b(),  0xba);
        EXPECT(gbc.c(),  0xf5);
        EXPECT(gbc.d(),  0xb8);
        EXPECT(gbc.e(),  0xa7);
        EXPECT(gbc.h(),  0x1d);
        EXPECT(gbc.l(),  0xfa);
        EXPECT(gbc.sp(), 0xcfff);
        EXPECT(gbc.pc(), 0x1ec1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 032C
        gbc.setState(0xc25, 0xc766, 0x4640, 0xb522, 0xe269, 0xa36b, 0x0, 0x1);
        gbc.writeMem(0xc25, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x45);
        EXPECT(gbc.b(),  0xb5);
        EXPECT(gbc.c(),  0x22);
        EXPECT(gbc.d(),  0xe2);
        EXPECT(gbc.e(),  0x69);
        EXPECT(gbc.h(),  0xa3);
        EXPECT(gbc.l(),  0x6b);
        EXPECT(gbc.sp(), 0xc766);
        EXPECT(gbc.pc(), 0xc26);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 032D
        gbc.setState(0xadba, 0x7c63, 0x9140, 0x71a2, 0xec3c, 0xc184, 0x0, 0x1);
        gbc.writeMem(0xadba, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x90);
        EXPECT(gbc.b(),  0x71);
        EXPECT(gbc.c(),  0xa2);
        EXPECT(gbc.d(),  0xec);
        EXPECT(gbc.e(),  0x3c);
        EXPECT(gbc.h(),  0xc1);
        EXPECT(gbc.l(),  0x84);
        EXPECT(gbc.sp(), 0x7c63);
        EXPECT(gbc.pc(), 0xadbb);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xadba), 0x3d);
        // 3D 032F
        gbc.setState(0x6f80, 0xa892, 0xc2e0, 0x3adb, 0x1082, 0x1e58, 0x0, 0x0);
        gbc.writeMem(0x6f80, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xc1);
        EXPECT(gbc.b(),  0x3a);
        EXPECT(gbc.c(),  0xdb);
        EXPECT(gbc.d(),  0x10);
        EXPECT(gbc.e(),  0x82);
        EXPECT(gbc.h(),  0x1e);
        EXPECT(gbc.l(),  0x58);
        EXPECT(gbc.sp(), 0xa892);
        EXPECT(gbc.pc(), 0x6f81);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0330
        gbc.setState(0x9ea1, 0xa961, 0x1a60, 0x6599, 0x31e6, 0xe42e, 0x0, 0x1);
        gbc.writeMem(0x9ea1, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x19);
        EXPECT(gbc.b(),  0x65);
        EXPECT(gbc.c(),  0x99);
        EXPECT(gbc.d(),  0x31);
        EXPECT(gbc.e(),  0xe6);
        EXPECT(gbc.h(),  0xe4);
        EXPECT(gbc.l(),  0x2e);
        EXPECT(gbc.sp(), 0xa961);
        EXPECT(gbc.pc(), 0x9ea2);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9ea1), 0x3d);
        // 3D 0331
        gbc.setState(0xc17e, 0xc19a, 0xea70, 0xd954, 0x3f79, 0x6881, 0x1, 0x0);
        gbc.writeMem(0xc17e, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xe9);
        EXPECT(gbc.b(),  0xd9);
        EXPECT(gbc.c(),  0x54);
        EXPECT(gbc.d(),  0x3f);
        EXPECT(gbc.e(),  0x79);
        EXPECT(gbc.h(),  0x68);
        EXPECT(gbc.l(),  0x81);
        EXPECT(gbc.sp(), 0xc19a);
        EXPECT(gbc.pc(), 0xc17f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc17e), 0x3d);
        // 3D 0332
        gbc.setState(0x4576, 0xda0c, 0x5a30, 0x5c11, 0x4991, 0x2bf4, 0x1, 0x0);
        gbc.writeMem(0x4576, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x59);
        EXPECT(gbc.b(),  0x5c);
        EXPECT(gbc.c(),  0x11);
        EXPECT(gbc.d(),  0x49);
        EXPECT(gbc.e(),  0x91);
        EXPECT(gbc.h(),  0x2b);
        EXPECT(gbc.l(),  0xf4);
        EXPECT(gbc.sp(), 0xda0c);
        EXPECT(gbc.pc(), 0x4577);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0334
        gbc.setState(0x258b, 0x81ba, 0x580, 0x5840, 0x782, 0x8009, 0x1, 0x1);
        gbc.writeMem(0x258b, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0x58);
        EXPECT(gbc.c(),  0x40);
        EXPECT(gbc.d(),  0x7);
        EXPECT(gbc.e(),  0x82);
        EXPECT(gbc.h(),  0x80);
        EXPECT(gbc.l(),  0x9);
        EXPECT(gbc.sp(), 0x81ba);
        EXPECT(gbc.pc(), 0x258c);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0335
        gbc.setState(0x2923, 0x21d9, 0x4580, 0x9c33, 0xfee3, 0xa95e, 0x0, 0x1);
        gbc.writeMem(0x2923, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x44);
        EXPECT(gbc.b(),  0x9c);
        EXPECT(gbc.c(),  0x33);
        EXPECT(gbc.d(),  0xfe);
        EXPECT(gbc.e(),  0xe3);
        EXPECT(gbc.h(),  0xa9);
        EXPECT(gbc.l(),  0x5e);
        EXPECT(gbc.sp(), 0x21d9);
        EXPECT(gbc.pc(), 0x2924);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0336
        gbc.setState(0x31c4, 0x60a7, 0x8490, 0xb641, 0x55e5, 0x86e1, 0x1, 0x0);
        gbc.writeMem(0x31c4, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x83);
        EXPECT(gbc.b(),  0xb6);
        EXPECT(gbc.c(),  0x41);
        EXPECT(gbc.d(),  0x55);
        EXPECT(gbc.e(),  0xe5);
        EXPECT(gbc.h(),  0x86);
        EXPECT(gbc.l(),  0xe1);
        EXPECT(gbc.sp(), 0x60a7);
        EXPECT(gbc.pc(), 0x31c5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0337
        gbc.setState(0x3e1f, 0x18b7, 0x7260, 0x611a, 0xcdb, 0xe174, 0x0, 0x0);
        gbc.writeMem(0x3e1f, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x71);
        EXPECT(gbc.b(),  0x61);
        EXPECT(gbc.c(),  0x1a);
        EXPECT(gbc.d(),  0xc);
        EXPECT(gbc.e(),  0xdb);
        EXPECT(gbc.h(),  0xe1);
        EXPECT(gbc.l(),  0x74);
        EXPECT(gbc.sp(), 0x18b7);
        EXPECT(gbc.pc(), 0x3e20);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0338
        gbc.setState(0x71a6, 0xa79a, 0xf3c0, 0xbf81, 0x5fc7, 0x4683, 0x0, 0x1);
        gbc.writeMem(0x71a6, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf2);
        EXPECT(gbc.b(),  0xbf);
        EXPECT(gbc.c(),  0x81);
        EXPECT(gbc.d(),  0x5f);
        EXPECT(gbc.e(),  0xc7);
        EXPECT(gbc.h(),  0x46);
        EXPECT(gbc.l(),  0x83);
        EXPECT(gbc.sp(), 0xa79a);
        EXPECT(gbc.pc(), 0x71a7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0339
        gbc.setState(0x58f1, 0xde57, 0x3740, 0xed00, 0x3922, 0xa57, 0x0, 0x1);
        gbc.writeMem(0x58f1, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x36);
        EXPECT(gbc.b(),  0xed);
        EXPECT(gbc.c(),  0x0);
        EXPECT(gbc.d(),  0x39);
        EXPECT(gbc.e(),  0x22);
        EXPECT(gbc.h(),  0xa);
        EXPECT(gbc.l(),  0x57);
        EXPECT(gbc.sp(), 0xde57);
        EXPECT(gbc.pc(), 0x58f2);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 033A
        gbc.setState(0xf72, 0x4636, 0x5750, 0x58fc, 0xe3b, 0x395d, 0x0, 0x1);
        gbc.writeMem(0xf72, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x56);
        EXPECT(gbc.b(),  0x58);
        EXPECT(gbc.c(),  0xfc);
        EXPECT(gbc.d(),  0xe);
        EXPECT(gbc.e(),  0x3b);
        EXPECT(gbc.h(),  0x39);
        EXPECT(gbc.l(),  0x5d);
        EXPECT(gbc.sp(), 0x4636);
        EXPECT(gbc.pc(), 0xf73);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 033B
        gbc.setState(0x1a18, 0xf01e, 0x3250, 0x15fb, 0xbe36, 0x28ab, 0x0, 0x1);
        gbc.writeMem(0x1a18, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x31);
        EXPECT(gbc.b(),  0x15);
        EXPECT(gbc.c(),  0xfb);
        EXPECT(gbc.d(),  0xbe);
        EXPECT(gbc.e(),  0x36);
        EXPECT(gbc.h(),  0x28);
        EXPECT(gbc.l(),  0xab);
        EXPECT(gbc.sp(), 0xf01e);
        EXPECT(gbc.pc(), 0x1a19);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 033C
        gbc.setState(0x52f4, 0x9888, 0x75a0, 0x87f1, 0x65cf, 0x9c29, 0x1, 0x1);
        gbc.writeMem(0x52f4, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x74);
        EXPECT(gbc.b(),  0x87);
        EXPECT(gbc.c(),  0xf1);
        EXPECT(gbc.d(),  0x65);
        EXPECT(gbc.e(),  0xcf);
        EXPECT(gbc.h(),  0x9c);
        EXPECT(gbc.l(),  0x29);
        EXPECT(gbc.sp(), 0x9888);
        EXPECT(gbc.pc(), 0x52f5);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 033D
        gbc.setState(0x518b, 0xc478, 0x7940, 0xf4ba, 0x4ed5, 0x9fa5, 0x0, 0x0);
        gbc.writeMem(0x518b, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x78);
        EXPECT(gbc.b(),  0xf4);
        EXPECT(gbc.c(),  0xba);
        EXPECT(gbc.d(),  0x4e);
        EXPECT(gbc.e(),  0xd5);
        EXPECT(gbc.h(),  0x9f);
        EXPECT(gbc.l(),  0xa5);
        EXPECT(gbc.sp(), 0xc478);
        EXPECT(gbc.pc(), 0x518c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 033E
        gbc.setState(0x8b75, 0x9ad3, 0x8dd0, 0xacf7, 0xbc78, 0xd917, 0x1, 0x0);
        gbc.writeMem(0x8b75, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x8c);
        EXPECT(gbc.b(),  0xac);
        EXPECT(gbc.c(),  0xf7);
        EXPECT(gbc.d(),  0xbc);
        EXPECT(gbc.e(),  0x78);
        EXPECT(gbc.h(),  0xd9);
        EXPECT(gbc.l(),  0x17);
        EXPECT(gbc.sp(), 0x9ad3);
        EXPECT(gbc.pc(), 0x8b76);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8b75), 0x3d);
        // 3D 033F
        gbc.setState(0x1ff6, 0x3b27, 0x1860, 0x78ec, 0x8980, 0x7243, 0x0, 0x0);
        gbc.writeMem(0x1ff6, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x17);
        EXPECT(gbc.b(),  0x78);
        EXPECT(gbc.c(),  0xec);
        EXPECT(gbc.d(),  0x89);
        EXPECT(gbc.e(),  0x80);
        EXPECT(gbc.h(),  0x72);
        EXPECT(gbc.l(),  0x43);
        EXPECT(gbc.sp(), 0x3b27);
        EXPECT(gbc.pc(), 0x1ff7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0340
        gbc.setState(0xa043, 0x5381, 0x74f0, 0x3e30, 0x9a82, 0xa112, 0x1, 0x0);
        gbc.writeMem(0xa043, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x73);
        EXPECT(gbc.b(),  0x3e);
        EXPECT(gbc.c(),  0x30);
        EXPECT(gbc.d(),  0x9a);
        EXPECT(gbc.e(),  0x82);
        EXPECT(gbc.h(),  0xa1);
        EXPECT(gbc.l(),  0x12);
        EXPECT(gbc.sp(), 0x5381);
        EXPECT(gbc.pc(), 0xa044);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa043), 0x3d);
        // 3D 0341
        gbc.setState(0xa1d1, 0xa98a, 0x4e00, 0x8dae, 0xb638, 0x540e, 0x0, 0x0);
        gbc.writeMem(0xa1d1, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x4d);
        EXPECT(gbc.b(),  0x8d);
        EXPECT(gbc.c(),  0xae);
        EXPECT(gbc.d(),  0xb6);
        EXPECT(gbc.e(),  0x38);
        EXPECT(gbc.h(),  0x54);
        EXPECT(gbc.l(),  0xe);
        EXPECT(gbc.sp(), 0xa98a);
        EXPECT(gbc.pc(), 0xa1d2);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa1d1), 0x3d);
        // 3D 0342
        gbc.setState(0xcac6, 0x7e29, 0x2e0, 0x7c76, 0xe1cb, 0x5137, 0x0, 0x1);
        gbc.writeMem(0xcac6, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0x7c);
        EXPECT(gbc.c(),  0x76);
        EXPECT(gbc.d(),  0xe1);
        EXPECT(gbc.e(),  0xcb);
        EXPECT(gbc.h(),  0x51);
        EXPECT(gbc.l(),  0x37);
        EXPECT(gbc.sp(), 0x7e29);
        EXPECT(gbc.pc(), 0xcac7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xcac6), 0x3d);
        // 3D 0343
        gbc.setState(0xb8a9, 0x51c3, 0x9940, 0x8630, 0x6f8a, 0x6d0, 0x0, 0x1);
        gbc.writeMem(0xb8a9, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x98);
        EXPECT(gbc.b(),  0x86);
        EXPECT(gbc.c(),  0x30);
        EXPECT(gbc.d(),  0x6f);
        EXPECT(gbc.e(),  0x8a);
        EXPECT(gbc.h(),  0x6);
        EXPECT(gbc.l(),  0xd0);
        EXPECT(gbc.sp(), 0x51c3);
        EXPECT(gbc.pc(), 0xb8aa);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb8a9), 0x3d);
        // 3D 0344
        gbc.setState(0x8836, 0x8688, 0x5b30, 0xfce9, 0x383f, 0x8fce, 0x0, 0x1);
        gbc.writeMem(0x8836, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x5a);
        EXPECT(gbc.b(),  0xfc);
        EXPECT(gbc.c(),  0xe9);
        EXPECT(gbc.d(),  0x38);
        EXPECT(gbc.e(),  0x3f);
        EXPECT(gbc.h(),  0x8f);
        EXPECT(gbc.l(),  0xce);
        EXPECT(gbc.sp(), 0x8688);
        EXPECT(gbc.pc(), 0x8837);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8836), 0x3d);
        // 3D 0345
        gbc.setState(0x3535, 0x33b3, 0x66a0, 0xbe94, 0x2f1d, 0x7ac, 0x1, 0x1);
        gbc.writeMem(0x3535, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x65);
        EXPECT(gbc.b(),  0xbe);
        EXPECT(gbc.c(),  0x94);
        EXPECT(gbc.d(),  0x2f);
        EXPECT(gbc.e(),  0x1d);
        EXPECT(gbc.h(),  0x7);
        EXPECT(gbc.l(),  0xac);
        EXPECT(gbc.sp(), 0x33b3);
        EXPECT(gbc.pc(), 0x3536);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0346
        gbc.setState(0x53d7, 0x590b, 0x9c90, 0xfaef, 0xab63, 0x93d8, 0x0, 0x1);
        gbc.writeMem(0x53d7, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x9b);
        EXPECT(gbc.b(),  0xfa);
        EXPECT(gbc.c(),  0xef);
        EXPECT(gbc.d(),  0xab);
        EXPECT(gbc.e(),  0x63);
        EXPECT(gbc.h(),  0x93);
        EXPECT(gbc.l(),  0xd8);
        EXPECT(gbc.sp(), 0x590b);
        EXPECT(gbc.pc(), 0x53d8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0347
        gbc.setState(0x98b6, 0x855, 0x61e0, 0x8017, 0x434a, 0x5f58, 0x1, 0x0);
        gbc.writeMem(0x98b6, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x60);
        EXPECT(gbc.b(),  0x80);
        EXPECT(gbc.c(),  0x17);
        EXPECT(gbc.d(),  0x43);
        EXPECT(gbc.e(),  0x4a);
        EXPECT(gbc.h(),  0x5f);
        EXPECT(gbc.l(),  0x58);
        EXPECT(gbc.sp(), 0x855);
        EXPECT(gbc.pc(), 0x98b7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x98b6), 0x3d);
        // 3D 0348
        gbc.setState(0x4333, 0x9a40, 0x7da0, 0x8e9a, 0xf8df, 0xb56b, 0x0, 0x1);
        gbc.writeMem(0x4333, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x7c);
        EXPECT(gbc.b(),  0x8e);
        EXPECT(gbc.c(),  0x9a);
        EXPECT(gbc.d(),  0xf8);
        EXPECT(gbc.e(),  0xdf);
        EXPECT(gbc.h(),  0xb5);
        EXPECT(gbc.l(),  0x6b);
        EXPECT(gbc.sp(), 0x9a40);
        EXPECT(gbc.pc(), 0x4334);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0349
        gbc.setState(0xc0fe, 0x312e, 0x500, 0xcd9, 0x49d0, 0x7186, 0x1, 0x0);
        gbc.writeMem(0xc0fe, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x4);
        EXPECT(gbc.b(),  0xc);
        EXPECT(gbc.c(),  0xd9);
        EXPECT(gbc.d(),  0x49);
        EXPECT(gbc.e(),  0xd0);
        EXPECT(gbc.h(),  0x71);
        EXPECT(gbc.l(),  0x86);
        EXPECT(gbc.sp(), 0x312e);
        EXPECT(gbc.pc(), 0xc0ff);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc0fe), 0x3d);
        // 3D 034A
        gbc.setState(0xbc30, 0x8023, 0xba10, 0x5446, 0x6314, 0x9157, 0x0, 0x0);
        gbc.writeMem(0xbc30, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xb9);
        EXPECT(gbc.b(),  0x54);
        EXPECT(gbc.c(),  0x46);
        EXPECT(gbc.d(),  0x63);
        EXPECT(gbc.e(),  0x14);
        EXPECT(gbc.h(),  0x91);
        EXPECT(gbc.l(),  0x57);
        EXPECT(gbc.sp(), 0x8023);
        EXPECT(gbc.pc(), 0xbc31);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbc30), 0x3d);
        // 3D 034C
        gbc.setState(0xe4d2, 0xf6a8, 0x9a0, 0xd8, 0xcfed, 0xdfef, 0x1, 0x1);
        gbc.writeMem(0xe4d2, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x8);
        EXPECT(gbc.b(),  0x0);
        EXPECT(gbc.c(),  0xd8);
        EXPECT(gbc.d(),  0xcf);
        EXPECT(gbc.e(),  0xed);
        EXPECT(gbc.h(),  0xdf);
        EXPECT(gbc.l(),  0xef);
        EXPECT(gbc.sp(), 0xf6a8);
        EXPECT(gbc.pc(), 0xe4d3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe4d2), 0x3d);
        // 3D 034D
        gbc.setState(0x6036, 0x2cbf, 0x8190, 0x57fc, 0x4c87, 0x3980, 0x1, 0x0);
        gbc.writeMem(0x6036, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0x57);
        EXPECT(gbc.c(),  0xfc);
        EXPECT(gbc.d(),  0x4c);
        EXPECT(gbc.e(),  0x87);
        EXPECT(gbc.h(),  0x39);
        EXPECT(gbc.l(),  0x80);
        EXPECT(gbc.sp(), 0x2cbf);
        EXPECT(gbc.pc(), 0x6037);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 034E
        gbc.setState(0xedb1, 0xac5, 0x2450, 0x468f, 0xcbd7, 0x81be, 0x1, 0x1);
        gbc.writeMem(0xedb1, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x23);
        EXPECT(gbc.b(),  0x46);
        EXPECT(gbc.c(),  0x8f);
        EXPECT(gbc.d(),  0xcb);
        EXPECT(gbc.e(),  0xd7);
        EXPECT(gbc.h(),  0x81);
        EXPECT(gbc.l(),  0xbe);
        EXPECT(gbc.sp(), 0xac5);
        EXPECT(gbc.pc(), 0xedb2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xedb1), 0x3d);
        // 3D 034F
        gbc.setState(0x3d51, 0xe6b8, 0xb230, 0x3572, 0x12d8, 0x93c0, 0x0, 0x1);
        gbc.writeMem(0x3d51, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xb1);
        EXPECT(gbc.b(),  0x35);
        EXPECT(gbc.c(),  0x72);
        EXPECT(gbc.d(),  0x12);
        EXPECT(gbc.e(),  0xd8);
        EXPECT(gbc.h(),  0x93);
        EXPECT(gbc.l(),  0xc0);
        EXPECT(gbc.sp(), 0xe6b8);
        EXPECT(gbc.pc(), 0x3d52);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0350
        gbc.setState(0xdccb, 0xe98b, 0x9760, 0x8870, 0x321, 0x2713, 0x0, 0x1);
        gbc.writeMem(0xdccb, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x96);
        EXPECT(gbc.b(),  0x88);
        EXPECT(gbc.c(),  0x70);
        EXPECT(gbc.d(),  0x3);
        EXPECT(gbc.e(),  0x21);
        EXPECT(gbc.h(),  0x27);
        EXPECT(gbc.l(),  0x13);
        EXPECT(gbc.sp(), 0xe98b);
        EXPECT(gbc.pc(), 0xdccc);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdccb), 0x3d);
        // 3D 0351
        gbc.setState(0x3c4f, 0xe70e, 0x3290, 0xe2f2, 0x9572, 0x368c, 0x0, 0x1);
        gbc.writeMem(0x3c4f, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x31);
        EXPECT(gbc.b(),  0xe2);
        EXPECT(gbc.c(),  0xf2);
        EXPECT(gbc.d(),  0x95);
        EXPECT(gbc.e(),  0x72);
        EXPECT(gbc.h(),  0x36);
        EXPECT(gbc.l(),  0x8c);
        EXPECT(gbc.sp(), 0xe70e);
        EXPECT(gbc.pc(), 0x3c50);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0352
        gbc.setState(0x27e1, 0x9428, 0x3280, 0xf0d8, 0xd976, 0x376e, 0x1, 0x1);
        gbc.writeMem(0x27e1, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x31);
        EXPECT(gbc.b(),  0xf0);
        EXPECT(gbc.c(),  0xd8);
        EXPECT(gbc.d(),  0xd9);
        EXPECT(gbc.e(),  0x76);
        EXPECT(gbc.h(),  0x37);
        EXPECT(gbc.l(),  0x6e);
        EXPECT(gbc.sp(), 0x9428);
        EXPECT(gbc.pc(), 0x27e2);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0353
        gbc.setState(0x8f6e, 0xa579, 0x6250, 0x251f, 0xff55, 0xc53a, 0x0, 0x0);
        gbc.writeMem(0x8f6e, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x61);
        EXPECT(gbc.b(),  0x25);
        EXPECT(gbc.c(),  0x1f);
        EXPECT(gbc.d(),  0xff);
        EXPECT(gbc.e(),  0x55);
        EXPECT(gbc.h(),  0xc5);
        EXPECT(gbc.l(),  0x3a);
        EXPECT(gbc.sp(), 0xa579);
        EXPECT(gbc.pc(), 0x8f6f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8f6e), 0x3d);
        // 3D 0354
        gbc.setState(0x6d7d, 0x352a, 0xc800, 0xf7be, 0xe582, 0x3a07, 0x0, 0x1);
        gbc.writeMem(0x6d7d, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xc7);
        EXPECT(gbc.b(),  0xf7);
        EXPECT(gbc.c(),  0xbe);
        EXPECT(gbc.d(),  0xe5);
        EXPECT(gbc.e(),  0x82);
        EXPECT(gbc.h(),  0x3a);
        EXPECT(gbc.l(),  0x7);
        EXPECT(gbc.sp(), 0x352a);
        EXPECT(gbc.pc(), 0x6d7e);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0355
        gbc.setState(0x7aa, 0x6dcc, 0xec80, 0x4c5c, 0xb02b, 0xeaac, 0x0, 0x0);
        gbc.writeMem(0x7aa, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xeb);
        EXPECT(gbc.b(),  0x4c);
        EXPECT(gbc.c(),  0x5c);
        EXPECT(gbc.d(),  0xb0);
        EXPECT(gbc.e(),  0x2b);
        EXPECT(gbc.h(),  0xea);
        EXPECT(gbc.l(),  0xac);
        EXPECT(gbc.sp(), 0x6dcc);
        EXPECT(gbc.pc(), 0x7ab);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0356
        gbc.setState(0xccd0, 0x4726, 0x9390, 0x3a01, 0xe27e, 0x792d, 0x1, 0x1);
        gbc.writeMem(0xccd0, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x92);
        EXPECT(gbc.b(),  0x3a);
        EXPECT(gbc.c(),  0x1);
        EXPECT(gbc.d(),  0xe2);
        EXPECT(gbc.e(),  0x7e);
        EXPECT(gbc.h(),  0x79);
        EXPECT(gbc.l(),  0x2d);
        EXPECT(gbc.sp(), 0x4726);
        EXPECT(gbc.pc(), 0xccd1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xccd0), 0x3d);
        // 3D 0357
        gbc.setState(0x8aa3, 0xf1f3, 0x7010, 0xb8dc, 0x8613, 0x62f3, 0x1, 0x0);
        gbc.writeMem(0x8aa3, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x6f);
        EXPECT(gbc.b(),  0xb8);
        EXPECT(gbc.c(),  0xdc);
        EXPECT(gbc.d(),  0x86);
        EXPECT(gbc.e(),  0x13);
        EXPECT(gbc.h(),  0x62);
        EXPECT(gbc.l(),  0xf3);
        EXPECT(gbc.sp(), 0xf1f3);
        EXPECT(gbc.pc(), 0x8aa4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8aa3), 0x3d);
        // 3D 0358
        gbc.setState(0xee2a, 0x181d, 0x7b60, 0xf7ab, 0xe412, 0x86f6, 0x0, 0x0);
        gbc.writeMem(0xee2a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x7a);
        EXPECT(gbc.b(),  0xf7);
        EXPECT(gbc.c(),  0xab);
        EXPECT(gbc.d(),  0xe4);
        EXPECT(gbc.e(),  0x12);
        EXPECT(gbc.h(),  0x86);
        EXPECT(gbc.l(),  0xf6);
        EXPECT(gbc.sp(), 0x181d);
        EXPECT(gbc.pc(), 0xee2b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xee2a), 0x3d);
        // 3D 0359
        gbc.setState(0x1e00, 0xd5d8, 0x4050, 0xeb6e, 0x426a, 0x6474, 0x1, 0x0);
        gbc.writeMem(0x1e00, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x3f);
        EXPECT(gbc.b(),  0xeb);
        EXPECT(gbc.c(),  0x6e);
        EXPECT(gbc.d(),  0x42);
        EXPECT(gbc.e(),  0x6a);
        EXPECT(gbc.h(),  0x64);
        EXPECT(gbc.l(),  0x74);
        EXPECT(gbc.sp(), 0xd5d8);
        EXPECT(gbc.pc(), 0x1e01);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        // 3D 035A
        gbc.setState(0x31f5, 0x1ac9, 0xef20, 0x17e9, 0x760e, 0xf175, 0x0, 0x0);
        gbc.writeMem(0x31f5, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xee);
        EXPECT(gbc.b(),  0x17);
        EXPECT(gbc.c(),  0xe9);
        EXPECT(gbc.d(),  0x76);
        EXPECT(gbc.e(),  0xe);
        EXPECT(gbc.h(),  0xf1);
        EXPECT(gbc.l(),  0x75);
        EXPECT(gbc.sp(), 0x1ac9);
        EXPECT(gbc.pc(), 0x31f6);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 035B
        gbc.setState(0xb12c, 0xcebc, 0x7ba0, 0x7290, 0x16f3, 0x277b, 0x1, 0x0);
        gbc.writeMem(0xb12c, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x7a);
        EXPECT(gbc.b(),  0x72);
        EXPECT(gbc.c(),  0x90);
        EXPECT(gbc.d(),  0x16);
        EXPECT(gbc.e(),  0xf3);
        EXPECT(gbc.h(),  0x27);
        EXPECT(gbc.l(),  0x7b);
        EXPECT(gbc.sp(), 0xcebc);
        EXPECT(gbc.pc(), 0xb12d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb12c), 0x3d);
        // 3D 035C
        gbc.setState(0xbda3, 0x37ed, 0xb4b0, 0x2e10, 0x2102, 0x9748, 0x1, 0x0);
        gbc.writeMem(0xbda3, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xb3);
        EXPECT(gbc.b(),  0x2e);
        EXPECT(gbc.c(),  0x10);
        EXPECT(gbc.d(),  0x21);
        EXPECT(gbc.e(),  0x2);
        EXPECT(gbc.h(),  0x97);
        EXPECT(gbc.l(),  0x48);
        EXPECT(gbc.sp(), 0x37ed);
        EXPECT(gbc.pc(), 0xbda4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbda3), 0x3d);
        // 3D 035D
        gbc.setState(0xbc64, 0x2e44, 0x11f0, 0x37a, 0xc372, 0xb504, 0x0, 0x1);
        gbc.writeMem(0xbc64, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0x3);
        EXPECT(gbc.c(),  0x7a);
        EXPECT(gbc.d(),  0xc3);
        EXPECT(gbc.e(),  0x72);
        EXPECT(gbc.h(),  0xb5);
        EXPECT(gbc.l(),  0x4);
        EXPECT(gbc.sp(), 0x2e44);
        EXPECT(gbc.pc(), 0xbc65);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbc64), 0x3d);
        // 3D 035E
        gbc.setState(0x2db1, 0x2f79, 0x1a70, 0xc5ad, 0xc790, 0x5fab, 0x0, 0x0);
        gbc.writeMem(0x2db1, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x19);
        EXPECT(gbc.b(),  0xc5);
        EXPECT(gbc.c(),  0xad);
        EXPECT(gbc.d(),  0xc7);
        EXPECT(gbc.e(),  0x90);
        EXPECT(gbc.h(),  0x5f);
        EXPECT(gbc.l(),  0xab);
        EXPECT(gbc.sp(), 0x2f79);
        EXPECT(gbc.pc(), 0x2db2);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 035F
        gbc.setState(0xec21, 0xfb16, 0x3af0, 0xeb4a, 0x7ab0, 0xfbc7, 0x1, 0x1);
        gbc.writeMem(0xec21, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x39);
        EXPECT(gbc.b(),  0xeb);
        EXPECT(gbc.c(),  0x4a);
        EXPECT(gbc.d(),  0x7a);
        EXPECT(gbc.e(),  0xb0);
        EXPECT(gbc.h(),  0xfb);
        EXPECT(gbc.l(),  0xc7);
        EXPECT(gbc.sp(), 0xfb16);
        EXPECT(gbc.pc(), 0xec22);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xec21), 0x3d);
        // 3D 0360
        gbc.setState(0x72f3, 0x253a, 0x8de0, 0xfdd, 0x23b7, 0x2c52, 0x0, 0x0);
        gbc.writeMem(0x72f3, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x8c);
        EXPECT(gbc.b(),  0xf);
        EXPECT(gbc.c(),  0xdd);
        EXPECT(gbc.d(),  0x23);
        EXPECT(gbc.e(),  0xb7);
        EXPECT(gbc.h(),  0x2c);
        EXPECT(gbc.l(),  0x52);
        EXPECT(gbc.sp(), 0x253a);
        EXPECT(gbc.pc(), 0x72f4);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0362
        gbc.setState(0x9f43, 0x4a81, 0x7b40, 0x53c5, 0x8969, 0xd844, 0x1, 0x0);
        gbc.writeMem(0x9f43, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x7a);
        EXPECT(gbc.b(),  0x53);
        EXPECT(gbc.c(),  0xc5);
        EXPECT(gbc.d(),  0x89);
        EXPECT(gbc.e(),  0x69);
        EXPECT(gbc.h(),  0xd8);
        EXPECT(gbc.l(),  0x44);
        EXPECT(gbc.sp(), 0x4a81);
        EXPECT(gbc.pc(), 0x9f44);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9f43), 0x3d);
        // 3D 0363
        gbc.setState(0xb79d, 0x1682, 0xe440, 0xc5d3, 0xffa0, 0x9c81, 0x1, 0x0);
        gbc.writeMem(0xb79d, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xe3);
        EXPECT(gbc.b(),  0xc5);
        EXPECT(gbc.c(),  0xd3);
        EXPECT(gbc.d(),  0xff);
        EXPECT(gbc.e(),  0xa0);
        EXPECT(gbc.h(),  0x9c);
        EXPECT(gbc.l(),  0x81);
        EXPECT(gbc.sp(), 0x1682);
        EXPECT(gbc.pc(), 0xb79e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xb79d), 0x3d);
        // 3D 0364
        gbc.setState(0x307c, 0x681a, 0x9440, 0x4486, 0x2580, 0x2f6, 0x1, 0x1);
        gbc.writeMem(0x307c, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x93);
        EXPECT(gbc.b(),  0x44);
        EXPECT(gbc.c(),  0x86);
        EXPECT(gbc.d(),  0x25);
        EXPECT(gbc.e(),  0x80);
        EXPECT(gbc.h(),  0x2);
        EXPECT(gbc.l(),  0xf6);
        EXPECT(gbc.sp(), 0x681a);
        EXPECT(gbc.pc(), 0x307d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0365
        gbc.setState(0x5938, 0x3de7, 0xb620, 0x7210, 0xb1c, 0x86d6, 0x1, 0x0);
        gbc.writeMem(0x5938, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xb5);
        EXPECT(gbc.b(),  0x72);
        EXPECT(gbc.c(),  0x10);
        EXPECT(gbc.d(),  0xb);
        EXPECT(gbc.e(),  0x1c);
        EXPECT(gbc.h(),  0x86);
        EXPECT(gbc.l(),  0xd6);
        EXPECT(gbc.sp(), 0x3de7);
        EXPECT(gbc.pc(), 0x5939);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0366
        gbc.setState(0x633, 0x7e8d, 0x5600, 0xc7d2, 0x4025, 0xd356, 0x0, 0x1);
        gbc.writeMem(0x633, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x55);
        EXPECT(gbc.b(),  0xc7);
        EXPECT(gbc.c(),  0xd2);
        EXPECT(gbc.d(),  0x40);
        EXPECT(gbc.e(),  0x25);
        EXPECT(gbc.h(),  0xd3);
        EXPECT(gbc.l(),  0x56);
        EXPECT(gbc.sp(), 0x7e8d);
        EXPECT(gbc.pc(), 0x634);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0367
        gbc.setState(0x5b27, 0xd916, 0x4cf0, 0x333c, 0x4583, 0x9cf0, 0x1, 0x0);
        gbc.writeMem(0x5b27, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x4b);
        EXPECT(gbc.b(),  0x33);
        EXPECT(gbc.c(),  0x3c);
        EXPECT(gbc.d(),  0x45);
        EXPECT(gbc.e(),  0x83);
        EXPECT(gbc.h(),  0x9c);
        EXPECT(gbc.l(),  0xf0);
        EXPECT(gbc.sp(), 0xd916);
        EXPECT(gbc.pc(), 0x5b28);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0368
        gbc.setState(0xcdf4, 0xd426, 0x3210, 0x7434, 0x2d12, 0xcb38, 0x0, 0x1);
        gbc.writeMem(0xcdf4, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x31);
        EXPECT(gbc.b(),  0x74);
        EXPECT(gbc.c(),  0x34);
        EXPECT(gbc.d(),  0x2d);
        EXPECT(gbc.e(),  0x12);
        EXPECT(gbc.h(),  0xcb);
        EXPECT(gbc.l(),  0x38);
        EXPECT(gbc.sp(), 0xd426);
        EXPECT(gbc.pc(), 0xcdf5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcdf4), 0x3d);
        // 3D 0369
        gbc.setState(0x9200, 0xd9e2, 0x3860, 0x513b, 0xcaf, 0xb634, 0x1, 0x1);
        gbc.writeMem(0x9200, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x37);
        EXPECT(gbc.b(),  0x51);
        EXPECT(gbc.c(),  0x3b);
        EXPECT(gbc.d(),  0xc);
        EXPECT(gbc.e(),  0xaf);
        EXPECT(gbc.h(),  0xb6);
        EXPECT(gbc.l(),  0x34);
        EXPECT(gbc.sp(), 0xd9e2);
        EXPECT(gbc.pc(), 0x9201);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9200), 0x3d);
        // 3D 036A
        gbc.setState(0xcfd2, 0xca76, 0x2cb0, 0x4911, 0xd1dc, 0x589c, 0x0, 0x1);
        gbc.writeMem(0xcfd2, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x2b);
        EXPECT(gbc.b(),  0x49);
        EXPECT(gbc.c(),  0x11);
        EXPECT(gbc.d(),  0xd1);
        EXPECT(gbc.e(),  0xdc);
        EXPECT(gbc.h(),  0x58);
        EXPECT(gbc.l(),  0x9c);
        EXPECT(gbc.sp(), 0xca76);
        EXPECT(gbc.pc(), 0xcfd3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcfd2), 0x3d);
        // 3D 036B
        gbc.setState(0x7853, 0xa559, 0x18b0, 0x40e, 0x699f, 0x4e27, 0x0, 0x1);
        gbc.writeMem(0x7853, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x17);
        EXPECT(gbc.b(),  0x4);
        EXPECT(gbc.c(),  0xe);
        EXPECT(gbc.d(),  0x69);
        EXPECT(gbc.e(),  0x9f);
        EXPECT(gbc.h(),  0x4e);
        EXPECT(gbc.l(),  0x27);
        EXPECT(gbc.sp(), 0xa559);
        EXPECT(gbc.pc(), 0x7854);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 036C
        gbc.setState(0x69ec, 0xfc40, 0xa140, 0x6649, 0x8c0f, 0x2fae, 0x1, 0x0);
        gbc.writeMem(0x69ec, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa0);
        EXPECT(gbc.b(),  0x66);
        EXPECT(gbc.c(),  0x49);
        EXPECT(gbc.d(),  0x8c);
        EXPECT(gbc.e(),  0xf);
        EXPECT(gbc.h(),  0x2f);
        EXPECT(gbc.l(),  0xae);
        EXPECT(gbc.sp(), 0xfc40);
        EXPECT(gbc.pc(), 0x69ed);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 036D
        gbc.setState(0xe7fd, 0x3197, 0x3a20, 0x4754, 0x8c7c, 0x5558, 0x0, 0x0);
        gbc.writeMem(0xe7fd, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x39);
        EXPECT(gbc.b(),  0x47);
        EXPECT(gbc.c(),  0x54);
        EXPECT(gbc.d(),  0x8c);
        EXPECT(gbc.e(),  0x7c);
        EXPECT(gbc.h(),  0x55);
        EXPECT(gbc.l(),  0x58);
        EXPECT(gbc.sp(), 0x3197);
        EXPECT(gbc.pc(), 0xe7fe);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe7fd), 0x3d);
        // 3D 036E
        gbc.setState(0x392c, 0x467b, 0xa730, 0x7de4, 0x1daf, 0x1ab6, 0x0, 0x0);
        gbc.writeMem(0x392c, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa6);
        EXPECT(gbc.b(),  0x7d);
        EXPECT(gbc.c(),  0xe4);
        EXPECT(gbc.d(),  0x1d);
        EXPECT(gbc.e(),  0xaf);
        EXPECT(gbc.h(),  0x1a);
        EXPECT(gbc.l(),  0xb6);
        EXPECT(gbc.sp(), 0x467b);
        EXPECT(gbc.pc(), 0x392d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 036F
        gbc.setState(0xcbd8, 0xb4f6, 0xaf0, 0x166f, 0x87b5, 0xba62, 0x0, 0x0);
        gbc.writeMem(0xcbd8, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x9);
        EXPECT(gbc.b(),  0x16);
        EXPECT(gbc.c(),  0x6f);
        EXPECT(gbc.d(),  0x87);
        EXPECT(gbc.e(),  0xb5);
        EXPECT(gbc.h(),  0xba);
        EXPECT(gbc.l(),  0x62);
        EXPECT(gbc.sp(), 0xb4f6);
        EXPECT(gbc.pc(), 0xcbd9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcbd8), 0x3d);
        // 3D 0370
        gbc.setState(0xed12, 0xc25e, 0xa9c0, 0x82f3, 0xf5ae, 0x270e, 0x0, 0x1);
        gbc.writeMem(0xed12, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa8);
        EXPECT(gbc.b(),  0x82);
        EXPECT(gbc.c(),  0xf3);
        EXPECT(gbc.d(),  0xf5);
        EXPECT(gbc.e(),  0xae);
        EXPECT(gbc.h(),  0x27);
        EXPECT(gbc.l(),  0xe);
        EXPECT(gbc.sp(), 0xc25e);
        EXPECT(gbc.pc(), 0xed13);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xed12), 0x3d);
        // 3D 0371
        gbc.setState(0x35d2, 0xbeeb, 0xd3e0, 0xc704, 0x24ba, 0x7578, 0x1, 0x0);
        gbc.writeMem(0x35d2, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xd2);
        EXPECT(gbc.b(),  0xc7);
        EXPECT(gbc.c(),  0x4);
        EXPECT(gbc.d(),  0x24);
        EXPECT(gbc.e(),  0xba);
        EXPECT(gbc.h(),  0x75);
        EXPECT(gbc.l(),  0x78);
        EXPECT(gbc.sp(), 0xbeeb);
        EXPECT(gbc.pc(), 0x35d3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0373
        gbc.setState(0x4ef1, 0x102a, 0x8a00, 0xaaa1, 0xbce3, 0xba5d, 0x0, 0x1);
        gbc.writeMem(0x4ef1, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x89);
        EXPECT(gbc.b(),  0xaa);
        EXPECT(gbc.c(),  0xa1);
        EXPECT(gbc.d(),  0xbc);
        EXPECT(gbc.e(),  0xe3);
        EXPECT(gbc.h(),  0xba);
        EXPECT(gbc.l(),  0x5d);
        EXPECT(gbc.sp(), 0x102a);
        EXPECT(gbc.pc(), 0x4ef2);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0374
        gbc.setState(0xd173, 0xf7, 0x4a60, 0x38f8, 0xde4a, 0x51cc, 0x1, 0x1);
        gbc.writeMem(0xd173, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x49);
        EXPECT(gbc.b(),  0x38);
        EXPECT(gbc.c(),  0xf8);
        EXPECT(gbc.d(),  0xde);
        EXPECT(gbc.e(),  0x4a);
        EXPECT(gbc.h(),  0x51);
        EXPECT(gbc.l(),  0xcc);
        EXPECT(gbc.sp(), 0xf7);
        EXPECT(gbc.pc(), 0xd174);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd173), 0x3d);
        // 3D 0375
        gbc.setState(0x663b, 0xcebc, 0xbdc0, 0x1074, 0xa53c, 0x5621, 0x0, 0x0);
        gbc.writeMem(0x663b, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xbc);
        EXPECT(gbc.b(),  0x10);
        EXPECT(gbc.c(),  0x74);
        EXPECT(gbc.d(),  0xa5);
        EXPECT(gbc.e(),  0x3c);
        EXPECT(gbc.h(),  0x56);
        EXPECT(gbc.l(),  0x21);
        EXPECT(gbc.sp(), 0xcebc);
        EXPECT(gbc.pc(), 0x663c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0376
        gbc.setState(0xd2c3, 0xfd2e, 0x5a30, 0x32ee, 0xa9f2, 0xdfdc, 0x1, 0x1);
        gbc.writeMem(0xd2c3, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x59);
        EXPECT(gbc.b(),  0x32);
        EXPECT(gbc.c(),  0xee);
        EXPECT(gbc.d(),  0xa9);
        EXPECT(gbc.e(),  0xf2);
        EXPECT(gbc.h(),  0xdf);
        EXPECT(gbc.l(),  0xdc);
        EXPECT(gbc.sp(), 0xfd2e);
        EXPECT(gbc.pc(), 0xd2c4);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd2c3), 0x3d);
        // 3D 0377
        gbc.setState(0x34df, 0xa996, 0x3ff0, 0x3daf, 0x4202, 0x94ba, 0x1, 0x1);
        gbc.writeMem(0x34df, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x3e);
        EXPECT(gbc.b(),  0x3d);
        EXPECT(gbc.c(),  0xaf);
        EXPECT(gbc.d(),  0x42);
        EXPECT(gbc.e(),  0x2);
        EXPECT(gbc.h(),  0x94);
        EXPECT(gbc.l(),  0xba);
        EXPECT(gbc.sp(), 0xa996);
        EXPECT(gbc.pc(), 0x34e0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0378
        gbc.setState(0xcf72, 0xf2f6, 0x4a10, 0xc28f, 0xc434, 0x8fea, 0x0, 0x1);
        gbc.writeMem(0xcf72, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x49);
        EXPECT(gbc.b(),  0xc2);
        EXPECT(gbc.c(),  0x8f);
        EXPECT(gbc.d(),  0xc4);
        EXPECT(gbc.e(),  0x34);
        EXPECT(gbc.h(),  0x8f);
        EXPECT(gbc.l(),  0xea);
        EXPECT(gbc.sp(), 0xf2f6);
        EXPECT(gbc.pc(), 0xcf73);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcf72), 0x3d);
        // 3D 0379
        gbc.setState(0xb462, 0xf617, 0xba90, 0x3576, 0xb3d4, 0x520b, 0x0, 0x0);
        gbc.writeMem(0xb462, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xb9);
        EXPECT(gbc.b(),  0x35);
        EXPECT(gbc.c(),  0x76);
        EXPECT(gbc.d(),  0xb3);
        EXPECT(gbc.e(),  0xd4);
        EXPECT(gbc.h(),  0x52);
        EXPECT(gbc.l(),  0xb);
        EXPECT(gbc.sp(), 0xf617);
        EXPECT(gbc.pc(), 0xb463);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xb462), 0x3d);
        // 3D 037A
        gbc.setState(0xee22, 0xfe97, 0x4eb0, 0x941a, 0x8c5, 0x8b1b, 0x0, 0x0);
        gbc.writeMem(0xee22, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x4d);
        EXPECT(gbc.b(),  0x94);
        EXPECT(gbc.c(),  0x1a);
        EXPECT(gbc.d(),  0x8);
        EXPECT(gbc.e(),  0xc5);
        EXPECT(gbc.h(),  0x8b);
        EXPECT(gbc.l(),  0x1b);
        EXPECT(gbc.sp(), 0xfe97);
        EXPECT(gbc.pc(), 0xee23);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xee22), 0x3d);
        // 3D 037B
        gbc.setState(0x838f, 0xdf71, 0xc1c0, 0x5d6, 0xe8e6, 0x5a9a, 0x1, 0x0);
        gbc.writeMem(0x838f, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xc0);
        EXPECT(gbc.b(),  0x5);
        EXPECT(gbc.c(),  0xd6);
        EXPECT(gbc.d(),  0xe8);
        EXPECT(gbc.e(),  0xe6);
        EXPECT(gbc.h(),  0x5a);
        EXPECT(gbc.l(),  0x9a);
        EXPECT(gbc.sp(), 0xdf71);
        EXPECT(gbc.pc(), 0x8390);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x838f), 0x3d);
        // 3D 037C
        gbc.setState(0xad64, 0x1056, 0x4f00, 0x72d8, 0x8944, 0xfa76, 0x1, 0x0);
        gbc.writeMem(0xad64, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x4e);
        EXPECT(gbc.b(),  0x72);
        EXPECT(gbc.c(),  0xd8);
        EXPECT(gbc.d(),  0x89);
        EXPECT(gbc.e(),  0x44);
        EXPECT(gbc.h(),  0xfa);
        EXPECT(gbc.l(),  0x76);
        EXPECT(gbc.sp(), 0x1056);
        EXPECT(gbc.pc(), 0xad65);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xad64), 0x3d);
        // 3D 037D
        gbc.setState(0xc64a, 0xea07, 0xeb00, 0x624f, 0x580e, 0x1018, 0x0, 0x0);
        gbc.writeMem(0xc64a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xea);
        EXPECT(gbc.b(),  0x62);
        EXPECT(gbc.c(),  0x4f);
        EXPECT(gbc.d(),  0x58);
        EXPECT(gbc.e(),  0xe);
        EXPECT(gbc.h(),  0x10);
        EXPECT(gbc.l(),  0x18);
        EXPECT(gbc.sp(), 0xea07);
        EXPECT(gbc.pc(), 0xc64b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc64a), 0x3d);
        // 3D 037E
        gbc.setState(0xc710, 0xd042, 0xa860, 0xfa86, 0x4ff4, 0x37a9, 0x0, 0x0);
        gbc.writeMem(0xc710, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa7);
        EXPECT(gbc.b(),  0xfa);
        EXPECT(gbc.c(),  0x86);
        EXPECT(gbc.d(),  0x4f);
        EXPECT(gbc.e(),  0xf4);
        EXPECT(gbc.h(),  0x37);
        EXPECT(gbc.l(),  0xa9);
        EXPECT(gbc.sp(), 0xd042);
        EXPECT(gbc.pc(), 0xc711);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc710), 0x3d);
        // 3D 037F
        gbc.setState(0x68bf, 0x4f1b, 0xa0c0, 0x717c, 0xc064, 0xeca3, 0x1, 0x0);
        gbc.writeMem(0x68bf, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x9f);
        EXPECT(gbc.b(),  0x71);
        EXPECT(gbc.c(),  0x7c);
        EXPECT(gbc.d(),  0xc0);
        EXPECT(gbc.e(),  0x64);
        EXPECT(gbc.h(),  0xec);
        EXPECT(gbc.l(),  0xa3);
        EXPECT(gbc.sp(), 0x4f1b);
        EXPECT(gbc.pc(), 0x68c0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        // 3D 0380
        gbc.setState(0x46be, 0x8df7, 0x1a50, 0x3f81, 0xadae, 0xa427, 0x1, 0x1);
        gbc.writeMem(0x46be, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x19);
        EXPECT(gbc.b(),  0x3f);
        EXPECT(gbc.c(),  0x81);
        EXPECT(gbc.d(),  0xad);
        EXPECT(gbc.e(),  0xae);
        EXPECT(gbc.h(),  0xa4);
        EXPECT(gbc.l(),  0x27);
        EXPECT(gbc.sp(), 0x8df7);
        EXPECT(gbc.pc(), 0x46bf);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0381
        gbc.setState(0x206c, 0xdd2e, 0x34e0, 0xdbfa, 0xe2cf, 0x6b88, 0x1, 0x1);
        gbc.writeMem(0x206c, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x33);
        EXPECT(gbc.b(),  0xdb);
        EXPECT(gbc.c(),  0xfa);
        EXPECT(gbc.d(),  0xe2);
        EXPECT(gbc.e(),  0xcf);
        EXPECT(gbc.h(),  0x6b);
        EXPECT(gbc.l(),  0x88);
        EXPECT(gbc.sp(), 0xdd2e);
        EXPECT(gbc.pc(), 0x206d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0382
        gbc.setState(0xafee, 0x5786, 0x8650, 0xb253, 0x434, 0xeb24, 0x0, 0x0);
        gbc.writeMem(0xafee, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x85);
        EXPECT(gbc.b(),  0xb2);
        EXPECT(gbc.c(),  0x53);
        EXPECT(gbc.d(),  0x4);
        EXPECT(gbc.e(),  0x34);
        EXPECT(gbc.h(),  0xeb);
        EXPECT(gbc.l(),  0x24);
        EXPECT(gbc.sp(), 0x5786);
        EXPECT(gbc.pc(), 0xafef);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xafee), 0x3d);
        // 3D 0383
        gbc.setState(0x7a89, 0x6348, 0x6240, 0x6021, 0x130c, 0x288e, 0x0, 0x1);
        gbc.writeMem(0x7a89, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x61);
        EXPECT(gbc.b(),  0x60);
        EXPECT(gbc.c(),  0x21);
        EXPECT(gbc.d(),  0x13);
        EXPECT(gbc.e(),  0xc);
        EXPECT(gbc.h(),  0x28);
        EXPECT(gbc.l(),  0x8e);
        EXPECT(gbc.sp(), 0x6348);
        EXPECT(gbc.pc(), 0x7a8a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0384
        gbc.setState(0xe6d6, 0xe341, 0x2ed0, 0xe7cc, 0xaa92, 0x1d89, 0x1, 0x0);
        gbc.writeMem(0xe6d6, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x2d);
        EXPECT(gbc.b(),  0xe7);
        EXPECT(gbc.c(),  0xcc);
        EXPECT(gbc.d(),  0xaa);
        EXPECT(gbc.e(),  0x92);
        EXPECT(gbc.h(),  0x1d);
        EXPECT(gbc.l(),  0x89);
        EXPECT(gbc.sp(), 0xe341);
        EXPECT(gbc.pc(), 0xe6d7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe6d6), 0x3d);
        // 3D 0385
        gbc.setState(0xce2a, 0x80d0, 0x2c0, 0x2fb1, 0xeb3f, 0x4a03, 0x1, 0x1);
        gbc.writeMem(0xce2a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x1);
        EXPECT(gbc.b(),  0x2f);
        EXPECT(gbc.c(),  0xb1);
        EXPECT(gbc.d(),  0xeb);
        EXPECT(gbc.e(),  0x3f);
        EXPECT(gbc.h(),  0x4a);
        EXPECT(gbc.l(),  0x3);
        EXPECT(gbc.sp(), 0x80d0);
        EXPECT(gbc.pc(), 0xce2b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xce2a), 0x3d);
        // 3D 0386
        gbc.setState(0x72a0, 0x467a, 0xb8d0, 0xdc7d, 0xcdf2, 0x4021, 0x0, 0x1);
        gbc.writeMem(0x72a0, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xb7);
        EXPECT(gbc.b(),  0xdc);
        EXPECT(gbc.c(),  0x7d);
        EXPECT(gbc.d(),  0xcd);
        EXPECT(gbc.e(),  0xf2);
        EXPECT(gbc.h(),  0x40);
        EXPECT(gbc.l(),  0x21);
        EXPECT(gbc.sp(), 0x467a);
        EXPECT(gbc.pc(), 0x72a1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0387
        gbc.setState(0x5e92, 0xae9c, 0x86a0, 0x475c, 0x5b08, 0x8f3a, 0x0, 0x0);
        gbc.writeMem(0x5e92, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x85);
        EXPECT(gbc.b(),  0x47);
        EXPECT(gbc.c(),  0x5c);
        EXPECT(gbc.d(),  0x5b);
        EXPECT(gbc.e(),  0x8);
        EXPECT(gbc.h(),  0x8f);
        EXPECT(gbc.l(),  0x3a);
        EXPECT(gbc.sp(), 0xae9c);
        EXPECT(gbc.pc(), 0x5e93);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0388
        gbc.setState(0x6faf, 0x7d93, 0xa540, 0x3bc9, 0x61b9, 0x7d55, 0x1, 0x1);
        gbc.writeMem(0x6faf, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa4);
        EXPECT(gbc.b(),  0x3b);
        EXPECT(gbc.c(),  0xc9);
        EXPECT(gbc.d(),  0x61);
        EXPECT(gbc.e(),  0xb9);
        EXPECT(gbc.h(),  0x7d);
        EXPECT(gbc.l(),  0x55);
        EXPECT(gbc.sp(), 0x7d93);
        EXPECT(gbc.pc(), 0x6fb0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0389
        gbc.setState(0x7729, 0x8a48, 0x1dd0, 0x1259, 0xc67d, 0x5bc4, 0x0, 0x1);
        gbc.writeMem(0x7729, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x1c);
        EXPECT(gbc.b(),  0x12);
        EXPECT(gbc.c(),  0x59);
        EXPECT(gbc.d(),  0xc6);
        EXPECT(gbc.e(),  0x7d);
        EXPECT(gbc.h(),  0x5b);
        EXPECT(gbc.l(),  0xc4);
        EXPECT(gbc.sp(), 0x8a48);
        EXPECT(gbc.pc(), 0x772a);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 038A
        gbc.setState(0x5c57, 0xc2a5, 0xb690, 0x8b79, 0x2dc0, 0xecf5, 0x1, 0x1);
        gbc.writeMem(0x5c57, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xb5);
        EXPECT(gbc.b(),  0x8b);
        EXPECT(gbc.c(),  0x79);
        EXPECT(gbc.d(),  0x2d);
        EXPECT(gbc.e(),  0xc0);
        EXPECT(gbc.h(),  0xec);
        EXPECT(gbc.l(),  0xf5);
        EXPECT(gbc.sp(), 0xc2a5);
        EXPECT(gbc.pc(), 0x5c58);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 038B
        gbc.setState(0x8674, 0x1802, 0xc480, 0x90fa, 0xfb38, 0x92f7, 0x0, 0x1);
        gbc.writeMem(0x8674, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xc3);
        EXPECT(gbc.b(),  0x90);
        EXPECT(gbc.c(),  0xfa);
        EXPECT(gbc.d(),  0xfb);
        EXPECT(gbc.e(),  0x38);
        EXPECT(gbc.h(),  0x92);
        EXPECT(gbc.l(),  0xf7);
        EXPECT(gbc.sp(), 0x1802);
        EXPECT(gbc.pc(), 0x8675);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8674), 0x3d);
        // 3D 038C
        gbc.setState(0xe803, 0x5b41, 0x9540, 0x2ca0, 0xc458, 0xface, 0x1, 0x0);
        gbc.writeMem(0xe803, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x94);
        EXPECT(gbc.b(),  0x2c);
        EXPECT(gbc.c(),  0xa0);
        EXPECT(gbc.d(),  0xc4);
        EXPECT(gbc.e(),  0x58);
        EXPECT(gbc.h(),  0xfa);
        EXPECT(gbc.l(),  0xce);
        EXPECT(gbc.sp(), 0x5b41);
        EXPECT(gbc.pc(), 0xe804);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe803), 0x3d);
        // 3D 038D
        gbc.setState(0x8f2f, 0xed47, 0x4a60, 0x1180, 0x21c3, 0x2a9e, 0x1, 0x1);
        gbc.writeMem(0x8f2f, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x49);
        EXPECT(gbc.b(),  0x11);
        EXPECT(gbc.c(),  0x80);
        EXPECT(gbc.d(),  0x21);
        EXPECT(gbc.e(),  0xc3);
        EXPECT(gbc.h(),  0x2a);
        EXPECT(gbc.l(),  0x9e);
        EXPECT(gbc.sp(), 0xed47);
        EXPECT(gbc.pc(), 0x8f30);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8f2f), 0x3d);
        // 3D 038E
        gbc.setState(0x9873, 0x2d24, 0xb320, 0x4f8e, 0x290, 0x5da3, 0x0, 0x1);
        gbc.writeMem(0x9873, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xb2);
        EXPECT(gbc.b(),  0x4f);
        EXPECT(gbc.c(),  0x8e);
        EXPECT(gbc.d(),  0x2);
        EXPECT(gbc.e(),  0x90);
        EXPECT(gbc.h(),  0x5d);
        EXPECT(gbc.l(),  0xa3);
        EXPECT(gbc.sp(), 0x2d24);
        EXPECT(gbc.pc(), 0x9874);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9873), 0x3d);
        // 3D 038F
        gbc.setState(0x8d3a, 0x9dd8, 0x37a0, 0x8074, 0x33eb, 0x9364, 0x1, 0x1);
        gbc.writeMem(0x8d3a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x36);
        EXPECT(gbc.b(),  0x80);
        EXPECT(gbc.c(),  0x74);
        EXPECT(gbc.d(),  0x33);
        EXPECT(gbc.e(),  0xeb);
        EXPECT(gbc.h(),  0x93);
        EXPECT(gbc.l(),  0x64);
        EXPECT(gbc.sp(), 0x9dd8);
        EXPECT(gbc.pc(), 0x8d3b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8d3a), 0x3d);
        // 3D 0390
        gbc.setState(0xbf41, 0xb359, 0x6020, 0xcd07, 0x2ee0, 0x13c6, 0x1, 0x1);
        gbc.writeMem(0xbf41, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x5f);
        EXPECT(gbc.b(),  0xcd);
        EXPECT(gbc.c(),  0x7);
        EXPECT(gbc.d(),  0x2e);
        EXPECT(gbc.e(),  0xe0);
        EXPECT(gbc.h(),  0x13);
        EXPECT(gbc.l(),  0xc6);
        EXPECT(gbc.sp(), 0xb359);
        EXPECT(gbc.pc(), 0xbf42);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbf41), 0x3d);
        // 3D 0391
        gbc.setState(0x32d0, 0xeed, 0x6a0, 0x5dd5, 0xeb9f, 0x6433, 0x1, 0x1);
        gbc.writeMem(0x32d0, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x5);
        EXPECT(gbc.b(),  0x5d);
        EXPECT(gbc.c(),  0xd5);
        EXPECT(gbc.d(),  0xeb);
        EXPECT(gbc.e(),  0x9f);
        EXPECT(gbc.h(),  0x64);
        EXPECT(gbc.l(),  0x33);
        EXPECT(gbc.sp(), 0xeed);
        EXPECT(gbc.pc(), 0x32d1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0392
        gbc.setState(0x6614, 0xf15f, 0x2760, 0x3346, 0xc381, 0x74a8, 0x1, 0x1);
        gbc.writeMem(0x6614, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x26);
        EXPECT(gbc.b(),  0x33);
        EXPECT(gbc.c(),  0x46);
        EXPECT(gbc.d(),  0xc3);
        EXPECT(gbc.e(),  0x81);
        EXPECT(gbc.h(),  0x74);
        EXPECT(gbc.l(),  0xa8);
        EXPECT(gbc.sp(), 0xf15f);
        EXPECT(gbc.pc(), 0x6615);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0393
        gbc.setState(0x4566, 0x8620, 0x7e30, 0x738c, 0xc929, 0x85e7, 0x0, 0x0);
        gbc.writeMem(0x4566, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x7d);
        EXPECT(gbc.b(),  0x73);
        EXPECT(gbc.c(),  0x8c);
        EXPECT(gbc.d(),  0xc9);
        EXPECT(gbc.e(),  0x29);
        EXPECT(gbc.h(),  0x85);
        EXPECT(gbc.l(),  0xe7);
        EXPECT(gbc.sp(), 0x8620);
        EXPECT(gbc.pc(), 0x4567);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0394
        gbc.setState(0x7e13, 0xa0e9, 0xceb0, 0xecf, 0xb548, 0x502f, 0x0, 0x0);
        gbc.writeMem(0x7e13, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xcd);
        EXPECT(gbc.b(),  0xe);
        EXPECT(gbc.c(),  0xcf);
        EXPECT(gbc.d(),  0xb5);
        EXPECT(gbc.e(),  0x48);
        EXPECT(gbc.h(),  0x50);
        EXPECT(gbc.l(),  0x2f);
        EXPECT(gbc.sp(), 0xa0e9);
        EXPECT(gbc.pc(), 0x7e14);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0395
        gbc.setState(0x27a6, 0x8037, 0x13c0, 0xd1d0, 0x8f51, 0x5b69, 0x0, 0x0);
        gbc.writeMem(0x27a6, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x12);
        EXPECT(gbc.b(),  0xd1);
        EXPECT(gbc.c(),  0xd0);
        EXPECT(gbc.d(),  0x8f);
        EXPECT(gbc.e(),  0x51);
        EXPECT(gbc.h(),  0x5b);
        EXPECT(gbc.l(),  0x69);
        EXPECT(gbc.sp(), 0x8037);
        EXPECT(gbc.pc(), 0x27a7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 0396
        gbc.setState(0x219b, 0xfd19, 0x5f30, 0x2085, 0x5090, 0xc610, 0x0, 0x0);
        gbc.writeMem(0x219b, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x5e);
        EXPECT(gbc.b(),  0x20);
        EXPECT(gbc.c(),  0x85);
        EXPECT(gbc.d(),  0x50);
        EXPECT(gbc.e(),  0x90);
        EXPECT(gbc.h(),  0xc6);
        EXPECT(gbc.l(),  0x10);
        EXPECT(gbc.sp(), 0xfd19);
        EXPECT(gbc.pc(), 0x219c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0397
        gbc.setState(0xdbfa, 0xf23f, 0x2f00, 0xd7ab, 0x5abf, 0xc9fd, 0x1, 0x1);
        gbc.writeMem(0xdbfa, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x2e);
        EXPECT(gbc.b(),  0xd7);
        EXPECT(gbc.c(),  0xab);
        EXPECT(gbc.d(),  0x5a);
        EXPECT(gbc.e(),  0xbf);
        EXPECT(gbc.h(),  0xc9);
        EXPECT(gbc.l(),  0xfd);
        EXPECT(gbc.sp(), 0xf23f);
        EXPECT(gbc.pc(), 0xdbfb);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xdbfa), 0x3d);
        // 3D 0398
        gbc.setState(0x4b90, 0x70f3, 0xecf0, 0x73bf, 0x708d, 0x5f4e, 0x0, 0x1);
        gbc.writeMem(0x4b90, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xeb);
        EXPECT(gbc.b(),  0x73);
        EXPECT(gbc.c(),  0xbf);
        EXPECT(gbc.d(),  0x70);
        EXPECT(gbc.e(),  0x8d);
        EXPECT(gbc.h(),  0x5f);
        EXPECT(gbc.l(),  0x4e);
        EXPECT(gbc.sp(), 0x70f3);
        EXPECT(gbc.pc(), 0x4b91);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 0399
        gbc.setState(0x547c, 0x83c0, 0x9310, 0x4f62, 0x6e22, 0x1d39, 0x1, 0x1);
        gbc.writeMem(0x547c, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x92);
        EXPECT(gbc.b(),  0x4f);
        EXPECT(gbc.c(),  0x62);
        EXPECT(gbc.d(),  0x6e);
        EXPECT(gbc.e(),  0x22);
        EXPECT(gbc.h(),  0x1d);
        EXPECT(gbc.l(),  0x39);
        EXPECT(gbc.sp(), 0x83c0);
        EXPECT(gbc.pc(), 0x547d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 039A
        gbc.setState(0xe936, 0xd0a, 0xf030, 0xd57, 0x6128, 0x3547, 0x1, 0x0);
        gbc.writeMem(0xe936, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xef);
        EXPECT(gbc.b(),  0xd);
        EXPECT(gbc.c(),  0x57);
        EXPECT(gbc.d(),  0x61);
        EXPECT(gbc.e(),  0x28);
        EXPECT(gbc.h(),  0x35);
        EXPECT(gbc.l(),  0x47);
        EXPECT(gbc.sp(), 0xd0a);
        EXPECT(gbc.pc(), 0xe937);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe936), 0x3d);
        // 3D 039B
        gbc.setState(0xcbf5, 0xb9e2, 0x8db0, 0x7346, 0x61c7, 0x507, 0x1, 0x0);
        gbc.writeMem(0xcbf5, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x8c);
        EXPECT(gbc.b(),  0x73);
        EXPECT(gbc.c(),  0x46);
        EXPECT(gbc.d(),  0x61);
        EXPECT(gbc.e(),  0xc7);
        EXPECT(gbc.h(),  0x5);
        EXPECT(gbc.l(),  0x7);
        EXPECT(gbc.sp(), 0xb9e2);
        EXPECT(gbc.pc(), 0xcbf6);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xcbf5), 0x3d);
        // 3D 039C
        gbc.setState(0xbbdf, 0x23ef, 0x4f40, 0xcea5, 0xfd81, 0xc75, 0x1, 0x1);
        gbc.writeMem(0xbbdf, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x4e);
        EXPECT(gbc.b(),  0xce);
        EXPECT(gbc.c(),  0xa5);
        EXPECT(gbc.d(),  0xfd);
        EXPECT(gbc.e(),  0x81);
        EXPECT(gbc.h(),  0xc);
        EXPECT(gbc.l(),  0x75);
        EXPECT(gbc.sp(), 0x23ef);
        EXPECT(gbc.pc(), 0xbbe0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xbbdf), 0x3d);
        // 3D 039D
        gbc.setState(0xebab, 0xa60b, 0x8c90, 0xd7a7, 0x9419, 0xb0c7, 0x0, 0x1);
        gbc.writeMem(0xebab, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x8b);
        EXPECT(gbc.b(),  0xd7);
        EXPECT(gbc.c(),  0xa7);
        EXPECT(gbc.d(),  0x94);
        EXPECT(gbc.e(),  0x19);
        EXPECT(gbc.h(),  0xb0);
        EXPECT(gbc.l(),  0xc7);
        EXPECT(gbc.sp(), 0xa60b);
        EXPECT(gbc.pc(), 0xebac);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xebab), 0x3d);
        // 3D 039E
        gbc.setState(0xc97c, 0xf4e4, 0x4e10, 0x9a25, 0x35da, 0x339c, 0x1, 0x1);
        gbc.writeMem(0xc97c, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x4d);
        EXPECT(gbc.b(),  0x9a);
        EXPECT(gbc.c(),  0x25);
        EXPECT(gbc.d(),  0x35);
        EXPECT(gbc.e(),  0xda);
        EXPECT(gbc.h(),  0x33);
        EXPECT(gbc.l(),  0x9c);
        EXPECT(gbc.sp(), 0xf4e4);
        EXPECT(gbc.pc(), 0xc97d);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc97c), 0x3d);
        // 3D 039F
        gbc.setState(0xd4a8, 0x2522, 0x7bd0, 0x7b60, 0x2610, 0x248a, 0x0, 0x1);
        gbc.writeMem(0xd4a8, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x7a);
        EXPECT(gbc.b(),  0x7b);
        EXPECT(gbc.c(),  0x60);
        EXPECT(gbc.d(),  0x26);
        EXPECT(gbc.e(),  0x10);
        EXPECT(gbc.h(),  0x24);
        EXPECT(gbc.l(),  0x8a);
        EXPECT(gbc.sp(), 0x2522);
        EXPECT(gbc.pc(), 0xd4a9);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd4a8), 0x3d);
        // 3D 03A0
        gbc.setState(0x4e02, 0xad80, 0xfc80, 0xadbb, 0x3224, 0xec3e, 0x1, 0x0);
        gbc.writeMem(0x4e02, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xfb);
        EXPECT(gbc.b(),  0xad);
        EXPECT(gbc.c(),  0xbb);
        EXPECT(gbc.d(),  0x32);
        EXPECT(gbc.e(),  0x24);
        EXPECT(gbc.h(),  0xec);
        EXPECT(gbc.l(),  0x3e);
        EXPECT(gbc.sp(), 0xad80);
        EXPECT(gbc.pc(), 0x4e03);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 03A1
        gbc.setState(0x9d0, 0xef92, 0xf160, 0xd640, 0x2660, 0x6ac7, 0x0, 0x0);
        gbc.writeMem(0x9d0, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf0);
        EXPECT(gbc.b(),  0xd6);
        EXPECT(gbc.c(),  0x40);
        EXPECT(gbc.d(),  0x26);
        EXPECT(gbc.e(),  0x60);
        EXPECT(gbc.h(),  0x6a);
        EXPECT(gbc.l(),  0xc7);
        EXPECT(gbc.sp(), 0xef92);
        EXPECT(gbc.pc(), 0x9d1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 03A2
        gbc.setState(0x5472, 0x129, 0x93f0, 0x393d, 0x5dff, 0x34b, 0x0, 0x0);
        gbc.writeMem(0x5472, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x92);
        EXPECT(gbc.b(),  0x39);
        EXPECT(gbc.c(),  0x3d);
        EXPECT(gbc.d(),  0x5d);
        EXPECT(gbc.e(),  0xff);
        EXPECT(gbc.h(),  0x3);
        EXPECT(gbc.l(),  0x4b);
        EXPECT(gbc.sp(), 0x129);
        EXPECT(gbc.pc(), 0x5473);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 03A3
        gbc.setState(0x6348, 0xbffb, 0x1380, 0x85b1, 0x8d6e, 0xfab7, 0x0, 0x1);
        gbc.writeMem(0x6348, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x12);
        EXPECT(gbc.b(),  0x85);
        EXPECT(gbc.c(),  0xb1);
        EXPECT(gbc.d(),  0x8d);
        EXPECT(gbc.e(),  0x6e);
        EXPECT(gbc.h(),  0xfa);
        EXPECT(gbc.l(),  0xb7);
        EXPECT(gbc.sp(), 0xbffb);
        EXPECT(gbc.pc(), 0x6349);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 03A4
        gbc.setState(0x2824, 0x1a32, 0xfc20, 0x8eb8, 0x84a, 0xc76f, 0x0, 0x1);
        gbc.writeMem(0x2824, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xfb);
        EXPECT(gbc.b(),  0x8e);
        EXPECT(gbc.c(),  0xb8);
        EXPECT(gbc.d(),  0x8);
        EXPECT(gbc.e(),  0x4a);
        EXPECT(gbc.h(),  0xc7);
        EXPECT(gbc.l(),  0x6f);
        EXPECT(gbc.sp(), 0x1a32);
        EXPECT(gbc.pc(), 0x2825);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 03A5
        gbc.setState(0x1057, 0x60f9, 0xc520, 0x4dd8, 0x2b33, 0x494c, 0x0, 0x1);
        gbc.writeMem(0x1057, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xc4);
        EXPECT(gbc.b(),  0x4d);
        EXPECT(gbc.c(),  0xd8);
        EXPECT(gbc.d(),  0x2b);
        EXPECT(gbc.e(),  0x33);
        EXPECT(gbc.h(),  0x49);
        EXPECT(gbc.l(),  0x4c);
        EXPECT(gbc.sp(), 0x60f9);
        EXPECT(gbc.pc(), 0x1058);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 03A6
        gbc.setState(0x148b, 0xb53b, 0x8320, 0x80f9, 0xe46e, 0x4c67, 0x0, 0x1);
        gbc.writeMem(0x148b, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x82);
        EXPECT(gbc.b(),  0x80);
        EXPECT(gbc.c(),  0xf9);
        EXPECT(gbc.d(),  0xe4);
        EXPECT(gbc.e(),  0x6e);
        EXPECT(gbc.h(),  0x4c);
        EXPECT(gbc.l(),  0x67);
        EXPECT(gbc.sp(), 0xb53b);
        EXPECT(gbc.pc(), 0x148c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 03A7
        gbc.setState(0xbe9, 0x872f, 0x4540, 0x4dc, 0xe31b, 0x4b7a, 0x1, 0x0);
        gbc.writeMem(0xbe9, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x44);
        EXPECT(gbc.b(),  0x4);
        EXPECT(gbc.c(),  0xdc);
        EXPECT(gbc.d(),  0xe3);
        EXPECT(gbc.e(),  0x1b);
        EXPECT(gbc.h(),  0x4b);
        EXPECT(gbc.l(),  0x7a);
        EXPECT(gbc.sp(), 0x872f);
        EXPECT(gbc.pc(), 0xbea);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 03A8
        gbc.setState(0x94e4, 0x5e14, 0x9500, 0xadd0, 0x8e72, 0x93cd, 0x0, 0x0);
        gbc.writeMem(0x94e4, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x94);
        EXPECT(gbc.b(),  0xad);
        EXPECT(gbc.c(),  0xd0);
        EXPECT(gbc.d(),  0x8e);
        EXPECT(gbc.e(),  0x72);
        EXPECT(gbc.h(),  0x93);
        EXPECT(gbc.l(),  0xcd);
        EXPECT(gbc.sp(), 0x5e14);
        EXPECT(gbc.pc(), 0x94e5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x94e4), 0x3d);
        // 3D 03A9
        gbc.setState(0x524c, 0x5211, 0xee70, 0xb94c, 0x7636, 0xfb2f, 0x0, 0x0);
        gbc.writeMem(0x524c, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xed);
        EXPECT(gbc.b(),  0xb9);
        EXPECT(gbc.c(),  0x4c);
        EXPECT(gbc.d(),  0x76);
        EXPECT(gbc.e(),  0x36);
        EXPECT(gbc.h(),  0xfb);
        EXPECT(gbc.l(),  0x2f);
        EXPECT(gbc.sp(), 0x5211);
        EXPECT(gbc.pc(), 0x524d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 03AA
        gbc.setState(0x9a2c, 0x2717, 0xad50, 0x764c, 0xd85c, 0xdc31, 0x0, 0x0);
        gbc.writeMem(0x9a2c, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xac);
        EXPECT(gbc.b(),  0x76);
        EXPECT(gbc.c(),  0x4c);
        EXPECT(gbc.d(),  0xd8);
        EXPECT(gbc.e(),  0x5c);
        EXPECT(gbc.h(),  0xdc);
        EXPECT(gbc.l(),  0x31);
        EXPECT(gbc.sp(), 0x2717);
        EXPECT(gbc.pc(), 0x9a2d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9a2c), 0x3d);
        // 3D 03AB
        gbc.setState(0xec21, 0x15a1, 0x9960, 0x2c3c, 0x5b42, 0x9a2c, 0x0, 0x0);
        gbc.writeMem(0xec21, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x98);
        EXPECT(gbc.b(),  0x2c);
        EXPECT(gbc.c(),  0x3c);
        EXPECT(gbc.d(),  0x5b);
        EXPECT(gbc.e(),  0x42);
        EXPECT(gbc.h(),  0x9a);
        EXPECT(gbc.l(),  0x2c);
        EXPECT(gbc.sp(), 0x15a1);
        EXPECT(gbc.pc(), 0xec22);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xec21), 0x3d);
        // 3D 03AC
        gbc.setState(0x143d, 0xb52c, 0x33c0, 0xe2da, 0x405f, 0xbf75, 0x1, 0x1);
        gbc.writeMem(0x143d, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x32);
        EXPECT(gbc.b(),  0xe2);
        EXPECT(gbc.c(),  0xda);
        EXPECT(gbc.d(),  0x40);
        EXPECT(gbc.e(),  0x5f);
        EXPECT(gbc.h(),  0xbf);
        EXPECT(gbc.l(),  0x75);
        EXPECT(gbc.sp(), 0xb52c);
        EXPECT(gbc.pc(), 0x143e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 03AD
        gbc.setState(0x295, 0x3d82, 0x6cc0, 0x825b, 0x514e, 0x9095, 0x0, 0x1);
        gbc.writeMem(0x295, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x6b);
        EXPECT(gbc.b(),  0x82);
        EXPECT(gbc.c(),  0x5b);
        EXPECT(gbc.d(),  0x51);
        EXPECT(gbc.e(),  0x4e);
        EXPECT(gbc.h(),  0x90);
        EXPECT(gbc.l(),  0x95);
        EXPECT(gbc.sp(), 0x3d82);
        EXPECT(gbc.pc(), 0x296);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 03AE
        gbc.setState(0x9778, 0x91fd, 0x1a20, 0xf371, 0x6735, 0xb127, 0x0, 0x0);
        gbc.writeMem(0x9778, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x19);
        EXPECT(gbc.b(),  0xf3);
        EXPECT(gbc.c(),  0x71);
        EXPECT(gbc.d(),  0x67);
        EXPECT(gbc.e(),  0x35);
        EXPECT(gbc.h(),  0xb1);
        EXPECT(gbc.l(),  0x27);
        EXPECT(gbc.sp(), 0x91fd);
        EXPECT(gbc.pc(), 0x9779);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x9778), 0x3d);
        // 3D 03AF
        gbc.setState(0xa133, 0x2c5c, 0x8e20, 0xc6ca, 0xe874, 0x4713, 0x0, 0x0);
        gbc.writeMem(0xa133, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x8d);
        EXPECT(gbc.b(),  0xc6);
        EXPECT(gbc.c(),  0xca);
        EXPECT(gbc.d(),  0xe8);
        EXPECT(gbc.e(),  0x74);
        EXPECT(gbc.h(),  0x47);
        EXPECT(gbc.l(),  0x13);
        EXPECT(gbc.sp(), 0x2c5c);
        EXPECT(gbc.pc(), 0xa134);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa133), 0x3d);
        // 3D 03B0
        gbc.setState(0xe760, 0x309a, 0x1160, 0x3936, 0x703e, 0x948e, 0x1, 0x0);
        gbc.writeMem(0xe760, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x10);
        EXPECT(gbc.b(),  0x39);
        EXPECT(gbc.c(),  0x36);
        EXPECT(gbc.d(),  0x70);
        EXPECT(gbc.e(),  0x3e);
        EXPECT(gbc.h(),  0x94);
        EXPECT(gbc.l(),  0x8e);
        EXPECT(gbc.sp(), 0x309a);
        EXPECT(gbc.pc(), 0xe761);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe760), 0x3d);
        // 3D 03B1
        gbc.setState(0xe867, 0x458, 0x81a0, 0xfb3e, 0xca99, 0x6e9a, 0x1, 0x0);
        gbc.writeMem(0xe867, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x80);
        EXPECT(gbc.b(),  0xfb);
        EXPECT(gbc.c(),  0x3e);
        EXPECT(gbc.d(),  0xca);
        EXPECT(gbc.e(),  0x99);
        EXPECT(gbc.h(),  0x6e);
        EXPECT(gbc.l(),  0x9a);
        EXPECT(gbc.sp(), 0x458);
        EXPECT(gbc.pc(), 0xe868);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe867), 0x3d);
        // 3D 03B2
        gbc.setState(0x1fa6, 0xb0bb, 0x4880, 0xf9e7, 0x58e5, 0x26ff, 0x1, 0x0);
        gbc.writeMem(0x1fa6, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x47);
        EXPECT(gbc.b(),  0xf9);
        EXPECT(gbc.c(),  0xe7);
        EXPECT(gbc.d(),  0x58);
        EXPECT(gbc.e(),  0xe5);
        EXPECT(gbc.h(),  0x26);
        EXPECT(gbc.l(),  0xff);
        EXPECT(gbc.sp(), 0xb0bb);
        EXPECT(gbc.pc(), 0x1fa7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 03B3
        gbc.setState(0x5f9e, 0x23a1, 0xc290, 0xbf64, 0x27a6, 0xba92, 0x1, 0x1);
        gbc.writeMem(0x5f9e, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xc1);
        EXPECT(gbc.b(),  0xbf);
        EXPECT(gbc.c(),  0x64);
        EXPECT(gbc.d(),  0x27);
        EXPECT(gbc.e(),  0xa6);
        EXPECT(gbc.h(),  0xba);
        EXPECT(gbc.l(),  0x92);
        EXPECT(gbc.sp(), 0x23a1);
        EXPECT(gbc.pc(), 0x5f9f);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 03B4
        gbc.setState(0x6e64, 0x4e3f, 0x7780, 0x3c4b, 0x3377, 0x1d5, 0x0, 0x0);
        gbc.writeMem(0x6e64, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x76);
        EXPECT(gbc.b(),  0x3c);
        EXPECT(gbc.c(),  0x4b);
        EXPECT(gbc.d(),  0x33);
        EXPECT(gbc.e(),  0x77);
        EXPECT(gbc.h(),  0x1);
        EXPECT(gbc.l(),  0xd5);
        EXPECT(gbc.sp(), 0x4e3f);
        EXPECT(gbc.pc(), 0x6e65);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 03B5
        gbc.setState(0x90a0, 0xef3d, 0x47b0, 0xe84e, 0x8e49, 0x5905, 0x1, 0x0);
        gbc.writeMem(0x90a0, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x46);
        EXPECT(gbc.b(),  0xe8);
        EXPECT(gbc.c(),  0x4e);
        EXPECT(gbc.d(),  0x8e);
        EXPECT(gbc.e(),  0x49);
        EXPECT(gbc.h(),  0x59);
        EXPECT(gbc.l(),  0x5);
        EXPECT(gbc.sp(), 0xef3d);
        EXPECT(gbc.pc(), 0x90a1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x90a0), 0x3d);
        // 3D 03B6
        gbc.setState(0x8ea0, 0xd03c, 0x1330, 0xf9e3, 0x963, 0xda65, 0x0, 0x1);
        gbc.writeMem(0x8ea0, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x12);
        EXPECT(gbc.b(),  0xf9);
        EXPECT(gbc.c(),  0xe3);
        EXPECT(gbc.d(),  0x9);
        EXPECT(gbc.e(),  0x63);
        EXPECT(gbc.h(),  0xda);
        EXPECT(gbc.l(),  0x65);
        EXPECT(gbc.sp(), 0xd03c);
        EXPECT(gbc.pc(), 0x8ea1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8ea0), 0x3d);
        // 3D 03B7
        gbc.setState(0xc020, 0x43cc, 0x7f00, 0x6bf4, 0x4ad6, 0x725a, 0x1, 0x0);
        gbc.writeMem(0xc020, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x7e);
        EXPECT(gbc.b(),  0x6b);
        EXPECT(gbc.c(),  0xf4);
        EXPECT(gbc.d(),  0x4a);
        EXPECT(gbc.e(),  0xd6);
        EXPECT(gbc.h(),  0x72);
        EXPECT(gbc.l(),  0x5a);
        EXPECT(gbc.sp(), 0x43cc);
        EXPECT(gbc.pc(), 0xc021);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xc020), 0x3d);
        // 3D 03B8
        gbc.setState(0x5c30, 0xed26, 0x5f60, 0x4704, 0xc495, 0xd043, 0x0, 0x0);
        gbc.writeMem(0x5c30, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x5e);
        EXPECT(gbc.b(),  0x47);
        EXPECT(gbc.c(),  0x4);
        EXPECT(gbc.d(),  0xc4);
        EXPECT(gbc.e(),  0x95);
        EXPECT(gbc.h(),  0xd0);
        EXPECT(gbc.l(),  0x43);
        EXPECT(gbc.sp(), 0xed26);
        EXPECT(gbc.pc(), 0x5c31);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 03B9
        gbc.setState(0x6976, 0x59a4, 0x4830, 0xb2b8, 0x8170, 0xc3e6, 0x1, 0x0);
        gbc.writeMem(0x6976, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x47);
        EXPECT(gbc.b(),  0xb2);
        EXPECT(gbc.c(),  0xb8);
        EXPECT(gbc.d(),  0x81);
        EXPECT(gbc.e(),  0x70);
        EXPECT(gbc.h(),  0xc3);
        EXPECT(gbc.l(),  0xe6);
        EXPECT(gbc.sp(), 0x59a4);
        EXPECT(gbc.pc(), 0x6977);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 03BA
        gbc.setState(0x1898, 0x92d4, 0x2920, 0x20e5, 0xc082, 0x1613, 0x0, 0x0);
        gbc.writeMem(0x1898, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0x20);
        EXPECT(gbc.c(),  0xe5);
        EXPECT(gbc.d(),  0xc0);
        EXPECT(gbc.e(),  0x82);
        EXPECT(gbc.h(),  0x16);
        EXPECT(gbc.l(),  0x13);
        EXPECT(gbc.sp(), 0x92d4);
        EXPECT(gbc.pc(), 0x1899);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 03BB
        gbc.setState(0xa4d6, 0x53e8, 0x6760, 0x558f, 0xaea8, 0xa9b0, 0x0, 0x1);
        gbc.writeMem(0xa4d6, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x66);
        EXPECT(gbc.b(),  0x55);
        EXPECT(gbc.c(),  0x8f);
        EXPECT(gbc.d(),  0xae);
        EXPECT(gbc.e(),  0xa8);
        EXPECT(gbc.h(),  0xa9);
        EXPECT(gbc.l(),  0xb0);
        EXPECT(gbc.sp(), 0x53e8);
        EXPECT(gbc.pc(), 0xa4d7);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa4d6), 0x3d);
        // 3D 03BC
        gbc.setState(0xda57, 0x4060, 0x4240, 0xf913, 0x911e, 0x3c1d, 0x0, 0x1);
        gbc.writeMem(0xda57, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x41);
        EXPECT(gbc.b(),  0xf9);
        EXPECT(gbc.c(),  0x13);
        EXPECT(gbc.d(),  0x91);
        EXPECT(gbc.e(),  0x1e);
        EXPECT(gbc.h(),  0x3c);
        EXPECT(gbc.l(),  0x1d);
        EXPECT(gbc.sp(), 0x4060);
        EXPECT(gbc.pc(), 0xda58);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xda57), 0x3d);
        // 3D 03BD
        gbc.setState(0x1af2, 0xef7b, 0xf140, 0x8656, 0x459e, 0x973, 0x1, 0x0);
        gbc.writeMem(0x1af2, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf0);
        EXPECT(gbc.b(),  0x86);
        EXPECT(gbc.c(),  0x56);
        EXPECT(gbc.d(),  0x45);
        EXPECT(gbc.e(),  0x9e);
        EXPECT(gbc.h(),  0x9);
        EXPECT(gbc.l(),  0x73);
        EXPECT(gbc.sp(), 0xef7b);
        EXPECT(gbc.pc(), 0x1af3);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 03BE
        gbc.setState(0x83b0, 0x7278, 0x2940, 0x923e, 0x5d9e, 0xbf32, 0x0, 0x0);
        gbc.writeMem(0x83b0, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x28);
        EXPECT(gbc.b(),  0x92);
        EXPECT(gbc.c(),  0x3e);
        EXPECT(gbc.d(),  0x5d);
        EXPECT(gbc.e(),  0x9e);
        EXPECT(gbc.h(),  0xbf);
        EXPECT(gbc.l(),  0x32);
        EXPECT(gbc.sp(), 0x7278);
        EXPECT(gbc.pc(), 0x83b1);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x83b0), 0x3d);
        // 3D 03BF
        gbc.setState(0xe97a, 0x938b, 0xc1c0, 0xacc5, 0x31be, 0x8eed, 0x1, 0x1);
        gbc.writeMem(0xe97a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xc0);
        EXPECT(gbc.b(),  0xac);
        EXPECT(gbc.c(),  0xc5);
        EXPECT(gbc.d(),  0x31);
        EXPECT(gbc.e(),  0xbe);
        EXPECT(gbc.h(),  0x8e);
        EXPECT(gbc.l(),  0xed);
        EXPECT(gbc.sp(), 0x938b);
        EXPECT(gbc.pc(), 0xe97b);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xe97a), 0x3d);
        // 3D 03C0
        gbc.setState(0x3637, 0xd7ca, 0x55a0, 0xbb34, 0x3b50, 0x3372, 0x0, 0x0);
        gbc.writeMem(0x3637, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x54);
        EXPECT(gbc.b(),  0xbb);
        EXPECT(gbc.c(),  0x34);
        EXPECT(gbc.d(),  0x3b);
        EXPECT(gbc.e(),  0x50);
        EXPECT(gbc.h(),  0x33);
        EXPECT(gbc.l(),  0x72);
        EXPECT(gbc.sp(), 0xd7ca);
        EXPECT(gbc.pc(), 0x3638);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 03C1
        gbc.setState(0x6e6d, 0x18ef, 0x8d20, 0x877d, 0x60c5, 0x3ec2, 0x1, 0x0);
        gbc.writeMem(0x6e6d, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x8c);
        EXPECT(gbc.b(),  0x87);
        EXPECT(gbc.c(),  0x7d);
        EXPECT(gbc.d(),  0x60);
        EXPECT(gbc.e(),  0xc5);
        EXPECT(gbc.h(),  0x3e);
        EXPECT(gbc.l(),  0xc2);
        EXPECT(gbc.sp(), 0x18ef);
        EXPECT(gbc.pc(), 0x6e6e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 03C2
        gbc.setState(0xbb5a, 0xb3cb, 0x3a10, 0xfddd, 0x940e, 0xe375, 0x0, 0x0);
        gbc.writeMem(0xbb5a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x39);
        EXPECT(gbc.b(),  0xfd);
        EXPECT(gbc.c(),  0xdd);
        EXPECT(gbc.d(),  0x94);
        EXPECT(gbc.e(),  0xe);
        EXPECT(gbc.h(),  0xe3);
        EXPECT(gbc.l(),  0x75);
        EXPECT(gbc.sp(), 0xb3cb);
        EXPECT(gbc.pc(), 0xbb5b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xbb5a), 0x3d);
        // 3D 03C3
        gbc.setState(0xeea4, 0x174e, 0x24c0, 0x7394, 0x15c2, 0x3b68, 0x0, 0x1);
        gbc.writeMem(0xeea4, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x23);
        EXPECT(gbc.b(),  0x73);
        EXPECT(gbc.c(),  0x94);
        EXPECT(gbc.d(),  0x15);
        EXPECT(gbc.e(),  0xc2);
        EXPECT(gbc.h(),  0x3b);
        EXPECT(gbc.l(),  0x68);
        EXPECT(gbc.sp(), 0x174e);
        EXPECT(gbc.pc(), 0xeea5);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xeea4), 0x3d);
        // 3D 03C4
        gbc.setState(0x8c75, 0xc2bb, 0x8460, 0x8b50, 0x8e1f, 0xf747, 0x0, 0x0);
        gbc.writeMem(0x8c75, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x83);
        EXPECT(gbc.b(),  0x8b);
        EXPECT(gbc.c(),  0x50);
        EXPECT(gbc.d(),  0x8e);
        EXPECT(gbc.e(),  0x1f);
        EXPECT(gbc.h(),  0xf7);
        EXPECT(gbc.l(),  0x47);
        EXPECT(gbc.sp(), 0xc2bb);
        EXPECT(gbc.pc(), 0x8c76);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8c75), 0x3d);
        // 3D 03C5
        gbc.setState(0x4c77, 0xf8e8, 0xf5d0, 0xe18b, 0x59f5, 0xe96c, 0x0, 0x1);
        gbc.writeMem(0x4c77, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf4);
        EXPECT(gbc.b(),  0xe1);
        EXPECT(gbc.c(),  0x8b);
        EXPECT(gbc.d(),  0x59);
        EXPECT(gbc.e(),  0xf5);
        EXPECT(gbc.h(),  0xe9);
        EXPECT(gbc.l(),  0x6c);
        EXPECT(gbc.sp(), 0xf8e8);
        EXPECT(gbc.pc(), 0x4c78);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 03C6
        gbc.setState(0xaf72, 0xd6d, 0x6f10, 0xb1be, 0xb8ec, 0x9094, 0x0, 0x1);
        gbc.writeMem(0xaf72, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x6e);
        EXPECT(gbc.b(),  0xb1);
        EXPECT(gbc.c(),  0xbe);
        EXPECT(gbc.d(),  0xb8);
        EXPECT(gbc.e(),  0xec);
        EXPECT(gbc.h(),  0x90);
        EXPECT(gbc.l(),  0x94);
        EXPECT(gbc.sp(), 0xd6d);
        EXPECT(gbc.pc(), 0xaf73);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xaf72), 0x3d);
        // 3D 03C7
        gbc.setState(0x711e, 0x202b, 0xeff0, 0x6ce4, 0x48e1, 0x58aa, 0x0, 0x1);
        gbc.writeMem(0x711e, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xee);
        EXPECT(gbc.b(),  0x6c);
        EXPECT(gbc.c(),  0xe4);
        EXPECT(gbc.d(),  0x48);
        EXPECT(gbc.e(),  0xe1);
        EXPECT(gbc.h(),  0x58);
        EXPECT(gbc.l(),  0xaa);
        EXPECT(gbc.sp(), 0x202b);
        EXPECT(gbc.pc(), 0x711f);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 03C8
        gbc.setState(0xdd15, 0x3916, 0x47d0, 0x1590, 0xd4e8, 0x23b1, 0x0, 0x1);
        gbc.writeMem(0xdd15, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x46);
        EXPECT(gbc.b(),  0x15);
        EXPECT(gbc.c(),  0x90);
        EXPECT(gbc.d(),  0xd4);
        EXPECT(gbc.e(),  0xe8);
        EXPECT(gbc.h(),  0x23);
        EXPECT(gbc.l(),  0xb1);
        EXPECT(gbc.sp(), 0x3916);
        EXPECT(gbc.pc(), 0xdd16);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xdd15), 0x3d);
        // 3D 03C9
        gbc.setState(0xe3f0, 0xd3bf, 0x17b0, 0x8b3b, 0x3ed0, 0x7e16, 0x1, 0x1);
        gbc.writeMem(0xe3f0, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x16);
        EXPECT(gbc.b(),  0x8b);
        EXPECT(gbc.c(),  0x3b);
        EXPECT(gbc.d(),  0x3e);
        EXPECT(gbc.e(),  0xd0);
        EXPECT(gbc.h(),  0x7e);
        EXPECT(gbc.l(),  0x16);
        EXPECT(gbc.sp(), 0xd3bf);
        EXPECT(gbc.pc(), 0xe3f1);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe3f0), 0x3d);
        // 3D 03CA
        gbc.setState(0xa74f, 0x5d50, 0x5020, 0x48fc, 0x17ad, 0x5850, 0x1, 0x0);
        gbc.writeMem(0xa74f, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x4f);
        EXPECT(gbc.b(),  0x48);
        EXPECT(gbc.c(),  0xfc);
        EXPECT(gbc.d(),  0x17);
        EXPECT(gbc.e(),  0xad);
        EXPECT(gbc.h(),  0x58);
        EXPECT(gbc.l(),  0x50);
        EXPECT(gbc.sp(), 0x5d50);
        EXPECT(gbc.pc(), 0xa750);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xa74f), 0x3d);
        // 3D 03CB
        gbc.setState(0xc6fa, 0x365e, 0xecb0, 0x8a53, 0x4a7e, 0xec7, 0x1, 0x1);
        gbc.writeMem(0xc6fa, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xeb);
        EXPECT(gbc.b(),  0x8a);
        EXPECT(gbc.c(),  0x53);
        EXPECT(gbc.d(),  0x4a);
        EXPECT(gbc.e(),  0x7e);
        EXPECT(gbc.h(),  0xe);
        EXPECT(gbc.l(),  0xc7);
        EXPECT(gbc.sp(), 0x365e);
        EXPECT(gbc.pc(), 0xc6fb);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xc6fa), 0x3d);
        // 3D 03CC
        gbc.setState(0x8148, 0xe365, 0x4410, 0x5968, 0xc726, 0xcf11, 0x1, 0x1);
        gbc.writeMem(0x8148, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x43);
        EXPECT(gbc.b(),  0x59);
        EXPECT(gbc.c(),  0x68);
        EXPECT(gbc.d(),  0xc7);
        EXPECT(gbc.e(),  0x26);
        EXPECT(gbc.h(),  0xcf);
        EXPECT(gbc.l(),  0x11);
        EXPECT(gbc.sp(), 0xe365);
        EXPECT(gbc.pc(), 0x8149);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8148), 0x3d);
        // 3D 03CD
        gbc.setState(0x5293, 0x6d0, 0x2fc0, 0x2c58, 0x966f, 0xc2b4, 0x1, 0x0);
        gbc.writeMem(0x5293, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x2e);
        EXPECT(gbc.b(),  0x2c);
        EXPECT(gbc.c(),  0x58);
        EXPECT(gbc.d(),  0x96);
        EXPECT(gbc.e(),  0x6f);
        EXPECT(gbc.h(),  0xc2);
        EXPECT(gbc.l(),  0xb4);
        EXPECT(gbc.sp(), 0x6d0);
        EXPECT(gbc.pc(), 0x5294);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 03CE
        gbc.setState(0x7e52, 0x6ae5, 0xdf70, 0xed4d, 0x54b2, 0x155f, 0x1, 0x1);
        gbc.writeMem(0x7e52, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xde);
        EXPECT(gbc.b(),  0xed);
        EXPECT(gbc.c(),  0x4d);
        EXPECT(gbc.d(),  0x54);
        EXPECT(gbc.e(),  0xb2);
        EXPECT(gbc.h(),  0x15);
        EXPECT(gbc.l(),  0x5f);
        EXPECT(gbc.sp(), 0x6ae5);
        EXPECT(gbc.pc(), 0x7e53);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 03CF
        gbc.setState(0x8c67, 0x221d, 0xbc30, 0x56af, 0xfae7, 0x83e2, 0x1, 0x0);
        gbc.writeMem(0x8c67, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xbb);
        EXPECT(gbc.b(),  0x56);
        EXPECT(gbc.c(),  0xaf);
        EXPECT(gbc.d(),  0xfa);
        EXPECT(gbc.e(),  0xe7);
        EXPECT(gbc.h(),  0x83);
        EXPECT(gbc.l(),  0xe2);
        EXPECT(gbc.sp(), 0x221d);
        EXPECT(gbc.pc(), 0x8c68);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8c67), 0x3d);
        // 3D 03D0
        gbc.setState(0x7d26, 0x45b0, 0xef30, 0x9552, 0xca38, 0x4c70, 0x0, 0x0);
        gbc.writeMem(0x7d26, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xee);
        EXPECT(gbc.b(),  0x95);
        EXPECT(gbc.c(),  0x52);
        EXPECT(gbc.d(),  0xca);
        EXPECT(gbc.e(),  0x38);
        EXPECT(gbc.h(),  0x4c);
        EXPECT(gbc.l(),  0x70);
        EXPECT(gbc.sp(), 0x45b0);
        EXPECT(gbc.pc(), 0x7d27);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 03D1
        gbc.setState(0x55f6, 0xa0c8, 0x1c50, 0xcf2, 0x54a8, 0xbb31, 0x1, 0x1);
        gbc.writeMem(0x55f6, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x1b);
        EXPECT(gbc.b(),  0xc);
        EXPECT(gbc.c(),  0xf2);
        EXPECT(gbc.d(),  0x54);
        EXPECT(gbc.e(),  0xa8);
        EXPECT(gbc.h(),  0xbb);
        EXPECT(gbc.l(),  0x31);
        EXPECT(gbc.sp(), 0xa0c8);
        EXPECT(gbc.pc(), 0x55f7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 03D3
        gbc.setState(0x693d, 0xdd71, 0x4750, 0xde1, 0xd119, 0xdcda, 0x1, 0x0);
        gbc.writeMem(0x693d, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x46);
        EXPECT(gbc.b(),  0xd);
        EXPECT(gbc.c(),  0xe1);
        EXPECT(gbc.d(),  0xd1);
        EXPECT(gbc.e(),  0x19);
        EXPECT(gbc.h(),  0xdc);
        EXPECT(gbc.l(),  0xda);
        EXPECT(gbc.sp(), 0xdd71);
        EXPECT(gbc.pc(), 0x693e);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 03D4
        gbc.setState(0x39ce, 0x9892, 0x5620, 0x74c7, 0xb23, 0x3d5, 0x1, 0x0);
        gbc.writeMem(0x39ce, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x55);
        EXPECT(gbc.b(),  0x74);
        EXPECT(gbc.c(),  0xc7);
        EXPECT(gbc.d(),  0xb);
        EXPECT(gbc.e(),  0x23);
        EXPECT(gbc.h(),  0x3);
        EXPECT(gbc.l(),  0xd5);
        EXPECT(gbc.sp(), 0x9892);
        EXPECT(gbc.pc(), 0x39cf);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 03D5
        gbc.setState(0x813c, 0xca2e, 0x32d0, 0xc1ff, 0x343e, 0x71e8, 0x0, 0x1);
        gbc.writeMem(0x813c, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x31);
        EXPECT(gbc.b(),  0xc1);
        EXPECT(gbc.c(),  0xff);
        EXPECT(gbc.d(),  0x34);
        EXPECT(gbc.e(),  0x3e);
        EXPECT(gbc.h(),  0x71);
        EXPECT(gbc.l(),  0xe8);
        EXPECT(gbc.sp(), 0xca2e);
        EXPECT(gbc.pc(), 0x813d);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x813c), 0x3d);
        // 3D 03D6
        gbc.setState(0x79f7, 0xa790, 0xd420, 0xb3df, 0x1604, 0x4bb3, 0x0, 0x0);
        gbc.writeMem(0x79f7, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xd3);
        EXPECT(gbc.b(),  0xb3);
        EXPECT(gbc.c(),  0xdf);
        EXPECT(gbc.d(),  0x16);
        EXPECT(gbc.e(),  0x4);
        EXPECT(gbc.h(),  0x4b);
        EXPECT(gbc.l(),  0xb3);
        EXPECT(gbc.sp(), 0xa790);
        EXPECT(gbc.pc(), 0x79f8);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 03D7
        gbc.setState(0x8cf6, 0xb2f7, 0xa830, 0x8dab, 0xabc5, 0xaf28, 0x1, 0x0);
        gbc.writeMem(0x8cf6, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa7);
        EXPECT(gbc.b(),  0x8d);
        EXPECT(gbc.c(),  0xab);
        EXPECT(gbc.d(),  0xab);
        EXPECT(gbc.e(),  0xc5);
        EXPECT(gbc.h(),  0xaf);
        EXPECT(gbc.l(),  0x28);
        EXPECT(gbc.sp(), 0xb2f7);
        EXPECT(gbc.pc(), 0x8cf7);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x8cf6), 0x3d);
        // 3D 03D8
        gbc.setState(0x5f42, 0xbe48, 0x47c0, 0x756d, 0xca84, 0x2082, 0x0, 0x0);
        gbc.writeMem(0x5f42, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x46);
        EXPECT(gbc.b(),  0x75);
        EXPECT(gbc.c(),  0x6d);
        EXPECT(gbc.d(),  0xca);
        EXPECT(gbc.e(),  0x84);
        EXPECT(gbc.h(),  0x20);
        EXPECT(gbc.l(),  0x82);
        EXPECT(gbc.sp(), 0xbe48);
        EXPECT(gbc.pc(), 0x5f43);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 03DA
        gbc.setState(0xd21b, 0xaa5c, 0x7250, 0xe799, 0xcac5, 0x211a, 0x0, 0x0);
        gbc.writeMem(0xd21b, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x71);
        EXPECT(gbc.b(),  0xe7);
        EXPECT(gbc.c(),  0x99);
        EXPECT(gbc.d(),  0xca);
        EXPECT(gbc.e(),  0xc5);
        EXPECT(gbc.h(),  0x21);
        EXPECT(gbc.l(),  0x1a);
        EXPECT(gbc.sp(), 0xaa5c);
        EXPECT(gbc.pc(), 0xd21c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xd21b), 0x3d);
        // 3D 03DB
        gbc.setState(0xd8fd, 0x872a, 0xe580, 0x7fe0, 0xf811, 0x1443, 0x0, 0x0);
        gbc.writeMem(0xd8fd, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xe4);
        EXPECT(gbc.b(),  0x7f);
        EXPECT(gbc.c(),  0xe0);
        EXPECT(gbc.d(),  0xf8);
        EXPECT(gbc.e(),  0x11);
        EXPECT(gbc.h(),  0x14);
        EXPECT(gbc.l(),  0x43);
        EXPECT(gbc.sp(), 0x872a);
        EXPECT(gbc.pc(), 0xd8fe);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0xd8fd), 0x3d);
        // 3D 03DC
        gbc.setState(0xe2ba, 0x2768, 0xa270, 0xa0cb, 0x28b1, 0xb1de, 0x0, 0x1);
        gbc.writeMem(0xe2ba, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa1);
        EXPECT(gbc.b(),  0xa0);
        EXPECT(gbc.c(),  0xcb);
        EXPECT(gbc.d(),  0x28);
        EXPECT(gbc.e(),  0xb1);
        EXPECT(gbc.h(),  0xb1);
        EXPECT(gbc.l(),  0xde);
        EXPECT(gbc.sp(), 0x2768);
        EXPECT(gbc.pc(), 0xe2bb);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xe2ba), 0x3d);
        // 3D 03DD
        gbc.setState(0x9165, 0xb8f, 0x5bd0, 0xd0a4, 0x6aa1, 0x2e13, 0x0, 0x0);
        gbc.writeMem(0x9165, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x5a);
        EXPECT(gbc.b(),  0xd0);
        EXPECT(gbc.c(),  0xa4);
        EXPECT(gbc.d(),  0x6a);
        EXPECT(gbc.e(),  0xa1);
        EXPECT(gbc.h(),  0x2e);
        EXPECT(gbc.l(),  0x13);
        EXPECT(gbc.sp(), 0xb8f);
        EXPECT(gbc.pc(), 0x9166);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x9165), 0x3d);
        // 3D 03DE
        gbc.setState(0x141a, 0xfc89, 0xa390, 0x224a, 0x51c1, 0x5527, 0x0, 0x0);
        gbc.writeMem(0x141a, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xa2);
        EXPECT(gbc.b(),  0x22);
        EXPECT(gbc.c(),  0x4a);
        EXPECT(gbc.d(),  0x51);
        EXPECT(gbc.e(),  0xc1);
        EXPECT(gbc.h(),  0x55);
        EXPECT(gbc.l(),  0x27);
        EXPECT(gbc.sp(), 0xfc89);
        EXPECT(gbc.pc(), 0x141b);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 03DF
        gbc.setState(0x97e2, 0x3192, 0x72b0, 0x82f, 0xa6cd, 0x8b68, 0x0, 0x0);
        gbc.writeMem(0x97e2, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x71);
        EXPECT(gbc.b(),  0x8);
        EXPECT(gbc.c(),  0x2f);
        EXPECT(gbc.d(),  0xa6);
        EXPECT(gbc.e(),  0xcd);
        EXPECT(gbc.h(),  0x8b);
        EXPECT(gbc.l(),  0x68);
        EXPECT(gbc.sp(), 0x3192);
        EXPECT(gbc.pc(), 0x97e3);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x97e2), 0x3d);
        // 3D 03E0
        gbc.setState(0xa3e5, 0x8abe, 0xbab0, 0xd74a, 0xc721, 0x1a77, 0x1, 0x0);
        gbc.writeMem(0xa3e5, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xb9);
        EXPECT(gbc.b(),  0xd7);
        EXPECT(gbc.c(),  0x4a);
        EXPECT(gbc.d(),  0xc7);
        EXPECT(gbc.e(),  0x21);
        EXPECT(gbc.h(),  0x1a);
        EXPECT(gbc.l(),  0x77);
        EXPECT(gbc.sp(), 0x8abe);
        EXPECT(gbc.pc(), 0xa3e6);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa3e5), 0x3d);
        // 3D 03E1
        gbc.setState(0x80cc, 0x689, 0x10d0, 0xa478, 0x1e52, 0x19e4, 0x1, 0x1);
        gbc.writeMem(0x80cc, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xf);
        EXPECT(gbc.b(),  0xa4);
        EXPECT(gbc.c(),  0x78);
        EXPECT(gbc.d(),  0x1e);
        EXPECT(gbc.e(),  0x52);
        EXPECT(gbc.h(),  0x19);
        EXPECT(gbc.l(),  0xe4);
        EXPECT(gbc.sp(), 0x689);
        EXPECT(gbc.pc(), 0x80cd);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  true);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0x80cc), 0x3d);
        // 3D 03E2
        gbc.setState(0xa87f, 0xc42e, 0xfe90, 0x510, 0x2bb4, 0x9d3f, 0x0, 0x1);
        gbc.writeMem(0xa87f, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xfd);
        EXPECT(gbc.b(),  0x5);
        EXPECT(gbc.c(),  0x10);
        EXPECT(gbc.d(),  0x2b);
        EXPECT(gbc.e(),  0xb4);
        EXPECT(gbc.h(),  0x9d);
        EXPECT(gbc.l(),  0x3f);
        EXPECT(gbc.sp(), 0xc42e);
        EXPECT(gbc.pc(), 0xa880);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa87f), 0x3d);
        // 3D 03E3
        gbc.setState(0x8adf, 0x70b5, 0xc260, 0x908c, 0x6a9c, 0xd487, 0x0, 0x1);
        gbc.writeMem(0x8adf, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xc1);
        EXPECT(gbc.b(),  0x90);
        EXPECT(gbc.c(),  0x8c);
        EXPECT(gbc.d(),  0x6a);
        EXPECT(gbc.e(),  0x9c);
        EXPECT(gbc.h(),  0xd4);
        EXPECT(gbc.l(),  0x87);
        EXPECT(gbc.sp(), 0x70b5);
        EXPECT(gbc.pc(), 0x8ae0);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        EXPECT(gbc.readMem(0x8adf), 0x3d);
        // 3D 03E4
        gbc.setState(0x13cf, 0xcc34, 0x5ea0, 0xc9c, 0x675e, 0xebae, 0x1, 0x0);
        gbc.writeMem(0x13cf, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x5d);
        EXPECT(gbc.b(),  0xc);
        EXPECT(gbc.c(),  0x9c);
        EXPECT(gbc.d(),  0x67);
        EXPECT(gbc.e(),  0x5e);
        EXPECT(gbc.h(),  0xeb);
        EXPECT(gbc.l(),  0xae);
        EXPECT(gbc.sp(), 0xcc34);
        EXPECT(gbc.pc(), 0x13d0);
        EXPECT(gbc.ime(), 0x1);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
        // 3D 03E5
        gbc.setState(0xa1ea, 0x5f87, 0xfe10, 0xeac4, 0x2e8a, 0xf610, 0x0, 0x1);
        gbc.writeMem(0xa1ea, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0xfd);
        EXPECT(gbc.b(),  0xea);
        EXPECT(gbc.c(),  0xc4);
        EXPECT(gbc.d(),  0x2e);
        EXPECT(gbc.e(),  0x8a);
        EXPECT(gbc.h(),  0xf6);
        EXPECT(gbc.l(),  0x10);
        EXPECT(gbc.sp(), 0x5f87);
        EXPECT(gbc.pc(), 0xa1eb);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        EXPECT(gbc.readMem(0xa1ea), 0x3d);
        // 3D 03E6
        gbc.setState(0x2f50, 0x721b, 0x5770, 0x498, 0x43e8, 0xd2ec, 0x0, 0x0);
        gbc.writeMem(0x2f50, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x56);
        EXPECT(gbc.b(),  0x4);
        EXPECT(gbc.c(),  0x98);
        EXPECT(gbc.d(),  0x43);
        EXPECT(gbc.e(),  0xe8);
        EXPECT(gbc.h(),  0xd2);
        EXPECT(gbc.l(),  0xec);
        EXPECT(gbc.sp(), 0x721b);
        EXPECT(gbc.pc(), 0x2f51);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  true);
        // 3D 03E7
        gbc.setState(0xc3b, 0x3e44, 0x1a80, 0x2d42, 0x3022, 0xce61, 0x0, 0x1);
        gbc.writeMem(0xc3b, { 0x3d });
        gbc.step();
        EXPECT(gbc.a(),  0x19);
        EXPECT(gbc.b(),  0x2d);
        EXPECT(gbc.c(),  0x42);
        EXPECT(gbc.d(),  0x30);
        EXPECT(gbc.e(),  0x22);
        EXPECT(gbc.h(),  0xce);
        EXPECT(gbc.l(),  0x61);
        EXPECT(gbc.sp(), 0x3e44);
        EXPECT(gbc.pc(), 0xc3c);
        EXPECT(gbc.ime(), 0x0);
        EXPECT(gbc.flagZ(),  false);
        EXPECT(gbc.flagN(),  true);
        EXPECT(gbc.flagH(),  false);
        EXPECT(gbc.flagC(),  false);
    }
